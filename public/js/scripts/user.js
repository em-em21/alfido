/*! For license information please see user.js.LICENSE.txt */
(()=>{var e={7757:(e,t,s)=>{e.exports=s(5666)},8583:(e,t,s)=>{"use strict";var i=s(7418);function r(e,t){if(e===t)return 0;for(var s=e.length,i=t.length,r=0,a=Math.min(s,i);r<a;++r)if(e[r]!==t[r]){s=e[r],i=t[r];break}return s<i?-1:i<s?1:0}function a(e){return s.g.Buffer&&"function"==typeof s.g.Buffer.isBuffer?s.g.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var n=s(69),o=Object.prototype.hasOwnProperty,c=Array.prototype.slice,d="foo"===function(){}.name;function h(e){return Object.prototype.toString.call(e)}function u(e){return!a(e)&&("function"==typeof s.g.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}var l=e.exports=y,f=/\s*function\s+([^\(\s]*)\s*/;function p(e){if(n.isFunction(e)){if(d)return e.name;var t=e.toString().match(f);return t&&t[1]}}function m(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function b(e){if(d||!n.isFunction(e))return n.inspect(e);var t=p(e);return"[Function"+(t?": "+t:"")+"]"}function g(e,t,s,i,r){throw new l.AssertionError({message:s,actual:e,expected:t,operator:i,stackStartFunction:r})}function y(e,t){e||g(e,!0,t,"==",l.ok)}function v(e,t,s,i){if(e===t)return!0;if(a(e)&&a(t))return 0===r(e,t);if(n.isDate(e)&&n.isDate(t))return e.getTime()===t.getTime();if(n.isRegExp(e)&&n.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(u(e)&&u(t)&&h(e)===h(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===r(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(a(e)!==a(t))return!1;var o=(i=i||{actual:[],expected:[]}).actual.indexOf(e);return-1!==o&&o===i.expected.indexOf(t)||(i.actual.push(e),i.expected.push(t),function(e,t,s,i){if(null==e||null==t)return!1;if(n.isPrimitive(e)||n.isPrimitive(t))return e===t;if(s&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var r=w(e),a=w(t);if(r&&!a||!r&&a)return!1;if(r)return v(e=c.call(e),t=c.call(t),s);var o,d,h=_(e),u=_(t);if(h.length!==u.length)return!1;for(h.sort(),u.sort(),d=h.length-1;d>=0;d--)if(h[d]!==u[d])return!1;for(d=h.length-1;d>=0;d--)if(!v(e[o=h[d]],t[o],s,i))return!1;return!0}(e,t,s,i))}return s?e===t:e==t}function w(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function k(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function S(e,t,s,i){var r;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof s&&(i=s,s=null),r=function(e){var t;try{e()}catch(e){t=e}return t}(t),i=(s&&s.name?" ("+s.name+").":".")+(i?" "+i:"."),e&&!r&&g(r,s,"Missing expected exception"+i);var a="string"==typeof i,o=!e&&r&&!s;if((!e&&n.isError(r)&&a&&k(r,s)||o)&&g(r,s,"Got unwanted exception"+i),e&&r&&s&&!k(r,s)||!e&&r)throw r}l.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return m(b(e.actual),128)+" "+e.operator+" "+m(b(e.expected),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||g;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var s=new Error;if(s.stack){var i=s.stack,r=p(t),a=i.indexOf("\n"+r);if(a>=0){var n=i.indexOf("\n",a+1);i=i.substring(n+1)}this.stack=i}}},n.inherits(l.AssertionError,Error),l.fail=g,l.ok=y,l.equal=function(e,t,s){e!=t&&g(e,t,s,"==",l.equal)},l.notEqual=function(e,t,s){e==t&&g(e,t,s,"!=",l.notEqual)},l.deepEqual=function(e,t,s){v(e,t,!1)||g(e,t,s,"deepEqual",l.deepEqual)},l.deepStrictEqual=function(e,t,s){v(e,t,!0)||g(e,t,s,"deepStrictEqual",l.deepStrictEqual)},l.notDeepEqual=function(e,t,s){v(e,t,!1)&&g(e,t,s,"notDeepEqual",l.notDeepEqual)},l.notDeepStrictEqual=function e(t,s,i){v(t,s,!0)&&g(t,s,i,"notDeepStrictEqual",e)},l.strictEqual=function(e,t,s){e!==t&&g(e,t,s,"===",l.strictEqual)},l.notStrictEqual=function(e,t,s){e===t&&g(e,t,s,"!==",l.notStrictEqual)},l.throws=function(e,t,s){S(!0,e,t,s)},l.doesNotThrow=function(e,t,s){S(!1,e,t,s)},l.ifError=function(e){if(e)throw e},l.strict=i((function e(t,s){t||g(t,!0,s,"==",e)}),l,{equal:l.strictEqual,deepEqual:l.deepStrictEqual,notEqual:l.notStrictEqual,notDeepEqual:l.notDeepStrictEqual}),l.strict.strict=l.strict;var _=Object.keys||function(e){var t=[];for(var s in e)o.call(e,s)&&t.push(s);return t}},6076:e=>{"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var s=function(){};s.prototype=t.prototype,e.prototype=new s,e.prototype.constructor=e}},2014:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},69:(e,t,s)=>{var i=s(4155),r=/%[sdj%]/g;t.format=function(e){if(!g(e)){for(var t=[],s=0;s<arguments.length;s++)t.push(o(arguments[s]));return t.join(" ")}s=1;for(var i=arguments,a=i.length,n=String(e).replace(r,(function(e){if("%%"===e)return"%";if(s>=a)return e;switch(e){case"%s":return String(i[s++]);case"%d":return Number(i[s++]);case"%j":try{return JSON.stringify(i[s++])}catch(e){return"[Circular]"}default:return e}})),c=i[s];s<a;c=i[++s])m(c)||!w(c)?n+=" "+c:n+=" "+o(c);return n},t.deprecate=function(e,r){if(y(s.g.process))return function(){return t.deprecate(e,r).apply(this,arguments)};if(!0===i.noDeprecation)return e;var a=!1;return function(){if(!a){if(i.throwDeprecation)throw new Error(r);i.traceDeprecation?console.trace(r):console.error(r),a=!0}return e.apply(this,arguments)}};var a,n={};function o(e,s){var i={seen:[],stylize:d};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),p(s)?i.showHidden=s:s&&t._extend(i,s),y(i.showHidden)&&(i.showHidden=!1),y(i.depth)&&(i.depth=2),y(i.colors)&&(i.colors=!1),y(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=c),h(i,e,i.depth)}function c(e,t){var s=o.styles[t];return s?"["+o.colors[s][0]+"m"+e+"["+o.colors[s][1]+"m":e}function d(e,t){return e}function h(e,s,i){if(e.customInspect&&s&&_(s.inspect)&&s.inspect!==t.inspect&&(!s.constructor||s.constructor.prototype!==s)){var r=s.inspect(i,e);return g(r)||(r=h(e,r,i)),r}var a=function(e,t){if(y(t))return e.stylize("undefined","undefined");if(g(t)){var s="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(s,"string")}if(b(t))return e.stylize(""+t,"number");if(p(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,s);if(a)return a;var n=Object.keys(s),o=function(e){var t={};return e.forEach((function(e,s){t[e]=!0})),t}(n);if(e.showHidden&&(n=Object.getOwnPropertyNames(s)),S(s)&&(n.indexOf("message")>=0||n.indexOf("description")>=0))return u(s);if(0===n.length){if(_(s)){var c=s.name?": "+s.name:"";return e.stylize("[Function"+c+"]","special")}if(v(s))return e.stylize(RegExp.prototype.toString.call(s),"regexp");if(k(s))return e.stylize(Date.prototype.toString.call(s),"date");if(S(s))return u(s)}var d,w="",O=!1,T=["{","}"];(f(s)&&(O=!0,T=["[","]"]),_(s))&&(w=" [Function"+(s.name?": "+s.name:"")+"]");return v(s)&&(w=" "+RegExp.prototype.toString.call(s)),k(s)&&(w=" "+Date.prototype.toUTCString.call(s)),S(s)&&(w=" "+u(s)),0!==n.length||O&&0!=s.length?i<0?v(s)?e.stylize(RegExp.prototype.toString.call(s),"regexp"):e.stylize("[Object]","special"):(e.seen.push(s),d=O?function(e,t,s,i,r){for(var a=[],n=0,o=t.length;n<o;++n)I(t,String(n))?a.push(l(e,t,s,i,String(n),!0)):a.push("");return r.forEach((function(r){r.match(/^\d+$/)||a.push(l(e,t,s,i,r,!0))})),a}(e,s,i,o,n):n.map((function(t){return l(e,s,i,o,t,O)})),e.seen.pop(),function(e,t,s){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return s[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+s[1];return s[0]+t+" "+e.join(", ")+" "+s[1]}(d,w,T)):T[0]+w+T[1]}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function l(e,t,s,i,r,a){var n,o,c;if((c=Object.getOwnPropertyDescriptor(t,r)||{value:t[r]}).get?o=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(o=e.stylize("[Setter]","special")),I(i,r)||(n="["+r+"]"),o||(e.seen.indexOf(c.value)<0?(o=m(s)?h(e,c.value,null):h(e,c.value,s-1)).indexOf("\n")>-1&&(o=a?o.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+o.split("\n").map((function(e){return"   "+e})).join("\n")):o=e.stylize("[Circular]","special")),y(n)){if(a&&r.match(/^\d+$/))return o;(n=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),n=e.stylize(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),n=e.stylize(n,"string"))}return n+": "+o}function f(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function m(e){return null===e}function b(e){return"number"==typeof e}function g(e){return"string"==typeof e}function y(e){return void 0===e}function v(e){return w(e)&&"[object RegExp]"===O(e)}function w(e){return"object"==typeof e&&null!==e}function k(e){return w(e)&&"[object Date]"===O(e)}function S(e){return w(e)&&("[object Error]"===O(e)||e instanceof Error)}function _(e){return"function"==typeof e}function O(e){return Object.prototype.toString.call(e)}function T(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(y(a)&&(a=i.env.NODE_DEBUG||""),e=e.toUpperCase(),!n[e])if(new RegExp("\\b"+e+"\\b","i").test(a)){var s=i.pid;n[e]=function(){var i=t.format.apply(t,arguments);console.error("%s %d: %s",e,s,i)}}else n[e]=function(){};return n[e]},t.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=f,t.isBoolean=p,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=b,t.isString=g,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=y,t.isRegExp=v,t.isObject=w,t.isDate=k,t.isError=S,t.isFunction=_,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=s(2014);var x=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function C(){var e=new Date,t=[T(e.getHours()),T(e.getMinutes()),T(e.getSeconds())].join(":");return[e.getDate(),x[e.getMonth()],t].join(" ")}function I(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",C(),t.format.apply(t,arguments))},t.inherits=s(6076),t._extend=function(e,t){if(!t||!w(t))return e;for(var s=Object.keys(t),i=s.length;i--;)e[s[i]]=t[s[i]];return e}},9669:(e,t,s)=>{e.exports=s(1609)},5448:(e,t,s)=>{"use strict";var i=s(4867),r=s(6026),a=s(4372),n=s(5327),o=s(4097),c=s(4109),d=s(7985),h=s(5061);e.exports=function(e){return new Promise((function(t,s){var u=e.data,l=e.headers;i.isFormData(u)&&delete l["Content-Type"];var f=new XMLHttpRequest;if(e.auth){var p=e.auth.username||"",m=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";l.Authorization="Basic "+btoa(p+":"+m)}var b=o(e.baseURL,e.url);if(f.open(e.method.toUpperCase(),n(b,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,f.onreadystatechange=function(){if(f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var i="getAllResponseHeaders"in f?c(f.getAllResponseHeaders()):null,a={data:e.responseType&&"text"!==e.responseType?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:i,config:e,request:f};r(t,s,a),f=null}},f.onabort=function(){f&&(s(h("Request aborted",e,"ECONNABORTED",f)),f=null)},f.onerror=function(){s(h("Network Error",e,null,f)),f=null},f.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),s(h(t,e,"ECONNABORTED",f)),f=null},i.isStandardBrowserEnv()){var g=(e.withCredentials||d(b))&&e.xsrfCookieName?a.read(e.xsrfCookieName):void 0;g&&(l[e.xsrfHeaderName]=g)}if("setRequestHeader"in f&&i.forEach(l,(function(e,t){void 0===u&&"content-type"===t.toLowerCase()?delete l[t]:f.setRequestHeader(t,e)})),i.isUndefined(e.withCredentials)||(f.withCredentials=!!e.withCredentials),e.responseType)try{f.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){f&&(f.abort(),s(e),f=null)})),u||(u=null),f.send(u)}))}},1609:(e,t,s)=>{"use strict";var i=s(4867),r=s(1849),a=s(321),n=s(7185);function o(e){var t=new a(e),s=r(a.prototype.request,t);return i.extend(s,a.prototype,t),i.extend(s,t),s}var c=o(s(5655));c.Axios=a,c.create=function(e){return o(n(c.defaults,e))},c.Cancel=s(5263),c.CancelToken=s(4972),c.isCancel=s(6502),c.all=function(e){return Promise.all(e)},c.spread=s(8713),c.isAxiosError=s(6268),e.exports=c,e.exports.default=c},5263:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},4972:(e,t,s)=>{"use strict";var i=s(5263);function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var s=this;e((function(e){s.reason||(s.reason=new i(e),t(s.reason))}))}r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e;return{token:new r((function(t){e=t})),cancel:e}},e.exports=r},6502:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},321:(e,t,s)=>{"use strict";var i=s(4867),r=s(5327),a=s(782),n=s(3572),o=s(7185);function c(e){this.defaults=e,this.interceptors={request:new a,response:new a}}c.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=o(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[n,void 0],s=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)s=s.then(t.shift(),t.shift());return s},c.prototype.getUri=function(e){return e=o(this.defaults,e),r(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},i.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,s){return this.request(o(s||{},{method:e,url:t,data:(s||{}).data}))}})),i.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,s,i){return this.request(o(i||{},{method:e,url:t,data:s}))}})),e.exports=c},782:(e,t,s)=>{"use strict";var i=s(4867);function r(){this.handlers=[]}r.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){i.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=r},4097:(e,t,s)=>{"use strict";var i=s(1793),r=s(7303);e.exports=function(e,t){return e&&!i(t)?r(e,t):t}},5061:(e,t,s)=>{"use strict";var i=s(481);e.exports=function(e,t,s,r,a){var n=new Error(e);return i(n,t,s,r,a)}},3572:(e,t,s)=>{"use strict";var i=s(4867),r=s(8527),a=s(6502),n=s(5655);function o(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return o(e),e.headers=e.headers||{},e.data=r(e.data,e.headers,e.transformRequest),e.headers=i.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),i.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||n.adapter)(e).then((function(t){return o(e),t.data=r(t.data,t.headers,e.transformResponse),t}),(function(t){return a(t)||(o(e),t&&t.response&&(t.response.data=r(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},481:e=>{"use strict";e.exports=function(e,t,s,i,r){return e.config=t,s&&(e.code=s),e.request=i,e.response=r,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},7185:(e,t,s)=>{"use strict";var i=s(4867);e.exports=function(e,t){t=t||{};var s={},r=["url","method","data"],a=["headers","auth","proxy","params"],n=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],o=["validateStatus"];function c(e,t){return i.isPlainObject(e)&&i.isPlainObject(t)?i.merge(e,t):i.isPlainObject(t)?i.merge({},t):i.isArray(t)?t.slice():t}function d(r){i.isUndefined(t[r])?i.isUndefined(e[r])||(s[r]=c(void 0,e[r])):s[r]=c(e[r],t[r])}i.forEach(r,(function(e){i.isUndefined(t[e])||(s[e]=c(void 0,t[e]))})),i.forEach(a,d),i.forEach(n,(function(r){i.isUndefined(t[r])?i.isUndefined(e[r])||(s[r]=c(void 0,e[r])):s[r]=c(void 0,t[r])})),i.forEach(o,(function(i){i in t?s[i]=c(e[i],t[i]):i in e&&(s[i]=c(void 0,e[i]))}));var h=r.concat(a).concat(n).concat(o),u=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===h.indexOf(e)}));return i.forEach(u,d),s}},6026:(e,t,s)=>{"use strict";var i=s(5061);e.exports=function(e,t,s){var r=s.config.validateStatus;s.status&&r&&!r(s.status)?t(i("Request failed with status code "+s.status,s.config,null,s.request,s)):e(s)}},8527:(e,t,s)=>{"use strict";var i=s(4867);e.exports=function(e,t,s){return i.forEach(s,(function(s){e=s(e,t)})),e}},5655:(e,t,s)=>{"use strict";var i=s(4155),r=s(4867),a=s(6016),n={"Content-Type":"application/x-www-form-urlencoded"};function o(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c,d={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==i&&"[object process]"===Object.prototype.toString.call(i))&&(c=s(5448)),c),transformRequest:[function(e,t){return a(t,"Accept"),a(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(o(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(o(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};d.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],(function(e){d.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){d.headers[e]=r.merge(n)})),e.exports=d},1849:e=>{"use strict";e.exports=function(e,t){return function(){for(var s=new Array(arguments.length),i=0;i<s.length;i++)s[i]=arguments[i];return e.apply(t,s)}}},5327:(e,t,s)=>{"use strict";var i=s(4867);function r(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,s){if(!t)return e;var a;if(s)a=s(t);else if(i.isURLSearchParams(t))a=t.toString();else{var n=[];i.forEach(t,(function(e,t){null!=e&&(i.isArray(e)?t+="[]":e=[e],i.forEach(e,(function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),n.push(r(t)+"="+r(e))})))})),a=n.join("&")}if(a){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+a}return e}},7303:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},4372:(e,t,s)=>{"use strict";var i=s(4867);e.exports=i.isStandardBrowserEnv()?{write:function(e,t,s,r,a,n){var o=[];o.push(e+"="+encodeURIComponent(t)),i.isNumber(s)&&o.push("expires="+new Date(s).toGMTString()),i.isString(r)&&o.push("path="+r),i.isString(a)&&o.push("domain="+a),!0===n&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},1793:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},6268:e=>{"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},7985:(e,t,s)=>{"use strict";var i=s(4867);e.exports=i.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),s=document.createElement("a");function r(e){var i=e;return t&&(s.setAttribute("href",i),i=s.href),s.setAttribute("href",i),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:s.port,pathname:"/"===s.pathname.charAt(0)?s.pathname:"/"+s.pathname}}return e=r(window.location.href),function(t){var s=i.isString(t)?r(t):t;return s.protocol===e.protocol&&s.host===e.host}}():function(){return!0}},6016:(e,t,s)=>{"use strict";var i=s(4867);e.exports=function(e,t){i.forEach(e,(function(s,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=s,delete e[i])}))}},4109:(e,t,s)=>{"use strict";var i=s(4867),r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,s,a,n={};return e?(i.forEach(e.split("\n"),(function(e){if(a=e.indexOf(":"),t=i.trim(e.substr(0,a)).toLowerCase(),s=i.trim(e.substr(a+1)),t){if(n[t]&&r.indexOf(t)>=0)return;n[t]="set-cookie"===t?(n[t]?n[t]:[]).concat([s]):n[t]?n[t]+", "+s:s}})),n):n}},8713:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},4867:(e,t,s)=>{"use strict";var i=s(1849),r=Object.prototype.toString;function a(e){return"[object Array]"===r.call(e)}function n(e){return void 0===e}function o(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==r.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function d(e){return"[object Function]"===r.call(e)}function h(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),a(e))for(var s=0,i=e.length;s<i;s++)t.call(null,e[s],s,e);else for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.call(null,e[r],r,e)}e.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===r.call(e)},isBuffer:function(e){return null!==e&&!n(e)&&null!==e.constructor&&!n(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:o,isPlainObject:c,isUndefined:n,isDate:function(e){return"[object Date]"===r.call(e)},isFile:function(e){return"[object File]"===r.call(e)},isBlob:function(e){return"[object Blob]"===r.call(e)},isFunction:d,isStream:function(e){return o(e)&&d(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:h,merge:function e(){var t={};function s(s,i){c(t[i])&&c(s)?t[i]=e(t[i],s):c(s)?t[i]=e({},s):a(s)?t[i]=s.slice():t[i]=s}for(var i=0,r=arguments.length;i<r;i++)h(arguments[i],s);return t},extend:function(e,t,s){return h(t,(function(t,r){e[r]=s&&"function"==typeof t?i(t,s):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},9742:(e,t)=>{"use strict";t.byteLength=function(e){var t=c(e),s=t[0],i=t[1];return 3*(s+i)/4-i},t.toByteArray=function(e){var t,s,a=c(e),n=a[0],o=a[1],d=new r(function(e,t,s){return 3*(t+s)/4-s}(0,n,o)),h=0,u=o>0?n-4:n;for(s=0;s<u;s+=4)t=i[e.charCodeAt(s)]<<18|i[e.charCodeAt(s+1)]<<12|i[e.charCodeAt(s+2)]<<6|i[e.charCodeAt(s+3)],d[h++]=t>>16&255,d[h++]=t>>8&255,d[h++]=255&t;2===o&&(t=i[e.charCodeAt(s)]<<2|i[e.charCodeAt(s+1)]>>4,d[h++]=255&t);1===o&&(t=i[e.charCodeAt(s)]<<10|i[e.charCodeAt(s+1)]<<4|i[e.charCodeAt(s+2)]>>2,d[h++]=t>>8&255,d[h++]=255&t);return d},t.fromByteArray=function(e){for(var t,i=e.length,r=i%3,a=[],n=16383,o=0,c=i-r;o<c;o+=n)a.push(d(e,o,o+n>c?c:o+n));1===r?(t=e[i-1],a.push(s[t>>2]+s[t<<4&63]+"==")):2===r&&(t=(e[i-2]<<8)+e[i-1],a.push(s[t>>10]+s[t>>4&63]+s[t<<2&63]+"="));return a.join("")};for(var s=[],i=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=0,o=a.length;n<o;++n)s[n]=a[n],i[a.charCodeAt(n)]=n;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var s=e.indexOf("=");return-1===s&&(s=t),[s,s===t?0:4-s%4]}function d(e,t,i){for(var r,a,n=[],o=t;o<i;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),n.push(s[(a=r)>>18&63]+s[a>>12&63]+s[a>>6&63]+s[63&a]);return n.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},4505:(e,t,s)=>{"use strict";var i=s(8764).Buffer,r=s(4155),a=s(8583),n=s(2292),o=s(405),c=s(7948),d=s(1619);for(var h in d)t[h]=d[h];t.NONE=0,t.DEFLATE=1,t.INFLATE=2,t.GZIP=3,t.GUNZIP=4,t.DEFLATERAW=5,t.INFLATERAW=6,t.UNZIP=7;function u(e){if("number"!=typeof e||e<t.DEFLATE||e>t.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=e,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}u.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,a(this.init_done,"close before init"),a(this.mode<=t.UNZIP),this.mode===t.DEFLATE||this.mode===t.GZIP||this.mode===t.DEFLATERAW?o.deflateEnd(this.strm):this.mode!==t.INFLATE&&this.mode!==t.GUNZIP&&this.mode!==t.INFLATERAW&&this.mode!==t.UNZIP||c.inflateEnd(this.strm),this.mode=t.NONE,this.dictionary=null)},u.prototype.write=function(e,t,s,i,r,a,n){return this._write(!0,e,t,s,i,r,a,n)},u.prototype.writeSync=function(e,t,s,i,r,a,n){return this._write(!1,e,t,s,i,r,a,n)},u.prototype._write=function(e,s,n,o,c,d,h,u){if(a.equal(arguments.length,8),a(this.init_done,"write before init"),a(this.mode!==t.NONE,"already finalized"),a.equal(!1,this.write_in_progress,"write already in progress"),a.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,a.equal(!1,void 0===s,"must provide flush value"),this.write_in_progress=!0,s!==t.Z_NO_FLUSH&&s!==t.Z_PARTIAL_FLUSH&&s!==t.Z_SYNC_FLUSH&&s!==t.Z_FULL_FLUSH&&s!==t.Z_FINISH&&s!==t.Z_BLOCK)throw new Error("Invalid flush value");if(null==n&&(n=i.alloc(0),c=0,o=0),this.strm.avail_in=c,this.strm.input=n,this.strm.next_in=o,this.strm.avail_out=u,this.strm.output=d,this.strm.next_out=h,this.flush=s,!e)return this._process(),this._checkError()?this._afterSync():void 0;var l=this;return r.nextTick((function(){l._process(),l._after()})),this},u.prototype._afterSync=function(){var e=this.strm.avail_out,t=this.strm.avail_in;return this.write_in_progress=!1,[t,e]},u.prototype._process=function(){var e=null;switch(this.mode){case t.DEFLATE:case t.GZIP:case t.DEFLATERAW:this.err=o.deflate(this.strm,this.flush);break;case t.UNZIP:switch(this.strm.avail_in>0&&(e=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===e)break;if(31!==this.strm.input[e]){this.mode=t.INFLATE;break}if(this.gzip_id_bytes_read=1,e++,1===this.strm.avail_in)break;case 1:if(null===e)break;139===this.strm.input[e]?(this.gzip_id_bytes_read=2,this.mode=t.GUNZIP):this.mode=t.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case t.INFLATE:case t.GUNZIP:case t.INFLATERAW:for(this.err=c.inflate(this.strm,this.flush),this.err===t.Z_NEED_DICT&&this.dictionary&&(this.err=c.inflateSetDictionary(this.strm,this.dictionary),this.err===t.Z_OK?this.err=c.inflate(this.strm,this.flush):this.err===t.Z_DATA_ERROR&&(this.err=t.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===t.GUNZIP&&this.err===t.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=c.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},u.prototype._checkError=function(){switch(this.err){case t.Z_OK:case t.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===t.Z_FINISH)return this._error("unexpected end of file"),!1;break;case t.Z_STREAM_END:break;case t.Z_NEED_DICT:return null==this.dictionary?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},u.prototype._after=function(){if(this._checkError()){var e=this.strm.avail_out,t=this.strm.avail_in;this.write_in_progress=!1,this.callback(t,e),this.pending_close&&this.close()}},u.prototype._error=function(e){this.strm.msg&&(e=this.strm.msg),this.onerror(e,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},u.prototype.init=function(e,s,i,r,n){a(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),a(e>=8&&e<=15,"invalid windowBits"),a(s>=-1&&s<=9,"invalid compression level"),a(i>=1&&i<=9,"invalid memlevel"),a(r===t.Z_FILTERED||r===t.Z_HUFFMAN_ONLY||r===t.Z_RLE||r===t.Z_FIXED||r===t.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(s,e,i,r,n),this._setDictionary()},u.prototype.params=function(){throw new Error("deflateParams Not supported")},u.prototype.reset=function(){this._reset(),this._setDictionary()},u.prototype._init=function(e,s,i,r,a){switch(this.level=e,this.windowBits=s,this.memLevel=i,this.strategy=r,this.flush=t.Z_NO_FLUSH,this.err=t.Z_OK,this.mode!==t.GZIP&&this.mode!==t.GUNZIP||(this.windowBits+=16),this.mode===t.UNZIP&&(this.windowBits+=32),this.mode!==t.DEFLATERAW&&this.mode!==t.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new n,this.mode){case t.DEFLATE:case t.GZIP:case t.DEFLATERAW:this.err=o.deflateInit2(this.strm,this.level,t.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case t.INFLATE:case t.GUNZIP:case t.INFLATERAW:case t.UNZIP:this.err=c.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==t.Z_OK&&this._error("Init error"),this.dictionary=a,this.write_in_progress=!1,this.init_done=!0},u.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=t.Z_OK,this.mode){case t.DEFLATE:case t.DEFLATERAW:this.err=o.deflateSetDictionary(this.strm,this.dictionary)}this.err!==t.Z_OK&&this._error("Failed to set dictionary")}},u.prototype._reset=function(){switch(this.err=t.Z_OK,this.mode){case t.DEFLATE:case t.DEFLATERAW:case t.GZIP:this.err=o.deflateReset(this.strm);break;case t.INFLATE:case t.INFLATERAW:case t.GUNZIP:this.err=c.inflateReset(this.strm)}this.err!==t.Z_OK&&this._error("Failed to reset stream")},t.Zlib=u},2635:(e,t,s)=>{"use strict";var i=s(4155),r=s(8764).Buffer,a=s(2830).Transform,n=s(4505),o=s(9539),c=s(8583).ok,d=s(8764).kMaxLength,h="Cannot create final Buffer. It would be larger than 0x"+d.toString(16)+" bytes";n.Z_MIN_WINDOWBITS=8,n.Z_MAX_WINDOWBITS=15,n.Z_DEFAULT_WINDOWBITS=15,n.Z_MIN_CHUNK=64,n.Z_MAX_CHUNK=1/0,n.Z_DEFAULT_CHUNK=16384,n.Z_MIN_MEMLEVEL=1,n.Z_MAX_MEMLEVEL=9,n.Z_DEFAULT_MEMLEVEL=8,n.Z_MIN_LEVEL=-1,n.Z_MAX_LEVEL=9,n.Z_DEFAULT_LEVEL=n.Z_DEFAULT_COMPRESSION;for(var u=Object.keys(n),l=0;l<u.length;l++){var f=u[l];f.match(/^Z/)&&Object.defineProperty(t,f,{enumerable:!0,value:n[f],writable:!1})}for(var p={Z_OK:n.Z_OK,Z_STREAM_END:n.Z_STREAM_END,Z_NEED_DICT:n.Z_NEED_DICT,Z_ERRNO:n.Z_ERRNO,Z_STREAM_ERROR:n.Z_STREAM_ERROR,Z_DATA_ERROR:n.Z_DATA_ERROR,Z_MEM_ERROR:n.Z_MEM_ERROR,Z_BUF_ERROR:n.Z_BUF_ERROR,Z_VERSION_ERROR:n.Z_VERSION_ERROR},m=Object.keys(p),b=0;b<m.length;b++){var g=m[b];p[p[g]]=g}function y(e,t,s){var i=[],a=0;function n(){for(var t;null!==(t=e.read());)i.push(t),a+=t.length;e.once("readable",n)}function o(){var t,n=null;a>=d?n=new RangeError(h):t=r.concat(i,a),i=[],e.close(),s(n,t)}e.on("error",(function(t){e.removeListener("end",o),e.removeListener("readable",n),s(t)})),e.on("end",o),e.end(t),n()}function v(e,t){if("string"==typeof t&&(t=r.from(t)),!r.isBuffer(t))throw new TypeError("Not a string or buffer");var s=e._finishFlushFlag;return e._processChunk(t,s)}function w(e){if(!(this instanceof w))return new w(e);I.call(this,e,n.DEFLATE)}function k(e){if(!(this instanceof k))return new k(e);I.call(this,e,n.INFLATE)}function S(e){if(!(this instanceof S))return new S(e);I.call(this,e,n.GZIP)}function _(e){if(!(this instanceof _))return new _(e);I.call(this,e,n.GUNZIP)}function O(e){if(!(this instanceof O))return new O(e);I.call(this,e,n.DEFLATERAW)}function T(e){if(!(this instanceof T))return new T(e);I.call(this,e,n.INFLATERAW)}function x(e){if(!(this instanceof x))return new x(e);I.call(this,e,n.UNZIP)}function C(e){return e===n.Z_NO_FLUSH||e===n.Z_PARTIAL_FLUSH||e===n.Z_SYNC_FLUSH||e===n.Z_FULL_FLUSH||e===n.Z_FINISH||e===n.Z_BLOCK}function I(e,s){var i=this;if(this._opts=e=e||{},this._chunkSize=e.chunkSize||t.Z_DEFAULT_CHUNK,a.call(this,e),e.flush&&!C(e.flush))throw new Error("Invalid flush flag: "+e.flush);if(e.finishFlush&&!C(e.finishFlush))throw new Error("Invalid flush flag: "+e.finishFlush);if(this._flushFlag=e.flush||n.Z_NO_FLUSH,this._finishFlushFlag=void 0!==e.finishFlush?e.finishFlush:n.Z_FINISH,e.chunkSize&&(e.chunkSize<t.Z_MIN_CHUNK||e.chunkSize>t.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<t.Z_MIN_WINDOWBITS||e.windowBits>t.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<t.Z_MIN_LEVEL||e.level>t.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<t.Z_MIN_MEMLEVEL||e.memLevel>t.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=t.Z_FILTERED&&e.strategy!=t.Z_HUFFMAN_ONLY&&e.strategy!=t.Z_RLE&&e.strategy!=t.Z_FIXED&&e.strategy!=t.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!r.isBuffer(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new n.Zlib(s);var o=this;this._hadError=!1,this._handle.onerror=function(e,s){M(o),o._hadError=!0;var i=new Error(e);i.errno=s,i.code=t.codes[s],o.emit("error",i)};var c=t.Z_DEFAULT_COMPRESSION;"number"==typeof e.level&&(c=e.level);var d=t.Z_DEFAULT_STRATEGY;"number"==typeof e.strategy&&(d=e.strategy),this._handle.init(e.windowBits||t.Z_DEFAULT_WINDOWBITS,c,e.memLevel||t.Z_DEFAULT_MEMLEVEL,d,e.dictionary),this._buffer=r.allocUnsafe(this._chunkSize),this._offset=0,this._level=c,this._strategy=d,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!i._handle},configurable:!0,enumerable:!0})}function M(e,t){t&&i.nextTick(t),e._handle&&(e._handle.close(),e._handle=null)}function N(e){e.emit("close")}Object.defineProperty(t,"codes",{enumerable:!0,value:Object.freeze(p),writable:!1}),t.Deflate=w,t.Inflate=k,t.Gzip=S,t.Gunzip=_,t.DeflateRaw=O,t.InflateRaw=T,t.Unzip=x,t.createDeflate=function(e){return new w(e)},t.createInflate=function(e){return new k(e)},t.createDeflateRaw=function(e){return new O(e)},t.createInflateRaw=function(e){return new T(e)},t.createGzip=function(e){return new S(e)},t.createGunzip=function(e){return new _(e)},t.createUnzip=function(e){return new x(e)},t.deflate=function(e,t,s){return"function"==typeof t&&(s=t,t={}),y(new w(t),e,s)},t.deflateSync=function(e,t){return v(new w(t),e)},t.gzip=function(e,t,s){return"function"==typeof t&&(s=t,t={}),y(new S(t),e,s)},t.gzipSync=function(e,t){return v(new S(t),e)},t.deflateRaw=function(e,t,s){return"function"==typeof t&&(s=t,t={}),y(new O(t),e,s)},t.deflateRawSync=function(e,t){return v(new O(t),e)},t.unzip=function(e,t,s){return"function"==typeof t&&(s=t,t={}),y(new x(t),e,s)},t.unzipSync=function(e,t){return v(new x(t),e)},t.inflate=function(e,t,s){return"function"==typeof t&&(s=t,t={}),y(new k(t),e,s)},t.inflateSync=function(e,t){return v(new k(t),e)},t.gunzip=function(e,t,s){return"function"==typeof t&&(s=t,t={}),y(new _(t),e,s)},t.gunzipSync=function(e,t){return v(new _(t),e)},t.inflateRaw=function(e,t,s){return"function"==typeof t&&(s=t,t={}),y(new T(t),e,s)},t.inflateRawSync=function(e,t){return v(new T(t),e)},o.inherits(I,a),I.prototype.params=function(e,s,r){if(e<t.Z_MIN_LEVEL||e>t.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+e);if(s!=t.Z_FILTERED&&s!=t.Z_HUFFMAN_ONLY&&s!=t.Z_RLE&&s!=t.Z_FIXED&&s!=t.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+s);if(this._level!==e||this._strategy!==s){var a=this;this.flush(n.Z_SYNC_FLUSH,(function(){c(a._handle,"zlib binding closed"),a._handle.params(e,s),a._hadError||(a._level=e,a._strategy=s,r&&r())}))}else i.nextTick(r)},I.prototype.reset=function(){return c(this._handle,"zlib binding closed"),this._handle.reset()},I.prototype._flush=function(e){this._transform(r.alloc(0),"",e)},I.prototype.flush=function(e,t){var s=this,a=this._writableState;("function"==typeof e||void 0===e&&!t)&&(t=e,e=n.Z_FULL_FLUSH),a.ended?t&&i.nextTick(t):a.ending?t&&this.once("end",t):a.needDrain?t&&this.once("drain",(function(){return s.flush(e,t)})):(this._flushFlag=e,this.write(r.alloc(0),"",t))},I.prototype.close=function(e){M(this,e),i.nextTick(N,this)},I.prototype._transform=function(e,t,s){var i,a=this._writableState,o=(a.ending||a.ended)&&(!e||a.length===e.length);return null===e||r.isBuffer(e)?this._handle?(o?i=this._finishFlushFlag:(i=this._flushFlag,e.length>=a.length&&(this._flushFlag=this._opts.flush||n.Z_NO_FLUSH)),void this._processChunk(e,i,s)):s(new Error("zlib binding closed")):s(new Error("invalid input"))},I.prototype._processChunk=function(e,t,s){var i=e&&e.length,a=this._chunkSize-this._offset,n=0,o=this,u="function"==typeof s;if(!u){var l,f=[],p=0;this.on("error",(function(e){l=e})),c(this._handle,"zlib binding closed");do{var m=this._handle.writeSync(t,e,n,i,this._buffer,this._offset,a)}while(!this._hadError&&y(m[0],m[1]));if(this._hadError)throw l;if(p>=d)throw M(this),new RangeError(h);var b=r.concat(f,p);return M(this),b}c(this._handle,"zlib binding closed");var g=this._handle.write(t,e,n,i,this._buffer,this._offset,a);function y(d,h){if(this&&(this.buffer=null,this.callback=null),!o._hadError){var l=a-h;if(c(l>=0,"have should not go down"),l>0){var m=o._buffer.slice(o._offset,o._offset+l);o._offset+=l,u?o.push(m):(f.push(m),p+=m.length)}if((0===h||o._offset>=o._chunkSize)&&(a=o._chunkSize,o._offset=0,o._buffer=r.allocUnsafe(o._chunkSize)),0===h){if(n+=i-d,i=d,!u)return!0;var b=o._handle.write(t,e,n,i,o._buffer,o._offset,o._chunkSize);return b.callback=y,void(b.buffer=e)}if(!u)return!1;s()}}g.buffer=e,g.callback=y},o.inherits(w,I),o.inherits(k,I),o.inherits(S,I),o.inherits(_,I),o.inherits(O,I),o.inherits(T,I),o.inherits(x,I)},8764:(e,t,s)=>{"use strict";var i=s(9742),r=s(645),a=s(5826);function n(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(n()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,s){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,s);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return d(this,e,t,s)}function d(e,t,s,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,s,i){if(t.byteLength,s<0||t.byteLength<s)throw new RangeError("'offset' is out of bounds");if(t.byteLength<s+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===s&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,s):new Uint8Array(t,s,i);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=l(e,t);return e}(e,t,s,i):"string"==typeof t?function(e,t,s){"string"==typeof s&&""!==s||(s="utf8");if(!c.isEncoding(s))throw new TypeError('"encoding" must be a valid string encoding');var i=0|p(t,s),r=(e=o(e,i)).write(t,s);r!==i&&(e=e.slice(0,r));return e}(e,t,s):function(e,t){if(c.isBuffer(t)){var s=0|f(t.length);return 0===(e=o(e,s)).length||t.copy(e,0,0,s),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?o(e,0):l(e,t);if("Buffer"===t.type&&a(t.data))return l(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t){if(h(t),e=o(e,t<0?0:0|f(t)),!c.TYPED_ARRAY_SUPPORT)for(var s=0;s<t;++s)e[s]=0;return e}function l(e,t){var s=t.length<0?0:0|f(t.length);e=o(e,s);for(var i=0;i<s;i+=1)e[i]=255&t[i];return e}function f(e){if(e>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|e}function p(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var s=e.length;if(0===s)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return s;case"utf8":case"utf-8":case void 0:return F(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*s;case"hex":return s>>>1;case"base64":return U(e).length;default:if(i)return F(e).length;t=(""+t).toLowerCase(),i=!0}}function m(e,t,s){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===s||s>this.length)&&(s=this.length),s<=0)return"";if((s>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return N(this,t,s);case"utf8":case"utf-8":return x(this,t,s);case"ascii":return I(this,t,s);case"latin1":case"binary":return M(this,t,s);case"base64":return T(this,t,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,s);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function b(e,t,s){var i=e[t];e[t]=e[s],e[s]=i}function g(e,t,s,i,r){if(0===e.length)return-1;if("string"==typeof s?(i=s,s=0):s>2147483647?s=2147483647:s<-2147483648&&(s=-2147483648),s=+s,isNaN(s)&&(s=r?0:e.length-1),s<0&&(s=e.length+s),s>=e.length){if(r)return-1;s=e.length-1}else if(s<0){if(!r)return-1;s=0}if("string"==typeof t&&(t=c.from(t,i)),c.isBuffer(t))return 0===t.length?-1:y(e,t,s,i,r);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,s):Uint8Array.prototype.lastIndexOf.call(e,t,s):y(e,[t],s,i,r);throw new TypeError("val must be string, number or Buffer")}function y(e,t,s,i,r){var a,n=1,o=e.length,c=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;n=2,o/=2,c/=2,s/=2}function d(e,t){return 1===n?e[t]:e.readUInt16BE(t*n)}if(r){var h=-1;for(a=s;a<o;a++)if(d(e,a)===d(t,-1===h?0:a-h)){if(-1===h&&(h=a),a-h+1===c)return h*n}else-1!==h&&(a-=a-h),h=-1}else for(s+c>o&&(s=o-c),a=s;a>=0;a--){for(var u=!0,l=0;l<c;l++)if(d(e,a+l)!==d(t,l)){u=!1;break}if(u)return a}return-1}function v(e,t,s,i){s=Number(s)||0;var r=e.length-s;i?(i=Number(i))>r&&(i=r):i=r;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");i>a/2&&(i=a/2);for(var n=0;n<i;++n){var o=parseInt(t.substr(2*n,2),16);if(isNaN(o))return n;e[s+n]=o}return n}function w(e,t,s,i){return j(F(t,e.length-s),e,s,i)}function k(e,t,s,i){return j(function(e){for(var t=[],s=0;s<e.length;++s)t.push(255&e.charCodeAt(s));return t}(t),e,s,i)}function S(e,t,s,i){return k(e,t,s,i)}function _(e,t,s,i){return j(U(t),e,s,i)}function O(e,t,s,i){return j(function(e,t){for(var s,i,r,a=[],n=0;n<e.length&&!((t-=2)<0);++n)i=(s=e.charCodeAt(n))>>8,r=s%256,a.push(r),a.push(i);return a}(t,e.length-s),e,s,i)}function T(e,t,s){return 0===t&&s===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,s))}function x(e,t,s){s=Math.min(e.length,s);for(var i=[],r=t;r<s;){var a,n,o,c,d=e[r],h=null,u=d>239?4:d>223?3:d>191?2:1;if(r+u<=s)switch(u){case 1:d<128&&(h=d);break;case 2:128==(192&(a=e[r+1]))&&(c=(31&d)<<6|63&a)>127&&(h=c);break;case 3:a=e[r+1],n=e[r+2],128==(192&a)&&128==(192&n)&&(c=(15&d)<<12|(63&a)<<6|63&n)>2047&&(c<55296||c>57343)&&(h=c);break;case 4:a=e[r+1],n=e[r+2],o=e[r+3],128==(192&a)&&128==(192&n)&&128==(192&o)&&(c=(15&d)<<18|(63&a)<<12|(63&n)<<6|63&o)>65535&&c<1114112&&(h=c)}null===h?(h=65533,u=1):h>65535&&(h-=65536,i.push(h>>>10&1023|55296),h=56320|1023&h),i.push(h),r+=u}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);var s="",i=0;for(;i<t;)s+=String.fromCharCode.apply(String,e.slice(i,i+=C));return s}(i)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==s.g.TYPED_ARRAY_SUPPORT?s.g.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=n(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,s){return d(null,e,t,s)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,s){return function(e,t,s,i){return h(t),t<=0?o(e,t):void 0!==s?"string"==typeof i?o(e,t).fill(s,i):o(e,t).fill(s):o(e,t)}(null,e,t,s)},c.allocUnsafe=function(e){return u(null,e)},c.allocUnsafeSlow=function(e){return u(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var s=e.length,i=t.length,r=0,a=Math.min(s,i);r<a;++r)if(e[r]!==t[r]){s=e[r],i=t[r];break}return s<i?-1:i<s?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var s;if(void 0===t)for(t=0,s=0;s<e.length;++s)t+=e[s].length;var i=c.allocUnsafe(t),r=0;for(s=0;s<e.length;++s){var n=e[s];if(!c.isBuffer(n))throw new TypeError('"list" argument must be an Array of Buffers');n.copy(i,r),r+=n.length}return i},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)b(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)b(this,t,t+3),b(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)b(this,t,t+7),b(this,t+1,t+6),b(this,t+2,t+5),b(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?x(this,0,e):m.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",s=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,s).match(/.{2}/g).join(" "),this.length>s&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,s,i,r){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===s&&(s=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||s>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=s)return 0;if(i>=r)return-1;if(t>=s)return 1;if(this===e)return 0;for(var a=(r>>>=0)-(i>>>=0),n=(s>>>=0)-(t>>>=0),o=Math.min(a,n),d=this.slice(i,r),h=e.slice(t,s),u=0;u<o;++u)if(d[u]!==h[u]){a=d[u],n=h[u];break}return a<n?-1:n<a?1:0},c.prototype.includes=function(e,t,s){return-1!==this.indexOf(e,t,s)},c.prototype.indexOf=function(e,t,s){return g(this,e,t,s,!0)},c.prototype.lastIndexOf=function(e,t,s){return g(this,e,t,s,!1)},c.prototype.write=function(e,t,s,i){if(void 0===t)i="utf8",s=this.length,t=0;else if(void 0===s&&"string"==typeof t)i=t,s=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(s)?(s|=0,void 0===i&&(i="utf8")):(i=s,s=void 0)}var r=this.length-t;if((void 0===s||s>r)&&(s=r),e.length>0&&(s<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var a=!1;;)switch(i){case"hex":return v(this,e,t,s);case"utf8":case"utf-8":return w(this,e,t,s);case"ascii":return k(this,e,t,s);case"latin1":case"binary":return S(this,e,t,s);case"base64":return _(this,e,t,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,t,s);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function I(e,t,s){var i="";s=Math.min(e.length,s);for(var r=t;r<s;++r)i+=String.fromCharCode(127&e[r]);return i}function M(e,t,s){var i="";s=Math.min(e.length,s);for(var r=t;r<s;++r)i+=String.fromCharCode(e[r]);return i}function N(e,t,s){var i=e.length;(!t||t<0)&&(t=0),(!s||s<0||s>i)&&(s=i);for(var r="",a=t;a<s;++a)r+=G(e[a]);return r}function A(e,t,s){for(var i=e.slice(t,s),r="",a=0;a<i.length;a+=2)r+=String.fromCharCode(i[a]+256*i[a+1]);return r}function E(e,t,s){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>s)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,s,i,r,a){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<a)throw new RangeError('"value" argument is out of bounds');if(s+i>e.length)throw new RangeError("Index out of range")}function B(e,t,s,i){t<0&&(t=65535+t+1);for(var r=0,a=Math.min(e.length-s,2);r<a;++r)e[s+r]=(t&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function V(e,t,s,i){t<0&&(t=4294967295+t+1);for(var r=0,a=Math.min(e.length-s,4);r<a;++r)e[s+r]=t>>>8*(i?r:3-r)&255}function L(e,t,s,i,r,a){if(s+i>e.length)throw new RangeError("Index out of range");if(s<0)throw new RangeError("Index out of range")}function q(e,t,s,i,a){return a||L(e,0,s,4),r.write(e,t,s,i,23,4),s+4}function D(e,t,s,i,a){return a||L(e,0,s,8),r.write(e,t,s,i,52,8),s+8}c.prototype.slice=function(e,t){var s,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(s=this.subarray(e,t)).__proto__=c.prototype;else{var r=t-e;s=new c(r,void 0);for(var a=0;a<r;++a)s[a]=this[a+e]}return s},c.prototype.readUIntLE=function(e,t,s){e|=0,t|=0,s||E(e,t,this.length);for(var i=this[e],r=1,a=0;++a<t&&(r*=256);)i+=this[e+a]*r;return i},c.prototype.readUIntBE=function(e,t,s){e|=0,t|=0,s||E(e,t,this.length);for(var i=this[e+--t],r=1;t>0&&(r*=256);)i+=this[e+--t]*r;return i},c.prototype.readUInt8=function(e,t){return t||E(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||E(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||E(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||E(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||E(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,s){e|=0,t|=0,s||E(e,t,this.length);for(var i=this[e],r=1,a=0;++a<t&&(r*=256);)i+=this[e+a]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readIntBE=function(e,t,s){e|=0,t|=0,s||E(e,t,this.length);for(var i=t,r=1,a=this[e+--i];i>0&&(r*=256);)a+=this[e+--i]*r;return a>=(r*=128)&&(a-=Math.pow(2,8*t)),a},c.prototype.readInt8=function(e,t){return t||E(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||E(e,2,this.length);var s=this[e]|this[e+1]<<8;return 32768&s?4294901760|s:s},c.prototype.readInt16BE=function(e,t){t||E(e,2,this.length);var s=this[e+1]|this[e]<<8;return 32768&s?4294901760|s:s},c.prototype.readInt32LE=function(e,t){return t||E(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||E(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||E(e,4,this.length),r.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||E(e,4,this.length),r.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||E(e,8,this.length),r.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||E(e,8,this.length),r.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,s,i){(e=+e,t|=0,s|=0,i)||P(this,e,t,s,Math.pow(2,8*s)-1,0);var r=1,a=0;for(this[t]=255&e;++a<s&&(r*=256);)this[t+a]=e/r&255;return t+s},c.prototype.writeUIntBE=function(e,t,s,i){(e=+e,t|=0,s|=0,i)||P(this,e,t,s,Math.pow(2,8*s)-1,0);var r=s-1,a=1;for(this[t+r]=255&e;--r>=0&&(a*=256);)this[t+r]=e/a&255;return t+s},c.prototype.writeUInt8=function(e,t,s){return e=+e,t|=0,s||P(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,s){return e=+e,t|=0,s||P(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):B(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,s){return e=+e,t|=0,s||P(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):B(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,s){return e=+e,t|=0,s||P(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):V(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,s){return e=+e,t|=0,s||P(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):V(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,s,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*s-1);P(this,e,t,s,r-1,-r)}var a=0,n=1,o=0;for(this[t]=255&e;++a<s&&(n*=256);)e<0&&0===o&&0!==this[t+a-1]&&(o=1),this[t+a]=(e/n>>0)-o&255;return t+s},c.prototype.writeIntBE=function(e,t,s,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*s-1);P(this,e,t,s,r-1,-r)}var a=s-1,n=1,o=0;for(this[t+a]=255&e;--a>=0&&(n*=256);)e<0&&0===o&&0!==this[t+a+1]&&(o=1),this[t+a]=(e/n>>0)-o&255;return t+s},c.prototype.writeInt8=function(e,t,s){return e=+e,t|=0,s||P(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,s){return e=+e,t|=0,s||P(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):B(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,s){return e=+e,t|=0,s||P(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):B(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,s){return e=+e,t|=0,s||P(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):V(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,s){return e=+e,t|=0,s||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):V(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,s){return q(this,e,t,!0,s)},c.prototype.writeFloatBE=function(e,t,s){return q(this,e,t,!1,s)},c.prototype.writeDoubleLE=function(e,t,s){return D(this,e,t,!0,s)},c.prototype.writeDoubleBE=function(e,t,s){return D(this,e,t,!1,s)},c.prototype.copy=function(e,t,s,i){if(s||(s=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<s&&(i=s),i===s)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(s<0||s>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-s&&(i=e.length-t+s);var r,a=i-s;if(this===e&&s<t&&t<i)for(r=a-1;r>=0;--r)e[r+t]=this[r+s];else if(a<1e3||!c.TYPED_ARRAY_SUPPORT)for(r=0;r<a;++r)e[r+t]=this[r+s];else Uint8Array.prototype.set.call(e,this.subarray(s,s+a),t);return a},c.prototype.fill=function(e,t,s,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,s=this.length):"string"==typeof s&&(i=s,s=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!c.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<s)throw new RangeError("Out of range index");if(s<=t)return this;var a;if(t>>>=0,s=void 0===s?this.length:s>>>0,e||(e=0),"number"==typeof e)for(a=t;a<s;++a)this[a]=e;else{var n=c.isBuffer(e)?e:F(new c(e,i).toString()),o=n.length;for(a=0;a<s-t;++a)this[a+t]=n[a%o]}return this};var R=/[^+\/0-9A-Za-z-_]/g;function G(e){return e<16?"0"+e.toString(16):e.toString(16)}function F(e,t){var s;t=t||1/0;for(var i=e.length,r=null,a=[],n=0;n<i;++n){if((s=e.charCodeAt(n))>55295&&s<57344){if(!r){if(s>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(n+1===i){(t-=3)>-1&&a.push(239,191,189);continue}r=s;continue}if(s<56320){(t-=3)>-1&&a.push(239,191,189),r=s;continue}s=65536+(r-55296<<10|s-56320)}else r&&(t-=3)>-1&&a.push(239,191,189);if(r=null,s<128){if((t-=1)<0)break;a.push(s)}else if(s<2048){if((t-=2)<0)break;a.push(s>>6|192,63&s|128)}else if(s<65536){if((t-=3)<0)break;a.push(s>>12|224,s>>6&63|128,63&s|128)}else{if(!(s<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(s>>18|240,s>>12&63|128,s>>6&63|128,63&s|128)}}return a}function U(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(R,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function j(e,t,s,i){for(var r=0;r<i&&!(r+s>=t.length||r>=e.length);++r)t[r+s]=e[r];return r}},584:e=>{e.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},2956:(e,t,s)=>{"use strict";const i=s(1853),{deepExtend:r}=i,a=s(3477),{unique:n}=s(5806),o={aax:s(4273),bequant:s(9607),binance:s(9709),binancecoinm:s(1293),binanceus:s(4286),binanceusdm:s(7270),bitcoincom:s(2231),bitfinex:s(197),bitmex:s(3812),bitstamp:s(8098),bittrex:s(5995),bitvavo:s(3245),cdax:s(6208),coinbaseprime:s(5019),coinbasepro:s(2960),currencycom:s(7839),ftx:s(320),gateio:s(5872),gopax:s(1937),hitbtc:s(1004),huobijp:s(4560),huobipro:s(5556),idex:s(7931),kraken:s(2992),kucoin:s(6194),ndax:s(5810),okcoin:s(8093),okex:s(3921),phemex:s(9995),poloniex:s(7815),ripio:s(4720),upbit:s(7739),zb:s(6916)};for(const e in o){const t=i[e];Object.getPrototypeOf(t)===i.Exchange&&(Object.setPrototypeOf(t,a),Object.setPrototypeOf(t.prototype,a.prototype))}e.exports=r(i,{version:"0.7.49",Exchange:a,exchanges:n(i.exchanges.concat(Object.keys(o))).sort()},o)},4273:(e,t,s)=>{"use strict";const i=s(1853),{ArrayCache:r,ArrayCacheByTimestamp:a,ArrayCacheBySymbolById:n,NotSupported:o,AuthenticationError:c}=s(9584);e.exports=class extends i.aax{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchOHLCV:!0,watchOrderBook:!0,watchTicker:!0,watchTrades:!0,watchBalance:!0,watchOrders:!0},urls:{api:{ws:{public:"wss://realtime.aax.com/marketdata/v2/",private:"wss://stream.aax.com/notification/v2/"}}},options:{OHLCVLimit:1e3,tradesLimit:1e3,ordersLimit:1e3,myTradesLimit:1e3}})}async watchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n=this.timeframes[t],o=a.id+"@"+n+"_candles",c=this.urls.api.ws.public,d={e:"subscribe",stream:o},h=this.deepExtend(d,r),u=await this.watch(c,o,h,o);return this.newUpdates&&(i=u.getLimit(e,i)),this.filterBySinceLimit(u,s,i,0,!0)}handleOHLCV(e,t){const s=this.safeString(t,"e"),i=s.split("@"),r=this.safeString(i,0),n=this.safeString(i,1),o=this.safeMarket(r).symbol,c=[this.safeTimestamp(t,"s"),this.safeNumber(t,"o"),this.safeNumber(t,"h"),this.safeNumber(t,"l"),this.safeNumber(t,"c"),this.safeNumber(t,"v")],d=n.split("_"),h=this.safeString(d,0),u=this.findTimeframe(h);this.ohlcvs[o]=this.safeValue(this.ohlcvs,o,{});let l=this.safeValue(this.ohlcvs[o],u);if(void 0===l){const e=this.safeInteger(this.options,"OHLCVLimit",1e3);l=new a(e),this.ohlcvs[o][u]=l}l.append(c),e.resolve(l,s)}async watchTicker(e,t={}){const s="tickers";await this.loadMarkets();const i=this.market(e).id+"@"+s,r=this.urls.api.ws.public,a={e:"subscribe",stream:s},n=this.extend(a,t);return await this.watch(r,i,n,s)}handleTickers(e,t){const s=this.safeString(t,"e"),i=this.safeInteger(t,"t"),r={timestamp:i,datetime:this.iso8601(i)},a=this.parseTickers(this.safeValue(t,"tickers",[]),void 0,r),n=Object.keys(a);for(let t=0;t<n.length;t++){const i=n[t];if(i in this.markets){const t=this.market(i),r=a[i];this.tickers[i]=r;const n=t.id+"@"+s;e.resolve(r,n)}}}async watchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e).id+"@trade",a=this.urls.api.ws.public,n={e:"subscribe",stream:r},o=this.extend(n,i),c=await this.watch(a,r,o,r);return this.newUpdates&&(s=c.getLimit(e,s)),this.filterBySinceLimit(c,t,s,"timestamp",!0)}handleTrades(e,t){const s=this.safeString(t,"e"),i=s.split("@"),a=this.safeString(i,0),n=this.safeMarket(a),o=n.symbol,c=this.parseTrade(t,n);let d=this.safeValue(this.trades,o);if(void 0===d){const e=this.safeInteger(this.options,"tradesLimit",1e3);d=new r(e),this.trades[o]=d}d.append(c),e.resolve(d,s)}async watchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e);if(20!==(t=void 0===t?20:t)&&50!==t)throw new o(this.id+" watchOrderBook() accepts limit values of 20 or 50 only");const r=i.id+"@book_"+t.toString(),a=this.urls.api.ws.public,n={e:"subscribe",stream:r},c=this.extend(n,s);return(await this.watch(a,r,c,r)).limit(t)}handleDelta(e,t){const s=this.safeFloat(t,0),i=this.safeFloat(t,1);e.store(s,i)}handleDeltas(e,t){for(let s=0;s<t.length;s++)this.handleDelta(e,t[s])}handleOrderBook(e,t){const s=this.safeString(t,"e"),[i,r]=s.split("@"),a=r.split("_"),n=this.safeMarket(i).symbol,o=this.safeString(a,1),c=parseInt(o),d=this.safeInteger(t,"t"),h=this.parseOrderBook(t,n,d);let u;n in this.orderbooks?(u=this.orderbooks[n],u.reset(h)):(u=this.orderBook(h,c),this.orderbooks[n]=u),e.resolve(u,s)}requestId(){const e=this.sum(this.safeInteger(this.options,"reqid",0),1);return this.options.reqid=e,e}async handshake(e={}){const t=this.urls.api.ws.private,s=this.client(t),i="handshake",r=s.future(i);if(void 0===this.safeValue(s.subscriptions,i)){const s=this.requestId(),a={event:"#"+i,data:{},cid:s},n=this.extend(a,e),o=s.toString(),c=await this.watch(t,o,n,i);r.resolve(c)}return await r}async authenticate(e={}){const t=this.urls.api.ws.private,s=this.client(t),i="login",r=s.future(i);if(void 0===this.safeValue(s.subscriptions,i)){const s=this.milliseconds(),a=s.toString()+":"+this.apiKey,n=this.hmac(this.encode(a),this.encode(this.secret)),o=this.requestId(),d={event:i,data:{apiKey:this.apiKey,nonce:s,signature:n},cid:o},h=this.extend(d,e),u=o.toString(),l=await this.watch(t,u,h,i),f=this.safeValue(l,"data",{});if(!this.safeValue(f,"isAuthenticated",!1))throw new c(this.id+" "+this.json(l));r.resolve(l)}return await r}async watchBalance(e={}){await this.loadMarkets(),await this.handshake(e);const t=await this.authenticate(e),s=this.safeValue(t,"data",{}),i=this.safeString(s,"uid"),r=this.urls.api.ws.private,a=this.safeString2(this.options,"userId","userID",i),n=this.safeString2(e,"userId","userID",a),o=this.safeString2(this.options,"watchBalance","defaultType","spot"),c=this.safeString(e,"type",o),d=this.omit(e,["userId","userID","type"]),h="user/"+n,u=c+":balance",l={event:"#subscribe",data:{channel:h},cid:this.requestId()},f=this.deepExtend(l,d);return await this.watch(r,u,f,h)}handleBalance(e,t){const s=this.safeValue(t,"data",{}),i=this.safeString(s,"purseType"),r=this.safeValue(this.options,"accounts",{}),a=this.safeString(r,i),n=a+":balance",o=this.safeString(s,"currency"),c=this.safeCurrencyCode(o),d=this.account();d.free=this.safeNumber(s,"available"),d.used=this.safeNumber(s,"unavailable"),a in this.balance||(this.balance[a]={}),this.balance[a][c]=d,this.balance[a]=this.parseBalance(this.balance[a],!1),e.resolve(this.balance[a],n)}async watchOrders(e,t,s,i={}){await this.loadMarkets(),await this.handshake(i);const r=await this.authenticate(i),a=this.safeValue(r,"data",{}),n=this.safeString(a,"uid"),o=this.urls.api.ws.private,c=this.safeString2(this.options,"userId","userID",n),d=this.safeString2(i,"userId","userID",c),h=this.omit(i,["userId","userID"]);let u="orders";void 0!==e&&(u+=":"+e);const l={event:"#subscribe",data:{channel:"user/"+d},cid:this.requestId()},f=this.deepExtend(l,h),p=await this.watch(o,u,f,u);return this.newUpdates&&(s=p.getLimit(e,s)),this.filterBySymbolSinceLimit(p,e,t,s,!0)}handleOrder(e,t){const s="orders",i=this.safeValue(t,"data"),r=this.safeValue(i,"order"),a=void 0===r?this.parseOrder(i):this.parseOrder(r),o=this.safeString(a,"symbol"),c=this.safeString(a,"id");if(void 0!==o){if(void 0===this.orders){const e=this.safeInteger(this.options,"ordersLimit",1e3);this.orders=new n(e)}const t=this.orders,i=this.safeValue(t.hashmap,o,{}),r=this.safeValue(i,c);if(void 0!==r){const e=this.safeValue(r,"fee");void 0!==e&&(a.fee=e);const t=this.safeValue(r,"fees");void 0!==t&&(a.fees=t),a.trades=this.safeValue(r,"trades"),a.timestamp=this.safeInteger(r,"timestamp"),a.datetime=this.safeString(r,"datetime")}t.append(a),e.resolve(this.orders,s);const d="orders:"+o;e.resolve(this.orders,d)}}handleSystemStatus(e,t){return t}handleSubscriptionStatus(e,t){const s=this.safeString(t,"rid");return e.resolve(t,s),t}async pong(e,t){await e.send("#2")}handlePing(e,t){this.spawn(this.pong,e,t)}handleNotification(e,t){const s=this.safeValue(t,"event"),i={USER_FUNDS:this.handleBalance,USER_BALANCE:this.handleBalance,SPOT:this.handleOrder,FUTURES:this.handleOrder},r=this.safeValue(i,s);if(void 0!==r)return r.call(this,e,t)}handleMessage(e,t){if("string"==typeof t)"#1"===t&&this.handlePing(e,t);else{const s=this.safeString(t,"event"),i=this.safeString(t,"e");if("#publish"===s){const s=this.safeValue(t,"data",{}),i=this.safeValue(s,"data",{});this.handleNotification(e,i)}else if(void 0===i){void 0!==this.safeString(t,"rid")&&this.handleSubscriptionStatus(e,t)}else{const s=i.split("@"),r=s.length,a={reply:this.handleSubscriptionStatus,system:this.handleSystemStatus,book:this.handleOrderBook,trade:this.handleTrades,empty:void 0,tickers:this.handleTickers,candles:this.handleOHLCV,done:this.handleOrder};let n;if(r>1){const e=this.safeString(s,1).split("_"),t=this.safeString(e,0),i=this.safeString(e,1);n=this.safeValue2(a,t,i)}else{const e=this.safeString(s,0);n=this.safeValue(a,e)}if(void 0!==n)return n.call(this,e,t)}}}}},9584:e=>{"use strict";class t extends Array{constructor(e){super(),Object.defineProperty(this,"maxSize",{__proto__:null,value:e,writable:!0})}clear(){this.length=0}}class s extends t{constructor(e){super(e),Object.defineProperty(this,"newUpdatesBySymbol",{__proto__:null,value:{},writable:!0}),Object.defineProperty(this,"clearUpdatesBySymbol",{__proto__:null,value:{},writable:!0})}getLimit(e,t){return void 0===e&&(e="all"),this.clearUpdatesBySymbol[e]=!0,void 0===t?this.newUpdatesBySymbol[e]:void 0===this.newUpdatesBySymbol[e]?t:Math.min(this.newUpdates,t)}append(e){this.maxSize&&this.length===this.maxSize&&this.shift(),this.push(e),this.clearUpdatesBySymbol[e.symbol]&&(this.clearUpdatesBySymbol[e.symbol]=!1,this.newUpdatesBySymbol[e.symbol]=0),this.clearUpdatesBySymbol.all&&(this.clearUpdatesBySymbol.all=!1,this.newUpdatesBySymbol.all=0),this.newUpdatesBySymbol[e.symbol]=(this.newUpdatesBySymbol[e.symbol]||0)+1,this.newUpdatesBySymbol.all=(this.newUpdatesBySymbol.all||0)+1}}e.exports={ArrayCache:s,ArrayCacheByTimestamp:class extends t{constructor(e){super(e),Object.defineProperty(this,"hashmap",{__proto__:null,value:{},writable:!0}),Object.defineProperty(this,"sizeTracker",{__proto__:null,value:new Set,writable:!0}),Object.defineProperty(this,"newUpdates",{__proto__:null,value:0,writable:!0}),Object.defineProperty(this,"clearUpdates",{__proto__:null,value:!1,writable:!0})}getLimit(e,t){return this.clearUpdates=!0,void 0===t?this.newUpdates:Math.min(this.newUpdates,t)}append(e){if(e[0]in this.hashmap){const t=this.hashmap[e[0]];if(t!==e)for(const s in e)t[s]=e[s]}else{if(this.hashmap[e[0]]=e,this.maxSize&&this.length===this.maxSize){const e=this.shift();delete this.hashmap[e[0]]}this.push(e)}this.clearUpdates&&(this.clearUpdates=!1,this.sizeTracker.clear()),this.sizeTracker.add(e[0]),this.newUpdates=this.sizeTracker.size}},ArrayCacheBySymbolById:class extends s{constructor(e){super(e),Object.defineProperty(this,"hashmap",{__proto__:null,value:{},writable:!0})}append(e){const t=this.hashmap[e.symbol]=this.hashmap[e.symbol]||{};if(e.id in t){const s=t[e.id];if(s!==e)for(const t in e)s[t]=e[t];e=s;const i=this.findIndex((t=>t.id===e.id));this.splice(i,1)}else t[e.id]=e;if(this.maxSize&&this.length===this.maxSize){const e=this.shift();delete this.hashmap[e.symbol][e.id]}this.push(e),this.clearUpdatesBySymbol[e.symbol]&&(this.clearUpdatesBySymbol[e.symbol]=!1,this.newUpdatesBySymbol[e.symbol]=0),this.clearUpdatesBySymbol.all&&(this.clearUpdatesBySymbol.all=!1,this.newUpdatesBySymbol.all=0),this.newUpdatesBySymbol[e.symbol]=(this.newUpdatesBySymbol[e.symbol]||0)+1,this.newUpdatesBySymbol.all=(this.newUpdatesBySymbol.all||0)+1}}}},1953:(e,t,s)=>{"use strict";var i=s(8764).Buffer;const r=s(1853),{isNode:a,isJsonEncodedObject:n,RequestTimeout:o,NetworkError:c,NotSupported:d,deepExtend:h,milliseconds:u}=r,{inflate:l,gunzip:f}=s(5858),p=s(3744);e.exports=class{constructor(e,t,s,i,r,a={}){const n={url:e,onMessageCallback:t,onErrorCallback:s,onCloseCallback:i,onConnectedCallback:r,verbose:!1,protocols:void 0,options:void 0,futures:{},subscriptions:{},connected:void 0,error:void 0,connectionStarted:void 0,connectionEstablished:void 0,connectionTimer:void 0,connectionTimeout:1e4,pingInterval:void 0,ping:void 0,keepAlive:3e4,maxPingPongMisses:2,connection:void 0,startedConnecting:!1,gunzip:!1,inflate:!1};Object.assign(this,h(n,a)),this.connected=p()}future(e){if(Array.isArray(e)){const t=e[0];if(!this.futures[t]){const s=p();this.futures[t]=s;for(let t=1;t<e.length;t++){const i=e[t];this.futures[i]=s}}return this.futures[t]}return this.futures[e]||(this.futures[e]=p()),this.futures[e]}resolve(e,t){if(this.verbose&&void 0===t&&this.print(new Date,"resolve received undefined messageHash"),this.futures[t]){this.futures[t].resolve(e),delete this.futures[t]}return e}reject(e,t){if(t){if(this.futures[t]){this.futures[t].reject(e),delete this.futures[t]}}else{const t=Object.keys(this.futures);for(let s=0;s<t.length;s++)this.reject(e,t[s])}return e}print(...e){console.log(...e)}connect(e=0){throw new d("connect() not implemented yet")}isOpen(){throw new d("isOpen() not implemented yet")}reset(e){this.clearConnectionTimeout(),this.clearPingInterval(),this.connected.reject(e),this.reject(e)}onConnectionTimeout(){if(!this.isOpen()){const e=new o("Connection to "+this.url+" failed due to a connection timeout");this.onError(e),this.connection.close(1006)}}setConnectionTimeout(){if(this.connectionTimeout){const e=this.onConnectionTimeout.bind(this);this.connectionTimer=setTimeout(e,this.connectionTimeout)}}clearConnectionTimeout(){this.connectionTimer&&(this.connectionTimer=clearTimeout(this.connectionTimer))}setPingInterval(){if(this.keepAlive){const e=this.onPingInterval.bind(this);this.pingInterval=setInterval(e,this.keepAlive)}}clearPingInterval(){this.pingInterval&&(this.pingInterval=clearInterval(this.pingInterval))}onPingInterval(){if(this.keepAlive&&this.isOpen()){const e=u();this.lastPong=this.lastPong||e,this.lastPong+this.keepAlive*this.maxPingPongMisses<e?this.onError(new o("Connection to "+this.url+" timed out due to a ping-pong keepalive missing on time")):this.ping?this.send(this.ping(this)):a?this.connection.ping():this.lastPong=e}}onOpen(){this.verbose&&this.print(new Date,"onOpen"),this.connectionEstablished=u(),this.connected.resolve(this.url),this.clearConnectionTimeout(),this.setPingInterval(),this.onConnectedCallback(this)}onPing(){this.verbose&&this.print(new Date,"onPing")}onPong(){this.lastPong=u(),this.verbose&&this.print(new Date,"onPong")}onError(e){this.verbose&&this.print(new Date,"onError",e.message),e instanceof r.BaseError||(e=new r.NetworkError(e.message)),this.error=e,this.reset(this.error),this.onErrorCallback(this,this.error)}onClose(e){this.verbose&&this.print(new Date,"onClose",e),this.error||this.reset(new c("connection closed by remote server, closing code "+String(e.code))),this.onCloseCallback(this,e)}onUpgrade(e){this.verbose&&this.print(new Date,"onUpgrade")}send(e){this.verbose&&this.print(new Date,"sending",e),e="string"==typeof e?e:JSON.stringify(e),this.connection.send(e)}close(){throw new d("close() not implemented yet")}onMessage(e){e=e.data,this.gunzip?e=f(e):this.inflate&&(e=l(e));try{e instanceof i&&(e=e.toString()),n(e)&&(e=JSON.parse(e.replace(/:(\d{15,}),/g,':"$1",'))),this.verbose&&this.print(new Date,"onMessage",e)}catch(e){this.print(new Date,"onMessage JSON.parse",e)}this.onMessageCallback(this,e)}}},3477:(e,t,s)=>{"use strict";const i=s(1853),r=s(2088),{OrderBook:a,IndexedOrderBook:n,CountedOrderBook:o}=s(7569),c=s(5858);e.exports=class extends i.Exchange{constructor(e={}){super(e),this.newUpdates=e.newUpdates||!1}inflate(e){return c.inflate(e)}inflate64(e){return c.inflate64(e)}gunzip(e){return c.gunzip(e)}orderBook(e={},t=Number.MAX_SAFE_INTEGER){return new a(e,t)}indexedOrderBook(e={},t=Number.MAX_SAFE_INTEGER){return new n(e,t)}countedOrderBook(e={},t=Number.MAX_SAFE_INTEGER){return new o(e,t)}client(e){if(this.clients=this.clients||{},!this.clients[e]){const t=this.handleMessage.bind(this),s=this.onError.bind(this),a=this.onClose.bind(this),n=this.onConnected.bind(this),o=this.safeValue(this.options,"ws",{}),c=this.extend(this.streaming,{print:this.print?this.print.bind(this):this.print,ping:this.ping?this.ping.bind(this):this.ping,verbose:this.verbose,throttle:i.throttle(this.tokenBucket)},o);this.clients[e]=new r(e,t,s,a,n,c)}return this.clients[e]}spawn(e,...t){e.apply(this,t).catch((e=>{}))}delay(e,t,...s){setTimeout((()=>{this.spawn(t,...s)}),e)}watch(e,t,s,i,r){const a=this.client(e),n=a.future(t);return a.connect(0).then((()=>{if(!a.subscriptions[i]){a.subscriptions[i]=r||!0;const e=this.safeValue(this.options,"ws"),t=this.safeValue(e,"rateLimit",this.rateLimit);s&&(this.enableRateLimit&&a.throttle?a.throttle(t).then((()=>{a.send(s)})).catch((e=>{throw e})):a.send(s))}})).catch((e=>{})),n}onConnected(e,t){}onError(e,t){e.url in this.clients&&this.clients[e.url].error&&delete this.clients[e.url]}onClose(e,t){e.error||this.clients[e.url]&&delete this.clients[e.url]}async close(){const e=Object.values(this.clients||{});for(let t=0;t<e.length;t++){const s=e[t];delete this.clients[s.url],await s.close()}}findTimeframe(e){const t=Object.keys(this.timeframes);for(let s=0;s<t.length;s++){const i=t[s];if(this.timeframes[i]===e)return i}}}},3744:e=>{"use strict";e.exports=function(){let e,t;const s=new Promise(((s,i)=>{e=s,t=i}));return s.resolve=function(){e.apply(this,arguments)},s.reject=function(){t.apply(this,arguments)},s}},7569:(e,t,s)=>{"use strict";const{iso8601:i}=s(9764),{extend:r,deepExtend:a}=s(5206),{Asks:n,Bids:o,CountedAsks:c,CountedBids:d,IndexedAsks:h,IndexedBids:u,IncrementalAsks:l,IncrementalBids:f,IncrementalIndexedAsks:p,IncrementalIndexedBids:m}=s(2499);class b{constructor(e={},t){Object.defineProperty(this,"cache",{__proto__:null,value:[],writable:!0}),t=t||Number.MAX_SAFE_INTEGER;const s={bids:[],asks:[],timestamp:void 0,datetime:void 0,nonce:void 0},a=Object.entries(r(s,e));for(let e=0;e<a.length;e++){const[t,s]=a[e];this[t]=s}"Array"===this.asks.constructor.name&&(this.asks=new n(this.asks,t)),"Array"===this.bids.constructor.name&&(this.bids=new o(this.bids,t)),this.timestamp&&(this.datetime=i(this.timestamp))}limit(e){return this.asks.limit(e),this.bids.limit(e),this}update(e){return void 0!==e.nonce&&void 0!==this.nonce&&e.nonce<=this.nonce?this:(this.nonce=e.nonce,this.timestamp=e.timestamp,this.datetime=i(this.timestamp),this.reset(e))}reset(e={}){if(this.asks.index.clear(),e.asks)for(let t=0;t<e.asks.length;t++)this.asks.storeArray(e.asks[t]);if(this.bids.index.clear(),e.bids)for(let t=0;t<e.bids.length;t++)this.bids.storeArray(e.bids[t]);return this.nonce=e.nonce,this.timestamp=e.timestamp,this.datetime=i(this.timestamp),this}}e.exports={OrderBook:b,CountedOrderBook:class extends b{constructor(e={},t){super(r(e,{asks:new c(e.asks||[],t),bids:new d(e.bids||[],t)}))}},IndexedOrderBook:class extends b{constructor(e={},t){super(r(e,{asks:new h(e.asks||[],t),bids:new u(e.bids||[],t)}))}},IncrementalOrderBook:class extends b{constructor(e={},t){super(r(e,{asks:new l(e.asks||[],t),bids:new f(e.bids||[],t)}))}},IncrementalIndexedOrderBook:class extends b{constructor(e={},t){super(r(e,{asks:new p(e.asks||[],t),bids:new m(e.bids||[],t)}))}}}},2499:e=>{"use strict";class t extends Array{constructor(e=[],t,s=0){super(e.length),Object.defineProperty(this,"index",{__proto__:null,value:new Map,writable:!0}),Object.defineProperty(this,"depth",{__proto__:null,value:t||Number.MAX_SAFE_INTEGER,writable:!0}),Object.defineProperty(this,"limitType",{__proto__:null,value:s,writable:!0});for(let t=0;t<e.length;t++)this.storeArray(e[t].slice())}store(e,t){t?this.index.set(e,t):this.index.delete(e)}storeArray(e){const t=e[0],s=e[1];this.store(t,s)}limit(e){e=e||Number.MAX_SAFE_INTEGER;const t=0===this.limitType?this.index.entries():this.index.values(),s=Array.from(t).sort(this.compare),i=Math.min(this.depth,s.length);this.index=new Map;for(let e=0;e<i;e++){this[e]=s[e];const t=s[e][0];if(0===this.limitType){const i=s[e][1];this.index.set(t,i)}else{const i=s[e][2];1===this.limitType?this.index.set(t,s[e]):this.index.set(i,s[e])}}return this.length=Math.min(i,e),this}}class s extends t{constructor(e=[],t=Number.MAX_SAFE_INTEGER){super(e,t,1)}store(e,t,s){s&&t?this.index.set(e,[e,t,s]):this.index.delete(e)}storeArray(e){const[t,s,i]=e;i&&s?this.index.set(t,e):this.index.delete(t)}}class i extends t{constructor(e=[],t=Number.MAX_SAFE_INTEGER){super(e,t,2)}store(e,t,s){if(t){const i=this.index.get(s);if(i)return i[0]=e||i[0],void(i[1]=t);this.index.set(s,[e,t,s])}else this.index.delete(s)}storeArray(e){const[t,s,i]=e;if(s){const r=this.index.get(i);if(r)return r[0]=t||r[0],void(r[1]=s);this.index.set(i,e)}else this.index.delete(i)}}class r extends t{constructor(e=[],t=Number.MAX_SAFE_INTEGER){super(e,t,0)}store(e,t){(t=(this.index.get(e)||0)+t)<=0?this.index.delete(e):this.index.set(e,t)}storeArray(e){const t=e[0],s=(this.index.get(t)||0)+e[1];s<=0?this.index.delete(t):this.index.set(t,s)}}class a extends i{store(e,t,s){if(t){const i=this.index.get(s);if(i&&t+i[1]>=0)return i[0]=e||i[0],void(i[1]=t+i[1]);this.index.set(s,[e,t,s])}else this.index.delete(s)}storeArray(e){const[t,s,i]=e;if(s){const e=this.index.get(i);if(e&&s+e[1]>=0)return e[0]=t||e[0],void(e[1]=s+e[1]);this.index.set(i,[t,s,i])}else this.index.delete(i)}}e.exports={Asks:class extends t{compare(e,t){return e[0]-t[0]}},Bids:class extends t{compare(e,t){return t[0]-e[0]}},OrderBookSide:t,CountedAsks:class extends s{compare(e,t){return e[0]-t[0]}},CountedBids:class extends s{compare(e,t){return t[0]-e[0]}},CountedOrderBookSide:s,IndexedAsks:class extends i{compare(e,t){return e[0]-t[0]}},IndexedBids:class extends i{compare(e,t){return t[0]-e[0]}},IndexedOrderBookSide:i,IncrementalAsks:class extends r{compare(e,t){return e[0]-t[0]}},IncrementalBids:class extends r{compare(e,t){return t[0]-e[0]}},IncrementalOrderBookSide:r,IncrementalIndexedAsks:class extends a{compare(e,t){return e[0]-t[0]}},IncrementalIndexedBids:class extends a{compare(e,t){return t[0]-e[0]}},IncrementalIndexedOrderBookSide:a,LIMIT_BY_KEY:0,LIMIT_BY_VALUE_PRICE_KEY:1,LIMIT_BY_VALUE_INDEX_KEY:2}},2088:(e,t,s)=>{"use strict";const i=s(1853),{sleep:r,isNode:a,milliseconds:n}=i,o=s(1953),c=a?s(7026):window.WebSocket;e.exports=class extends o{createConnection(){this.verbose&&this.print(new Date,"connecting to",this.url),this.connectionStarted=n(),this.setConnectionTimeout(),this.connection=new c(this.url,this.protocols,this.options),this.connection.onopen=this.onOpen.bind(this),this.connection.onmessage=this.onMessage.bind(this),this.connection.onerror=this.onError.bind(this),this.connection.onclose=this.onClose.bind(this),a&&this.connection.on("ping",this.onPing.bind(this)).on("pong",this.onPong.bind(this)).on("upgrade",this.onUpgrade.bind(this))}connect(e=0){return this.startedConnecting||(this.startedConnecting=!0,e?r(e).then(this.createConnection.bind(this)):this.createConnection()),this.connected}isOpen(){return this.connection.readyState===c.OPEN}close(){if(this.connection instanceof c)return this.connection.close()}}},5858:(e,t,s)=>{"use strict";var i=s(8764).Buffer;const{inflateRawSync:r,gunzipSync:a}=s(2635);function n(e){return r(e).toString()}e.exports={inflate:n,inflate64:function(e){return n(i.from(e,"base64"))},gunzip:function(e){return a(e).toString()}}},9607:(e,t,s)=>{"use strict";const i=s(1004);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bequant",name:"Bequant",countries:["MT"],pro:!0,urls:{logo:"https://user-images.githubusercontent.com/1294454/55248342-a75dfe00-525a-11e9-8aa2-05e9dca943c6.jpg",api:{public:"https://api.bequant.io",private:"https://api.bequant.io"},www:"https://bequant.io",doc:["https://api.bequant.io/"],fees:["https://bequant.io/fees-and-limits"],referral:"https://bequant.io"}})}}},9709:(e,t,s)=>{"use strict";const i=s(1853),{ExchangeError:r}=s(3449),{ArrayCache:a,ArrayCacheByTimestamp:n,ArrayCacheBySymbolById:o}=s(9584);e.exports=class extends i.binance{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchBalance:!0,watchMyTrades:!0,watchOHLCV:!0,watchOrderBook:!0,watchOrders:!0,watchTicker:!0,watchTickers:!1,watchTrades:!0},urls:{test:{ws:{spot:"wss://testnet.binance.vision/ws",margin:"wss://testnet.binance.vision/ws",future:"wss://stream.binancefuture.com/ws",delivery:"wss://dstream.binancefuture.com/ws"}},api:{ws:{spot:"wss://stream.binance.com:9443/ws",margin:"wss://stream.binance.com:9443/ws",future:"wss://fstream.binance.com/ws",delivery:"wss://dstream.binance.com/ws"}}},options:{watchOrderBookRate:100,tradesLimit:1e3,ordersLimit:1e3,OHLCVLimit:1e3,requestId:{},watchOrderBookLimit:1e3,watchTrades:{name:"trade"},watchTicker:{name:"ticker"},wallet:"wb",futureBalance:{},listenKeyRefreshRate:12e5}})}requestId(e){const t=this.safeValue(this.options,"requestId",{}),s=this.safeInteger(t,e,0),i=this.sum(s,1);return this.options.requestId[e]=i,i}async watchOrderBook(e,t,s={}){if(void 0!==t&&5!==t&&10!==t&&20!==t&&50!==t&&100!==t&&500!==t&&1e3!==t)throw new r(this.id+" watchOrderBook limit argument must be undefined, 5, 10, 20, 50, 100, 500 or 1000");await this.loadMarkets();const i=this.safeString2(this.options,"watchOrderBook","defaultType","spot"),a=this.safeString(s,"type",i),n=this.omit(s,"type"),o="depth",c=this.market(e).lowercaseId+"@"+o,d=this.urls.api.ws[a],h=this.requestId(d),u={method:"SUBSCRIBE",params:[c+"@"+this.safeString(this.options,"watchOrderBookRate","100")+"ms"],id:h},l={id:h.toString(),messageHash:c,name:o,symbol:e,method:this.handleOrderBookSubscription,limit:t,type:a,params:s},f=this.extend(u,n);return(await this.watch(d,c,f,c,l)).limit(t)}async fetchOrderBookSnapshot(e,t,s){const i=this.safeInteger(this.options,"watchOrderBookLimit",1e3),r=this.safeValue(s,"type"),a=this.safeString(s,"symbol"),n=this.safeString(s,"messageHash"),o=this.safeInteger(s,"limit",i),c=this.safeValue(s,"params"),d=await this.fetchOrderBook(a,o,c),h=this.safeValue(this.orderbooks,a);if(void 0===h)return;h.reset(d);const u=h.cache;for(let t=0;t<u.length;t++){const s=u[t],i=this.safeInteger(s,"U"),a=this.safeInteger(s,"u"),n=this.safeInteger(s,"pu");if("future"===r){if(a<h.nonce)continue;(i<=h.nonce&&a>=h.nonce||n===h.nonce)&&this.handleOrderBookMessage(e,s,h)}else{if(a<=h.nonce)continue;i-1<=h.nonce&&a-1>=h.nonce&&this.handleOrderBookMessage(e,s,h)}}this.orderbooks[a]=h,e.resolve(h,n)}handleDelta(e,t){const s=this.safeFloat(t,0),i=this.safeFloat(t,1);e.store(s,i)}handleDeltas(e,t){for(let s=0;s<t.length;s++)this.handleDelta(e,t[s])}handleOrderBookMessage(e,t,s){const i=this.safeInteger(t,"u");this.handleDeltas(s.asks,this.safeValue(t,"a",[])),this.handleDeltas(s.bids,this.safeValue(t,"b",[])),s.nonce=i;const r=this.safeInteger(t,"E");return s.timestamp=r,s.datetime=this.iso8601(r),s}handleOrderBook(e,t){const s=this.safeString(t,"s"),i=this.safeMarket(s),a=i.symbol,n=i.lowercaseId+"@depth",o=this.safeValue(this.orderbooks,a);if(void 0===o)return;const c=this.safeInteger(o,"nonce");if(void 0===c)o.cache.push(t);else try{const s=this.safeInteger(t,"U"),i=this.safeInteger(t,"u"),a=this.safeInteger(t,"pu");if(void 0===a){if(i>o.nonce){let a;if(a=void 0===this.safeInteger(o,"timestamp")?s-1<=o.nonce&&i-1>=o.nonce:s-1===o.nonce,!a)throw new r(this.id+" handleOrderBook received an out-of-order nonce");this.handleOrderBookMessage(e,t,o),c<o.nonce&&e.resolve(o,n)}}else if(i>=o.nonce){if(!(s<=o.nonce||a===o.nonce))throw new r(this.id+" handleOrderBook received an out-of-order nonce");this.handleOrderBookMessage(e,t,o),c<=o.nonce&&e.resolve(o,n)}}catch(t){delete this.orderbooks[a],delete e.subscriptions[n],e.reject(t,n)}}handleOrderBookSubscription(e,t,s){const i=this.safeInteger(this.options,"watchOrderBookLimit",1e3),r=this.safeString(s,"symbol"),a=this.safeInteger(s,"limit",i);r in this.orderbooks&&delete this.orderbooks[r],this.orderbooks[r]=this.orderBook({},a),this.spawn(this.fetchOrderBookSnapshot,e,t,s)}handleSubscriptionStatus(e,t){const s=this.safeString(t,"id"),i=this.indexBy(e.subscriptions,"id"),r=this.safeValue(i,s,{}),a=this.safeValue(r,"method");return void 0!==a&&a.call(this,e,t,r),t}async watchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a=this.safeValue(this.options,"watchTrades",{}),n=this.safeString(a,"name","trade"),o=r.lowercaseId+"@"+n,c=this.safeString(this.options,"defaultType","spot"),d=this.safeString2(a,"type","defaultType",c),h=this.safeString(i,"type",d),u=this.omit(i,"type"),l=this.urls.api.ws[h],f=this.requestId(l),p={method:"SUBSCRIBE",params:[o],id:f},m={id:f},b=await this.watch(l,o,this.extend(p,u),o,m);return this.newUpdates&&(s=b.getLimit(e,s)),this.filterBySinceLimit(b,t,s,"timestamp",!0)}parseTrade(e,t){const s="TRADE"===this.safeString(e,"x");if(!s)return super.parseTrade(e,t);const i=this.safeString2(e,"t","a"),r=this.safeInteger(e,"T"),a=this.safeFloat2(e,"L","p");let n=this.safeFloat(e,"q");s&&(n=this.safeFloat(e,"l",n));let o=this.safeFloat(e,"Y");void 0===o&&void 0!==a&&void 0!==n&&(o=a*n);const c=this.safeString(e,"s"),d=this.safeSymbol(c);let h,u=this.safeStringLower(e,"S");const l=this.safeString(e,"i");let f;"m"in e&&(void 0===u&&(u=e.m?"sell":"buy"),h=e.m?"maker":"taker");const p=this.safeFloat(e,"n");if(void 0!==p){const t=this.safeString(e,"N");f={cost:p,currency:this.safeCurrencyCode(t)}}const m=this.safeStringLower(e,"o");return{info:e,timestamp:r,datetime:this.iso8601(r),symbol:d,id:i,order:l,type:m,takerOrMaker:h,side:u,price:a,amount:n,cost:o,fee:f}}handleTrade(e,t){const s=this.safeString(t,"s"),i=this.safeMarket(s),r=i.symbol,n=this.safeStringLower(t,"s")+"@"+this.safeString(t,"e"),o=this.parseTrade(t,i);let c=this.safeValue(this.trades,r);if(void 0===c){const e=this.safeInteger(this.options,"tradesLimit",1e3);c=new a(e)}c.append(o),this.trades[r]=c,e.resolve(c,n)}async watchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e).lowercaseId+"@kline_"+this.timeframes[t],n=this.safeValue(this.options,"watchOHLCV",{}),o=this.safeString(this.options,"defaultType","spot"),c=this.safeString2(n,"type","defaultType",o),d=this.safeString(r,"type",c),h=this.omit(r,"type"),u=this.urls.api.ws[d],l=this.requestId(u),f={method:"SUBSCRIBE",params:[a],id:l},p={id:l},m=await this.watch(u,a,this.extend(f,h),a,p);return this.newUpdates&&(i=m.getLimit(e,i)),this.filterBySinceLimit(m,s,i,0,!0)}handleOHLCV(e,t){const s=this.safeString(t,"s"),i=this.safeStringLower(t,"s"),r=this.safeString(t,"e"),a=this.safeValue(t,"k"),o=this.safeString(a,"i"),c=this.findTimeframe(o),d=i+"@"+r+"_"+o,h=[this.safeInteger(a,"t"),this.safeFloat(a,"o"),this.safeFloat(a,"h"),this.safeFloat(a,"l"),this.safeFloat(a,"c"),this.safeFloat(a,"v")],u=this.safeSymbol(s);this.ohlcvs[u]=this.safeValue(this.ohlcvs,u,{});let l=this.safeValue(this.ohlcvs[u],c);if(void 0===l){const e=this.safeInteger(this.options,"OHLCVLimit",1e3);l=new n(e),this.ohlcvs[u][c]=l}l.append(h),e.resolve(l,d)}async watchTicker(e,t={}){await this.loadMarkets();const s=this.market(e).lowercaseId,i=this.safeValue(this.options,"watchTicker",{}),r=s+"@"+this.safeString(i,"name","ticker"),a=this.safeString2(this.options,"defaultType","spot"),n=this.safeString2(i,"type","defaultType",a),o=this.safeString(t,"type",n),c=this.omit(t,"type"),d=this.urls.api.ws[o],h=this.requestId(d),u={method:"SUBSCRIBE",params:[r],id:h},l={id:h};return await this.watch(d,r,this.extend(u,c),r,l)}handleTicker(e,t){let s=this.safeString(t,"e","bookTicker");"24hrTicker"===s&&(s="ticker");const i=this.safeStringLower(t,"s")+"@"+s,r=this.safeInteger(t,"C",this.milliseconds()),a=this.safeString(t,"s"),n=this.safeSymbol(a),o=this.safeFloat(t,"c"),c={symbol:n,timestamp:r,datetime:this.iso8601(r),high:this.safeFloat(t,"h"),low:this.safeFloat(t,"l"),bid:this.safeFloat(t,"b"),bidVolume:this.safeFloat(t,"B"),ask:this.safeFloat(t,"a"),askVolume:this.safeFloat(t,"A"),vwap:this.safeFloat(t,"w"),open:this.safeFloat(t,"o"),close:o,last:o,previousClose:this.safeFloat(t,"x"),change:this.safeFloat(t,"p"),percentage:this.safeFloat(t,"P"),average:void 0,baseVolume:this.safeFloat(t,"v"),quoteVolume:this.safeFloat(t,"q"),info:t};this.tickers[n]=c,e.resolve(c,i)}async authenticate(e={}){const t=this.milliseconds();let s=this.safeString2(this.options,"defaultType","authenticate","spot");s=this.safeString(e,"type",s);const i=this.safeValue(this.options,s,{}),r=this.safeInteger(i,"lastAuthenticatedTime",0),a=this.safeInteger(this.options,"listenKeyRefreshRate",12e5);if(t-r>this.sum(a,1e4)){let r="publicPostUserDataStream";"future"===s?r="fapiPrivatePostListenKey":"delivery"===s?r="dapiPrivatePostListenKey":"margin"===s&&(r="sapiPostUserDataStream");const n=await this[r]();this.options[s]=this.extend(i,{listenKey:this.safeString(n,"listenKey"),lastAuthenticatedTime:t}),this.delay(a,this.keepAliveListenKey,e)}}async keepAliveListenKey(e={}){let t=this.safeString2(this.options,"defaultType","authenticate","spot");t=this.safeString(e,"type",t);const s=this.safeValue(this.options,t,{}),i=this.safeString(s,"listenKey");let r="publicPutUserDataStream";"future"===t?r="fapiPrivatePutListenKey":"delivery"===t?r="dapiPrivatePutListenKey":"margin"===t&&(r="sapiPutUserDataStream");const a={listenKey:i},n=this.milliseconds(),o=this.omit(e,"type");try{await this[r](this.extend(a,o))}catch(e){const i=this.urls.api.ws[t]+"/"+this.options[t].listenKey,r=this.client(i),a=Object.keys(r.futures);for(let t=0;t<a.length;t++){const s=a[t];r.reject(e,s)}return void(this.options[t]=this.extend(s,{listenKey:void 0,lastAuthenticatedTime:0}))}this.options[t]=this.extend(s,{listenKey:i,lastAuthenticatedTime:n});const c=Object.values(this.clients),d=this.safeInteger(this.options,"listenKeyRefreshRate",12e5);for(let s=0;s<c.length;s++){const i=c[s],r=Object.keys(i.subscriptions);for(let s=0;s<r.length;s++){if(r[s]===t)return this.delay(d,this.keepAliveListenKey,e)}}}async watchBalance(e={}){await this.loadMarkets(),await this.authenticate(e);const t=this.safeString2(this.options,"watchBalance","defaultType","spot"),s=this.safeString(e,"type",t),i=this.urls.api.ws[s]+"/"+this.options[s].listenKey;s in this.client(i).subscriptions||(this.balance[s]={});const r=s+":balance";return await this.watch(i,r,undefined,s)}handleBalance(e,t){const s=this.safeValue(this.options,"wallet","wb"),i=Object.keys(e.subscriptions)[0],r=i+":balance";t=this.safeValue(t,"a",t),this.balance[i].info=t;const a=this.safeValue(t,"B",[]);for(let e=0;e<a.length;e++){const t=a[e],r=this.safeString(t,"a"),n=this.safeCurrencyCode(r),o=this.account();o.free=this.safeString(t,"f"),o.used=this.safeString(t,"l"),o.total=this.safeString(t,s),this.balance[i][n]=o}this.balance[i]=this.parseBalance(this.balance[i],!1),e.resolve(this.balance[i],r)}async watchOrders(e,t,s,i={}){await this.loadMarkets(),await this.authenticate(i);const r=this.safeString2(this.options,"watchOrders","defaultType","spot"),a=this.safeString(i,"type",r),n=this.urls.api.ws[a]+"/"+this.options[a].listenKey;let o="orders";void 0!==e&&(o+=":"+e);a in this.client(n).subscriptions||(this.balance[a]={});const c=await this.watch(n,o,undefined,a);return this.newUpdates&&(s=c.getLimit(e,s)),this.filterBySymbolSinceLimit(c,e,t,s,!0)}parseWsOrder(e,t){const s=this.safeString(e,"x"),i=this.safeString(e,"i"),r=this.safeString(e,"s"),a=this.safeSymbol(r);let n=this.safeInteger(e,"O");const o=this.safeInteger(e,"T");let c,d;"NEW"===s?void 0===n&&(n=o):"TRADE"===s&&(c=o);const h=this.safeFloat(e,"n");if(void 0!==h&&h>0){const t=this.safeString(e,"N");d={cost:h,currency:this.safeCurrencyCode(t)}}const u=this.safeFloat(e,"p"),l=this.safeFloat(e,"q"),f=this.safeStringLower(e,"S"),p=this.safeStringLower(e,"o"),m=this.safeFloat(e,"z"),b=this.safeFloat(e,"Z");let g=l,y=this.safeFloat(e,"ap"),v=b;void 0!==m&&(void 0===v&&void 0!==u&&(v=m*u),void 0!==l&&(g=Math.max(l-m,0)),void 0===y&&void 0!==b&&m>0&&(y=b/m));const w=this.safeString(e,"X"),k=this.parseOrderStatus(w),S=this.safeString(e,"c"),_=this.safeFloat2(e,"P","sp"),O=this.safeString(e,"f");return{info:e,symbol:a,id:i,clientOrderId:S,timestamp:n,datetime:this.iso8601(n),lastTradeTimestamp:c,type:p,timeInForce:O,postOnly:void 0,side:f,price:u,stopPrice:_,amount:l,cost:v,average:y,filled:m,remaining:g,status:k,fee:d,trades:undefined}}handleOrderUpdate(e,t){"ORDER_TRADE_UPDATE"===this.safeString(t,"e")&&(t=this.safeValue(t,"o",t)),this.handleMyTrade(e,t),this.handleOrder(e,t)}async watchMyTrades(e,t,s,i={}){await this.loadMarkets(),await this.authenticate(i);const r=this.safeString2(this.options,"watchMyTrades","defaultType","spot"),a=this.safeString(i,"type",r),n=this.urls.api.ws[a]+"/"+this.options[a].listenKey;let o="myTrades";void 0!==e&&(o+=":"+e);a in this.client(n).subscriptions||(this.balance[a]={});const c=await this.watch(n,o,undefined,a);return this.newUpdates&&(s=c.getLimit(e,s)),this.filterBySymbolSinceLimit(c,e,t,s,!0)}handleMyTrade(e,t){const s="myTrades";if("TRADE"===this.safeString(t,"x")){const i=this.parseTrade(t),r=this.safeString(i,"order"),a=this.safeValue(i,"fee"),n=this.safeString(i,"symbol");if(void 0!==r&&void 0!==a&&void 0!==n){const e=this.orders;if(void 0!==e){const t=this.safeValue(e.hashmap,n,{}),s=this.safeValue(t,r);if(void 0!==s){const e=this.safeValue(s,"fees"),t=this.safeValue(s,"fee");if(void 0!==e){let t=!0;for(let i=0;i<e.length;i++){const r=e[i];if(r.currency===a.currency){const e=this.sum(a.cost,r.cost);s.fees[i].cost=parseFloat(this.currencyToPrecision(a.currency,e)),t=!1;break}}t&&s.fees.push(a)}else if(void 0!==t)if(t.currency===a.currency){const e=this.sum(t.cost,a.cost);s.fee.cost=parseFloat(this.currencyToPrecision(a.currency,e))}else void 0===t.currency?s.fee=a:(s.fees=[t,a],s.fee=void 0);else s.fee=a;const r=this.safeValue(s,"trades",[]);r.push(i),s.trades=r}}}if(void 0===this.myTrades){const e=this.safeInteger(this.options,"tradesLimit",1e3);this.myTrades=new o(e)}this.myTrades.append(i),e.resolve(this.myTrades,s);const c="myTrades:"+n;e.resolve(this.myTrades,c)}}handleOrder(e,t){const s="orders",i=this.parseWsOrder(t),r=this.safeString(i,"symbol"),a=this.safeString(i,"id");if(void 0!==r){if(void 0===this.orders){const e=this.safeInteger(this.options,"ordersLimit",1e3);this.orders=new o(e)}const t=this.orders,n=this.safeValue(t.hashmap,r,{}),c=this.safeValue(n,a);if(void 0!==c){const e=this.safeValue(c,"fee");void 0!==e&&(i.fee=e);const t=this.safeValue(c,"fees");void 0!==t&&(i.fees=t),i.trades=this.safeValue(c,"trades"),i.timestamp=this.safeInteger(c,"timestamp"),i.datetime=this.safeString(c,"datetime")}t.append(i),e.resolve(this.orders,s);const d="orders:"+r;e.resolve(this.orders,d)}}handleMessage(e,t){const s={depthUpdate:this.handleOrderBook,trade:this.handleTrade,aggTrade:this.handleTrade,kline:this.handleOHLCV,"24hrTicker":this.handleTicker,bookTicker:this.handleTicker,outboundAccountPosition:this.handleBalance,ACCOUNT_UPDATE:this.handleBalance,executionReport:this.handleOrderUpdate,ORDER_TRADE_UPDATE:this.handleOrderUpdate},i=this.safeString(t,"e"),r=this.safeValue(s,i);if(void 0!==r)return r.call(this,e,t);if(void 0!==this.safeString(t,"id"))return this.handleSubscriptionStatus(e,t);void 0===i&&this.handleTicker(e,t)}}},1293:(e,t,s)=>{"use strict";const i=s(9709);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"binancecoinm",name:"Binance COIN-M",urls:{logo:"https://user-images.githubusercontent.com/1294454/117738721-668c8d80-b205-11eb-8c49-3fad84c4a07f.jpg"},options:{defaultType:"delivery"}})}}},4286:(e,t,s)=>{"use strict";const i=s(9709);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"binanceus",name:"Binance US",countries:["US"],certified:!1,urls:{logo:"https://user-images.githubusercontent.com/1294454/65177307-217b7c80-da5f-11e9-876e-0b748ba0a358.jpg",api:{ws:{spot:"wss://stream.binance.us:9443/ws"},web:"https://www.binance.us",wapi:"https://api.binance.us/wapi/v3",public:"https://api.binance.us/api/v1",private:"https://api.binance.us/api/v3",v3:"https://api.binance.us/api/v3",v1:"https://api.binance.us/api/v1"},www:"https://www.binance.us",referral:"https://www.binance.us/?ref=35005074",doc:"https://github.com/binance-us/binance-official-api-docs",fees:"https://www.binance.us/en/fee/schedule"},fees:{trading:{tierBased:!1,percentage:!0,taker:0,maker:0}}})}}},7270:(e,t,s)=>{"use strict";const i=s(9709);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"binanceusdm",name:"Binance USDⓈ-M",urls:{logo:"https://user-images.githubusercontent.com/1294454/117738721-668c8d80-b205-11eb-8c49-3fad84c4a07f.jpg"},options:{defaultType:"future"}})}}},2231:(e,t,s)=>{"use strict";const i=s(1004);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bitcoincom",name:"bitcoin.com",countries:["KN"],urls:{logo:"https://user-images.githubusercontent.com/1294454/97296144-514fa300-1861-11eb-952b-3d55d492200b.jpg",api:{public:"https://api.exchange.bitcoin.com",private:"https://api.exchange.bitcoin.com",ws:"wss://api.exchange.bitcoin.com/api/2/ws"},www:"https://exchange.bitcoin.com",doc:"https://api.exchange.bitcoin.com/api/2/explore",fees:"https://exchange.bitcoin.com/fees-and-limits",referral:"https://exchange.bitcoin.com/referral/da948b21d6c92d69"},fees:{trading:{maker:.0015,taker:.002}}})}}},197:(e,t,s)=>{"use strict";const i=s(1853),{ExchangeError:r,AuthenticationError:a}=s(3449),{ArrayCache:n,ArrayCacheBySymbolById:o}=s(9584);e.exports=class extends i.bitfinex{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchTicker:!0,watchTickers:!1,watchOrderBook:!0,watchTrades:!0,watchBalance:!1,watchOHLCV:!1},urls:{api:{ws:{public:"wss://api-pub.bitfinex.com/ws/1",private:"wss://api.bitfinex.com/ws/1"}}},options:{watchOrderBook:{prec:"P0",freq:"F0"},ordersLimit:1e3}})}async subscribe(e,t,s={}){await this.loadMarkets();const i=this.market(t).id,r=this.urls.api.ws.public,a=e+":"+i,n={event:"subscribe",channel:e,symbol:i,messageHash:a};return await this.watch(r,a,this.deepExtend(n,s),a)}async watchTrades(e,t,s,i={}){const r=await this.subscribe("trades",e,i);return this.newUpdates&&(s=r.getLimit(e,s)),this.filterBySinceLimit(r,t,s,"timestamp",!0)}async watchTicker(e,t={}){return await this.subscribe("ticker",e,t)}handleTrades(e,t,s){const i=this.safeValue(s,"channel"),r=this.safeString(s,"pair"),a=i+":"+r,o=this.safeInteger(this.options,"tradesLimit",1e3);if(r in this.markets_by_id){const s=this.markets_by_id[r],i=s.symbol,c=this.safeValue(t,1);let d=this.safeValue(this.trades,i);if(void 0===d&&(d=new n(o),this.trades[i]=d),Array.isArray(c)){const e=this.parseTrades(c,s);for(let t=0;t<e.length;t++)d.append(e[t])}else{if("tu"!==this.safeString(t,1))return;const e=this.parseTrade(t,s);d.append(e)}e.resolve(d,a)}return t}parseTrade(e,t){if(!Array.isArray(e))return super.parseTrade(e,t);const s=e.length;let i;"tu"===this.safeString(e,1)&&(i=this.safeString(e,s-4));const r=this.safeTimestamp(e,s-3),a=this.safeFloat(e,s-2);let n,o,c=this.safeFloat(e,s-1);void 0!==c&&(n=c>0?"buy":"sell",c=Math.abs(c)),void 0!==a&&void 0!==c&&(o=a*c);const d=this.safeString(e,2).split("-");let h=this.safeString(d,1);void 0!==h&&(h=h.replace("t",""));const u=this.safeSymbol(h,t);return{info:e,timestamp:r,datetime:this.iso8601(r),symbol:u,id:i,order:undefined,type:void 0,takerOrMaker:undefined,side:n,price:a,amount:c,cost:o,fee:void 0}}handleTicker(e,t,s){const i=this.milliseconds(),r=this.safeString(s,"pair"),a=this.safeSymbol(r),n="ticker:"+r,o=this.safeFloat(t,7),c=this.safeFloat(t,5);let d;void 0!==o&&void 0!==c&&(d=o-c);const h={symbol:a,timestamp:i,datetime:this.iso8601(i),high:this.safeFloat(t,9),low:this.safeFloat(t,10),bid:this.safeFloat(t,1),bidVolume:void 0,ask:this.safeFloat(t,3),askVolume:void 0,vwap:void 0,open:d,close:o,last:o,previousClose:void 0,change:c,percentage:this.safeFloat(t,6),average:void 0,baseVolume:this.safeFloat(t,8),quoteVolume:void 0,info:t};this.tickers[a]=h,e.resolve(h,n)}async watchOrderBook(e,t,s={}){if(void 0!==t&&25!==t&&100!==t)throw new r(this.id+" watchOrderBook limit argument must be undefined, 25 or 100");const i=this.safeValue(this.options,"watchOrderBook",{}),a={prec:this.safeString(i,"prec","P0"),freq:this.safeString(i,"freq","F0"),len:t};return(await this.subscribe("book",e,this.deepExtend(a,s))).limit(t)}handleOrderBook(e,t,s){const i=this.safeString(s,"pair"),r=this.safeSymbol(i),a="book:"+i,n="R0"===this.safeString(s,"prec","P0");if(Array.isArray(t[1])){const i=this.safeInteger(s,"len");this.orderbooks[r]=n?this.indexedOrderBook({},i):this.countedOrderBook({},i);const o=this.orderbooks[r];if(n){const e=t[1];for(let t=0;t<e.length;t++){const s=e[t],i=this.safeString(s,0),r=this.safeFloat(s,1),a=s[2]<0?-s[2]:s[2];o[s[2]<0?"asks":"bids"].store(r,a,i)}}else{const e=t[1];for(let t=0;t<e.length;t++){const s=e[t],i=s[2]<0?-s[2]:s[2];o[s[2]<0?"asks":"bids"].store(s[0],i,s[1])}}e.resolve(o,a)}else{const s=this.orderbooks[r];if(n){const e=this.safeString(t,1),i=this.safeFloat(t,2),r=t[3]<0?-t[3]:t[3],a=i>0?r:0;s[t[3]<0?"asks":"bids"].store(i,a,e)}else{const e=t[3]<0?-t[3]:t[3];s[t[3]<0?"asks":"bids"].store(t[1],e,t[2])}e.resolve(s,a)}}handleHeartbeat(e,t){const s=this.safeString(t,"event");e.resolve(t,s)}handleSystemStatus(e,t){return t}handleSubscriptionStatus(e,t){const s=this.safeString(t,"chanId");return e.subscriptions[s]=t,t}async authenticate(e={}){const t=this.urls.api.ws.private,s=this.client(t),i=s.future("authenticated"),r="auth";if(void 0===this.safeValue(s.subscriptions,r)){const e=this.milliseconds(),s="AUTH"+e.toString(),i=this.hmac(this.encode(s),this.encode(this.secret),"sha384","hex"),a={apiKey:this.apiKey,authSig:i,authNonce:e,authPayload:s,event:r,filter:["trading","wallet"]};this.spawn(this.watch,t,r,a,1)}return await i}handleAuthenticationMessage(e,t){if("OK"===this.safeString(t,"status")){this.safeValue(e.futures,"authenticated").resolve(!0)}else{const s=new a(this.json(t));e.reject(s,"authenticated");const i=this.safeString(t,"event");i in e.subscriptions&&delete e.subscriptions[i]}}async watchOrder(e,t,s={}){await this.loadMarkets();const i=this.urls.api.ws.private;return await this.authenticate(),await this.watch(i,e,void 0,1)}async watchOrders(e,t,s,i={}){await this.loadMarkets(),await this.authenticate();const r=this.urls.api.ws.private,a=await this.watch(r,"os",void 0,1);return this.newUpdates&&(s=a.getLimit(e,s)),this.filterBySymbolSinceLimit(a,e,t,s,!0)}handleOrders(e,t,s){const i=this.safeValue(t,2,[]);if("os"===this.safeString(t,1))for(let t=0;t<i.length;t++){const s=i[t];this.handleOrder(e,s)}else this.handleOrder(e,i);void 0!==this.orders&&e.resolve(this.orders,"os")}parseWsOrderStatus(e){return this.safeString({ACTIVE:"open",CANCELED:"canceled"},e,e)}handleOrder(e,t){const s=this.safeString(t,0),i=this.safeString(t,1),r=this.safeSymbol(i);let a=this.safeFloat(t,2),n=this.safeFloat(t,3),c="buy";a<0&&(a=Math.abs(a),n=Math.abs(n),c="sell");let d=this.safeString(t,4);d.indexOf("LIMIT")>-1?d="limit":d.indexOf("MARKET")>-1&&(d="market");const h=this.parseWsOrderStatus(this.safeString(t,5)),u=this.safeFloat(t,6),l=this.safeString(t,8),f=this.parse8601(l),p={info:t,id:s,clientOrderId:void 0,timestamp:f,datetime:this.iso8601(f),lastTradeTimestamp:void 0,symbol:r,type:d,side:c,price:u,stopPrice:void 0,average:void 0,amount:a,remaining:n,filled:a-n,status:h,fee:void 0,cost:void 0,trades:void 0};if(void 0===this.orders){const e=this.safeInteger(this.options,"ordersLimit",1e3);this.orders=new o(e)}return this.orders.append(p),e.resolve(p,s),p}handleMessage(e,t){if(Array.isArray(t)){const s=this.safeString(t,0);if("hb"===t[1])return t;const i=this.safeValue(e.subscriptions,s,{}),r=this.safeString(i,"channel"),a=this.safeString(t,1),n={book:this.handleOrderBook,ticker:this.handleTicker,trades:this.handleTrades,os:this.handleOrders,on:this.handleOrders,oc:this.handleOrders},o=this.safeValue2(n,r,a);return void 0===o?t:o.call(this,e,t,i)}{const s=this.safeString(t,"event");if(void 0!==s){const i={info:this.handleSystemStatus,subscribed:this.handleSubscriptionStatus,auth:this.handleAuthenticationMessage},r=this.safeValue(i,s);return void 0===r?t:r.call(this,e,t)}}}}},3812:(e,t,s)=>{"use strict";const i=s(1853),{AuthenticationError:r,ExchangeError:a,RateLimitExceeded:n}=s(3449),{ArrayCache:o,ArrayCacheByTimestamp:c,ArrayCacheBySymbolById:d}=s(9584);e.exports=class extends i.bitmex{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchBalance:!0,watchMyTrades:!0,watchOHLCV:!0,watchOrderBook:!0,watchOrders:!0,watchTicker:!0,watchTickers:!1,watchTrades:!0},urls:{test:{ws:"wss://testnet.bitmex.com/realtime"},api:{ws:"wss://www.bitmex.com/realtime"}},versions:{ws:"0.2.0"},options:{watchOrderBookLevel:"orderBookL2",tradesLimit:1e3,OHLCVLimit:1e3},exceptions:{ws:{exact:{},broad:{"Rate limit exceeded":n}}}})}async watchTicker(e,t={}){await this.loadMarkets();const s="instrument:"+this.market(e).id,i=this.urls.api.ws,r={op:"subscribe",args:[s]};return await this.watch(i,s,this.extend(r,t),s)}handleTicker(e,t){const s=this.safeString(t,"table"),i=this.safeValue(t,"data",[]);for(let t=0;t<i.length;t++){const r=i[t],a=this.safeValue(r,"symbol"),n=this.safeMarket(a),o=n.symbol,c=s+":"+a;let d=this.safeValue(this.tickers,o,{});const h=this.safeValue(d,"info",{});d=this.parseTicker(this.extend(h,r),n),this.tickers[o]=d,e.resolve(d,c)}return t}async watchBalance(e={}){await this.loadMarkets(),await this.authenticate();const t="margin",s=this.urls.api.ws,i={op:"subscribe",args:[t]};return await this.watch(s,t,this.extend(i,e),t)}handleBalance(e,t){const s=this.safeValue(t,"data"),i=this.parseBalanceResponse(s);this.balance=this.extend(this.balance,i);const r=this.safeString(t,"table");e.resolve(this.balance,r)}handleTrades(e,t){const s=this.safeValue(t,"data",[]),i=this.groupBy(s,"symbol"),r=Object.keys(i);for(let t=0;t<r.length;t++){const s=r[t],a=this.safeMarket(s),n="trade:"+s,c=a.symbol,d=this.parseTrades(i[s],a);let h=this.safeValue(this.trades,c);if(void 0===h){const e=this.safeInteger(this.options,"tradesLimit",1e3);h=new o(e),this.trades[c]=h}for(let e=0;e<d.length;e++)h.append(d[e]);e.resolve(h,n)}}async watchTrades(e,t,s,i={}){await this.loadMarkets();const r="trade:"+this.market(e).id,a=this.urls.api.ws,n={op:"subscribe",args:[r]},o=await this.watch(a,r,this.extend(n,i),r);return this.newUpdates&&(s=o.getLimit(e,s)),this.filterBySinceLimit(o,t,s,"timestamp",!0)}async authenticate(e={}){const t=this.urls.api.ws,s=this.client(t),i=s.future("authenticated"),r="authKeyExpires";if(void 0===this.safeValue(s.subscriptions,r))try{this.checkRequiredCredentials();const e=this.milliseconds(),s="GET/realtime"+e.toString(),i=this.hmac(this.encode(s),this.encode(this.secret)),a={op:r,args:[this.apiKey,e,i]};this.spawn(this.watch,t,r,a,r)}catch(e){s.reject(e,"authenticated"),r in s.subscriptions&&delete s.subscriptions[r]}return await i}handleAuthenticationMessage(e,t){if(this.safeValue(t,"success",!1)){this.safeValue(e.futures,"authenticated").resolve(!0)}else{const s=new r(this.json(t));e.reject(s,"authenticated");const i="authKeyExpires";i in e.subscriptions&&delete e.subscriptions[i]}}async watchOrders(e,t,s,i={}){await this.loadMarkets(),await this.authenticate();const r="order",a=r;let n=r;void 0!==e&&(n+=":"+e);const o=this.urls.api.ws,c={op:"subscribe",args:[a]},d=await this.watch(o,n,c,a);return this.newUpdates&&(s=d.getLimit(e,s)),this.filterBySymbolSinceLimit(d,e,t,s,!0)}handleOrders(e,t){const s=this.safeValue(t,"data",[]),i="order",r=s.length;if(r>0){if(void 0===this.orders){const e=this.safeInteger(this.options,"ordersLimit",1e3);this.orders=new d(e)}const t=this.orders,a={};for(let e=0;e<r;e++){const i=s[e],r=this.safeString(i,"orderID"),n=this.safeValue(t.hashmap,r);let o=i;void 0!==n&&(o=this.extend(n.info,i));const c=this.parseOrder(o);t.append(c);a[c.symbol]=!0}e.resolve(this.orders,i);const n=Object.keys(a);for(let t=0;t<n.length;t++){const s=n[t];e.resolve(this.orders,"order:"+s)}}}async watchMyTrades(e,t,s,i={}){await this.loadMarkets(),await this.authenticate();const r="execution",a=r;let n=r;void 0!==e&&(n+=":"+e);const o=this.urls.api.ws,c={op:"subscribe",args:[a]},d=await this.watch(o,n,c,a);return this.newUpdates&&(s=d.getLimit(e,s)),this.filterBySymbolSinceLimit(d,e,t,s,!0)}handleMyTrades(e,t){const s=this.safeString(t,"table"),i=this.safeValue(t,"data",[]),r=this.groupBy(i,"execType"),a=this.safeValue(r,"Trade",[]),n=this.parseTrades(a);if(void 0===this.myTrades){const e=this.safeInteger(this.options,"tradesLimit",1e3);this.myTrades=new d(e)}const o=this.myTrades,c={};for(let e=0;e<n.length;e++){const t=n[e],s=t.symbol;o.append(t),c[s]=t}n.length>0&&e.resolve(o,s);const h=Object.keys(c);for(let t=0;t<h.length;t++)e.resolve(o,s+":"+h[t])}async watchOrderBook(e,t,s={}){let i;if(void 0===t)i=this.safeString(this.options,"watchOrderBookLevel","orderBookL2");else if(25===t)i="orderBookL2_25";else{if(10!==t)throw new a(this.id+" watchOrderBook limit argument must be undefined (L2), 25 (L2) or 10 (L3)");i="orderBookL10"}await this.loadMarkets();const r=i+":"+this.market(e).id,n=this.urls.api.ws,o={op:"subscribe",args:[r]};return(await this.watch(n,r,this.deepExtend(o,s),r)).limit(t)}async watchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n="tradeBin"+this.timeframes[t]+":"+a.id,o=this.urls.api.ws,c={op:"subscribe",args:[n]},d=await this.watch(o,n,this.extend(c,r),n);return this.newUpdates&&(i=d.getLimit(e,i)),this.filterBySinceLimit(d,s,i,0,!0)}handleOHLCV(e,t){const s=this.safeString(t,"table"),i=s.replace("tradeBin",""),r=this.findTimeframe(i),a=this.parseTimeframe(r),n=this.safeValue(t,"data",[]),o={};for(let e=0;e<n.length;e++){const t=n[e],i=this.safeString(t,"symbol"),d=this.safeMarket(i),h=d.symbol,u=s+":"+d.id,l=[this.parse8601(this.safeString(t,"timestamp"))-1e3*a,this.safeFloat(t,"open"),this.safeFloat(t,"high"),this.safeFloat(t,"low"),this.safeFloat(t,"close"),this.safeFloat(t,"volume")];this.ohlcvs[h]=this.safeValue(this.ohlcvs,h,{});let f=this.safeValue(this.ohlcvs[h],r);if(void 0===f){const e=this.safeInteger(this.options,"OHLCVLimit",1e3);f=new c(e),this.ohlcvs[h][r]=f}f.append(l),o[u]=f}const d=Object.keys(o);for(let t=0;t<d.length;t++){const s=d[t];e.resolve(o[s],s)}}async watchHeartbeat(e={}){await this.loadMarkets();const t=this.urls.api.ws;return await this.watch(t,"heartbeat")}handleOrderBook(e,t){const s=this.safeString(t,"action"),i=this.safeString(t,"table"),r=this.safeValue(t,"data",[]);if("partial"===s){const s=this.safeValue(t,"filter",{}),a=this.safeValue(s,"symbol"),n=this.safeMarket(a).symbol;"orderBookL2"===i?this.orderbooks[n]=this.indexedOrderBook():"orderBookL2_25"===i?this.orderbooks[n]=this.indexedOrderBook({},25):"orderBook10"===i&&(this.orderbooks[n]=this.indexedOrderBook({},10));const o=this.orderbooks[n];for(let e=0;e<r.length;e++){const t=this.safeFloat(r[e],"price"),s=this.safeFloat(r[e],"size"),i=this.safeString(r[e],"id");let a=this.safeString(r[e],"side");a="Buy"===a?"bids":"asks";o[a].store(t,s,i)}const c=i+":"+a;e.resolve(o,c)}else{const t={};for(let e=0;e<r.length;e++){const s=this.safeValue(r[e],"symbol");s in t||(t[s]=0),t[s]=this.sum(t,1);const i=this.safeMarket(s).symbol,a=this.orderbooks[i],n=this.safeFloat(r[e],"price"),o=this.safeFloat(r[e],"size",0),c=this.safeString(r[e],"id");let d=this.safeString(r[e],"side");d="Buy"===d?"bids":"asks";a[d].store(n,o,c)}const s=Object.keys(t);for(let t=0;t<s.length;t++){const r=s[t],a=i+":"+r,n=this.safeMarket(r).symbol,o=this.orderbooks[n];e.resolve(o,a)}}}handleSystemStatus(e,t){return t}handleSubscriptionStatus(e,t){return t}handleErrorMessage(e,t){const s=this.safeValue(t,"error");if(void 0!==s){const i=this.safeValue(t,"request",{}),r=this.safeString(i,"args",[]);if(r.length>0){const t=r[0],i=this.exceptions.ws.broad,n=this.findBroadlyMatchedKey(i,s);let o;return o=void 0===n?new a(s):new i[n](s),e.reject(o,t),!1}}return!0}handleMessage(e,t){if(this.handleErrorMessage(e,t)){const s=this.safeString(t,"table"),i={orderBookL2:this.handleOrderBook,orderBookL2_25:this.handleOrderBook,orderBook10:this.handleOrderBook,instrument:this.handleTicker,trade:this.handleTrades,tradeBin1m:this.handleOHLCV,tradeBin5m:this.handleOHLCV,tradeBin1h:this.handleOHLCV,tradeBin1d:this.handleOHLCV,order:this.handleOrders,execution:this.handleMyTrades,margin:this.handleBalance},r=this.safeValue(i,s);if(void 0===r){const s=this.safeValue(t,"request",{});return"authKeyExpires"===this.safeValue(s,"op")?this.handleAuthenticationMessage.call(this,e,t):t}return r.call(this,e,t)}}}},8098:(e,t,s)=>{"use strict";const i=s(1853),{ArrayCache:r}=s(9584);e.exports=class extends i.bitstamp{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchOrderBook:!0,watchTrades:!0,watchOHLCV:!1,watchTicker:!1,watchTickers:!1},urls:{api:{ws:"wss://ws.bitstamp.net"}},options:{watchOrderBook:{type:"order_book"},tradesLimit:1e3,OHLCVLimit:1e3}})}async watchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),r=this.safeValue(this.options,"watchOrderBook",{}),a=this.safeString(r,"type","order_book"),n=a+"_"+i.id,o=this.urls.api.ws,c={event:"bts:subscribe",data:{channel:n}},d={messageHash:n,type:a,symbol:e,method:this.handleOrderBookSubscription,limit:t,params:s},h=this.extend(c,s);return(await this.watch(o,n,h,n,d)).limit(t)}async fetchOrderBookSnapshot(e,t,s){const i=this.safeString(s,"symbol"),r=this.safeInteger(s,"limit"),a=this.safeValue(s,"params"),n=this.safeString(s,"messageHash"),o=await this.fetchOrderBook(i,r,a),c=this.safeValue(this.orderbooks,i);if(void 0!==c){c.reset(o);const t=c.cache;for(let s=0;s<t.length;s++){const i=t[s];this.handleOrderBookMessage(e,i,c)}this.orderbooks[i]=c,e.resolve(c,n)}}handleDelta(e,t){const s=this.safeFloat(t,0),i=this.safeFloat(t,1),r=this.safeString(t,2);void 0===r?e.store(s,i):e.store(s,i,r)}handleDeltas(e,t){for(let s=0;s<t.length;s++)this.handleDelta(e,t[s])}handleOrderBookMessage(e,t,s,i){const r=this.safeValue(t,"data",{}),a=this.safeInteger(r,"microtimestamp");if(void 0!==i&&a<=i)return s;this.handleDeltas(s.asks,this.safeValue(r,"asks",[])),this.handleDeltas(s.bids,this.safeValue(r,"bids",[])),s.nonce=a;const n=parseInt(a/1e3);return s.timestamp=n,s.datetime=this.iso8601(n),s}handleOrderBook(e,t){const s=this.safeString(t,"channel"),i=this.safeValue(e.subscriptions,s),r=this.safeString(i,"symbol"),a=this.safeString(i,"type"),n=this.safeValue(this.orderbooks,r);if(void 0===n)return t;if("order_book"===a)n.reset({}),this.handleOrderBookMessage(e,t,n),e.resolve(n,s);else if("detail_order_book"===a)n.reset({}),this.handleOrderBookMessage(e,t,n),e.resolve(n,s);else if("diff_order_book"===a){const i=this.safeInteger(n,"nonce");if(void 0===i)n.cache.push(t);else try{this.handleOrderBookMessage(e,t,n,i),e.resolve(n,s)}catch(t){r in this.orderbooks&&delete this.orderbooks[r],s in e.subscriptions&&delete e.subscriptions[s],e.reject(t,s)}}}async watchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a=this.safeValue(this.options,"watchTrades",{}),n=this.safeString(a,"type","live_trades"),o=n+"_"+r.id,c=this.urls.api.ws,d={event:"bts:subscribe",data:{channel:o}},h={messageHash:o,type:n,symbol:e,limit:s,params:i},u=this.extend(d,i),l=await this.watch(c,o,u,o,h);return this.newUpdates&&(s=l.getLimit(e,s)),this.filterBySinceLimit(l,t,s,"timestamp",!0)}parseTrade(e,t){const s=this.safeInteger(e,"microtimestamp");if(void 0===s)return super.parseTrade(e,t);const i=this.safeString(e,"id"),r=parseInt(s/1e3),a=this.safeFloat(e,"price"),n=this.safeFloat(e,"amount");let o,c;void 0!==a&&void 0!==n&&(o=a*n);const d=this.safeString(e,"s");d in this.markets_by_id&&(t=this.markets_by_id[d]),void 0===c&&void 0!==t&&(c=t.symbol);let h=this.safeInteger(e,"type");return h=0===h?"buy":"sell",{info:e,timestamp:r,datetime:this.iso8601(r),symbol:c,id:i,order:void 0,type:void 0,takerOrMaker:void 0,side:h,price:a,amount:n,cost:o,fee:void 0}}handleTrade(e,t){const s=this.safeString(t,"channel"),i=this.safeValue(t,"data"),a=this.safeValue(e.subscriptions,s),n=this.safeString(a,"symbol"),o=this.market(n),c=this.parseTrade(i,o);let d=this.safeValue(this.trades,n);if(void 0===d){const e=this.safeInteger(this.options,"tradesLimit",1e3);d=new r(e),this.trades[n]=d}d.append(c),e.resolve(d,s)}handleOrderBookSubscription(e,t,s){const i=this.safeString(s,"type"),r=this.safeString(s,"symbol");if(r in this.orderbooks&&delete this.orderbooks[r],"order_book"===i){const e=this.safeInteger(s,"limit",100);this.orderbooks[r]=this.orderBook({},e)}else if("detail_order_book"===i){const e=this.safeInteger(s,"limit",100);this.orderbooks[r]=this.indexedOrderBook({},e)}else if("diff_order_book"===i){const i=this.safeInteger(s,"limit");this.orderbooks[r]=this.orderBook({},i),this.spawn(this.fetchOrderBookSnapshot,e,t,s)}}handleSubscriptionStatus(e,t){const s=this.safeString(t,"channel"),i=this.safeValue(e.subscriptions,s,{}),r=this.safeValue(i,"method");return void 0!==r&&r.call(this,e,t,i),t}handleSubject(e,t){const s=this.safeString(t,"channel"),i=this.safeValue(e.subscriptions,s),r=this.safeString(i,"type"),a={live_trades:this.handleTrade,order_book:this.handleOrderBook,detail_order_book:this.handleOrderBook,diff_order_book:this.handleOrderBook},n=this.safeValue(a,r);return void 0===n?t:n.call(this,e,t)}handleErrorMessage(e,t){return t}handleMessage(e,t){if(!this.handleErrorMessage(e,t))return;return"bts:subscription_succeeded"===this.safeString(t,"event")?this.handleSubscriptionStatus(e,t):this.handleSubject(e,t)}}},5995:(e,t,s)=>{"use strict";const i=s(1853),{InvalidNonce:r,BadRequest:a}=s(3449),{ArrayCache:n,ArrayCacheByTimestamp:o,ArrayCacheBySymbolById:c}=s(9584);e.exports=class extends i.bittrex{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchBalance:!0,watchHeartbeat:!0,watchOHLCV:!0,watchOrderBook:!0,watchOrders:!0,watchTicker:!0,watchTickers:!1,watchTrades:!0},urls:{api:{ws:"wss://socket-v3.bittrex.com/signalr/connect",signalr:"https://socket-v3.bittrex.com/signalr"}},api:{signalr:{get:["negotiate","start"]}},options:{tradesLimit:1e3,hub:"c3",I:this.milliseconds()}})}getSignalRUrl(e){const t=this.safeString(e.response,"ConnectionToken"),s=this.extend(e.request,{connectionToken:t});return this.urls.api.ws+"?"+this.urlencode(s)}makeRequest(e,t,s){return{H:this.safeString(this.options,"hub","c3"),M:t,A:s,I:e}}makeRequestToSubscribe(e,t){return this.makeRequest(e,"Subscribe",t)}makeRequestToAuthenticate(e){const t=this.milliseconds(),s=this.uuid(),i=t.toString()+s,r=this.hmac(this.encode(i),this.encode(this.secret),"sha512"),a=[this.apiKey,t,s,r];return this.makeRequest(e,"Authenticate",a)}requestId(){const e=this.sum(this.safeInteger(this.options,"I",0),1);return this.options.I=e,e}async sendRequestToSubscribe(e,t,s,i={}){const r=[t],a=this.requestId().toString(),n=this.makeRequestToSubscribe(a,[r]);s=this.extend({id:a,negotiation:e},s);const o=this.getSignalRUrl(e);return await this.watch(o,t,n,t,s)}async authenticate(e={}){await this.loadMarkets();const t=await this.negotiate();return await this.sendRequestToAuthenticate(t,!1,e)}async sendRequestToAuthenticate(e,t=!1,s={}){const i=this.getSignalRUrl(e),r=this.client(i),a="authenticate";let n=this.safeValue(r.subscriptions,a);if(void 0===n||t){n=r.future(a),r.subscriptions.authenticate=n;const t=this.requestId().toString(),o=this.makeRequestToAuthenticate(t),c={id:t,params:s,negotiation:e,method:this.handleAuthenticate};this.spawn(this.watch,i,a,o,t,c)}return await n}async sendAuthenticatedRequestToSubscribe(e,t,s={}){const i=this.safeValue(e,"negotiation"),r={params:s};return await this.sendRequestToSubscribe(i,t,r,s)}handleAuthenticate(e,t,s){const i=this.safeString(s,"id");i in e.subscriptions&&delete e.subscriptions[i],e.resolve(s,"authenticate")}async handleAuthenticationExpiringHelper(){const e=await this.negotiate();return await this.sendRequestToAuthenticate(e,!0)}handleAuthenticationExpiring(e,t){this.spawn(this.handleAuthenticationExpiringHelper)}createSignalRQuery(e={}){const t=[{name:this.safeString(this.options,"hub","c3")}],s=this.milliseconds();return this.extend({transport:"webSockets",connectionData:this.json(t),clientProtocol:1.5,_:s,tid:this.sum(s%10,1)},e)}async negotiate(e={}){const t=this.client(this.urls.api.ws),s="negotiate";let i=this.safeValue(t.subscriptions,s);if(void 0===i){i=t.future(s),t.subscriptions.negotiate=i;const r=this.createSignalRQuery(e),a={request:r,response:await this.signalrGetNegotiate(this.extend(r,e))};t.resolve(a,s)}return await i}async start(e,t={}){const s=this.safeString(e.response,"ConnectionToken"),i=this.createSignalRQuery(this.extend(e.request,{connectionToken:s}));return await this.signalrGetStart(i)}async watchOrders(e,t,s,i={}){await this.loadMarkets();const r=await this.authenticate(),a=await this.subscribeToOrders(r,i);return this.newUpdates&&(s=a.getLimit(e,s)),this.filterBySymbolSinceLimit(a,e,t,s,!0)}async subscribeToOrders(e,t={}){return await this.sendAuthenticatedRequestToSubscribe(e,"order",t)}handleOrder(e,t){const s=this.safeValue(t,"delta",{}),i=this.parseOrder(s);if(void 0===this.orders){const e=this.safeInteger(this.options,"ordersLimit",1e3);this.orders=new c(e)}this.orders.append(i);e.resolve(this.orders,"order")}async watchBalance(e={}){await this.loadMarkets();const t=await this.authenticate();return await this.subscribeToBalance(t,e)}async subscribeToBalance(e,t={}){return await this.sendAuthenticatedRequestToSubscribe(e,"balance",t)}handleBalance(e,t){const s=this.safeValue(t,"delta",{}),i=this.safeString(s,"currencySymbol"),r=this.safeCurrencyCode(i),a=this.account();a.free=this.safeNumber(s,"available"),a.total=this.safeNumber(s,"total"),this.balance[r]=a,this.balance=this.parseBalance(this.balance,!1);e.resolve(this.balance,"balance")}async watchHeartbeat(e={}){await this.loadMarkets();const t=await this.negotiate();return await this.subscribeToHeartbeat(t,e)}async subscribeToHeartbeat(e,t={}){await this.loadMarkets();const s=this.getSignalRUrl(e),i=this.milliseconds().toString(),r="heartbeat",a=[r],n=this.makeRequestToSubscribe(i,[a]),o={id:i,params:t,negotiation:e};return await this.watch(s,r,n,r,o)}handleHeartbeat(e,t){e.resolve(t,"heartbeat")}async watchTicker(e,t={}){await this.loadMarkets();const s=await this.negotiate();return await this.subscribeToTicker(s,e,t)}async subscribeToTicker(e,t,s={}){await this.loadMarkets();const i=this.market(t),r="ticker_"+i.id,a={marketId:i.id,symbol:t,params:s};return await this.sendRequestToSubscribe(e,r,a)}handleTicker(e,t){const s=this.parseTicker(t),i=s.symbol,r=this.market(i);this.tickers[i]=s;const a="ticker_"+r.id;e.resolve(s,a)}async watchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=await this.negotiate(),n=await this.subscribeToOHLCV(a,e,t,r);return this.newUpdates&&(i=n.getLimit(e,i)),this.filterBySinceLimit(n,s,i,0,!0)}async subscribeToOHLCV(e,t,s="1m",i={}){await this.loadMarkets();const r=this.market(t),a=this.timeframes[s],n="candle_"+r.id+"_"+a,o={symbol:t,timeframe:s,messageHash:n,params:i};return await this.sendRequestToSubscribe(e,n,o)}handleOHLCV(e,t){const s=this.safeString(t,"marketSymbol"),i=this.safeSymbol(s,void 0,"-"),r=this.safeString(t,"interval"),a="candle_"+s+"_"+r,n=this.findTimeframe(r),c=this.safeValue(t,"delta",{}),d=this.parseOHLCV(c);this.ohlcvs[i]=this.safeValue(this.ohlcvs,i,{});let h=this.safeValue(this.ohlcvs[i],n);if(void 0===h){const e=this.safeInteger(this.options,"OHLCVLimit",1e3);h=new o(e),this.ohlcvs[i][n]=h}h.append(d),e.resolve(h,a)}async watchTrades(e,t,s,i={}){await this.loadMarkets();const r=await this.negotiate(),a=await this.subscribeToTrades(r,e,i);return this.newUpdates&&(s=a.getLimit(e,s)),this.filterBySinceLimit(a,t,s,"timestamp",!0)}async subscribeToTrades(e,t,s={}){await this.loadMarkets();const i="trade_"+this.market(t).id,r={symbol:t,messageHash:i,params:s};return await this.sendRequestToSubscribe(e,i,r)}handleTrades(e,t){const s=this.safeValue(t,"deltas",[]),i=this.safeString(t,"marketSymbol"),r=this.safeSymbol(i,void 0,"-"),a=this.market(r),o="trade_"+i;let c=this.safeValue(this.trades,r);if(void 0===c){const e=this.safeInteger(this.options,"tradesLimit",1e3);c=new n(e)}const d=this.parseTrades(s,a);for(let e=0;e<d.length;e++)c.append(d[e]);this.trades[r]=c,e.resolve(c,o)}async watchOrderBook(e,t,s={}){if(1!==(t=void 0===t?25:t)&&25!==t&&500!==t)throw new a(this.id+" watchOrderBook() limit argument must be undefined, 1, 25 or 500, default is 25");await this.loadMarkets();const i=await this.negotiate();return(await this.subscribeToOrderBook(i,e,t,s)).limit(t)}async subscribeToOrderBook(e,t,s,i={}){await this.loadMarkets();const r="orderbook_"+this.market(t).id+"_"+s.toString(),a={symbol:t,messageHash:r,method:this.handleSubscribeToOrderBook,limit:s,params:i};return await this.sendRequestToSubscribe(e,r,a)}async fetchOrderBookSnapshot(e,t,s){const i=this.safeString(s,"symbol"),a=this.safeInteger(s,"limit"),n=this.safeString(s,"messageHash");try{const o=await this.fetchOrderBook(i,a),c=this.orderbooks[i],d=c.cache,h=this.safeValue(d,0,{}),u=this.safeInteger(h,"sequence"),l=this.safeInteger(o,"nonce");if(void 0!==u&&l<u){const a=this.safeValue(this.options,"fetchOrderBookSnapshot",{}),o=this.safeInteger(a,"maxAttempts",3);let c=this.safeInteger(s,"numAttempts",0);if(!(c<o))throw new r(this.id+" failed to synchronize WebSocket feed with the snapshot for symbol "+i+" in "+o.toString()+" attempts");n in e.subscriptions&&(c=this.sum(c,1),s.numAttempts=c,e.subscriptions[n]=s,this.spawn(this.fetchOrderBookSnapshot,e,t,s))}else{c.reset(o);for(let t=0;t<d.length;t++){const s=d[t];this.handleOrderBookMessage(e,s,c)}this.orderbooks[i]=c,e.resolve(c,n)}}catch(t){e.reject(t,n)}}handleSubscribeToOrderBook(e,t,s){const i=this.safeString(s,"symbol"),r=this.safeInteger(s,"limit");i in this.orderbooks&&delete this.orderbooks[i],this.orderbooks[i]=this.orderBook({},r),this.spawn(this.fetchOrderBookSnapshot,e,t,s)}handleDelta(e,t){const s=this.safeFloat(t,"rate"),i=this.safeFloat(t,"quantity");e.store(s,i)}handleDeltas(e,t){for(let s=0;s<t.length;s++)this.handleDelta(e,t[s])}handleOrderBook(e,t){const s=this.safeString(t,"marketSymbol"),i=this.safeSymbol(s,void 0,"-"),r=this.safeValue(this.orderbooks,i,{});void 0!==this.safeInteger(r,"nonce")?this.handleOrderBookMessage(e,t,r):r.cache.push(t)}handleOrderBookMessage(e,t,s){const i="orderbook_"+this.safeString(t,"marketSymbol")+"_"+this.safeString(t,"depth"),r=this.safeInteger(t,"sequence");return r>s.nonce&&(this.handleDeltas(s.asks,this.safeValue(t,"askDeltas",[])),this.handleDeltas(s.bids,this.safeValue(t,"bidDeltas",[])),s.nonce=r,e.resolve(s,i)),s}async handleSystemStatusHelper(){const e=await this.negotiate();await this.start(e)}handleSystemStatus(e,t){return this.spawn(this.handleSystemStatusHelper),t}handleSubscriptionStatus(e,t){const s=this.safeString(t,"I");let i=this.safeValue(e.subscriptions,s);if(void 0===i){const t=this.indexBy(e.subscriptions,"id");i=this.safeValue(t,s,{})}else delete e.subscriptions[s];const r=this.safeValue(i,"method");return void 0===r?e.resolve(t,s):r.call(this,e,t,i),t}handleMessage(e,t){const s={authenticationExpiring:this.handleAuthenticationExpiring,order:this.handleOrder,balance:this.handleBalance,trade:this.handleTrades,candle:this.handleOHLCV,orderBook:this.handleOrderBook,heartbeat:this.handleHeartbeat,ticker:this.handleTicker},i=this.safeValue(t,"M",[]);for(let r=0;r<i.length;r++){const a=this.safeValue(i[r],"M"),n=this.safeValue(s,a);if(void 0!==n)if("heartbeat"===a)n.call(this,e,t);else if("authenticationExpiring"===a)n.call(this,e,t);else{const t=this.safeValue(i[r],"A",[]);for(let s=0;s<t.length;s++){const i=this.inflate64(t[s]),r=JSON.parse(i);n.call(this,e,r)}}}"I"in t&&this.handleSubscriptionStatus(e,t),"S"in t&&this.handleSystemStatus(e,t);Object.keys(t).length<1&&this.handleHeartbeat(e,t)}}},3245:(e,t,s)=>{"use strict";const i=s(1853),{AuthenticationError:r,ArgumentsRequired:a}=s(3449),{ArrayCache:n,ArrayCacheByTimestamp:o,ArrayCacheBySymbolById:c}=s(9584);e.exports=class extends i.bitvavo{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchOrderBook:!0,watchTrades:!0,watchTicker:!0,watchOHLCV:!0,watchOrders:!0,watchMyTrades:!0},urls:{api:{ws:"wss://ws.bitvavo.com/v2"}},options:{tradesLimit:1e3,ordersLimit:1e3,OHLCVLimit:1e3}})}async watchPublic(e,t,s={}){await this.loadMarkets();const i=this.market(t),r=e+"@"+i.id,a=this.urls.api.ws,n={action:"subscribe",channels:[{name:e,markets:[i.id]}]},o=this.extend(n,s);return await this.watch(a,r,o,r)}async watchTicker(e,t={}){return await this.watchPublic("ticker24h",e,t)}handleTicker(e,t){const s=this.safeString(t,"event"),i=this.safeValue(t,"data",[]);for(let t=0;t<i.length;t++){const r=i[t],a=this.safeString(r,"market"),n=this.safeMarket(a,void 0,"-"),o=s+"@"+a,c=this.parseTicker(r,n),d=c.symbol;this.tickers[d]=c,e.resolve(c,o)}return t}async watchTrades(e,t,s,i={}){const r=await this.watchPublic("trades",e,i);return this.newUpdates&&(s=r.getLimit(e,s)),this.filterBySinceLimit(r,t,s,"timestamp",!0)}handleTrade(e,t){const s=this.safeString(t,"market"),i=this.safeMarket(s,void 0,"-"),r=i.symbol,a="trades@"+s,o=this.parseTrade(t,i);let c=this.safeValue(this.trades,r);if(void 0===c){const e=this.safeInteger(this.options,"tradesLimit",1e3);c=new n(e)}c.append(o),this.trades[r]=c,e.resolve(c,a)}async watchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e).id,n=this.timeframes[t],o="candles@"+a+"_"+n,c=this.urls.api.ws,d={action:"subscribe",channels:[{name:"candles",interval:[n],markets:[a]}]},h=this.extend(d,r),u=await this.watch(c,o,h,o);return this.newUpdates&&(i=u.getLimit(e,i)),this.filterBySinceLimit(u,s,i,0,!0)}handleOHLCV(e,t){const s=this.safeString(t,"market"),i=this.safeMarket(s,void 0,"-"),r=i.symbol,a=this.safeString(t,"interval"),n=this.findTimeframe(a),c="candles@"+s+"_"+a,d=this.safeValue(t,"candle");this.ohlcvs[r]=this.safeValue(this.ohlcvs,r,{});let h=this.safeValue(this.ohlcvs[r],n);if(void 0===h){const e=this.safeInteger(this.options,"OHLCVLimit",1e3);h=new o(e),this.ohlcvs[r][n]=h}for(let e=0;e<d.length;e++){const t=d[e],s=this.parseOHLCV(t,i);h.append(s)}e.resolve(h,c)}async watchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),r="book",a="book@"+i.id,n=this.urls.api.ws,o={action:"subscribe",channels:[{name:r,markets:[i.id]}]},c={messageHash:a,name:r,symbol:e,marketId:i.id,method:this.handleOrderBookSubscription,limit:t,params:s},d=this.extend(o,s);return(await this.watch(n,a,d,a,c)).limit(t)}handleDelta(e,t){const s=this.safeFloat(t,0),i=this.safeFloat(t,1);e.store(s,i)}handleDeltas(e,t){for(let s=0;s<t.length;s++)this.handleDelta(e,t[s])}handleOrderBookMessage(e,t,s){const i=this.safeInteger(t,"nonce");return i>s.nonce&&(this.handleDeltas(s.asks,this.safeValue(t,"asks",[])),this.handleDeltas(s.bids,this.safeValue(t,"bids",[])),s.nonce=i),s}handleOrderBook(e,t){const s=this.safeString(t,"event"),i=this.safeString(t,"market"),r=this.safeMarket(i,void 0,"-"),a=r.symbol,n=s+"@"+r.id,o=this.safeValue(this.orderbooks,a);if(void 0!==o)if(void 0===o.nonce){const s=this.safeValue(e.subscriptions,n,{});if(void 0===this.safeValue(s,"watchingOrderBookSnapshot")){s.watchingOrderBookSnapshot=!0,e.subscriptions[n]=s;const i=this.safeValue(this.options,"watchOrderBookSnapshot",{}),r=this.safeInteger(i,"delay",this.rateLimit);this.delay(r,this.watchOrderBookSnapshot,e,t,s)}o.cache.push(t)}else this.handleOrderBookMessage(e,t,o),e.resolve(o,n)}async watchOrderBookSnapshot(e,t,s){const i=this.safeInteger(s,"limit"),r=this.safeValue(s,"params"),a=this.safeString(s,"marketId"),n="getBook",o=n+"@"+a,c=this.urls.api.ws,d={action:n,market:a};return(await this.watch(c,o,this.extend(d,r),o,s)).limit(i)}handleOrderBookSnapshot(e,t){const s=this.safeValue(t,"response");if(void 0===s)return t;const i=this.safeString(s,"market");let r;if(i in this.markets_by_id){r=this.markets_by_id[i].symbol}const a="book@"+i,n=this.orderbooks[r],o=this.parseOrderBook(s,r);o.nonce=this.safeInteger(s,"nonce"),n.reset(o);const c=n.cache;for(let t=0;t<c.length;t++){const s=c[t];this.handleOrderBookMessage(e,s,n)}this.orderbooks[r]=n,e.resolve(n,a)}handleOrderBookSubscription(e,t,s){const i=this.safeString(s,"symbol"),r=this.safeInteger(s,"limit");i in this.orderbooks&&delete this.orderbooks[i],this.orderbooks[i]=this.orderBook({},r)}handleOrderBookSubscriptions(e,t,s){for(let i=0;i<s.length;i++){const r=this.safeString(s,i);if(r in this.markets_by_id){const s="book@"+r;if(!(this.markets_by_id[r].symbol in this.orderbooks)){const i=this.safeValue(e.subscriptions,s),r=this.safeValue(i,"method");void 0!==r&&r.call(this,e,t,i)}}}}async watchOrders(e,t,s,i={}){if(void 0===e)throw new a(this.id+" watchOrders requires a symbol argument");await this.loadMarkets(),await this.authenticate();const r=this.market(e).id,n=this.urls.api.ws,o="account",c=o+"@"+r,d=c+"_order",h={action:"subscribe",channels:[{name:o,markets:[r]}]},u=await this.watch(n,d,h,c);return this.newUpdates&&(s=u.getLimit(e,s)),this.filterBySymbolSinceLimit(u,e,t,s,!0)}async watchMyTrades(e,t,s,i={}){if(void 0===e)throw new a(this.id+" watchMyTrades requires a symbol argument");await this.loadMarkets(),await this.authenticate();const r=this.market(e).id,n=this.urls.api.ws,o="account",c=o+"@"+r,d=c+"_fill",h={action:"subscribe",channels:[{name:o,markets:[r]}]},u=await this.watch(n,d,h,c);return this.newUpdates&&(s=u.getLimit(e,s)),this.filterBySymbolSinceLimit(u,e,t,s,!0)}handleOrder(e,t){const s=this.safeString(t,"event"),i=this.safeString(t,"market","-"),r="account@"+i+"_"+s;if(i in this.markets_by_id){const s=this.markets_by_id[i],a=this.parseOrder(t,s);if(void 0===this.orders){const e=this.safeInteger(this.options,"ordersLimit",1e3);this.orders=new c(e)}this.orders.append(a),e.resolve(this.orders,r)}}handleMyTrade(e,t){const s=this.safeString(t,"event"),i=this.safeString(t,"market"),r="account@"+i+"_"+s,a=this.safeMarket(i,void 0,"-"),o=this.parseTrade(t,a);if(void 0===this.myTrades){const e=this.safeInteger(this.options,"tradesLimit",1e3);this.myTrades=new n(e)}const c=this.myTrades;c.append(o),this.myTrades=c,e.resolve(c,r)}handleSubscriptionStatus(e,t){const s=this.safeValue(t,"subscriptions",{}),i={book:this.handleOrderBookSubscriptions},r=Object.keys(s);for(let a=0;a<r.length;a++){const n=r[a],o=this.safeValue(i,n);if(void 0!==o){const i=this.safeValue(s,n);o.call(this,e,t,i)}}return t}async authenticate(e={}){const t=this.urls.api.ws,s=this.client(t),i=s.future("authenticated"),r="authenticate";if(void 0===this.safeValue(s.subscriptions,r))try{this.checkRequiredCredentials();const e=this.milliseconds(),s=e.toString()+"GET/"+this.version+"/websocket",i=this.hmac(this.encode(s),this.encode(this.secret)),a={action:r,key:this.apiKey,signature:i,timestamp:e};this.spawn(this.watch,t,r,a,r)}catch(e){s.reject(e,"authenticated"),r in s.subscriptions&&delete s.subscriptions[r]}return await i}handleAuthenticationMessage(e,t){if(this.safeValue(t,"authenticated",!1)){this.safeValue(e.futures,"authenticated").resolve(!0)}else{const s=new r(this.json(t));e.reject(s,"authenticated");const i=this.safeValue(t,"event");i in e.subscriptions&&delete e.subscriptions[i]}}handleMessage(e,t){const s={subscribed:this.handleSubscriptionStatus,book:this.handleOrderBook,getBook:this.handleOrderBookSnapshot,trade:this.handleTrade,candle:this.handleOHLCV,ticker24h:this.handleTicker,authenticate:this.handleAuthenticationMessage,order:this.handleOrder,fill:this.handleMyTrade},i=this.safeString(t,"event");let r=this.safeValue(s,i);if(void 0===r){const i=this.safeString(t,"action");return r=this.safeValue(s,i),void 0===r?t:r.call(this,e,t)}return r.call(this,e,t)}}},6208:(e,t,s)=>{"use strict";const i=s(5556);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"cdax",name:"CDAX",countries:["RU"],hostname:"cdax.io",urls:{logo:"https://user-images.githubusercontent.com/1294454/102157692-fd406280-3e90-11eb-8d46-4511b617cd17.jpg",api:{ws:{api:{public:"wss://{hostname}/api/ws",private:"wss://{hostname}/api/ws/v2"}},market:"https://{hostname}/api",public:"https://{hostname}/api",private:"https://{hostname}/api",v2Public:"https://{hostname}/api",v2Private:"https://{hostname}/api"},www:"https://cdax.io",referral:"https://cdax.io/invite?invite_code=esc74",doc:"https://github.com/cloudapidoc/API_Docs",fees:"https://cdax.io/about/fee"}})}}},5019:(e,t,s)=>{"use strict";const i=s(2960);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"coinbaseprime",name:"Coinbase Prime",has:{ws:!0,watchOrderBook:!0},urls:{test:{ws:"wss://ws-feed-public.sandbox.exchange.coinbase.com"},logo:"https://user-images.githubusercontent.com/1294454/44539184-29f26e00-a70c-11e8-868f-e907fc236a7c.jpg",api:{ws:"wss://ws-feed.exchange.coinbase.com"},www:"https://exchange.coinbase.com",doc:"https://docs.exchange.coinbase.com/",fees:"https://pro.coinbase.com/fees"}})}}},2960:(e,t,s)=>{"use strict";const i=s(1853),{BadSymbol:r}=s(3449),{ArrayCache:a,ArrayCacheBySymbolById:n}=s(9584);e.exports=class extends i.coinbasepro{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchOHLCV:!1,watchOrderBook:!0,watchTicker:!0,watchTickers:!1,watchTrades:!0,watchBalance:!1,watchStatus:!1,watchOrders:!0,watchMyTrades:!0},urls:{api:{ws:"wss://ws-feed.pro.coinbase.com"}},options:{tradesLimit:1e3,ordersLimit:1e3,myTradesLimit:1e3}})}authenticate(){this.checkRequiredCredentials();const e=this.nonce(),t=e.toString()+"GET/users/self/verify",s=this.hmac(this.encode(t),this.base64ToBinary(this.secret),"sha256","base64");return{timestamp:e,key:this.apiKey,signature:s,passphrase:this.password}}async subscribe(e,t,s,i={}){await this.loadMarkets();const r=this.market(t),a=s+":"+r.id;let n=this.urls.api.ws;"signature"in i&&(n+="?");const o={type:"subscribe",product_ids:[r.id],channels:[e]},c=this.extend(o,i);return await this.watch(n,a,c,a)}async watchTicker(e,t={}){const s="ticker";return await this.subscribe(s,e,s,t)}async watchTrades(e,t,s,i={}){const r="matches",a=await this.subscribe(r,e,r,i);return this.newUpdates&&(s=a.getLimit(e,s)),this.filterBySinceLimit(a,t,s,"timestamp",!0)}async watchMyTrades(e,t,s,i={}){if(void 0===e)throw new r(this.id+" watchMyTrades requires a symbol");const a=this.authenticate(),n=await this.subscribe("user",e,"myTrades",this.extend(i,a));return this.newUpdates&&(s=n.getLimit(e,s)),this.filterBySinceLimit(n,t,s,"timestamp",!0)}async watchOrders(e,t,s,i={}){if(void 0===e)throw new r(this.id+" watchMyTrades requires a symbol");const a=this.authenticate(),n=await this.subscribe("user",e,"orders",this.extend(i,a));return this.newUpdates&&(s=n.getLimit(e,s)),this.filterBySinceLimit(n,t,s,"timestamp",!0)}async watchOrderBook(e,t,s={}){const i="level2";await this.loadMarkets();const r=this.market(e),a=i+":"+r.id,n=this.urls.api.ws,o={type:"subscribe",product_ids:[r.id],channels:[i]},c=this.extend(o,s),d={messageHash:a,symbol:e,marketId:r.id,limit:t};return(await this.watch(n,a,c,a,d)).limit(t)}handleTrade(e,t){const s=this.safeString(t,"product_id");if(void 0!==s){const i=this.parseWsTrade(t),r=i.symbol,n="matches"+":"+s;let o=this.safeValue(this.trades,r);if(void 0===o){const e=this.safeInteger(this.options,"tradesLimit",1e3);o=new a(e),this.trades[r]=o}o.append(i),e.resolve(o,n)}return t}handleMyTrade(e,t){const s=this.safeString(t,"product_id");if(void 0!==s){const i=this.parseWsTrade(t),r="myTrades"+":"+s;let a=this.myTrades;if(void 0===a){const e=this.safeInteger(this.options,"myTradesLimit",1e3);a=new n(e),this.myTrades=a}a.append(i),e.resolve(a,r)}return t}parseWsTrade(e){const t=super.parseTrade(e);let s;"maker_fee_rate"in e?(t.takerOrMaker="maker",s=this.safeFloat(e,"maker_fee_rate")):(t.takerOrMaker="taker",s=this.safeFloat(e,"taker_fee_rate"));const i=this.market(t.symbol).quote;let r;return void 0!==t.cost&&void 0!==s&&(r=t.cost*s),t.fee={rate:s,cost:r,currency:i},t}parseWsOrderStatus(e){return this.safeString({filled:"closed",canceled:"canceled"},e,"open")}handleOrder(e,t){let s=this.orders;if(void 0===s){const e=this.safeInteger(this.options,"ordersLimit",1e3);s=new n(e),this.orders=s}const i=this.safeString(t,"type"),r=this.safeString(t,"product_id");if(void 0!==r){const s="orders:"+r,a=this.safeSymbol(r),n=this.safeString(t,"order_id"),o=this.safeString(t,"maker_order_id"),c=this.safeString(t,"taker_order_id"),d=this.orders,h=this.safeValue(d.hashmap,a,{});let u=this.safeValue(h,n);if(void 0===u&&(u=this.safeValue2(h,o,c)),void 0===u){const i=this.parseWsOrder(t);d.append(i),e.resolve(d,s)}else{const r=this.safeInteger(t,"sequence"),a=this.safeValue(u,"info",{}),n=this.safeInteger(a,"sequence");if(void 0===n||r>n)if("match"===i){const i=this.parseWsTrade(t);void 0===u.trades&&(u.trades=[]),u.trades.push(i),u.lastTradeTimestamp=i.timestamp;let r=0,a=0;const n=u.trades;for(let e=0;e<n.length;e++){const t=n[e];r=this.sum(r,t.cost),a=this.sum(a,t.amount)}a>0&&(u.average=r/a),u.cost=r,void 0!==u.filled&&(u.filled+=i.amount,void 0!==u.amount&&(u.remaining=u.amount-u.filled)),void 0===u.fee&&(u.fee={cost:0,currency:i.fee.currency}),void 0!==u.fee.cost&&void 0!==i.fee.cost&&(u.fee.cost=this.sum(u.fee.cost,i.fee.cost)),d.append(u),e.resolve(d,s)}else if("received"===i||"done"===i){const i=this.extend(u.info,t),r=this.parseWsOrder(i),a=Object.keys(r);for(let e=0;e<a.length;e++){const t=a[e];void 0!==r[t]&&(u[t]=r[t])}d.append(u),e.resolve(d,s)}}}}parseWsOrder(e){const t=this.safeString(e,"order_id"),s=this.safeString(e,"client_oid"),i=this.safeString(e,"product_id"),r=this.safeSymbol(i),a=this.safeString(e,"side"),n=this.safeFloat(e,"price"),o=this.safeFloat2(e,"size","funds"),c=this.safeString(e,"time"),d=this.parse8601(c),h=this.safeString(e,"reason"),u=this.parseWsOrderStatus(h),l=this.safeString(e,"order_type");let f=this.safeFloat(e,"remaining_size");const p=this.safeString(e,"type");let m,b;return void 0!==o&&void 0!==f?m=o-f:"received"===p&&(m=0,void 0!==o&&(f=o-m)),void 0!==n&&void 0!==o&&(b=n*o),{info:e,symbol:r,id:t,clientOrderId:s,timestamp:d,datetime:this.iso8601(d),lastTradeTimestamp:void 0,type:l,timeInForce:void 0,postOnly:void 0,side:a,price:n,stopPrice:void 0,amount:o,cost:b,average:void 0,filled:m,remaining:f,status:u,fee:void 0,trades:void 0}}handleTicker(e,t){const s=this.safeString(t,"product_id");if(void 0!==s){const i=this.parseTicker(t),r=i.symbol;this.tickers[r]=i;const a=this.safeString(t,"type")+":"+s;e.resolve(i,a)}return t}parseTicker(e,t){if(void 0===this.safeString(e,"type"))return super.parseTicker(e,t);const s=this.safeString(e,"product_id"),i=this.safeSymbol(s,t,"-"),r=this.parse8601(this.safeString(e,"time")),a=this.safeFloat(e,"price");return{symbol:i,timestamp:r,datetime:this.iso8601(r),high:this.safeFloat(e,"high_24h"),low:this.safeFloat(e,"low_24h"),bid:this.safeFloat(e,"best_bid"),bidVolume:void 0,ask:this.safeFloat(e,"best_ask"),askVolume:void 0,vwap:void 0,open:this.safeFloat(e,"open_24h"),close:a,last:a,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeFloat(e,"volume_24h"),quoteVolume:void 0,info:e}}handleDelta(e,t){const s=this.safeFloat(t,0),i=this.safeFloat(t,1);e.store(s,i)}handleDeltas(e,t){for(let s=0;s<t.length;s++)this.handleDelta(e,t[s])}handleOrderBook(e,t){const s=this.safeString(t,"type"),i=this.safeString(t,"product_id"),r=this.safeMarket(i,void 0,"-").symbol,a="level2:"+i,n=this.safeValue(e.subscriptions,a,{}),o=this.safeInteger(n,"limit");if("snapshot"===s){this.orderbooks[r]=this.orderBook({},o);const s=this.orderbooks[r];this.handleDeltas(s.asks,this.safeValue(t,"asks",[])),this.handleDeltas(s.bids,this.safeValue(t,"bids",[])),s.timestamp=void 0,s.datetime=void 0,e.resolve(s,a)}else if("l2update"===s){const s=this.orderbooks[r],i=this.parse8601(this.safeString(t,"time")),n=this.safeValue(t,"changes",[]),o={sell:"asks",buy:"bids"};for(let e=0;e<n.length;e++){const t=n[e],i=this.safeString(t,0),r=this.safeString(o,i),a=this.safeFloat(t,1),c=this.safeFloat(t,2);s[r].store(a,c)}s.timestamp=i,s.datetime=this.iso8601(i),e.resolve(s,a)}}handleSubscriptionStatus(e,t){return t}handleMessage(e,t){const s=this.safeString(t,"type"),i={snapshot:this.handleOrderBook,l2update:this.handleOrderBook,subscribe:this.handleSubscriptionStatus,ticker:this.handleTicker,received:this.handleOrder,open:this.handleOrder,change:this.handleOrder,done:this.handleOrder},r=e.url.length,a="?"===e.url[r-1],n=this.safeValue(i,s);if(void 0!==n)return n.call(this,e,t);"match"===s&&(a?(this.handleMyTrade(e,t),this.handleOrder(e,t)):this.handleTrade(e,t))}}},7839:(e,t,s)=>{"use strict";const i=s(1853),r=s(1853).Precise,{ArrayCache:a,ArrayCacheByTimestamp:n}=s(9584);e.exports=class extends i.currencycom{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchBalance:!0,watchTicker:!0,watchTickers:!1,watchTrades:!0,watchOrderBook:!0,watchOHLCV:!0},urls:{api:{ws:"wss://api-adapter.backend.currency.com/connect"}},options:{tradesLimit:1e3,OHLCVLimit:1e3,timeframes:{"1m":"M1","3m":"M3","5m":"M5","15m":"M15","30m":"M30","1h":"H1","4h":"H4","1d":"D1","1w":"W1"}},streaming:{ping:this.ping,keepAlive:2e4}})}ping(e){return{destination:"ping",correlationId:this.requestId().toString(),payload:{}}}handlePong(e,t){return e.lastPong=this.milliseconds(),t}handleBalance(e,t,s){const i=this.safeValue(t,"payload"),r=this.parseBalanceResponse(i);this.balance=this.extend(this.balance,r);const a=this.safeString(s,"messageHash");e.resolve(this.balance,a),a in e.subscriptions&&delete e.subscriptions[a]}handleTicker(e,t,s){const i=this.safeValue(t,"payload"),r=this.safeValue(i,"tickers",[]);for(let t=0;t<r.length;t++){const s=this.parseTicker(r[t]),i=s.symbol;this.tickers[i]=s;const a="/api/v1/ticker/24hr:"+i;e.resolve(s,a),a in e.subscriptions&&delete e.subscriptions[a]}}handleTrade(e,t){const s=this.safeString(e,"symbol"),i=this.safeSymbol(s,void 0,"/"),a=this.safeInteger(e,"ts"),n=this.safeString(e,"price"),o=this.safeString(e,"size"),c=this.parseNumber(r.stringMul(n,o)),d=this.parseNumber(n),h=this.parseNumber(o),u=this.safeString2(e,"id"),l=this.safeString(e,"orderId"),f=this.safeValue(e,"buyer")?"buy":"sell";return{info:e,timestamp:a,datetime:this.iso8601(a),symbol:i,id:u,order:l,type:void 0,takerOrMaker:void 0,side:f,price:d,amount:h,cost:c,fee:void 0}}handleTrades(e,t,s){const i=this.safeValue(t,"payload"),r=this.handleTrade(i),n=r.symbol,o="trades.subscribe:"+n;let c=this.safeValue(this.trades,n);if(void 0===c){const e=this.safeInteger(this.options,"tradesLimit",1e3);c=new a(e),this.trades[n]=c}c.append(r),e.resolve(c,o)}findTimeframe(e){const t=this.safeValue(this.options,"timeframes"),s=Object.keys(t);for(let i=0;i<s.length;i++){const r=s[i];if(t[r]===e)return r}}handleOHLCV(e,t){const s=this.safeValue(t,"payload",{}),i=this.safeString(s,"interval"),r=this.findTimeframe(i),a=this.safeString(s,"symbol"),o=this.safeMarket(a).symbol,c="OHLCMarketData.subscribe:"+r+":"+o,d=[this.safeInteger(s,"t"),this.safeNumber(s,"o"),this.safeNumber(s,"h"),this.safeNumber(s,"l"),this.safeNumber(s,"c"),void 0];this.ohlcvs[o]=this.safeValue(this.ohlcvs,o,{});let h=this.safeValue(this.ohlcvs[o],r);if(void 0===h){const e=this.safeInteger(this.options,"OHLCVLimit",1e3);h=new n(e),this.ohlcvs[o][r]=h}h.append(d),e.resolve(h,c)}requestId(){const e=this.sum(this.safeInteger(this.options,"correlationId",0),1);return this.options.correlationId=e,e}async watchPublic(e,t,s={}){await this.loadMarkets();const i=this.market(t),r=e+":"+t,a=this.urls.api.ws,n=this.requestId().toString(),o=this.deepExtend({destination:e,correlationId:n,payload:{symbols:[i.id]}},s),c=this.extend(o,{messageHash:r,symbol:t});return await this.watch(a,r,o,r,c)}async watchPrivate(e,t={}){await this.loadMarkets();const s="/api/v1/account",i=this.urls.api.ws,r=this.requestId().toString(),a={timestamp:this.milliseconds(),apiKey:this.apiKey},n=this.urlencode(this.keysort(a)),o=this.deepExtend({destination:e,correlationId:r,payload:a},t);o.payload.signature=this.hmac(this.encode(n),this.encode(this.secret));const c=this.extend(o,{messageHash:s});return await this.watch(i,s,o,s,c)}async watchBalance(e={}){return await this.loadMarkets(),await this.watchPrivate("/api/v1/account",e)}async watchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i="/api/v1/ticker/24hr",r=i+":"+e,a=this.urls.api.ws,n=this.requestId().toString(),o=this.deepExtend({destination:i,correlationId:n,payload:{symbol:s.id}},t),c=this.extend(o,{messageHash:r,symbol:e});return await this.watch(a,r,o,r,c)}async watchTrades(e,t,s,i={}){const r=await this.watchPublic("trades.subscribe",e,i);return this.newUpdates&&(s=r.getLimit(e,s)),this.filterBySinceLimit(r,t,s,"timestamp",!0)}async watchOrderBook(e,t,s={}){return(await this.watchPublic("depthMarketData.subscribe",e,s)).limit(t)}async watchOHLCV(e,t="1m",s,i,r={}){const a="OHLCMarketData.subscribe",n=a+":"+t,o={destination:a,payload:{intervals:[this.safeValue(this.options,"timeframes")[t]]}},c=await this.watchPublic(n,e,this.extend(o,r));return this.newUpdates&&(i=c.getLimit(e,i)),this.filterBySinceLimit(c,s,i,0,!0)}handleDeltas(e,t){const s=Object.keys(t);for(let i=0;i<s.length;i++){const r=s[i],a=t[r];e.store(parseFloat(r),parseFloat(a))}}handleOrderBook(e,t){const s=this.safeValue(t,"payload",{}),i=this.safeValue(s,"data",{}),r=this.safeString(s,"symbol"),a=this.safeSymbol(r,void 0,"/"),n="depthMarketData.subscribe:"+a,o=this.safeInteger(i,"ts");let c=this.safeValue(this.orderbooks,a);void 0===c&&(c=this.orderBook()),c.reset({timestamp:o,datetime:this.iso8601(o)});const d=this.safeValue(i,"bid",{}),h=this.safeValue(i,"ofr",{});this.handleDeltas(c.bids,d),this.handleDeltas(c.asks,h),this.orderbooks[a]=c,e.resolve(c,n)}handleMessage(e,t){const s=this.safeString(t,"correlationId");if(void 0!==s){const i=this.indexBy(e.subscriptions,"correlationId"),r=this.safeString(t,"status"),a=this.safeValue(i,s);if(void 0!==a&&"OK"===r){const s=this.safeString(a,"destination");if(void 0!==s){const i={"/api/v1/ticker/24hr":this.handleTicker,"/api/v1/account":this.handleBalance},r=this.safeValue(i,s);return void 0===r?t:r.call(this,e,t,a)}}}const i=this.safeString(t,"destination");if(void 0!==i){const s={"marketdepth.event":this.handleOrderBook,"internal.trade":this.handleTrades,"ohlc.event":this.handleOHLCV,ping:this.handlePong},r=this.safeValue(s,i);return void 0===r?t:r.call(this,e,t)}}}},320:(e,t,s)=>{"use strict";const i=s(1853),{ExchangeError:r,AuthenticationError:a}=s(3449),{ArrayCache:n,ArrayCacheBySymbolById:o}=s(9584);e.exports=class extends i.ftx{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchOrderBook:!0,watchTicker:!0,watchTrades:!0,watchOHLCV:!1,watchBalance:!1,watchOrders:!0,watchMyTrades:!0},urls:{api:{ws:"wss://{hostname}/ws"}},options:{ordersLimit:1e3,tradesLimit:1e3},streaming:{ping:this.ping,keepAlive:15e3},exceptions:{exact:{"Invalid login credentials":a,"Not logged in":a}}})}async watchPublic(e,t,s={}){await this.loadMarkets();const i=this.market(e).id,r=this.implodeParams(this.urls.api.ws,{hostname:this.hostname}),a={op:"subscribe",channel:t,market:i},n=t+":"+i;return await this.watch(r,n,a,n)}async watchPrivate(e,t,s={}){await this.loadMarkets();let i=e;if(void 0!==t){i=i+":"+this.market(t).id}await this.authenticate();const r=this.implodeParams(this.urls.api.ws,{hostname:this.hostname}),a={op:"subscribe",channel:e};return await this.watch(r,i,a,e)}authenticate(e={}){const t=this.implodeParams(this.urls.api.ws,{hostname:this.hostname}),s=this.client(t),i="authenticate",r="login";if(!(i in s.subscriptions)){this.checkRequiredCredentials(),s.subscriptions.authenticate=!0;const e=this.milliseconds(),i=e.toString()+"websocket_login",a=this.hmac(this.encode(i),this.encode(this.secret),"sha256","hex"),n={key:this.apiKey,time:e,sign:a},o=this.safeValue(this.options,"sign",{}),c=this.safeString(o,this.hostname,"FTX"),d=this.safeString(this.headers,c+"-SUBACCOUNT");void 0!==d&&(n.subaccount=d);const h={args:n,op:r};this.watch(t,r,h).resolve(!0)}return s.future(r)}async watchTicker(e,t={}){return await this.watchPublic(e,"ticker")}async watchTrades(e,t,s,i={}){const r=await this.watchPublic(e,"trades");return this.newUpdates&&(s=r.getLimit(e,s)),this.filterBySinceLimit(r,t,s,"timestamp",!0)}async watchOrderBook(e,t,s={}){return(await this.watchPublic(e,"orderbook")).limit(t)}handlePartial(e,t){const s={orderbook:this.handleOrderBookSnapshot},i=this.safeString(t,"channel"),r=this.safeValue(s,i);r&&r.call(this,e,t)}handleUpdate(e,t){const s={trades:this.handleTrade,ticker:this.handleTicker,orderbook:this.handleOrderBookUpdate,orders:this.handleOrder,fills:this.handleMyTrade},i=this.safeString(t,"channel"),r=this.safeValue(s,i);r&&r.call(this,e,t)}handleMessage(e,t){const s={partial:this.handleOrderBookSnapshot,update:this.handleUpdate,subscribed:this.handleSubscriptionStatus,unsubscribed:this.handleUnsubscriptionStatus,info:this.handleInfo,error:this.handleError,pong:this.handlePong},i=this.safeString(t,"type"),r=this.safeValue(s,i);r&&r.call(this,e,t)}getMessageHash(e){return this.safeString(e,"channel")+":"+this.safeString(e,"market")}handleTicker(e,t){const s=this.safeValue(t,"data",{}),i=this.safeString(t,"market");if(i in this.markets_by_id){const r=this.markets_by_id[i],a=this.parseTicker(s,r),n=a.symbol;this.tickers[n]=a;const o=this.getMessageHash(t);e.resolve(a,o)}return t}handleOrderBookSnapshot(e,t){const s=this.safeValue(t,"data",{}),i=this.safeString(t,"market");if(i in this.markets_by_id){const r=this.markets_by_id[i].symbol,a=this.safeValue(this.options,"watchOrderBook",{}),n=this.safeInteger(a,"limit",400),o=this.orderBook({},n);this.orderbooks[r]=o;const c=this.safeTimestamp(s,"time"),d=this.parseOrderBook(s,r,c);o.reset(d),this.orderbooks[r]=o;const h=this.getMessageHash(t);e.resolve(o,h)}}handleDelta(e,t){const s=this.safeFloat(t,0),i=this.safeFloat(t,1);e.store(s,i)}handleDeltas(e,t){for(let s=0;s<t.length;s++)this.handleDelta(e,t[s])}handleOrderBookUpdate(e,t){const s=this.safeValue(t,"data",{}),i=this.safeString(t,"market");if(i in this.markets_by_id){const r=this.markets_by_id[i].symbol,a=this.orderbooks[r];this.handleDeltas(a.asks,this.safeValue(s,"asks",[])),this.handleDeltas(a.bids,this.safeValue(s,"bids",[]));const n=this.safeTimestamp(s,"time");a.timestamp=n,a.datetime=this.iso8601(n),this.orderbooks[r]=a;const o=this.getMessageHash(t);e.resolve(a,o)}}handleTrade(e,t){const s=this.safeValue(t,"data",{}),i=this.safeString(t,"market");if(i in this.markets_by_id){const r=this.markets_by_id[i],a=r.symbol,o=this.getMessageHash(t),c=this.safeInteger(this.options,"tradesLimit",1e3);let d=this.safeValue(this.trades,a);if(void 0===d&&(d=new n(c),this.trades[a]=d),Array.isArray(s)){const e=this.parseTrades(s,r);for(let t=0;t<e.length;t++)d.append(e[t])}else{const e=this.parseTrade(t,r);d.append(e)}e.resolve(d,o)}return t}handleSubscriptionStatus(e,t){return t}handleUnsubscriptionStatus(e,t){return t}handleInfo(e,t){return t}handleError(e,t){const s=this.safeString(t,"msg"),i=this.safeValue(this.exceptions.exact,s);if(void 0===i){const t=new r(s);e.reject(t)}else{if(i instanceof a){const t="authenticate";t in e.subscriptions&&delete e.subscriptions[t]}const t=new i(s);e.reject(t,"fills"),e.reject(t,"orders")}return t}ping(e){return{op:"ping"}}handlePong(e,t){return e.lastPong=this.milliseconds(),t}async watchOrders(e,t,s,i={}){await this.loadMarkets();const r=await this.watchPrivate("orders",e);return this.newUpdates&&(s=r.getLimit(e,s)),this.filterBySymbolSinceLimit(r,e,t,s,!0)}handleOrder(e,t){const s=this.safeString(t,"channel"),i=this.safeValue(t,"data"),r=this.parseOrder(i),a=this.market(r.symbol);if(void 0===this.orders){const e=this.safeInteger(this.options,"ordersLimit",1e3);this.orders=new o(e)}const n=this.orders;n.append(r),e.resolve(n,s);const c=s+":"+a.id;e.resolve(n,c)}async watchMyTrades(e,t,s,i={}){await this.loadMarkets();const r=await this.watchPrivate("fills",e);return this.newUpdates&&(s=r.getLimit(e,s)),this.filterBySymbolSinceLimit(r,e,t,s,!0)}handleMyTrade(e,t){const s=this.safeString(t,"channel"),i=this.safeValue(t,"data",{}),r=this.parseTrade(i),a=this.market(r.symbol);if(void 0===this.myTrades){const e=this.safeInteger(this.options,"tradesLimit",1e3);this.myTrades=new o(e)}const n=this.myTrades;n.append(r),e.resolve(n,s);const c=s+":"+a.id;e.resolve(n,c)}}},5872:(e,t,s)=>{"use strict";const i=s(1853),{ExchangeError:r,AuthenticationError:a}=s(3449),{ArrayCache:n,ArrayCacheByTimestamp:o,ArrayCacheBySymbolById:c}=s(9584);e.exports=class extends i.gateio{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchOrderBook:!0,watchTicker:!0,watchTickers:!1,watchTrades:!0,watchOHLCV:!0,watchBalance:!0,watchOrders:!0},urls:{api:{ws:"wss://ws.gate.io/v3"}},options:{tradesLimit:1e3,OHLCVLimit:1e3,watchTradesSubscriptions:{},watchTickerSubscriptions:{},watchOrderBookSubscriptions:{}}})}async watchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),a=i.id,n=i.uppercaseId,o=this.nonce(),c=this.urls.api.ws,d=this.safeValue(this.options,"watchOrderBook",{}),h=this.safeInteger(d,"limit",30);if(t){if(1!==t&&5!==t&&10!==t&&20!==t&&30!==t)throw new r(this.id+" watchOrderBook limit argument must be undefined, 1, 5, 10, 20, or 30")}else t=h;const u=this.safeString(s,"interval","0.00000001"),l=parseFloat(u),f=-1*Math.log10(l);if(f<0||f>8||f%1!=0)throw new r(this.id+" invalid interval");const p=[n,t,u],m=this.safeValue(d,"subscriptions",{});m[e]=p,d.subscriptions=m,this.options.watchOrderBook=d;const b="depth.update:"+a,g={id:o,method:"depth.subscribe",params:Object.values(m)},y={id:o};return(await this.watch(c,b,g,b,y)).limit(t)}handleDelta(e,t){const s=this.safeFloat(t,0),i=this.safeFloat(t,1);e.store(s,i)}handleDeltas(e,t){for(let s=0;s<t.length;s++)this.handleDelta(e,t[s])}handleOrderBook(e,t){const s=this.safeValue(t,"params",[]),i=this.safeValue(s,0),r=this.safeValue(s,1),a=this.safeStringLower(s,2),n=this.safeSymbol(a),o=this.safeString(t,"method")+":"+a;let c;const d=this.safeValue(this.options,"watchOrderBook",{}),h=this.safeValue(d,"subscriptions",{}),u=this.safeValue(h,n,[]),l=this.safeInteger(d,"limit",30),f=this.safeValue(u,1,l);i?(c=this.orderBook({},f),this.orderbooks[n]=c):c=this.orderbooks[n],this.handleDeltas(c.asks,this.safeValue(r,"asks",[])),this.handleDeltas(c.bids,this.safeValue(r,"bids",[])),e.resolve(c,o)}async watchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i=s.id,r=s.uppercaseId,a=this.nonce(),n=this.urls.api.ws,o=this.safeValue(this.options,"watchTicker",{}),c=this.safeValue(o,"subscriptions",{});c[r]=!0,o.subscriptions=c,this.options.watchTicker=o;const d={id:a,method:"ticker.subscribe",params:Object.keys(c)},h={id:a},u="ticker.update:"+i;return await this.watch(n,u,d,u,h)}handleTicker(e,t){const s=this.safeValue(t,"params",[]),i=this.safeStringLower(s,0),r=this.safeMarket(i,void 0,"_"),a=r.symbol,n=this.safeValue(s,1,{}),o=this.parseTicker(n,r),c=t.method+":"+i;this.tickers[a]=o,e.resolve(o,c)}async watchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a=r.id,n=r.uppercaseId,o=this.nonce(),c=this.urls.api.ws,d=this.safeValue(this.options,"watchTrades",{}),h=this.safeValue(d,"subcsriptions",{});h[n]=!0,d.subscriptions=h,this.options.watchTrades=d;const u={id:o,method:"trades.subscribe",params:Object.keys(h)},l={id:o},f="trades.update:"+a,p=await this.watch(c,f,u,f,l);return this.newUpdates&&(s=p.getLimit(e,s)),this.filterBySinceLimit(p,t,s,"timestamp",!0)}handleTrades(e,t){const s=this.safeValue(t,"params",[]),i=this.safeStringLower(s,0),r=this.safeMarket(i,void 0,"_"),a=r.symbol;let o=this.safeValue(this.trades,a);if(void 0===o){const e=this.safeInteger(this.options,"tradesLimit",1e3);o=new n(e),this.trades[a]=o}const c=this.safeValue(s,1,[]),d=this.parseTrades(c,r);for(let e=0;e<d.length;e++)o.append(d[e]);const h=t.method+":"+i;e.resolve(o,h)}async watchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n=a.id,o=a.uppercaseId,c=this.nonce(),d=this.urls.api.ws,h={id:c,method:"kline.subscribe",params:[o,this.timeframes[t]]},u={id:c},l="kline.update:"+n,f=await this.watch(d,l,h,l,u);return this.newUpdates&&(i=f.getLimit(e,i)),this.filterBySinceLimit(f,s,i,0,!0)}handleOHLCV(e,t){const s=this.safeValue(t,"params",[]),i=this.safeValue(s,0,[]),r=this.safeStringLower(i,7),a=[this.safeTimestamp(i,0),this.safeNumber(i,1),this.safeNumber(i,3),this.safeNumber(i,4),this.safeNumber(i,2),this.safeNumber(i,5)],n=this.safeSymbol(r,void 0,"_");let c=this.safeValue(this.ohlcvs,n);if(void 0===c){const e=this.safeInteger(this.options,"OHLCVLimit",1e3);c=new o(e),this.ohlcvs[n]=c}c.append(a);const d=t.method+":"+r;e.resolve(c,d)}async authenticate(e={}){const t=this.urls.api.ws,s=this.client(t),i=s.future("authenticated"),r="server.sign";if(void 0===this.safeValue(s.subscriptions,r)){const e=this.milliseconds(),s=e.toString(),i=this.hmac(this.encode(s),this.encode(this.secret),"sha512","base64"),a={id:e,method:r,params:[this.apiKey,i,e]},n={id:e,method:this.handleAuthenticationMessage};this.spawn(this.watch,t,e,a,r,n)}return await i}async watchBalance(e={}){await this.loadMarkets(),this.checkRequiredCredentials();const t=this.urls.api.ws;await this.authenticate();const s=this.nonce(),i="balance.update",r={id:s,method:"balance.subscribe",params:[]},a={id:s,method:this.handleBalanceSubscription};return await this.watch(t,i,r,i,a)}async fetchBalanceSnapshot(){await this.loadMarkets(),this.checkRequiredCredentials();const e=this.urls.api.ws;await this.authenticate();const t=this.nonce(),s="balance.query",i={id:t,method:s,params:[]},r={id:t,method:this.handleBalanceSnapshot};return await this.watch(e,t,i,s,r)}handleBalanceSnapshot(e,t){const s=t.id,i=t.result;this.handleBalanceMessage(e,s,i),"balance.query"in e.subscriptions&&delete e.subscriptions["balance.query"]}handleBalance(e,t){const s=t.method,i=t.params[0];this.handleBalanceMessage(e,s,i)}handleBalanceMessage(e,t,s){const i=Object.keys(s);for(let e=0;e<i.length;e++){const t=this.account(),r=i[e],a=this.safeCurrencyCode(r),n=s[r];t.free=this.safeNumber(n,"available"),t.used=this.safeNumber(n,"freeze"),this.balance[a]=t}this.balance=this.parseBalance(this.balance,!1),e.resolve(this.balance,t)}async watchOrders(e,t,s,i={}){this.checkRequiredCredentials(),await this.loadMarkets();const r="order.update";let a,n=r;void 0!==e&&(a=this.market(e),n=r+":"+a.id);const o=this.urls.api.ws;await this.authenticate();const c=this.nonce(),d={id:c,method:"order.subscribe",params:[]},h={id:c},u=await this.watch(o,n,d,r,h);return this.newUpdates&&(s=u.getLimit(e,s)),this.filterBySinceLimit(u,t,s,"timestamp",!0)}handleOrder(e,t){const s=this.safeString(t,"method"),i=this.safeValue(t,"params"),r=this.safeInteger(i,0),a=this.safeValue(i,1),n=this.safeStringLower(a,"market"),o=this.safeMarket(n,void 0,"_"),d=this.parseOrder(a,o);if(1===r)d.status="open";else if(2===r)d.status="open";else if(3===r){const e=this.safeFloat(d,"filled"),t=this.safeFloat(d,"amount");d.status=void 0!==e&&void 0!==t?e>=t?"closed":"canceled":"closed"}if(void 0===this.orders){const e=this.safeInteger(this.options,"ordersLimit",1e3);this.orders=new c(e)}const h=this.orders;h.append(d);const u=s+":"+n;e.resolve(h,s),e.resolve(h,u)}handleAuthenticationMessage(e,t,s){const i=this.safeValue(t,"result");if("success"===this.safeString(i,"status")){const t=this.safeValue(e.futures,"authenticated");void 0!==t&&t.resolve(!0)}else{const t=new a("not success");e.reject(t,"authenticated"),"server.sign"in e.subscriptions&&delete e.subscriptions["server.sign"]}}handleErrorMessage(e,t){const s=this.safeValue(t,"error",{}),i=this.safeInteger(s,"code");if(11===i||6===i){const s=new a("invalid credentials");e.reject(s,t.id),e.reject(s,"authenticated")}}handleBalanceSubscription(e,t,s){this.spawn(this.fetchBalanceSnapshot)}handleSubscriptionStatus(e,t){const s=this.safeInteger(t,"id"),i=this.indexBy(e.subscriptions,"id"),r=this.safeValue(i,s,{}),a=this.safeValue(r,"method");void 0!==a&&a.call(this,e,t,r),e.resolve(t,s)}handleMessage(e,t){this.handleErrorMessage(e,t);const s={"depth.update":this.handleOrderBook,"ticker.update":this.handleTicker,"trades.update":this.handleTrades,"kline.update":this.handleOHLCV,"balance.update":this.handleBalance,"order.update":this.handleOrder},i=this.safeString(t,"method"),r=this.safeValue(s,i);if(void 0===r){void 0!==this.safeInteger(t,"id")&&this.handleSubscriptionStatus(e,t)}else r.call(this,e,t)}}},1937:(e,t,s)=>{"use strict";const i=s(1853),{ArrayCache:r,ArrayCacheBySymbolById:a}=s(9584);e.exports=class extends i.gopax{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchOrderBook:!0,watchMyTrades:!0,watchBalance:!0,watchOrders:!0},urls:{api:{ws:"wss://wsapi.gopax.co.kr"}},options:{tradesLimit:1e3,ordersLimit:1e3,OHLCVLimit:1e3}})}getSignedUrl(){const e=this.safeValue(this.options,"ws",{});if("url"in e)return e.url;this.checkRequiredCredentials();const t=this.nonce().toString(),s="t"+t,i=this.base64ToBinary(this.secret),r=this.hmac(this.encode(s),i,"sha512","base64"),a={apiKey:this.apiKey,timestamp:t,signature:r},n=this.urls.api.ws+"?"+this.urlencode(a);return e.url=n,this.options.ws=e,n}async watchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),r="orderbook",a=r+":"+i.id,n=this.getSignedUrl(),o={n:"SubscribeToOrderBook",o:{tradingPairName:i.id}},c={messageHash:a,name:r,symbol:e,marketId:i.id,method:this.handleOrderBook,limit:t,params:s},d=this.extend(o,s);return(await this.watch(n,a,d,a,c)).limit(t)}handleDelta(e,t,s){const i=this.safeInteger(s,"entryId");if(void 0!==e.nonce&&i>=e.nonce){const e=this.safeFloat(s,"price"),i=this.safeFloat(s,"volume");t.store(e,i)}return i}handleDeltas(e,t,s){let i=0;for(let r=0;r<s.length;r++){const a=this.handleDelta(e,t,s[r]);i=Math.max(i,a)}return i}handleOrderBookMessage(e,t,s){const i=this.safeValue(t,"o",{}),r=this.handleDeltas(s,s.asks,this.safeValue(i,"ask",[])),a=this.handleDeltas(s,s.bids,this.safeValue(i,"bid",[])),n=Math.max(r,a);return s.nonce=n,s}handleOrderBook(e,t){const s=this.safeString(t,"n"),i=this.safeValue(t,"o"),r=this.safeString(i,"tradingPairName"),a=this.safeMarket(r,void 0,"-"),n=a.symbol,o="orderbook:"+a.id,c=this.safeValue(e.subscriptions,o,{}),d=this.safeInteger(c,"limit");n in this.orderbooks||(this.orderbooks[n]=this.orderBook({},d));const h=this.safeValue(this.orderbooks,n);if("SubscribeToOrderBook"===s){h.nonce=0,this.handleOrderBookMessage(e,t,h);for(let t=0;t<h.cache.length;t++){const s=h.cache[t];this.handleOrderBookMessage(e,s,h)}e.resolve(h,o)}else void 0===h.nonce?h.cache.push(t):(this.handleOrderBookMessage(e,t,h),e.resolve(h,o))}async watchOrders(e,t,s,i={}){await this.loadMarkets();const r="orders";let a=r;void 0!==e&&(a+=":"+e);const n=this.getSignedUrl(),o={messageHash:a,name:r,symbol:e,method:this.handleOrderBook,limit:s,params:i},c=this.extend({n:"SubscribeToOrders",o:{}},i),d=await this.watch(n,a,c,"orders",o);return this.newUpdates&&(s=d.getLimit(e,s)),this.filterBySymbolSinceLimit(d,e,t,s,!0)}parseWsOrderStatus(e){return this.safeString({1:"open",2:"canceled",3:"closed",4:"open"},e,e)}parseWsOrderType(e){return this.safeString({1:"limit",2:"market"},e,e)}parseWsOrderSide(e){return this.safeString({1:"buy",2:"sell"},e,e)}parseWsTimeInForce(e){return this.safeString({0:"GTC",1:"PO",2:"IOC",3:"FOK"},e,e)}parseWsOrder(e,t){const s=this.safeString(e,"orderId"),i=this.safeString(e,"clientOrderId"),r=this.safeTimestamp(e,"createdAt"),a=this.parseWsOrderType(this.safeString(e,"type")),n=this.parseWsOrderSide(this.safeString(e,"side")),o=this.parseWsTimeInForce(this.safeString(e,"timeInForce")),c=this.safeFloat(e,"price"),d=this.safeFloat(e,"orgAmount"),h=this.safeFloat(e,"stopPrice"),u=this.safeFloat(e,"remainAmount"),l=this.safeString(e,"tradingPairName");t=this.safeMarket(l,t,"-");const f=this.parseWsOrderStatus(this.safeString(e,"status"));let p,m,b=this.safeFloat(e,"tradedBaseAmount"),g=this.safeFloat(e,"tradedQuoteAmount");void 0!==d&&void 0!==u&&(b=Math.max(0,d-u),b>0&&(p=this.safeTimestamp(e,"updatedAt")),void 0!==c&&(g=b*c)),void 0!==o&&(m="PO"===o);return{id:s,clientOrderId:i,datetime:this.iso8601(r),timestamp:r,lastTradeTimestamp:p,status:f,symbol:t.symbol,type:a,timeInForce:o,postOnly:m,side:n,price:c,stopPrice:h,average:c,amount:d,filled:b,remaining:u,cost:g,trades:void 0,fee:undefined,info:e}}handleOrder(e,t,s,i){const r=this.parseWsOrder(s);if(void 0===this.orders){const e=this.safeInteger(this.options,"ordersLimit",1e3);this.orders=new a(e)}return this.orders.append(r),r}handleOrders(e,t){const s=this.safeValue(t,"o",[]),i=this.safeValue(s,"data"),r="orders";if(void 0===i){const s=this.handleOrder(e,t,i).symbol;e.resolve(this.orders,r),e.resolve(this.orders,"orders:"+s)}else{const s=i.length;if(s>0){const a={};for(let r=0;r<s;r++){a[this.handleOrder(e,t,i[r]).symbol]=!0}e.resolve(this.orders,r);const n=Object.keys(a);for(let t=0;t<n.length;t++){const s=n[t];e.resolve(this.orders,"orders:"+s)}}}}async watchMyTrades(e,t,s,i={}){await this.loadMarkets();const r="myTrades";let a=r;void 0!==e&&(a+=":"+e);const n=this.getSignedUrl(),o={messageHash:a,name:r,symbol:e,method:this.handleMyTrades,limit:s,params:i},c=this.extend({n:"SubscribeToTrades",o:{}},i),d=await this.watch(n,a,c,"myTrades",o);return this.newUpdates&&(s=d.getLimit(e,s)),this.filterBySinceLimit(d,t,s,"timestamp",!0)}handleMyTrades(e,t){const s=this.safeValue(t,"o",{}),i="myTrades",a=this.parseTrade(s),n=a.symbol;let o=this.safeValue(this.myTrades,n);if(void 0===o){const e=this.safeInteger(this.options,"tradesLimit",1e3);o=new r(e)}o.append(a),this.myTrades[n]=o,e.resolve(o,i),e.resolve(o,"myTrades:"+n)}async watchBalance(e={}){await this.loadMarkets();const t="balance",s=t,i=this.getSignedUrl(),r={messageHash:s,name:t,params:e},a=this.extend({n:"SubscribeToBalances",o:{}},e);return await this.watch(i,s,a,s,r)}handleBalance(e,t){const s=this.safeValue(t,"o"),i=this.safeValue(s,"data");if(void 0===i){const e=this.parseBalanceResponse([s]);this.balance=this.parseBalance(this.extend(this.balance,e))}else this.balance=this.parseBalanceResponse(i);e.resolve(this.balance,"balance")}async pong(e,t){const s=JSON.parse(t).split("::"),i="primus::pong::"+this.safeString(s,2);await e.send(i)}handlePing(e,t){this.spawn(this.pong,e,t)}handleMessage(e,t){if("string"==typeof t)this.handlePing(e,t);else{const s={OrderBookEvent:this.handleOrderBook,SubscribeToOrderBook:this.handleOrderBook,TradeEvent:this.handleMyTrades,SubscribeToOrders:this.handleOrders,OrderEvent:this.handleOrders,SubscribeToBalances:this.handleBalance,BalanceEvent:this.handleBalance},i=this.safeString(t,"n"),r=this.safeValue(s,i);if(void 0!==r)return r.call(this,e,t)}return t}}},1004:(e,t,s)=>{"use strict";const i=s(1853),{ArrayCache:r,ArrayCacheByTimestamp:a}=s(9584);e.exports=class extends i.hitbtc{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchTicker:!0,watchTickers:!1,watchTrades:!0,watchOrderBook:!0,watchBalance:!1,watchOHLCV:!0},urls:{api:{ws:"wss://api.hitbtc.com/api/2/ws"}},options:{tradesLimit:1e3,methods:{orderbook:"subscribeOrderbook",ticker:"subscribeTicker",trades:"subscribeTrades",ohlcv:"subscribeCandles"}}})}async watchPublic(e,t,s,i={}){await this.loadMarkets();const r=this.marketId(e),a=this.urls.api.ws;let n=t+":"+r;void 0!==s&&(n+=":"+s);const o=this.safeValue(this.options,"methods",{}),c={method:this.safeString(o,t,t),params:{symbol:r},id:this.nonce()},d=this.deepExtend(c,i);return await this.watch(a,n,d,n)}async watchOrderBook(e,t,s={}){return(await this.watchPublic(e,"orderbook",void 0,s)).limit(t)}handleOrderBookSnapshot(e,t){const s=this.safeValue(t,"params",{}),i=this.safeString(s,"symbol"),r=this.safeMarket(i).symbol,a=this.parse8601(this.safeString(s,"timestamp")),n=this.safeInteger(s,"sequence");r in this.orderbooks&&delete this.orderbooks[r];const o=this.parseOrderBook(s,r,a,"bid","ask","price","size"),c=this.orderBook(o);c.nonce=n,this.orderbooks[r]=c;const d="orderbook:"+i;e.resolve(c,d)}handleOrderBookUpdate(e,t){const s=this.safeValue(t,"params",{}),i=this.safeString(s,"symbol"),r=this.safeMarket(i).symbol;if(r in this.orderbooks){const t=this.parse8601(this.safeString(s,"timestamp")),a=this.safeInteger(s,"sequence"),n=this.orderbooks[r],o=this.safeValue(s,"ask",[]),c=this.safeValue(s,"bid",[]);this.handleDeltas(n.asks,o),this.handleDeltas(n.bids,c),n.timestamp=t,n.datetime=this.iso8601(t),n.nonce=a,this.orderbooks[r]=n;const d="orderbook:"+i;e.resolve(n,d)}}handleDelta(e,t){const s=this.safeFloat(t,"price"),i=this.safeFloat(t,"size");e.store(s,i)}handleDeltas(e,t){for(let s=0;s<t.length;s++)this.handleDelta(e,t[s])}async watchTicker(e,t={}){return await this.watchPublic(e,"ticker",void 0,t)}handleTicker(e,t){const s=this.safeValue(t,"params"),i=this.safeValue(s,"symbol"),r=this.safeMarket(i),a=r.symbol,n=this.parseTicker(s,r);this.tickers[a]=n;const o=this.safeValue(t,"method")+":"+i;e.resolve(n,o)}async watchTrades(e,t,s,i={}){const r=await this.watchPublic(e,"trades",void 0,i);return this.newUpdates&&(s=r.getLimit(e,s)),this.filterBySinceLimit(r,t,s,"timestamp",!0)}handleTrades(e,t){const s=this.safeValue(t,"params",{}),i=this.safeValue(s,"data",[]),a=this.safeString(s,"symbol"),n=this.safeMarket(a),o=n.symbol,c="trades:"+a,d=this.safeInteger(this.options,"tradesLimit",1e3);let h=this.safeValue(this.trades,o);if(void 0===h&&(h=new r(d),this.trades[o]=h),Array.isArray(i)){const e=this.parseTrades(i,n);for(let t=0;t<e.length;t++)h.append(e[t])}else{const e=this.parseTrade(t,n);h.append(e)}return e.resolve(h,c),t}async watchOHLCV(e,t="1m",s,i,r={}){const a=this.timeframes[t],n={params:{period:a}},o=this.deepExtend(n,r),c=await this.watchPublic(e,"ohlcv",a,o);return this.newUpdates&&(i=c.getLimit(e,i)),this.filterBySinceLimit(c,s,i,0,!0)}handleOHLCV(e,t){const s=this.safeValue(t,"params",{}),i=this.safeValue(s,"data",[]),r=this.safeString(s,"symbol"),n=this.safeMarket(r),o=n.symbol,c=this.safeString(s,"period"),d=this.findTimeframe(c),h="ohlcv:"+r+":"+c;for(let t=0;t<i.length;t++){const s=i[t],r=this.parseOHLCV(s,n);this.ohlcvs[o]=this.safeValue(this.ohlcvs,o,{});let c=this.safeValue(this.ohlcvs[o],d);if(void 0===c){const e=this.safeInteger(this.options,"OHLCVLimit",1e3);c=new a(e),this.ohlcvs[o][d]=c}c.append(r),e.resolve(c,h)}return t}handleNotification(e,t){return t}handleMessage(e,t){const s={snapshotOrderbook:this.handleOrderBookSnapshot,updateOrderbook:this.handleOrderBookUpdate,ticker:this.handleTicker,snapshotTrades:this.handleTrades,updateTrades:this.handleTrades,snapshotCandles:this.handleOHLCV,updateCandles:this.handleOHLCV},i=this.safeString(t,"method"),r=this.safeValue(s,i);void 0===r?this.handleNotification(e,t):r.call(this,e,t)}}},4560:(e,t,s)=>{"use strict";const{NotSupported:i}=s(3449),r=s(5556);e.exports=class extends r{describe(){return this.deepExtend(super.describe(),{id:"huobijp",name:"Huobi Japan",countries:["JP"],hostname:"api-cloud.huobi.co.jp",has:{fetchDepositAddress:!1},urls:{logo:"https://user-images.githubusercontent.com/1294454/85734211-85755480-b705-11ea-8b35-0b7f1db33a2f.jpg",api:{ws:{api:{public:"wss://{hostname}/ws",private:"wss://{hostname}/ws"}},market:"https://{hostname}",public:"https://{hostname}",private:"https://{hostname}"},www:"https://www.huobi.co.jp",referral:"https://www.huobi.co.jp/register/?invite_code=znnq3",doc:"https://api-doc.huobi.co.jp",fees:"https://www.huobi.co.jp/support/fee"}})}async fetchDepositAddress(e,t={}){throw new i(this.id+" fetchDepositAddress not supported yet")}}},5556:(e,t,s)=>{"use strict";const i=s(1853),{ExchangeError:r}=s(3449),{ArrayCache:a,ArrayCacheByTimestamp:n}=s(9584);e.exports=class extends i.huobipro{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchOrderBook:!0,watchTickers:!1,watchTicker:!0,watchTrades:!0,watchBalance:!1,watchOHLCV:!0},urls:{api:{ws:{api:{public:"wss://{hostname}/ws",private:"wss://{hostname}/ws/v2"},"api-aws":{public:"wss://api-aws.huobi.pro/ws",private:"wss://api-aws.huobi.pro/ws/v2"}}}},options:{tradesLimit:1e3,OHLCVLimit:1e3,api:"api",ws:{gunzip:!0}}})}requestId(){const e=this.sum(this.safeInteger(this.options,"requestId",0),1);return this.options.requestId=e,e.toString()}async watchTicker(e,t={}){await this.loadMarkets();const s="market."+this.market(e).id+".detail",i=this.safeString(this.options,"api","api"),r={hostname:this.hostname},a=this.implodeParams(this.urls.api.ws[i].public,r),n=this.requestId(),o={sub:s,id:n},c={id:n,messageHash:s,symbol:e,params:t};return await this.watch(a,s,this.extend(o,t),s,c)}handleTicker(e,t){const s=this.safeValue(t,"tick",{}),i=this.safeString(t,"ch"),r=i.split("."),a=this.safeString(r,1),n=this.safeMarket(a),o=this.parseTicker(s,n),c=this.safeValue(t,"ts");o.timestamp=c,o.datetime=this.iso8601(c);const d=o.symbol;return this.tickers[d]=o,e.resolve(o,i),t}async watchTrades(e,t,s,i={}){await this.loadMarkets();const r="market."+this.market(e).id+".trade.detail",a=this.safeString(this.options,"api","api"),n={hostname:this.hostname},o=this.implodeParams(this.urls.api.ws[a].public,n),c=this.requestId(),d={sub:r,id:c},h={id:c,messageHash:r,symbol:e,params:i},u=await this.watch(o,r,this.extend(d,i),r,h);return this.newUpdates&&(s=u.getLimit(e,s)),this.filterBySinceLimit(u,t,s,"timestamp",!0)}handleTrades(e,t){const s=this.safeValue(t,"tick",{}),i=this.safeValue(s,"data",{}),r=this.safeString(t,"ch"),n=r.split("."),o=this.safeString(n,1),c=this.safeMarket(o),d=c.symbol;let h=this.safeValue(this.trades,d);if(void 0===h){const e=this.safeInteger(this.options,"tradesLimit",1e3);h=new a(e),this.trades[d]=h}for(let e=0;e<i.length;e++){const t=this.parseTrade(i[e],c);h.append(t)}return e.resolve(h,r),t}async watchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n=this.timeframes[t],o="market."+a.id+".kline."+n,c=this.safeString(this.options,"api","api"),d={hostname:this.hostname},h=this.implodeParams(this.urls.api.ws[c].public,d),u=this.requestId(),l={sub:o,id:u},f={id:u,messageHash:o,symbol:e,timeframe:t,params:r},p=await this.watch(h,o,this.extend(l,r),o,f);return this.newUpdates&&(i=p.getLimit(e,i)),this.filterBySinceLimit(p,s,i,0,!0)}handleOHLCV(e,t){const s=this.safeString(t,"ch"),i=s.split("."),r=this.safeString(i,1),a=this.safeMarket(r),o=a.symbol,c=this.safeString(i,3),d=this.findTimeframe(c);this.ohlcvs[o]=this.safeValue(this.ohlcvs,o,{});let h=this.safeValue(this.ohlcvs[o],d);if(void 0===h){const e=this.safeInteger(this.options,"OHLCVLimit",1e3);h=new n(e),this.ohlcvs[o][d]=h}const u=this.safeValue(t,"tick"),l=this.parseOHLCV(u,a);h.append(l),e.resolve(h,s)}async watchOrderBook(e,t,s={}){if(void 0!==t&&150!==t)throw new r(this.id+" watchOrderBook accepts limit = 150 only");await this.loadMarkets();t=void 0===t?150:t;const i="market."+this.market(e).id+".mbp."+t.toString(),a=this.safeString(this.options,"api","api"),n={hostname:this.hostname},o=this.implodeParams(this.urls.api.ws[a].public,n),c=this.requestId(),d={sub:i,id:c},h={id:c,messageHash:i,symbol:e,limit:t,params:s,method:this.handleOrderBookSubscription};return(await this.watch(o,i,this.extend(d,s),i,h)).limit(t)}handleOrderBookSnapshot(e,t,s){const i=this.safeString(s,"symbol"),r=this.safeString(s,"messageHash"),a=this.orderbooks[i],n=this.safeValue(t,"data"),o=this.parseOrderBook(n,i);o.nonce=this.safeInteger(n,"seqNum"),a.reset(o);const c=a.cache;for(let t=0;t<c.length;t++){const s=c[t];this.handleOrderBookMessage(e,s,a)}this.orderbooks[i]=a,e.resolve(a,r)}async watchOrderBookSnapshot(e,t,s){const i=this.safeString(s,"symbol"),r=this.safeInteger(s,"limit"),a=this.safeValue(s,"params"),n=this.safeString(s,"messageHash"),o=this.safeString(this.options,"api","api"),c={hostname:this.hostname},d=this.implodeParams(this.urls.api.ws[o].public,c),h=this.requestId(),u={req:n,id:h},l={id:h,messageHash:n,symbol:i,limit:r,params:a,method:this.handleOrderBookSnapshot};return(await this.watch(d,h,u,h,l)).limit(r)}handleDelta(e,t){const s=this.safeFloat(t,0),i=this.safeFloat(t,1);e.store(s,i)}handleDeltas(e,t){for(let s=0;s<t.length;s++)this.handleDelta(e,t[s])}handleOrderBookMessage(e,t,s){const i=this.safeValue(t,"tick",{}),r=this.safeInteger(i,"seqNum");if(this.safeInteger(i,"prevSeqNum")<=s.nonce&&r>s.nonce){const e=this.safeValue(i,"asks",[]),a=this.safeValue(i,"bids",[]);this.handleDeltas(s.asks,e),this.handleDeltas(s.bids,a),s.nonce=r;const n=this.safeInteger(t,"ts");s.timestamp=n,s.datetime=this.iso8601(n)}return s}handleOrderBook(e,t){const s=this.safeString(t,"ch"),i=this.safeValue(t,"ch").split("."),r=this.safeString(i,1),a=this.safeSymbol(r),n=this.orderbooks[a];void 0===n.nonce?n.cache.push(t):(this.handleOrderBookMessage(e,t,n),e.resolve(n,s))}handleOrderBookSubscription(e,t,s){const i=this.safeString(s,"symbol"),r=this.safeInteger(s,"limit");i in this.orderbooks&&delete this.orderbooks[i],this.orderbooks[i]=this.orderBook({},r),this.spawn(this.watchOrderBookSnapshot,e,t,s)}handleSubscriptionStatus(e,t){const s=this.safeString(t,"id"),i=this.indexBy(e.subscriptions,"id"),r=this.safeValue(i,s);if(void 0!==r){const i=this.safeValue(r,"method");if(void 0!==i)return i.call(this,e,t,r);s in e.subscriptions&&delete e.subscriptions[s]}return t}handleSystemStatus(e,t){return t}handleSubject(e,t){const s=this.safeValue(t,"ch").split(".");if("market"===this.safeString(s,0)){const i=this.safeString(s,2),r={mbp:this.handleOrderBook,detail:this.handleTicker,trade:this.handleTrades,kline:this.handleOHLCV},a=this.safeValue(r,i);return void 0===a?t:a.call(this,e,t)}}async pong(e,t){await e.send({pong:this.safeInteger(t,"ping")})}handlePing(e,t){this.spawn(this.pong,e,t)}handleErrorMessage(e,t){if("error"===this.safeString(t,"status")){const s=this.safeString(t,"id"),i=this.indexBy(e.subscriptions,"id"),r=this.safeValue(i,s);if(void 0!==r){const i=this.safeString(t,"err-code");try{this.throwExactlyMatchedException(this.exceptions.exact,i,this.json(t))}catch(t){const i=this.safeString(r,"messageHash");e.reject(t,i),e.reject(t,s),s in e.subscriptions&&delete e.subscriptions[s]}}return!1}return t}handleMessage(e,t){this.handleErrorMessage(e,t)&&("id"in t?this.handleSubscriptionStatus(e,t):"ch"in t?this.handleSubject(e,t):"ping"in t&&this.handlePing(e,t))}}},7931:(e,t,s)=>{"use strict";const i=s(1853),{InvalidNonce:r}=s(3449),{ArrayCache:a,ArrayCacheByTimestamp:n,ArrayCacheBySymbolById:o}=s(9584);e.exports=class extends i.idex{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchOrderBook:!0,watchTrades:!0,watchOHLCV:!0,watchTicker:!0,watchTickers:!1,watchOrders:!0,watchTransactions:!0},urls:{test:{ws:"wss://websocket.idex.io/v1"},api:{}},options:{tradesLimit:1e3,ordersLimit:1e3,OHLCVLimit:1e3,watchOrderBookLimit:1e3,orderBookSubscriptions:{},token:void 0,fetchOrderBookSnapshotMaxAttempts:10,fetchOrderBookSnapshotMaxDelay:1e4}})}async subscribe(e,t,s=!0){const i=this.urls.test.ws,r={method:"subscribe",subscriptions:[e]};return await this.watch(i,t,r,t,s)}async subscribePrivate(e,t){const s=await this.authenticate(),i=this.urls.test.ws,r={method:"subscribe",token:s,subscriptions:[e]};return await this.watch(i,t,r,t)}async watchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i="tickers",r={name:i,markets:[s.id]},a=i+":"+s.id;return await this.subscribe(this.extend(r,t),a)}handleTicker(e,t){const s=this.safeString(t,"type"),i=this.safeValue(t,"data"),r=this.safeString(i,"m"),a=this.safeSymbol(r),n=s+":"+r,o=this.safeInteger(i,"t"),c=this.safeFloat(i,"c"),d=this.safeFloat(i,"P");let h;void 0!==d&&void 0!==c&&(h=c*d);const u={symbol:a,timestamp:o,datetime:this.iso8601(o),high:this.safeFloat(i,"h"),low:this.safeFloat(i,"l"),bid:this.safeFloat(i,"b"),bidVolume:void 0,ask:this.safeFloat(i,"a"),askVolume:void 0,vwap:void 0,open:this.safeFloat(i,"o"),close:c,last:c,previousClose:void 0,change:h,percentage:d,average:void 0,baseVolume:this.safeFloat(i,"v"),quoteVolume:this.safeFloat(i,"q"),info:t};e.resolve(u,n)}async watchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a="trades",n={name:a,markets:[r.id]},o=a+":"+r.id,c=await this.subscribe(n,o);return this.newUpdates&&(s=c.getLimit(e,s)),this.filterBySinceLimit(c,t,s,"timestamp",!0)}handleTrade(e,t){const s=this.safeString(t,"type"),i=this.safeValue(t,"data"),r=s+":"+this.safeString(i,"m"),a=this.parseWsTrade(i);if(0===Object.keys(this.trades).length){const e=this.safeInteger(this.options,"tradesLimit");this.trades=new o(e)}const n=this.trades;n.append(a),e.resolve(n,r)}parseWsTrade(e){const t=this.safeString(e,"m"),s=this.safeSymbol(t),i=this.safeString(e,"i"),r=this.safeFloat(e,"p"),a=this.safeFloat(e,"q"),n=this.safeFloat(e,"Q"),o=this.safeInteger(e,"t"),c=this.safeString(e,"s"),d={currency:this.safeString(e,"a"),cost:this.safeFloat(e,"f")},h=this.safeString(e,"l");return{info:e,timestamp:o,datetime:this.iso8601(o),symbol:s,id:i,order:void 0,type:void 0,takerOrMaker:h,side:c,price:r,amount:a,cost:n,fee:d}}async watchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n="candles",o=this.timeframes[t],c={name:n,markets:[a.id],interval:o},d=n+":"+a.id,h=await this.subscribe(c,d);return this.newUpdates&&(i=h.getLimit(e,i)),this.filterBySinceLimit(h,s,i,0,!0)}handleOHLCV(e,t){const s=this.safeString(t,"type"),i=this.safeValue(t,"data"),r=this.safeString(i,"m"),a=s+":"+r,o=[this.safeInteger(i,"s"),this.safeFloat(i,"o"),this.safeFloat(i,"h"),this.safeFloat(i,"l"),this.safeFloat(i,"c"),this.safeFloat(i,"v")],c=this.safeSymbol(r),d=this.safeString(i,"i"),h=this.findTimeframe(d);this.ohlcvs[c]=this.safeValue(this.ohlcvs,c,{});let u=this.safeValue(this.ohlcvs[c],h);if(void 0===u){const e=this.safeInteger(this.options,"OHLCVLimit",1e3);u=new n(e),this.ohlcvs[c][h]=u}u.append(o),e.resolve(u,a)}handleSubscribeMessage(e,t){const s=this.safeValue(t,"subscriptions");for(let t=0;t<s.length;t++){const i=s[t];if("l2orderbook"===this.safeString(i,"name")){const t=this.safeValue(i,"markets");for(let s=0;s<t.length;s++){const i=t[s];if(!(i in this.safeValue(this.options,"orderBookSubscriptions",{}))){const t=this.safeSymbol(i);if(!(t in this.orderbooks)){const e=this.countedOrderBook({});e.cache=[],this.orderbooks[t]=e}this.spawn(this.fetchOrderBookSnapshot,e,t)}}break}}}async fetchOrderBookSnapshot(e,t,s={}){const i=this.orderbooks[t],a="l2orderbook:"+this.market(t).id,n=e.subscriptions[a];n.fetchingOrderBookSnapshot||(n.startTime=this.milliseconds()),n.fetchingOrderBookSnapshot=!0;const o=this.safeInteger(this.options,"fetchOrderBookSnapshotMaxAttempts",10),c=this.safeInteger(this.options,"fetchOrderBookSnapshotMaxDelay",1e4);try{const s=this.safeInteger(n,"limit",0),d=await this.fetchOrderBook(t,s),h=this.safeValue(i.cache,0),u=this.safeValue(h,"data"),l=this.safeInteger(u,"u"),f=i.cache.length,p=this.safeValue(i.cache,f-1),m=this.safeValue(p,"data"),b=this.safeInteger(m,"u");if(void 0!==l&&void 0!==b&&l<=d.nonce+1&&b>d.nonce){i.reset(d);for(let t=0;t<i.cache.length;t++){const s=i.cache[t],r=this.safeValue(s,"data");this.safeInteger(r,"u")>i.nonce&&this.handleOrderBookMessage(e,s,i)}n.fetchingOrderBookSnapshot=!1,e.resolve(i,a)}else{n.numAttempts=n.numAttempts+1;const s=this.milliseconds()-n.startTime,i=n.numAttempts<o,a=s<c;if(!i||!a){const e=i?" after "+c.toString()+" milliseconds":" in "+o.toString()+" attempts";throw new r(this.id+" failed to synchronize WebSocket feed with the snapshot for symbol "+t+e)}this.delay(this.rateLimit,this.fetchOrderBookSnapshot,e,t)}}catch(t){n.fetchingOrderBookSnapshot=!1,e.reject(t,a)}}async watchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),r="l2orderbook",a={name:r,markets:[i.id]},n=r+":"+i.id,o={fetchingOrderBookSnapshot:!1,numAttempts:0,startTime:void 0,limit:0};return(await this.subscribe(a,n,o)).limit(t)}handleOrderBook(e,t){const s=this.safeValue(t,"data"),i=this.safeString(s,"m"),r=this.safeSymbol(i),a=this.orderbooks[r];void 0===a.nonce?a.cache.push(t):this.handleOrderBookMessage(e,t,a)}handleOrderBookMessage(e,t,s){const i=this.safeString(t,"type"),r=this.safeValue(t,"data"),a=i+":"+this.safeString(r,"m"),n=this.safeInteger(r,"u"),o=this.safeInteger(r,"t"),c=this.safeValue(r,"b"),d=this.safeValue(r,"a");this.handleDeltas(s.bids,c),this.handleDeltas(s.asks,d),s.nonce=n,s.timestamp=o,s.datetime=this.iso8601(o),e.resolve(s,a)}handleDelta(e,t){const s=this.safeFloat(t,0),i=this.safeFloat(t,1),r=this.safeInteger(t,2);e.store(s,i,r)}handleDeltas(e,t){for(let s=0;s<t.length;s++)this.handleDelta(e,t[s])}async authenticate(e={}){const t=this.seconds();if(t-this.safeInteger(this.options,"lastAuthenticatedTime",0)>900){const s={wallet:this.walletAddress,nonce:this.uuidv1()},i=await this.privateGetWsToken(this.extend(s,e));this.options.lastAuthenticatedTime=t,this.options.token=this.safeString(i,"token")}return this.options.token}async watchOrders(e,t,s,i={}){await this.loadMarkets();const r="orders",a={name:r};let n=r;if(void 0!==e){const t=this.marketId(e);a.markets=[t],n=r+":"+t}const o=await this.subscribePrivate(a,n);return this.newUpdates&&(s=o.getLimit(e,s)),this.filterBySinceLimit(o,t,s,"timestamp",!0)}handleOrder(e,t){const s=this.safeString(t,"type"),i=this.safeValue(t,"data"),r=this.safeString(i,"m"),a=this.safeSymbol(r),n=this.safeInteger(i,"t"),c=this.safeValue(i,"F"),d=[];for(let e=0;e<c.length;e++)d.push(this.parseWsTrade(c[e]));const h=this.safeString(i,"i"),u=this.safeString(i,"s"),l=this.safeString(i,"o"),f=this.safeFloat(i,"q"),p=this.safeFloat(i,"z");let m;void 0!==f&&void 0!==p&&(m=f-p);const b=this.safeFloat(i,"v"),g=this.safeFloat(i,"price",b);let y;void 0!==f&&void 0!==g&&(y=f*g);const v=this.safeString(i,"X"),w=this.parseOrderStatus(v),k={currency:void 0,cost:void 0};let S;for(let e=0;e<d.length;e++)S=d[e],k.currency=S.fee.currency,k.cost=this.sum(k.cost,S.fee.cost);const _=this.safeInteger(S,"timestamp"),O={info:t,id:h,clientOrderId:void 0,timestamp:n,datetime:this.iso8601(n),lastTradeTimestamp:_,symbol:a,type:l,side:u,price:g,stopPrice:void 0,amount:f,cost:y,average:b,filled:p,remaining:m,status:w,fee:k,trades:d};if(void 0===this.orders){const e=this.safeInteger(this.options,"ordersLimit",1e3);this.orders=new o(e)}const T=this.orders;T.append(O);const x=s+":"+r;e.resolve(T,x),e.resolve(T,s)}async watchTransactions(e,t,s,i={}){await this.loadMarkets();const r="balances",a={name:r};let n=r;void 0!==e&&(n=r+":"+e);const o=await this.subscribePrivate(a,n);return this.newUpdates&&(s=o.getLimit(e,s)),this.filterBySinceLimit(o,t,s,"timestamp",!0)}handleTransaction(e,t){const s=this.safeString(t,"type"),i=this.safeValue(t,"data"),r=this.safeString(i,"a"),n=s+":"+r,o=this.safeCurrencyCode(r),c={info:t,id:void 0,currency:o,amount:void 0,address:this.safeString(i,"w"),addressTo:void 0,addressFrom:void 0,tag:void 0,tagTo:void 0,tagFrom:void 0,status:"ok",type:void 0,updated:void 0,txid:void 0,timestamp:void 0,datetime:void 0,fee:void 0};if(!(o in this.transactions)){const e=this.safeInteger(this.options,"transactionsLimit",1e3);this.transactions[o]=new a(e)}const d=this.transactions[o];d.append(c),e.resolve(d,n),e.resolve(d,s)}handleMessage(e,t){const s=this.safeString(t,"type"),i={tickers:this.handleTicker,trades:this.handleTrade,subscriptions:this.handleSubscribeMessage,candles:this.handleOHLCV,l2orderbook:this.handleOrderBook,balances:this.handleTransaction,orders:this.handleOrder};if(s in i){i[s].call(this,e,t)}}}},2992:(e,t,s)=>{"use strict";const i=s(1853),{BadSymbol:r,BadRequest:a,ExchangeError:n,NotSupported:o}=s(3449),{ArrayCache:c,ArrayCacheByTimestamp:d,ArrayCacheBySymbolById:h}=s(9584);e.exports=class extends i.kraken{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchBalance:!1,watchMyTrades:!0,watchOHLCV:!0,watchOrderBook:!0,watchOrders:!0,watchTicker:!0,watchTickers:!1,watchTrades:!0},urls:{api:{ws:{public:"wss://ws.kraken.com",private:"wss://ws-auth.kraken.com",beta:"wss://beta-ws.kraken.com"}}},versions:{ws:"0.2.0"},options:{tradesLimit:1e3,OHLCVLimit:1e3,ordersLimit:1e3,symbolsByOrderId:{}},exceptions:{ws:{exact:{"Event(s) not found":a},broad:{"Currency pair not in ISO 4217-A3 format":r}}}})}handleTicker(e,t,s){const i=t[3],r="ticker:"+i,a=this.safeValue(this.options.marketsByWsName,i).symbol,n=t[1],o=this.safeFloat(n.p,0);let c;const d=this.safeFloat(n.v,0);void 0!==d&&void 0!==o&&(c=d*o);const h=this.safeFloat(n.c,0),u=this.milliseconds(),l={symbol:a,timestamp:u,datetime:this.iso8601(u),high:this.safeFloat(n.h,0),low:this.safeFloat(n.l,0),bid:this.safeFloat(n.b,0),bidVolume:this.safeFloat(n.b,2),ask:this.safeFloat(n.a,0),askVolume:this.safeFloat(n.a,2),vwap:o,open:this.safeFloat(n.o,0),close:h,last:h,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:d,quoteVolume:c,info:n};this.tickers[a]=l,e.resolve(l,r)}handleTrades(e,t,s){const i=this.safeString(t,3),r=this.safeString(t,2)+":"+i,a=this.safeValue(this.options.marketsByWsName,i),n=a.symbol;let o=this.safeValue(this.trades,n);if(void 0===o){const e=this.safeInteger(this.options,"tradesLimit",1e3);o=new c(e),this.trades[n]=o}const d=this.safeValue(t,1,[]),h=this.parseTrades(d,a);for(let e=0;e<h.length;e++)o.append(h[e]);e.resolve(o,r)}handleOHLCV(e,t,s){const i=this.safeValue(s,"subscription",{}),r=this.safeInteger(i,"interval"),a=this.safeString(i,"name"),n=this.safeString(t,3),o=this.safeValue(this.options.marketsByWsName,n).symbol,c=this.findTimeframe(r),h=this.parseTimeframe(c);if(void 0!==c){const s=this.safeValue(t,1),i=a+":"+c+":"+n;let r=this.safeFloat(s,1);r-=h;const u=[parseInt(1e3*r),this.safeFloat(s,2),this.safeFloat(s,3),this.safeFloat(s,4),this.safeFloat(s,5),this.safeFloat(s,7)];this.ohlcvs[o]=this.safeValue(this.ohlcvs,o,{});let l=this.safeValue(this.ohlcvs[o],c);if(void 0===l){const e=this.safeInteger(this.options,"OHLCVLimit",1e3);l=new d(e),this.ohlcvs[o][c]=l}l.append(u),e.resolve(l,i)}}requestId(){const e=this.sum(this.safeInteger(this.options,"reqid",0),1);return this.options.reqid=e,e}async watchPublic(e,t,s={}){await this.loadMarkets();const i=this.market(t),r=this.safeValue(i.info,"wsname"),a=e+":"+r,n=this.urls.api.ws.public,o={event:"subscribe",reqid:this.requestId(),pair:[r],subscription:{name:e}},c=this.deepExtend(o,s);return await this.watch(n,a,c,a)}async watchTicker(e,t={}){return await this.watchPublic("ticker",e,t)}async watchTrades(e,t,s,i={}){const r=await this.watchPublic("trade",e,i);return this.newUpdates&&(s=r.getLimit(e,s)),this.filterBySinceLimit(r,t,s,"timestamp",!0)}async watchOrderBook(e,t,s={}){const i={};if(void 0!==t){if(10!==t&&25!==t&&100!==t&&500!==t&&1e3!==t)throw new o(this.id+" watchOrderBook accepts limit values of 10, 25, 100, 500 and 1000 only");i.subscription={depth:t}}return(await this.watchPublic("book",e,this.extend(i,s))).limit(t)}async watchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a="ohlc",n=this.market(e),o=this.safeValue(n.info,"wsname"),c="ohlc:"+t+":"+o,d=this.urls.api.ws.public,h={event:"subscribe",reqid:this.requestId(),pair:[o],subscription:{name:a,interval:this.timeframes[t]}},u=this.deepExtend(h,r),l=await this.watch(d,c,u,c);return this.newUpdates&&(i=l.getLimit(e,i)),this.filterBySinceLimit(l,s,i,0,!0)}async loadMarkets(e=!1,t={}){const s=await super.loadMarkets(e,t);let i=this.safeValue(this.options,"marketsByWsName");if(void 0===i||e){i={};for(let e=0;e<this.symbols.length;e++){const t=this.symbols[e],s=this.markets[t];if(s.darkpool){const e=this.safeValue(s,"info",{}),t=this.safeString(e,"altname");i[t.slice(0,3)+"/"+t.slice(3)]=s}else{const e=this.safeValue(s,"info",{});i[this.safeString(e,"wsname")]=s}}this.options.marketsByWsName=i}return s}async watchHeartbeat(e={}){await this.loadMarkets();const t=this.urls.api.ws.public;return await this.watch(t,"heartbeat")}handleHeartbeat(e,t){const s=this.safeString(t,"event");e.resolve(t,s)}handleOrderBook(e,t,s){const i=t.length,r=t[i-1],a=t[i-2].split("-"),n=this.safeInteger(a,1,10),o=this.safeValue(this.options.marketsByWsName,r).symbol;let c;const d="book:"+r;if("as"in t[1]){this.orderbooks[o]=this.orderBook({},n);const s=this.orderbooks[o],i={as:"asks",bs:"bids"},r=Object.keys(i);for(let e=0;e<r.length;e++){const a=r[e],n=s[i[a]],o=this.safeValue(t[1],a,[]);c=this.handleDeltas(n,o,c)}s.timestamp=c,s.datetime=this.iso8601(c),e.resolve(s,d)}else{const s=this.orderbooks[o];let r,a;5===i?(r=this.safeValue(t[1],"a",[]),a=this.safeValue(t[2],"b",[])):"a"in t[1]?r=this.safeValue(t[1],"a",[]):a=this.safeValue(t[1],"b",[]),void 0!==r&&(c=this.handleDeltas(s.asks,r,c)),void 0!==a&&(c=this.handleDeltas(s.bids,a,c)),s.timestamp=c,s.datetime=this.iso8601(c),s.limit(),e.resolve(s,d)}}handleDeltas(e,t,s){for(let i=0;i<t.length;i++){const r=t[i],a=parseFloat(r[0]),n=parseFloat(r[1]);s=Math.max(s||0,parseInt(1e3*parseFloat(r[2]))),e.store(a,n)}return s}handleSystemStatus(e,t){return t}async authenticate(e={}){const t=this.urls.api.ws.private,s=this.client(t),i="authenticated";let r=this.safeValue(s.subscriptions,i);if(void 0===r){const t=await this.privatePostGetWebSocketsToken(e);r=this.safeValue(t,"result"),s.subscriptions.authenticated=r}return this.safeString(r,"token")}async watchPrivate(e,t,s,i,r={}){await this.loadMarkets();const a=await this.authenticate(),n=e;let o=e;void 0!==t&&(o+=":"+t);const c=this.urls.api.ws.private,d={event:"subscribe",reqid:this.requestId(),subscription:{name:e,token:a}},h=this.deepExtend(d,r),u=await this.watch(c,o,h,n);return this.newUpdates&&(i=u.getLimit(t,i)),this.filterBySymbolSinceLimit(u,t,s,i,!0)}async watchMyTrades(e,t,s,i={}){return await this.watchPrivate("ownTrades",e,t,s,i)}handleMyTrades(e,t,s){const i=this.safeValue(t,0,[]);if(i.length>0){if(void 0===this.myTrades){const e=this.safeInteger(this.options,"tradesLimit",1e3);this.myTrades=new c(e)}const t=this.myTrades,s={};for(let e=0;e<i.length;e++){const r=this.safeValue(i,e,{}),a=Object.keys(r);for(let e=0;e<a.length;e++){const i=a[e],n=r[i],o=this.parseWsTrade(this.extend({id:i},n));t.append(o);s[o.symbol]=!0}}const r="ownTrades";e.resolve(this.myTrades,r);const a=Object.keys(s);for(let t=0;t<a.length;t++){const s=r+":"+a[t];e.resolve(this.myTrades,s)}}}parseWsTrade(e,t){const s=this.safeString(e,"pair");let i;t=this.safeValue(this.options.marketsByWsName,s,t);const r=this.safeString(e,"ordertxid"),a=this.safeString2(e,"id","postxid"),n=this.safeTimestamp(e,"time"),o=this.safeString(e,"type"),c=this.safeString(e,"ordertype"),d=this.safeFloat(e,"price"),h=this.safeFloat(e,"vol");let u,l;if("fee"in e){let s;void 0!==t&&(s=t.quote),l={cost:this.safeFloat(e,"fee"),currency:s}}return void 0!==t&&(i=t.symbol),void 0!==d&&void 0!==h&&(u=d*h),{id:a,order:r,info:e,timestamp:n,datetime:this.iso8601(n),symbol:i,type:c,side:o,takerOrMaker:void 0,price:d,amount:h,cost:u,fee:l}}async watchOrders(e,t,s,i={}){return await this.watchPrivate("openOrders",e,t,s,i)}handleOrders(e,t,s){const i=this.safeValue(t,0,[]);if(i.length>0){const t=this.safeInteger(this.options,"ordersLimit",1e3);void 0===this.orders&&(this.orders=new h(t));const s=this.orders,r={};for(let e=0;e<i.length;e++){const a=this.safeValue(i,e,{}),n=Object.keys(a);for(let e=0;e<n.length;e++){const i=n[e],o=a[i],c=this.parseWsOrder(o);let d;c.id=i;const h=this.safeValue(this.options,"symbolsByOrderId",{});void 0!==c.symbol?(d=c.symbol,h[i]=d,this.options.symbolsByOrderId=h):d=this.safeString(h,i);const u=this.safeValue(s.hashmap,d),l=this.safeValue(u,i);let f=c;if(void 0!==l){const e=this.extend(l.info,f.info);f=this.parseWsOrder(e),f.id=i}if(s.length===t&&void 0===l){const e=s[0];e.id in h&&delete h[e.id]}s.append(f),r[d]=!0}}const a="openOrders";e.resolve(this.orders,a);const n=Object.keys(r);for(let t=0;t<n.length;t++){const s=a+":"+n[t];e.resolve(this.orders,s)}}}parseWsOrder(e,t){const s=this.safeValue(e,"descr",{}),i=this.safeString(s,"order");let r,a,n,o,c,d;if(void 0!==i){const e=i.split(" ");r=this.safeString(e,0),c=this.safeFloat(e,1),n=this.safeString(e,2),a=this.safeString(e,4),o=this.safeFloat(e,5)}r=this.safeString(s,"type",r),a=this.safeString(s,"ordertype",a),n=this.safeString(s,"pair",n),t=this.safeValue(this.options.marketsByWsName,n,t);const h=this.safeTimestamp(e,"opentm");c=this.safeFloat(e,"vol",c);const u=this.safeFloat(e,"vol_exec");let l,f;void 0!==c&&void 0!==u&&(l=c-u);const p=this.safeFloat(e,"cost");o=this.safeFloat(s,"price",o),void 0!==o&&0!==o||(o=this.safeFloat(s,"price2")),void 0!==o&&0!==o||(o=this.safeFloat(e,"price",o));const m=this.safeFloat(e,"price");if(void 0!==t&&(d=t.symbol,"fee"in e)){const s=e.oflags;f={cost:this.safeFloat(e,"fee"),rate:void 0},s.indexOf("fciq")>=0?f.currency=t.quote:s.indexOf("fcib")>=0&&(f.currency=t.base)}const b=this.parseOrderStatus(this.safeString(e,"status"));let g=this.safeString(e,"id");if(void 0===g){const t=this.safeValue(e,"txid");g=this.safeString(t,0)}const y=this.safeString(e,"userref"),v=this.safeValue(e,"trades");let w;void 0!==v&&(w=this.parseTrades(v,t,void 0,void 0,{order:g}));const k=this.safeFloat(e,"stopprice");return{id:g,clientOrderId:y,info:e,timestamp:h,datetime:this.iso8601(h),lastTradeTimestamp:void 0,status:b,symbol:d,type:a,timeInForce:void 0,postOnly:void 0,side:r,price:o,stopPrice:k,cost:p,amount:c,filled:u,average:m,remaining:l,fee:f,trades:w}}handleSubscriptionStatus(e,t){const s=this.safeString(t,"channelID");void 0!==s&&(e.subscriptions[s]=t)}handleErrorMessage(e,t){const s=this.safeValue(t,"errorMessage");if(void 0!==s){const i=this.safeValue(t,"reqid");if(void 0!==i){const t=this.exceptions.ws.broad,r=this.findBroadlyMatchedKey(t,s);let a;return a=void 0===r?new n(s):new t[r](s),e.reject(a,i),!1}}return!0}handleMessage(e,t){if(Array.isArray(t)){const s=this.safeString(t,0),i=this.safeValue(e.subscriptions,s,{}),r=this.safeValue(i,"subscription",{}),a=t.length,n=this.safeString(t,a-2),o=this.safeString(r,"name"),c={book:this.handleOrderBook,ohlc:this.handleOHLCV,ticker:this.handleTicker,trade:this.handleTrades,openOrders:this.handleOrders,ownTrades:this.handleMyTrades},d=this.safeValue2(c,o,n);return void 0===d?t:d.call(this,e,t,i)}if(this.handleErrorMessage(e,t)){const s=this.safeString(t,"event"),i={heartbeat:this.handleHeartbeat,systemStatus:this.handleSystemStatus,subscriptionStatus:this.handleSubscriptionStatus},r=this.safeValue(i,s);return void 0===r?t:r.call(this,e,t)}}}},6194:(e,t,s)=>{"use strict";const i=s(1853),{ExchangeError:r,InvalidNonce:a}=s(3449),{ArrayCache:n,ArrayCacheByTimestamp:o}=s(9584);e.exports=class extends i.kucoin{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchOrderBook:!0,watchTickers:!1,watchTicker:!0,watchTrades:!0,watchBalance:!1,watchOHLCV:!0},options:{tradesLimit:1e3,watchOrderBookRate:100,fetchOrderBookSnapshot:{maxAttempts:3,delay:1e3}},streaming:{ping:this.ping}})}async negotiate(e={}){const t=this.client("ws"),s="negotiate";let i=this.safeValue(t.subscriptions,s);if(void 0===i){let e;i=t.future(s),t.subscriptions.negotiate=i;const r=!1;e=this.checkRequiredCredentials(r)?await this.privatePostBulletPrivate():await this.publicPostBulletPublic(),t.resolve(e,s)}return await i}requestId(){const e=this.sum(this.safeInteger(this.options,"requestId",0),1);return this.options.requestId=e,e}async subscribe(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.safeValue(e,"data",{}),o=this.safeValue(n,"instanceServers",[]),c=this.safeValue(o,0,{}),d=this.safeString(c,"endpoint"),h=this.safeString(n,"token"),u=this.requestId(),l={token:h,acceptUserMessage:"true"},f=d+"?"+this.urlencode(l),p={id:u,type:"subscribe",topic:s,response:!0},m={id:u.toString(),symbol:r,topic:t,messageHash:s,method:i},b=this.extend(p,a);return await this.watch(f,s,b,s,m)}async watchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i=await this.negotiate(),r="/market/snapshot",a=r+":"+s.id;return await this.subscribe(i,r,a,void 0,e,t)}handleTicker(e,t){const s=this.safeValue(t,"data",{}),i=this.safeValue(s,"data",{}),r=this.parseTicker(i),a=r.symbol;this.tickers[a]=r;const n=this.safeString(t,"topic");return void 0!==n&&e.resolve(r,n),t}async watchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=await this.negotiate(),n="/market/candles",o=this.market(e),c=this.timeframes[t],d=n+":"+o.id+"_"+c,h=await this.subscribe(a,n,d,void 0,e,r);return this.newUpdates&&(i=h.getLimit(e,i)),this.filterBySinceLimit(h,s,i,"timestamp",!0)}handleOHLCV(e,t){const s=this.safeValue(t,"data",{}),i=this.safeString(s,"symbol"),r=this.safeValue(s,"candles",[]),a=this.safeString(t,"topic"),n=a.split("_"),c=this.safeString(n,1),d=this.findTimeframe(c),h=this.safeSymbol(i),u=this.market(h);this.ohlcvs[h]=this.safeValue(this.ohlcvs,h,{});let l=this.safeValue(this.ohlcvs[h],d);if(void 0===l){const e=this.safeInteger(this.options,"OHLCVLimit",1e3);l=new o(e),this.ohlcvs[h][d]=l}const f=this.parseOHLCV(r,u);l.append(f),e.resolve(l,a)}async watchTrades(e,t,s,i={}){await this.loadMarkets();const r=await this.negotiate(),a="/market/match",n=a+":"+this.market(e).id,o=await this.subscribe(r,a,n,void 0,e,i);return this.newUpdates&&(s=o.getLimit(e,s)),this.filterBySinceLimit(o,t,s,"timestamp",!0)}handleTrade(e,t){const s=this.safeValue(t,"data",{}),i=this.parseTrade(s),r=this.safeString(t,"topic"),a=i.symbol;let o=this.safeValue(this.trades,a);if(void 0===o){const e=this.safeInteger(this.options,"tradesLimit",1e3);o=new n(e),this.trades[a]=o}return o.append(i),e.resolve(o,r),t}async watchOrderBook(e,t,s={}){if(void 0!==t&&20!==t&&100!==t)throw new r(this.id+" watchOrderBook 'limit' argument must be undefined, 20 or 100");await this.loadMarkets();const i=await this.negotiate(),a="/market/level2",n=a+":"+this.market(e).id;return(await this.subscribe(i,a,n,this.handleOrderBookSubscription,e,s)).limit(t)}async fetchOrderBookSnapshot(e,t,s){const i=this.safeString(s,"symbol"),r=this.safeInteger(s,"limit"),n=this.safeString(s,"messageHash");try{const o=await this.fetchOrderBook(i,r),c=this.orderbooks[i],d=c.cache,h=this.safeValue(d,0,{}),u=this.safeValue(h,"data",{}),l=this.safeInteger(u,"sequenceStart"),f=this.safeInteger(o,"nonce");if(f<l-1){const r=this.safeValue(this.options,"fetchOrderBookSnapshot",{}),o=this.safeInteger(r,"maxAttempts",3);let c=this.safeInteger(s,"numAttempts",0);if(!(c<o))throw new a(this.id+" failed to synchronize WebSocket feed with the snapshot for symbol "+i+" in "+o.toString()+" attempts");n in e.subscriptions&&(c=this.sum(c,1),s.numAttempts=c,e.subscriptions[n]=s,this.spawn(this.fetchOrderBookSnapshot,e,t,s))}else{c.reset(o);for(let t=0;t<d.length;t++){const s=d[t];this.handleOrderBookMessage(e,s,c)}this.orderbooks[i]=c,e.resolve(c,n)}}catch(t){e.reject(t,n)}}handleDelta(e,t,s){const i=this.safeFloat(t,0);if(i>0){if(this.safeInteger(t,2)>s){const s=this.safeFloat(t,1);e.store(i,s)}}}handleDeltas(e,t,s){for(let i=0;i<t.length;i++)this.handleDelta(e,t[i],s)}handleOrderBookMessage(e,t,s){const i=this.safeValue(t,"data",{}),a=this.safeInteger(i,"sequenceEnd");if(a>s.nonce){const e=this.safeInteger(t,"sequenceStart");if(void 0!==e&&e-1>s.nonce)throw new r(this.id+" handleOrderBook received an out-of-order nonce");const n=this.safeValue(i,"changes",{});let o=this.safeValue(n,"asks",[]),c=this.safeValue(n,"bids",[]);o=this.sortBy(o,2),c=this.sortBy(c,2),this.handleDeltas(s.asks,o,s.nonce),this.handleDeltas(s.bids,c,s.nonce),s.nonce=a,s.timestamp=void 0,s.datetime=void 0}return s}handleOrderBook(e,t){const s=this.safeString(t,"topic"),i=this.safeValue(t,"data"),r=this.safeString(i,"symbol"),a=this.safeSymbol(r,void 0,"-"),n=this.orderbooks[a];if(void 0===n.nonce){const i=this.safeValue(e.subscriptions,s);if(void 0===this.safeValue(i,"fetchingOrderBookSnapshot")){i.fetchingOrderBookSnapshot=!0,e.subscriptions[s]=i;const r=this.safeValue(this.options,"fetchOrderBookSnapshot",{}),a=this.safeInteger(r,"delay",this.rateLimit);this.delay(a,this.fetchOrderBookSnapshot,e,t,i)}n.cache.push(t)}else this.handleOrderBookMessage(e,t,n),e.resolve(n,s)}handleOrderBookSubscription(e,t,s){const i=this.safeString(s,"symbol"),r=this.safeString(s,"limit");i in this.orderbooks&&delete this.orderbooks[i],this.orderbooks[i]=this.orderBook({},r)}handleSubscriptionStatus(e,t){const s=this.safeString(t,"id"),i=this.indexBy(e.subscriptions,"id"),r=this.safeValue(i,s,{}),a=this.safeValue(r,"method");return void 0!==a&&a.call(this,e,t,r),t}handleSystemStatus(e,t){return t}handleSubject(e,t){const s=this.safeString(t,"subject"),i={"trade.l2update":this.handleOrderBook,"trade.snapshot":this.handleTicker,"trade.l3match":this.handleTrade,"trade.candles.update":this.handleOHLCV},r=this.safeValue(i,s);return void 0===r?t:r.call(this,e,t)}ping(e){return{id:this.requestId().toString(),type:"ping"}}handlePong(e,t){return e.lastPong=this.milliseconds(),t}handleErrorMessage(e,t){return t}handleMessage(e,t){if(this.handleErrorMessage(e,t)){const s=this.safeString(t,"type"),i={welcome:this.handleSystemStatus,ack:this.handleSubscriptionStatus,message:this.handleSubject,pong:this.handlePong},r=this.safeValue(i,s);return void 0===r?t:r.call(this,e,t)}}}},5810:(e,t,s)=>{"use strict";const i=s(1853),{ArrayCache:r}=s(9584);e.exports=class extends i.ndax{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchOrderBook:!0,watchTrades:!0,watchTicker:!0,watchOHLCV:!0},urls:{test:{ws:"wss://ndaxmarginstaging.cdnhop.net:10456/WSAdminGatewa/"},api:{ws:"wss://api.ndax.io/WSGateway"}}})}requestId(){const e=this.sum(this.safeInteger(this.options,"requestId",0),1);return this.options.requestId=e,e}async watchTicker(e,t={}){const s=this.safeInteger(this.options,"omsId",1);await this.loadMarkets();const i=this.market(e),r="SubscribeLevel1",a=r+":"+i.id,n=this.urls.api.ws,o=this.requestId(),c={OMSId:s,InstrumentId:parseInt(i.id)},d={m:0,i:o,n:r,o:this.json(c)},h=this.extend(d,t);return await this.watch(n,a,h)}handleTicker(e,t){const s=this.safeValue(t,"o",{}),i=this.parseTicker(s),r=i.symbol,a=this.market(r);this.tickers[r]=i;const n="SubscribeLevel1:"+a.id;e.resolve(i,n)}async watchTrades(e,t,s,i={}){const r=this.safeInteger(this.options,"omsId",1);await this.loadMarkets();const a=this.market(e),n="SubscribeTrades",o=n+":"+a.id,c=this.urls.api.ws,d=this.requestId(),h={OMSId:r,InstrumentId:parseInt(a.id),IncludeLastCount:100},u={m:0,i:d,n,o:this.json(h)},l=this.extend(u,i),f=await this.watch(c,o,l);return this.newUpdates&&(s=f.getLimit(e,s)),this.filterBySinceLimit(f,t,s,"timestamp",!0)}handleTrades(e,t){const s=this.safeValue(t,"o",[]),i={};for(let e=0;e<s.length;e++){const t=this.parseTrade(s[e]),a=t.symbol;let n=this.safeValue(this.trades,a);if(void 0===n){const e=this.safeInteger(this.options,"tradesLimit",1e3);n=new r(e)}n.append(t),this.trades[a]=n,i[a]=!0}const a=Object.keys(i);for(let t=0;t<a.length;t++){const s=a[t],i="SubscribeTrades:"+this.market(s).id,r=this.safeValue(this.trades,s);e.resolve(r,i)}}async watchOHLCV(e,t="1m",s,i,r={}){const a=this.safeInteger(this.options,"omsId",1);await this.loadMarkets();const n=this.market(e),o="SubscribeTicker",c=o+":"+t+":"+n.id,d=this.urls.api.ws,h=this.requestId(),u={OMSId:a,InstrumentId:parseInt(n.id),Interval:parseInt(this.timeframes[t]),IncludeLastCount:100},l={m:0,i:h,n:o,o:this.json(u)},f=this.extend(l,r),p=await this.watch(d,c,f);return this.newUpdates&&(i=p.getLimit(e,i)),this.filterBySinceLimit(p,s,i,0,!0)}handleOHLCV(e,t){const s=this.safeValue(t,"o",[]),i={};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,8),a=this.safeMarket(r).symbol;i[r]={},this.ohlcvs[a]=this.safeValue(this.ohlcvs,a,{});const n=Object.keys(this.timeframes);for(let e=0;e<n.length;e++){const s=n[e],o=this.timeframes[s],c=1e3*parseInt(o),d=this.safeInteger(t,0),h=[parseInt(d/c)*c,this.safeFloat(t,3),this.safeFloat(t,1),this.safeFloat(t,2),this.safeFloat(t,4),this.safeFloat(t,5)],u=this.safeValue(this.ohlcvs[a],s,[]),l=u.length;if(l&&h[0]===u[l-1][0]){const e=u[l-1];u[l-1]=[h[0],e[1],Math.max(h[1],e[1]),Math.min(h[2],e[2]),h[4],this.sum(h[5],e[5])],i[r][s]=!0}else{if(l&&h[0]<u[l-1][0])continue;u.push(h);l>=this.safeInteger(this.options,"OHLCVLimit",1e3)&&u.shift(),i[r][s]=!0}this.ohlcvs[a][s]=u}}const r=Object.keys(i);for(let t=0;t<r.length;t++){const s=r[t],a=Object.keys(i[s]);for(let t=0;t<a.length;t++){const i=a[t],r="SubscribeTicker:"+i+":"+s,n=this.safeMarket(s).symbol,o=this.safeValue(this.ohlcvs[n],i,[]);e.resolve(o,r)}}}async watchOrderBook(e,t,s={}){const i=this.safeInteger(this.options,"omsId",1);await this.loadMarkets();const r=this.market(e),a="SubscribeLevel2",n=a+":"+r.id,o=this.urls.api.ws,c=this.requestId();t=void 0===t?100:t;const d={OMSId:i,InstrumentId:parseInt(r.id),Depth:t},h={m:0,i:c,n:a,o:this.json(d)},u={id:c,messageHash:n,name:a,symbol:e,marketId:r.id,method:this.handleOrderBookSubscription,limit:t,params:s},l=this.extend(h,s);return(await this.watch(o,n,l,n,u)).limit(t)}handleOrderBook(e,t){const s=this.safeValue(t,"o",[]),i=this.safeValue(s,0,[]),r=this.safeString(i,7);if(void 0===r)return t;const a=this.safeMarket(r).symbol,n=this.safeValue(this.orderbooks,a);if(void 0===n)return t;let o,c;for(let e=0;e<s.length;e++){const t=s[e];if(void 0===o)o=this.safeInteger(t,2);else{const e=this.safeInteger(t,2);o=Math.max(o,e)}if(void 0===c)c=this.safeInteger(t,0);else{const e=this.safeInteger(t,0);c=Math.max(c,e)}const i=this.safeInteger(t,3),r=this.safeFloat(t,6),a=this.safeFloat(t,8),d=0===this.safeInteger(t,9)?n.bids:n.asks;0===i||1===i?d.store(r,a):2===i&&d.store(r,0)}n.nonce=c,n.timestamp=o,n.datetime=this.iso8601(o);const d="SubscribeLevel2:"+r;this.orderbooks[a]=n,e.resolve(n,d)}handleOrderBookSubscription(e,t,s){const i=this.safeValue(t,"o",[]),r=this.safeString(s,"symbol"),a=this.parseOrderBook(i,r),n=this.safeInteger(s,"limit"),o=this.orderBook(a,n);this.orderbooks[r]=o;const c=this.safeString(s,"messageHash");e.resolve(o,c)}handleSubscriptionStatus(e,t){const s=this.indexBy(e.subscriptions,"id"),i=this.safeInteger(t,"i"),r=this.safeValue(s,i);if(void 0!==r){const s=this.safeValue(r,"method");return void 0===s?t:s.call(this,e,t,r)}}handleMessage(e,t){const s=this.safeString(t,"o");if(void 0===s)return t;t.o=JSON.parse(s);const i={SubscribeLevel2:this.handleSubscriptionStatus,SubscribeLevel1:this.handleTicker,Level2UpdateEvent:this.handleOrderBook,Level1UpdateEvent:this.handleTicker,SubscribeTrades:this.handleTrades,TradeDataUpdateEvent:this.handleTrades,SubscribeTicker:this.handleOHLCV,TickerDataUpdateEvent:this.handleOHLCV},r=this.safeString(t,"n"),a=this.safeValue(i,r);return void 0===a?t:a.call(this,e,t)}}},8093:(e,t,s)=>{"use strict";const i=s(3921);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"okcoin",name:"OKCoin",countries:["CN","US"],hostname:"okcoin.com",pro:!0,urls:{api:{ws:"wss://real.okcoin.com:8443/ws/v3"},logo:"https://user-images.githubusercontent.com/1294454/27766791-89ffb502-5ee5-11e7-8a5b-c5950b68ac65.jpg",www:"https://www.okcoin.com",doc:"https://www.okcoin.com/docs/en/",fees:"https://www.okcoin.com/coin-fees",referral:"https://www.okcoin.com/account/register?flag=activity&channelId=600001513"},fees:{trading:{taker:.002,maker:.001}},options:{fetchMarkets:["spot"]}})}}},3921:(e,t,s)=>{"use strict";const i=s(1853),{ArgumentsRequired:r,AuthenticationError:a}=s(3449),{ArrayCache:n,ArrayCacheByTimestamp:o}=s(9584);e.exports=class extends i.okex{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchTicker:!0,watchTickers:!1,watchOrderBook:!0,watchTrades:!0,watchBalance:!0,watchOHLCV:!0},urls:{api:{ws:"wss://real.okex.com:8443/ws/v3"},test:{ws:"wss://real.okex.com:8443/ws/v3?BrokerId=181"}},options:{watchOrderBook:{limit:400,type:"spot",depth:"depth_l2_tbt"},watchBalance:"spot",ws:{inflate:!0}},streaming:{ping:this.ping,keepAlive:2e4}})}async subscribe(e,t,s={}){await this.loadMarkets();const i=this.market(t),r=this.urls.api.ws,a=i.type+"/"+e+":"+i.id,n={op:"subscribe",args:[a]};return await this.watch(r,a,this.deepExtend(n,s),a)}async watchTrades(e,t,s,i={}){const r=await this.subscribe("trade",e,i);return this.newUpdates&&(s=r.getLimit(e,s)),this.filterBySinceLimit(r,t,s,"timestamp",!0)}async watchTicker(e,t={}){return await this.subscribe("ticker",e,t)}handleTrade(e,t){const s=this.safeString(t,"table"),i=this.safeValue(t,"data",[]),r=this.safeInteger(this.options,"tradesLimit",1e3);for(let t=0;t<i.length;t++){const a=this.parseTrade(i[t]),o=a.symbol,c=s+":"+this.safeString(a.info,"instrument_id");let d=this.safeValue(this.trades,o);void 0===d&&(d=new n(r),this.trades[o]=d),d.append(a),e.resolve(d,c)}return t}handleTicker(e,t){const s=this.safeString(t,"table"),i=this.safeValue(t,"data",[]);for(let t=0;t<i.length;t++){const r=this.parseTicker(i[t]),a=r.symbol,n=s+":"+this.safeString(r.info,"instrument_id");this.tickers[a]=r,e.resolve(r,n)}return t}async watchOHLCV(e,t="1m",s,i,r={}){const a="candle"+this.timeframes[t]+"s",n=await this.subscribe(a,e,r);return this.newUpdates&&(i=n.getLimit(e,i)),this.filterBySinceLimit(n,s,i,0,!0)}handleOHLCV(e,t){const s=this.safeString(t,"table"),i=this.safeValue(t,"data",[]),r=s.split("/");let a=this.safeString(r,1).replace("candle","");a=a.replace("s","");const n=this.findTimeframe(a);for(let t=0;t<i.length;t++){const r=this.safeString(i[t],"instrument_id"),a=this.safeValue(i[t],"candle"),c=this.safeMarket(r),d=c.symbol,h=this.parseOHLCV(a,c);this.ohlcvs[d]=this.safeValue(this.ohlcvs,d,{});let u=this.safeValue(this.ohlcvs[d],n);if(void 0===u){const e=this.safeInteger(this.options,"OHLCVLimit",1e3);u=new o(e),this.ohlcvs[d][n]=u}u.append(h);const l=s+":"+r;e.resolve(u,l)}}async watchOrderBook(e,t,s={}){const i=this.safeValue(this.options,"watchOrderBook",{}),r=this.safeString(i,"depth","depth_l2_tbt");return(await this.subscribe(r,e,s)).limit(t)}handleDelta(e,t){const s=this.safeFloat(t,0),i=this.safeFloat(t,1);e.store(s,i)}handleDeltas(e,t){for(let s=0;s<t.length;s++)this.handleDelta(e,t[s])}handleOrderBookMessage(e,t,s){const i=this.safeValue(t,"asks",[]),r=this.safeValue(t,"bids",[]);this.handleDeltas(s.asks,i),this.handleDeltas(s.bids,r);const a=this.parse8601(this.safeString(t,"timestamp"));return s.timestamp=a,s.datetime=this.iso8601(a),s}handleOrderBook(e,t){const s=this.safeString(t,"action"),i=this.safeValue(t,"data",[]),r=this.safeString(t,"table");if("partial"===s)for(let t=0;t<i.length;t++){const s=i[t],a=this.safeString(s,"instrument_id"),n=this.safeMarket(a).symbol,o=this.safeValue(this.options,"watchOrderBook",{}),c=this.safeInteger(o,"limit",400),d=this.orderBook({},c);this.orderbooks[n]=d,this.handleOrderBookMessage(e,s,d);const h=r+":"+a;e.resolve(d,h)}else for(let t=0;t<i.length;t++){const s=i[t],a=this.safeString(s,"instrument_id"),n=this.safeMarket(a).symbol;if(n in this.orderbooks){const t=this.orderbooks[n];this.handleOrderBookMessage(e,s,t);const i=r+":"+a;e.resolve(t,i)}}return t}async authenticate(e={}){this.checkRequiredCredentials();const t=this.urls.api.ws,s="login",i=this.client(t);let r=this.safeValue(i.subscriptions,s);if(void 0===r){r=i.future("authenticated");const e=this.seconds().toString(),a=e+"GET"+"/users/self/verify",n=this.hmac(this.encode(a),this.encode(this.secret),"sha256","base64"),o={op:s,args:[this.apiKey,this.password,e,n]};this.spawn(this.watch,t,s,o,s,r)}return await r}async watchBalance(e={}){const t=this.safeString2(this.options,"watchBalance","defaultType");if(void 0===this.safeString(e,"type",t))throw new r(this.id+" watchBalance requires a type parameter (one of 'spot', 'margin', 'futures', 'swap')");const s=await this.authenticate();return await this.subscribeToUserAccount(s,e)}async subscribeToUserAccount(e,t={}){const s=this.safeString2(this.options,"watchBalance","defaultType"),i=this.safeString(t,"type",s);if(void 0===i)throw new r(this.id+" watchBalance requires a type parameter (one of 'spot', 'margin', 'futures', 'swap')");await this.loadMarkets();const a=this.safeString(t,"currency"),n=this.safeString(t,"code",this.safeCurrencyCode(a));let o;void 0!==n&&(o=this.currency(n));const c=this.safeString(t,"instrument_id"),d=this.safeString(t,"symbol");let h;void 0!==d?h=this.market(d):void 0!==c&&c in this.markets_by_id&&(h=this.markets_by_id[c]);const u=void 0===h,l=void 0===o;if("spot"===i){if(l)throw new r(this.id+" watchBalance requires a 'currency' (id) or a unified 'code' parameter for "+i+" accounts")}else if("margin"===i||"swap"===i||"option"===i){if(u)throw new r(this.id+" watchBalance requires a 'instrument_id' (id) or a unified 'symbol' parameter for "+i+" accounts")}else if("futures"===i&&l&&u)throw new r(this.id+" watchBalance requires a 'currency' (id), or unified 'code', or 'instrument_id' (id), or unified 'symbol' parameter for "+i+" accounts");let f;l?u||(f=h.id):f=o.id;const p=("margin"===i?"spot":i)+"/"+("margin"===i?"margin_account":"account"),m=p+":"+f,b=this.urls.api.ws,g={op:"subscribe",args:[m]},y=this.omit(t,["currency","code","instrument_id","symbol","type"]);return await this.watch(b,p,this.deepExtend(g,y),m)}handleBalance(e,t){const s=this.safeString(t,"table"),i=s.split("/");let r=this.safeString(i,0);if("spot"===r){"margin_account"===this.safeString(i,1)&&(r="margin")}const a=this.safeValue(t,"data",[]);for(let t=0;t<a.length;t++){const t=this.parseBalanceByType(r,a),i=this.safeValue(this.balance,r,{}),n=this.deepExtend(i,t);this.balance[r]=this.parseBalance(n),e.resolve(this.balance[r],s)}}handleSubscriptionStatus(e,t){return t}handleAuthenticate(e,t){return e.resolve(t,"authenticated"),t}ping(e){return"ping"}handlePong(e,t){return e.lastPong=this.milliseconds(),t}handleErrorMessage(e,t){const s=this.safeString(t,"errorCode");try{if(void 0!==s){const e=this.id+" "+this.json(t);this.throwExactlyMatchedException(this.exceptions.exact,s,e);const i=this.safeValue(t,"message");void 0!==i&&this.throwBroadlyMatchedException(this.exceptions.broad,i,e)}}catch(t){if(t instanceof a){e.reject(t,"authenticated");const s="login";return s in e.subscriptions&&delete e.subscriptions[s],!1}}return t}handleMessage(e,t){if(!this.handleErrorMessage(e,t))return;if("pong"===t)return this.handlePong(e,t);const s=this.safeString(t,"table");if(void 0!==s){const i=s.split("/"),r=this.safeString(i,1),a={depth:this.handleOrderBook,depth5:this.handleOrderBook,depth_l2_tbt:this.handleOrderBook,ticker:this.handleTicker,trade:this.handleTrade,account:this.handleBalance,margin_account:this.handleBalance};let n=this.safeValue(a,r);return r.indexOf("candle")>=0&&(n=this.handleOHLCV),void 0===n?t:n.call(this,e,t)}{const s=this.safeString(t,"event");if(void 0!==s){const i={login:this.handleAuthenticate,subscribe:this.handleSubscriptionStatus},r=this.safeValue(i,s);return void 0===r?t:r.call(this,e,t)}}}}},9995:(e,t,s)=>{"use strict";const i=s(1853),{NotSupported:r}=s(3449),a=s(6832),{ArrayCache:n,ArrayCacheByTimestamp:o}=s(9584);e.exports=class extends i.phemex{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchTicker:!0,watchTickers:!1,watchTrades:!0,watchOrderBook:!0,watchOHLCV:!0},urls:{test:{ws:"wss://testnet.phemex.com/ws"},api:{ws:"wss://phemex.com/ws"}},options:{tradesLimit:1e3,OHLCVLimit:1e3},streaming:{keepAlive:2e4}})}fromEn(e,t){if(void 0===e)return;const s=new a(e);return s.decimals=this.sum(s.decimals,t),s.reduce(),s.toString()}fromEp(e,t){return void 0===e||void 0===t?e:this.fromEn(e,this.safeInteger(t,"priceScale"))}fromEv(e,t){return void 0===e||void 0===t?e:this.fromEn(e,this.safeInteger(t,"valueScale"))}fromEr(e,t){return void 0===e||void 0===t?e:this.fromEn(e,this.safeInteger(t,"ratioScale"))}requestId(){const e=this.sum(this.safeInteger(this.options,"requestId",0),1);return this.options.requestId=e,e}parseSwapTicker(e,t){const s=this.safeString(e,"symbol"),i=(t=this.safeMarket(s,t)).symbol,r=this.safeIntegerProduct(e,"timestamp",1e-6),n=this.fromEp(this.safeString(e,"close"),t),o=this.parseNumber(n),c=this.parseNumber(this.fromEv(this.safeString(e,"turnover"),t)),d=this.parseNumber(this.fromEv(this.safeString(e,"volume"),t));let h,u,l;const f=this.omitZero(this.fromEp(this.safeString(e,"open"),t)),p=this.parseNumber(f);void 0!==f&&void 0!==n&&(h=this.parseNumber(a.stringSub(n,f)),l=this.parseNumber(a.stringDiv(a.stringAdd(n,f),"2")),u=this.parseNumber(a.stringMul(a.stringSub(a.stringDiv(n,f),"1"),"100")));return{symbol:i,timestamp:r,datetime:this.iso8601(r),high:this.parseNumber(this.fromEp(this.safeString(e,"high"),t)),low:this.parseNumber(this.fromEp(this.safeString(e,"low"),t)),bid:void 0,bidVolume:void 0,ask:void 0,askVolume:void 0,vwap:void 0,open:p,close:o,last:o,previousClose:void 0,change:h,percentage:u,average:l,baseVolume:d,quoteVolume:c,info:e}}handleTicker(e,t){let s,i="market24h",r=this.safeValue(t,i);void 0===r?(i="spot_market24h",r=this.safeValue(t,i),s=this.parseTicker(r)):s=this.parseSwapTicker(r);const a=s.symbol,n=i+":"+a,o=this.safeIntegerProduct(t,"timestamp",1e-6);s.timestamp=o,s.datetime=this.iso8601(o),this.tickers[a]=s,e.resolve(s,n)}async watchBalance(e={}){throw await this.loadMarkets(),new r(this.id+" watchBalance() not implemented yet")}handleTrades(e,t){const s=this.safeString(t,"symbol"),i=this.safeMarket(s),r=i.symbol,a="trade:"+r;let o=this.safeValue(this.trades,r);if(void 0===o){const e=this.safeInteger(this.options,"tradesLimit",1e3);o=new n(e),this.trades[r]=o}const c=this.safeValue(t,"trades",[]),d=this.parseTrades(c,i);for(let e=0;e<d.length;e++)o.append(d[e]);e.resolve(o,a)}handleOHLCV(e,t){const s="kline",i=this.safeString(t,"symbol"),r=this.safeMarket(i),a=r.symbol,n=this.safeValue(t,s,[]),c=this.safeValue(n,0,[]),d=this.safeString(c,1),h=this.findTimeframe(d);if(void 0!==h){const t="kline:"+h+":"+a,s=this.parseOHLCVs(n,r);this.ohlcvs[a]=this.safeValue(this.ohlcvs,a,{});let i=this.safeValue(this.ohlcvs[a],h);if(void 0===i){const e=this.safeInteger(this.options,"OHLCVLimit",1e3);i=new o(e),this.ohlcvs[a][h]=i}for(let e=0;e<s.length;e++){const t=s[e];i.append(t)}e.resolve(i,t)}}async watchTicker(e,t={}){await this.loadMarkets();const s=this.market(e).spot?"spot_market24h":"market24h",i=this.urls.api.ws,r=s+".subscribe",a=s+":"+e,n={method:r,id:this.requestId(),params:[]},o=this.deepExtend(n,t);return await this.watch(i,a,o,r)}async watchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a=this.urls.api.ws,n="trade:"+e,o={method:"trade.subscribe",id:this.requestId(),params:[r.id]},c=this.deepExtend(o,i),d=await this.watch(a,n,c,n);return this.newUpdates&&(s=d.getLimit(e,s)),this.filterBySinceLimit(d,t,s,"timestamp",!0)}async watchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),r=this.urls.api.ws,a="orderbook",n=a+":"+e,o={method:"orderbook.subscribe",id:this.requestId(),params:[i.id]},c=this.deepExtend(o,s);return(await this.watch(r,n,c,n)).limit(t)}async watchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n=this.urls.api.ws,o="kline:"+t+":"+e,c={method:"kline.subscribe",id:this.requestId(),params:[a.id,this.safeInteger(this.timeframes,t)]},d=this.deepExtend(c,r),h=await this.watch(n,o,d,o);return this.newUpdates&&(i=h.getLimit(e,i)),this.filterBySinceLimit(h,s,i,0,!0)}handleDelta(e,t,s){const i=this.parseBidAsk(t,0,1,s);e.storeArray(i)}handleDeltas(e,t,s){for(let i=0;i<t.length;i++)this.handleDelta(e,t[i],s)}handleOrderBook(e,t){const s=this.safeString(t,"symbol"),i=this.safeMarket(s),r=i.symbol,a=this.safeString(t,"type"),n=this.safeInteger(t,"depth"),o="orderbook:"+r,c=this.safeInteger(t,"sequence"),d=this.safeIntegerProduct(t,"timestamp",1e-6);if("snapshot"===a){const s=this.safeValue(t,"book",{}),a=this.parseOrderBook(s,r,d,"bids","asks",0,1,i);a.nonce=c;const h=this.orderBook(a,n);this.orderbooks[r]=h,e.resolve(h,o)}else{const s=this.safeValue(this.orderbooks,r);if(void 0!==s){const a=this.safeValue(t,"book",{}),n=this.safeValue(a,"asks",[]),h=this.safeValue(a,"bids",[]);this.handleDeltas(s.asks,n,i),this.handleDeltas(s.bids,h,i),s.nonce=c,s.timestamp=d,s.datetime=this.iso8601(d),this.orderbooks[r]=s,e.resolve(s,o)}}}handleMessage(e,t){return"market24h"in t||"spot_market24h"in t?this.handleTicker(e,t):"trades"in t?this.handleTrades(e,t):"kline"in t?this.handleOHLCV(e,t):"book"in t?this.handleOrderBook(e,t):t}}},7815:(e,t,s)=>{"use strict";const i=s(1853),{ArrayCache:r,ArrayCacheBySymbolById:a}=s(9584);e.exports=class extends i.poloniex{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchTicker:!0,watchTickers:!1,watchTrades:!0,watchOrderBook:!0,watchBalance:!1,watchOHLCV:!1},urls:{api:{ws:"wss://api2.poloniex.com"}},options:{tradesLimit:1e3,symbolsByOrderId:{}}})}handleTickers(e,t){const s=this.safeString(t,0);if(this.safeValue(t,1))return;const i=this.safeValue(t,2),r=this.safeString(i,0),a=this.safeValue(this.options.marketsByNumericId,r);if(void 0===a)return;const n=this.safeString(a,"symbol"),o=this.milliseconds();let c,d,h;const u=this.safeFloat(i,1),l=this.safeFloat(i,4);-1!==l&&(c=u/this.sum(1,l),d=u-c,h=this.sum(u,c)/2);const f={symbol:n,timestamp:o,datetime:this.iso8601(o),high:this.safeFloat(i,8),low:this.safeFloat(i,9),bid:this.safeFloat(i,3),bidVolume:void 0,ask:this.safeFloat(i,2),askVolume:void 0,vwap:void 0,open:c,close:u,last:u,previousClose:void 0,change:d,percentage:100*l,average:h,baseVolume:this.safeFloat(i,6),quoteVolume:this.safeFloat(i,5),info:i};this.tickers[n]=f;const p=s+":"+r;e.resolve(f,p)}async subscribePrivate(e,t){const s="1000",i=this.urls.api.ws;s in this.client(i).subscriptions||this.spawn(this.fetchAndCacheOpenOrders);const r=this.nonce(),a=this.urlencode({nonce:r}),n=this.hmac(this.encode(a),this.encode(this.secret),"sha512"),o={command:"subscribe",channel:s,key:this.apiKey,payload:a,sign:n};return await this.watch(i,e,o,s,t)}async watchBalance(e={}){this.checkRequiredCredentials(),await this.loadMarkets();const t=this.urls.api.ws,s=this.client(t),i=this.safeValue(s.subscriptions,"1000",{});return this.safeValue(i,"fetchedBalance",!1)||(this.balance=await this.fetchBalance(),i.fetchedBalance=!0),await this.subscribePrivate("balance",i)}async fetchAndCacheOpenOrders(){const e=await this.fetchOpenOrders();let t=this.orders;const s=this.safeValue(this.options,"symbolsByOrderId",{});if(void 0===t){const e=this.safeInteger(this.options,"ordersLimit",1e3);t=new a(e),this.orders=t}for(let i=0;i<e.length;i++){const r=e[i];t.append(r),s[r.id]=r.symbol}this.options.symbolsByOrderId=s}async watchOrders(e,t,s,i={}){this.checkRequiredCredentials(),await this.loadMarkets();let r="orders";if(e){r=r+":"+this.marketId(e)}const a=await this.subscribePrivate(r,{});return this.newUpdates&&(s=a.getLimit()),this.filterBySymbolSinceLimit(a,e,t,s)}async watchMyTrades(e,t,s,i={}){this.checkRequiredCredentials(),await this.loadMarkets();let r="myTrades";if(e){r=r+":"+this.marketId(e)}const a=await this.subscribePrivate(r,{});return this.newUpdates&&(s=a.getLimit()),this.filterBySymbolSinceLimit(a,e,t,s)}async watchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i="1002",r="1002:"+this.safeString(s,"numericId"),a=this.urls.api.ws,n={command:"subscribe",channel:i};return await this.watch(a,r,n,i)}async watchTickers(e,t={}){await this.loadMarkets();const s="1002",i=this.urls.api.ws,r={command:"subscribe",channel:s},a=await this.watch(i,"1002",r,s);return this.filterByArray(a,"symbol",e)}async loadMarkets(e=!1,t={}){const s=await super.loadMarkets(e,t);let i=this.safeValue(this.options,"marketsByNumericId");if(void 0===i||e){i={};for(let e=0;e<this.symbols.length;e++){const t=this.symbols[e],s=this.markets[t];i[this.safeString(s,"numericId")]=s}this.options.marketsByNumericId=i}let r=this.safeValue(this.options,"marketsByNumericId");if(void 0===r||e){r={};const e=Object.keys(this.currencies);for(let t=0;t<e.length;t++){const s=this.currencies[e[t]];r[this.safeString(s,"numericId")]=s}this.options.currenciesByNumericId=r}return s}async watchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a=this.safeString(r,"numericId"),n="trades:"+a,o=this.urls.api.ws,c={command:"subscribe",channel:a},d=await this.watch(o,n,c,a);return this.newUpdates&&(s=d.getLimit(e,s)),this.filterBySinceLimit(d,t,s,"timestamp",!0)}async watchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),r=this.safeString(i,"numericId"),a="orderbook:"+r,n=this.urls.api.ws,o={command:"subscribe",channel:r};return(await this.watch(n,a,o,r)).limit(t)}async watchHeartbeat(e={}){await this.loadMarkets();const t=this.urls.api.ws;return await this.watch(t,"1010")}handleHeartbeat(e,t){e.resolve(t,"1010")}handleTrade(e,t,s){const i=this.safeString(t,1),r=this.safeInteger(t,2)?"buy":"sell",a=this.safeFloat(t,3),n=this.safeFloat(t,4),o=this.safeTimestamp(t,5);let c;return void 0!==s&&(c=s.symbol),{info:t,timestamp:o,datetime:this.iso8601(o),symbol:c,id:i,order:void 0,type:void 0,takerOrMaker:void 0,side:r,price:a,amount:n,cost:a*n,fee:void 0}}handleOrderBookAndTrades(e,t){const s=t[0].toString(),i=t[1],a=t[2],n=this.safeValue(this.options.marketsByNumericId,s),o=this.safeString(n,"symbol");let c=0,d=0,h=this.safeValue(this.trades,o);if(void 0===h){const e=this.safeInteger(this.options,"tradesLimit",1e3);h=new r(e),this.trades[o]=h}for(let t=0;t<a.length;t++){const s=a[t];if("i"===s[0]){const e=this.safeValue(s[1],"orderBook",[]),t=["asks","bids"];this.orderbooks[o]=this.orderBook();const r=this.orderbooks[o];for(let s=0;s<e.length;s++){const i=r[t[s]],a=e[s],n=Object.keys(a);for(let e=0;e<n.length;e++){const t=n[e],s=a[t];i.store(parseFloat(t),parseFloat(s))}}r.nonce=i,c=this.sum(c,1)}else if("o"===s[0]){const e=this.orderbooks[o],t=e[s[1]?"bids":"asks"],r=parseFloat(s[2]),a=parseFloat(s[3]);t.store(r,a),c=this.sum(c,1),e.nonce=i}else if("t"===s[0]){const t=this.handleTrade(e,s,n);h.append(t),d=this.sum(d,1)}}if(c){const t="orderbook:"+s,i=this.orderbooks[o];e.resolve(i,t)}if(d){const t="trades:"+s;e.resolve(h,t)}}handleAccountNotifications(e,t){const s=this.safeValue(t,2,[]),i={b:[this.handleBalance],p:[this.handleOrder,this.handleBalance],n:[this.handleOrder,this.handleBalance],o:[this.handleOrder,this.handleBalance],t:[this.handleMyTrade,this.handleOrder,this.handleBalance]};for(let t=0;t<s.length;t++){const r=s[t],a=this.safeString(r,0),n=this.safeValue(i,a);if(Array.isArray(n))for(let t=0;t<n.length;t++){n[t].call(this,e,r)}}}handleBalance(e,t){const s=this.safeValue(e.subscriptions,"1000",{});if(!this.safeValue(s,"fetchedBalance",!1))return;const i=this.safeString(t,0);if("b"===i){if("e"!==this.safeString(t,2))return;const e=this.safeString(t,1),s=this.safeValue(this.options.currenciesByNumericId,e);if(void 0===s)return;const i=s.code,r=this.safeFloat(t,3);this.balance[i].free=this.sum(this.balance[i].free,r),this.balance[i].total=void 0,this.balance=this.parseBalance(this.balance)}else if("o"===i||"p"===i||"t"===i||"n"===i){let e,s;if("o"===i||"p"===i){s=this.safeString(t,1);const e=this.safeString(t,3);if("o"===i&&"f"===e)return}else"t"===i?s=this.safeString(t,6):"n"===i&&(s=this.safeString(t,2));const r=this.safeValue(this.options,"symbolsByOrderId");if(e=this.safeString(r,s),!(e in this.markets))return;const a=this.market(e),n=this.safeValue(this.orders.hashmap,e,{}),o=this.safeValue(n,s),c=a.quote;let d;d="n"===i?o.filled:"o"===i?this.safeFloat(t,5):o.amount;const h=d*o.price,u=a.base,l=d;let f,p;"buy"===o.side?(f=h,p=c):(f=l,p=u);const m=this.amountToPrecision(e,f),b=parseFloat(m);this.balance[p].used="o"===i||"t"===i||"n"===i?this.balance[p].used-b:this.sum(this.balance[p].used,b),this.balance[p].total=void 0,this.balance=this.parseBalance(this.balance)}e.resolve(this.balance,"balance")}handleOrder(e,t){let s=this.orders;const i=this.safeInteger(this.options,"ordersLimit",1e3),r=this.safeValue(this.options,"symbolsByOrderId",{});void 0===s&&(s=new a(i),this.orders=s);const n=s.length,o=this.safeString(t,0);let c;if("p"===o){const e=this.safeString(t,1),a=this.safeString(t,2),o=this.safeValue(this.options.marketsByNumericId,a);if(void 0===o)return;c=o.symbol,r[e]=c;const d=this.safeFloat(t,3),h=this.safeFloat(t,4),u=this.safeInteger(t,5)?"buy":"sell",l=this.safeString(t,6);if(n===i){const e=s[0];e.id in r&&delete r[e.id]}s.append({info:t,symbol:c,id:e,clientOrderId:l,timestamp:void 0,datetime:void 0,lastTradeTimestamp:void 0,type:"limit",timeInForce:void 0,postOnly:void 0,side:u,price:d,stopPrice:void 0,amount:h,cost:void 0,average:void 0,filled:void 0,remaining:h,status:"open",fee:void 0,trades:void 0})}else if("n"===o){const e=this.safeString(t,1),a=this.safeValue(this.options.marketsByNumericId,e);if(void 0===a)return;c=a.symbol;const o=this.safeString(t,2),d=this.safeInteger(t,3)?"buy":"sell",h=this.safeFloat(t,4),u=this.safeFloat(t,5),l=this.safeString(t,6),f=this.parse8601(l),p=this.safeFloat(t,7),m=this.safeString(t,8);let b,g;if(void 0!==p&&void 0!==u&&(b=p-u,g=b*h),n===i){const e=s[0];e.id in r&&delete r[e.id]}s.append({info:t,symbol:c,id:o,clientOrderId:m,timestamp:f,datetime:this.iso8601(f),lastTradeTimestamp:void 0,type:"limit",timeInForce:void 0,postOnly:void 0,side:d,price:h,stopPrice:void 0,amount:p,cost:g,average:void 0,filled:b,remaining:u,status:"open",fee:void 0,trades:void 0})}else if("o"===o){const e=this.safeString(t,1),i=this.safeString(t,3);if("c"===i||"k"===i){const t=this.safeString(r,e),i=this.safeValue(s.hashmap,t,{}),a=this.safeValue(i,e);void 0!==a&&(a.status="canceled")}}else if("t"===o){const e=this.parseWsTrade(t),i=this.safeString(e,"order"),a=this.safeString(r,i),n=this.safeValue(s.hashmap,a,{}),o=this.safeValue(n,i);void 0===o.trades&&(o.trades=[]),o.trades.push(e);let c=o.filled;c=void 0===c?e.amount:o.filled+e.amount,void 0!==o.amount&&(o.remaining=Math.max(o.amount-c,0),0===o.remaining&&(o.status="closed")),o.filled=c,o.cost=c*o.price,void 0===o.fee?o.fee={currency:e.fee.currency,cost:e.fee.cost}:o.fee.cost=this.sum(o.fee.cost,e.fee.cost)}const d="orders";e.resolve(s,d);const h="orders:"+c;e.resolve(s,h)}handleMyTrade(e,t){let s=this.myTrades;if(void 0===s){const e=this.safeInteger(this.options,"tradesLimit",1e3);s=new a(e)}let i=this.orders;if(void 0===i){const e=this.safeInteger(this.options,"ordersLimit",1e3);i=new a(e),this.orders=i}const r=this.parseWsTrade(t);s.append(r);const n="myTrades";e.resolve(s,n);const o="myTrades:"+r.symbol;e.resolve(s,o)}parseWsTrade(e){const t=this.orders,s=this.safeString(e,1),i=this.safeFloat(e,2),r=this.safeFloat(e,3),a=this.safeFloat(e,4),n=this.safeString(e,6),o=this.safeFloat(e,7),c=this.safeString(e,8),d=this.safeFloat(e,10),h=this.parse8601(c),u=this.safeValue(this.options,"symbolsByOrderId",{}),l=this.safeString(u,n),f=this.safeValue(t.hashmap,l,{}),p=this.safeValue(f,n),m=this.market(l),b=this.safeString(p,"side");let g;g="buy"===b?m.base:m.quote;const y={cost:o,rate:a,currency:g};return{info:e,timestamp:h,datetime:this.iso8601(h),symbol:l,id:s,order:n,type:"limit",takerOrMaker:void 0,side:b,price:i,amount:r,cost:d,fee:y}}handleMessage(e,t){const s=this.safeString(t,0),i={1e3:this.handleAccountNotifications,1002:this.handleTickers,1010:this.handleHeartbeat},r=this.safeValue(i,s);if(void 0===r){return void 0===this.safeValue(this.options.marketsByNumericId,s)?t:this.handleOrderBookAndTrades(e,t)}r.call(this,e,t)}}},4720:(e,t,s)=>{"use strict";const i=s(1853),{ArrayCache:r}=s(9584);e.exports=class extends i.ripio{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchOrderBook:!0,watchTrades:!0,watchTicker:!0},urls:{api:{ws:"wss://api.exchange.ripio.com/ws/v2/consumer/non-persistent/public/default/"}},options:{tradesLimit:1e3,uuid:this.uuid()}})}async watchTrades(e,t,s,i={}){await this.loadMarkets();const r="trades",a=r+"_"+this.market(e).id.toLowerCase(),n=this.urls.api.ws+a+"/"+this.options.uuid,o={name:r,symbol:e,messageHash:a,method:this.handleTrade},c=await this.watch(n,a,void 0,a,o);return this.newUpdates&&(s=c.getLimit(e,s)),this.filterBySinceLimit(c,t,s,"timestamp",!0)}handleTrade(e,t,s){const i=this.safeString(t,"payload");if(void 0===i)return t;const a=JSON.parse(this.base64ToString(i)),n=this.safeString(s,"symbol"),o=this.safeString(s,"messageHash"),c=this.market(n),d=this.parseTrade(a,c);let h=this.safeValue(this.trades,n);if(void 0===h){const e=this.safeInteger(this.options,"tradesLimit",1e3);h=new r(e),this.trades[n]=h}h.append(d),e.resolve(h,o)}async watchTicker(e,t={}){await this.loadMarkets();const s="rate",i="rate_"+this.market(e).id.toLowerCase(),r=this.urls.api.ws+i+"/"+this.options.uuid,a={name:s,symbol:e,messageHash:i,method:this.handleTicker};return await this.watch(r,i,void 0,i,a)}handleTicker(e,t,s){const i=this.safeString(t,"payload");if(void 0===i)return t;const r=JSON.parse(this.base64ToString(i)),a=this.parseTicker(r),n=this.parse8601(this.safeString(t,"publishTime"));a.timestamp=n,a.datetime=this.iso8601(n);const o=a.symbol;this.tickers[o]=a;const c=this.safeString(s,"messageHash");return void 0!==c&&e.resolve(a,c),t}async watchOrderBook(e,t,s={}){await this.loadMarkets();const i="orderbook",r=i+"_"+this.market(e).id.toLowerCase(),a=this.urls.api.ws+r+"/"+this.options.uuid,n=this.client(a),o={name:i,symbol:e,messageHash:r,method:this.handleOrderBook};if(!(r in n.subscriptions)){this.orderbooks[e]=this.orderBook({}),n.subscriptions[r]=o;const t=this.safeValue(this.options,"fetchOrderBookSnapshot",{}),s=this.safeInteger(t,"delay",this.rateLimit);this.delay(s,this.fetchOrderBookSnapshot,n,o)}return(await this.watch(a,r,void 0,r,o)).limit(t)}async fetchOrderBookSnapshot(e,t){const s=this.safeString(t,"symbol"),i=this.safeString(t,"messageHash");try{const t=await this.fetchOrderBook(s),r=this.orderbooks[s],a=r.cache;r.reset(t);for(let t=0;t<a.length;t++){const s=a[t];this.handleOrderBookMessage(e,s,r)}this.orderbooks[s]=r,e.resolve(r,i)}catch(t){e.reject(t,i)}}handleOrderBook(e,t,s){const i=this.safeString(s,"messageHash"),r=this.safeString(s,"symbol"),a=this.safeValue(this.orderbooks,r);return void 0===a||(void 0===a.nonce?a.cache.push(t):(this.handleOrderBookMessage(e,t,a),e.resolve(a,i))),t}handleOrderBookMessage(e,t,s){const i=this.safeString(t,"payload");if(void 0===i)return t;const r=JSON.parse(this.base64ToString(i)),a=this.safeInteger(r,"updated_id");if(a>s.nonce){const e=this.safeValue(r,"sell",[]),i=this.safeValue(r,"buy",[]);this.handleDeltas(s.asks,e,s.nonce),this.handleDeltas(s.bids,i,s.nonce),s.nonce=a;const n=this.parse8601(this.safeString(t,"publishTime"));s.timestamp=n,s.datetime=this.iso8601(n)}return s}handleDelta(e,t){const s=this.safeFloat(t,"price"),i=this.safeFloat(t,"amount");e.store(s,i)}handleDeltas(e,t){for(let s=0;s<t.length;s++)this.handleDelta(e,t[s])}async ack(e,t){await e.send({messageId:t})}handleMessage(e,t){const s=this.safeString(t,"messageId");void 0!==s&&this.spawn(this.ack,e,s);const i=Object.keys(e.subscriptions),r=this.safeString(i,0),a=this.safeValue(e.subscriptions,r,{}),n=this.safeValue(a,"method");return void 0!==n?n.call(this,e,t,a):t}}},7739:(e,t,s)=>{"use strict";const i=s(1853),{ArrayCache:r}=s(9584);e.exports=class extends i.upbit{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchOrderBook:!0,watchTicker:!0,watchTrades:!0},urls:{api:{ws:"wss://api.upbit.com/websocket/v1"}},options:{tradesLimit:1e3}})}async watchPublic(e,t,s={}){await this.loadMarkets();const i=this.market(e).id,r=this.urls.api.ws;this.options[t]=this.safeValue(this.options,t,{}),this.options[t][e]=!0;const a=Object.keys(this.options[t]),n=this.marketIds(a),o=[{ticket:this.uuid()},{type:t,codes:n}],c=t+":"+i;return await this.watch(r,c,o,c)}async watchTicker(e,t={}){return await this.watchPublic(e,"ticker")}async watchTrades(e,t,s,i={}){const r=await this.watchPublic(e,"trade");return this.newUpdates&&(s=r.getLimit(e,s)),this.filterBySinceLimit(r,t,s,"timestamp",!0)}async watchOrderBook(e,t,s={}){return(await this.watchPublic(e,"orderbook")).limit(t)}handleTicker(e,t){const s="ticker:"+this.safeString(t,"code"),i=this.parseTicker(t),r=i.symbol;this.tickers[r]=i,e.resolve(i,s)}handleOrderBook(e,t){const s=this.safeString(t,"code"),i=this.safeSymbol(s,void 0,"-"),r=this.safeString(t,"stream_type"),a=this.safeValue(this.options,"watchOrderBook",{}),n=this.safeInteger(a,"limit",15);"SNAPSHOT"===r&&(this.orderbooks[i]=this.orderBook({},n));const o=this.orderbooks[i];o.reset({});const c=o.bids,d=o.asks,h=this.safeValue(t,"orderbook_units",[]);for(let e=0;e<h.length;e++){const t=h[e],s=this.safeFloat(t,"ask_price"),i=this.safeFloat(t,"ask_size"),r=this.safeFloat(t,"bid_price"),a=this.safeFloat(t,"bid_size");d.store(s,i),c.store(r,a)}const u=this.safeInteger(t,"timestamp"),l=this.iso8601(u);o.timestamp=u,o.datetime=l;const f="orderbook:"+s;e.resolve(o,f)}handleTrades(e,t){const s=this.parseTrade(t),i=s.symbol;let a=this.safeValue(this.trades,i);if(void 0===a){const e=this.safeInteger(this.options,"tradesLimit",1e3);a=new r(e),this.trades[i]=a}a.append(s);const n="trade:"+this.safeString(t,"code");e.resolve(a,n)}handleMessage(e,t){const s={ticker:this.handleTicker,orderbook:this.handleOrderBook,trade:this.handleTrades},i=this.safeString(t,"type"),r=this.safeValue(s,i);r&&r.call(this,e,t)}}},6916:(e,t,s)=>{"use strict";const i=s(1853),{ExchangeError:r}=s(3449),{ArrayCache:a}=s(9584);e.exports=class extends i.zb{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchOrderBook:!0,watchTicker:!0,watchTrades:!0},urls:{api:{ws:"wss://api.zb.today/websocket"}},options:{tradesLimit:1e3,ordersLimit:1e3,OHLCVLimit:1e3}})}async watchPublic(e,t,s,i={}){await this.loadMarkets();const r=this.market(t),a=r.baseId+r.quoteId+"_"+e,n=this.urls.api.ws,o={event:"addChannel",channel:a},c=this.extend(o,i),d={name:e,symbol:t,marketId:r.id,messageHash:a,method:s};return await this.watch(n,a,c,a,d)}async watchTicker(e,t={}){return await this.watchPublic("ticker",e,this.handleTicker,t)}handleTicker(e,t,s){const i=this.safeString(s,"symbol"),r=this.safeString(t,"channel"),a=this.market(i),n=this.safeValue(t,"ticker");n.date=this.safeValue(t,"date");const o=this.parseTicker(n,a);return o.symbol=i,this.tickers[i]=o,e.resolve(o,r),t}async watchTrades(e,t,s,i={}){const r=await this.watchPublic("trades",e,this.handleTrades,i);return this.newUpdates&&(s=r.getLimit(e,s)),this.filterBySinceLimit(r,t,s,"timestamp",!0)}handleTrades(e,t,s){const i=this.safeValue(t,"channel"),r=this.safeString(s,"symbol"),n=this.market(r),o=this.safeValue(t,"data"),c=this.parseTrades(o,n);let d=this.safeValue(this.trades,r);if(void 0===d){const e=this.safeInteger(this.options,"tradesLimit",1e3);d=new a(e)}for(let e=0;e<c.length;e++)d.append(c[e]);this.trades[r]=d,e.resolve(d,i)}async watchOrderBook(e,t,s={}){if(void 0!==t){if(5!==t&&10!==t&&20!==t)throw new r(this.id+" watchOrderBook limit argument must be undefined, 5, 10 or 20")}else t=5;await this.loadMarkets();const i=this.market(e),a="quick_depth",n=i.baseId+i.quoteId+"_"+a,o=this.urls.api.ws+"/"+i.baseId,c={event:"addChannel",channel:n,length:t},d=this.extend(c,s),h={name:a,symbol:e,marketId:i.id,messageHash:n,method:this.handleOrderBook};return(await this.watch(o,n,d,n,h)).limit(t)}handleOrderBook(e,t,s){const i=this.safeString(t,"channel"),r=this.safeInteger(s,"limit"),a=this.safeString(s,"symbol");let n=this.safeValue(this.orderbooks,a);void 0===n&&(n=this.orderBook({},r),this.orderbooks[a]=n);const o=this.safeInteger(t,"lastTime"),c=this.parseOrderBook(t,a,o,"listDown","listUp");n.reset(c),n.symbol=a,e.resolve(n,i)}handleMessage(e,t){if(void 0!==this.safeString(t,"dataType")){const s=this.safeString(t,"channel"),i=this.safeValue(e.subscriptions,s);if(void 0!==i){const s=this.safeValue(i,"method");if(void 0!==s)return s.call(this,e,t,i)}return t}}}},1853:(e,t,s)=>{"use strict";const i=s(8819),r=s(6832),a=s(5806),n=s(3449),o="1.52.41";i.ccxtVersion=o;const c={aax:s(9133),aofex:s(1272),ascendex:s(2300),bequant:s(1366),bibox:s(7838),bigone:s(4400),binance:s(6056),binancecoinm:s(2483),binanceus:s(3393),binanceusdm:s(2137),bit2c:s(2455),bitbank:s(9703),bitbay:s(3528),bitbns:s(8875),bitcoincom:s(3334),bitfinex:s(7965),bitfinex2:s(5328),bitflyer:s(5421),bitforex:s(2519),bitget:s(829),bithumb:s(9202),bitmart:s(9102),bitmex:s(7763),bitpanda:s(3223),bitso:s(5686),bitstamp:s(7653),bitstamp1:s(2554),bittrex:s(9461),bitvavo:s(4253),bitz:s(6424),bl3p:s(5480),braziliex:s(6147),btcalpha:s(6492),btcbox:s(6142),btcmarkets:s(9284),btctradeua:s(233),btcturk:s(1899),buda:s(4875),bw:s(1520),bybit:s(3803),bytetrade:s(2291),cdax:s(9124),cex:s(4228),coinbase:s(2939),coinbaseprime:s(8806),coinbasepro:s(1241),coincheck:s(1770),coinegg:s(6347),coinex:s(8427),coinfalcon:s(6810),coinfloor:s(1224),coinmarketcap:s(6410),coinmate:s(948),coinone:s(9261),coinspot:s(8974),crex24:s(7268),currencycom:s(9610),delta:s(4237),deribit:s(1680),digifinex:s(6755),eqonex:s(8170),equos:s(6159),exmo:s(4101),exx:s(5982),flowbtc:s(3513),ftx:s(9636),gateio:s(4663),gemini:s(3094),gopax:s(6039),hbtc:s(4493),hitbtc:s(8267),hollaex:s(4693),huobijp:s(4072),huobipro:s(3775),idex:s(2574),independentreserve:s(3585),indodax:s(4535),itbit:s(1431),kraken:s(6594),kucoin:s(6987),kuna:s(3112),latoken:s(2444),lbank:s(1524),liquid:s(4352),luno:s(5439),lykke:s(5591),mercado:s(7551),mixcoins:s(4554),ndax:s(1985),novadax:s(1541),oceanex:s(7426),okcoin:s(1384),okex:s(8579),okex5:s(2597),paymium:s(757),phemex:s(788),poloniex:s(7497),probit:s(6818),qtrade:s(2715),ripio:s(2041),southxchange:s(8405),stex:s(842),therock:s(9269),tidebit:s(1783),tidex:s(6974),timex:s(1378),upbit:s(7705),vcc:s(3571),wavesexchange:s(6091),whitebit:s(390),xena:s(9741),yobit:s(5927),zaif:s(4422),zb:s(927)};e.exports=Object.assign({version:o,Exchange:i,Precise:r,exchanges:Object.keys(c)},c,a,n)},9133:(e,t,s)=>{"use strict";const i=s(8819),{ArgumentsRequired:r,AuthenticationError:a,ExchangeError:n,ExchangeNotAvailable:o,OrderNotFound:c,InvalidOrder:d,CancelPending:h,RateLimitExceeded:u,InsufficientFunds:l,BadRequest:f,BadSymbol:p,PermissionDenied:m}=s(3449),{TICK_SIZE:b}=s(2115),g=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"aax",name:"AAX",countries:["MT"],enableRateLimit:!0,rateLimit:500,version:"v2",hostname:"aaxpro.com",certified:!0,pro:!0,has:{cancelAllOrders:!0,cancelOrder:!0,createOrder:!0,editOrder:!0,fetchBalance:!0,fetchCanceledOrders:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchStatus:!0,fetchTicker:"emulated",fetchTickers:!0,fetchTrades:!0},timeframes:{"1m":"1m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","2h":"2h","4h":"4h","12h":"12h","1d":"1d","3d":"3d","1w":"1w"},urls:{logo:"https://user-images.githubusercontent.com/1294454/104140087-a27f2580-53c0-11eb-87c1-5d9e81208fe9.jpg",test:{v1:"https://api.testnet.{hostname}/marketdata/v1",public:"https://api.testnet.{hostname}",private:"https://api.testnet.{hostname}"},api:{v1:"https://api.{hostname}/marketdata/v1",public:"https://api.{hostname}",private:"https://api.{hostname}"},www:"https://www.aaxpro.com",doc:"https://www.aaxpro.com/apidoc/index.html",fees:"https://www.aaxpro.com/en-US/fees/",referral:"https://www.aaxpro.com/invite/sign-up?inviteCode=JXGm5Fy7R2MB"},api:{v1:{get:["getHistMarketData"]},public:{get:["currencies","announcement/maintenance","instruments","market/orderbook","futures/position/openInterest","market/tickers","market/candles","market/history/candles","market/trades","market/markPrice","futures/funding/predictedFunding/{symbol}","futures/funding/prevFundingRate/{symbol}","market/candles/index"]},private:{get:["user/info","account/balances","account/deposit/address","spot/trades","spot/openOrders","spot/orders","futures/position","futures/position/closed","futures/trades","futures/openOrders","futures/orders","futures/funding/predictedFundingFee/{symbol}"],post:["account/transfer","spot/orders","spot/orders/cancelAllOnTimeout","futures/orders","futures/orders/cancelAllOnTimeout","futures/position/sltp","futures/position/close","futures/position/leverage","futures/position/margin"],put:["spot/orders","futures/orders"],delete:["spot/orders/cancel/{orderID}","spot/orders/cancel/all","futures/orders/cancel/{orderID}","futures/orders/cancel/all"]}},fees:{trading:{tierBased:!1,percentage:!0,maker:6e-4,taker:.001},funding:{tierBased:!1,percentage:!0,withdraw:{}}},commonCurrencies:{XBT:"XBT"},exceptions:{exact:{2002:l,2003:c,10003:f,10006:a,10007:a,11007:a,20001:l,20009:d,3e4:c,30001:d,30004:d,30005:d,30006:d,30007:d,30008:d,30009:d,30010:d,30011:h,30012:f,30013:p,30014:c,30015:d,30016:n,30017:d,30018:d,30019:d,30020:d,30021:d,30022:d,30023:d,30024:d,30025:d,30026:d,30027:d,30028:p,30029:d,30030:d,30031:d,30032:d,30033:d,30034:u,30035:u,30036:o,30037:d,30038:n,30039:l,30040:d,30041:d,30042:d,30043:d,30044:f,30045:d,30046:d,30047:d,30048:d,30049:d,30050:d,40004:f,40009:u,40102:a,40103:a,40303:m,41001:f,41002:f,42001:o,50001:n,50002:n},broad:{}},precisionMode:b,options:{defaultType:"spot",types:{spot:"SPTP",future:"FUTP",otc:"F2CP",saving:"VLTP"},accounts:{SPTP:"spot",FUTP:"future",F2CP:"otc",VLTP:"saving"}}})}async fetchStatus(e={}){const t=await this.publicGetAnnouncementMaintenance(e),s=this.safeValue(t,"data",{}),i=this.milliseconds(),r=this.parse8601(this.safeString(s,"startTime")),a=this.parse8601(this.safeString(s,"endTime")),n={updated:this.safeInteger(t,"ts",i)};if(void 0!==a){const e=void 0===r||i<r,t=i>a||e;n.eta=a,n.status=t?"ok":"maintenance"}return this.status=this.extend(this.status,n),this.status}async fetchMarkets(e={}){const t=await this.publicGetInstruments(e),s=this.safeValue(t,"data"),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"symbol"),a=this.safeString(t,"base"),n=this.safeString(t,"quote"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d="enable"===this.safeString(t,"status"),h=this.safeNumber(t,"takerFee"),u=this.safeNumber(t,"makerFee"),l=this.safeString(t,"type");let f,p,m;const b="spot"===l,g="futures"===l,y=this.safeStringLower(t,"settleType");void 0!==y&&(f="inverse"===y,p="vanilla"===y,m="quanto"===y);let v=r;"spot"===l&&(v=o+"/"+c);const w={amount:this.safeNumber(t,"lotSize"),price:this.safeNumber(t,"tickSize")};i.push({id:r,symbol:v,base:o,quote:c,baseId:a,quoteId:n,type:l,spot:b,futures:g,inverse:f,linear:p,quanto:m,precision:w,info:t,active:d,taker:h,maker:u,percentage:!1,tierBased:!0,limits:{amount:{min:this.safeString(t,"minQuantity"),max:this.safeString(t,"maxQuantity")},price:{min:this.safeString(t,"minPrice"),max:this.safeString(t,"maxPrice")},cost:{min:void 0,max:void 0}}})}return i}async fetchCurrencies(e={}){const t=await this.publicGetCurrencies(e),s={},i=this.safeValue(t,"data",[]);for(let e=0;e<i.length;e++){const t=i[e],r=this.safeString(t,"chain"),a=this.safeString(t,"displayName"),n=this.safeCurrencyCode(r),o=this.safeNumber(t,"withdrawPrecision"),c=this.safeValue(t,"enableWithdraw"),d=this.safeValue(t,"enableDeposit"),h=this.safeNumber(t,"withdrawFee"),u=this.safeValue(t,"visible"),l=c&&d&&u,f=this.safeString(t,"network");s[n]={id:r,name:a,code:n,precision:o,info:t,active:l,fee:h,network:f,limits:{deposit:{min:this.safeNumber(t,"depositMin"),max:void 0},withdraw:{min:this.safeNumber(t,"withdrawMin"),max:void 0}}}}return s}parseTicker(e,t){const s=this.safeInteger(e,"t"),i=this.safeString(e,"s"),r=this.safeSymbol(i,t),a=this.safeNumber(e,"c"),n=this.safeNumber(e,"o");let o,c,d;void 0!==a&&void 0!==n&&(o=a-n,n>0&&(c=o/n*100),d=this.sum(a,n)/2);const h=this.safeNumber(e,"v");return{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"h"),low:this.safeNumber(e,"l"),bid:void 0,bidVolume:void 0,ask:void 0,askVolume:void 0,vwap:void 0,open:n,close:a,last:a,previousClose:void 0,change:o,percentage:c,average:d,baseVolume:void 0,quoteVolume:h,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetMarketTickers(t),i=this.safeValue(s,"tickers",[]),r=[],a=this.safeInteger(s,"t");for(let e=0;e<i.length;e++){const t=this.parseTicker(this.extend(i[e],{t:a}));r.push(t)}return this.filterByArray(r,"symbol",e)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e);if(void 0===t)t=20;else if(20!==t&&50!==t)throw new f(this.id+" fetchOrderBook() limit argument must be undefined, 20 or 50");const r={symbol:i.id,level:t},a=await this.publicGetMarketOrderbook(this.extend(r,s)),n=this.safeInteger(a,"t");return this.parseOrderBook(a,e,n)}parseTrade(e,t){let s=this.safeInteger(e,"t");void 0===s&&(s=this.parse8601(this.safeString(e,"createTime")));const i=this.safeString2(e,"tid","tradeID");let r;const a=this.safeString(e,"symbol");void 0!==(t=this.safeMarket(a,t))&&(r=t.symbol);let n=this.safeString2(e,"p","filledPrice");const o=this.safeString2(e,"q","filledQty"),c=this.safeString(e,"orderID"),d=this.safeValue(e,"taker");let h;void 0!==d&&(h=d?"taker":"maker");let u=this.safeString(e,"side");"1"===u?u="buy":"2"===u&&(u="sell"),void 0===u&&(u="-"===n[0]?"sell":"buy"),n=g.stringAbs(n);const l=this.parseNumber(n),f=this.parseNumber(o),p=this.parseNumber(g.stringMul(n,o)),m=this.parseOrderType(this.safeString(e,"orderType"));let b;const y=this.safeNumber(e,"commission");if(void 0!==y){let e;void 0!==t&&("buy"===u?e=t.base:"sell"===u&&(e=t.quote)),b={currency:e,cost:y}}return{info:e,id:i,timestamp:s,datetime:this.iso8601(s),symbol:r,type:m,side:u,order:c,takerOrMaker:h,price:l,amount:f,cost:p,fee:b}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e);s=void 0===s?2e3:s,s=Math.min(s,2e3);const a={symbol:r.id,limit:s},n=await this.publicGetMarketTrades(a),o=this.safeValue(n,"trades",[]);return this.parseTrades(o,r,t,s)}parseOHLCV(e,t){return[this.safeTimestamp(e,5),this.safeNumber(e,0),this.safeNumber(e,1),this.safeNumber(e,2),this.safeNumber(e,3),this.safeNumber(e,4)]}async fetchOHLCV(e,t="1h",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={symbol:a.id,timeFrame:this.timeframes[t]};i=void 0===i?500:i;const o=this.parseTimeframe(t);if(void 0===s){const e=this.seconds();n.start=e-o*i,n.end=e}else{const e=parseInt(s/1e3);n.start=e,n.end=this.sum(e,o*i)}const c=await this.publicGetMarketHistoryCandles(this.extend(n,r)),d=this.safeValue(c,"data",[]);return this.parseOHLCVs(d,a,t,s,i)}async fetchBalance(e={}){await this.loadMarkets();const t=this.safeString2(this.options,"fetchBalance","defaultType","spot"),s=this.safeString(e,"type",t),i=this.safeValue(this.options,"types",{}),r=this.safeString(i,s,s),a={purseType:r};e=this.omit(e,"type");const n=await this.privateGetAccountBalances(this.extend(a,e)),o=this.safeValue(n,"data"),c=this.safeInteger(n,"ts"),d={info:n,timestamp:c,datetime:this.iso8601(c)};for(let e=0;e<o.length;e++){const t=o[e];if(this.safeString(t,"purseType")===r){const e=this.safeString(t,"currency"),s=this.safeCurrencyCode(e),i=this.account();i.free=this.safeString(t,"available"),i.used=this.safeString(t,"unavailable"),d[s]=i}}return this.parseBalance(d,!1)}async createOrder(e,t,s,i,a,n={}){let o=t.toUpperCase();const c=s.toUpperCase();await this.loadMarkets();const d=this.market(e),h={symbol:d.id,orderQty:this.amountToPrecision(e,i),side:c},u=this.safeString(n,"timeInForce");void 0!==u&&(h.timeInForce=u,n=this.omit(n,"timeInForce"));const l=this.safeString2(n,"clOrdID","clientOrderId");void 0!==l&&(h.clOrdID=l,n=this.omit(n,["clOrdID","clientOrderId"]));const f=this.safeNumber(n,"stopPrice");if(void 0===f){if("STOP-LIMIT"===o||"STOP"===o)throw new r(this.id+" createOrder() requires a stopPrice parameter for "+o+" orders")}else"LIMIT"===o?o="STOP-LIMIT":"MARKET"===o&&(o="STOP"),h.stopPrice=this.priceToPrecision(e,f),n=this.omit(n,"stopPrice");let p;"LIMIT"!==o&&"STOP-LIMIT"!==o||(h.price=this.priceToPrecision(e,a)),h.orderType=o,d.spot?p="privatePostSpotOrders":d.futures&&(p="privatePostFuturesOrders");const m=await this[p](this.extend(h,n)),b=this.safeValue(m,"data",{});return this.parseOrder(b,d)}async editOrder(e,t,s,i,r,a,n={}){await this.loadMarkets();const o=this.market(t),c={orderID:e},d=this.safeNumber(n,"stopPrice");let h;void 0!==d&&(c.stopPrice=this.priceToPrecision(t,d),n=this.omit(n,"stopPrice")),void 0!==a&&(c.price=this.priceToPrecision(t,a)),void 0!==r&&(c.orderQty=this.amountToPrecision(t,r)),o.spot?h="privatePutSpotOrders":o.futures&&(h="privatePutFuturesOrders");const u=await this[h](this.extend(c,n)),l=this.safeValue(u,"data",{});return this.parseOrder(l,o)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={orderID:e};let r;const a=this.safeString2(this.options,"cancelOrder","defaultType","spot");let n,o=this.safeString(s,"type",a);s=this.omit(s,"type"),void 0!==t&&(n=this.market(t),o=n.type),"spot"===o?r="privateDeleteSpotOrdersCancelOrderID":"futures"===o&&(r="privateDeleteFuturesOrdersCancelOrderID");const c=await this[r](this.extend(i,s)),d=this.safeValue(c,"data",{});return this.parseOrder(d,n)}async cancelAllOrders(e,t={}){if(void 0===e)throw new r(this.id+" cancelAllOrders() requires a symbol argument");await this.loadMarkets();const s=this.market(e),i={symbol:s.id};let a;s.spot?a="privateDeleteSpotOrdersCancelAll":s.futures&&(a="privateDeleteFuturesOrdersCancelAll");return await this[a](this.extend(i,t))}async fetchOrder(e,t,s={}){await this.loadMarkets();const i=this.safeString2(this.options,"fetchOrder","defaultType","spot");s.type=this.safeString(s,"type",i);const r={},a=this.safeString2(s,"clOrdID","clientOrderId");void 0===a?r.orderID=e:(r.clOrdID=a,s=this.omit(s,["clOrdID","clientOrderId"]));const n=await this.fetchOrders(t,void 0,void 0,this.extend(r,s)),o=this.safeValue(n,0);if(void 0===o)throw new c(void 0===a?this.id+" fetchOrder() could not find order id "+e:this.id+" fetchOrder() could not find order clientOrderID "+a);return o}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r={},a=this.safeString2(this.options,"fetchOpenOrders","defaultType","spot");let n,o=this.safeString(i,"type",a);i=this.omit(i,"type"),void 0!==e&&(n=this.market(e),r.symbol=n.id,o=n.type);const c=this.safeString2(i,"clOrdID","clientOrderId");let d;void 0!==c&&(r.clOrdID=c,i=this.omit(i,["clOrdID","clientOrderId"])),"spot"===o?d="privateGetSpotOpenOrders":"futures"===o&&(d="privateGetFuturesOpenOrders"),void 0!==s&&(r.pageSize=s);const h=await this[d](this.extend(r,i)),u=this.safeValue(h,"data",{}),l=this.safeValue(u,"list",[]);return this.parseOrders(l,n,t,s)}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({orderStatus:"2"},i))}async fetchCanceledOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({orderStatus:"3"},i))}async fetchOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a;const n=this.safeString2(this.options,"fetchOrders","defaultType","spot");let o,c=this.safeString(i,"type",n);i=this.omit(i,"type"),void 0!==e&&(o=this.market(e),r.symbol=o.id,c=o.type),"spot"===c?a="privateGetSpotOrders":"futures"===c&&(a="privateGetFuturesOrders");const d=this.safeString2(i,"clOrdID","clientOrderId");void 0!==d&&(r.clOrdID=d,i=this.omit(i,["clOrdID","clientOrderId"])),void 0!==s&&(r.pageSize=s),void 0!==t&&(r.startDate=this.ymd(t));const h=await this[a](this.extend(r,i)),u=this.safeValue(h,"data",{}),l=this.safeValue(u,"list",[]);return this.parseOrders(l,o,t,s)}parseOrderStatus(e){return this.safeString({0:"open",1:"open",2:"open",3:"closed",4:"canceled",5:"canceled",6:"rejected",10:"expired",11:"rejected"},e,e)}parseOrderType(e){return this.safeString({1:"market",2:"limit",3:"stop",4:"stop-limit",7:"stop-loss",8:"take-profit"},e,e)}parseTimeInForce(e){return this.safeString({1:"GTC",3:"IOC",4:"FOK"},e,e)}parseOrder(e,t){let s=this.safeValue(e,"createTime");"string"==typeof s&&(s=this.parse8601(s));const i=this.parseOrderStatus(this.safeString(e,"orderStatus")),r=this.parseOrderType(this.safeString(e,"orderType"));let a=this.safeString(e,"side");"1"===a?a="buy":"2"===a&&(a="sell");const n=this.safeString(e,"orderID"),o=this.safeString(e,"clOrdID"),c=this.safeString(e,"symbol"),d=(t=this.safeMarket(c,t)).symbol,h=this.safeNumber(e,"price"),u=this.safeNumber(e,"stopPrice"),l=this.parseTimeInForce(this.safeString(e,"timeInForce")),f="Post-Only"===this.safeString(e,"execInst"),p=this.safeNumber(e,"avgPrice"),m=this.safeNumber(e,"orderQty"),b=this.safeNumber(e,"cumQty");let g=this.safeNumber(e,"leavesQty");0===b&&0===g&&(g=void 0);let y,v=this.safeValue(e,"transactTime");"string"==typeof v&&(v=this.parse8601(v));const w=this.safeNumber(e,"commission");if(void 0!==w){let e;void 0!==t&&("buy"===a?e=t.base:"sell"===a&&(e=t.quote)),y={currency:e,cost:w}}return this.safeOrder({id:n,info:e,clientOrderId:o,timestamp:s,datetime:this.iso8601(s),lastTradeTimestamp:v,status:i,symbol:d,type:r,timeInForce:l,postOnly:f,side:a,price:h,stopPrice:u,average:p,amount:m,filled:b,remaining:g,cost:void 0,trades:void 0,fee:y})}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={};let a;const n=this.safeString2(this.options,"fetchMyTrades","defaultType","spot");let o,c=this.safeString(i,"type",n);i=this.omit(i,"type"),void 0!==e&&(o=this.market(e),r.symbol=o.id,c=o.type),"spot"===c?a="privateGetSpotTrades":"futures"===c&&(a="privateGetFuturesTrades"),void 0!==s&&(r.pageSize=s),void 0!==t&&(r.startDate=this.ymd(t));const d=await this[a](this.extend(r,i)),h=this.safeValue(d,"data",{}),u=this.safeValue(h,"list",[]);return this.parseTrades(u,o,t,s)}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e),i={currency:s.id},r=await this.privateGetAccountDepositAddress(this.extend(i,t)),a=this.safeValue(r,"data",{});return this.parseDepositAddress(a,s)}parseDepositAddress(e,t){const s=this.safeString(e,"address"),i=this.safeString(e,"tag"),r=this.safeString(e,"currency");return{info:e,code:this.safeCurrencyCode(r),address:s,tag:i}}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n="/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if("v1"===t)Object.keys(o).length&&(n+="?"+this.urlencode(o));else if(n="/"+this.version+n,"public"===t)Object.keys(o).length&&(n+="?"+this.urlencode(o));else if("private"===t){this.checkRequiredCredentials();const e=this.nonce().toString();r={"X-ACCESS-KEY":this.apiKey,"X-ACCESS-NONCE":e};let t=e+":"+s;"GET"===s?(Object.keys(o).length&&(n+="?"+this.urlencode(o)),t+=n):(r["Content-Type"]="application/json",t+=n+(a=this.json(o)));const i=this.hmac(this.encode(t),this.encode(this.secret));r["X-ACCESS-SIGN"]=i}return n=this.implodeParams(this.urls.api[t],{hostname:this.hostname})+n,{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,a,n,o,c){if(void 0===n)return;const d=this.safeString(n,"code");if(void 0!==d&&"1"!==d){const e=this.id+" "+this.json(n);this.throwExactlyMatchedException(this.exceptions.exact,d,e),this.throwBroadlyMatchedException(this.exceptions.broad,a,e)}}}},1272:(e,t,s)=>{"use strict";const i=s(8819),{ArgumentsRequired:r,ExchangeError:a,BadSymbol:n,InvalidOrder:o,PermissionDenied:c,InvalidAddress:d,AuthenticationError:h,InvalidNonce:u,BadRequest:l,InsufficientFunds:f,OrderNotFound:p}=s(3449),{TRUNCATE:m}=s(2115),b=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"aofex",name:"AOFEX",countries:["GB"],rateLimit:1e3,hostname:"openapi.aofex.com",has:{fetchMarkets:!0,fetchCurrencies:!1,fetchOrderBook:!0,fetchTrades:!0,fetchTicker:!0,fetchTickers:!0,fetchOHLCV:!0,fetchBalance:!0,createOrder:!0,cancelOrder:!0,cancelAllOrders:!0,fetchOpenOrders:!0,fetchClosedOrders:!0,fetchClosedOrder:!0,fetchOrderTrades:!0,fetchTradingFee:!0},timeframes:{"1m":"1min","5m":"5min","15m":"15min","30m":"30min","1h":"1hour","6h":"6hour","12h":"12hour","1d":"1day","1w":"1week"},urls:{logo:"https://user-images.githubusercontent.com/51840849/77670271-056d1080-6f97-11ea-9ac2-4268e9ed0c1f.jpg",api:{public:"https://{hostname}/openApi",private:"https://{hostname}/openApi"},www:"https://aofex.com",doc:"https://aofex.zendesk.com/hc/en-us/sections/360005576574-API",fees:"https://aofex.zendesk.com/hc/en-us/articles/360025814934-Fees-on-AOFEX",referral:"https://aofex.com/#/register?key=9763840"},api:{public:{get:["market/symbols","market/trade","market/depth","market/kline","market/precision","market/24kline","market/gears_depth","market/detail"]},private:{get:["entrust/currentList","entrust/historyList","entrust/rate","wallet/list","entrust/detail"],post:["entrust/add","entrust/cancel"]}},fees:{trading:{maker:.0019,taker:.002}},exceptions:{exact:{20001:a,20401:c,20500:a,20501:n,20502:a,20503:a,20504:f,20505:l,20506:h,20507:a,20508:d,20509:f,20510:o,20511:o,20512:o,20513:o,20514:o,20515:o,20516:o,20517:o,50518:o,20519:u,20520:u,20521:l,20522:a,20523:h,20524:c,20525:h,20526:c,20527:c,20528:c,20529:h,20530:c},broad:{}},options:{fetchBalance:{show_all:"0"}},commonCurrencies:{CPC:"Consensus Planet Coin"}})}async fetchMarkets(e={}){let t=await this.publicGetMarketSymbols(e),s=await this.publicGetMarketPrecision();s=this.safeValue(s,"result",{}),t=this.safeValue(t,"result",[]);const i=[];for(let e=0;e<t.length;e++){const r=t[e],a=this.safeString(r,"symbol"),n=this.safeString(r,"base_currency"),o=this.safeString(r,"quote_currency"),c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o),h=c+"/"+d,u=this.safeInteger(r,"id"),l=this.safeValue(s,a,{}),f=this.safeString(r,"maker_fee"),p=this.safeString(r,"taker_fee"),m=this.parseNumber(b.stringDiv(f,"1000")),g=this.parseNumber(b.stringDiv(p,"1000"));i.push({id:a,numericId:u,symbol:h,baseId:n,quoteId:o,base:c,quote:d,active:void 0,maker:m,taker:g,precision:{amount:this.safeInteger(l,"amount"),price:this.safeInteger(l,"price")},limits:{amount:{min:this.safeNumber(r,"min_size"),max:this.safeNumber(r,"max_size")},price:{min:this.safeNumber(r,"min_price"),max:this.safeNumber(r,"max_price")},cost:{min:void 0,max:void 0}},info:r})}return i}parseOHLCV(e,t){return[this.safeTimestamp(e,"id"),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"amount")]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e);void 0===i&&(i=150);const n={symbol:a.id,period:this.timeframes[t],size:i},o=await this.publicGetMarketKline(this.extend(n,r)),c=this.safeValue(o,"result",{}),d=this.safeValue(c,"data",[]);return this.parseOHLCVs(d,a,s,i)}async fetchBalance(e={}){await this.loadMarkets();const t=this.safeValue(this.options,"fetchBalance",{}),s={show_all:this.safeValue(t,"show_all","0")},i=await this.privateGetWalletList(this.extend(s,e)),r={info:i,timestamp:void 0,datetime:void 0},a=this.safeValue(i,"result",[]);for(let e=0;e<a.length;e++){const t=a[e],s=this.safeString(t,"currency"),i=this.safeCurrencyCode(s),n=this.account();n.free=this.safeString(t,"available"),n.used=this.safeString(t,"frozen"),r[i]=n}return this.parseBalance(r,!1)}async fetchTradingFee(e,t={}){await this.loadMarkets();const s={symbol:this.market(e).id},i=await this.privateGetEntrustRate(this.extend(s,t)),r=this.safeValue(i,"result",{});return{info:i,symbol:e,maker:this.safeNumber(r,"fromFee"),taker:this.safeNumber(r,"toFee")}}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.marketId(e)},r=await this.publicGetMarketDepth(this.extend(i,s)),a=this.safeValue(r,"result",{}),n=this.safeInteger(a,"ts");return this.parseOrderBook(a,e,n)}parseTicker(e,t){const s=this.safeTimestamp(e,"id");let i;t&&(i=t.symbol);const r=this.safeNumber(e,"open"),a=this.safeNumber(e,"close");let n;n=void 0!==i?parseFloat(this.priceToPrecision(i,a-r)):a-r;const o=this.sum(a,r)/2,c=n/r*100,d=this.safeNumber(e,"amount"),h=this.safeNumber(e,"vol");let u=this.vwap(d,h);return void 0!==u&&(u=parseFloat(this.priceToPrecision(i,u))),{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:void 0,bidVolume:void 0,ask:void 0,askVolume:void 0,vwap:u,open:r,close:a,last:a,previousClose:void 0,change:n,percentage:c,average:o,baseVolume:d,quoteVolume:h,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s={};if(void 0!==e){const t=this.marketIds(e);s.symbol=t.join(",")}const i=await this.publicGetMarket24kline(this.extend(s,t)),r=this.safeValue(i,"result",[]),a={};for(let e=0;e<r.length;e++){const t=this.safeString(r[e],"symbol"),s=this.safeMarket(t,void 0,"-"),i=s.symbol,n=this.safeValue(r[e],"data",{});a[i]=this.parseTicker(n,s)}return this.filterByArray(a,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.publicGetMarketDetail(this.extend(i,t)),a=this.safeValue(r,"result",{});return this.parseTicker(a,s)}parseTrade(e,t){const s=this.safeString(e,"id"),i=this.parse8601(this.safeString(e,"ctime")),r=this.safeTimestamp(e,"ts",i)-288e5;let a;void 0===a&&void 0!==t&&(a=t.symbol);const n=this.safeString(e,"direction"),o=this.safeString(e,"price"),c=this.safeString2(e,"amount","number"),d=this.parseNumber(o),h=this.parseNumber(c);let u=this.safeNumber(e,"total_price");void 0===u&&(u=this.parseNumber(b.stringMul(o,c)));const l=this.safeNumber(e,"fee");let f;if(void 0!==l){let e;void 0!==t&&("buy"===n?e=t.base:"sell"===n&&(e=t.quote)),f={cost:l,currency:e}}return{id:s,info:e,timestamp:r,datetime:this.iso8601(r),symbol:a,order:void 0,type:void 0,side:n,takerOrMaker:void 0,price:d,amount:h,cost:u,fee:f}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id},n=await this.publicGetMarketTrade(this.extend(a,i)),o=this.safeValue(n,"result",{}),c=this.safeValue(o,"data",[]);return this.parseTrades(c,r,t,s)}parseOrderStatus(e){return this.safeString({1:"open",2:"open",3:"closed",4:"canceled",5:"canceled",6:"canceled"},e,e)}parseOrder(e,t){const s=this.safeString(e,"order_sn"),i=this.safeString(e,"status"),r=this.parseOrderStatus(i),a=this.safeString(e,"symbol");t=this.safeMarket(a,t,"-");let n=this.parse8601(this.safeString(e,"ctime"));void 0!==n&&(n-=288e5);const o="2"===this.safeString(e,"type")?"limit":"market",c=this.safeString(e,"side");let d,h,u,l;const f=this.safeNumber(e,"number"),p=this.safeNumber(e,"total_price");"limit"===o?(u=f,h=this.safeNumber(e,"price")):(l=this.safeNumber(e,"deal_price"),u="buy"===c?this.safeNumber(e,"deal_number"):f);const m=this.safeValue(e,"trades",[]);for(let e=0;e<m.length;e++)m[e].direction=c;const b=this.parseTrades(m,t,void 0,void 0,{symbol:t.symbol,order:s,type:o});let g;return"limit"===o?d=p:"buy"===c&&(d=f),"limit"===o&&"3"===i&&(g=u),this.safeOrder({info:e,id:s,clientOrderId:void 0,timestamp:n,datetime:this.iso8601(n),lastTradeTimestamp:void 0,status:r,symbol:t.symbol,type:o,timeInForce:void 0,postOnly:void 0,side:c,price:h,stopPrice:void 0,cost:d,average:l,amount:u,filled:g,remaining:void 0,trades:b,fee:void 0})}async fetchClosedOrder(e,t,s={}){await this.loadMarkets();const i={order_sn:e},r=await this.privateGetEntrustDetail(this.extend(i,s)),a=this.safeValue(r,"result",{}),n=this.safeValue(a,"trades",[]),o=this.safeValue(a,"entrust",{});return o.trades=n,this.parseOrder(o)}async fetchOrderTrades(e,t,s,i,r={}){const a=await this.fetchClosedOrder(e,t,r);return this.safeValue(a,"trades",[])}async fetchOrdersWithMethod(e,t,s,i,r={}){await this.loadMarkets();const a={direct:"prev"};let n;void 0!==t&&(n=this.market(t),a.symbol=n.id),void 0!==i&&(a.limit=i);const o=await this[e](this.extend(a,r)),c=this.safeValue(o,"result",[]);return this.parseOrders(c,n,s,i)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrdersWithMethod("privateGetEntrustCurrentList",e,t,s,i)}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrdersWithMethod("privateGetEntrustHistoryList",e,t,s,i)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),c=s+"-"+t,d={symbol:n.id,type:c};if("limit"===t)d.amount=this.amountToPrecision(e,i),d.price=this.priceToPrecision(e,r);else if("market"===t)if("buy"===s){let e=i;if(this.safeValue(this.options,"createMarketBuyOrderRequiresPrice",!0)){if(void 0===r)throw new o(this.id+" createOrder() requires the price argument with market buy orders to calculate total order cost (amount to spend), where cost = amount * price. Supply a price argument to createOrder() call if you want the cost to be calculated for you from price and amount, or, alternatively, add .options['createMarketBuyOrderRequiresPrice'] = false and supply the total cost value in the 'amount' argument");e=i*r}const t=n.precision.price;d.amount=this.decimalToPrecision(e,m,t,this.precisionMode)}else d.amount=this.amountToPrecision(e,i);const h=await this.privatePostEntrustAdd(this.extend(d,a)),u=this.safeValue(h,"result",{}),l=this.parseOrder(u,n),f=this.milliseconds();return this.extend(l,{timestamp:f,datetime:this.iso8601(f),amount:i,price:r,type:t,side:s})}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={order_ids:e},r=await this.privatePostEntrustCancel(this.extend(i,s)),a=this.safeValue(r,"result",{}),n=this.safeValue(a,"success",[]);if(!this.inArray(e,n))throw new p(this.id+" order id "+e+" not found in successfully canceled orders: "+this.json(r));const o=void 0;return{info:r,id:e,timestamp:o,datetime:this.iso8601(o),lastTradeTimestamp:void 0,status:"canceled",symbol:t,type:void 0,side:void 0,price:void 0,cost:void 0,average:void 0,amount:void 0,filled:void 0,remaining:void 0,trades:void 0,fee:void 0,clientOrderId:void 0}}async cancelAllOrders(e,t={}){if(void 0===e)throw new r(this.id+" cancelAllOrders() requires a symbol argument");await this.loadMarkets();const s={symbol:this.market(e).id};return await this.privatePostEntrustCancel(this.extend(s,t))}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n=this.implodeParams(this.urls.api[t],{hostname:this.hostname})+"/"+e,o=Object.keys(i);const c=o.length;if("public"===t)c>0&&(n+="?"+this.urlencode(i));else{const e=this.nonce().toString()+"_"+this.uuid().slice(0,5),t={};t[this.apiKey]=this.apiKey,t[this.secret]=this.secret,t[e]=e;for(let e=0;e<c;e++){const s=o[e];t[s]=s+"="+i[s]}const d=this.keysort(t);let h="";o=Object.keys(d);for(let e=0;e<o.length;e++){h+=d[o[e]]}const u=this.hash(this.encode(h),"sha1");r={Nonce:e,Token:this.apiKey,Signature:u},"POST"===s?(r["Content-Type"]="application/x-www-form-urlencoded",c>0&&(a=this.urlencode(i))):c>0&&(n+="?"+this.urlencode(i))}return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,n,o,c,d){if(void 0===o)return;const h=this.safeString(o,"errno");if(void 0!==h&&"0"!==h){const e=this.safeString(o,"errmsg"),t=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,h,t),this.throwBroadlyMatchedException(this.exceptions.broad,e,t),new a(t)}}}},2300:(e,t,s)=>{"use strict";const i=s(8819),{ArgumentsRequired:r,AuthenticationError:a,ExchangeError:n,InsufficientFunds:o,InvalidOrder:c,BadSymbol:d,PermissionDenied:h,BadRequest:u}=s(3449),{TICK_SIZE:l}=s(2115),f=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"ascendex",name:"AscendEX",countries:["SG","CN"],rateLimit:500,has:{CORS:!1,fetchMarkets:!0,fetchCurrencies:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchOHLCV:!0,fetchTrades:!0,fetchAccounts:!0,fetchBalance:!0,createOrder:!0,cancelOrder:!0,cancelAllOrders:!0,fetchDepositAddress:!0,fetchTransactions:!0,fetchDeposits:!0,fetchWithdrawals:!0,fetchOrder:!0,fetchOrders:!0,fetchOpenOrders:!0,fetchClosedOrders:!0},timeframes:{"1m":"1","5m":"5","15m":"15","30m":"30","1h":"60","2h":"120","4h":"240","6h":"360","12h":"720","1d":"1d","1w":"1w","1M":"1m"},version:"v1",urls:{logo:"https://user-images.githubusercontent.com/1294454/112027508-47984600-8b48-11eb-9e17-d26459cc36c6.jpg",api:"https://ascendex.com",test:"https://bitmax-test.io",www:"https://ascendex.com",doc:["https://bitmax-exchange.github.io/bitmax-pro-api/#bitmax-pro-api-documentation"],fees:"https://ascendex.com/en/feerate/transactionfee-traderate",referral:"https://bitmax.io/#/register?inviteCode=EL6BXBQM"},api:{public:{get:["assets","products","ticker","barhist/info","barhist","depth","trades","cash/assets","cash/products","margin/assets","margin/products","futures/collateral","futures/contracts","futures/ref-px","futures/market-data","futures/funding-rates"]},accountCategory:{get:["balance","order/open","order/status","order/hist/current","risk"],post:["order","order/batch"],delete:["order","order/all","order/batch"]},accountGroup:{get:["cash/balance","margin/balance","margin/risk","transfer","futures/collateral-balance","futures/position","futures/risk","futures/funding-payments","order/hist"],post:["futures/transfer/deposit","futures/transfer/withdraw"]},private:{get:["info","wallet/transactions","wallet/deposit/address"]}},fees:{trading:{feeSide:"get",tierBased:!0,percentage:!0,taker:.002,maker:.002}},precisionMode:l,options:{"account-category":"cash","account-group":void 0,fetchClosedOrders:{method:"accountGroupGetOrderHist"}},exceptions:{exact:{1900:u,2100:a,5002:d,6001:d,6010:o,60060:c,600503:c,100001:u,100002:u,100003:u,100004:u,100005:u,100006:u,100007:u,100008:d,100009:a,100010:u,100011:u,100012:u,100013:u,100101:n,150001:u,200001:a,200002:n,200003:n,200004:n,200005:n,200006:n,200007:n,200008:n,200009:n,200010:a,200011:n,200012:n,200013:n,200014:h,200015:h,300001:c,300002:c,300003:c,300004:c,300005:c,300006:c,300007:c,300008:c,300009:c,300011:o,300012:d,300013:c,300020:c,300021:c,300031:c,310001:o,310002:c,310003:c,310004:d,310005:c,510001:n,900001:n},broad:{}},commonCurrencies:{BOND:"BONDED",BTCBEAR:"BEAR",BTCBULL:"BULL",BYN:"Beyond Finance"}})}getAccount(e={}){return this.safeValue(e,"account",this.options.account).toLowerCase().capitalize()}async fetchCurrencies(e={}){const t=await this.publicGetAssets(e),s=await this.publicGetMarginAssets(e),i=await this.publicGetCashAssets(e),r=this.safeValue(t,"data",[]),a=this.safeValue(s,"data",[]),n=this.safeValue(i,"data",[]),o=this.indexBy(r,"assetCode"),c=this.indexBy(a,"assetCode"),d=this.indexBy(n,"assetCode"),h=this.deepExtend(o,c,d),u=Object.keys(h),l={};for(let e=0;e<u.length;e++){const t=u[e],s=h[t],i=this.safeCurrencyCode(t),r=this.safeInteger2(s,"precisionScale","nativeScale"),a=this.safeNumber2(s,"withdrawFee","withdrawalFee"),n="Normal"===this.safeString2(s,"status","statusCode"),o="borrowAssetCode"in s;l[i]={id:t,code:i,info:s,type:void 0,margin:o,name:this.safeString(s,"assetName"),active:n,fee:a,precision:r,limits:{amount:{min:Math.pow(10,-r),max:void 0},withdraw:{min:this.safeNumber(s,"minWithdrawalAmt"),max:void 0}}}}return l}async fetchMarkets(e={}){const t=await this.publicGetProducts(e),s=await this.publicGetCashProducts(e),i=await this.publicGetFuturesContracts(e),r=this.safeValue(t,"data",[]),a=this.indexBy(r,"symbol"),n=this.safeValue(s,"data",[]),o=this.safeValue(i,"data",[]),c=this.arrayConcat(n,o),d=this.indexBy(c,"symbol"),h=this.deepExtend(a,d),u=Object.keys(h),l=[];for(let e=0;e<u.length;e++){const t=u[e],s=h[t],i=this.safeString(s,"baseAsset"),r=this.safeString(s,"quoteAsset"),a=this.safeCurrencyCode(i),n=this.safeCurrencyCode(r),o={amount:this.safeNumber(s,"lotSize"),price:this.safeNumber(s,"tickSize")},c="Normal"===this.safeString(s,"status"),d="useLot"in s?"spot":"future",f="spot"===d,p="future"===d,m=this.safeValue(s,"marginTradable",!1);let b=t;p||(b=a+"/"+n);const g=this.safeNumber(s,"commissionReserveRate");l.push({id:t,symbol:b,base:a,quote:n,baseId:i,quoteId:r,info:s,type:d,spot:f,margin:m,future:p,active:c,precision:o,taker:g,maker:g,limits:{amount:{min:this.safeNumber(s,"minQty"),max:this.safeNumber(s,"maxQty")},price:{min:this.safeNumber(s,"tickSize"),max:void 0},cost:{min:this.safeNumber(s,"minNotional"),max:this.safeNumber(s,"maxNotional")}}})}return l}async fetchAccounts(e={}){let t,s=this.safeString(this.options,"account-group");if(void 0===s){t=await this.privateGetInfo(e);const i=this.safeValue(t,"data",{});s=this.safeString(i,"accountGroup"),this.options["account-group"]=s}return[{id:s,type:void 0,currency:void 0,info:t}]}async fetchBalance(e={}){await this.loadMarkets(),await this.loadAccounts();const t=this.safeString(this.options,"account-category","cash"),s=this.safeValue(this.options,"fetchBalance",{});let i=this.safeString(s,"account-category",t);i=this.safeString(e,"account-category",i),e=this.omit(e,"account-category");const r=this.safeValue(this.accounts,0,{}),a={"account-group":this.safeString(r,"id")};let n="accountCategoryGetBalance";"futures"===i?n="accountGroupGetFuturesCollateralBalance":a["account-category"]=i;const o=await this[n](this.extend(a,e)),c={info:o,timestamp:void 0,datetime:void 0},d=this.safeValue(o,"data",[]);for(let e=0;e<d.length;e++){const t=d[e],s=this.safeCurrencyCode(this.safeString(t,"asset")),i=this.account();i.free=this.safeString(t,"availableBalance"),i.total=this.safeString(t,"totalBalance"),c[s]=i}return this.parseBalance(c,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.market(e).id},r=await this.publicGetDepth(this.extend(i,s)),a=this.safeValue(r,"data",{}),n=this.safeValue(a,"data",{}),o=this.safeInteger(n,"ts"),c=this.parseOrderBook(n,e,o);return c.nonce=this.safeInteger(n,"seqnum"),c}parseTicker(e,t){const s=void 0,i=this.safeString(e,"symbol");let r;if(i in this.markets_by_id)t=this.markets_by_id[i];else if(void 0!==i){if("spot"===this.safeString(e,"type")){const[e,t]=i.split("/");r=this.safeCurrencyCode(e)+"/"+this.safeCurrencyCode(t)}}void 0===r&&void 0!==t&&(r=t.symbol);const a=this.safeNumber(e,"close"),n=this.safeValue(e,"bid",[]),o=this.safeValue(e,"ask",[]),c=this.safeNumber(e,"open");let d,h,u;return void 0!==c&&void 0!==a&&(d=a-c,c>0&&(h=d/c*100),u=this.sum(c,a)/2),{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(n,0),bidVolume:this.safeNumber(n,1),ask:this.safeNumber(o,0),askVolume:this.safeNumber(o,1),vwap:void 0,open:c,close:a,last:a,previousClose:void 0,change:d,percentage:h,average:u,baseVolume:this.safeNumber(e,"volume"),quoteVolume:void 0,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.publicGetTicker(this.extend(i,t)),a=this.safeValue(r,"data",{});return this.parseTicker(a,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s={};if(void 0!==e){const t=this.marketIds(e);s.symbol=t.join(",")}const i=await this.publicGetTicker(this.extend(s,t)),r=this.safeValue(i,"data",[]);return this.parseTickers(r,e)}parseOHLCV(e,t){const s=this.safeValue(e,"data",{});return[this.safeInteger(s,"ts"),this.safeNumber(s,"o"),this.safeNumber(s,"h"),this.safeNumber(s,"l"),this.safeNumber(s,"c"),this.safeNumber(s,"v")]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={symbol:a.id,interval:this.timeframes[t]},o=this.parseTimeframe(t),c=this.safeValue(this.options,"fetchOHLCV",{}),d=this.safeInteger(c,"limit",500);void 0!==s?(n.from=s,i=void 0===i?d:Math.min(i,d),n.to=this.sum(s,i*o*1e3,1)):void 0!==i&&(n.n=i);const h=await this.publicGetBarhist(this.extend(n,r)),u=this.safeValue(h,"data",[]);return this.parseOHLCVs(u,a,t,s,i)}parseTrade(e,t){const s=this.safeInteger(e,"ts"),i=this.safeString2(e,"price","p"),r=this.safeString(e,"q"),a=this.parseNumber(i),n=this.parseNumber(r),o=this.parseNumber(f.stringMul(i,r)),c=this.safeValue(e,"bm",!1),d=c?"maker":"taker",h=c?"buy":"sell";let u;return void 0===u&&void 0!==t&&(u=t.symbol),{info:e,timestamp:s,datetime:this.iso8601(s),symbol:u,id:void 0,order:void 0,type:void 0,takerOrMaker:d,side:h,price:a,amount:n,cost:o,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id};void 0!==s&&(a.n=s);const n=await this.publicGetTrades(this.extend(a,i)),o=this.safeValue(n,"data",[]),c=this.safeValue(o,"data",[]);return this.parseTrades(c,r,t,s)}parseOrderStatus(e){return this.safeString({PendingNew:"open",New:"open",PartiallyFilled:"open",Filled:"closed",Canceled:"canceled",Rejected:"rejected"},e,e)}parseOrder(e,t){const s=this.parseOrderStatus(this.safeString(e,"status")),i=this.safeString(e,"symbol"),r=this.safeSymbol(i,t,"/"),a=this.safeInteger2(e,"timestamp","sendingTime"),n=this.safeInteger(e,"lastExecTime"),o=this.safeNumber(e,"price"),c=this.safeNumber(e,"orderQty"),d=this.safeNumber(e,"avgPx"),h=this.safeNumber2(e,"cumFilledQty","cumQty"),u=this.safeString(e,"orderId");let l=this.safeString(e,"id");void 0!==l&&l.length<1&&(l=void 0);const f=this.safeStringLower(e,"orderType"),p=this.safeStringLower(e,"side"),m=this.safeNumber(e,"cumFee");let b;if(void 0!==m){const t=this.safeString(e,"feeAsset");b={cost:m,currency:this.safeCurrencyCode(t)}}const g=this.safeNumber(e,"stopPrice");return this.safeOrder({info:e,id:u,clientOrderId:void 0,timestamp:a,datetime:this.iso8601(a),lastTradeTimestamp:n,symbol:r,type:f,timeInForce:void 0,postOnly:void 0,side:p,price:o,stopPrice:g,amount:c,cost:void 0,average:d,filled:h,remaining:void 0,status:s,fee:b,trades:void 0})}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets(),await this.loadAccounts();const n=this.market(e),o=this.safeString(this.options,"account-category","cash"),d=this.safeValue(this.options,"createOrder",{});let h=this.safeString(d,"account-category",o);h=this.safeString(a,"account-category",h),a=this.omit(a,"account-category");const u=this.safeValue(this.accounts,0,{}),l=this.safeValue(u,"id"),f=this.safeString2(a,"clientOrderId","id"),p={"account-group":l,"account-category":h,symbol:n.id,time:this.milliseconds(),orderQty:this.amountToPrecision(e,i),orderType:t,side:s};if(void 0!==f&&(p.id=f,a=this.omit(a,["clientOrderId","id"])),"limit"!==t&&"stop_limit"!==t||(p.orderPrice=this.priceToPrecision(e,r)),"stop_limit"===t||"stop_market"===t){const s=this.safeNumber(a,"stopPrice");if(void 0===s)throw new c(this.id+" createOrder() requires a stopPrice parameter for "+t+" orders");p.stopPrice=this.priceToPrecision(e,s),a=this.omit(a,"stopPrice")}const m=await this.accountCategoryPostOrder(this.extend(p,a)),b=this.safeValue(m,"data",{}),g=this.safeValue(b,"info",{});return this.parseOrder(g,n)}async fetchOrder(e,t,s={}){await this.loadMarkets(),await this.loadAccounts();const i=this.safeString(this.options,"account-category","cash"),r=this.safeValue(this.options,"fetchOrder",{});let a=this.safeString(r,"account-category",i);a=this.safeString(s,"account-category",a),s=this.omit(s,"account-category");const n=this.safeValue(this.accounts,0,{}),o={"account-group":this.safeValue(n,"id"),"account-category":a,orderId:e},c=await this.accountCategoryGetOrderStatus(this.extend(o,s)),d=this.safeValue(c,"data",{});return this.parseOrder(d)}async fetchOpenOrders(e,t,s,i={}){let r;await this.loadMarkets(),await this.loadAccounts(),void 0!==e&&(r=this.market(e));const a=this.safeString(this.options,"account-category","cash"),n=this.safeValue(this.options,"fetchOpenOrders",{});let o=this.safeString(n,"account-category",a);o=this.safeString(i,"account-category",o),i=this.omit(i,"account-category");const c=this.safeValue(this.accounts,0,{}),d={"account-group":this.safeValue(c,"id"),"account-category":o},h=await this.accountCategoryGetOrderOpen(this.extend(d,i)),u=this.safeValue(h,"data",[]);if("futures"===o)return this.parseOrders(u,r,t,s);const l=[];for(let e=0;e<u.length;e++){const t=this.parseOrder(u[e],r);l.push(t)}return this.filterBySymbolSinceLimit(l,e,t,s)}async fetchClosedOrders(e,t,s,i={}){let r;await this.loadMarkets(),await this.loadAccounts(),void 0!==e&&(r=this.market(e));const a=this.safeString(this.options,"account-category"),n=this.safeValue(this.options,"fetchClosedOrders",{});let o=this.safeString(n,"account-category",a);o=this.safeString(i,"account-category",o),i=this.omit(i,"account-category");const c=this.safeValue(this.accounts,0,{}),d={"account-group":this.safeValue(c,"id")};void 0!==e&&(r=this.market(e),d.symbol=r.id);const h=this.safeValue(n,"method","accountGroupGetOrderHist");"accountGroupGetOrderHist"===h?void 0!==o&&(d.category=o):d["account-category"]=o,void 0!==t&&(d.startTime=t),void 0!==s&&(d.pageSize=s);const u=await this[h](this.extend(d,i));let l=this.safeValue(u,"data");return Array.isArray(l)||(l=this.safeValue(l,"data",[])),this.parseOrders(l,r,t,s)}async cancelOrder(e,t,s={}){if(void 0===t)throw new r(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets(),await this.loadAccounts();const i=this.market(t),a=this.safeString(this.options,"account-category","cash"),n=this.safeValue(this.options,"cancelOrder",{});let o=this.safeString(n,"account-category",a);o=this.safeString(s,"account-category",o),s=this.omit(s,"account-category");const c=this.safeValue(this.accounts,0,{}),d=this.safeValue(c,"id"),h=this.safeString2(s,"clientOrderId","id"),u={"account-group":d,"account-category":o,symbol:i.id,time:this.milliseconds(),id:"foobar"};void 0===h?u.orderId=e:(u.id=h,s=this.omit(s,["clientOrderId","id"]));const l=await this.accountCategoryDeleteOrder(this.extend(u,s)),f=this.safeValue(l,"data",{}),p=this.safeValue(f,"info",{});return this.parseOrder(p,i)}async cancelAllOrders(e,t={}){await this.loadMarkets(),await this.loadAccounts();const s=this.safeString(this.options,"account-category","cash"),i=this.safeValue(this.options,"cancelAllOrders",{});let r=this.safeString(i,"account-category",s);r=this.safeString(t,"account-category",r),t=this.omit(t,"account-category");const a=this.safeValue(this.accounts,0,{}),n={"account-group":this.safeValue(a,"id"),"account-category":r,time:this.milliseconds()};let o;void 0!==e&&(o=this.market(e),n.symbol=o.id);return await this.accountCategoryDeleteOrderAll(this.extend(n,t))}parseDepositAddress(e,t){const s=this.safeString(e,"address"),i=this.safeString(e,"tagId"),r=this.safeString(e,i);this.checkAddress(s);return{currency:void 0===t?void 0:t.code,address:s,tag:r,info:e}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e),i=this.safeString(t,"chainName");t=this.omit(t,"chainName");const a={asset:s.id},n=await this.privateGetWalletDepositAddress(this.extend(a,t)),o=this.safeValue(n,"data",{}),c=this.safeValue(o,"address",[]);let d;if(c.length>1){const e=this.indexBy(c,"chainName");if(void 0===i){const t=Object.keys(e).join(", ");throw new r(this.id+" fetchDepositAddress returned more than one address, a chainName parameter is required, one of "+t)}d=this.safeValue(e,i,{})}else d=this.safeValue(c,0,{});const h=this.parseDepositAddress(d,s);return this.extend(h,{info:n})}async fetchDeposits(e,t,s,i={}){return await this.fetchTransactions(e,t,s,this.extend({txType:"deposit"},i))}async fetchWithdrawals(e,t,s,i={}){return await this.fetchTransactions(e,t,s,this.extend({txType:"withdrawal"},i))}async fetchTransactions(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.asset=a.id),void 0!==t&&(r.startTs=t),void 0!==s&&(r.pageSize=s);const n=await this.privateGetWalletTransactions(this.extend(r,i)),o=this.safeValue(n,"data",{}),c=this.safeValue(o,"data",[]);return this.parseTransactions(c,a,t,s)}parseTransactionStatus(e){return this.safeString({reviewing:"pending",pending:"pending",confirmed:"ok",rejected:"rejected"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"requestId"),i=this.safeNumber(e,"amount"),r=this.safeValue(e,"destAddress",{}),a=this.safeString(r,"address"),n=this.safeString(r,"destTag"),o=this.safeString(e,"networkTransactionId"),c=this.safeString(e,"transactionType"),d=this.safeInteger(e,"time"),h=this.safeString(e,"asset"),u=this.safeCurrencyCode(h,t),l=this.parseTransactionStatus(this.safeString(e,"status")),f=this.safeNumber(e,"commission");return{info:e,id:s,currency:u,amount:i,address:a,addressTo:a,addressFrom:void 0,tag:n,tagTo:n,tagFrom:void 0,status:l,type:c,updated:void 0,txid:o,timestamp:d,datetime:this.iso8601(d),fee:{currency:u,cost:f}}}sign(e,t="public",s="GET",i={},r,a){let n="",o=i;const c="accountCategory"===t;(c||"accountGroup"===t)&&(n+=this.implodeParams("/{account-group}",i),o=this.omit(i,"account-group"));const d=this.implodeParams(e,o);if(n+="/api/pro/"+this.version,c&&(n+=this.implodeParams("/{account-category}",o),o=this.omit(o,"account-category")),n+="/"+d,o=this.omit(o,this.extractParams(e)),"public"===t)Object.keys(o).length&&(n+="?"+this.urlencode(o));else{this.checkRequiredCredentials();const e=this.milliseconds().toString(),t=e+"+"+d,i=this.hmac(this.encode(t),this.encode(this.secret),"sha256","base64");r={"x-auth-key":this.apiKey,"x-auth-timestamp":e,"x-auth-signature":i},"GET"===s?Object.keys(o).length&&(n+="?"+this.urlencode(o)):(r["Content-Type"]="application/json",a=this.json(o))}return n=this.urls.api+n,{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,a,o,c,d){if(void 0===o)return;const h=this.safeString(o,"code"),u=this.safeString(o,"message");if(void 0!==h&&"0"!==h||void 0!==u){const e=this.id+" "+a;throw this.throwExactlyMatchedException(this.exceptions.exact,h,e),this.throwExactlyMatchedException(this.exceptions.exact,u,e),this.throwBroadlyMatchedException(this.exceptions.broad,u,e),new n(e)}}}},8819:(e,t,s)=>{"use strict";const i=s(5806),{isNode:r,keys:a,values:n,deepExtend:o,extend:c,clone:d,flatten:h,unique:u,indexBy:l,sortBy:f,groupBy:p,aggregate:m,uuid:b,unCamelCase:g,precisionFromString:y,throttle:v,capitalize:w,now:k,timeout:S,TimedOut:_,buildOHLCVC:O,decimalToPrecision:T,defaultFetch:x}=i,{ExchangeError:C,BadSymbol:I,InvalidAddress:M,NotSupported:N,AuthenticationError:A,DDoSProtection:E,RequestTimeout:P,ExchangeNotAvailable:B,RateLimitExceeded:V}=s(3449),{TRUNCATE:L,ROUND:q,DECIMAL_PLACES:D,NO_PADDING:R}=i.precisionConstants,G=(s(5060),s(6832));e.exports=class{describe(){return{id:void 0,name:void 0,countries:void 0,enableRateLimit:!0,rateLimit:2e3,certified:!1,pro:!1,has:{loadMarkets:!0,cancelAllOrders:!1,cancelOrder:!0,cancelOrders:!1,CORS:!1,createDepositAddress:!1,createLimitOrder:!0,createMarketOrder:!0,createOrder:!0,deposit:!1,editOrder:"emulated",fetchBalance:!0,fetchBidsAsks:!1,fetchClosedOrders:!1,fetchCurrencies:!1,fetchDepositAddress:!1,fetchDeposits:!1,fetchFundingFees:!1,fetchL2OrderBook:!0,fetchLedger:!1,fetchMarkets:!0,fetchMyTrades:!1,fetchOHLCV:"emulated",fetchOpenOrders:!1,fetchOrder:!1,fetchOrderBook:!0,fetchOrderBooks:!1,fetchOrders:!1,fetchOrderTrades:!1,fetchStatus:"emulated",fetchTicker:!0,fetchTickers:!1,fetchTime:!1,fetchTrades:!0,fetchTradingFee:!1,fetchTradingFees:!1,fetchTradingLimits:!1,fetchTransactions:!1,fetchWithdrawals:!1,privateAPI:!0,publicAPI:!0,signIn:!1,withdraw:!1},urls:{logo:void 0,api:void 0,www:void 0,doc:void 0,fees:void 0},api:void 0,requiredCredentials:{apiKey:!0,secret:!0,uid:!1,login:!1,password:!1,twofa:!1,privateKey:!1,walletAddress:!1,token:!1},markets:void 0,currencies:{},timeframes:void 0,fees:{trading:{tierBased:void 0,percentage:void 0,taker:void 0,maker:void 0},funding:{tierBased:void 0,percentage:void 0,withdraw:{},deposit:{}}},status:{status:"ok",updated:void 0,eta:void 0,url:void 0},exceptions:void 0,httpExceptions:{422:C,418:E,429:V,404:B,409:B,410:B,500:B,501:B,502:B,520:B,521:B,522:B,525:B,526:B,400:B,403:B,405:B,503:B,530:B,408:P,504:P,401:A,511:A},dontGetUsedBalanceFromStaleCache:!1,commonCurrencies:{XBT:"BTC",BCC:"BCH",DRK:"DASH",BCHABC:"BCH",BCHSV:"BSV"},precisionMode:D,paddingMode:R,limits:{amount:{min:void 0,max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}}}}constructor(e={}){Object.assign(this,i),this.options={},this.fetchOptions={},this.userAgents={chrome:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36",chrome39:"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36"},this.headers={},this.proxy="",this.origin="*",this.minFundingAddressLength=1,this.substituteCommonCurrencyCodes=!0,this.quoteJsonNumbers=!0,this.number=Number,this.reduceFees=!0,this.fetchImplementation=x,this.timeout=1e4,this.verbose=!1,this.debug=!1,this.userAgent=void 0,this.twofa=void 0,this.apiKey=void 0,this.secret=void 0,this.uid=void 0,this.login=void 0,this.password=void 0,this.privateKey=void 0,this.walletAddress=void 0,this.token=void 0,this.balance={},this.orderbooks={},this.tickers={},this.orders=void 0,this.trades={},this.transactions={},this.ohlcvs={},this.myTrades=void 0,this.requiresWeb3=!1,this.requiresEddsa=!1,this.precision={},this.enableLastJsonResponse=!0,this.enableLastHttpResponse=!0,this.enableLastResponseHeaders=!0,this.last_http_response=void 0,this.last_json_response=void 0,this.last_response_headers=void 0;const t=(e=this)=>{if(null!==e){const s=Object.getOwnPropertyNames(e);for(let e=0;e<s.length;e++){const t=s[e];this[g(t)]=this[t]}t(Object.getPrototypeOf(e))}};t();const s=Object.entries(this.describe()).concat(Object.entries(e));for(let e=0;e<s.length;e++){const[t,i]=s[e];i&&Object.getPrototypeOf(i)===Object.prototype?this[t]=o(this[t],i):this[t]=i}const a={keepAlive:!0};!this.httpAgent&&x.http&&r&&(this.httpAgent=new x.http.Agent(a)),!this.httpsAgent&&x.https&&r&&(this.httpsAgent=new x.https.Agent(a));const n=Object.keys(this.has);for(let e=0;e<n.length;e++){const t=n[e];this["has"+w(t)]=!!this.has[t]}this.api&&this.defineRestApi(this.api,"request"),this.initRestRateLimiter(),this.markets&&this.setMarkets(this.markets)}defaults(){return{}}nonce(){return this.seconds()}encodeURIComponent(...e){return encodeURIComponent(...e)}checkRequiredCredentials(e=!0){const t=Object.keys(this.requiredCredentials);for(let s=0;s<t.length;s++){const i=t[s];if(this.requiredCredentials[i]&&!this[i]){if(e)throw new A(this.id+" requires `"+i+"` credential");return e}}return!0}checkAddress(e){if(void 0===e)throw new M(this.id+" address is undefined");if(1===u(e).length||e.length<this.minFundingAddressLength||e.includes(" "))throw new M(this.id+" address is invalid or has less than "+this.minFundingAddressLength.toString()+' characters: "'+this.json(e)+'"');return e}initRestRateLimiter(){if(void 0===this.rateLimit)throw new Error(this.id+".rateLimit property is not configured");this.tokenBucket=this.extend({delay:1,capacity:1,defaultCost:1,maxCapacity:1e3},this.tokenBucket),this.throttle=v(this.tokenBucket),this.executeRestRequest=(e,t="GET",s,i)=>{const a=this.fetchImplementation,n={method:t,headers:s,body:i,timeout:this.timeout};this.agent?n.agent=this.agent:this.httpAgent&&0===e.indexOf("http://")?n.agent=this.httpAgent:this.httpsAgent&&0===e.indexOf("https://")&&(n.agent=this.httpsAgent);const o=a(e,this.extend(n,this.fetchOptions)).catch((s=>{if(r)throw new B([this.id,t,e,s.type,s.message].join(" "));throw s})).then((r=>this.handleRestResponse(r,e,t,s,i)));return S(this.timeout,o).catch((s=>{if(s instanceof _)throw new P(this.id+" "+t+" "+e+" request timed out ("+this.timeout+" ms)");throw s}))}}setSandboxMode(e){if(e){if(!("test"in this.urls))throw new N(this.id+" does not have a sandbox URL");"string"==typeof this.urls.api?(this.urls.apiBackup=this.urls.api,this.urls.api=this.urls.test):(this.urls.apiBackup=d(this.urls.api),this.urls.api=d(this.urls.test))}else"apiBackup"in this.urls&&("string"==typeof this.urls.api?this.urls.api=this.urls.apiBackup:this.urls.api=d(this.urls.apiBackup))}defineRestApi(e,t,s=[]){const i=Object.keys(e);for(let r=0;r<i.length;r++){const a=i[r],n=e[a];if(Array.isArray(n)){const e=a.toUpperCase(),i=a.toLowerCase(),r=this.capitalize(i);for(let a=0;a<n.length;a++){const o=n[a].trim(),c=o.split(/[^a-zA-Z0-9]/),d=c.map(this.capitalize).join(""),h=c.map((e=>e.trim().toLowerCase())).filter((e=>e.length>0)).join("_"),u=[s[0]].concat(s.slice(1).map(this.capitalize)).join(""),l=[s[0]].concat(s.slice(1).map((e=>e.trim())).filter((e=>e.length>0))).join("_"),f=u+r+this.capitalize(d),p=l+"_"+i+"_"+h,m=s.length>1?s:s[0],b=async s=>this[t](o,m,e,s||{});this[f]=b,this[p]=b}}else this.defineRestApi(n,t,s.concat([a]))}}print(...e){console.log(...e)}setHeaders(e){return e}fetch(e,t="GET",s,i){return r&&this.userAgent&&("string"==typeof this.userAgent?s=c({"User-Agent":this.userAgent},s):"object"==typeof this.userAgent&&"User-Agent"in this.userAgent&&(s=c(this.userAgent,s))),"function"==typeof this.proxy?(e=this.proxy(e),r&&(s=c({Origin:this.origin},s))):"string"==typeof this.proxy&&(this.proxy.length&&r&&(s=c({Origin:this.origin},s)),e=this.proxy+e),s=c(this.headers,s),s=this.setHeaders(s),this.verbose&&this.print("fetch:\n",this.id,t,e,"\nRequest:\n",s,"\n",i,"\n"),this.executeRestRequest(e,t,s,i)}async fetch2(e,t="public",s="GET",i={},r,a){this.enableRateLimit&&await this.throttle(this.rateLimit);const n=this.sign(e,t,s,i,r,a);return this.fetch(n.url,n.method,n.headers,n.body)}request(e,t="public",s="GET",i={},r,a){return this.fetch2(e,t,s,i,r,a)}parseJson(e){try{if(this.isJsonEncodedObject(e))return JSON.parse(this.onJsonResponse(e))}catch(e){return}}throwExactlyMatchedException(e,t,s){if(t in e)throw new e[t](s)}throwBroadlyMatchedException(e,t,s){const i=this.findBroadlyMatchedKey(e,t);if(void 0!==i)throw new e[i](s)}findBroadlyMatchedKey(e,t){const s=Object.keys(e);for(let e=0;e<s.length;e++){const i=s[e];if(t.indexOf(i)>=0)return i}}handleErrors(e,t,s,i,r,a,n,o,c){}handleHttpStatusCode(e,t,s,i,r){const a=e.toString();if(a in this.httpExceptions){throw new(0,this.httpExceptions[a])([this.id,i,s,e,t,r].join(" "))}}getResponseHeaders(e){const t={};return e.headers.forEach(((e,s)=>{s=s.split("-").map((e=>w(e))).join("-"),t[s]=e})),t}handleRestResponse(e,t,s="GET",i,r){return e.text().then((a=>{const n=this.getResponseHeaders(e),o=this.onRestResponse(e.status,e.statusText,t,s,n,a,i,r),c=this.parseJson(o);return this.enableLastResponseHeaders&&(this.last_response_headers=n),this.enableLastHttpResponse&&(this.last_http_response=a),this.enableLastJsonResponse&&(this.last_json_response=c),this.verbose&&this.print("handleRestResponse:\n",this.id,s,t,e.status,e.statusText,"\nResponse:\n",n,"\n",a,"\n"),this.handleErrors(e.status,e.statusText,t,s,n,a,c,i,r),this.handleHttpStatusCode(e.status,e.statusText,t,s,a),c||a}))}onRestResponse(e,t,s,i,r,a,n,o){return a.trim()}onJsonResponse(e){return this.quoteJsonNumbers?e.replace(/":([+.0-9eE-]+)([,}])/g,'":"$1"$2'):e}setMarkets(e,t){const s=Object.values(e).map((e=>o({limits:this.limits,precision:this.precision},this.fees.trading,e)));if(this.markets=l(s,"symbol"),this.marketsById=l(e,"id"),this.markets_by_id=this.marketsById,this.symbols=Object.keys(this.markets).sort(),this.ids=Object.keys(this.markets_by_id).sort(),t)this.currencies=o(t,this.currencies);else{let e=s.filter((e=>"base"in e)).map((e=>({id:e.baseId||e.base,numericId:void 0!==e.baseNumericId?e.baseNumericId:void 0,code:e.base,precision:e.precision?e.precision.base||e.precision.amount:8}))),t=s.filter((e=>"quote"in e)).map((e=>({id:e.quoteId||e.quote,numericId:void 0!==e.quoteNumericId?e.quoteNumericId:void 0,code:e.quote,precision:e.precision?e.precision.quote||e.precision.price:8})));e=f(e,"code"),t=f(t,"code"),this.baseCurrencies=l(e,"code"),this.quoteCurrencies=l(t,"code");const i=e.concat(t),r=p(i,"code"),a=Object.keys(r).map((e=>r[e].reduce(((e,t)=>e.precision>t.precision?e:t),r[e][0]))),n=f(h(a),"code");this.currencies=o(l(n,"code"),this.currencies)}return this.currencies_by_id=l(this.currencies,"id"),this.markets}async loadMarketsHelper(e=!1,t={}){if(!e&&this.markets)return this.markets_by_id?this.markets:this.setMarkets(this.markets);let s;this.has.fetchCurrencies&&(s=await this.fetchCurrencies());const i=await this.fetchMarkets(t);return this.setMarkets(i,s)}loadMarkets(e=!1,t={}){return(e&&!this.reloadingMarkets||!this.marketsLoading)&&(this.reloadingMarkets=!0,this.marketsLoading=this.loadMarketsHelper(e,t).then((e=>(this.reloadingMarkets=!1,e)),(e=>{throw this.reloadingMarkets=!1,e}))),this.marketsLoading}async loadAccounts(e=!1,t={}){if(e)this.accounts=await this.fetchAccounts(t);else{if(this.accounts)return this.accounts;this.accounts=await this.fetchAccounts(t)}return this.accountsById=this.indexBy(this.accounts,"id"),this.accounts}fetchBidsAsks(e,t={}){throw new N(this.id+" fetchBidsAsks not supported yet")}async fetchOHLCVC(e,t="1m",s,i,r={}){if(!this.has.fetchTrades)throw new N(this.id+" fetchOHLCV() not supported yet");await this.loadMarkets();const a=await this.fetchTrades(e,s,i,r);return O(a,t,s,i)}async fetchOHLCV(e,t="1m",s,i,r={}){if(!this.has.fetchTrades)throw new N(this.id+" fetchOHLCV() not supported yet");await this.loadMarkets();const a=await this.fetchTrades(e,s,i,r);return O(a,t,s,i).map((e=>e.slice(0,-1)))}parseTradingViewOHLCV(e,t,s="1m",i,r){const a=this.convertTradingViewToOHLCV(e);return this.parseOHLCVs(a,t,s,i,r)}convertTradingViewToOHLCV(e,t="t",s="o",i="h",r="l",a="c",n="v",o=!1){const c=[];for(let d=0;d<e[t].length;d++)c.push([o?e[t][d]:1e3*e[t][d],e[s][d],e[i][d],e[r][d],e[a][d],e[n][d]]);return c}convertOHLCVToTradingView(e,t="t",s="o",i="h",r="l",a="c",n="v",o=!1){const c={};c[t]=[],c[s]=[],c[i]=[],c[r]=[],c[a]=[],c[n]=[];for(let d=0;d<e.length;d++)c[t].push(o?e[d][0]:parseInt(e[d][0]/1e3)),c[s].push(e[d][1]),c[i].push(e[d][2]),c[r].push(e[d][3]),c[a].push(e[d][4]),c[n].push(e[d][5]);return c}async fetchTicker(e,t={}){if(this.has.fetchTickers){const s=await this.fetchTickers([e],t),i=this.safeValue(s,e);if(void 0===i)throw new M(this.id+" fetchTickers could not find a ticker for "+e);return i}throw new N(this.id+" fetchTicker not supported yet")}fetchTickers(e,t={}){throw new N(this.id+" fetchTickers not supported yet")}fetchOrder(e,t,s={}){throw new N(this.id+" fetchOrder not supported yet")}fetchUnifiedOrder(e,t={}){return this.fetchOrder(this.safeValue(e,"id"),this.safeValue(e,"symbol"),t)}createOrder(e,t,s,i,r,a={}){throw new N(this.id+" createOrder not supported yet")}cancelOrder(e,t,s={}){throw new N(this.id+" cancelOrder not supported yet")}cancelUnifiedOrder(e,t={}){return this.cancelOrder(this.safeValue(e,"id"),this.safeValue(e,"symbol"),t)}fetchOrders(e,t,s,i={}){throw new N(this.id+" fetchOrders not supported yet")}fetchOpenOrders(e,t,s,i={}){throw new N(this.id+" fetchOpenOrders not supported yet")}fetchClosedOrders(e,t,s,i={}){throw new N(this.id+" fetchClosedOrders not supported yet")}fetchMyTrades(e,t,s,i={}){throw new N(this.id+" fetchMyTrades not supported yet")}fetchTransactions(e,t,s,i={}){throw new N(this.id+" fetchTransactions not supported yet")}fetchDeposits(e,t,s,i={}){throw new N(this.id+" fetchDeposits not supported yet")}fetchWithdrawals(e,t,s,i={}){throw new N(this.id+" fetchWithdrawals not supported yet")}async fetchDepositAddress(e,t={}){if(this.has.fetchDepositAddresses){const s=await this.fetchDepositAddresses([e],t),i=this.safeValue(s,e);if(void 0===i)throw new M(this.id+" fetchDepositAddress could not find a deposit address for "+e+", make sure you have created a corresponding deposit address in your wallet on the exchange website");return i}throw new N(this.id+" fetchDepositAddress not supported yet")}fetchCurrencies(e={}){return new Promise(((e,t)=>e(this.currencies)))}fetchMarkets(e={}){return new Promise(((e,t)=>e(Object.values(this.markets))))}async fetchOrderStatus(e,t,s={}){return(await this.fetchOrder(e,t,s)).status}account(){return{free:void 0,used:void 0,total:void 0}}commonCurrencyCode(e){return this.substituteCommonCurrencyCodes?this.safeString(this.commonCurrencies,e,e):e}currencyId(e){if(void 0===this.currencies)throw new C(this.id+" currencies not loaded");if(e in this.currencies)return this.currencies[e].id;const t={},s=Object.keys(this.commonCurrencies);for(let e=0;e<s.length;e++){const i=s[e];t[this.commonCurrencies[i]]=i}return this.safeString(t,e,e)}currency(e){if(void 0===this.currencies)throw new C(this.id+" currencies not loaded");if("string"==typeof e&&e in this.currencies)return this.currencies[e];throw new C(this.id+" does not have currency code "+e)}market(e){if(void 0===this.markets)throw new C(this.id+" markets not loaded");if("string"==typeof e&&e in this.markets)return this.markets[e];throw new I(this.id+" does not have market symbol "+e)}marketId(e){const t=this.market(e);return void 0!==t?t.id:e}marketIds(e){return e.map((e=>this.marketId(e)))}currencyIds(e){return e.map((e=>this.currencyId(e)))}symbol(e){return this.market(e).symbol||e}url(e,t={}){let s=this.implodeParams(e,t);const i=this.omit(t,this.extractParams(e));return Object.keys(i).length&&(s+="?"+this.urlencode(i)),s}parseBidAsk(e,t=0,s=1){return[this.safeNumber(e,t),this.safeNumber(e,s)]}parseBidsAsks(e,t=0,s=1){return Object.values(e||[]).map((e=>this.parseBidAsk(e,t,s)))}async fetchL2OrderBook(e,t,s={}){const i=await this.fetchOrderBook(e,t,s);return c(i,{bids:f(m(i.bids),0,!0),asks:f(m(i.asks),0)})}parseOrderBook(e,t,s,i="bids",r="asks",a=0,n=1){return{symbol:t,bids:f(i in e?this.parseBidsAsks(e[i],a,n):[],0,!0),asks:f(r in e?this.parseBidsAsks(e[r],a,n):[],0),timestamp:s,datetime:this.iso8601(s),nonce:void 0}}parseBalance(e,t=!0){const s=Object.keys(this.omit(e,["info","timestamp","datetime","free","used","total"]));e.free={},e.used={},e.total={};for(let i=0;i<s.length;i++){const r=s[i];void 0===e[r].total&&void 0!==e[r].free&&void 0!==e[r].used&&(e[r].total=t?this.sum(e[r].free,e[r].used):G.stringAdd(e[r].free,e[r].used)),void 0===e[r].free&&void 0!==e[r].total&&void 0!==e[r].used&&(e[r].free=t?this.sum(e[r].total,-e[r].used):G.stringSub(e[r].total,e[r].used)),void 0===e[r].used&&void 0!==e[r].total&&void 0!==e[r].free&&(e[r].used=t?this.sum(e[r].total,-e[r].free):G.stringSub(e[r].total,e[r].free)),e[r].free=this.parseNumber(e[r].free),e[r].used=this.parseNumber(e[r].used),e[r].total=this.parseNumber(e[r].total),e.free[r]=e[r].free,e.used[r]=e[r].used,e.total[r]=e[r].total}return e}async fetchBalance(e={}){throw new N(this.id+" fetchBalance not supported yet")}async fetchPartialBalance(e,t={}){return(await this.fetchBalance(t))[e]}fetchFreeBalance(e={}){return this.fetchPartialBalance("free",e)}fetchUsedBalance(e={}){return this.fetchPartialBalance("used",e)}fetchTotalBalance(e={}){return this.fetchPartialBalance("total",e)}async fetchStatus(e={}){if(this.has.fetchTime){const t=await this.fetchTime(e);this.status=this.extend(this.status,{updated:t})}return this.status}async fetchTradingFees(e={}){throw new N(this.id+" fetchTradingFees not supported yet")}async fetchTradingFee(e,t={}){if(!this.has.fetchTradingFees)throw new N(this.id+" fetchTradingFee not supported yet");return await this.fetchTradingFees(t)}async loadTradingLimits(e,t=!1,s={}){if(this.has.fetchTradingLimits&&(t||!("limitsLoaded"in this.options))){const t=await this.fetchTradingLimits(e);for(let s=0;s<e.length;s++){const i=e[s];this.markets[i]=this.deepExtend(this.markets[i],t[i])}this.options.limitsLoaded=this.milliseconds()}return this.markets}filterBySinceLimit(e,t,s,i="timestamp",r=!1){return null!=t&&(e=e.filter((e=>e[i]>=t))),null!=s&&(e=r?e.slice(-s):e.slice(0,s)),e}filterByValueSinceLimit(e,t,s,i,r,a="timestamp",n=!1){const o=null!=s,c=null!=i;return(o||c)&&(e=e.filter((e=>(!o||e[t]===s)&&(!c||e[a]>=i)))),null!=r&&(e=n?e.slice(-r):e.slice(0,r)),e}filterBySymbolSinceLimit(e,t,s,i,r=!1){return this.filterByValueSinceLimit(e,"symbol",t,s,i,"timestamp",r)}filterByCurrencySinceLimit(e,t,s,i,r=!1){return this.filterByValueSinceLimit(e,"currency",t,s,i,"timestamp",r)}filterByArray(e,t,s,i=!0){if(e=Object.values(e),null==s)return i?l(e,t):e;const r=[];for(let i=0;i<e.length;i++)s.includes(e[i][t])&&r.push(e[i]);return i?l(r,t):r}safeTicker(e,t){void 0===this.safeValue(e,"symbol")&&(e.symbol=this.safeSymbol(void 0,t));const s=this.safeInteger(e,"timestamp");void 0!==s&&(e.timestamp=s,e.datetime=this.iso8601(s));const i=this.safeValue(e,"baseVolume"),r=this.safeValue(e,"quoteVolume");void 0===this.safeValue(e,"vwap")&&(e.vwap=this.vwap(i,r));const a=this.safeValue(e,"close"),n=this.safeValue(e,"last");return void 0===a&&void 0!==n?e.close=n:void 0===n&&void 0!==a&&(e.last=a),e}parseTickers(e,t,s={}){const i=[],r=Object.values(e||[]);for(let e=0;e<r.length;e++)i.push(this.extend(this.parseTicker(r[e]),s));return this.filterByArray(i,"symbol",t)}parseDepositAddresses(e,t){let s=[];for(let t=0;t<e.length;t++){const i=this.parseDepositAddress(e[t]);s.push(i)}return t&&(s=this.filterByArray(s,"currency",t)),this.indexBy(s,"currency")}parseTrades(e,t,s,i,r={}){let a=Object.values(e||[]).map((e=>this.extend(this.parseTrade(e,t),r)));a=f(a,"timestamp");const n=void 0!==t?t.symbol:void 0,o=void 0===s;return this.filterBySymbolSinceLimit(a,n,s,i,o)}parseTransactions(e,t,s,i,r={}){let a=Object.values(e||[]).map((e=>this.extend(this.parseTransaction(e,t),r)));a=this.sortBy(a,"timestamp");const n=void 0!==t?t.code:void 0,o=void 0===s;return this.filterByCurrencySinceLimit(a,n,s,i,o)}parseTransfers(e,t,s,i,r={}){let a=Object.values(e||[]).map((e=>this.extend(this.parseTransfer(e,t),r)));a=this.sortBy(a,"timestamp");const n=void 0!==t?t.code:void 0,o=void 0===s;return this.filterByCurrencySinceLimit(a,n,s,i,o)}parseLedger(e,t,s,i,r={}){let a=[];const n=Object.values(e||[]);for(let e=0;e<n.length;e++){const s=this.parseLedgerEntry(n[e],t);if(Array.isArray(s))for(let e=0;e<s.length;e++)a.push(this.extend(s[e],r));else a.push(this.extend(s,r))}a=this.sortBy(a,"timestamp");const o=void 0!==t?t.code:void 0,c=void 0===s;return this.filterByCurrencySinceLimit(a,o,s,i,c)}parseOrders(e,t,s,i,r={}){let a=Array.isArray(e)?Object.values(e).map((e=>this.extend(this.parseOrder(e,t),r))):Object.entries(e).map((([e,s])=>this.extend(this.parseOrder(this.extend({id:e},s),t),r)));a=f(a,"timestamp");const n=void 0!==t?t.symbol:void 0,o=void 0===s;return this.filterBySymbolSinceLimit(a,n,s,i,o)}safeCurrency(e,t){return void 0===e&&void 0!==t?t:void 0!==this.currencies_by_id&&e in this.currencies_by_id?this.currencies_by_id[e]:{id:e,code:void 0===e?e:this.commonCurrencyCode(e.toUpperCase())}}safeCurrencyCode(e,t){return(t=this.safeCurrency(e,t)).code}safeMarket(e,t,s){if(void 0!==e)if(void 0!==this.markets_by_id&&e in this.markets_by_id)t=this.markets_by_id[e];else if(void 0!==s){const[t,i]=e.split(s),r=this.safeCurrencyCode(t),a=this.safeCurrencyCode(i);return{id:e,symbol:r+"/"+a,base:r,quote:a,baseId:t,quoteId:i}}return void 0!==t?t:{id:e,symbol:e,base:void 0,quote:void 0,baseId:void 0,quoteId:void 0}}safeSymbol(e,t,s){return(t=this.safeMarket(e,t,s)).symbol}filterBySymbol(e,t){return void 0!==t?e.filter((e=>e.symbol===t)):e}parseOHLCV(e,t){return Array.isArray(e)?e.slice(0,6):e}parseOHLCVs(e,t,s="1m",i,r){const a=e.map((e=>this.parseOHLCV(e,t))),n=this.sortBy(a,0),o=void 0===i;return this.filterBySinceLimit(n,i,r,0,o)}editLimitBuyOrder(e,t,...s){return this.editLimitOrder(e,t,"buy",...s)}editLimitSellOrder(e,t,...s){return this.editLimitOrder(e,t,"sell",...s)}editLimitOrder(e,t,...s){return this.editOrder(e,t,"limit",...s)}async editOrder(e,t,...s){if(!this.enableRateLimit)throw new C(this.id+" editOrder() requires enableRateLimit = true");return await this.cancelOrder(e,t),this.createOrder(t,...s)}createLimitOrder(e,t,s,i,r={}){return this.createOrder(e,"limit",t,s,i,r)}createMarketOrder(e,t,s,i,r={}){return this.createOrder(e,"market",t,s,i,r)}createLimitBuyOrder(e,t,s,i={}){return this.createOrder(e,"limit","buy",t,s,i)}createLimitSellOrder(e,t,s,i={}){return this.createOrder(e,"limit","sell",t,s,i)}createMarketBuyOrder(e,t,s={}){return this.createOrder(e,"market","buy",t,void 0,s)}createMarketSellOrder(e,t,s={}){return this.createOrder(e,"market","sell",t,void 0,s)}costToPrecision(e,t){return T(t,L,this.markets[e].precision.price,this.precisionMode,this.paddingMode)}priceToPrecision(e,t){return T(t,q,this.markets[e].precision.price,this.precisionMode,this.paddingMode)}amountToPrecision(e,t){return T(t,L,this.markets[e].precision.amount,this.precisionMode,this.paddingMode)}feeToPrecision(e,t){return T(t,q,this.markets[e].precision.price,this.precisionMode,this.paddingMode)}currencyToPrecision(e,t){return T(t,q,this.currencies[e].precision,this.precisionMode,this.paddingMode)}calculateFee(e,t,s,i,r,a="taker",n={}){const o=this.markets[e],c=this.safeString(o,"feeSide","quote");let d,h="quote";"quote"===c?d=i*r:"base"===c?d=i:"get"===c?(d=i,"sell"===s?d*=r:h="base"):"give"===c&&(d=i,"buy"===s?d*=r:h="base");const u=o[a];return void 0!==d&&(d*=u),{type:a,currency:o[h],rate:u,cost:d}}checkRequiredDependencies(){}remove0xPrefix(e){return"0x"===e.slice(0,2)?e.slice(2):e}hashMessage(e){const t=this.base16ToBinary(this.remove0xPrefix(e)),s=this.stringToBinary("Ethereum Signed Message:\n"+t.sigBytes);return"0x"+this.hash(this.binaryConcat(s,t),"keccak","hex")}signHash(e,t){const s=this.ecdsa(e.slice(-64),t.slice(-64),"secp256k1",void 0);return{r:"0x"+s.r,s:"0x"+s.s,v:27+s.v}}signMessage(e,t){return this.signHash(this.hashMessage(e),t.slice(-64))}signMessageString(e,t){const s=this.signMessage(e,t);return s.r+this.remove0xPrefix(s.s)+this.binaryToBase16(this.numberToBE(s.v))}oath(){if(void 0!==this.twofa)return this.totp(this.twofa);throw new C(this.id+" this.twofa has not been set")}reduceFeesByCurrency(e){const t={};for(let s=0;s<e.length;s++){const i=e[s],r=this.safeValue(i,"currency");void 0!==r&&(r in t?t[r].cost=this.sum(t[r].cost,i.cost):t[r]={cost:i.cost,currency:r})}return Object.values(t)}safeOrder(e){let t=this.safeValue(e,"amount"),s=this.safeValue(e,"remaining"),i=this.safeValue(e,"filled"),r=this.safeValue(e,"cost"),a=this.safeValue(e,"average"),n=this.safeValue(e,"price"),o=this.safeInteger(e,"lastTradeTimestamp");const c=void 0===i,d=void 0===r,h=void 0===o,u=void 0===this.safeValue(e,"fee"),l=void 0===this.safeValue(e,"fees"),f=u||l,p=this.safeValue(e,"fees",[]);if(c||d||f){const t=this.safeValue(e,"trades");if(Array.isArray(t)){c&&(i=0),d&&(r=0);for(let e=0;e<t.length;e++){const s=t[e],a=this.safeValue(s,"amount");c&&void 0!==a&&(i=this.sum(i,a));const n=this.safeValue(s,"cost");d&&void 0!==n&&(r=this.sum(r,n));const u=this.safeValue(s,"timestamp");if(h&&void 0!==u&&(o=void 0===o?u:Math.max(o,u)),f){const e=this.safeValue(s,"fees");if(void 0!==e)for(let t=0;t<e.length;t++){const s=e[t];p.push(this.extend({},s))}else{const e=this.safeValue(s,"fee");void 0!==e&&p.push(this.extend({},e))}}}}}if(f){const t=this.reduceFees?this.reduceFeesByCurrency(p):p,s=t.length;u||0!==s||t.push(e.fee),l&&(e.fees=t),u&&1===s&&(e.fee=t[0])}void 0===t&&(void 0!==i&&void 0!==s?t=this.sum(i,s):"closed"===this.safeString(e,"status")&&(t=i)),void 0===i&&void 0!==t&&void 0!==s&&(i=Math.max(this.sum(t,-s),0)),void 0===s&&void 0!==t&&void 0!==i&&(s=Math.max(this.sum(t,-i),0)),void 0===a&&void 0!==i&&void 0!==r&&i>0&&(a=r/i);d&&void 0!==i&&(void 0!==a||void 0!==n)&&(r=void 0===a?n*i:a*i);const m=this.safeValue(e,"type");return(void 0===n||0===n)&&"market"===m&&(n=a),this.extend(e,{lastTradeTimestamp:o,price:n,amount:t,cost:r,average:a,filled:i,remaining:s})}parseNumber(e,t){if(void 0===e)return t;try{return this.number(e)}catch(e){return t}}safeNumber(e,t,s){const i=this.safeString(e,t);return this.parseNumber(i,s)}safeNumber2(e,t,s,i){const r=this.safeString2(e,t,s);return this.parseNumber(r,i)}parsePrecision(e){if(void 0!==e)return"1e"+G.stringNeg(e)}}},6832:e=>{"use strict";const t=BigInt(0),s=BigInt(-1);class i{constructor(e,t=0){const s="bigint"==typeof e;if(!s&&!("string"==typeof e))throw new Error("Precise initiated with something other than a string or BN");if(s)this.integer=e,this.decimals=t;else{if(t)throw new Error("Cannot set decimals when initializing with a string");let s=0;(e=e.toLowerCase()).indexOf("e")>-1&&([e,s]=e.split("e"),s=parseInt(s));const i=e.indexOf(".");this.decimals=i>-1?e.length-i-1:0;const r=e.replace(".","");this.integer=BigInt(r),this.decimals=this.decimals-s}this.base=10,this.reduce()}mul(e){const t=this.integer*e.integer;return new i(t,this.decimals+e.decimals)}div(e,t=18){const s=t-this.decimals+e.decimals;let r;if(0===s)r=this.integer;else if(s<0){const e=BigInt(this.base)**BigInt(-s);r=this.integer/e}else{const e=BigInt(this.base)**BigInt(s);r=this.integer*e}const a=r/e.integer;return new i(a,t)}add(e){if(this.decimals===e.decimals){const t=this.integer+e.integer;return new i(t,this.decimals)}{const[t,s]=this.decimals>e.decimals?[e,this]:[this,e],r=s.decimals-t.decimals,a=t.integer*BigInt(this.base)**BigInt(r)+s.integer;return new i(a,s.decimals)}}mod(e){const t=BigInt(this.base),s=Math.max(-this.decimals+e.decimals,0),r=this.integer*t**BigInt(s),a=Math.max(-e.decimals+this.decimals,0),n=e.integer*t**BigInt(a);return new i(r%n,a+e.decimals)}pow(e){const t=this.integer**e.integer;return new i(t,this.decimals*parseInt(e.integer))}sub(e){const t=new i(-e.integer,e.decimals);return this.add(t)}abs(){return new i(this.integer<0?this.integer*s:this.integer,this.decimals)}neg(){return new i(-this.integer,this.decimals)}reduce(){if(this.integer===t)return this.decimals=0,this;const e=BigInt(this.base);let s=this.integer%e;for(;s===t;)this.integer=this.integer/e,s=this.integer%e,this.decimals--;return this}toString(){let e,t;this.integer<0?(e="-",t=-this.integer):(e="",t=this.integer);const s=Array.from(t.toString(this.base).padStart(this.decimals,"0")),i=s.length-this.decimals;let r;return r=0===i?"0.":this.decimals<0?"0".repeat(-this.decimals):0===this.decimals?"":".",s.splice(i,0,r),e+s.join("")}static stringMul(e,t){if(void 0!==e&&void 0!==t)return new i(e).mul(new i(t)).toString()}static stringDiv(e,t,s=18){if(void 0!==e&&void 0!==t)return new i(e).div(new i(t),s).toString()}static stringAdd(e,t){if(void 0!==e||void 0!==t)return void 0===e?t:void 0===t?e:new i(e).add(new i(t)).toString()}static stringSub(e,t){if(void 0!==e&&void 0!==t)return new i(e).sub(new i(t)).toString()}static stringAbs(e){if(void 0!==e)return new i(e).abs().toString()}static stringNeg(e){if(void 0!==e)return new i(e).neg().toString()}static stringMod(e,t){if(void 0!==e&&void 0!==t)return new i(e).mod(new i(t)).toString()}static stringPow(e,t){if(void 0!==e&&void 0!==t)return new i(e).pow(new i(t)).toString()}}e.exports=i},6667:e=>{"use strict";e.exports={BaseError:{ExchangeError:{AuthenticationError:{PermissionDenied:{},AccountSuspended:{}},ArgumentsRequired:{},BadRequest:{BadSymbol:{}},BadResponse:{NullResponse:{}},InsufficientFunds:{},InvalidAddress:{AddressPending:{}},InvalidOrder:{OrderNotFound:{},OrderNotCached:{},CancelPending:{},OrderImmediatelyFillable:{},OrderNotFillable:{},DuplicateOrderId:{}},NotSupported:{}},NetworkError:{DDoSProtection:{RateLimitExceeded:{}},ExchangeNotAvailable:{OnMaintenance:{}},InvalidNonce:{},RequestTimeout:{}}}}},3449:(e,t,s)=>{"use strict";const i=s(6667);e.exports=function e(t,s,i={}){for(const[r,a]of Object.entries(s)){const s=Object.assign(i,{[r]:class extends t{constructor(e){super(e),this.constructor=s,this.__proto__=s.prototype,this.name=r,this.message=e,Object.setPrototypeOf(this,s.prototype)}}})[r];e(s,a,i)}return i}(Error,i)},5806:(e,t,s)=>{"use strict";const{unCamelCase:i}=s(9579);e.exports=(e=>{for(const t in e)e[i(t)]=e[t];return e})(Object.assign({},s(182),s(5206),s(9579),s(1799),s(2115),s(651),s(5691),s(9764),s(3186),s(6558)))},5691:(e,t,s)=>{"use strict";const i=s(7295),{capitalize:r}=s(9579),{stringToBase64:a,urlencodeBase64:n}=s(651),o=s(1286),{binaryToBase58:c,byteArrayToWordArray:d}=s(651),h=s(3150),u=h.ec,l=h.eddsa,{ArgumentsRequired:f}=s(3449),p=s(5060),m=(e,t="md5",s="hex")=>{const a={};"keccak"===t&&(t="SHA3",a.outputLength=256);const n=i[t.toUpperCase()](e,a);return"binary"===s?n:n.toString(i.enc[r(s)])},b=(e,t,s="sha256",a="hex")=>{const n=i["Hmac"+s.toUpperCase()](e,t);if(a){const e="binary"===a?"Latin1":r(a);return n.toString(i.enc[r(e)])}return n};function g(e,t,s="RS256"){const i={RS256:"pkcs1-sha256",RS512:"pkcs1-sha512"};if(!(s in i))throw new ExchangeError(s+" is not a supported rsa signing algorithm.");return new o(t,{environment:"browser",signingScheme:i[s]}).sign(e,"base64","binary")}e.exports={hash:m,hmac:b,jwt:function(e,t,s="HS256"){const i=[n(a(JSON.stringify({alg:s,typ:"JWT"}))),n(a(JSON.stringify(e)))].join("."),r=s.slice(0,2);let o;return"HS"===r?o=n(b(i,t,{HS256:"sha256",HS384:"sha384",HS512:"sha512"}[s],"base64")):"RS"===r&&(o=n(g(i,t,s))),[i,o].join(".")},totp:e=>{const t=e=>parseInt(e,16),s=(e,t)=>(t+e).slice(-t.length);return(e=>{e=e.replace(" ","");let r=Math.round((new Date).getTime()/1e3),a=s(((n=Math.floor(r/30))<15.5?"0":"")+Math.round(n).toString(16),"0000000000000000");var n;let o=b(i.enc.Hex.parse(a),i.enc.Hex.parse((e=>{let t="",i="";for(let i=0;i<e.length;i++){let r="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".indexOf(e.charAt(i).toUpperCase());t+=s(r.toString(2),"00000")}for(let e=0;e+4<=t.length;e+=4){let s=t.substr(e,4);i+=parseInt(s,2).toString(16)}return i})(e)),"sha1","hex"),c=t(o.substring(o.length-1)),d=(t(o.substr(2*c,8))&t("7fffffff"))+"";return d=d.substr(d.length-6,6),d})(e)},rsa:g,ecdsa:function(e,t,s="p256",i,r=!1){let a=e;void 0!==i&&(a=m(e,i,"hex"));const n=new u(s);let o=n.sign(a,t,"hex",{canonical:!0}),c=new p("0");const d=new p("1").shln(248).sub(new p("1"));for(;r&&(o.r.gt(n.nh)||o.r.lte(d)||o.s.lte(d));)o=n.sign(a,t,"hex",{canonical:!0,extraEntropy:c.toArray("le",32)}),c=c.add(new p("1"));return{r:o.r.toString(16).padStart(64,"0"),s:o.s.toString(16).padStart(64,"0"),v:o.recoveryParam}},eddsa:function(e,t,s="ed25519"){const i=new l(s).signModified(e,t);return c(d(i.toBytes()))}}},651:(e,t,s)=>{"use strict";const i=s(7295),r=s(4106),a=s(5060),n="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";let o=null,c=null;function d(e){const t=[];for(let s=0;s<e.length;s++)t[s/4|0]|=e[s]<<24-8*s;return i.lib.WordArray.create(t,e.length)}e.exports={json:(e,t)=>JSON.stringify(e),isJsonEncodedObject:e=>"string"==typeof e&&e.length>=2&&("{"===e[0]||"["===e[0]),stringToBinary:e=>i.enc.Latin1.parse(e),stringToBase64:e=>i.enc.Latin1.parse(e).toString(i.enc.Base64),base64ToBinary:e=>i.enc.Base64.parse(e),base64ToString:e=>i.enc.Base64.parse(e).toString(i.enc.Utf8),binaryToBase64:e=>e.toString(i.enc.Base64),base16ToBinary:e=>i.enc.Hex.parse(e),binaryToBase16:e=>e.toString(i.enc.Hex),binaryConcat:(...e)=>e.reduce(((e,t)=>e.concat(t))),binaryConcatArray:e=>e.reduce(((e,t)=>e.concat(t))),urlencode:e=>r.stringify(e),urlencodeWithArrayRepeat:e=>r.stringify(e,{arrayFormat:"repeat"}),rawencode:e=>r.stringify(e,{encode:!1}),encode:e=>e,decode:e=>e,urlencodeBase64:e=>e.replace(/[=]+$/,"").replace(/\+/g,"-").replace(/\//g,"_"),numberToLE:(e,t)=>d(new a(e).toArray("le",t)),numberToBE:(e,t)=>d(new a(e).toArray("be",t)),base58ToBinary:e=>{if(!o){o={},c={};for(let e=0;e<58;e++){const t=n[e],s=new a(e);o[t]=s,c[s]=t}}let t=new a(0);const s=new a(58);for(let i=0;i<e.length;i++){const r=e[i];t.imul(s),t.iadd(o[r])}return d(t.toArray("be"))},binaryToBase58:e=>{if(!c){o={},c={};for(let e=0;e<58;e++){const t=n[e],s=new a(e);o[t]=s,c[s]=t}}const t=new a(58),s=e.toString(i.enc.Hex);let r=new a(s,16),d=[];for(;!r.isZero();){const{div:e,mod:s}=r.divmod(t);r=e,d.push(c[s])}return d.reverse().join("")}},e.exports.byteArrayToWordArray=d},5206:(e,t,s)=>{"use strict";const{isObject:i,isNumber:r,isDictionary:a,isArray:n}=s(1799),o=Object.keys,c=e=>n(e)?e:Object.values(e),d=e=>new Set(c(e)),h=(...e)=>Object.assign({},...e),u=e=>n(e)?Array.from(e):h(e);e.exports={keys:o,values:c,extend:h,clone:u,index:d,ordered:e=>e,unique:e=>Array.from(d(e)),arrayConcat:(e,t)=>e.concat(t),inArray:(e,t)=>t.includes(e),toArray:e=>Object.values(e),isEmpty:e=>!e||(Array.isArray(e)?e:Object.keys(e)).length<1,keysort(e,t={}){for(const s of o(e).sort())t[s]=e[s];return t},indexBy(e,t,s={}){for(const i of c(e))t in i&&(s[i[t]]=i);return s},groupBy(e,t,s={}){for(const i of c(e))if(t in i){const e=i[t];s[e]=s[e]||[],s[e].push(i)}return s},filterBy(e,t,s,i=[]){for(const r of c(e))r[t]===s&&i.push(r);return i},sortBy:(e,t,s=!1,i=(s?-1:1))=>e.sort(((e,s)=>e[t]<s[t]?-i:e[t]>s[t]?i:0)),flatten:function e(t,s=[]){for(const i of t)n(i)?e(i,s):s.push(i);return s},pluck:(e,t)=>c(e).filter((e=>t in e)).map((e=>e[t])),omit(e,...t){if(!Array.isArray(e)){const s=u(e);for(const e of t)if(n(e))for(const t of e)delete s[t];else delete s[e];return s}return e},sum(...e){const t=e.filter(r);return t.length>0?t.reduce(((e,t)=>e+t),0):void 0},deepExtend:function e(...t){let s;for(const i of t)if(a(i)){a(s)||(s={});for(const t in i)s[t]=e(s[t],i[t])}else s=i;return s}}},6558:(e,t,s)=>{"use strict";const{ROUND_UP:i,ROUND_DOWN:r}=s(2115),{NotSupported:a}=s(3449),n=e=>{const t=e.slice(0,-1),s=e.slice(-1);let i;if("y"===s)i=31536e3;else if("M"===s)i=2592e3;else if("w"===s)i=604800;else if("d"===s)i=86400;else if("h"===s)i=3600;else if("m"===s)i=60;else{if("s"!==s)throw new a("timeframe unit "+s+" is not supported");i=1}return t*i};e.exports={aggregate(e){const t={};for(let s=0;s<e.length;s++){const[i,r]=e[s];r>0&&(t[i]=(t[i]||0)+r)}return Object.keys(t).map((e=>[parseFloat(e),parseFloat(t[e])]))},parseTimeframe:n,roundTimeframe:(e,t,s=r)=>{const a=1e3*n(e);return t-t%a+(s===i?a:0)},buildOHLCVC:(e,t="1m",s=-1/0,i=1/0)=>{const r=1e3*n(t),a=[],[o,,c,d,h,u,l]=[0,1,2,3,4,5,6],f=Math.min(e.length-1,i);for(let t=0;t<=f;t++){const i=e[t];if(i.timestamp<s)continue;const n=Math.floor(i.timestamp/r)*r,f=a.length-1;-1===f||n>=a[f][o]+r?a.push([n,i.price,i.price,i.price,i.price,i.amount,1]):(a[f][c]=Math.max(a[f][c],i.price),a[f][d]=Math.min(a[f][d],i.price),a[f][h]=i.price,a[f][u]+=i.amount,a[f][l]++)}return a},ROUND_UP:i,ROUND_DOWN:r,implodeParams:(e,t)=>{if(!Array.isArray(t)){const s=Object.keys(t);for(let i=0;i<s.length;i++){const r=s[i];Array.isArray(t[r])||(e=e.replace("{"+r+"}",t[r]))}}return e},extractParams:e=>{const t=/{([\w-]+)}/g,s=[];let i=t.exec(e);for(;i;)s.push(i[1]),i=t.exec(e);return s},vwap:function(e,t){return void 0!==e&&void 0!==t&&e>0?t/e:void 0}}},2115:e=>{"use strict";const t={ROUND:0,TRUNCATE:1,ROUND_UP:2,ROUND_DOWN:3,DECIMAL_PLACES:0,SIGNIFICANT_DIGITS:1,TICK_SIZE:2,NO_PADDING:0,PAD_WITH_ZERO:1};function s(e){if("string"==typeof e)return e;const t=e.toString();if(Math.abs(e)<1){const s=t.split("e-"),i=s[0].replace(".",""),r=parseInt(s[1]),a="-"===t[0];if(r)return e=(a?"-":"")+"0."+new Array(r).join("0")+i.substring(a)}else{const e=t.split("e");if(e[1]){let t=parseInt(e[1]);const s=e[0].split(".");let i="";return s[1]&&(t-=s[1].length,i=s[1]),s[0]+i+new Array(t+1).join("0")}}return t}const i=[],r=(e,t=0)=>{if(e=s(e),t>0){const s=i[t]||(i[t]=new RegExp("([-]*\\d+\\.\\d{"+t+"})(\\d)")),[,r]=e.toString().match(s)||[null,e];return r.toString()}return parseInt(e).toString()};function a(e){const t=e.replace(/0+$/g,"").split(".");return t.length>1?t[1].length:0}const n=(e,t,i,r=0,o=0)=>{if(2===r&&i<=0)throw new Error("TICK_SIZE cant be used with negative or zero numPrecisionDigits");if(i<0){const s=Math.pow(10,-i);if(0===t)return(s*n(e/s,t,0,r,o)).toString();if(1===t)return(e-e%s).toString()}if(2===r){const s=a(n(i,0,22,0,0));let r=e%i;r=Number(n(r,0,8,0,0));return 0!==a(n(r/i,0,Math.max(s,8),0,0))&&(0===t?e>0?r>=i/2?e=e-r+i:e-=r:e=r>=i/2?Number(e)-r:Number(e)-r-i:1===t&&(e-=r)),n(e,0,s,0,o)}const c=s(e),d="-"===c[0],h=d?1:0,u=c.length;for(var l=0;l<u&&"."!==c[l];l++);const f=l<c.length,p=48,m=new Uint8Array(u-h+(f?0:1));m[0]=p;let b=m.length,g=-1,y=-1;for(var v=1,w=h;w<u;w++,v++){const e=c.charCodeAt(w);if(46===e)b=v--;else{if(e<p||e>57)throw new Error(`${c}: invalid number (contains an illegal character '${c[v-1]}')`);m[v]=e,e!==p&&g<0&&(g=v)}}g<0&&(g=1);let k=0===r?b:g,S=k+i;y=-1;let _=!0,O=d;for(let e=m.length-1,s=0;e>=0;e--){let r=m[e];if(0!==e){if(r+=s,e>=k+i){r=0===t&&r>=53&&!(53===r&&s)?58:p}r>57?(r=p,s=1):s=0}else s&&(r=49);m[e]=r,r!==p&&(_=!1,g=e,y=y<0?e+1:y)}1===r&&(k=g,S=k+i),_&&(O=!1);const T=g>=b||_?b-1:g,x=y<b?b:y,C=O?1:0,I=C+(b-T),M=Math.max(x-b,0),N=x-T,A=0===o?N:S-T,E=Math.max(A-N,0),P=I+1+M,B=P+E,V=M+E===0,L=new Uint8Array(I+(V?0:1)+M+E);for(O&&(L[0]=45),v=C,w=T;v<I;v++,w++)L[v]=m[w];for(V||(L[I]=46),v=I+1,w=b;v<P;v++,w++)L[v]=m[w];for(v=P;v<B;v++)L[v]=p;return String.fromCharCode(...L)};e.exports={toWei:function(e,t=18){if(void 0===e)return e;const i=parseFloat(e).toExponential(),[r,a]=i.split("e"),n=parseInt(a)+t;return s(Math.floor(parseFloat(r+"e"+n)))},fromWei:function(e,t=18){if(void 0===e)return e;const s=Math.floor(e).toExponential(),[i,r]=s.split("e"),a=parseInt(r)-t;return parseFloat(i+"e"+a)},numberToString:s,precisionFromString:a,decimalToPrecision:n,truncate_to_string:r,truncate:(e,t=0)=>parseFloat(r(e,t)),omitZero:function(e){if(void 0!==e&&0!==parseFloat(e))return e},precisionConstants:t,ROUND:0,TRUNCATE:1,ROUND_UP:2,ROUND_DOWN:3,DECIMAL_PLACES:0,SIGNIFICANT_DIGITS:1,TICK_SIZE:2,NO_PADDING:0,PAD_WITH_ZERO:1}},182:(e,t,s)=>{"use strict";var i=s(4155);const r="undefined"!=typeof window,a=void 0!==i&&void 0!==i.versions&&void 0!==i.versions.electron,n="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,o=void 0!==i&&"win32"===i.platform,c=!(r||n),d="undefined"==typeof fetch?s(9323)().fetch:fetch;e.exports={isBrowser:r,isElectron:a,isWebWorker:n,isNode:c,isWindows:o,defaultFetch:d}},9579:e=>{"use strict";const t=e=>e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t),s=e=>e?(e^16*Math.random()>>e/4).toString(16):([1e7]+1e3+4e3+8e5).replace(/[018]/g,s);e.exports={uuid:t,uuid22:s,unCamelCase:e=>e.match(/^[A-Z0-9_]+$/)?e:e.replace(/[a-z0-9][A-Z]/g,(e=>e[0]+"_"+e[1])).replace(/[A-Z0-9][A-Z0-9][a-z]/g,(e=>e[0]+"_"+e[1]+e[2])).toLowerCase(),capitalize:e=>e.length?e.charAt(0).toUpperCase()+e.slice(1):e,strip:e=>e.replace(/^\s+|\s+$/g,"")}},3186:(e,t,s)=>{"use strict";const{sleep:i,now:r}=s(9764);e.exports={throttle:function e(t){let s=r(),a=void 0!==t.numTokens?t.numTokens:t.capacity,n=!1;const o=[];return Object.assign(((e,c)=>{if(o.length>t.maxCapacity)throw new Error("Backlog is over max capacity of "+t.maxCapacity);return new Promise((async(d,h)=>{try{if(o.push({cost:c,resolve:d,reject:h}),!n){for(n=!0;o.length>0;){if((t.capacity?a>0:a>=0)&&o.length>0){let{cost:e,resolve:s,reject:i}=o[0];e=e||t.defaultCost,a>=Math.min(e,t.capacity)&&(a-=e,o.shift(),s())}const n=r(),c=n-s;s=n,a=Math.min(t.capacity,a+c*(1/e)),await i(t.delay)}n=!1}}catch(e){h(e)}}))}),t,{configure:s=>e(Object.assign({},t,s))})}}},9764:e=>{"use strict";const t=Date.now,s=()=>1e3*t(),i=t,r=setTimeout,a=(e,s,i=r,n=t()+s)=>{let o=()=>{},c=!0;const d=i((()=>{c=!0;const s=n-t();s>0?o=a(e,s,i,n):e()}),s);return function(){c&&(c=!1,clearTimeout(d)),o()}};class n extends Error{constructor(){const e="timed out";super(e),this.constructor=n,this.__proto__=n.prototype,this.message=e}}const o=e=>{if("string"==typeof e&&e&&!e.match(/^[0-9]+$/)&&!(e.indexOf("-")<0||e.indexOf(":")<0))try{const t=Date.parse(e.indexOf("+")>=0||"Z"===e.slice(-1)?e:(e+"Z").replace(/\s(\d\d):/,"T$1:"));if(Number.isNaN(t))return;return t}catch(e){return}};e.exports={now:t,microseconds:s,milliseconds:i,seconds:()=>Math.floor(t()/1e3),iso8601:e=>{let t;if(t="number"==typeof e?Math.floor(e):parseInt(e,10),!(Number.isNaN(t)||t<0))try{return new Date(t).toISOString()}catch(e){return}},parse8601:o,rfc2616:e=>new Date(e).toUTCString(),uuidv1:()=>{const e=(10*s()+122192928e9).toString(16);return e.slice(7,15)+e.slice(3,7)+"1"+e.slice(0,3)+"9696"+"ff".repeat(6)},parseDate:e=>{if("string"==typeof e&&e){if(e.indexOf("GMT")>=0)try{return Date.parse(e)}catch(e){return}return o(e)}},mdy:(e,t="-")=>{t=t||"";const s=new Date(e),i=s.getUTCFullYear().toString();let r=s.getUTCMonth()+1,a=s.getUTCDate();return r=r<10?"0"+r:r.toString(),a=a<10?"0"+a:a.toString(),r+t+a+t+i},ymd:(e,t="-")=>{t=t||"";const s=new Date(e),i=s.getUTCFullYear().toString();let r=s.getUTCMonth()+1,a=s.getUTCDate();return r=r<10?"0"+r:r.toString(),a=a<10?"0"+a:a.toString(),i+t+r+t+a},ymdhms:(e,t=" ")=>{const s=new Date(e),i=s.getUTCFullYear();let r=s.getUTCMonth()+1,a=s.getUTCDate(),n=s.getUTCHours(),o=s.getUTCMinutes(),c=s.getUTCSeconds();return r=r<10?"0"+r:r,a=a<10?"0"+a:a,n=n<10?"0"+n:n,o=o<10?"0"+o:o,c=c<10?"0"+c:c,i+"-"+r+"-"+a+t+n+":"+o+":"+c},setTimeout_safe:a,sleep:e=>new Promise((t=>a(t,e))),TimedOut:n,timeout:async(e,t)=>{let s=()=>{};const i=new Promise((t=>s=a(t,e)));try{return await Promise.race([t,i.then((()=>{throw new n}))])}finally{s()}}}},1799:e=>{"use strict";const t=Number.isFinite,s=Number.isInteger,i=Array.isArray,r=e=>null!=e,a=e=>"string"==typeof e,n=e=>null!==e&&"object"==typeof e,o=e=>r(e)&&e.toString||t(e),c=(e,t)=>n(e)?e[t]:void 0,d=(e,t,s)=>n(e)?t in e&&null!==e[t]?e[t]:e[s]:void 0,h=e=>t(e)||a(e)?parseFloat(e):NaN,u=e=>t(e)||a(e)?parseInt(e,10):NaN;e.exports={isNumber:t,isInteger:s,isArray:i,isObject:n,isString:a,isStringCoercible:o,isDictionary:e=>n(e)&&Object.getPrototypeOf(e)===Object.prototype&&!i(e)&&!(e=>e instanceof RegExp)(e),hasProps:r,prop:c,asFloat:h,asInteger:u,safeFloat:(e,s,i,r=h(c(e,s)))=>t(r)?r:i,safeInteger:(e,s,i,r=u(c(e,s)))=>t(r)?r:i,safeIntegerProduct:(e,s,i,r,a=u(c(e,s)))=>t(a)?parseInt(a*i):r,safeTimestamp:(e,s,i,r=h(c(e,s)))=>t(r)?parseInt(1e3*r):i,safeValue:(e,t,s,i=c(e,t))=>r(i)?i:s,safeString:(e,t,s,i=c(e,t))=>o(i)?String(i):s,safeStringLower:(e,t,s,i=c(e,t))=>o(i)?String(i).toLowerCase():s,safeStringUpper:(e,t,s,i=c(e,t))=>o(i)?String(i).toUpperCase():s,safeFloat2:(e,s,i,r,a=h(d(e,s,i)))=>t(a)?a:r,safeInteger2:(e,s,i,r,a=u(d(e,s,i)))=>t(a)?a:r,safeIntegerProduct2:(e,s,i,r,a,n=u(d(e,s,i)))=>t(n)?parseInt(n*r):a,safeTimestamp2:(e,s,i,r,a=h(d(e,s,i)))=>t(a)?parseInt(1e3*a):r,safeValue2:(e,t,s,i,a=d(e,t,s))=>r(a)?a:i,safeString2:(e,t,s,i,r=d(e,t,s))=>o(r)?String(r):i,safeStringLower2:(e,t,s,i,r=d(e,t,s))=>o(r)?String(r).toLowerCase():i,safeStringUpper2:(e,t,s,i,r=d(e,t,s))=>o(r)?String(r).toUpperCase():i}},1366:(e,t,s)=>{"use strict";const i=s(8267);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bequant",name:"Bequant",countries:["MT"],pro:!0,urls:{logo:"https://user-images.githubusercontent.com/1294454/55248342-a75dfe00-525a-11e9-8aa2-05e9dca943c6.jpg",api:{public:"https://api.bequant.io",private:"https://api.bequant.io"},www:"https://bequant.io",doc:["https://api.bequant.io/"],fees:["https://bequant.io/fees-and-limits"],referral:"https://bequant.io"}})}}},7838:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,AccountSuspended:a,ArgumentsRequired:n,AuthenticationError:o,DDoSProtection:c,ExchangeNotAvailable:d,InvalidOrder:h,OrderNotFound:u,PermissionDenied:l,InsufficientFunds:f,BadSymbol:p,RateLimitExceeded:m,BadRequest:b}=s(3449),g=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bibox",name:"Bibox",countries:["CN","US","KR"],version:"v1",hostname:"bibox365.com",has:{cancelOrder:!0,CORS:!1,createMarketOrder:!1,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchDeposits:!0,fetchDepositAddress:!0,fetchFundingFees:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchWithdrawals:!0,publicAPI:!1,withdraw:!0},timeframes:{"1m":"1min","5m":"5min","15m":"15min","30m":"30min","1h":"1hour","2h":"2hour","4h":"4hour","6h":"6hour","12h":"12hour","1d":"day","1w":"week"},urls:{logo:"https://user-images.githubusercontent.com/51840849/77257418-3262b000-6c85-11ea-8fb8-20bdf20b3592.jpg",api:"https://api.{hostname}",www:"https://www.bibox365.com",doc:["https://biboxcom.github.io/en/"],fees:"https://bibox.zendesk.com/hc/en-us/articles/360002336133",referral:"https://w2.bibox365.com/login/register?invite_code=05Kj3I"},api:{public:{post:["mdata"],get:["cquery","mdata","cdata"]},private:{post:["cquery","ctrade","user","orderpending","transfer"]},v2private:{post:["assets/transfer/spot"]}},fees:{trading:{tierBased:!1,percentage:!0,taker:.001,maker:8e-4},funding:{tierBased:!1,percentage:!1,withdraw:{},deposit:{}}},exceptions:{2011:a,2015:o,2021:f,2027:f,2033:u,2065:h,2066:h,2067:h,2068:h,2078:h,2085:h,2091:m,2092:h,3e3:b,3002:b,3012:o,3016:p,3024:l,3025:o,4e3:d,4003:c},commonCurrencies:{"APENFT(NFT)":"NFT",BOX:"DefiBox",BPT:"BlockPool Token",GTC:"Game.com",KEY:"Bihu",MTC:"MTC Mesh Network",NFT:"NFT Protocol",PAI:"PCHAIN",TERN:"Ternio-ERC20"},options:{fetchCurrencies:"fetch_currencies_public"}})}async fetchMarkets(e={}){const t=await this.publicGetMdata(this.extend({cmd:"marketAll"},e)),s=this.safeValue(t,"result"),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeInteger(t,"id"),a=this.safeString(t,"coin_symbol"),n=this.safeString(t,"currency_symbol"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d=o+"/"+c,h=a+"_"+n,u={amount:4,price:8};i.push({id:h,numericId:r,symbol:d,base:o,quote:c,baseId:a,quoteId:n,active:!0,info:t,precision:u,limits:{amount:{min:Math.pow(10,-u.amount),max:void 0},price:{min:Math.pow(10,-u.price),max:void 0}}})}return i}parseTicker(e,t){const s=this.safeInteger(e,"timestamp");let i;if(void 0!==t)i=t.symbol;else{const t=this.safeString(e,"coin_symbol"),s=this.safeString(e,"currency_symbol");i=this.safeCurrencyCode(t)+"/"+this.safeCurrencyCode(s)}const r=this.safeNumber(e,"last"),a=this.safeNumber(e,"change"),n=this.safeNumber2(e,"vol","vol24H");let o;void 0!==r&&void 0!==a&&(o=r-a);let c=this.safeString(e,"percent");return void 0!==c&&(c=c.replace("%",""),c=parseFloat(c)),{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"buy"),bidVolume:void 0,ask:this.safeNumber(e,"sell"),askVolume:void 0,vwap:void 0,open:o,close:r,last:r,previousClose:void 0,change:a,percentage:c,average:void 0,baseVolume:n,quoteVolume:this.safeNumber(e,"amount"),info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={cmd:"ticker",pair:s.id},r=await this.publicGetMdata(this.extend(i,t));return this.parseTicker(r.result,s)}async fetchTickers(e,t={}){const s=await this.publicGetMdata(this.extend({cmd:"marketAll"},t)),i=this.parseTickers(s.result,e),r=this.indexBy(i,"symbol");return this.filterByArray(r,"symbol",e)}parseTrade(e,t){const s=this.safeInteger2(e,"time","createdAt");let i,r,a=this.safeInteger2(e,"side","order_side");if(a=1===a?"buy":"sell",void 0===t){let s=this.safeString(e,"pair");if(void 0===s){const t=this.safeString(e,"coin_symbol"),i=this.safeString(e,"currency_symbol");void 0!==t&&void 0!==i&&(s=t+"_"+i)}s in this.markets_by_id&&(t=this.markets_by_id[s])}void 0!==t&&(i=t.symbol);const n=this.safeNumber(e,"fee");let o=this.safeString(e,"fee_symbol");void 0!==o&&(o=o in this.currencies_by_id?this.currencies_by_id[o].code:this.safeCurrencyCode(o));const c=this.safeString(e,"price"),d=this.safeString(e,"amount"),h=this.parseNumber(c),u=this.parseNumber(d),l=this.parseNumber(g.stringMul(c,d));void 0!==n&&(r={cost:-n,currency:o,rate:undefined});return{info:e,id:this.safeString(e,"id"),order:void 0,timestamp:s,datetime:this.iso8601(s),symbol:i,type:"limit",takerOrMaker:void 0,side:a,price:h,amount:u,cost:l,fee:r}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={cmd:"deals",pair:r.id};void 0!==s&&(a.size=s);const n=await this.publicGetMdata(this.extend(a,i));return this.parseTrades(n.result,r,t,s)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={cmd:"depth",pair:this.market(e).id};void 0!==t&&(i.size=t);const r=await this.publicGetMdata(this.extend(i,s));return this.parseOrderBook(r.result,e,this.safeNumber(r.result,"update_time"),"bids","asks","price","volume")}parseOHLCV(e,t){return[this.safeInteger(e,"time"),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"vol")]}async fetchOHLCV(e,t="1m",s,i=1e3,r={}){await this.loadMarkets();const a=this.market(e),n={cmd:"kline",pair:a.id,period:this.timeframes[t],size:i},o=await this.publicGetMdata(this.extend(n,r)),c=this.safeValue(o,"result",[]);return this.parseOHLCVs(c,a,t,s,i)}async fetchCurrencies(e={}){const t=this.safeString(this.options,"fetchCurrencies","fetch_currencies_public");return await this[t](e)}async fetchCurrenciesPublic(e={}){const t=await this.publicGetCdata(this.extend({cmd:"currencies"},e)),s=this.safeValue(t,"result"),i={};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"symbol"),a=this.safeString(t,"name"),n=this.safeCurrencyCode(r),o=this.safeInteger(t,"valid_decimals"),c=this.safeValue(t,"enable_deposit"),d=this.safeValue(t,"enable_withdraw"),h=c&&d;i[n]={id:r,code:n,info:t,name:a,active:h,fee:void 0,precision:o,limits:{amount:{min:Math.pow(10,-o),max:void 0},withdraw:{min:this.safeNumber(t,"withdraw_min"),max:void 0}}}}return i}async fetchCurrenciesPrivate(e={}){if(!this.apiKey||!this.secret)throw new o(this.id+" fetchCurrencies is an authenticated endpoint, therefore it requires 'apiKey' and 'secret' credentials. If you don't need currency details, set exchange.has['fetchCurrencies'] = false before calling its methods.");const t=await this.privatePostTransfer(this.extend({cmd:"transfer/coinList",body:{}},e)),s=this.safeValue(t,"result"),i={};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"symbol"),a=t.name,n=this.safeCurrencyCode(r),o=8,c=this.safeValue(t,"enable_deposit"),d=this.safeValue(t,"enable_withdraw"),h=c&&d;i[n]={id:r,code:n,info:t,name:a,active:h,fee:void 0,precision:o,limits:{amount:{min:Math.pow(10,-o),max:Math.pow(10,o)},withdraw:{min:void 0,max:Math.pow(10,o)}}}}return i}async fetchBalance(e={}){await this.loadMarkets();const t=this.safeString(e,"type","assets");e=this.omit(e,"type");const s={cmd:"transfer/"+t,body:this.extend({select:1},e)},i=await this.privatePostTransfer(s),r=this.safeValue(i,"result"),a={info:r};let n;n="assets_list"in r?this.indexBy(r.assets_list,"coin_symbol"):r;const o=Object.keys(n);for(let e=0;e<o.length;e++){const t=o[e];let s=t.toUpperCase();s.indexOf("TOTAL_")>=0&&(s=s.slice(6)),s in this.currencies_by_id&&(s=this.currencies_by_id[s].code);const i=this.account(),r=n[t];"string"==typeof r?(i.free=r,i.total=r):(i.free=this.safeString(r,"balance"),i.used=this.safeString(r,"freeze")),a[s]=i}return this.parseBalance(a,!1)}async fetchDeposits(e,t,s,i={}){let r;await this.loadMarkets();const a={page:1};void 0!==e&&(r=this.currency(e),a.symbol=r.id),a.size=void 0!==s?s:100;const n=await this.privatePostTransfer({cmd:"transfer/transferInList",body:this.extend(a,i)}),o=this.safeValue(n.result,"items",[]);for(let e=0;e<o.length;e++)o[e].type="deposit";return this.parseTransactions(o,r,t,s)}async fetchWithdrawals(e,t,s,i={}){let r;await this.loadMarkets();const a={page:1};void 0!==e&&(r=this.currency(e),a.symbol=r.id),a.size=void 0!==s?s:100;const n=await this.privatePostTransfer({cmd:"transfer/transferOutList",body:this.extend(a,i)}),o=this.safeValue(n.result,"items",[]);for(let e=0;e<o.length;e++)o[e].type="withdrawal";return this.parseTransactions(o,r,t,s)}parseTransaction(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"to_address"),r=this.safeString(e,"coin_symbol"),a=this.safeCurrencyCode(r,t),n=this.safeString(e,"createdAt");let o=this.safeString(e,"addr_remark");const c=this.safeString(e,"type"),d=this.parseTransactionStatusByType(this.safeString(e,"status"),c),h=this.safeNumber(e,"amount");let u=this.safeNumber(e,"fee");"deposit"===c&&(u=0,o=void 0);const l={cost:u,currency:a};return{info:e,id:s,txid:void 0,timestamp:n,datetime:this.iso8601(n),address:i,tag:o,type:c,amount:h,currency:a,status:d,updated:void 0,fee:l}}parseTransactionStatusByType(e,t){return this.safeString(this.safeValue({deposit:{1:"pending",2:"ok"},withdrawal:{0:"pending",3:"ok"}},t,{}),e,e)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o="limit"===t?2:1,c="buy"===s?1:2,d={cmd:"orderpending/trade",body:this.extend({pair:n.id,account_type:0,order_type:o,order_side:c,pay_bix:0,amount:i,price:r},a)},h=await this.privatePostOrderpending(d);return{info:h,id:this.safeString(h,"result")}}async cancelOrder(e,t,s={}){const i={cmd:"orderpending/cancelTrade",body:this.extend({orders_id:e},s)};return await this.privatePostOrderpending(i)}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={cmd:"orderpending/order",body:this.extend({id:e.toString(),account_type:0},s)},r=await this.privatePostOrderpending(i),a=this.safeValue(r,"result");if(this.isEmpty(a))throw new u(this.id+" order "+e+" not found");return this.parseOrder(a)}parseOrder(e,t){let s;if(void 0===t){let s;const i=this.safeString(e,"coin_symbol"),r=this.safeString(e,"currency_symbol");void 0!==i&&void 0!==r&&(s=i+"_"+r),s in this.markets_by_id&&(t=this.markets_by_id[s])}void 0!==t&&(s=t.symbol);const i="1"===this.safeString(e,"order_type")?"market":"limit",r=this.safeInteger(e,"createdAt"),a=this.safeNumber(e,"price"),n=this.safeNumber(e,"deal_price"),o=this.safeNumber(e,"deal_amount"),c=this.safeNumber(e,"amount"),d=this.safeNumber2(e,"deal_money","money"),h="1"===this.safeString(e,"order_side")?"buy":"sell",u=this.parseOrderStatus(this.safeString(e,"status")),l=this.safeString(e,"id"),f=this.safeNumber(e,"fee");let p;return void 0!==f&&(p={cost:f,currency:void 0}),this.safeOrder({info:e,id:l,clientOrderId:void 0,timestamp:r,datetime:this.iso8601(r),lastTradeTimestamp:void 0,symbol:s,type:i,timeInForce:void 0,postOnly:void 0,side:h,price:a,stopPrice:void 0,amount:c,cost:d,average:n,filled:o,remaining:void 0,status:u,fee:p,trades:void 0})}parseOrderStatus(e){return this.safeString({1:"open",2:"open",3:"closed",4:"canceled",5:"canceled",6:"canceled"},e,e)}async fetchOpenOrders(e,t,s,i={}){let r,a;await this.loadMarkets(),void 0!==e&&(r=this.market(e),a=r.id);const n=s||200,o={cmd:"orderpending/orderPendingList",body:this.extend({pair:a,account_type:0,page:1,size:n},i)},c=await this.privatePostOrderpending(o),d=this.safeValue(c.result,"items",[]);return this.parseOrders(d,r,t,s)}async fetchClosedOrders(e,t,s=200,i={}){if(void 0===e)throw new n(this.id+" fetchClosedOrders() requires a `symbol` argument");await this.loadMarkets();const r=this.market(e),a={cmd:"orderpending/pendingHistoryList",body:this.extend({pair:r.id,account_type:0,page:1,size:s},i)},o=await this.privatePostOrderpending(a),c=this.safeValue(o.result,"items",[]);return this.parseOrders(c,r,t,s)}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new n(this.id+" fetchMyTrades() requires a `symbol` argument");await this.loadMarkets();const r=this.market(e),a=s||200,o={cmd:"orderpending/orderHistoryList",body:this.extend({pair:r.id,account_type:0,page:1,size:a,coin_symbol:r.baseId,currency_symbol:r.quoteId},i)},c=await this.privatePostOrderpending(o),d=this.safeValue(c.result,"items",[]);return this.parseTrades(d,r,t,s)}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e),i={cmd:"transfer/transferIn",body:this.extend({coin_symbol:s.id},t)},r=await this.privatePostTransfer(i),a=this.safeString(r,"result");let n,o=a;if(this.isJsonEncodedObject(a)){const e=JSON.parse(a);o=this.safeString(e,"account"),n=this.safeString(e,"memo")}return{currency:e,address:o,tag:n,info:r}}async withdraw(e,t,s,i,a={}){this.checkAddress(s),await this.loadMarkets();const n=this.currency(e);if(void 0===this.password&&!("trade_pwd"in a))throw new r(this.id+" withdraw() requires this.password set on the exchange instance or a trade_pwd parameter");if(!("totp_code"in a))throw new r(this.id+" withdraw() requires a totp_code parameter for 2FA authentication");const o={trade_pwd:this.password,coin_symbol:n.id,amount:t,addr:s};void 0!==i&&(o.address_remark=i);return{info:await this.privatePostTransfer({cmd:"transfer/transferOut",body:this.extend(o,a)}),id:void 0}}async fetchFundingFees(e,t={}){await this.loadMarkets();const s={},i={};void 0===e&&(e=Object.keys(this.currencies));for(let r=0;r<e.length;r++){const a=e[r],n=this.currency(a),o={cmd:"transfer/coinConfig",body:this.extend({coin_symbol:n.id},t)},c=await this.privatePostTransfer(o);i[a]=c,s[a]=this.safeNumber(c.result,"withdraw_fee")}return{info:i,withdraw:s,deposit:{}}}sign(e,t="public",s="GET",i={},r,a){let n=this.implodeParams(this.urls.api,{hostname:this.hostname})+"/"+this.version+"/"+e;const o=this.json([i]);if("public"===t)"GET"!==s?a={cmds:o}:Object.keys(i).length&&(n+="?"+this.urlencode(i));else if("v2private"===t){this.checkRequiredCredentials(),n=this.implodeParams(this.urls.api,{hostname:this.hostname})+"/v2/"+e;const t=this.json(i);a={body:t,apikey:this.apiKey,sign:this.hmac(this.encode(t),this.encode(this.secret),"md5")}}else this.checkRequiredCredentials(),a={cmds:o,apikey:this.apiKey,sign:this.hmac(this.encode(o),this.encode(this.secret),"md5")};return void 0!==a&&(a=this.json(a,{convertArraysToObjects:!0})),{url:n,method:s,body:a,headers:{"Content-Type":"application/json"}}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0!==o){if("error"in o){if("code"in o.error){const e=this.safeString(o.error,"code"),t=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions,e,t),new r(t)}throw new r(this.id+" "+n)}if(!("result"in o))throw new r(this.id+" "+n)}}async request(e,t="public",s="GET",i={},r,a){const n=await this.fetch2(e,t,s,i,r,a);return"GET"===s?n:n.result[0]}}},4400:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,AuthenticationError:n,OrderNotFound:o,InsufficientFunds:c,PermissionDenied:d,BadRequest:h,RateLimitExceeded:u,InvalidOrder:l}=s(3449),f=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bigone",name:"BigONE",countries:["CN"],version:"v3",rateLimit:1200,has:{cancelAllOrders:!0,cancelOrder:!0,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrders:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchWithdrawals:!0,withdraw:!0},timeframes:{"1m":"min1","5m":"min5","15m":"min15","30m":"min30","1h":"hour1","3h":"hour3","4h":"hour4","6h":"hour6","12h":"hour12","1d":"day1","1w":"week1","1M":"month1"},hostname:"big.one",urls:{logo:"https://user-images.githubusercontent.com/1294454/69354403-1d532180-0c91-11ea-88ed-44c06cefdf87.jpg",api:{public:"https://{hostname}/api/v3",private:"https://{hostname}/api/v3/viewer"},www:"https://big.one",doc:"https://open.big.one/docs/api.html",fees:"https://bigone.zendesk.com/hc/en-us/articles/115001933374-BigONE-Fee-Policy",referral:"https://b1.run/users/new?code=D3LLBVFT"},api:{public:{get:["ping","asset_pairs","asset_pairs/{asset_pair_name}/depth","asset_pairs/{asset_pair_name}/trades","asset_pairs/{asset_pair_name}/ticker","asset_pairs/{asset_pair_name}/candles","asset_pairs/tickers"]},private:{get:["accounts","fund/accounts","assets/{asset_symbol}/address","orders","orders/{id}","orders/multi","trades","withdrawals","deposits"],post:["orders","orders/{id}/cancel","orders/cancel","withdrawals","transfer"]}},fees:{trading:{maker:.001,taker:.001},funding:{withdraw:{BTC:.001,ETH:.005,EOS:.01,ZEC:.003,LTC:.01,QTUM:.01,ETC:.01,GAS:0,BTS:1,GXS:.1,BITCNY:19}}},exceptions:{exact:{10001:h,10005:r,"Amount's scale must greater than AssetPair's base scale":l,10007:h,10011:r,10013:o,10014:c,10403:d,10429:u,40004:n,40103:n,40104:n,40301:d,40302:r,40601:r,40602:r,40603:c,40120:l,40121:l},broad:{}},commonCurrencies:{MBN:"Mobilian Coin",ONE:"BigONE Token"}})}async fetchMarkets(e={}){const t=await this.publicGetAssetPairs(e),s=this.safeValue(t,"data",[]),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"name"),a=this.safeString(t,"id"),n=this.safeValue(t,"base_asset",{}),o=this.safeValue(t,"quote_asset",{}),c=this.safeString(n,"symbol"),d=this.safeString(o,"symbol"),h=this.safeCurrencyCode(c),u=this.safeCurrencyCode(d),l=h+"/"+u,f=this.safeString(t,"base_scale"),p=this.safeString(t,"quote_scale"),m=this.parsePrecision(f),b=this.parsePrecision(p),g={amount:parseInt(f),price:parseInt(p)},y=this.safeInteger(t,"min_quote_value"),v={id:r,uuid:a,symbol:l,base:h,quote:u,baseId:c,quoteId:d,active:!0,precision:g,limits:{amount:{min:this.parseNumber(m),max:void 0},price:{min:this.parseNumber(b),max:void 0},cost:{min:y,max:void 0}},info:t};i.push(v)}return i}async loadMarkets(e=!1,t={}){const s=await super.loadMarkets(e,t);let i=this.safeValue(this.options,"marketsByUuid");if(void 0===i||e){i={};for(let e=0;e<this.symbols.length;e++){const t=this.symbols[e],s=this.markets[t];i[this.safeString(s,"uuid")]=s}this.options.marketsByUuid=i}return s}parseTicker(e,t){const s=this.safeString(e,"asset_pair_name"),i=this.safeSymbol(s,t,"-"),r=void 0,a=this.safeNumber(e,"close"),n=this.safeValue(e,"bid",{}),o=this.safeValue(e,"ask",{});return{symbol:i,timestamp:r,datetime:this.iso8601(r),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(n,"price"),bidVolume:this.safeNumber(n,"quantity"),ask:this.safeNumber(o,"price"),askVolume:this.safeNumber(o,"quantity"),vwap:void 0,open:this.safeNumber(e,"open"),close:a,last:a,previousClose:void 0,change:this.safeNumber(e,"daily_change"),percentage:void 0,average:void 0,baseVolume:this.safeNumber(e,"volume"),quoteVolume:void 0,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={asset_pair_name:s.id},r=await this.publicGetAssetPairsAssetPairNameTicker(this.extend(i,t)),a=this.safeValue(r,"data",{});return this.parseTicker(a,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s={};if(void 0!==e){const t=this.marketIds(e);s.pair_names=t.join(",")}const i=await this.publicGetAssetPairsTickers(this.extend(s,t)),r=this.safeValue(i,"data",[]),a={};for(let e=0;e<r.length;e++){const t=this.parseTicker(r[e]);a[t.symbol]=t}return this.filterByArray(a,"symbol",e)}async fetchTime(e={}){const t=await this.publicGetPing(e),s=this.safeValue(t,"data",{}),i=this.safeInteger(s,"timestamp");return parseInt(i/1e6)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={asset_pair_name:this.market(e).id};void 0!==t&&(i.limit=t);const r=await this.publicGetAssetPairsAssetPairNameDepth(this.extend(i,s)),a=this.safeValue(r,"data",{});return this.parseOrderBook(a,e,void 0,"bids","asks","price","quantity")}parseTrade(e,t){const s=this.parse8601(this.safeString2(e,"created_at","inserted_at")),i=this.safeString(e,"price"),r=this.safeString(e,"amount"),a=this.parseNumber(i),n=this.parseNumber(r),o=this.parseNumber(f.stringMul(i,r)),c=this.safeString(e,"asset_pair_name"),d=this.safeSymbol(c,t,"-");let h=this.safeString(e,"side");const u=this.safeString(e,"taker_side");let l;void 0!==u&&void 0!==h&&"SELF_TRADING"!==h&&(l=u===h?"taker":"maker"),void 0===h?h="ASK"===u?"sell":"buy":"BID"===h?h="buy":"ASK"===h&&(h="sell");const p=this.safeString(e,"maker_order_id"),m=this.safeString(e,"taker_order_id");let b;void 0!==p?b=void 0!==m?[p,m]:p:void 0!==m&&(b=m);const g={id:this.safeString(e,"id"),timestamp:s,datetime:this.iso8601(s),symbol:d,order:b,type:"limit",side:h,takerOrMaker:l,price:a,amount:n,cost:parseFloat(o),info:e};let y,v;void 0!==t&&void 0!==l?"buy"===h?"maker"===l?(y=t.base,v=t.quote):(y=t.quote,v=t.base):"maker"===l?(y=t.quote,v=t.base):(y=t.base,v=t.quote):"SELF_TRADING"===h&&("BID"===u?(y=t.quote,v=t.base):"ASK"===u&&(y=t.base,v=t.quote));const w=this.safeNumber(e,"maker_fee"),k=this.safeNumber(e,"taker_fee");return void 0!==w?void 0!==k?g.fees=[{cost:w,currency:y},{cost:k,currency:v}]:g.fee={cost:w,currency:y}:g.fee=void 0!==k?{cost:k,currency:v}:void 0,g}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={asset_pair_name:r.id},n=await this.publicGetAssetPairsAssetPairNameTrades(this.extend(a,i)),o=this.safeValue(n,"data",[]);return this.parseTrades(o,r,t,s)}parseOHLCV(e,t){return[this.parse8601(this.safeString(e,"time")),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e);void 0===i&&(i=100);const n={asset_pair_name:a.id,period:this.timeframes[t],limit:i};if(void 0!==s){const e=this.sum(s,i*this.parseTimeframe(t)*1e3);n.time=this.iso8601(e)}const o=await this.publicGetAssetPairsAssetPairNameCandles(this.extend(n,r)),c=this.safeValue(o,"data",[]);return this.parseOHLCVs(c,a,t,s,i)}async fetchBalance(e={}){await this.loadMarkets();const t=this.safeString(e,"type","");e=this.omit(e,"type");const s="privateGet"+this.capitalize(t)+"Accounts",i=await this[s](e),r={info:i,timestamp:void 0,datetime:void 0},a=this.safeValue(i,"data",[]);for(let e=0;e<a.length;e++){const t=a[e],s=this.safeString(t,"asset_symbol"),i=this.safeCurrencyCode(s),n=this.account();n.total=this.safeString(t,"balance"),n.used=this.safeString(t,"locked_balance"),r[i]=n}return this.parseBalance(r,!1)}parseOrder(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"asset_pair_name"),r=this.safeSymbol(i,t,"-"),a=this.parse8601(this.safeString(e,"created_at")),n=this.safeNumber(e,"price"),o=this.safeNumber(e,"amount"),c=this.safeNumber(e,"filled_amount"),d=this.parseOrderStatus(this.safeString(e,"state"));let h=this.safeString(e,"side");h="BID"===h?"buy":"sell";const u=this.parse8601(this.safeString(e,"updated_at")),l=this.safeNumber(e,"avg_deal_price");return this.safeOrder({info:e,id:s,clientOrderId:void 0,timestamp:a,datetime:this.iso8601(a),lastTradeTimestamp:u,symbol:r,type:void 0,timeInForce:void 0,postOnly:void 0,side:h,price:n,stopPrice:void 0,amount:o,cost:void 0,average:l,filled:c,remaining:void 0,status:d,fee:void 0,trades:void 0})}async createOrder(e,t,s,i,r,n={}){await this.loadMarkets();const o=this.market(e);s="buy"===s?"BID":"ASK";const c=t.toUpperCase(),d={asset_pair_name:o.id,side:s,amount:this.amountToPrecision(e,i),type:c};if("LIMIT"===c)d.price=this.priceToPrecision(e,r);else{const t="STOP_LIMIT"===c,s="STOP_MARKET"===c;if(t||s){const t=this.safeNumber2(n,"stop_price","stopPrice");if(void 0===t)throw new a(this.id+" createOrder() requires a stop_price parameter");d.stop_price=this.priceToPrecision(e,t),n=this.omit(n,["stop_price","stopPrice"])}t&&(d.price=this.priceToPrecision(e,r))}const h=await this.privatePostOrders(this.extend(d,n)),u=this.safeValue(h,"data");return this.parseOrder(u,o)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={id:e},r=await this.privatePostOrdersIdCancel(this.extend(i,s)),a=this.safeValue(r,"data");return this.parseOrder(a)}async cancelAllOrders(e,t={}){await this.loadMarkets();const s={asset_pair_name:this.market(e).id};return await this.privatePostOrdersCancel(this.extend(s,t))}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={id:e},r=await this.privateGetOrdersId(this.extend(i,s)),a=this.safeValue(r,"data",{});return this.parseOrder(a)}async fetchOrders(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),n={asset_pair_name:r.id};void 0!==s&&(n.limit=s);const o=await this.privateGetOrders(this.extend(n,i)),c=this.safeValue(o,"data",[]);return this.parseOrders(c,r,t,s)}async fetchMyTrades(e,t,s,i={}){if(await this.loadMarkets(),void 0===e)throw new a(this.id+" fetchMyTrades() requires a symbol argument");const r=this.market(e),n={asset_pair_name:r.id};void 0!==s&&(n.limit=s);const o=await this.privateGetTrades(this.extend(n,i)),c=this.safeValue(o,"data",[]);return this.parseTrades(c,r,t,s)}parseOrderStatus(e){return this.safeString({PENDING:"open",FILLED:"closed",CANCELLED:"canceled"},e)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({state:"PENDING"},i))}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({state:"FILLED"},i))}nonce(){return 1e3*this.microseconds()}sign(e,t="public",s="GET",i={},r,a){const n=this.omit(i,this.extractParams(e));let o=this.implodeParams(this.urls.api[t],{hostname:this.hostname})+"/"+this.implodeParams(e,i);if("public"===t)Object.keys(n).length&&(o+="?"+this.urlencode(n));else{this.checkRequiredCredentials();const e=this.nonce().toString(),t={type:"OpenAPIV2",sub:this.apiKey,nonce:e};r={Authorization:"Bearer "+this.jwt(t,this.encode(this.secret))},"GET"===s?Object.keys(n).length&&(o+="?"+this.urlencode(n)):"POST"===s&&(r["Content-Type"]="application/json",a=this.json(n))}return{url:o,method:s,body:a,headers:r}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={asset_symbol:this.currency(e).id},i=await this.privateGetAssetsAssetSymbolAddress(this.extend(s,t)),a=this.safeValue(i,"data",[]);if(a.length<1)throw new r(this.id+"fetchDepositAddress() returned empty address response");const n=a[0],o=this.safeString(n,"value"),c=this.safeString(n,"memo");return this.checkAddress(o),{currency:e,address:o,tag:c,info:i}}parseTransactionStatus(e){return this.safeString({WITHHOLD:"ok",UNCONFIRMED:"pending",CONFIRMED:"ok"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"asset_symbol"),i=this.safeCurrencyCode(s),r=this.safeInteger(e,"id"),a=this.safeNumber(e,"amount"),n=this.parseTransactionStatus(this.safeString(e,"state")),o=this.parse8601(this.safeString(e,"inserted_at")),c=this.parse8601(this.safeString2(e,"updated_at","completed_at")),d=this.safeString(e,"txid"),h=this.safeString(e,"target_address"),u=this.safeString(e,"memo"),l="customer_id"in e?"deposit":"withdrawal";return{info:e,id:r,txid:d,timestamp:o,datetime:this.iso8601(o),addressFrom:void 0,address:void 0,addressTo:h,tagFrom:void 0,tag:u,tagTo:void 0,type:l,amount:a,currency:i,status:n,updated:c,fee:void 0}}async fetchDeposits(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.asset_symbol=a.id),void 0!==s&&(r.limit=s);const n=await this.privateGetDeposits(this.extend(r,i)),o=this.safeValue(n,"data",[]);return this.parseTransactions(o,e,t,s)}async fetchWithdrawals(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.asset_symbol=a.id),void 0!==s&&(r.limit=s);const n=await this.privateGetWithdrawals(this.extend(r,i)),o=this.safeValue(n,"data",[]);return this.parseTransactions(o,e,t,s)}async withdraw(e,t,s,i,r={}){await this.loadMarkets();const a=this.currency(e),n={symbol:a.id,target_address:s,amount:this.currencyToPrecision(e,t)};void 0!==i&&(n.memo=i);const o=await this.privatePostWithdrawals(this.extend(n,r)),c=this.safeValue(o,"data",{});return this.parseTransaction(c,a)}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0===o)return;const h=this.safeString(o,"code"),u=this.safeString(o,"message");if("0"!==h){const e=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,u,e),this.throwExactlyMatchedException(this.exceptions.exact,h,e),this.throwBroadlyMatchedException(this.exceptions.broad,u,e),new r(e)}}}},6056:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,ExchangeNotAvailable:n,InsufficientFunds:o,OrderNotFound:c,InvalidOrder:d,DDoSProtection:h,InvalidNonce:u,AuthenticationError:l,RateLimitExceeded:f,PermissionDenied:p,NotSupported:m,BadRequest:b,BadSymbol:g,AccountSuspended:y,OrderImmediatelyFillable:v}=s(3449),{TRUNCATE:w}=s(2115),k=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"binance",name:"Binance",countries:["JP","MT"],rateLimit:500,certified:!0,pro:!0,has:{cancelAllOrders:!0,cancelOrder:!0,CORS:!1,createOrder:!0,fetchCurrencies:!0,fetchBalance:!0,fetchBidsAsks:!0,fetchClosedOrders:"emulated",fetchDepositAddress:!0,fetchDeposits:!0,fetchFundingFees:!0,fetchFundingHistory:!0,fetchFundingRate:!0,fetchFundingRates:!0,fetchIsolatedPositions:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrders:!0,fetchOrderBook:!0,fetchPositions:!0,fetchStatus:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTradingFee:!0,fetchTradingFees:!0,fetchTransactions:!1,fetchWithdrawals:!0,setLeverage:!0,setMarginMode:!0,withdraw:!0,transfer:!0,fetchTransfers:!0},timeframes:{"1m":"1m","3m":"3m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","2h":"2h","4h":"4h","6h":"6h","8h":"8h","12h":"12h","1d":"1d","3d":"3d","1w":"1w","1M":"1M"},urls:{logo:"https://user-images.githubusercontent.com/1294454/29604020-d5483cdc-87ee-11e7-94c7-d1a8d9169293.jpg",test:{dapiPublic:"https://testnet.binancefuture.com/dapi/v1",dapiPrivate:"https://testnet.binancefuture.com/dapi/v1",fapiPublic:"https://testnet.binancefuture.com/fapi/v1",fapiPrivate:"https://testnet.binancefuture.com/fapi/v1",fapiPrivateV2:"https://testnet.binancefuture.com/fapi/v2",public:"https://testnet.binance.vision/api/v3",private:"https://testnet.binance.vision/api/v3",v3:"https://testnet.binance.vision/api/v3",v1:"https://testnet.binance.vision/api/v1"},api:{wapi:"https://api.binance.com/wapi/v3",sapi:"https://api.binance.com/sapi/v1",dapiPublic:"https://dapi.binance.com/dapi/v1",dapiPrivate:"https://dapi.binance.com/dapi/v1",dapiPrivateV2:"https://dapi.binance.com/dapi/v2",dapiData:"https://dapi.binance.com/futures/data",fapiPublic:"https://fapi.binance.com/fapi/v1",fapiPrivate:"https://fapi.binance.com/fapi/v1",fapiData:"https://fapi.binance.com/futures/data",fapiPrivateV2:"https://fapi.binance.com/fapi/v2",public:"https://api.binance.com/api/v3",private:"https://api.binance.com/api/v3",v3:"https://api.binance.com/api/v3",v1:"https://api.binance.com/api/v1"},www:"https://www.binance.com",referral:{url:"https://www.binance.com/en/register?ref=BLEJC98C",discount:.2},doc:["https://binance-docs.github.io/apidocs/spot/en"],api_management:"https://www.binance.com/en/usercenter/settings/api-management",fees:"https://www.binance.com/en/fee/schedule"},api:{sapi:{get:["accountSnapshot","margin/asset","margin/pair","margin/allAssets","margin/allPairs","margin/priceIndex","asset/assetDividend","asset/transfer","asset/assetDetail","asset/tradeFee","margin/loan","margin/repay","margin/account","margin/transfer","margin/interestHistory","margin/forceLiquidationRec","margin/order","margin/openOrders","margin/allOrders","margin/myTrades","margin/maxBorrowable","margin/maxTransferable","margin/isolated/transfer","margin/isolated/account","margin/isolated/pair","margin/isolated/allPairs","margin/interestRateHistory","fiatpayment/query/deposit/history","fiatpayment/query/withdraw/history","futures/transfer","futures/loan/borrow/history","futures/loan/repay/history","futures/loan/wallet","futures/loan/configs","futures/loan/calcAdjustLevel","futures/loan/calcMaxAdjustAmount","futures/loan/adjustCollateral/history","futures/loan/liquidationHistory","capital/config/getall","capital/deposit/address","capital/deposit/hisrec","capital/deposit/subAddress","capital/deposit/subHisrec","capital/withdraw/history","bnbBurn","sub-account/assets","sub-account/futures/account","sub-account/futures/accountSummary","sub-account/futures/positionRisk","sub-account/futures/internalTransfer","sub-account/margin/account","sub-account/margin/accountSummary","sub-account/spotSummary","sub-account/status","sub-account/transfer/subUserHistory","sub-account/universalTransfer","lending/daily/product/list","lending/daily/userLeftQuota","lending/daily/userRedemptionQuota","lending/daily/token/position","lending/union/account","lending/union/purchaseRecord","lending/union/redemptionRecord","lending/union/interestHistory","lending/project/list","lending/project/position/list","mining/pub/algoList","mining/pub/coinList","mining/worker/detail","mining/worker/list","mining/payment/list","mining/statistics/user/status","mining/statistics/user/list","bswap/pools","bswap/liquidity","bswap/liquidityOps","bswap/quote","bswap/swap","blvt/tokenInfo","blvt/subscribe/record","blvt/redeem/record","blvt/userLimit","apiReferral/ifNewUser","apiReferral/customization","apiReferral/userCustomization","apiReferral/rebate/recentRecord","apiReferral/rebate/historicalRecord","apiReferral/kickback/recentRecord","apiReferral/kickback/historicalRecord","broker/subAccountApi","broker/subAccount","broker/subAccountApi/commission/futures","broker/subAccountApi/commission/coinFutures","broker/info","broker/transfer","broker/transfer/futures","broker/rebate/recentRecord","broker/rebate/historicalRecord","broker/subAccount/bnbBurn/status","broker/subAccount/depositHist","broker/subAccount/spotSummary","broker/subAccount/marginSummary","broker/subAccount/futuresSummary","broker/rebate/futures/recentRecord","broker/subAccountApi/ipRestriction","broker/universalTransfer"],post:["asset/dust","asset/transfer","account/disableFastWithdrawSwitch","account/enableFastWithdrawSwitch","capital/withdraw/apply","margin/transfer","margin/loan","margin/repay","margin/order","margin/isolated/create","margin/isolated/transfer","bnbBurn","sub-account/margin/transfer","sub-account/margin/enable","sub-account/margin/enable","sub-account/futures/enable","sub-account/futures/transfer","sub-account/futures/internalTransfer","sub-account/transfer/subToSub","sub-account/transfer/subToMaster","sub-account/universalTransfer","userDataStream","userDataStream/isolated","futures/transfer","futures/loan/borrow","futures/loan/repay","futures/loan/adjustCollateral","lending/customizedFixed/purchase","lending/daily/purchase","lending/daily/redeem","bswap/liquidityAdd","bswap/liquidityRemove","bswap/swap","blvt/subscribe","blvt/redeem","apiReferral/customization","apiReferral/userCustomization","apiReferral/rebate/historicalRecord","apiReferral/kickback/historicalRecord","broker/subAccount","broker/subAccount/margin","broker/subAccount/futures","broker/subAccountApi","broker/subAccountApi/permission","broker/subAccountApi/commission","broker/subAccountApi/commission/futures","broker/subAccountApi/commission/coinFutures","broker/transfer","broker/transfer/futures","broker/rebate/historicalRecord","broker/subAccount/bnbBurn/spot","broker/subAccount/bnbBurn/marginInterest","broker/subAccount/blvt","broker/subAccountApi/ipRestriction","broker/subAccountApi/ipRestriction/ipList","broker/universalTransfer","broker/subAccountApi/permission/universalTransfer","broker/subAccountApi/permission/vanillaOptions"],put:["userDataStream","userDataStream/isolated"],delete:["margin/openOrders","margin/order","userDataStream","userDataStream/isolated","broker/subAccountApi","broker/subAccountApi/ipRestriction/ipList"]},wapi:{post:["withdraw","sub-account/transfer"],get:["depositHistory","withdrawHistory","depositAddress","accountStatus","systemStatus","apiTradingStatus","userAssetDribbletLog","tradeFee","assetDetail","sub-account/list","sub-account/transfer/history","sub-account/assets"]},dapiPublic:{get:["ping","time","exchangeInfo","depth","trades","historicalTrades","aggTrades","premiumIndex","fundingRate","klines","continuousKlines","indexPriceKlines","markPriceKlines","ticker/24hr","ticker/price","ticker/bookTicker","allForceOrders","openInterest"]},dapiData:{get:["openInterestHist","topLongShortAccountRatio","topLongShortPositionRatio","globalLongShortAccountRatio","takerBuySellVol","basis"]},dapiPrivate:{get:["positionSide/dual","order","openOrder","openOrders","allOrders","balance","account","positionMargin/history","positionRisk","userTrades","income","leverageBracket","forceOrders","adlQuantile"],post:["positionSide/dual","order","batchOrders","countdownCancelAll","leverage","marginType","positionMargin","listenKey"],put:["listenKey"],delete:["order","allOpenOrders","batchOrders","listenKey"]},dapiPrivateV2:{get:["leverageBracket"]},fapiPublic:{get:["ping","time","exchangeInfo","depth","trades","historicalTrades","aggTrades","klines","continuousKlines","fundingRate","premiumIndex","ticker/24hr","ticker/price","ticker/bookTicker","allForceOrders","openInterest","indexInfo"]},fapiData:{get:["openInterestHist","topLongShortAccountRatio","topLongShortPositionRatio","globalLongShortAccountRatio","takerlongshortRatio"]},fapiPrivate:{get:["allForceOrders","allOrders","openOrder","openOrders","order","account","balance","leverageBracket","positionMargin/history","positionRisk","positionSide/dual","userTrades","income","commissionRate","apiTradingStatus","apiReferral/ifNewUser","apiReferral/customization","apiReferral/userCustomization","apiReferral/traderNum","apiReferral/overview","apiReferral/tradeVol","apiReferral/rebateVol","apiReferral/traderSummary"],post:["batchOrders","positionSide/dual","positionMargin","marginType","order","leverage","listenKey","countdownCancelAll","apiReferral/customization","apiReferral/userCustomization"],put:["listenKey"],delete:["batchOrders","order","allOpenOrders","listenKey"]},fapiPrivateV2:{get:["account","balance","positionRisk"]},v3:{get:["ticker/price","ticker/bookTicker"]},public:{get:["ping","time","depth","trades","aggTrades","historicalTrades","klines","ticker/24hr","ticker/price","ticker/bookTicker","exchangeInfo"],put:["userDataStream"],post:["userDataStream"],delete:["userDataStream"]},private:{get:["allOrderList","openOrderList","orderList","order","openOrders","allOrders","account","myTrades"],post:["order/oco","order","order/test"],delete:["openOrders","orderList","order"]}},fees:{trading:{feeSide:"get",tierBased:!1,percentage:!0,taker:.001,maker:.001},future:{trading:{feeSide:"quote",tierBased:!0,percentage:!0,taker:this.parseNumber("0.000400"),maker:this.parseNumber("0.000200"),tiers:{taker:[[this.parseNumber("0"),this.parseNumber("0.000400")],[this.parseNumber("250"),this.parseNumber("0.000400")],[this.parseNumber("2500"),this.parseNumber("0.000350")],[this.parseNumber("7500"),this.parseNumber("0.000320")],[this.parseNumber("22500"),this.parseNumber("0.000300")],[this.parseNumber("50000"),this.parseNumber("0.000270")],[this.parseNumber("100000"),this.parseNumber("0.000250")],[this.parseNumber("200000"),this.parseNumber("0.000220")],[this.parseNumber("400000"),this.parseNumber("0.000200")],[this.parseNumber("750000"),this.parseNumber("0.000170")]],maker:[[this.parseNumber("0"),this.parseNumber("0.000200")],[this.parseNumber("250"),this.parseNumber("0.000160")],[this.parseNumber("2500"),this.parseNumber("0.000140")],[this.parseNumber("7500"),this.parseNumber("0.000120")],[this.parseNumber("22500"),this.parseNumber("0.000100")],[this.parseNumber("50000"),this.parseNumber("0.000080")],[this.parseNumber("100000"),this.parseNumber("0.000060")],[this.parseNumber("200000"),this.parseNumber("0.000040")],[this.parseNumber("400000"),this.parseNumber("0.000020")],[this.parseNumber("750000"),this.parseNumber("0")]]}}},delivery:{trading:{feeSide:"base",tierBased:!0,percentage:!0,taker:this.parseNumber("0.000500"),maker:this.parseNumber("0.000100"),tiers:{taker:[[this.parseNumber("0"),this.parseNumber("0.000500")],[this.parseNumber("250"),this.parseNumber("0.000450")],[this.parseNumber("2500"),this.parseNumber("0.000400")],[this.parseNumber("7500"),this.parseNumber("0.000300")],[this.parseNumber("22500"),this.parseNumber("0.000250")],[this.parseNumber("50000"),this.parseNumber("0.000240")],[this.parseNumber("100000"),this.parseNumber("0.000240")],[this.parseNumber("200000"),this.parseNumber("0.000240")],[this.parseNumber("400000"),this.parseNumber("0.000240")],[this.parseNumber("750000"),this.parseNumber("0.000240")]],maker:[[this.parseNumber("0"),this.parseNumber("0.000100")],[this.parseNumber("250"),this.parseNumber("0.000080")],[this.parseNumber("2500"),this.parseNumber("0.000050")],[this.parseNumber("7500"),this.parseNumber("0.0000030")],[this.parseNumber("22500"),this.parseNumber("0")],[this.parseNumber("50000"),this.parseNumber("-0.000050")],[this.parseNumber("100000"),this.parseNumber("-0.000060")],[this.parseNumber("200000"),this.parseNumber("-0.000070")],[this.parseNumber("400000"),this.parseNumber("-0.000080")],[this.parseNumber("750000"),this.parseNumber("-0.000090")]]}}}},commonCurrencies:{BCC:"BCC",YOYO:"YOYOW"},options:{fetchCurrencies:!1,defaultTimeInForce:"GTC",defaultType:"spot",hasAlreadyAuthenticatedSuccessfully:!1,warnOnFetchOpenOrdersWithoutSymbol:!0,recvWindow:5e3,timeDifference:0,adjustForTimeDifference:!1,parseOrderToPrecision:!1,newOrderRespType:{market:"FULL",limit:"FULL"},quoteOrderQty:!0,broker:{spot:"x-R4BD3S82",margin:"x-R4BD3S82",future:"x-xcKtGhcu",delivery:"x-xcKtGhcu"},accountsByType:{main:"MAIN",spot:"MAIN",margin:"MARGIN",future:"UMFUTURE",delivery:"CMFUTURE",mining:"MINING"},typesByAccount:{MAIN:"spot",MARGIN:"margin",UMFUTURE:"future",CMFUTURE:"delivery",MINING:"mining"}},exceptions:{exact:{"System abnormality":r,"You are not authorized to execute this request.":p,"API key does not exist":l,"Order would trigger immediately.":v,"Stop price would trigger immediately.":v,"Order would immediately match and take.":v,"Account has insufficient balance for requested action.":o,"Rest API trading is not enabled.":n,"You don't have permission.":p,"Market is closed.":n,"Too many requests.":h,"-1000":n,"-1001":n,"-1002":l,"-1003":f,"-1013":d,"-1015":f,"-1016":n,"-1020":b,"-1021":u,"-1022":l,"-1100":b,"-1101":b,"-1102":b,"-1103":b,"-1104":b,"-1105":b,"-1106":b,"-1111":b,"-1112":d,"-1114":b,"-1115":b,"-1116":b,"-1117":b,"-1118":b,"-1119":b,"-1120":b,"-1121":g,"-1125":l,"-1127":b,"-1128":b,"-1130":b,"-1131":b,"-2008":l,"-2010":r,"-2011":c,"-2013":c,"-2014":l,"-2015":l,"-2019":o,"-3005":o,"-3008":o,"-3010":r,"-3022":y,"-4028":b,"-3020":o,"-3041":o,"-5013":o},broad:{"has no operation privilege":p}}})}currencyToPrecision(e,t){return this.numberToString(t)}nonce(){return this.milliseconds()-this.options.timeDifference}async fetchTime(e={}){const t=this.safeString2(this.options,"fetchTime","defaultType","spot");let s="publicGetTime";"future"===t?s="fapiPublicGetTime":"delivery"===t&&(s="dapiPublicGetTime");const i=await this[s](e);return this.safeInteger(i,"serverTime")}async loadTimeDifference(e={}){const t=await this.fetchTime(e),s=this.milliseconds();return this.options.timeDifference=s-t,this.options.timeDifference}async fetchCurrencies(e={}){if(!this.safeValue(this.options,"fetchCurrencies"))return;if(!this.checkRequiredCredentials(!1))return;if(void 0!==this.safeString(this.urls,"apiBackup"))return;const t=await this.sapiGetCapitalConfigGetall(e),s={};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"coin"),a=this.safeString(i,"name"),n=this.safeCurrencyCode(r),o=void 0;let c=!0,d=!0;const h=this.safeValue(i,"networkList",[]),u={};let l;for(let e=0;e<h.length;e++){const t=h[e],s=this.safeString(t,"network"),i=this.safeNumber(t,"withdrawFee"),r=this.safeValue(t,"depositEnable"),a=this.safeValue(t,"withdrawEnable");d=d||r,c=c||a,u[s]=i;(this.safeValue(t,"isDefault")||void 0===l)&&(l=i)}const f=this.safeValue(i,"trading"),p=c&&d&&f;s[n]={id:r,name:a,code:n,precision:o,info:i,active:p,fee:l,fees:u,limits:this.limits}}return s}async fetchMarkets(e={}){const t=this.safeString2(this.options,"fetchMarkets","defaultType","spot"),s=this.safeString(e,"type",t),i=this.omit(e,"type");if("spot"!==s&&"future"!==s&&"margin"!==s&&"delivery"!==s)throw new r(this.id+" does not support '"+s+"' type, set exchange.options['defaultType'] to 'spot', 'margin', 'delivery' or 'future'");let a="publicGetExchangeInfo";"future"===s?a="fapiPublicGetExchangeInfo":"delivery"===s&&(a="dapiPublicGetExchangeInfo");const n=await this[a](i);this.options.adjustForTimeDifference&&await this.loadTimeDifference();const o=this.safeValue(n,"symbols",[]),c=[];for(let e=0;e<o.length;e++){const t=o[e],i="spot"===s,r="future"===s,a="delivery"===s,n=this.safeString(t,"symbol"),d=this.safeStringLower(t,"symbol"),h=this.safeString(t,"baseAsset"),u=this.safeString(t,"quoteAsset"),l=this.safeCurrencyCode(h),f=this.safeCurrencyCode(u),p=this.safeString(t,"contractType");let m,b;(r||a)&&"PERPETUAL"!==p?(m=n,b=this.safeInteger(t,"deliveryDate")):m=l+"/"+f;const g=this.safeValue(t,"filters",[]),y=this.indexBy(g,"filterType"),v={base:this.safeInteger(t,"baseAssetPrecision"),quote:this.safeInteger(t,"quotePrecision"),amount:this.safeInteger(t,"quantityPrecision"),price:this.safeInteger(t,"pricePrecision")},w="TRADING"===this.safeString2(t,"status","contractStatus"),k=this.safeValue(t,"isMarginTradingAllowed",!1);let S,_=this.fees;(r||a)&&(S=this.safeString(t,"contractSize","1"),_=this.fees[s]);const O=_.trading.maker,T=_.trading.taker,x={id:n,lowercaseId:d,symbol:m,base:l,quote:f,baseId:h,quoteId:u,info:t,spot:i,type:s,margin:k,future:r,delivery:a,linear:r,inverse:a,expiry:b,expiryDatetime:this.iso8601(b),active:w,precision:v,contractSize:S,maker:O,taker:T,limits:{amount:{min:void 0,max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}}};if("PRICE_FILTER"in y){const e=this.safeValue(y,"PRICE_FILTER",{});x.limits.price={min:this.safeNumber(e,"minPrice"),max:this.safeNumber(e,"maxPrice")},x.precision.price=this.precisionFromString(e.tickSize)}if("LOT_SIZE"in y){const e=this.safeValue(y,"LOT_SIZE",{}),t=this.safeString(e,"stepSize");x.precision.amount=this.precisionFromString(t),x.limits.amount={min:this.safeNumber(e,"minQty"),max:this.safeNumber(e,"maxQty")}}if("MARKET_LOT_SIZE"in y){const e=this.safeValue(y,"MARKET_LOT_SIZE",{});x.limits.market={min:this.safeNumber(e,"minQty"),max:this.safeNumber(e,"maxQty")}}if("MIN_NOTIONAL"in y){const e=this.safeValue(y,"MIN_NOTIONAL",{});x.limits.cost.min=this.safeNumber2(e,"minNotional","notional")}c.push(x)}return c}async fetchBalance(e={}){await this.loadMarkets();const t=this.safeString2(this.options,"fetchBalance","defaultType","spot"),s=this.safeString(e,"type",t);let i="privateGetAccount";if("future"===s){const e=this.safeValue(this.options,"future",{}),t=this.safeValue(e,"fetchBalance",{});i=this.safeString(t,"method","fapiPrivateV2GetAccount")}else if("delivery"===s){const e=this.safeValue(this.options,"delivery",{}),t=this.safeValue(e,"fetchBalance",{});i=this.safeString(t,"method","dapiPrivateGetAccount")}else"margin"===s&&(i="sapiGetMarginAccount");const r=this.omit(e,"type"),a=await this[i](r),n={info:a};let o;if("spot"===s||"margin"===s){o=this.safeInteger(a,"updateTime");const e=this.safeValue2(a,"balances","userAssets",[]);for(let t=0;t<e.length;t++){const s=e[t],i=this.safeString(s,"asset"),r=this.safeCurrencyCode(i),a=this.account();a.free=this.safeString(s,"free"),a.used=this.safeString(s,"locked"),n[r]=a}}else{let e=a;Array.isArray(a)||(e=this.safeValue(a,"assets",[]));for(let t=0;t<e.length;t++){const s=e[t],i=this.safeString(s,"asset"),r=this.safeCurrencyCode(i),a=this.account();a.free=this.safeString(s,"availableBalance"),a.used=this.safeString(s,"initialMargin"),a.total=this.safeString2(s,"marginBalance","balance"),n[r]=a}}return n.timestamp=o,n.datetime=this.iso8601(o),this.parseBalance(n,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),r={symbol:i.id};void 0!==t&&(r.limit=t);let a="publicGetDepth";i.linear?a="fapiPublicGetDepth":i.inverse&&(a="dapiPublicGetDepth");const n=await this[a](this.extend(r,s)),o=this.safeInteger(n,"T"),c=this.parseOrderBook(n,e,o);return c.nonce=this.safeInteger(n,"lastUpdateId"),c}parseTicker(e,t){const s=this.safeInteger(e,"closeTime"),i=this.safeString(e,"symbol"),r=this.safeSymbol(i,t),a=this.safeNumber(e,"lastPrice");let n,o;return"baseVolume"in e?(n=this.safeNumber(e,"baseVolume"),o=this.safeNumber(e,"volume")):(n=this.safeNumber(e,"volume"),o=this.safeNumber(e,"quoteVolume")),{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"highPrice"),low:this.safeNumber(e,"lowPrice"),bid:this.safeNumber(e,"bidPrice"),bidVolume:this.safeNumber(e,"bidQty"),ask:this.safeNumber(e,"askPrice"),askVolume:this.safeNumber(e,"askQty"),vwap:this.safeNumber(e,"weightedAvgPrice"),open:this.safeNumber(e,"openPrice"),close:a,last:a,previousClose:this.safeNumber(e,"prevClosePrice"),change:this.safeNumber(e,"priceChange"),percentage:this.safeNumber(e,"priceChangePercent"),average:void 0,baseVolume:n,quoteVolume:o,info:e}}async fetchStatus(e={}){const t=await this.wapiGetSystemStatus(e);let s=this.safeString(t,"status");return void 0!==s&&(s="0"===s?"ok":"maintenance",this.status=this.extend(this.status,{status:s,updated:this.milliseconds()})),this.status}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id};let r="publicGetTicker24hr";s.linear?r="fapiPublicGetTicker24hr":s.inverse&&(r="dapiPublicGetTicker24hr");const a=await this[r](this.extend(i,t));if(Array.isArray(a)){const e=this.safeValue(a,0,{});return this.parseTicker(e,s)}return this.parseTicker(a,s)}async fetchBidsAsks(e,t={}){await this.loadMarkets();const s=this.safeString2(this.options,"fetchBidsAsks","defaultType","spot"),i=this.safeString(t,"type",s),r=this.omit(t,"type");let a;a="future"===i?"fapiPublicGetTickerBookTicker":"delivery"===i?"dapiPublicGetTickerBookTicker":"publicGetTickerBookTicker";const n=await this[a](r);return this.parseTickers(n,e)}async fetchTickers(e,t={}){await this.loadMarkets();const s=this.safeString2(this.options,"fetchTickers","defaultType","spot"),i=this.safeString(t,"type",s),r=this.omit(t,"type");let a;a="future"===i?"fapiPublicGetTicker24hr":"delivery"===i?"dapiPublicGetTicker24hr":"publicGetTicker24hr";const n=this.safeString(this.options,"fetchTickersMethod",a),o=await this[n](r);return this.parseTickers(o,e)}parseOHLCV(e,t){return[this.safeInteger(e,0),this.safeNumber(e,1),this.safeNumber(e,2),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,5)]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e);i=void 0===i?500:Math.min(i,1500);const n={symbol:a.id,interval:this.timeframes[t],limit:i},o=this.parseTimeframe(t);if(void 0!==s&&(n.startTime=s,s>0)){const e=this.sum(s,i*o*1e3-1),t=this.milliseconds();n.endTime=Math.min(t,e)}let c="publicGetKlines";a.linear?c="fapiPublicGetKlines":a.inverse&&(c="dapiPublicGetKlines");const d=await this[c](this.extend(n,r));return this.parseOHLCVs(d,a,t,s,i)}parseTrade(e,t){if("isDustTrade"in e)return this.parseDustTrade(e,t);const s=this.safeInteger2(e,"T","time"),i=this.safeString2(e,"p","price"),r=this.safeString2(e,"q","qty"),a=this.parseNumber(i),n=this.parseNumber(r),o=this.parseNumber(k.stringMul(i,r));let c,d=this.safeString2(e,"t","a");d=this.safeString(e,"id",d);const h=this.safeString(e,"orderId");let u,l;"m"in e?c=e.m?"sell":"buy":"isBuyerMaker"in e?c=e.isBuyerMaker?"sell":"buy":"side"in e?c=this.safeStringLower(e,"side"):"isBuyer"in e&&(c=e.isBuyer?"buy":"sell"),"commission"in e&&(u={cost:this.safeNumber(e,"commission"),currency:this.safeCurrencyCode(this.safeString(e,"commissionAsset"))}),"isMaker"in e&&(l=e.isMaker?"maker":"taker"),"maker"in e&&(l=e.maker?"maker":"taker");const f=this.safeString(e,"symbol"),p=this.safeSymbol(f,t);return{info:e,timestamp:s,datetime:this.iso8601(s),symbol:p,id:d,order:h,type:void 0,side:c,takerOrMaker:l,price:a,amount:n,cost:o,fee:u}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id},n=this.safeString2(this.options,"fetchTrades","defaultType","spot"),o=this.safeString(i,"type",n),c=this.omit(i,"type");let d;d="future"===o?"fapiPublicGetAggTrades":"delivery"===o?"dapiPublicGetAggTrades":"publicGetAggTrades";let h=this.safeString(this.options,"fetchTradesMethod",d);"publicGetAggTrades"===h?(void 0!==t&&(a.startTime=t,a.endTime=this.sum(t,36e5)),"future"===o?h="fapiPublicGetAggTrades":"delivery"===o&&(h="dapiPublicGetAggTrades")):"publicGetHistoricalTrades"===h&&("future"===o?h="fapiPublicGetHistoricalTrades":"delivery"===o&&(h="dapiPublicGetHistoricalTrades")),void 0!==s&&(a.limit=s);const u=await this[h](this.extend(a,c));return this.parseTrades(u,r,t,s)}parseOrderStatus(e){return this.safeString({NEW:"open",PARTIALLY_FILLED:"open",FILLED:"closed",CANCELED:"canceled",PENDING_CANCEL:"canceling",REJECTED:"rejected",EXPIRED:"expired"},e,e)}parseOrder(e,t){const s=this.parseOrderStatus(this.safeString(e,"status")),i=this.safeString(e,"symbol"),r=this.safeSymbol(i,t),a=this.safeString(e,"executedQty","0"),n=this.parseNumber(a),o=parseFloat(a);let c,d;"time"in e?c=this.safeInteger(e,"time"):"transactTime"in e?c=this.safeInteger(e,"transactTime"):"updateTime"in e&&"open"===s&&(o>0?d=this.safeInteger(e,"updateTime"):c=this.safeInteger(e,"updateTime"));const h=this.safeString(e,"avgPrice"),u=this.parseNumber(this.omitZero(h)),l=this.safeString(e,"price"),f=this.parseNumber(this.omitZero(l)),p=this.safeNumber(e,"origQty"),m=this.safeNumber2(e,"cummulativeQuoteQty","cumQuote"),b=this.safeString(e,"orderId");let g=this.safeStringLower(e,"type");"limit_maker"===g&&(g="limit");const y=this.safeStringLower(e,"side"),v=this.safeValue(e,"fills",[]),w=this.parseTrades(v,t),k=this.safeString(e,"clientOrderId"),S=this.safeString(e,"timeInForce"),_="limit_maker"===g||"GTX"===S,O=this.safeString(e,"stopPrice"),T=this.parseNumber(this.omitZero(O));return this.safeOrder({info:e,id:b,clientOrderId:k,timestamp:c,datetime:this.iso8601(c),lastTradeTimestamp:d,symbol:r,type:g,timeInForce:S,postOnly:_,side:y,price:f,stopPrice:T,amount:p,cost:m,average:u,filled:n,remaining:void 0,status:s,fee:void 0,trades:w})}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o=this.safeString2(this.options,"createOrder","defaultType","spot"),c=this.safeString(a,"type",o),h=this.safeString2(a,"newClientOrderId","clientOrderId");a=this.omit(a,["type","newClientOrderId","clientOrderId"]);let u="privatePostOrder";if("future"===c?u="fapiPrivatePostOrder":"delivery"===c?u="dapiPrivatePostOrder":"margin"===c&&(u="sapiPostMarginOrder"),n.spot){this.safeValue(a,"test",!1)&&(u+="Test"),a=this.omit(a,"test")}const l=t.toUpperCase(),f=this.safeValue(n.info,"orderTypes");if(!this.inArray(l,f))throw new d(this.id+" "+t+" is not a valid order type in market "+e);const p={symbol:n.id,type:l,side:s.toUpperCase()};if(void 0===h){const e=this.safeValue(this.options,"broker");if(e){const t=this.safeString(e,c);void 0!==t&&(p.newClientOrderId=t+this.uuid22())}}else p.newClientOrderId=h;p.newOrderRespType="spot"===c||"margin"===c?this.safeValue(this.options.newOrderRespType,t,"RESULT"):"RESULT";let m=!1,b=!1,g=!1,y=!1;if("MARKET"===l){if(this.safeValue(this.options,"quoteOrderQty",!1)){const e=this.safeNumber(a,"quoteOrderQty"),t=n.precision.price;void 0!==e?(p.quoteOrderQty=this.decimalToPrecision(e,w,t,this.precisionMode),a=this.omit(a,"quoteOrderQty")):void 0!==r?p.quoteOrderQty=this.decimalToPrecision(i*r,w,t,this.precisionMode):y=!0}else y=!0}else if("LIMIT"===l)b=!0,m=!0,y=!0;else if("STOP_LOSS"===l||"TAKE_PROFIT"===l)g=!0,y=!0,(n.linear||n.inverse)&&(b=!0);else if("STOP_LOSS_LIMIT"===l||"TAKE_PROFIT_LIMIT"===l)y=!0,g=!0,b=!0,m=!0;else if("LIMIT_MAKER"===l)b=!0,y=!0;else if("STOP"===l)y=!0,g=!0,b=!0;else if("STOP_MARKET"===l||"TAKE_PROFIT_MARKET"===l){void 0===this.safeValue(a,"closePosition")&&(y=!0),g=!0}else if("TRAILING_STOP_MARKET"===l){y=!0;if(void 0===this.safeNumber(a,"callbackRate"))throw new d(this.id+" createOrder() requires a callbackRate extra param for a "+t+" order")}if(y&&(p.quantity=this.amountToPrecision(e,i)),b){if(void 0===r)throw new d(this.id+" createOrder() requires a price argument for a "+t+" order");p.price=this.priceToPrecision(e,r)}if(m&&(p.timeInForce=this.options.defaultTimeInForce),g){const s=this.safeNumber(a,"stopPrice");if(void 0===s)throw new d(this.id+" createOrder() requires a stopPrice extra param for a "+t+" order");a=this.omit(a,"stopPrice"),p.stopPrice=this.priceToPrecision(e,s)}const v=await this[u](this.extend(p,a));return this.parseOrder(v,n)}async fetchOrder(e,t,s={}){if(void 0===t)throw new a(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r=this.safeString2(this.options,"fetchOrder","defaultType","spot"),n=this.safeString(s,"type",r);let o="privateGetOrder";"future"===n?o="fapiPrivateGetOrder":"delivery"===n?o="dapiPrivateGetOrder":"margin"===n&&(o="sapiGetMarginOrder");const c={symbol:i.id},d=this.safeValue2(s,"origClientOrderId","clientOrderId");void 0!==d?c.origClientOrderId=d:c.orderId=e;const h=this.omit(s,["type","clientOrderId","origClientOrderId"]),u=await this[o](this.extend(c,h));return this.parseOrder(u,i)}async fetchOrders(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),n=this.safeString2(this.options,"fetchOrders","defaultType","spot"),o=this.safeString(i,"type",n);let c="privateGetAllOrders";"future"===o?c="fapiPrivateGetAllOrders":"delivery"===o?c="dapiPrivateGetAllOrders":"margin"===o&&(c="sapiGetMarginAllOrders");const d={symbol:r.id};void 0!==t&&(d.startTime=t),void 0!==s&&(d.limit=s);const h=this.omit(i,"type"),u=await this[c](this.extend(d,h));return this.parseOrders(u,r,t,s)}async fetchOpenOrders(e,t,s,i={}){let a,n,o;await this.loadMarkets();const c={};if(void 0!==e){a=this.market(e),c.symbol=a.id;const t=this.safeString2(this.options,"fetchOpenOrders","defaultType","spot");o=this.safeString(i,"type",t),n=this.omit(i,"type")}else{if(this.options.warnOnFetchOpenOrdersWithoutSymbol){const e=this.symbols.length,t=parseInt(e/2);throw new r(this.id+" fetchOpenOrders WARNING: fetching open orders without specifying a symbol is rate-limited to one call per "+t.toString()+" seconds. Do not call this method frequently to avoid ban. Set "+this.id+'.options["warnOnFetchOpenOrdersWithoutSymbol"] = false to suppress this warning message.')}{const e=this.safeString2(this.options,"fetchOpenOrders","defaultType","spot");o=this.safeString(i,"type",e),n=this.omit(i,"type")}}let d="privateGetOpenOrders";"future"===o?d="fapiPrivateGetOpenOrders":"delivery"===o?d="dapiPrivateGetOpenOrders":"margin"===o&&(d="sapiGetMarginOpenOrders");const h=await this[d](this.extend(c,n));return this.parseOrders(h,a,t,s)}async fetchClosedOrders(e,t,s,i={}){const r=await this.fetchOrders(e,t,s,i);return this.filterBy(r,"status","closed")}async cancelOrder(e,t,s={}){if(void 0===t)throw new a(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r=this.safeString2(this.options,"fetchOpenOrders","defaultType","spot"),n=this.safeString(s,"type",r),o=this.safeValue2(s,"origClientOrderId","clientOrderId"),c={symbol:i.id};void 0===o?c.orderId=e:c.origClientOrderId=o;let d="privateDeleteOrder";"future"===n?d="fapiPrivateDeleteOrder":"delivery"===n?d="dapiPrivateDeleteOrder":"margin"===n&&(d="sapiDeleteMarginOrder");const h=this.omit(s,["type","origClientOrderId","clientOrderId"]),u=await this[d](this.extend(c,h));return this.parseOrder(u)}async cancelAllOrders(e,t={}){if(void 0===e)throw new a(this.id+" cancelAllOrders() requires a symbol argument");await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=this.safeString2(this.options,"cancelAllOrders","defaultType","spot"),n=this.safeString(t,"type",r),o=this.omit(t,"type");let c="privateDeleteOpenOrders";"margin"===n?c="sapiDeleteMarginOpenOrders":"future"===n?c="fapiPrivateDeleteAllOpenOrders":"delivery"===n&&(c="dapiPrivateDeleteAllOpenOrders");const d=await this[c](this.extend(i,o));return Array.isArray(d)?this.parseOrders(d,s):d}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const r=this.market(e),n=this.safeString2(this.options,"fetchMyTrades","defaultType","spot"),o=this.safeString(i,"type",n);let c;i=this.omit(i,"type"),"spot"===o?c="privateGetMyTrades":"margin"===o?c="sapiGetMarginMyTrades":"future"===o?c="fapiPrivateGetUserTrades":"delivery"===o&&(c="dapiPrivateGetUserTrades");const d={symbol:r.id};void 0!==t&&(d.startTime=t),void 0!==s&&(d.limit=s);const h=await this[c](this.extend(d,i));return this.parseTrades(h,r,t,s)}async fetchMyDustTrades(e,t,s,i={}){await this.loadMarkets();const r=await this.wapiGetUserAssetDribbletLog(i),a=this.safeValue(r,"results",{}),n=this.safeValue(a,"rows",[]),o=[];for(let e=0;e<n.length;e++){const t=n[e].logs;for(let e=0;e<t.length;e++)t[e].isDustTrade=!0,o.push(t[e])}const c=this.parseTrades(o,void 0,t,s);return this.filterBySinceLimit(c,t,s)}parseDustTrade(e,t){const s=this.safeString(e,"tranId"),i=this.parse8601(this.safeString(e,"operateTime")),r=this.safeCurrencyCode(this.safeString(e,"fromAsset")),a=this.currency("BNB").code,n=a+"/"+r;let o=!1;n in this.markets&&(o=!0);const c={currency:a,cost:this.safeNumber(e,"serviceChargeAmount")};let d,h,u,l,f;o?(d=n,h=this.sum(this.safeNumber(e,"transferedAmount"),c.cost),u=this.safeNumber(e,"amount"),l="buy"):(d=r+"/"+a,h=this.safeNumber(e,"amount"),u=this.sum(this.safeNumber(e,"transferedAmount"),c.cost),l="sell"),void 0!==u&&h&&(f=u/h);return{id:undefined,timestamp:i,datetime:this.iso8601(i),symbol:d,order:s,type:undefined,takerOrMaker:undefined,side:l,amount:h,price:f,cost:u,fee:c,info:e}}async fetchDeposits(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.currency(e),a.coin=r.id),void 0!==t&&(a.startTime=t,a.endTime=this.sum(t,7776e6)),void 0!==s&&(a.limit=s);const n=await this.sapiGetCapitalDepositHisrec(this.extend(a,i));return this.parseTransactions(n,r,t,s)}async fetchWithdrawals(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.currency(e),a.coin=r.id),void 0!==t&&(a.startTime=t,a.endTime=this.sum(t,7776e6)),void 0!==s&&(a.limit=s);const n=await this.sapiGetCapitalWithdrawHistory(this.extend(a,i));return this.parseTransactions(n,r,t,s)}parseTransactionStatusByType(e,t){const s=this.safeValue({deposit:{0:"pending",1:"ok"},withdrawal:{0:"pending",1:"canceled",2:"pending",3:"failed",4:"pending",5:"failed",6:"ok"}},t,{});return this.safeString(s,e,e)}parseTransaction(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"address");let r=this.safeString(e,"addressTag");void 0!==r&&r.length<1&&(r=void 0);let a=this.safeString(e,"txId");void 0!==a&&a.indexOf("Internal transfer ")>=0&&(a=a.slice(18));const n=this.safeString(e,"coin"),o=this.safeCurrencyCode(n,t);let c;const d=this.safeInteger(e,"insertTime"),h=this.parse8601(this.safeString(e,"applyTime"));let u=this.safeString(e,"type");void 0===u&&(void 0!==d&&void 0===h?(u="deposit",c=d):void 0===d&&void 0!==h&&(u="withdrawal",c=h));const l=this.parseTransactionStatusByType(this.safeString(e,"status"),u),f=this.safeNumber(e,"amount"),p=this.safeNumber(e,"transactionFee");let m;void 0!==p&&(m={currency:o,cost:p});const b=this.safeInteger(e,"successTime");let g=this.safeInteger(e,"transferType",!1);return g=!!g,{info:e,id:s,txid:a,timestamp:c,datetime:this.iso8601(c),address:i,addressTo:i,addressFrom:void 0,tag:r,tagTo:r,tagFrom:void 0,type:u,amount:f,currency:o,status:l,updated:b,internal:g,fee:m}}parseTransferStatus(e){return this.safeString({CONFIRMED:"ok"},e,e)}parseTransfer(e,t){const s=this.safeString(e,"tranId"),i=this.safeString(e,"asset"),r=this.safeCurrencyCode(i,t),a=this.safeNumber(e,"amount"),n=this.safeString(e,"type");let o,c;const d=this.safeValue(this.options,"typesByAccount",{});if(void 0!==n){const e=n.split("_");o=this.safeValue(e,0),c=this.safeValue(e,1),o=this.safeString(d,o,o),c=this.safeString(d,c,c)}const h=this.safeInteger(e,"timestamp"),u=this.parseTransferStatus(this.safeString(e,"status"));return{info:e,id:s,timestamp:h,datetime:this.iso8601(h),currency:r,amount:a,fromAccount:o,toAccount:c,status:u}}parseIncome(e,t){const s=this.safeString(e,"symbol"),i=this.safeSymbol(s,t),r=this.safeNumber(e,"income"),a=this.safeString(e,"asset"),n=this.safeCurrencyCode(a),o=this.safeString(e,"tranId"),c=this.safeInteger(e,"time");return{info:e,symbol:i,code:n,timestamp:c,datetime:this.iso8601(c),id:o,amount:r}}parseIncomes(e,t,s,i){const r=[];for(let s=0;s<e.length;s++){const i=e[s],a=this.parseIncome(i,t);r.push(a)}return this.filterBySinceLimit(r,s,i,"timestamp")}async transfer(e,t,s,i,a={}){await this.loadMarkets();const n=this.currency(e);let o=this.safeString(a,"type");if(void 0===o){const e=this.safeValue(this.options,"accountsByType",{}),t=this.safeString(e,s,s),a=this.safeString(e,i,i);if(void 0===t){const t=Object.keys(e);throw new r(this.id+" fromAccount must be one of "+t.join(", "))}if(void 0===a){const t=Object.keys(e);throw new r(this.id+" toAccount must be one of "+t.join(", "))}o=t+"_"+a}const c={asset:n.id,amount:this.currencyToPrecision(e,t),type:o},d=await this.sapiPostAssetTransfer(this.extend(c,a)),h=this.parseTransfer(d,n);return this.extend(h,{amount:t,currency:e,fromAccount:s,toAccount:i})}async fetchTransfers(e,t,s,i={}){await this.loadMarkets();const a=this.currency(e),n=this.safeString2(this.options,"fetchTransfers","defaultType","spot"),o=this.safeString(i,"fromAccount",n),c="future"===o?"spot":"future",d=this.safeString(i,"toAccount",c);let h=this.safeString(i,"type");const u=this.safeValue(this.options,"accountsByType",{}),l=this.safeString(u,o),f=this.safeString(u,d);if(void 0===h){if(void 0===l){const e=Object.keys(u);throw new r(this.id+" fromAccount parameter must be one of "+e.join(", "))}if(void 0===f){const e=Object.keys(u);throw new r(this.id+" toAccount parameter must be one of "+e.join(", "))}h=l+"_"+f}const p={type:h};void 0!==t&&(p.startTime=t),void 0!==s&&(p.size=s);const m=await this.sapiGetAssetTransfer(this.extend(p,i)),b=this.safeValue(m,"rows",[]);return this.parseTransfers(b,a,t,s)}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={coin:this.currency(e).id},i=await this.sapiGetCapitalDepositAddress(this.extend(s,t)),r=this.safeString(i,"address"),a=this.safeString(i,"tag");return this.checkAddress(r),{currency:e,address:r,tag:a,info:i}}async fetchFundingFees(e,t={}){const s=await this.sapiGetCapitalConfigGetall(t),i={};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"coin"),a=this.safeCurrencyCode(r),n=this.safeValue(t,"networkList");i[a]={};for(let e=0;e<n.length;e++){const t=n[e],s=this.safeString(t,"network"),r=this.safeCurrencyCode(s),o=this.safeNumber(t,"withdrawFee");i[a][r]=o}}return{withdraw:i,deposit:{},info:s}}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a={coin:this.currency(e).id,address:s,amount:t};void 0!==i&&(a.addressTag=i);const n=await this.sapiPostCapitalWithdrawApply(this.extend(a,r));return{info:n,id:this.safeString(n,"id")}}parseTradingFee(e,t){const s=this.safeString(e,"symbol");return{info:e,symbol:this.safeSymbol(s),maker:this.safeNumber(e,"makerCommission"),taker:this.safeNumber(e,"takerCommission")}}async fetchTradingFee(e,t={}){await this.loadMarkets();const s={symbol:this.market(e).id},i=await this.sapiGetAssetTradeFee(this.extend(s,t)),r=this.safeValue(i,0,{});return this.parseTradingFee(r)}async fetchTradingFees(e={}){let t;await this.loadMarkets();const s=this.safeString2(this.options,"fetchFundingRates","defaultType","future"),i=this.safeString(e,"type",s),r=this.omit(e,"type");"spot"===i||"margin"===i?t="sapiGetAssetTradeFee":"future"===i?t="fapiPrivateGetAccount":"delivery"===i&&(t="dapiPrivateGetAccount");const a=await this[t](r);if("spot"===i||"margin"===i){const e={};for(let t=0;t<a.length;t++){const s=this.parseTradingFee(a[t]);e[s.symbol]=s}return e}if("future"===i){const e=Object.keys(this.markets),t={},s=this.safeInteger(a,"feeTier"),r=this.fees[i].trading.tiers,n=r.maker[s][1],o=r.taker[s][1];for(let i=0;i<e.length;i++){const r=e[i];t[r]={info:{feeTier:s},symbol:r,maker:n,taker:o}}return t}if("delivery"===i){const e=Object.keys(this.markets),t={},s=this.safeInteger(a,"feeTier"),r=this.fees[i].trading.tiers,n=r.maker[s][1],o=r.taker[s][1];for(let i=0;i<e.length;i++){const r=e[i];t[r]={info:{feeTier:s},symbol:r,maker:n,taker:o}}return t}}async futuresTransfer(e,t,s,i={}){if(s<1||s>4)throw new a(this.id+" type must be between 1 and 4");await this.loadMarkets();const r=this.currency(e),n={asset:r.id,amount:t,type:s},o=await this.sapiPostFuturesTransfer(this.extend(n,i));return this.parseTransfer(o,r)}async fetchFundingRate(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id};let r;if(s.linear)r="fapiPublicGetPremiumIndex";else{if(!s.inverse)throw m(this.id+" setMarginMode() supports linear and inverse contracts only");r="dapiPublicGetPremiumIndex"}const a=await this[r](this.extend(i,t));return this.parseFundingRate(a)}async fetchFundingRates(e,t={}){let s;await this.loadMarkets();const i=this.safeString2(this.options,"fetchFundingRates","defaultType","future"),r=this.safeString(t,"type",i),a=this.omit(t,"type");if("future"===r)s="fapiPublicGetPremiumIndex";else{if("delivery"!==r)throw m(this.id+" setMarginMode() supports linear and inverse contracts only");s="dapiPublicGetPremiumIndex"}const n=await this[s](a),o=[];for(let e=0;e<n.length;e++){const t=n[e],s=this.parseFundingRate(t);o.push(s)}return this.filterByArray(o,"symbol",e)}parseFundingRate(e,t){const s=this.safeInteger(e,"time"),i=this.safeString(e,"symbol"),r=this.safeSymbol(i,t),a=this.safeNumber(e,"markPrice"),n=this.safeNumber(e,"indexPrice"),o=this.safeNumber(e,"interestRate"),c=this.safeNumber(e,"lastFundingRate"),d=this.safeInteger(e,"nextFundingTime");return{info:e,symbol:r,markPrice:a,indexPrice:n,interestRate:o,timestamp:s,datetime:this.iso8601(s),fundingRate:c,nextFundingTimestamp:d,nextFundingDatetime:this.iso8601(d)}}parseAccountPositions(e){const t=this.safeValue(e,"positions"),s=this.safeValue(e,"assets"),i={};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"asset"),a=this.safeCurrencyCode(r),n=this.safeString(t,"crossWalletBalance"),o=this.safeString(t,"crossUnPnl");i[a]={crossMargin:k.stringAdd(n,o),crossWalletBalance:n}}const r=[];for(let e=0;e<t.length;e++){const s=t[e],a=this.safeString(s,"symbol"),n=this.safeMarket(a),o="future"===this.options.defaultType?n.quote:n.base,c=this.parsePosition(this.extend(s,{crossMargin:i[o].crossMargin,crossWalletBalance:i[o].crossWalletBalance}),n);r.push(c)}return r}parsePosition(e,t){const s=this.safeString(e,"symbol"),i=(t=this.safeMarket(s,t)).symbol,r=this.safeString(e,"leverage"),a=parseInt(r),n=this.safeString(e,"initialMargin"),o=this.parseNumber(n);let c=k.stringDiv("1",r,8);1e3%a==0||(c=k.stringDiv(k.stringAdd(c,"1e-8"),"1",8));const d="notional"in e,h=this.safeString(e,"maintMargin"),u=this.parseNumber(h),l=this.safeString(e,"entryPrice");let f=this.parseNumber(l);const p=this.safeString2(e,"notional","notionalValue"),m=k.stringAbs(p),b=parseFloat(p),g=parseFloat(m),y=this.parseNumber(k.stringAbs(p));let v=this.safeString(e,"positionAmt"),w=k.stringAbs(v);if(void 0===v){const e=k.stringMul(k.stringMul(r,n),l);v=k.stringDiv(e,t.contractSize),w=k.stringDiv(k.stringAdd(v,"0.5"),"1",0)}const S=this.parseNumber(w),_=this.safeValue(this.options,"leverageBrackets",{}),O=this.safeValue(_,i,[]);let T;for(let e=0;e<O.length;e++){const t=O[e];if(g<t[0])break;T=t[1]}const x=this.parseNumber(T),C=this.safeString(e,"unrealizedProfit"),I=this.parseNumber(C);let M=this.safeInteger(e,"updateTime");0===M&&(M=void 0);let N,A,E;this.safeValue(e,"isolated")?(N="isolated",E=this.safeString(e,"isolatedWallet"),A=k.stringAdd(E,C)):(N="cross",E=this.safeString(e,"crossWalletBalance"),A=this.safeString(e,"crossMargin"));const P=this.parseNumber(A);let B,V,L,q,D;if(0===b)f=void 0;else{if(V=b<0?"short":"long",B=this.parseNumber(k.stringDiv(h,A,4)),L=this.parseNumber(k.stringMul(k.stringDiv(C,n,4),"100")),d){let e,t=l;"short"===V?e=k.stringAdd("1",T):(e=k.stringAdd("-1",T),t=k.stringMul("-1",t));const s=k.stringDiv(E,k.stringMul(w,e)),i=k.stringDiv(t,e);q=k.stringAdd(s,i)}else{let e,s=l;"short"===V?e=k.stringSub("1",T):(e=k.stringSub("-1",T),s=k.stringMul("-1",s));const i=k.stringMul(w,t.contractSize),r=k.stringMul(i,e),a=k.stringSub(k.stringMul(k.stringDiv("1",s),i),E);q=k.stringDiv(r,a)}const e=t.precision.price,s=(e+1).toString(),i=new k("5e-"+s).toString(),r=k.stringAdd(i,q);let a=k.stringDiv(r,"1",e);"-"===a[0]&&(a=void 0),D=this.parseNumber(a)}return{info:e,symbol:i,timestamp:M,datetime:this.iso8601(M),initialMargin:o,initialMarginPercentage:this.parseNumber(c),maintenanceMargin:u,maintenanceMarginPercentage:x,entryPrice:f,notional:y,leverage:a,unrealizedPnl:I,contracts:S,marginRatio:B,liquidationPrice:D,markPrice:void 0,collateral:P,marginType:N,side:V,percentage:L}}parsePositionRisk(e,t){const s=this.safeString(e,"symbol"),i=(t=this.safeMarket(s,t)).symbol,r=this.safeValue(this.options,"leverageBrackets",{}),a=this.safeValue(r,i,[]),n=this.safeString2(e,"notional","notionalValue"),o=k.stringAbs(n),c=parseFloat(o),d=parseFloat(n);let h;for(let e=0;e<a.length;e++){const t=a[e];if(c<t[0])break;h=t[1]}const u=this.parseNumber(o),l=k.stringAbs(this.safeString(e,"positionAmt")),f=this.parseNumber(l),p=this.safeString(e,"unRealizedProfit"),m=this.parseNumber(p),b=this.safeString(e,"leverage"),g=parseInt(b);let y=this.safeNumber(e,"liquidationPrice");const v=this.safeString(e,"isolatedMargin"),w=parseFloat(v),S=this.parseNumber(v),_=this.safeString(e,"markPrice");let O;0!==parseFloat(_)&&(O=this.parseNumber(_));const T=this.safeNumber(e,"entryPrice"),x=this.safeInteger(e,"updateTime"),C=this.parseNumber(h),I=k.stringMul(h,o),M=this.parseNumber(I);let N=k.stringDiv("1",b,8);1e3%g==0||(N=k.stringAdd(N,"1e-8"));const A=k.stringDiv(k.stringMul(o,N),"1",8),E=this.parseNumber(A);let P,B,V;0===w?y=void 0:(P=this.parseNumber(k.stringDiv(I,v,4)),B=d<0?"short":"long",V=this.parseNumber(k.stringMul(k.stringDiv(p,A,4),"100")));const L=this.safeString(e,"marginType");return"cross"===L&&(y=void 0),{info:e,symbol:i,contracts:f,unrealizedPnl:m,leverage:g,liquidationPrice:y,collateral:S,notional:u,markPrice:O,entryPrice:T,timestamp:x,initialMargin:E,initialMarginPercentage:this.parseNumber(N),maintenanceMargin:M,maintenanceMarginPercentage:C,marginRatio:P,datetime:this.iso8601(x),marginType:L,side:B,percentage:V}}async loadLeverageBrackets(e=!1,t={}){await this.loadMarkets();if(void 0===this.safeValue(this.options,"leverageBrackets")||e){let e;const s=this.safeString2(this.options,"fetchPositions","defaultType","future"),i=this.safeString(t,"type",s),r=this.omit(t,"type");if("future"===i)e="fapiPrivateGetLeverageBracket";else{if("delivery"!==i)throw new m(this.id+" loadLeverageBrackets() supports linear and inverse contracts only");e="dapiPrivateV2GetLeverageBracket"}const a=await this[e](r);this.options.leverageBrackets={};for(let e=0;e<a.length;e++){const t=a[e],s=this.safeString(t,"symbol"),i=this.safeSymbol(s),r=this.safeValue(t,"brackets"),n=[];for(let e=0;e<r.length;e++){const t=r[e],s=this.safeFloat2(t,"notionalFloor","qtyFloor"),i=this.safeString(t,"maintMarginRatio");n.push([s,i])}this.options.leverageBrackets[i]=n}}return this.options.leverageBrackets}async fetchPositions(e,t={}){let s;await this.loadMarkets(),await this.loadLeverageBrackets();const i=this.safeString2(this.options,"fetchPositions","defaultType","future"),r=this.safeString(t,"type",i),a=this.omit(t,"type");if("future"===r)s="fapiPrivateGetAccount";else{if("delivery"!==r)throw new m(this.id+" fetchPositions() supports linear and inverse contracts only");s="dapiPrivateGetAccount"}const n=await this[s](a),o=this.parseAccountPositions(n);return this.filterByArray(o,"symbol",e,!1)}async fetchIsolatedPositions(e,t={}){await this.loadMarkets(),await this.loadLeverageBrackets();const s={};let i,r,a="future";if(void 0!==e)if(i=this.market(e),s.symbol=i.id,i.linear)a="future";else{if(!i.inverse)throw m(this.id+" fetchIsolatedPositions() supports linear and inverse contracts only");a="delivery"}a=this.safeString2(this.options,"fetchIsolatedPositions","defaultType",a);const n=this.safeString(t,"type",a);if(t=this.omit(t,"type"),"future"===n||"linear"===n)r="fapiPrivateGetPositionRisk";else{if("delivery"!==n&&"inverse"!==n)throw m(this.id+" fetchIsolatedPositions() supports linear and inverse contracts only");r="dapiPrivateGetPositionRisk"}const o=await this[r](this.extend(s,t));if(void 0===e){const e=[];for(let t=0;t<o.length;t++){const s=this.parsePositionRisk(o[t],i);"isolated"===s.marginType&&e.push(s)}return e}return this.parsePositionRisk(this.safeValue(o,0),i)}async fetchFundingHistory(e,t,s,i={}){let r,a;await this.loadMarkets();let n="future";const o={incomeType:"FUNDING_FEE"};if(void 0!==e)if(r=this.market(e),o.symbol=r.id,r.linear)n="future";else{if(!r.inverse)throw m(this.id+" fetchFundingHistory() supports linear and inverse contracts only");n="delivery"}void 0!==t&&(o.startTime=t),void 0!==s&&(o.limit=s),n=this.safeString2(this.options,"fetchFundingHistory","defaultType",n);const c=this.safeString(i,"type",n);if(i=this.omit(i,"type"),"future"===c||"linear"===c)a="fapiPrivateGetIncome";else{if("delivery"!==c&&"inverse"!==c)throw m(this.id+" fetchFundingHistory() supports linear and inverse contracts only");a="dapiPrivateGetIncome"}const d=await this[a](this.extend(o,i));return this.parseIncomes(d,r,t,s)}async setLeverage(e,t,s={}){if(t<1||t>125)throw new b(this.id+" leverage should be between 1 and 125");await this.loadMarkets();const i=this.market(e);let r;if(i.linear)r="fapiPrivatePostLeverage";else{if(!i.inverse)throw m(this.id+" setLeverage() supports linear and inverse contracts only");r="dapiPrivatePostLeverage"}const a={symbol:i.id,leverage:t};return await this[r](this.extend(a,s))}async setMarginMode(e,t,s={}){if("ISOLATED"!==(t=t.toUpperCase())&&"CROSSED"!==t)throw new b(this.id+" marginType must be either isolated or crossed");await this.loadMarkets();const i=this.market(e);let r;if(i.linear)r="fapiPrivatePostMarginType";else{if(!i.inverse)throw m(this.id+" setMarginMode() supports linear and inverse contracts only");r="dapiPrivatePostMarginType"}const a={symbol:i.id,marginType:t};return await this[r](this.extend(a,s))}sign(e,t="public",s="GET",i={},r,a){if(!(t in this.urls.api))throw new m(this.id+" does not have a testnet/sandbox URL for "+t+" endpoints");let n=this.urls.api[t];if(n+="/"+e,"wapi"===t&&(n+=".html"),"historicalTrades"===e){if(!this.apiKey)throw new l(this.id+" historicalTrades endpoint requires `apiKey` credential");r={"X-MBX-APIKEY":this.apiKey}}if("userDataStream"===e||"listenKey"===e){if(!this.apiKey)throw new l(this.id+" userDataStream endpoint requires `apiKey` credential");r={"X-MBX-APIKEY":this.apiKey,"Content-Type":"application/x-www-form-urlencoded"},"GET"!==s&&(a=this.urlencode(i))}else if("private"===t||"sapi"===t||"wapi"===t&&"systemStatus"!==e||"dapiPrivate"===t||"dapiPrivateV2"===t||"fapiPrivate"===t||"fapiPrivateV2"===t){let o;this.checkRequiredCredentials();const c=this.safeInteger(this.options,"recvWindow",5e3);o="sapi"===t&&"asset/dust"===e?this.urlencodeWithArrayRepeat(this.extend({timestamp:this.nonce(),recvWindow:c},i)):"batchOrders"===e||e.indexOf("sub-account")>=0?this.rawencode(this.extend({timestamp:this.nonce(),recvWindow:c},i)):this.urlencode(this.extend({timestamp:this.nonce(),recvWindow:c},i));o+="&signature="+this.hmac(this.encode(o),this.encode(this.secret)),r={"X-MBX-APIKEY":this.apiKey},"GET"===s||"DELETE"===s||"wapi"===t?n+="?"+o:(a=o,r["Content-Type"]="application/x-www-form-urlencoded")}else Object.keys(i).length&&(n+="?"+this.urlencode(i));return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,u){if(418===e||429===e)throw new h(this.id+" "+e.toString()+" "+t+" "+n);if(e>=400){if(n.indexOf("Price * QTY is zero or less")>=0)throw new d(this.id+" order cost = amount * price is zero or less "+n);if(n.indexOf("LOT_SIZE")>=0)throw new d(this.id+" order amount should be evenly divisible by lot size "+n);if(n.indexOf("PRICE_FILTER")>=0)throw new d(this.id+" order price is invalid, i.e. exceeds allowed price precision, exceeds min price or max price limits or is invalid float value in general, use this.priceToPrecision (symbol, amount) "+n)}if(void 0===o)return;const l=this.safeValue(o,"success",!0);if(!l){const e=this.safeString(o,"msg");let t;if(void 0!==e){try{t=JSON.parse(e)}catch(e){t=void 0}void 0!==t&&(o=t)}}const f=this.safeString(o,"msg");void 0!==f&&(this.throwExactlyMatchedException(this.exceptions.exact,f,this.id+" "+f),this.throwBroadlyMatchedException(this.exceptions.broad,f,this.id+" "+f));const p=this.safeString(o,"code");if(void 0!==p){if("200"===p||"0"===p)return;if("-2015"===p&&this.options.hasAlreadyAuthenticatedSuccessfully)throw new h(this.id+" temporary banned: "+n);const e=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,p,e),new r(e)}if(!l)throw new r(this.id+" "+n)}async request(e,t="public",s="GET",i={},r,a){const n=await this.fetch2(e,t,s,i,r,a);return"private"!==t&&"wapi"!==t||(this.options.hasAlreadyAuthenticatedSuccessfully=!0),n}}},2483:(e,t,s)=>{"use strict";const i=s(6056);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"binancecoinm",name:"Binance COIN-M",urls:{logo:"https://user-images.githubusercontent.com/1294454/117738721-668c8d80-b205-11eb-8c49-3fad84c4a07f.jpg",doc:["https://binance-docs.github.io/apidocs/delivery/en/","https://binance-docs.github.io/apidocs/spot/en"]},options:{defaultType:"delivery",leverageBrackets:void 0},has:{fetchPositions:!0,fetchIsolatedPositions:!0,fetchFundingRate:!0,fetchFundingHistory:!0,setLeverage:!0,setMode:!0}})}async transferIn(e,t,s={}){return await this.futuresTransfer(e,t,3,s)}async transferOut(e,t,s={}){return await this.futuresTransfer(e,t,4,s)}}},3393:(e,t,s)=>{"use strict";const i=s(6056);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"binanceus",name:"Binance US",countries:["US"],certified:!1,pro:!0,urls:{logo:"https://user-images.githubusercontent.com/1294454/65177307-217b7c80-da5f-11e9-876e-0b748ba0a358.jpg",api:{web:"https://www.binance.us",sapi:"https://api.binance.us/sapi/v1",wapi:"https://api.binance.us/wapi/v3",public:"https://api.binance.us/api/v1",private:"https://api.binance.us/api/v3",v3:"https://api.binance.us/api/v3",v1:"https://api.binance.us/api/v1"},www:"https://www.binance.us",referral:"https://www.binance.us/?ref=35005074",doc:"https://github.com/binance-us/binance-official-api-docs",fees:"https://www.binance.us/en/fee/schedule"},fees:{trading:{tierBased:!0,percentage:!0,taker:.001,maker:.001}},options:{quoteOrderQty:!1}})}async fetchCurrencies(e={}){}}},2137:(e,t,s)=>{"use strict";const i=s(6056);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"binanceusdm",name:"Binance USDⓈ-M",urls:{logo:"https://user-images.githubusercontent.com/1294454/117738721-668c8d80-b205-11eb-8c49-3fad84c4a07f.jpg",doc:["https://binance-docs.github.io/apidocs/futures/en/","https://binance-docs.github.io/apidocs/spot/en"]},has:{fetchPositions:!0,fetchIsolatedPositions:!0,fetchFundingRate:!0,fetchFundingHistory:!0,setLeverage:!0,setMarginMode:!0},options:{defaultType:"future",leverageBrackets:void 0,marginTypes:{}}})}async transferIn(e,t,s={}){return await this.futuresTransfer(e,t,1,s)}async transferOut(e,t,s={}){return await this.futuresTransfer(e,t,2,s)}}},2455:(e,t,s)=>{"use strict";const i=s(8819),{ArgumentsRequired:r,ExchangeError:a,InvalidNonce:n,AuthenticationError:o,PermissionDenied:c}=s(3449),d=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bit2c",name:"Bit2C",countries:["IL"],rateLimit:3e3,has:{cancelOrder:!0,CORS:!1,createOrder:!0,fetchBalance:!0,fetchMyTrades:!0,fetchOpenOrders:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTrades:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/27766119-3593220e-5ece-11e7-8b3a-5a041f6bcc3f.jpg",api:"https://bit2c.co.il",www:"https://www.bit2c.co.il",referral:"https://bit2c.co.il/Aff/63bfed10-e359-420c-ab5a-ad368dab0baf",doc:["https://www.bit2c.co.il/home/api","https://github.com/OferE/bit2c"]},api:{public:{get:["Exchanges/{pair}/Ticker","Exchanges/{pair}/orderbook","Exchanges/{pair}/trades","Exchanges/{pair}/lasttrades"]},private:{post:["Merchant/CreateCheckout","Order/AddCoinFundsRequest","Order/AddFund","Order/AddOrder","Order/AddOrderMarketPriceBuy","Order/AddOrderMarketPriceSell","Order/CancelOrder","Order/AddCoinFundsRequest","Order/AddStopOrder","Payment/GetMyId","Payment/Send","Payment/Pay"],get:["Account/Balance","Account/Balance/v2","Order/MyOrders","Order/GetById","Order/AccountHistory","Order/OrderHistory"]}},markets:{"BTC/NIS":{id:"BtcNis",symbol:"BTC/NIS",base:"BTC",quote:"NIS",baseId:"Btc",quoteId:"Nis"},"ETH/NIS":{id:"EthNis",symbol:"ETH/NIS",base:"ETH",quote:"NIS",baseId:"Eth",quoteId:"Nis"},"BCH/NIS":{id:"BchabcNis",symbol:"BCH/NIS",base:"BCH",quote:"NIS",baseId:"Bchabc",quoteId:"Nis"},"LTC/NIS":{id:"LtcNis",symbol:"LTC/NIS",base:"LTC",quote:"NIS",baseId:"Ltc",quoteId:"Nis"},"ETC/NIS":{id:"EtcNis",symbol:"ETC/NIS",base:"ETC",quote:"NIS",baseId:"Etc",quoteId:"Nis"},"BTG/NIS":{id:"BtgNis",symbol:"BTG/NIS",base:"BTG",quote:"NIS",baseId:"Btg",quoteId:"Nis"},"BSV/NIS":{id:"BchsvNis",symbol:"BSV/NIS",base:"BSV",quote:"NIS",baseId:"Bchsv",quoteId:"Nis"},"GRIN/NIS":{id:"GrinNis",symbol:"GRIN/NIS",base:"GRIN",quote:"NIS",baseId:"Grin",quoteId:"Nis"}},fees:{trading:{maker:.005,taker:.005}},options:{fetchTradesMethod:"public_get_exchanges_pair_trades"},exceptions:{exact:{"Please provide valid APIkey":o},broad:{"Please provide valid nonce":n,"please approve new terms of use on site":c}}})}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetAccountBalanceV2(e),s={info:t,timestamp:void 0,datetime:void 0},i=Object.keys(this.currencies);for(let e=0;e<i.length;e++){const r=i[e],a=this.account(),n=this.currencyId(r).toUpperCase();n in t&&(a.free=this.safeString(t,"AVAILABLE_"+n),a.total=this.safeString(t,n)),s[r]=a}return this.parseBalance(s,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={pair:this.marketId(e)},r=await this.publicGetExchangesPairOrderbook(this.extend(i,s));return this.parseOrderBook(r,e)}async fetchTicker(e,t={}){await this.loadMarkets();const s={pair:this.marketId(e)},i=await this.publicGetExchangesPairTicker(this.extend(s,t)),r=this.milliseconds(),a=this.safeNumber(i,"av"),n=this.safeNumber(i,"a");let o;void 0!==n&&void 0!==a&&(o=n*a);const c=this.safeNumber(i,"ll");return{symbol:e,timestamp:r,datetime:this.iso8601(r),high:void 0,low:void 0,bid:this.safeNumber(i,"h"),bidVolume:void 0,ask:this.safeNumber(i,"l"),askVolume:void 0,vwap:void 0,open:void 0,close:c,last:c,previousClose:void 0,change:void 0,percentage:void 0,average:a,baseVolume:n,quoteVolume:o,info:i}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),n=this.options.fetchTradesMethod,o={pair:r.id};void 0!==t&&(o.date=parseInt(t)),void 0!==s&&(o.limit=s);const c=await this[n](this.extend(o,i));if("string"==typeof c)throw new a(c);return this.parseTrades(c,r,t,s)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();let n="privatePostOrderAddOrder";const o={Amount:i,Pair:this.marketId(e)};"market"===t?n+="MarketPrice"+this.capitalize(s):(o.Price=r,o.Total=i*r,o.IsBid="buy"===s);const c=await this[n](this.extend(o,a));return{info:c,id:c.NewOrder.id}}async cancelOrder(e,t,s={}){const i={id:e};return await this.privatePostOrderCancelOrder(this.extend(i,s))}async fetchOpenOrders(e,t,s,i={}){if(void 0===e)throw new r(this.id+" fetchOpenOrders() requires a symbol argument");await this.loadMarkets();const a=this.market(e),n={pair:a.id},o=await this.privateGetOrderMyOrders(this.extend(n,i)),c=this.safeValue(o,a.id,{}),d=this.safeValue(c,"ask",[]),h=this.safeValue(c,"bid",[]);return this.parseOrders(this.arrayConcat(d,h),a,t,s)}parseOrder(e,t){const s=this.safeInteger(e,"created"),i=this.safeNumber(e,"price"),r=this.safeNumber(e,"amount");let a;void 0!==t&&(a=t.symbol);let n=this.safeValue(e,"type");0===n?n="buy":1===n&&(n="sell");const o=this.safeString(e,"id"),c=this.safeString(e,"status");return this.safeOrder({id:o,clientOrderId:void 0,timestamp:s,datetime:this.iso8601(s),lastTradeTimestamp:void 0,status:c,symbol:a,type:void 0,timeInForce:void 0,postOnly:void 0,side:n,price:i,stopPrice:void 0,amount:r,filled:void 0,remaining:void 0,cost:void 0,trades:void 0,fee:void 0,info:e,average:void 0})}async fetchMyTrades(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==s&&(a.take=s),a.take=s,void 0!==t&&(a.toTime=this.ymd(this.milliseconds(),"."),a.fromTime=this.ymd(t,".")),void 0!==e&&(r=this.market(e),a.pair=r.id);const n=await this.privateGetOrderOrderHistory(this.extend(a,i));return this.parseTrades(n,r,t,s)}parseTrade(e,t){let s,i,r,a,n,o,c;const h=this.safeString(e,"reference");if(void 0!==h){s=this.safeTimestamp(e,"ticks"),r=this.safeString(e,"price"),a=this.safeString(e,"firstAmount");const d=h.split("|");if(void 0===t){const s=this.safeString(e,"pair");s in this.markets_by_id[s]?t=this.markets_by_id[s]:d[0]in this.markets_by_id&&(t=this.markets_by_id[d[0]])}n=d[1],i=d[2],c=this.safeInteger(e,"action"),0===c?c="buy":1===c&&(c="sell"),o=this.safeNumber(e,"feeAmount")}else s=this.safeTimestamp(e,"date"),i=this.safeString(e,"tid"),r=this.safeString(e,"price"),a=this.safeString(e,"amount"),c=this.safeValue(e,"isBid"),void 0!==c&&(c=c?"buy":"sell");let u;void 0!==t&&(u=t.symbol);const l=this.parseNumber(r),f=this.parseNumber(a),p=this.parseNumber(d.stringMul(r,a));return{info:e,id:i,timestamp:s,datetime:this.iso8601(s),symbol:u,order:n,type:void 0,side:c,takerOrMaker:void 0,price:l,amount:f,cost:p,fee:{cost:o,currency:"NIS",rate:void 0}}}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api+"/"+this.implodeParams(e,i);if("public"===t)n+=".json";else{this.checkRequiredCredentials();const e=this.nonce(),t=this.extend({nonce:e},i),o=this.urlencode(t);"GET"===s?Object.keys(t).length&&(n+="?"+o):a=o;const c=this.hmac(this.encode(o),this.encode(this.secret),"sha512","base64");r={"Content-Type":"application/x-www-form-urlencoded",key:this.apiKey,sign:c}}return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,n,o,c,d){if(void 0===o)return;const h=this.safeString(o,"error");if(void 0!==h){const e=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,h,e),this.throwBroadlyMatchedException(this.exceptions.broad,h,e),new a(e)}}}},9703:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,AuthenticationError:a,InvalidNonce:n,InsufficientFunds:o,InvalidOrder:c,OrderNotFound:d,PermissionDenied:h}=s(3449),u=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bitbank",name:"bitbank",countries:["JP"],version:"v1",has:{cancelOrder:!0,createOrder:!0,fetchBalance:!0,fetchDepositAddress:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTrades:!0,withdraw:!0},timeframes:{"1m":"1min","5m":"5min","15m":"15min","30m":"30min","1h":"1hour","4h":"4hour","8h":"8hour","12h":"12hour","1d":"1day","1w":"1week"},hostname:"bitbank.cc",urls:{logo:"https://user-images.githubusercontent.com/1294454/37808081-b87f2d9c-2e59-11e8-894d-c1900b7584fe.jpg",api:{public:"https://public.{hostname}",private:"https://api.{hostname}",markets:"https://api.{hostname}"},www:"https://bitbank.cc/",doc:"https://docs.bitbank.cc/",fees:"https://bitbank.cc/docs/fees/"},api:{public:{get:["{pair}/ticker","{pair}/depth","{pair}/transactions","{pair}/transactions/{yyyymmdd}","{pair}/candlestick/{candletype}/{yyyymmdd}"]},private:{get:["user/assets","user/spot/order","user/spot/active_orders","user/spot/trade_history","user/withdrawal_account"],post:["user/spot/order","user/spot/cancel_order","user/spot/cancel_orders","user/spot/orders_info","user/request_withdrawal"]},markets:{get:["spot/pairs"]}},exceptions:{20001:a,20002:a,20003:a,20005:a,20004:n,40020:c,40021:c,40025:r,40013:d,40014:d,50008:h,50009:d,50010:d,60001:o,60005:c}})}async fetchMarkets(e={}){const t=await this.marketsGetSpotPairs(e),s=this.safeValue(t,"data"),i=this.safeValue(s,"pairs",[]),r=[];for(let e=0;e<i.length;e++){const t=i[e],s=this.safeString(t,"name"),a=this.safeString(t,"base_asset"),n=this.safeString(t,"quote_asset"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d=o+"/"+c,h=this.safeNumber(t,"maker_fee_rate_quote"),l=this.safeNumber(t,"taker_fee_rate_quote"),f=this.safeString(t,"price_digits"),p=this.parsePrecision(f),m={price:parseInt(f),amount:this.safeInteger(t,"amount_digits")},b=this.safeValue(t,"is_enabled"),g=this.safeString(t,"unit_amount"),y=u.stringMul(g,p),v={amount:{min:this.safeNumber(t,"unit_amount"),max:this.safeNumber(t,"limit_max_amount")},price:{min:this.parseNumber(p),max:void 0},cost:{min:this.parseNumber(y),max:void 0}};r.push({info:t,id:s,symbol:d,baseId:a,quoteId:n,base:o,quote:c,precision:m,limits:v,active:b,maker:h,taker:l})}return r}parseTicker(e,t){let s;void 0!==t&&(s=t.symbol);const i=this.safeInteger(e,"timestamp"),r=this.safeNumber(e,"last");return{symbol:s,timestamp:i,datetime:this.iso8601(i),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"buy"),bidVolume:void 0,ask:this.safeNumber(e,"sell"),askVolume:void 0,vwap:void 0,open:void 0,close:r,last:r,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(e,"vol"),quoteVolume:void 0,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={pair:s.id},r=await this.publicGetPairTicker(this.extend(i,t)),a=this.safeValue(r,"data",{});return this.parseTicker(a,s)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={pair:this.marketId(e)},r=await this.publicGetPairDepth(this.extend(i,s)),a=this.safeValue(r,"data",{}),n=this.safeInteger(a,"timestamp");return this.parseOrderBook(a,e,n)}parseTrade(e,t){const s=this.safeInteger(e,"executed_at");let i,r;void 0!==t&&(i=t.symbol,r=t.quote);const a=this.safeString(e,"price"),n=this.safeString(e,"amount"),o=this.parseNumber(a),c=this.parseNumber(n),d=this.parseNumber(u.stringMul(a,n)),h=this.safeString2(e,"transaction_id","trade_id"),l=this.safeString(e,"maker_taker");let f;const p=this.safeNumber(e,"fee_amount_quote");void 0!==p&&(f={currency:r,cost:p});const m=this.safeString(e,"order_id"),b=this.safeString(e,"type"),g=this.safeString(e,"side");return{timestamp:s,datetime:this.iso8601(s),symbol:i,id:h,order:m,type:b,side:g,takerOrMaker:l,price:o,amount:c,cost:d,fee:f,info:e}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={pair:r.id},n=await this.publicGetPairTransactions(this.extend(a,i)),o=this.safeValue(n,"data",{}),c=this.safeValue(o,"transactions",[]);return this.parseTrades(c,r,t,s)}parseOHLCV(e,t){return[this.safeInteger(e,5),this.safeNumber(e,0),this.safeNumber(e,1),this.safeNumber(e,2),this.safeNumber(e,3),this.safeNumber(e,4)]}async fetchOHLCV(e,t="5m",s,i,r={}){await this.loadMarkets();const a=this.market(e);let n=this.milliseconds();n=this.ymd(n),n=n.split("-");const o={pair:a.id,candletype:this.timeframes[t],yyyymmdd:n.join("")},c=await this.publicGetPairCandlestickCandletypeYyyymmdd(this.extend(o,r)),d=this.safeValue(c,"data",{}),h=this.safeValue(d,"candlestick",[]),u=this.safeValue(h,0,{}),l=this.safeValue(u,"ohlcv",[]);return this.parseOHLCVs(l,a,t,s,i)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetUserAssets(e),s={info:t,timestamp:void 0,datetime:void 0},i=this.safeValue(t,"data",{}),r=this.safeValue(i,"assets",[]);for(let e=0;e<r.length;e++){const t=r[e],i=this.safeString(t,"asset"),a=this.safeCurrencyCode(i),n=this.account();n.free=this.safeString(t,"free_amount"),n.used=this.safeString(t,"locked_amount"),n.total=this.safeString(t,"onhand_amount"),s[a]=n}return this.parseBalance(s,!1)}parseOrderStatus(e){return this.safeString({UNFILLED:"open",PARTIALLY_FILLED:"open",FULLY_FILLED:"closed",CANCELED_UNFILLED:"canceled",CANCELED_PARTIALLY_FILLED:"canceled"},e,e)}parseOrder(e,t){const s=this.safeString(e,"order_id"),i=this.safeString(e,"pair");let r;i&&!t&&i in this.markets_by_id&&(t=this.markets_by_id[i]),void 0!==t&&(r=t.symbol);const a=this.safeInteger(e,"ordered_at"),n=this.safeNumber(e,"price"),o=this.safeNumber(e,"start_amount"),c=this.safeNumber(e,"executed_amount"),d=this.safeNumber(e,"remaining_amount"),h=this.safeNumber(e,"average_price"),u=this.parseOrderStatus(this.safeString(e,"status")),l=this.safeStringLower(e,"type"),f=this.safeStringLower(e,"side");return this.safeOrder({id:s,clientOrderId:void 0,datetime:this.iso8601(a),timestamp:a,lastTradeTimestamp:void 0,status:u,symbol:r,type:l,timeInForce:void 0,postOnly:void 0,side:f,price:n,stopPrice:void 0,cost:void 0,average:h,amount:o,filled:c,remaining:d,trades:void 0,fee:void 0,info:e})}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e);if(void 0===r)throw new c(this.id+" createOrder() requires a price argument for both market and limit orders");const o={pair:n.id,amount:this.amountToPrecision(e,i),price:this.priceToPrecision(e,r),side:s,type:t},d=await this.privatePostUserSpotOrder(this.extend(o,a)),h=this.safeValue(d,"data");return this.parseOrder(h,n)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={order_id:e,pair:this.market(t).id},r=await this.privatePostUserSpotCancelOrder(this.extend(i,s));return this.safeValue(r,"data")}async fetchOrder(e,t,s={}){await this.loadMarkets();const i=this.market(t),r={order_id:e,pair:i.id},a=await this.privateGetUserSpotOrder(this.extend(r,s)),n=this.safeValue(a,"data");return this.parseOrder(n,i)}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={pair:r.id};void 0!==s&&(a.count=s),void 0!==t&&(a.since=parseInt(t/1e3));const n=await this.privateGetUserSpotActiveOrders(this.extend(a,i)),o=this.safeValue(n,"data",{}),c=this.safeValue(o,"orders",[]);return this.parseOrders(c,r,t,s)}async fetchMyTrades(e,t,s,i={}){let r;await this.loadMarkets(),void 0!==e&&(r=this.market(e));const a={};void 0!==r&&(a.pair=r.id),void 0!==s&&(a.count=s),void 0!==t&&(a.since=parseInt(t/1e3));const n=await this.privateGetUserSpotTradeHistory(this.extend(a,i)),o=this.safeValue(n,"data",{}),c=this.safeValue(o,"trades",[]);return this.parseTrades(c,r,t,s)}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e),i={asset:s.id},r=await this.privateGetUserWithdrawalAccount(this.extend(i,t)),a=this.safeValue(r,"data",{}),n=this.safeValue(a,"accounts",[]),o=this.safeValue(n,0,{});return{currency:s,address:this.safeString(o,"address"),tag:void 0,info:r}}async withdraw(e,t,s,i,a={}){if(!("uuid"in a))throw new r(this.id+" uuid is required for withdrawal");await this.loadMarkets();const n={asset:this.currency(e).id,amount:t},o=await this.privatePostUserRequestWithdrawal(this.extend(n,a)),c=this.safeValue(o,"data",{});return{info:o,id:this.safeString(c,"txid")}}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n=this.omit(i,this.extractParams(e)),o=this.implodeParams(this.urls.api[t],{hostname:this.hostname})+"/";if("public"===t||"markets"===t)o+=this.implodeParams(e,i),Object.keys(n).length&&(o+="?"+this.urlencode(n));else{this.checkRequiredCredentials();const t=this.nonce().toString();let c=t;o+=this.version+"/"+this.implodeParams(e,i),"POST"===s?c+=a=this.json(n):(c+="/"+this.version+"/"+e,Object.keys(n).length&&(n=this.urlencode(n),o+="?"+n,c+="?"+n)),r={"Content-Type":"application/json","ACCESS-KEY":this.apiKey,"ACCESS-NONCE":t,"ACCESS-SIGNATURE":this.hmac(this.encode(c),this.encode(this.secret))}}return{url:o,method:s,body:a,headers:r}}async request(e,t="public",s="GET",i={},a,n){const o=await this.fetch2(e,t,s,i,a,n),c=this.safeInteger(o,"success"),d=this.safeValue(o,"data");if(!c||!d){const e={1e4:"URL does not exist",10001:"A system error occurred. Please contact support",10002:"Invalid JSON format. Please check the contents of transmission",10003:"A system error occurred. Please contact support",10005:"A timeout error occurred. Please wait for a while and try again",20001:"API authentication failed",20002:"Illegal API key",20003:"API key does not exist",20004:"API Nonce does not exist",20005:"API signature does not exist",20011:"Two-step verification failed",20014:"SMS authentication failed",30001:"Please specify the order quantity",30006:"Please specify the order ID",30007:"Please specify the order ID array",30009:"Please specify the stock",30012:"Please specify the order price",30013:"Trade Please specify either",30015:"Please specify the order type",30016:"Please specify asset name",30019:"Please specify uuid",30039:"Please specify the amount to be withdrawn",40001:"The order quantity is invalid",40006:"Count value is invalid",40007:"End time is invalid",40008:"end_id Value is invalid",40009:"The from_id value is invalid",40013:"The order ID is invalid",40014:"The order ID array is invalid",40015:"Too many specified orders",40017:"Incorrect issue name",40020:"The order price is invalid",40021:"The trading classification is invalid",40022:"Start date is invalid",40024:"The order type is invalid",40025:"Incorrect asset name",40028:"uuid is invalid",40048:"The amount of withdrawal is illegal",50003:"Currently, this account is in a state where you can not perform the operation you specified. Please contact support",50004:"Currently, this account is temporarily registered. Please try again after registering your account",50005:"Currently, this account is locked. Please contact support",50006:"Currently, this account is locked. Please contact support",50008:"User identification has not been completed",50009:"Your order does not exist",50010:"Can not cancel specified order",50011:"API not found",60001:"The number of possessions is insufficient",60002:"It exceeds the quantity upper limit of the tender buying order",60003:"The specified quantity exceeds the limit",60004:"The specified quantity is below the threshold",60005:"The specified price is above the limit",60006:"The specified price is below the lower limit",70001:"A system error occurred. Please contact support",70002:"A system error occurred. Please contact support",70003:"A system error occurred. Please contact support",70004:"We are unable to accept orders as the transaction is currently suspended",70005:"Order can not be accepted because purchase order is currently suspended",70006:"We can not accept orders because we are currently unsubscribed ",70009:"We are currently temporarily restricting orders to be carried out. Please use the limit order.",70010:"We are temporarily raising the minimum order quantity as the system load is now rising."},t=this.exceptions,s=this.safeString(d,"code"),i=this.safeString(e,s,"Error"),a=this.safeValue(t,s);throw void 0!==a?new a(i):new r(this.id+" "+this.json(o))}return o}}},3528:(e,t,s)=>{"use strict";const i=s(8819),{InvalidNonce:r,InsufficientFunds:a,AuthenticationError:n,InvalidOrder:o,ExchangeError:c,OrderNotFound:d,AccountSuspended:h,BadSymbol:u,OrderImmediatelyFillable:l,RateLimitExceeded:f,OnMaintenance:p,PermissionDenied:m}=s(3449),b=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bitbay",name:"BitBay",countries:["MT","EU"],rateLimit:1e3,has:{cancelOrder:!0,CORS:!0,createOrder:!0,fetchBalance:!0,fetchLedger:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTrades:!0,withdraw:!0},timeframes:{"1m":"60","3m":"180","5m":"300","15m":"900","30m":"1800","1h":"3600","2h":"7200","4h":"14400","6h":"21600","12h":"43200","1d":"86400","3d":"259200","1w":"604800"},hostname:"bitbay.net",urls:{referral:"https://auth.bitbay.net/ref/jHlbB4mIkdS1",logo:"https://user-images.githubusercontent.com/1294454/27766132-978a7bd8-5ece-11e7-9540-bc96d1e9bbb8.jpg",www:"https://bitbay.net",api:{public:"https://{hostname}/API/Public",private:"https://{hostname}/API/Trading/tradingApi.php",v1_01Public:"https://api.{hostname}/rest",v1_01Private:"https://api.{hostname}/rest"},doc:["https://bitbay.net/public-api","https://bitbay.net/en/private-api","https://bitbay.net/account/tab-api","https://github.com/BitBayNet/API","https://docs.bitbay.net/v1.0.1-en/reference"],support:"https://support.bitbay.net",fees:"https://bitbay.net/en/fees"},api:{public:{get:["{id}/all","{id}/market","{id}/orderbook","{id}/ticker","{id}/trades"]},private:{post:["info","trade","cancel","orderbook","orders","transfer","withdraw","history","transactions"]},v1_01Public:{get:["trading/ticker","trading/ticker/{symbol}","trading/stats","trading/orderbook/{symbol}","trading/transactions/{symbol}","trading/candle/history/{symbol}/{resolution}"]},v1_01Private:{get:["payments/withdrawal/{detailId}","payments/deposit/{detailId}","trading/offer","trading/config/{symbol}","trading/history/transactions","balances/BITBAY/history","balances/BITBAY/balance","fiat_cantor/rate/{baseId}/{quoteId}","fiat_cantor/history"],post:["trading/offer/{symbol}","trading/config/{symbol}","balances/BITBAY/balance","balances/BITBAY/balance/transfer/{source}/{destination}","fiat_cantor/exchange"],delete:["trading/offer/{symbol}/{id}/{side}/{price}"],put:["balances/BITBAY/balance/{id}"]}},fees:{trading:{maker:0,taker:.001,percentage:!0,tierBased:!1},fiat:{maker:.003,taker:.0043,percentage:!0,tierBased:!0,tiers:{taker:[[.0043,0],[.0042,1250],[.0041,3750],[.004,7500],[.0039,1e4],[.0038,15e3],[.0037,2e4],[.0036,25e3],[.0035,37500],[.0034,5e4],[.0033,75e3],[.0032,1e5],[.0031,15e4],[.003,2e5],[.0029,25e4],[.0028,375e3],[.0027,5e5],[.0026,625e3],[.0025,875e3]],maker:[[.003,0],[.0029,1250],[.0028,3750],[.0028,7500],[.0027,1e4],[.0026,15e3],[.0025,2e4],[.0025,25e3],[.0024,37500],[.0023,5e4],[.0023,75e3],[.0022,1e5],[.0021,15e4],[.0021,2e5],[.002,25e4],[.0019,375e3],[.0018,5e5],[.0018,625e3],[.0017,875e3]]}},funding:{withdraw:{BTC:9e-4,LTC:.005,ETH:.00126,LSK:.2,BCH:6e-4,GAME:.005,DASH:.001,BTG:8e-4,PLN:4,EUR:1.5}}},options:{fiatCurrencies:["EUR","USD","GBP","PLN"]},exceptions:{400:c,401:o,402:o,403:o,404:o,405:o,406:a,408:o,501:n,502:n,503:r,504:c,505:n,506:h,509:c,510:u,FUNDS_NOT_SUFFICIENT:a,OFFER_FUNDS_NOT_EXCEEDING_MINIMUMS:o,OFFER_NOT_FOUND:d,OFFER_WOULD_HAVE_BEEN_PARTIALLY_FILLED:l,ACTION_LIMIT_EXCEEDED:f,UNDER_MAINTENANCE:p,REQUEST_TIMESTAMP_TOO_OLD:r,PERMISSIONS_NOT_SUFFICIENT:m},commonCurrencies:{GGC:"Global Game Coin"}})}async fetchMarkets(e={}){const t=await this.v1_01PublicGetTradingTicker(e),s=this.safeValue(this.options,"fiatCurrencies",[]),i=[],r=this.safeValue(t,"items"),a=Object.keys(r);for(let e=0;e<a.length;e++){const t=r[a[e]],n=this.safeValue(t,"market",{}),o=this.safeValue(n,"first",{}),c=this.safeValue(n,"second",{}),d=this.safeString(o,"currency"),h=this.safeString(c,"currency"),u=d+h,l=this.safeCurrencyCode(d),f=this.safeCurrencyCode(h),p=l+"/"+f,m={amount:this.safeInteger(o,"scale"),price:this.safeInteger(c,"scale")};let b=this.safeValue(this.fees,"trading",{});(this.inArray(l,s)||this.inArray(f,s))&&(b=this.safeValue(this.fees,"fiat",{}));const g=this.safeNumber(b,"maker"),y=this.safeNumber(b,"taker");i.push({id:u,symbol:p,base:l,quote:f,baseId:d,quoteId:h,precision:m,active:void 0,maker:g,taker:y,limits:{amount:{min:this.safeNumber(o,"minOffer"),max:void 0},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(c,"minOffer"),max:void 0}},info:t})}return i}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r=await this.v1_01PrivateGetTradingOffer(this.extend({},i)),a=this.safeValue(r,"items",[]);return this.parseOrders(a,void 0,t,s,{status:"open"})}parseOrder(e,t){const s=this.safeString(e,"market"),i=this.safeSymbol(s,t,"-"),r=this.safeInteger(e,"time"),a=this.safeNumber(e,"startAmount"),n=this.safeNumber(e,"currentAmount"),o=this.safeValue(e,"postOnly");return this.safeOrder({id:this.safeString(e,"id"),clientOrderId:void 0,info:e,timestamp:r,datetime:this.iso8601(r),lastTradeTimestamp:void 0,status:void 0,symbol:i,type:this.safeString(e,"mode"),timeInForce:void 0,postOnly:o,side:this.safeStringLower(e,"offerType"),price:this.safeNumber(e,"rate"),stopPrice:void 0,amount:a,cost:void 0,filled:void 0,remaining:n,average:void 0,fee:void 0,trades:void 0})}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={};if(e){const t=[this.marketId(e)];r.markets=t}const a={query:this.json(this.extend(r,i))},n=await this.v1_01PrivateGetTradingHistoryTransactions(a),o=this.safeValue(n,"items"),c=this.parseTrades(o,void 0,t,s);return void 0===e?c:this.filterBySymbol(c,e)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.v1_01PrivateGetBalancesBITBAYBalance(e),s=this.safeValue(t,"balances");if(void 0===s)throw new c(this.id+" empty balance response "+this.json(t));const i={info:t};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"currency"),a=this.safeCurrencyCode(r),n=this.account();n.used=this.safeString(t,"lockedFunds"),n.free=this.safeString(t,"availableFunds"),i[a]=n}return this.parseBalance(i,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={id:this.marketId(e)},r=await this.publicGetIdOrderbook(this.extend(i,s));return this.parseOrderBook(r,e)}async fetchTicker(e,t={}){await this.loadMarkets();const s={id:this.marketId(e)},i=await this.publicGetIdTicker(this.extend(s,t)),r=this.milliseconds(),a=this.safeNumber(i,"volume"),n=this.safeNumber(i,"vwap");let o;void 0!==a&&void 0!==n&&(o=a*n);const c=this.safeNumber(i,"last");return{symbol:e,timestamp:r,datetime:this.iso8601(r),high:this.safeNumber(i,"max"),low:this.safeNumber(i,"min"),bid:this.safeNumber(i,"bid"),bidVolume:void 0,ask:this.safeNumber(i,"ask"),askVolume:void 0,vwap:n,open:void 0,close:c,last:c,previousClose:void 0,change:void 0,percentage:void 0,average:this.safeNumber(i,"average"),baseVolume:a,quoteVolume:o,info:i}}async fetchLedger(e,t,s,i={}){const r=[];if(void 0!==e){const t=this.currency(e);r.push(t.id)}let a={balanceCurrencies:r};void 0!==t&&(a.fromTime=t),void 0!==s&&(a.limit=s),a=this.extend(a,i);const n=(await this.v1_01PrivateGetBalancesBITBAYHistory({query:this.json(a)})).items;return this.parseLedger(n,void 0,t,s)}parseLedgerEntry(e,t){const s=this.safeInteger(e,"time"),i=this.safeValue(e,"balance",{}),r=this.safeString(i,"currency"),a=this.safeCurrencyCode(r),n=this.safeValue(e,"change",{});let o=this.safeNumber(n,"total"),c="in";o<0&&(c="out",o=-o);const d=this.safeString(e,"historyId"),h=this.safeString(e,"detailId"),u=this.parseLedgerEntryType(this.safeString(e,"type")),l=this.safeValue(e,"fundsBefore",{}),f=this.safeNumber(l,"total"),p=this.safeValue(e,"fundsAfter",{});return{info:e,id:d,direction:c,account:void 0,referenceId:h,referenceAccount:void 0,type:u,currency:a,amount:o,before:f,after:this.safeNumber(p,"total"),status:"ok",timestamp:s,datetime:this.iso8601(s),fee:void 0}}parseLedgerEntryType(e){return this.safeString({ADD_FUNDS:"transaction",BITCOIN_GOLD_FORK:"transaction",CREATE_BALANCE:"transaction",FUNDS_MIGRATION:"transaction",WITHDRAWAL_LOCK_FUNDS:"transaction",WITHDRAWAL_SUBTRACT_FUNDS:"transaction",WITHDRAWAL_UNLOCK_FUNDS:"transaction",TRANSACTION_COMMISSION_OUTCOME:"fee",TRANSACTION_COMMISSION_RETURN:"fee",TRANSACTION_OFFER_ABORTED_RETURN:"trade",TRANSACTION_OFFER_COMPLETED_RETURN:"trade",TRANSACTION_POST_INCOME:"trade",TRANSACTION_POST_OUTCOME:"trade",TRANSACTION_PRE_LOCKING:"trade"},e,e)}parseOHLCV(e,t){const s=this.safeValue(e,1,{});return[this.safeInteger(e,0),this.safeNumber(s,"o"),this.safeNumber(s,"h"),this.safeNumber(s,"l"),this.safeNumber(s,"c"),this.safeNumber(s,"v")]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={symbol:a.baseId+"-"+a.quoteId,resolution:this.timeframes[t]};void 0===i&&(i=100);const o=i*this.parseTimeframe(t)*1e3;void 0===s?(n.to=this.milliseconds(),n.from=n.to-o):(n.from=parseInt(s),n.to=this.sum(n.from,o));const c=await this.v1_01PublicGetTradingCandleHistorySymbolResolution(this.extend(n,r)),d=this.safeValue(c,"items",[]);return this.parseOHLCVs(d,a,t,s,i)}parseTrade(e,t){const s=this.safeInteger2(e,"time","t"),i="Buy"===this.safeString(e,"userAction")?"buy":"sell",r=this.safeValue(e,"wasTaker");let a;void 0!==r&&(a=r?"taker":"maker");const n=this.safeString2(e,"rate","r"),o=this.safeString2(e,"amount","a"),c=this.parseNumber(n),d=this.parseNumber(o),h=this.parseNumber(b.stringMul(n,o)),u=this.safeNumber(e,"commissionValue"),l=this.safeString(e,"market"),f=(t=this.safeMarket(l,t,"-")).symbol;let p;if(void 0!==u){p={currency:"buy"===i?t.base:t.quote,cost:u}}const m=this.safeString(e,"offerId");let g;return void 0!==m&&(g=m?"limit":"market"),{id:this.safeString(e,"id"),order:m,timestamp:s,datetime:this.iso8601(s),symbol:f,type:g,side:i,price:c,amount:d,cost:h,takerOrMaker:a,fee:p,info:e}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.baseId+"-"+r.quoteId};void 0!==t&&(a.fromTime=t-1),void 0!==s&&(a.limit=s);const n=await this.v1_01PublicGetTradingTransactionsSymbol(this.extend(a,i)),o=this.safeValue(n,"items");return this.parseTrades(o,r,t,s)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o={symbol:n.baseId+"-"+n.quoteId,offerType:s,amount:i,mode:t};"limit"===t&&(o.rate=r,r=parseFloat(r)),i=parseFloat(i);const c=await this.v1_01PrivatePostTradingOfferSymbol(this.extend(o,a)),d=this.milliseconds(),h=this.safeString(c,"offerId"),u=this.safeValue(c,"completed",!1)?"closed":"open";let l,f=0;const p=this.safeValue(c,"transactions");let m;if(void 0!==p){m=this.parseTrades(p,n,void 0,void 0,{timestamp:d,datetime:this.iso8601(d),symbol:e,side:s,type:t,orderId:h}),l=0;for(let e=0;e<m.length;e++)f=this.sum(f,m[e].amount),l=this.sum(l,m[e].cost)}const b=i-f;return{id:h,info:c,timestamp:d,datetime:this.iso8601(d),lastTradeTimestamp:void 0,status:u,symbol:e,type:t,side:s,price:r,amount:i,cost:l,filled:f,remaining:b,average:void 0,fee:void 0,trades:m,clientOrderId:void 0}}async cancelOrder(e,t,s={}){const i=this.safeString(s,"side");if(void 0===i)throw new c(this.id+' cancelOrder() requires a `side` parameter ("buy" or "sell")');const r=this.safeValue(s,"price");if(void 0===r)throw new c(this.id+" cancelOrder() requires a `price` parameter (float or string)");await this.loadMarkets();const a=this.market(t),n={symbol:a.baseId+"-"+a.quoteId,id:e,side:i,price:r};return this.v1_01PrivateDeleteTradingOfferSymbolIdSidePrice(this.extend(n,s))}isFiat(e){return this.safeValue({USD:!0,EUR:!0,PLN:!0},e,!1)}async withdraw(e,t,s,i,r={}){let a;this.checkAddress(s),await this.loadMarkets();const n={currency:this.currency(e).id,quantity:t};this.isFiat(e)?a="privatePostWithdraw":(a="privatePostTransfer",void 0!==i&&(s+="?dt="+i.toString()),n.address=s);return{info:await this[a](this.extend(n,r)),id:void 0}}sign(e,t="public",s="GET",i={},r,a){let n=this.implodeParams(this.urls.api[t],{hostname:this.hostname});if("public"===t){const t=this.omit(i,this.extractParams(e));n+="/"+this.implodeParams(e,i)+".json",Object.keys(t).length&&(n+="?"+this.urlencode(t))}else if("v1_01Public"===t){const t=this.omit(i,this.extractParams(e));n+="/"+this.implodeParams(e,i),Object.keys(t).length&&(n+="?"+this.urlencode(t))}else if("v1_01Private"===t){this.checkRequiredCredentials();const t=this.omit(i,this.extractParams(e));n+="/"+this.implodeParams(e,i);const o=this.milliseconds().toString();let c;"POST"!==s?(Object.keys(t).length&&(n+="?"+this.urlencode(t)),c=this.apiKey+o):void 0===a&&(a=this.json(t),c=this.apiKey+o+a),r={"Request-Timestamp":o,"Operation-Id":this.uuid(),"API-Key":this.apiKey,"API-Hash":this.hmac(this.encode(c),this.encode(this.secret),"sha512"),"Content-Type":"application/json"}}else this.checkRequiredCredentials(),a=this.urlencode(this.extend({method:e,moment:this.nonce()},i)),r={"Content-Type":"application/x-www-form-urlencoded","API-Key":this.apiKey,"API-Hash":this.hmac(this.encode(a),this.encode(this.secret),"sha512")};return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,a,n,o,d){if(void 0!==n){if("code"in n){const e=this.safeString(n,"code"),t=this.id+" "+a;throw this.throwExactlyMatchedException(this.exceptions,e,t),new c(t)}if("status"in n){if("Fail"===this.safeString(n,"status")){const e=this.safeValue(n,"errors"),t=this.id+" "+a;for(let s=0;s<e.length;s++){const i=e[s];this.throwExactlyMatchedException(this.exceptions,i,t)}throw new c(t)}}}}}},8875:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,InsufficientFunds:n,OrderNotFound:o,BadRequest:c,BadSymbol:d}=s(3449),h=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bitbns",name:"Bitbns",countries:["IN"],rateLimit:1e3,certified:!1,pro:!1,has:{cancelOrder:!0,createOrder:!0,fetchBalance:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!1,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchStatus:!0,fetchTicker:"emulated",fetchTickers:!0,fetchTrades:!1,fetchWithdrawals:!0},timeframes:{},urls:{logo:"https://user-images.githubusercontent.com/1294454/117201933-e7a6e780-adf5-11eb-9d80-98fc2a21c3d6.jpg",api:{ccxt:"https://bitbns.com/order",v1:"https://api.bitbns.com/api/trade/v1",v2:"https://api.bitbns.com/api/trade/v2"},www:"https://bitbns.com",referral:"https://ref.bitbns.com/1090961",doc:["https://bitbns.com/trade/#/api-trading/"],fees:"https://bitbns.com/fees"},api:{ccxt:{get:["fetchMarkets","fetchTickers","fetchOrderbook"]},v1:{get:["platform/status","tickers","orderbook/sell/{symbol}","orderbook/buy/{symbol}"],post:["currentCoinBalance/EVERYTHING","getApiUsageStatus/USAGE","getOrderSocketToken/USAGE","currentCoinBalance/{symbol}","orderStatus/{symbol}","depositHistory/{symbol}","withdrawHistory/{symbol}","listOpenOrders/{symbol}","listOpenStopOrders/{symbol}","getCoinAddress/{symbol}","placeSellOrder/{symbol}","placeBuyOrder/{symbol}","buyStopLoss/{symbol}","placeSellOrder/{symbol}","cancelOrder/{symbol}","cancelStopLossOrder/{symbol}","listExecutedOrders/{symbol}"]},v2:{post:["orders","cancel","getordersnew","marginOrders"]}},fees:{trading:{feeSide:"quote",tierBased:!1,percentage:!0,taker:.0025,maker:.0025}},exceptions:{exact:{400:c,409:d,416:n,417:o},broad:{}}})}async fetchStatus(e={}){const t=await this.v1GetPlatformStatus(e);let s=this.safeString(t,"status");return void 0!==s&&(s="1"===s?"ok":"maintenance",this.status=this.extend(this.status,{status:s,updated:this.milliseconds()})),this.status}async fetchMarkets(e={}){const t=await this.ccxtGetFetchMarkets(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"id"),a=this.safeString(i,"base"),n=this.safeString(i,"quote"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d=o+"/"+c,h=this.safeValue(i,"precision",{}),u={amount:this.safeInteger(h,"amount"),price:this.safeInteger(h,"price")},l=this.safeValue(i,"limits",{}),f=this.safeValue(l,"amount",{}),p=this.safeValue(l,"price",{}),m=this.safeValue(l,"cost",{}),b="USDT"===n?a+"_"+n:a;s.push({id:r,uppercaseId:b,symbol:d,base:o,quote:c,baseId:a,quoteId:n,info:i,active:void 0,precision:u,limits:{amount:{min:this.safeNumber(f,"min"),max:this.safeNumber(f,"max")},price:{min:this.safeNumber(p,"min"),max:this.safeNumber(p,"max")},cost:{min:this.safeNumber(m,"min"),max:this.safeNumber(m,"max")}}})}return s}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.market(e).id};void 0!==t&&(i.limit=t);const r=await this.ccxtGetFetchOrderbook(this.extend(i,s)),a=this.safeInteger(r,"timestamp");return this.parseOrderBook(r,a)}parseTicker(e,t){const s=this.safeInteger(e,"timestamp"),i=this.safeString(e,"symbol"),r=this.safeSymbol(i,t),a=this.safeNumber(e,"last");return{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"bid"),bidVolume:this.safeNumber(e,"bidVolume"),ask:this.safeNumber(e,"ask"),askVolume:this.safeNumber(e,"askVolume"),vwap:this.safeNumber(e,"vwap"),open:this.safeNumber(e,"open"),close:a,last:a,previousClose:this.safeNumber(e,"previousClose"),change:this.safeNumber(e,"change"),percentage:this.safeNumber(e,"percentage"),average:this.safeNumber(e,"average"),baseVolume:this.safeNumber(e,"baseVolume"),quoteVolume:this.safeNumber(e,"quoteVolume"),info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.ccxtGetFetchTickers(t);return this.parseTickers(s,e)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.v1PostCurrentCoinBalanceEVERYTHING(e),s=void 0,i={info:t,timestamp:s,datetime:this.iso8601(s)},r=this.safeValue(t,"data",{}),a=Object.keys(r);for(let e=0;e<a.length;e++){const t=a[e],s=t.split("availableorder");if(s.length>1){const e=this.safeString(s,1);if("Money"!==e){const s=this.safeCurrencyCode(e),a=this.account();a.free=this.safeString(r,t),a.used=this.safeString(r,"inorder"+e),i[s]=a}}}return this.parseBalance(i,!1)}parseOrderStatus(e){return this.safeString({0:"open"},e,e)}parseOrder(e,t){const s=this.safeString2(e,"id","entry_id"),i=this.safeString(e,"symbol"),r=this.safeSymbol(i,t),a=this.parse8601(this.safeString(e,"time")),n=this.safeNumber(e,"rate"),o=this.safeNumber2(e,"amount","btc"),c=this.safeNumber(e,"filled"),d=this.safeNumber(e,"remaining"),h=this.safeNumber(e,"avg_cost"),u=this.safeNumber(e,"cost");let l=this.safeStringLower(e,"type");"0"===l&&(l="limit");const f=this.parseOrderStatus(this.safeString(e,"status")),p=this.safeStringLower(e,"side"),m=this.safeNumber(e,"fee");let b;if(void 0!==m){b={cost:m,currency:void 0}}return this.safeOrder({info:e,id:s,clientOrderId:void 0,timestamp:a,datetime:this.iso8601(a),lastTradeTimestamp:void 0,symbol:r,type:l,timeInForce:void 0,postOnly:void 0,side:p,price:n,stopPrice:void 0,amount:o,cost:u,average:h,filled:c,remaining:d,status:f,fee:b,trades:void 0})}async createOrder(e,t,s,i,a,n={}){if("limit"!==t)throw new r(this.id+" allows limit orders only");await this.loadMarkets();const o=this.market(e),c={side:s.toUpperCase(),symbol:o.baseId+"_"+o.quoteId,quantity:this.amountToPrecision(e,i),rate:this.priceToPrecision(e,a)},d=await this.v2PostOrders(this.extend(c,n));return this.parseOrder(d,o)}async cancelOrder(e,t,s={}){if(void 0===t)throw new a(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r="USDT"===i.quoteId?"usdtcancelOrder":"cancelOrder",n={entry_id:e,symbol:i.uppercaseId,side:r},o=await this.v2PostCancel(this.extend(n,s));return this.parseOrder(o,i)}async fetchOrder(e,t,s={}){if(void 0===t)throw new a(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={symbol:i.id,entry_id:e},n=await this.v1PostOrderStatusSymbol(this.extend(r,s)),o=this.safeValue(n,"data",[]),c=this.safeValue(o,0);return this.parseOrder(c,i)}async fetchOpenOrders(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),n="USDT"===r.quoteId?"usdtListOpenOrders":"listOpenOrders",o={symbol:r.uppercaseId,side:n,page:0},c=await this.v2PostGetordersnew(this.extend(o,i)),d=this.safeValue(c,"data",[]);return this.parseOrders(d,r,t,s)}parseTrade(e,t){t=this.safeMarket(void 0,t);const s=this.safeString(e,"id"),i=this.parse8601(this.safeString(e,"date")),r=this.safeString(e,"amount"),a=this.safeString(e,"rate"),n=this.parseNumber(a),o=this.safeString(e,"factor"),c=h.stringDiv(r,o),d=this.parseNumber(c),u=this.parseNumber(h.stringMul(a,c)),l=t.symbol;let f,p=this.safeStringLower(e,"type");p.indexOf("sell")>=0?p="sell":p.indexOf("buy")>=0&&(p="buy");const m=this.safeNumber(e,"fee");if(void 0!==m){f={cost:m,currency:t.quote}}return{info:e,timestamp:i,datetime:this.iso8601(i),symbol:l,id:void 0,order:s,type:void 0,side:p,takerOrMaker:void 0,price:n,amount:d,cost:u,fee:f}}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),n={symbol:r.id,page:0};void 0!==t&&(n.since=this.iso8601(t));const o=await this.v1PostListExecutedOrdersSymbol(this.extend(n,i)),c=this.safeValue(o,"data",[]);return this.parseTrades(c,r,t,s)}async fetchDeposits(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchDeposits() requires a currency code argument");await this.loadMarkets();const r=this.currency(e),n={symbol:r.id,page:0},o=await this.v1PostDepositHistorySymbol(this.extend(n,i)),c=this.safeValue(o,"data",[]);return this.parseTransactions(c,r,t,s)}async fetchWithdrawals(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchWithdrawals() requires a currency code argument");await this.loadMarkets();const r=this.currency(e),n={symbol:r.id,page:0},o=await this.v1PostWithdrawHistorySymbol(this.extend(n,i)),c=this.safeValue(o,"data",[]);return this.parseTransactions(c,r,t,s)}parseTransactionStatusByType(e,t){const s=this.safeValue({deposit:{0:"pending",1:"ok"},withdrawal:{0:"pending",1:"canceled",2:"pending",3:"failed",4:"pending",5:"failed",6:"ok"}},t,{});return this.safeString(s,e,e)}parseTransaction(e,t){const s=this.safeString(e,"unit"),i=this.safeCurrencyCode(s,t),r=this.parse8601(this.safeString(e,"date"));let a,n=this.safeString(e,"type");void 0!==n&&(n.indexOf("deposit")>=0?(n="deposit",a="ok"):n.indexOf("withdraw")>=0&&(n="withdrawal"));const o=this.safeNumber(e,"amount"),c=this.safeNumber(e,"fee");let d;return void 0!==c&&(d={currency:i,cost:c}),{info:e,id:void 0,txid:void 0,timestamp:r,datetime:this.iso8601(r),address:void 0,addressTo:void 0,addressFrom:void 0,tag:void 0,tagTo:void 0,tagFrom:void 0,type:n,amount:o,currency:i,status:a,updated:void 0,internal:void 0,fee:d}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={symbol:this.currency(e).id},i=await this.v1PostGetCoinAddressSymbol(this.extend(s,t)),r=this.safeValue(i,"data",{}),a=this.safeString(r,"token"),n=this.safeString(r,"tag");return this.checkAddress(a),{currency:e,address:a,tag:n,info:i}}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a={coin:this.currency(e).id,address:s,amount:t};void 0!==i&&(a.addressTag=i);const n=await this.sapiPostCapitalWithdrawApply(this.extend(a,r));return{info:n,id:this.safeString(n,"id")}}nonce(){return this.milliseconds()}sign(e,t="v1",s="GET",i={},r,a){this.checkRequiredCredentials();let n=this.implodeParams(this.urls.api[t],{hostname:this.hostname})+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e)),c=this.nonce().toString();if(r={"X-BITBNS-APIKEY":this.apiKey},"GET"===s)Object.keys(o).length&&(n+="?"+this.urlencode(o));else if("POST"===s){const e={timeStamp_nonce:c,body:a=Object.keys(o).length?this.json(o):"{}"},t=this.stringToBase64(this.json(e)),s=this.hmac(t,this.encode(this.secret),"sha512");r["X-BITBNS-PAYLOAD"]=this.decode(t),r["X-BITBNS-SIGNATURE"]=s,r["Content-Type"]="application/x-www-form-urlencoded"}return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0===o)return;const h=this.safeString(o,"code"),u=this.safeString(o,"msg");if(void 0!==h&&"200"!==h||void 0!==u){const e=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,h,e),this.throwExactlyMatchedException(this.exceptions.exact,u,e),this.throwBroadlyMatchedException(this.exceptions.broad,u,e),new r(e)}}}},3334:(e,t,s)=>{"use strict";const i=s(8267);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bitcoincom",name:"bitcoin.com",countries:["KN"],urls:{logo:"https://user-images.githubusercontent.com/1294454/97296144-514fa300-1861-11eb-952b-3d55d492200b.jpg",api:{public:"https://api.exchange.bitcoin.com",private:"https://api.exchange.bitcoin.com"},www:"https://exchange.bitcoin.com",doc:"https://api.exchange.bitcoin.com/api/2/explore",fees:"https://exchange.bitcoin.com/fees-and-limits",referral:"https://exchange.bitcoin.com/referral/da948b21d6c92d69"},fees:{trading:{maker:.0015,taker:.002}}})}}},7965:(e,t,s)=>{"use strict";const i=s(8819),{NotSupported:r,RateLimitExceeded:a,AuthenticationError:n,PermissionDenied:o,ArgumentsRequired:c,ExchangeError:d,ExchangeNotAvailable:h,InsufficientFunds:u,InvalidOrder:l,OrderNotFound:f,InvalidNonce:p,BadSymbol:m}=s(3449),{SIGNIFICANT_DIGITS:b,DECIMAL_PLACES:g,TRUNCATE:y,ROUND:v}=s(2115),w=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bitfinex",name:"Bitfinex",countries:["VG"],version:"v1",rateLimit:1500,pro:!0,has:{cancelAllOrders:!0,cancelOrder:!0,CORS:!1,createDepositAddress:!0,createOrder:!0,deposit:!0,editOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchDepositAddress:!0,fetchDeposits:!1,fetchFundingFees:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTradingFee:!0,fetchTradingFees:!0,fetchTransactions:!0,fetchWithdrawals:!1,withdraw:!0,transfer:!0},timeframes:{"1m":"1m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","3h":"3h","4h":"4h","6h":"6h","12h":"12h","1d":"1D","1w":"7D","2w":"14D","1M":"1M"},urls:{logo:"https://user-images.githubusercontent.com/1294454/27766244-e328a50c-5ed2-11e7-947b-041416579bb3.jpg",api:{v2:"https://api-pub.bitfinex.com",public:"https://api.bitfinex.com",private:"https://api.bitfinex.com"},www:"https://www.bitfinex.com",referral:"https://www.bitfinex.com/?refcode=P61eYxFL",doc:["https://docs.bitfinex.com/v1/docs","https://github.com/bitfinexcom/bitfinex-api-node"]},api:{v2:{get:["platform/status","tickers","ticker/{symbol}","trades/{symbol}/hist","book/{symbol}/{precision}","book/{symbol}/P0","book/{symbol}/P1","book/{symbol}/P2","book/{symbol}/P3","book/{symbol}/R0","stats1/{key}:{size}:{symbol}:{side}/{section}","stats1/{key}:{size}:{symbol}/{section}","stats1/{key}:{size}:{symbol}:long/last","stats1/{key}:{size}:{symbol}:long/hist","stats1/{key}:{size}:{symbol}:short/last","stats1/{key}:{size}:{symbol}:short/hist","candles/trade:{timeframe}:{symbol}/{section}","candles/trade:{timeframe}:{symbol}/last","candles/trade:{timeframe}:{symbol}/hist"]},public:{get:["book/{symbol}","lendbook/{currency}","lends/{currency}","pubticker/{symbol}","stats/{symbol}","symbols","symbols_details","tickers","trades/{symbol}"]},private:{post:["account_fees","account_infos","balances","basket_manage","credits","deposit/new","funding/close","history","history/movements","key_info","margin_infos","mytrades","mytrades_funding","offer/cancel","offer/new","offer/status","offers","offers/hist","order/cancel","order/cancel/all","order/cancel/multi","order/cancel/replace","order/new","order/new/multi","order/status","orders","orders/hist","position/claim","position/close","positions","summary","taken_funds","total_taken_funds","transfer","unused_taken_funds","withdraw"]}},fees:{trading:{feeSide:"get",tierBased:!0,percentage:!0,maker:.001,taker:.002,tiers:{taker:[[0,.002],[5e5,.002],[1e6,.002],[25e5,.002],[5e6,.002],[75e5,.002],[1e7,.0018],[15e6,.0016],[2e7,.14/100],[25e6,.0012],[3e7,.001]],maker:[[0,.001],[5e5,8e-4],[1e6,6e-4],[25e5,4e-4],[5e6,2e-4],[75e5,0],[1e7,0],[15e6,0],[2e7,0],[25e6,0],[3e7,0]]}},funding:{tierBased:!1,percentage:!1,deposit:{BTC:4e-4,IOTA:.5,ETH:.0027,BCH:1e-4,LTC:.001,EOS:.24279,XMR:.04,SAN:.99269,DASH:.01,ETC:.01,XRP:.02,YYW:16.915,NEO:0,ZEC:.001,BTG:0,OMG:.14026,DATA:20.773,QASH:1.9858,ETP:.01,QTUM:.01,EDO:.95001,AVT:1.3045,USDT:0,TRX:28.184,ZRX:1.9947,RCN:10.793,TNB:31.915,SNT:14.976,RLC:1.414,GNT:5.8952,SPK:10.893,REP:.041168,BAT:6.1546,ELF:1.8753,FUN:32.336,SNG:18.622,AID:8.08,MNA:16.617,NEC:1.6504,XTZ:.2},withdraw:{BTC:4e-4,IOTA:.5,ETH:.0027,BCH:1e-4,LTC:.001,EOS:.24279,XMR:.04,SAN:.99269,DASH:.01,ETC:.01,XRP:.02,YYW:16.915,NEO:0,ZEC:.001,BTG:0,OMG:.14026,DATA:20.773,QASH:1.9858,ETP:.01,QTUM:.01,EDO:.95001,AVT:1.3045,USDT:20,TRX:28.184,ZRX:1.9947,RCN:10.793,TNB:31.915,SNT:14.976,RLC:1.414,GNT:5.8952,SPK:10.893,REP:.041168,BAT:6.1546,ELF:1.8753,FUN:32.336,SNG:18.622,AID:8.08,MNA:16.617,NEC:1.6504,XTZ:.2}}},commonCurrencies:{ALG:"ALGO",AMP:"AMPL",ATO:"ATOM",BCHABC:"BCHA",BCHN:"BCH",DAT:"DATA",DOG:"MDOGE",DSH:"DASH",EDO:"PNT",EUS:"EURS",EUT:"EURT",IOT:"IOTA",IQX:"IQ",MNA:"MANA",ORS:"ORS Group",PAS:"PASS",QSH:"QASH",QTM:"QTUM",RBT:"RBTC",SNG:"SNGLS",STJ:"STORJ",TSD:"TUSD",YYW:"YOYOW",UDC:"USDC",UST:"USDT",VSY:"VSYS",WAX:"WAXP",XCH:"XCHF",ZBT:"ZB"},exceptions:{exact:{temporarily_unavailable:h,"Order could not be cancelled.":f,"No such order found.":f,"Order price must be positive.":l,"Could not find a key matching the given X-BFX-APIKEY.":n,'Key price should be a decimal number, e.g. "123.456"':l,'Key amount should be a decimal number, e.g. "123.456"':l,ERR_RATE_LIMIT:a,Ratelimit:a,"Nonce is too small.":p,"No summary found.":d,"Cannot evaluate your available balance, please try again":h,"Unknown symbol":m,"Cannot complete transfer. Exchange balance insufficient.":u,"Momentary balance check. Please wait few seconds and try the transfer again.":d},broad:{"Invalid X-BFX-SIGNATURE":n,"This API key does not have permission":o,"not enough exchange balance for ":u,"minimum size for ":l,"Invalid order":l,"The available balance is only":u}},precisionMode:b,options:{currencyNames:{AGI:"agi",AID:"aid",AIO:"aio",ANT:"ant",AVT:"aventus",BAT:"bat",BCH:"bab",BCI:"bci",BFT:"bft",BSV:"bsv",BTC:"bitcoin",BTG:"bgold",CFI:"cfi",COMP:"comp",DAI:"dai",DADI:"dad",DASH:"dash",DATA:"datacoin",DTH:"dth",EDO:"eidoo",ELF:"elf",EOS:"eos",ETC:"ethereumc",ETH:"ethereum",ETP:"metaverse",FUN:"fun",GNT:"golem",IOST:"ios",IOTA:"iota",LEO:"let",LINK:"link",LRC:"lrc",LTC:"litecoin",LYM:"lym",MANA:"mna",MIT:"mit",MKR:"mkr",MTN:"mtn",NEO:"neo",ODE:"ode",OMG:"omisego",OMNI:"mastercoin",QASH:"qash",QTUM:"qtum",RCN:"rcn",RDN:"rdn",REP:"rep",REQ:"req",RLC:"rlc",SAN:"santiment",SNGLS:"sng",SNT:"status",SPANK:"spk",STORJ:"stj",TNB:"tnb",TRX:"trx",TUSD:"tsd",USD:"wire",USDC:"udc",UTK:"utk",USDT:"tetheruso",VEE:"vee",WAX:"wax",XLM:"xlm",XMR:"monero",XRP:"ripple",XVG:"xvg",YOYOW:"yoyow",ZEC:"zcash",ZRX:"zrx",XTZ:"xtz"},orderTypes:{limit:"exchange limit",market:"exchange market"},accountsByType:{spot:"exchange",margin:"trading",funding:"deposit",exchange:"exchange",trading:"trading",deposit:"deposit",derivatives:"trading"}}})}async fetchFundingFees(e={}){await this.loadMarkets();const t=await this.privatePostAccountFees(e),s=t.withdraw,i={},r=Object.keys(s);for(let e=0;e<r.length;e++){const t=r[e];i[this.safeCurrencyCode(t)]=this.safeNumber(s,t)}return{info:t,withdraw:i,deposit:i}}async fetchTradingFees(e={}){await this.loadMarkets();const t=await this.privatePostSummary(e);return{info:t,maker:this.safeNumber(t,"maker_fee"),taker:this.safeNumber(t,"taker_fee")}}async fetchMarkets(e={}){const t=await this.publicGetSymbols(),s=await this.publicGetSymbolsDetails(),i=[];for(let e=0;e<s.length;e++){const r=s[e];let a,n,o=this.safeString(r,"pair");if(!this.inArray(o,t))continue;if(o=o.toUpperCase(),o.indexOf(":")>=0){const e=o.split(":");a=e[0],n=e[1]}else a=o.slice(0,3),n=o.slice(3,6);const c=this.safeCurrencyCode(a),d=this.safeCurrencyCode(n),h=c+"/"+d,u={price:this.safeInteger(r,"price_precision"),amount:8},l=this.safeString(r,"minimum_order_size"),f=this.safeString(r,"maximum_order_size"),p={amount:{min:this.parseNumber(l),max:this.parseNumber(f)},price:{min:this.parseNumber("1e-8"),max:void 0},cost:{min:void 0,max:void 0}},m=this.safeValue(r,"margin");i.push({id:o,symbol:h,base:c,quote:d,baseId:a,quoteId:n,active:!0,type:"spot",margin:m,precision:u,limits:p,info:r})}return i}amountToPrecision(e,t){return this.decimalToPrecision(t,y,this.markets[e].precision.amount,g)}priceToPrecision(e,t){return t=this.decimalToPrecision(t,v,this.markets[e].precision.price,this.precisionMode),this.decimalToPrecision(t,y,8,g)}async fetchBalance(e={}){await this.loadMarkets();const t=this.safeValue(this.options,"accountsByType",{}),s=this.safeString(e,"type","exchange"),i=this.safeString(t,s);if(void 0===i){const e=Object.keys(t);throw new d(this.id+" fetchBalance type parameter must be one of "+e.join(", "))}const r=this.omit(e,"type"),a=await this.privatePostBalances(r),n={info:a},o="derivatives"===s;for(let e=0;e<a.length;e++){const t=a[e],s=this.safeString(t,"type"),r=this.safeStringLower(t,"currency",""),c=r.length-2,d="f0"===r.slice(c),h=!o||d;if(i===s&&h){const e=this.safeCurrencyCode(r);if(!(e in n)){const s=this.account();s.free=this.safeString(t,"available"),s.total=this.safeString(t,"amount"),n[e]=s}}}return this.parseBalance(n,!1)}async transfer(e,t,s,i,r={}){await this.loadMarkets();const a=this.safeValue(this.options,"accountsByType",{}),n=this.safeString(a,s);if(void 0===n){const e=Object.keys(a);throw new d(this.id+" transfer fromAccount must be one of "+e.join(", "))}const o=this.safeString(a,i);if(void 0===o){const e=Object.keys(a);throw new d(this.id+" transfer toAccount must be one of "+e.join(", "))}const c=this.currencyId(e),h=this.convertDerivativesId(c,s),u=this.convertDerivativesId(c,i),l=this.currencyToPrecision(e,t),f={amount:l,currency:h,currency_to:u,walletfrom:n,walletto:o},p=await this.privatePostTransfer(this.extend(f,r)),m=this.safeValue(p,0),b=this.safeString(m,"status"),g=this.safeString(m,"message");if(void 0===g)throw new d(this.id+" transfer failed");if("error"===b)throw this.throwExactlyMatchedException(this.exceptions.exact,g,this.id+" "+g),new d(this.id+" "+g);return{info:p,status:b,amount:l,code:e,fromAccount:s,toAccount:i,timestamp:void 0,datetime:void 0}}convertDerivativesId(e,t){const s=e.length-2,i="F0"===e.slice(s);return"derivatives"!==t&&"trading"!==t&&"margin"!==t&&i?e=e.slice(0,s):"derivatives"!==t||i||(e+="F0"),e}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.marketId(e)};void 0!==t&&(i.limit_bids=t,i.limit_asks=t);const r=await this.publicGetBookSymbol(this.extend(i,s));return this.parseOrderBook(r,e,void 0,"bids","asks","price","amount")}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTickers(t),i={};for(let e=0;e<s.length;e++){const t=this.parseTicker(s[e]);i[t.symbol]=t}return this.filterByArray(i,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.publicGetPubtickerSymbol(this.extend(i,t));return this.parseTicker(r,s)}parseTicker(e,t){let s,i=this.safeNumber(e,"timestamp");if(void 0!==i&&(i*=1e3),i=parseInt(i),void 0!==t)s=t.symbol;else if("pair"in e){const i=this.safeString(e,"pair");if(void 0!==i)if(i in this.markets_by_id)s=(t=this.markets_by_id[i]).symbol;else{const e=i.slice(0,3),t=i.slice(3,6);s=this.safeCurrencyCode(e)+"/"+this.safeCurrencyCode(t)}}const r=this.safeNumber(e,"last_price");return{symbol:s,timestamp:i,datetime:this.iso8601(i),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"bid"),bidVolume:void 0,ask:this.safeNumber(e,"ask"),askVolume:void 0,vwap:void 0,open:void 0,close:r,last:r,previousClose:void 0,change:void 0,percentage:void 0,average:this.safeNumber(e,"mid"),baseVolume:this.safeNumber(e,"volume"),quoteVolume:void 0,info:e}}parseTrade(e,t){const s=this.safeString(e,"tid");let i=this.safeNumber(e,"timestamp");void 0!==i&&(i=1e3*parseInt(i));const r=this.safeStringLower(e,"type"),a=this.safeString(e,"order_id"),n=this.safeString(e,"price"),o=this.safeString(e,"amount"),c=this.parseNumber(n),d=this.parseNumber(o),h=this.parseNumber(w.stringMul(n,o));let u;if("fee_amount"in e){const t=-this.safeNumber(e,"fee_amount"),s=this.safeString(e,"fee_currency");u={cost:t,currency:this.safeCurrencyCode(s)}}return{id:s,info:e,timestamp:i,datetime:this.iso8601(i),symbol:t.symbol,type:undefined,order:a,side:r,takerOrMaker:void 0,price:c,amount:d,cost:h,fee:u}}async fetchTrades(e,t,s=50,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id,limit_trades:s};void 0!==t&&(a.timestamp=parseInt(t/1e3));const n=await this.publicGetTradesSymbol(this.extend(a,i));return this.parseTrades(n,r,t,s)}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new c(this.id+" fetchMyTrades() requires a `symbol` argument");await this.loadMarkets();const r=this.market(e),a={symbol:r.id};void 0!==s&&(a.limit_trades=s),void 0!==t&&(a.timestamp=parseInt(t/1e3));const n=await this.privatePostMytrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n={symbol:this.marketId(e),side:s,amount:this.amountToPrecision(e,i),type:this.safeString(this.options.orderTypes,t,t),ocoorder:!1,buy_price_oco:0,sell_price_oco:0};n.price="market"===t?this.nonce().toString():this.priceToPrecision(e,r);const o=await this.privatePostOrderNew(this.extend(n,a));return this.parseOrder(o)}async editOrder(e,t,s,i,r,a,n={}){await this.loadMarkets();const o={order_id:parseInt(e)};void 0!==a&&(o.price=this.priceToPrecision(t,a)),void 0!==r&&(o.amount=this.numberToString(r)),void 0!==t&&(o.symbol=this.marketId(t)),void 0!==i&&(o.side=i),void 0!==s&&(o.type=this.safeString(this.options.orderTypes,s,s));const c=await this.privatePostOrderCancelReplace(this.extend(o,n));return this.parseOrder(c)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={order_id:parseInt(e)};return await this.privatePostOrderCancel(this.extend(i,s))}async cancelAllOrders(e,t={}){return await this.privatePostOrderCancelAll(t)}parseOrder(e,t){const s=this.safeString(e,"side"),i=this.safeValue(e,"is_live"),r=this.safeValue(e,"is_cancelled");let a;a=i?"open":r?"canceled":"closed";const n=this.safeStringUpper(e,"symbol"),o=this.safeSymbol(n,t);let c=this.safeString(e,"type","");if(c.indexOf("exchange ")>=0){c=e.type.split(" ")[1]}const d=this.safeTimestamp(e,"timestamp"),h=this.safeString(e,"id");return this.safeOrder({info:e,id:h,clientOrderId:void 0,timestamp:d,datetime:this.iso8601(d),lastTradeTimestamp:void 0,symbol:o,type:c,timeInForce:void 0,postOnly:void 0,side:s,price:this.safeNumber(e,"price"),stopPrice:void 0,average:this.safeNumber(e,"avg_execution_price"),amount:this.safeNumber(e,"original_amount"),remaining:this.safeNumber(e,"remaining_amount"),filled:this.safeNumber(e,"executed_amount"),status:a,fee:void 0,cost:void 0,trades:void 0})}async fetchOpenOrders(e,t,s,i={}){if(await this.loadMarkets(),void 0!==e&&!(e in this.markets))throw new d(this.id+" has no symbol "+e);const r=await this.privatePostOrders(i);let a=this.parseOrders(r,void 0,t,s);return void 0!==e&&(a=this.filterBy(a,"symbol",e)),a}async fetchClosedOrders(e,t,s,i={}){await this.loadMarkets();const r={};void 0!==s&&(r.limit=s);const a=await this.privatePostOrdersHist(this.extend(r,i));let n=this.parseOrders(a,void 0,t,s);return void 0!==e&&(n=this.filterBy(n,"symbol",e)),n=this.filterByArray(n,"status",["closed","canceled"],!1),n}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={order_id:parseInt(e)},r=await this.privatePostOrderStatus(this.extend(i,s));return this.parseOrder(r)}parseOHLCV(e,t){return[this.safeInteger(e,0),this.safeNumber(e,1),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,2),this.safeNumber(e,5)]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets(),void 0===i&&(i=100);const a=this.market(e),n={symbol:"t"+a.id,timeframe:this.timeframes[t],sort:1,limit:i};void 0!==s&&(n.start=s);const o=await this.v2GetCandlesTradeTimeframeSymbolHist(this.extend(n,r));return this.parseOHLCVs(o,a,t,s,i)}getCurrencyName(e){if(e in this.options.currencyNames)return this.options.currencyNames[e];throw new r(this.id+" "+e+" not supported for withdrawal")}async createDepositAddress(e,t={}){await this.loadMarkets();return await this.fetchDepositAddress(e,this.extend({renew:1},t))}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={method:this.getCurrencyName(e),wallet_name:"exchange",renew:0},i=await this.privatePostDepositNew(this.extend(s,t));let r,a=this.safeValue(i,"address");return"address_pool"in i&&(r=a,a=i.address_pool),this.checkAddress(a),{currency:e,address:a,tag:r,info:i}}async fetchTransactions(e,t,s,i={}){await this.loadMarkets();let r=this.safeString(i,"currency");const a=this.omit(i,"currency");let n;if(void 0===r){if(void 0===e)throw new c(this.id+" fetchTransactions() requires a currency `code` argument or a `currency` parameter");n=this.currency(e),r=n.id}a.currency=r,void 0!==t&&(a.since=parseInt(t/1e3));const o=await this.privatePostHistoryMovements(this.extend(a,i));return this.parseTransactions(o,n,t,s)}parseTransaction(e,t){let s=this.safeNumber(e,"timestamp_created");void 0!==s&&(s=parseInt(1e3*s));let i=this.safeNumber(e,"timestamp");void 0!==i&&(i=parseInt(1e3*i));const r=this.safeString(e,"currency"),a=this.safeCurrencyCode(r,t),n=this.safeStringLower(e,"type"),o=this.parseTransactionStatus(this.safeString(e,"status"));let c=this.safeNumber(e,"fee");return void 0!==c&&(c=Math.abs(c)),{info:e,id:this.safeString(e,"id"),txid:this.safeString(e,"txid"),timestamp:s,datetime:this.iso8601(s),address:this.safeString(e,"address"),tag:void 0,type:n,amount:this.safeNumber(e,"amount"),currency:a,status:o,updated:i,fee:{currency:a,cost:c,rate:void 0}}}parseTransactionStatus(e){return this.safeString({SENDING:"pending",CANCELED:"canceled",ZEROCONFIRMED:"failed",COMPLETED:"ok"},e,e)}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a={withdraw_type:this.getCurrencyName(e),walletselected:"exchange",amount:this.numberToString(t),address:s};void 0!==i&&(a.payment_id=i);const n=(await this.privatePostWithdraw(this.extend(a,r)))[0],o=this.safeString(n,"withdrawal_id"),c=this.safeString(n,"message"),h=this.findBroadlyMatchedKey(this.exceptions.broad,c);if(0===o){if(void 0!==h){throw new(0,this.exceptions.broad[h])(this.id+" "+c)}throw new d(this.id+" withdraw returned an id of zero: "+this.json(n))}return{info:n,id:o}}async fetchPositions(e,t={}){await this.loadMarkets();return await this.privatePostPositions(t)}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n="/"+this.implodeParams(e,i);n="v2"===t?"/"+t+n:"/"+this.version+n;let o=this.omit(i,this.extractParams(e)),c=this.urls.api[t]+n;if(("public"===t||e.indexOf("/hist")>=0)&&Object.keys(o).length){const e="?"+this.urlencode(o);c+=e,n+=e}if("private"===t){this.checkRequiredCredentials();const e=this.nonce();o=this.extend({nonce:e.toString(),request:n},o),a=this.json(o);const t=this.stringToBase64(a),s=this.encode(this.secret),i=this.hmac(t,s,"sha384");r={"X-BFX-APIKEY":this.apiKey,"X-BFX-PAYLOAD":this.decode(t),"X-BFX-SIGNATURE":i,"Content-Type":"application/json"}}return{url:c,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,a,n,o,c){if(void 0!==n&&e>=400&&"{"===a[0]){const e=this.id+" "+a,t=this.safeString2(n,"message","error");throw this.throwExactlyMatchedException(this.exceptions.exact,t,e),this.throwBroadlyMatchedException(this.exceptions.broad,t,e),new d(e)}}}},5328:(e,t,s)=>{"use strict";const i=s(7965),{ExchangeError:r,InvalidAddress:a,ArgumentsRequired:n,InsufficientFunds:o,AuthenticationError:c,OrderNotFound:d,InvalidOrder:h,BadRequest:u,InvalidNonce:l,BadSymbol:f,OnMaintenance:p,NotSupported:m,PermissionDenied:b}=s(3449),g=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bitfinex2",name:"Bitfinex",countries:["VG"],version:"v2",certified:!1,pro:!1,has:{CORS:!1,cancelAllOrders:!0,cancelOrder:!0,createDepositAddress:!0,createLimitOrder:!0,createMarketOrder:!0,createOrder:!0,deposit:!1,editOrder:!1,fetchBalance:!0,fetchClosedOrder:!0,fetchClosedOrders:!1,fetchCurrencies:!0,fetchDepositAddress:!0,fetchFundingFees:!1,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrder:!0,fetchOpenOrders:!0,fetchOrder:!1,fetchOrderTrades:!0,fetchStatus:!0,fetchTickers:!0,fetchTradingFee:!1,fetchTradingFees:!1,fetchTransactions:!0,withdraw:!0},timeframes:{"1m":"1m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","3h":"3h","4h":"4h","6h":"6h","12h":"12h","1d":"1D","1w":"7D","2w":"14D","1M":"1M"},rateLimit:1500,urls:{logo:"https://user-images.githubusercontent.com/1294454/27766244-e328a50c-5ed2-11e7-947b-041416579bb3.jpg",api:{v1:"https://api.bitfinex.com",public:"https://api-pub.bitfinex.com",private:"https://api.bitfinex.com"},www:"https://www.bitfinex.com",doc:["https://docs.bitfinex.com/v2/docs/","https://github.com/bitfinexcom/bitfinex-api-node"],fees:"https://www.bitfinex.com/fees"},api:{v1:{get:["symbols","symbols_details"]},public:{get:["conf/{config}","conf/pub:{action}:{object}","conf/pub:{action}:{object}:{detail}","conf/pub:map:{object}","conf/pub:map:{object}:{detail}","conf/pub:map:currency:{detail}","conf/pub:map:currency:sym","conf/pub:map:currency:label","conf/pub:map:currency:unit","conf/pub:map:currency:undl","conf/pub:map:currency:pool","conf/pub:map:currency:explorer","conf/pub:map:currency:tx:fee","conf/pub:map:tx:method","conf/pub:list:{object}","conf/pub:list:{object}:{detail}","conf/pub:list:currency","conf/pub:list:pair:exchange","conf/pub:list:pair:margin","conf/pub:list:pair:futures","conf/pub:list:competitions","conf/pub:info:{object}","conf/pub:info:{object}:{detail}","conf/pub:info:pair","conf/pub:info:tx:status","conf/pub:fees","platform/status","tickers","ticker/{symbol}","trades/{symbol}/hist","book/{symbol}/{precision}","book/{symbol}/P0","book/{symbol}/P1","book/{symbol}/P2","book/{symbol}/P3","book/{symbol}/R0","stats1/{key}:{size}:{symbol}:{side}/{section}","stats1/{key}:{size}:{symbol}:{side}/last","stats1/{key}:{size}:{symbol}:{side}/hist","stats1/{key}:{size}:{symbol}/{section}","stats1/{key}:{size}:{symbol}/last","stats1/{key}:{size}:{symbol}/hist","stats1/{key}:{size}:{symbol}:long/last","stats1/{key}:{size}:{symbol}:long/hist","stats1/{key}:{size}:{symbol}:short/last","stats1/{key}:{size}:{symbol}:short/hist","candles/trade:{timeframe}:{symbol}:{period}/{section}","candles/trade:{timeframe}:{symbol}/{section}","candles/trade:{timeframe}:{symbol}/last","candles/trade:{timeframe}:{symbol}/hist","status/{type}","status/deriv","liquidations/hist","rankings/{key}:{timeframe}:{symbol}/{section}","rankings/{key}:{timeframe}:{symbol}/hist"],post:["calc/trade/avg","calc/fx"]},private:{post:["auth/r/wallets","auth/r/wallets/hist","auth/r/orders","auth/r/orders/{symbol}","auth/w/order/submit","auth/w/order/update","auth/w/order/cancel","auth/w/order/multi","auth/w/order/cancel/multi","auth/r/orders/{symbol}/hist","auth/r/orders/hist","auth/r/order/{symbol}:{id}/trades","auth/r/trades/{symbol}/hist","auth/r/trades/hist","auth/r/ledgers/{currency}/hist","auth/r/ledgers/hist","auth/r/info/margin/{key}","auth/r/info/margin/base","auth/r/info/margin/sym_all","auth/r/positions","auth/w/position/claim","auth/r/positions/hist","auth/r/positions/audit","auth/r/positions/snap","auth/w/deriv/collateral/set","auth/w/deriv/collateral/limits","auth/r/funding/offers","auth/r/funding/offers/{symbol}","auth/w/funding/offer/submit","auth/w/funding/offer/cancel","auth/w/funding/offer/cancel/all","auth/w/funding/close","auth/w/funding/auto","auth/w/funding/keep","auth/r/funding/offers/{symbol}/hist","auth/r/funding/offers/hist","auth/r/funding/loans","auth/r/funding/loans/hist","auth/r/funding/loans/{symbol}","auth/r/funding/loans/{symbol}/hist","auth/r/funding/credits","auth/r/funding/credits/hist","auth/r/funding/credits/{symbol}","auth/r/funding/credits/{symbol}/hist","auth/r/funding/trades/{symbol}/hist","auth/r/funding/trades/hist","auth/r/info/funding/{key}","auth/r/info/user","auth/r/logins/hist","auth/w/transfer","auth/w/deposit/address","auth/w/deposit/invoice","auth/w/withdraw","auth/r/movements/{currency}/hist","auth/r/movements/hist","auth/r/alerts","auth/w/alert/set","auth/w/alert/price:{symbol}:{price}/del","auth/w/alert/{type}:{symbol}:{price}/del","auth/calc/order/avail","auth/w/settings/set","auth/r/settings","auth/w/settings/del"]}},fees:{trading:{maker:.001,taker:.002},funding:{withdraw:{BTC:4e-4,BCH:1e-4,ETH:.00135,EOS:0,LTC:.001,OMG:.15097,IOT:0,NEO:0,ETC:.01,XRP:.02,ETP:.01,ZEC:.001,BTG:0,DASH:.01,XMR:1e-4,QTM:.01,EDO:.23687,DAT:9.8858,AVT:1.1251,SAN:.35977,USDT:5,SPK:16.971,BAT:1.1209,GNT:2.8789,SNT:9.0848,QASH:1.726,YYW:7.9464}}},options:{precision:"R0",exchangeTypes:{"EXCHANGE MARKET":"market","EXCHANGE LIMIT":"limit"},orderTypes:{market:"EXCHANGE MARKET",limit:"EXCHANGE LIMIT"},fiat:{USD:"USD",EUR:"EUR",JPY:"JPY",GBP:"GBP"},v2AccountsByType:{spot:"exchange",exchange:"exchange",funding:"funding",margin:"margin",derivatives:"margin"}},exceptions:{exact:{10001:b,10020:u,10100:c,10114:l,20060:p},broad:{address:a,"available balance is only":o,"not enough exchange balance":o,"Order not found":d,"symbol: invalid":f,"Invalid order":h}}})}isFiat(e){return e in this.options.fiat}getCurrencyId(e){return"f"+e}async fetchStatus(e={}){const t=await this.publicGetPlatformStatus(e),s=1===this.safeInteger(t,0)?"ok":"maintenance";return this.status=this.extend(this.status,{status:s,updated:this.milliseconds()}),this.status}async fetchMarkets(e={}){const t=await this.publicGetConfPubListPairFutures(e),s=await this.v1GetSymbolsDetails(e),i=this.safeValue(t,0,[]),r=[];for(let e=0;e<s.length;e++){const t=s[e];let a=this.safeStringUpper(t,"pair"),n=!0;this.inArray(a,i)&&(n=!1);const o=!n,c=n?"spot":"futures";let d,h;if(a.indexOf(":")>=0){const e=a.split(":");d=e[0],h=e[1]}else d=a.slice(0,3),h=a.slice(3,6);const u=this.safeCurrencyCode(d),l=this.safeCurrencyCode(h),f=u+"/"+l;a="t"+a,d=this.getCurrencyId(d),h=this.getCurrencyId(h);const p={price:this.safeInteger(t,"price_precision"),amount:8},m=this.safeString(t,"minimum_order_size"),b=this.safeString(t,"maximum_order_size"),g={amount:{min:this.parseNumber(m),max:this.parseNumber(b)},price:{min:this.parseNumber("1e-8"),max:void 0},cost:{min:void 0,max:void 0}},y=this.safeValue(t,"margin");r.push({id:a,symbol:f,base:u,quote:l,baseId:d,quoteId:h,active:!0,precision:p,limits:g,info:t,type:c,swap:!1,spot:n,margin:y,futures:o})}return r}async fetchCurrencies(e={}){const t={config:["pub:list:currency","pub:map:currency:sym","pub:map:currency:label","pub:map:currency:unit","pub:map:currency:undl","pub:map:currency:pool","pub:map:currency:explorer","pub:map:currency:tx:fee"].join(",")},s=await this.publicGetConfConfig(this.extend(t,e)),i={sym:this.indexBy(this.safeValue(s,1,[]),0),label:this.indexBy(this.safeValue(s,2,[]),0),unit:this.indexBy(this.safeValue(s,3,[]),0),undl:this.indexBy(this.safeValue(s,4,[]),0),pool:this.indexBy(this.safeValue(s,5,[]),0),explorer:this.indexBy(this.safeValue(s,6,[]),0),fees:this.indexBy(this.safeValue(s,7,[]),0)},r=this.safeValue(s,0,[]),a={};for(let e=0;e<r.length;e++){const t=r[e],s=this.safeCurrencyCode(t),n=this.safeValue(i.label,t,[]),o=this.safeString(n,1),c=this.safeValue(i.pool,t,[]),d=this.safeString(c,1),h=this.safeValue(i.fees,t,[]),u=this.safeValue(h,1,[]),l=this.safeNumber(u,1),f=this.safeValue(i.undl,t,[]),p=8,m="f"+t;a[s]={id:m,code:s,info:[t,n,c,h,f],type:d,name:o,active:!0,fee:l,precision:p,limits:{amount:{min:1/Math.pow(10,p),max:void 0},withdraw:{min:l,max:void 0}}}}return a}async fetchBalance(e={}){await this.loadMarkets();const t=this.safeValue(this.options,"v2AccountsByType",{}),s=this.safeString(e,"type","exchange"),i=this.safeString(t,s);if(void 0===i){const e=Object.keys(t);throw new r(this.id+" fetchBalance type parameter must be one of "+e.join(", "))}const a="derivatives"===s,n=this.omit(e,"type"),o=await this.privatePostAuthRWallets(n),c={info:o};for(let e=0;e<o.length;e++){const t=o[e],s=this.safeString(t,0),r=this.safeStringLower(t,1,""),n=r.length-2,d="f0"===r.slice(n),h=!a||d;if(i===s&&h){const e=this.safeCurrencyCode(r),s=this.account();s.total=this.safeString(t,2),s.free=this.safeString(t,4),c[e]=s}}return this.parseBalance(c,!1)}async transfer(e,t,s,i,a={}){await this.loadMarkets();const n=this.safeValue(this.options,"v2AccountsByType",{}),o=this.safeString(n,s);if(void 0===o){const e=Object.keys(n);throw new r(this.id+" transfer fromAccount must be one of "+e.join(", "))}const c=this.safeString(n,i);if(void 0===c){const e=Object.keys(n);throw new r(this.id+" transfer toAccount must be one of "+e.join(", "))}const d=this.currency(e),h=this.convertDerivativesId(d,s),u=this.convertDerivativesId(d,i),l=this.currencyToPrecision(e,t),f={amount:l,currency:h,currency_to:u,from:o,to:c},p=await this.privatePostAuthWTransfer(this.extend(f,a)),m=this.safeInteger(p,0);if("error"===this.safeString(p,0)){const e=this.safeString(p,2,"");throw this.throwExactlyMatchedException(this.exceptions.exact,e,this.id+" "+e),new r(this.id+" "+e)}const b=this.safeValue(p,4),g=this.safeString(b,1),y=this.safeString(b,2),v=this.safeCurrencyCode(this.safeString(b,5)),w="SUCCESS"===this.safeString(p,6)?"ok":void 0;return{info:p,timestamp:m,datetime:this.iso8601(m),status:w,amount:l,code:v,fromAccount:g,toAccount:y}}convertDerivativesId(e,t){const s=this.safeValue(e,"info"),i=this.safeString(s,0),r=this.safeValue(s,4,[]);let a;if("derivatives"===t){a=this.safeString(r,0,i);const e=a.length-2;"F0"===a.slice(e)||(a+="F0")}else a="margin"!==t?this.safeString(r,1,i):i;return a}async fetchOrder(e,t,s={}){throw new m(this.id+" fetchOrder is not implemented yet")}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.safeValue(this.options,"precision","R0"),r={symbol:this.marketId(e),precision:i};void 0!==t&&(r.len=t);const a=this.extend(r,s),n=await this.publicGetBookSymbolPrecision(a),o=this.milliseconds(),c={symbol:e,bids:[],asks:[],timestamp:o,datetime:this.iso8601(o),nonce:void 0},d="R0"===a.precision?1:0;for(let e=0;e<n.length;e++){const t=n[e],s=this.safeNumber(t,d),i=this.safeNumber(t,2),r=Math.abs(i);c[i>0?"bids":"asks"].push([s,r])}return c.bids=this.sortBy(c.bids,0,!0),c.asks=this.sortBy(c.asks,0),c}parseTicker(e,t){const s=this.milliseconds();let i;void 0!==t&&(i=t.symbol);const r=e.length,a=this.safeNumber(e,r-4);return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,r-2),low:this.safeNumber(e,r-1),bid:this.safeNumber(e,r-10),bidVolume:void 0,ask:this.safeNumber(e,r-8),askVolume:void 0,vwap:void 0,open:void 0,close:a,last:a,previousClose:void 0,change:this.safeNumber(e,r-6),percentage:100*this.safeNumber(e,r-5),average:void 0,baseVolume:this.safeNumber(e,r-3),quoteVolume:void 0,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s={};if(void 0!==e){const t=this.marketIds(e);s.symbols=t.join(",")}else s.symbols="ALL";const i=await this.publicGetTickers(this.extend(s,t)),r={};for(let e=0;e<i.length;e++){const t=i[e],s=t[0];if(s in this.markets_by_id){const e=this.markets_by_id[s];r[e.symbol]=this.parseTicker(t,e)}}return this.filterByArray(r,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.publicGetTickerSymbol(this.extend(i,t));return this.parseTicker(r,s)}parseSymbol(e){if(void 0===e)return e;let t,s;if((e=e.replace("t","")).indexOf(":")>=0){const i=e.split(":");t=i[0],s=i[1]}else t=e.slice(0,3),s=e.slice(3,6);return this.safeCurrencyCode(t)+"/"+this.safeCurrencyCode(s)}parseTrade(e,t){const s=e.length>5,i=this.safeString(e,0),r=s?4:2;let a,n=this.safeString(e,r);const o=s?5:3,c=this.safeString(e,o);"-"===n[0]?(a="sell",n=n.slice(1)):a="buy";const d=this.parseNumber(n),h=this.parseNumber(c),u=this.parseNumber(g.stringMul(c,n));let l,f,p,m,b;const y=s?2:1,v=this.safeInteger(e,y);if(s){const s=e[1];b=s in this.markets_by_id?(t=this.markets_by_id[s]).symbol:this.parseSymbol(s),l=this.safeString(e,3);f=1===this.safeInteger(e,8)?"maker":"taker";let i=this.safeString(e,9);i=g.stringNeg(i);const r=this.parseNumber(i),a=this.safeString(e,10);m={cost:r,currency:this.safeCurrencyCode(a)};const n=e[6];p=this.safeString(this.options.exchangeTypes,n)}return void 0===b&&void 0!==t&&(b=t.symbol),{id:i,timestamp:v,datetime:this.iso8601(v),symbol:b,order:l,side:a,type:p,takerOrMaker:f,price:h,amount:d,cost:u,fee:m,info:e}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e);let a="-1";const n={symbol:r.id};void 0!==t&&(n.start=t,a="1"),void 0!==s&&(n.limit=s),n.sort=a;const o=await this.publicGetTradesSymbolHist(this.extend(n,i)),c=this.sortBy(o,1);return this.parseTrades(c,r,void 0,s)}async fetchOHLCV(e,t="1m",s,i=100,r={}){await this.loadMarkets();const a=this.market(e);void 0===i&&(i=100),void 0===s&&(s=this.milliseconds()-this.parseTimeframe(t)*i*1e3);const n={symbol:a.id,timeframe:this.timeframes[t],sort:1,start:s,limit:i},o=await this.publicGetCandlesTradeTimeframeSymbolHist(this.extend(n,r));return this.parseOHLCVs(o,a,t,s,i)}parseOrderStatus(e){if(void 0===e)return e;const t=e.split(" "),s=this.safeString(t,0);return this.safeString({ACTIVE:"open",PARTIALLY:"open",EXECUTED:"closed",CANCELED:"canceled",INSUFFICIENT:"canceled",RSN_DUST:"rejected",RSN_PAUSE:"rejected"},s,e)}parseOrder(e,t){const s=this.safeString(e,0);let i;const r=this.safeString(e,3);r in this.markets_by_id?t=this.markets_by_id[r]:i=this.parseSymbol(r),void 0===i&&void 0!==t&&(i=t.symbol);const a=this.safeInteger(e,5),n=Math.abs(this.safeNumber(e,6)),o=this.safeNumber(e,7),c=Math.abs(o),d=o<0?"sell":"buy",h=this.safeString(e,8),u=this.safeString(this.safeValue(this.options,"exchangeTypes"),h);let l;const f=this.safeString(e,13);if(void 0!==f){const e=f.split(" @ ");l=this.parseOrderStatus(this.safeString(e,0))}const p=this.safeNumber(e,16),m=this.safeNumber(e,17),b=this.safeString(e,2);return this.safeOrder({info:e,id:s,clientOrderId:b,timestamp:a,datetime:this.iso8601(a),lastTradeTimestamp:void 0,symbol:i,type:u,timeInForce:void 0,postOnly:void 0,side:d,price:p,stopPrice:void 0,amount:c,cost:void 0,average:m,filled:void 0,remaining:n,status:l,fee:void 0,trades:void 0})}async createOrder(e,t,s,i,a,o={}){await this.loadMarkets();const c=this.market(e),d=this.safeValue(this.options,"orderTypes",{}),h=this.safeStringUpper(d,t,t);i="sell"===s?-i:i;const u={symbol:c.id,type:h,amount:this.numberToString(i)};if("LIMIT"===h||"EXCHANGE LIMIT"===h)u.price=this.numberToString(a);else if("STOP"===h||"EXCHANGE STOP"===h){const e=this.safeNumber(o,"stopPrice",a);u.price=this.numberToString(e)}else if("STOP LIMIT"===h||"EXCHANGE STOP LIMIT"===h){const e=this.safeNumber(o,"price_aux_limit");let t=this.safeNumber(o,"stopPrice");if(void 0===e){if(void 0===t)throw new n(this.id+" createOrder() requires a stopPrice parameter or a price_aux_limit parameter for a "+h+" order");u.price_aux_limit=this.numberToString(a)}else u.price_aux_limit=this.numberToString(e),void 0===t&&(t=a);u.price=this.numberToString(t)}else if("TRAILING STOP"===h||"EXCHANGE TRAILING STOP"===h){const e=this.safeNumber(o,"price_trailing");u.price_trailing=this.numberToString(e);const t=this.safeNumber(o,"stopPrice",a);u.price=this.numberToString(t)}else"FOK"!==h&&"EXCHANGE FOK"!==h&&"IOC"!==h&&"EXCHANGE IOC"!==h||(u.price=this.numberToString(a));o=this.omit(o,["stopPrice","price_aux_limit","price_trailing"]);const l=this.safeValue2(o,"cid","clientOrderId");void 0!==l&&(u.cid=l,o=this.omit(o,["cid","clientOrderId"]));const f=await this.privatePostAuthWOrderSubmit(this.extend(u,o));if("SUCCESS"!==this.safeString(f,6)){const e=f[5],t=f[7];throw new r(this.id+" "+f[6]+": "+t+" (#"+e+")")}const p=this.safeValue(f,4,[]),m=this.safeValue(p,0);return this.parseOrder(m,c)}async cancelAllOrders(e,t={}){const s=await this.privatePostAuthWOrderCancelMulti(this.extend({all:1},t)),i=this.safeValue(s,4,[]);return this.parseOrders(i)}async cancelOrder(e,t,s={}){const i=this.safeValue2(s,"cid","clientOrderId");let r;if(void 0!==i){const e=this.safeValue(s,"cidDate");if(void 0===e)throw new h(this.id+" canceling an order by clientOrderId ('cid') requires both 'cid' and 'cid_date' ('YYYY-MM-DD')");r={cid:i,cid_date:e},s=this.omit(s,["cid","clientOrderId"])}else r={id:parseInt(e)};const a=await this.privatePostAuthWOrderCancel(this.extend(r,s)),n=this.safeValue(a,4);return this.parseOrder(n)}async fetchOpenOrder(e,t,s={}){const i={id:[parseInt(e)]},r=await this.fetchOpenOrders(t,void 0,void 0,this.extend(i,s)),a=this.safeValue(r,0);if(void 0===a)throw new d(this.id+" order "+e+" not found");return a}async fetchClosedOrder(e,t,s={}){const i={id:[parseInt(e)]},r=await this.fetchClosedOrders(t,void 0,void 0,this.extend(i,s)),a=this.safeValue(r,0);if(void 0===a)throw new d(this.id+" order "+e+" not found");return a}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a,n;return void 0===e?n=await this.privatePostAuthROrders(this.extend(r,i)):(a=this.market(e),r.symbol=a.id,n=await this.privatePostAuthROrdersSymbol(this.extend(r,i))),this.parseOrders(n,a,t,s)}async fetchClosedOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a,n;return void 0===e?n=await this.privatePostAuthROrdersHist(this.extend(r,i)):(a=this.market(e),r.symbol=a.id,n=await this.privatePostAuthROrdersSymbolHist(this.extend(r,i))),void 0!==t&&(r.start=t),void 0!==s&&(r.limit=s),this.parseOrders(n,a,t,s)}async fetchOrderTrades(e,t,s,i,r={}){if(void 0===t)throw new n(this.id+" fetchOrderTrades() requires a symbol argument");await this.loadMarkets();const a=this.market(t),o={id:parseInt(e),symbol:a.id},c=await this.privatePostAuthROrderSymbolIdTrades(this.extend(o,r));return this.parseTrades(c,a,s,i)}async fetchMyTrades(e,t,s,i={}){let r;await this.loadMarkets();const a={end:this.milliseconds()};void 0!==t&&(a.start=t),void 0!==s&&(a.limit=s);let n="privatePostAuthRTradesHist";void 0!==e&&(r=this.market(e),a.symbol=r.id,n="privatePostAuthRTradesSymbolHist");const o=await this[n](this.extend(a,i));return this.parseTrades(o,r,t,s)}async createDepositAddress(e,t={}){await this.loadMarkets();return await this.fetchDepositAddress(e,this.extend({op_renew:1},t))}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={method:this.getCurrencyName(e),wallet:"exchange",op_renew:0},i=await this.privatePostAuthWDepositAddress(this.extend(s,t)),r=this.safeValue(i,4,[]),a=this.safeString(r,5),n=void 0===a?this.safeString(r,4):a,o=void 0===a?void 0:this.safeString(r,4);return this.checkAddress(n),{currency:e,address:n,tag:o,info:i}}parseTransactionStatus(e){return this.safeString({SUCCESS:"ok",ERROR:"failed",FAILURE:"failed",CANCELED:"canceled"},e,e)}parseTransaction(e,t){let s,i,r,a,n,o,c,d,h,u,l;if(e.length<9){const i=this.safeValue(e,4,[]);s=this.safeInteger(e,0),void 0!==t&&(r=t.code),h=this.safeNumber(i,8),void 0!==h&&(h=-h),a=this.safeNumber(i,5),n=this.safeValue(i,0),o="ok",0===n&&(n=void 0,o="failed"),c=this.safeString(i,3),d="withdrawal"}else n=this.safeString(e,0),s=this.safeInteger(e,5),i=this.safeInteger(e,6),o=this.parseTransactionStatus(this.safeString(e,9)),a=this.safeNumber(e,12),void 0!==a&&(d=a<0?"withdrawal":"deposit"),h=this.safeNumber(e,13),void 0!==h&&(h=-h),l=this.safeString(e,16),u=this.safeString(e,20);return{info:e,id:n,txid:u,timestamp:s,datetime:this.iso8601(s),addressFrom:void 0,address:l,addressTo:l,tagFrom:void 0,tag:c,tagTo:c,type:d,amount:a,currency:r,status:o,updated:i,fee:{currency:r,cost:h,rate:void 0}}}async fetchTransactions(e,t,s,i={}){let r;await this.loadMarkets();const a={};let n="privatePostAuthRMovementsHist";void 0!==e&&(r=this.currency(e),a.currency=r.id,n="privatePostAuthRMovementsCurrencyHist"),void 0!==t&&(a.start=t),void 0!==s&&(a.limit=s);const o=await this[n](this.extend(a,i));return this.parseTransactions(o,r,t,s)}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a=this.currency(e),n={method:this.getCurrencyName(e),wallet:"exchange",amount:this.numberToString(t),address:s};void 0!==i&&(n.payment_id=i);const o=await this.privatePostAuthWWithdraw(this.extend(n,r)),c=this.safeString(o,7);"success"!==c&&this.throwBroadlyMatchedException(this.exceptions.broad,c,c);const d=this.parseTransaction(o,a);return this.extend(d,{address:s})}async fetchPositions(e,t={}){await this.loadMarkets();return await this.privatePostPositions(t)}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n="/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));n="v1"===t?t+n:this.version+n;let c=this.urls.api[t]+"/"+n;if("public"===t&&Object.keys(o).length&&(c+="?"+this.urlencode(o)),"private"===t){this.checkRequiredCredentials();const e=this.nonce().toString(),t="/api/"+n+e+(a=this.json(o)),s=this.hmac(this.encode(t),this.encode(this.secret),"sha384");r={"bfx-nonce":e,"bfx-apikey":this.apiKey,"bfx-signature":s,"Content-Type":"application/json"}}return{url:c,method:s,body:a,headers:r}}async request(e,t="public",s="GET",i={},a,n){const c=await this.fetch2(e,t,s,i,a,n);if(c){if("message"in c){if(c.message.indexOf("not enough exchange balance")>=0)throw new o(this.id+" "+this.json(c));throw new r(this.id+" "+this.json(c))}return c}if(""===c)throw new r(this.id+" returned empty response");return c}handleErrors(e,t,s,i,a,n,o,c,d){if(500===e){const e=this.numberToString(o[1]),t=o[2],s=this.id+" "+t;throw this.throwExactlyMatchedException(this.exceptions.exact,e,s),this.throwExactlyMatchedException(this.exceptions.exact,t,s),this.throwBroadlyMatchedException(this.exceptions.broad,t,s),new r(this.id+" "+t+" (#"+e+")")}}}},5421:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,OrderNotFound:n}=s(3449),o=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bitflyer",name:"bitFlyer",countries:["JP"],version:"v1",rateLimit:1e3,hostname:"bitflyer.com",has:{cancelOrder:!0,CORS:!1,createOrder:!0,fetchBalance:!0,fetchClosedOrders:"emulated",fetchMarkets:!0,fetchMyTrades:!0,fetchOpenOrders:"emulated",fetchOrder:"emulated",fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTrades:!0,withdraw:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/28051642-56154182-660e-11e7-9b0d-6042d1e6edd8.jpg",api:"https://api.{hostname}",www:"https://bitflyer.com",doc:"https://lightning.bitflyer.com/docs?lang=en"},api:{public:{get:["getmarkets/usa","getmarkets/eu","getmarkets","getboard","getticker","getexecutions","gethealth","getboardstate","getchats"]},private:{get:["getpermissions","getbalance","getbalancehistory","getcollateral","getcollateralhistory","getcollateralaccounts","getaddresses","getcoinins","getcoinouts","getbankaccounts","getdeposits","getwithdrawals","getchildorders","getparentorders","getparentorder","getexecutions","getpositions","gettradingcommission"],post:["sendcoin","withdraw","sendchildorder","cancelchildorder","sendparentorder","cancelparentorder","cancelallchildorders"]}},fees:{trading:{maker:.002,taker:.002},"BTC/JPY":{maker:.0015,taker:.0015}}})}async fetchMarkets(e={}){const t=await this.publicGetGetmarkets(e),s=await this.publicGetGetmarketsUsa(e),i=await this.publicGetGetmarketsEu(e);let r=this.arrayConcat(t,s);r=this.arrayConcat(r,i);const a=[];for(let e=0;e<r.length;e++){const t=r[e],s=this.safeString(t,"product_code"),i=s.split("_");let n,o,c,d;const h=i.length;1===h?(n=s.slice(0,3),o=s.slice(3,6)):2===h?(n=i[0],o=i[1]):(n=i[1],o=i[2]),c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o);const u=2===h?c+"/"+d:s,l=this.safeValue(this.fees,u,this.fees.trading);let f=this.safeValue(l,"maker",this.fees.trading.maker),p=this.safeValue(l,"taker",this.fees.trading.taker),m=!0,b=!1,g="spot";("alias"in t||"FX"===i[0])&&(g="future",b=!0,m=!1,f=0,p=0),a.push({id:s,symbol:u,base:c,quote:d,baseId:n,quoteId:o,maker:f,taker:p,type:g,spot:m,future:b,info:t})}return a}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetGetbalance(e),s={info:t};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"currency_code"),a=this.safeCurrencyCode(r),n=this.account();n.total=this.safeString(i,"amount"),n.free=this.safeString(i,"available"),s[a]=n}return this.parseBalance(s,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={product_code:this.marketId(e)},r=await this.publicGetGetboard(this.extend(i,s));return this.parseOrderBook(r,e,void 0,"bids","asks","price","size")}async fetchTicker(e,t={}){await this.loadMarkets();const s={product_code:this.marketId(e)},i=await this.publicGetGetticker(this.extend(s,t)),r=this.parse8601(this.safeString(i,"timestamp")),a=this.safeNumber(i,"ltp");return{symbol:e,timestamp:r,datetime:this.iso8601(r),high:void 0,low:void 0,bid:this.safeNumber(i,"best_bid"),bidVolume:void 0,ask:this.safeNumber(i,"best_ask"),askVolume:void 0,vwap:void 0,open:void 0,close:a,last:a,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(i,"volume_by_product"),quoteVolume:void 0,info:i}}parseTrade(e,t){let s,i=this.safeStringLower(e,"side");if(void 0!==i&&i.length<1&&(i=void 0),void 0!==i){const t=i+"_child_order_acceptance_id";t in e&&(s=e[t])}void 0===s&&(s=this.safeString(e,"child_order_acceptance_id"));const r=this.parse8601(this.safeString(e,"exec_date")),a=this.safeString(e,"price"),n=this.safeString(e,"size"),c=this.parseNumber(a),d=this.parseNumber(n),h=this.parseNumber(o.stringMul(a,n)),u=this.safeString(e,"id");let l;return void 0!==t&&(l=t.symbol),{id:u,info:e,timestamp:r,datetime:this.iso8601(r),symbol:l,order:s,type:void 0,side:i,takerOrMaker:void 0,price:c,amount:d,cost:h,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={product_code:r.id},n=await this.publicGetGetexecutions(this.extend(a,i));return this.parseTrades(n,r,t,s)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n={product_code:this.marketId(e),child_order_type:t.toUpperCase(),side:s.toUpperCase(),price:r,size:i},o=await this.privatePostSendchildorder(this.extend(n,a));return{info:o,id:this.safeString(o,"child_order_acceptance_id")}}async cancelOrder(e,t,s={}){if(void 0===t)throw new a(this.id+" cancelOrder() requires a `symbol` argument");await this.loadMarkets();const i={product_code:this.marketId(t),child_order_acceptance_id:e};return await this.privatePostCancelchildorder(this.extend(i,s))}parseOrderStatus(e){return this.safeString({ACTIVE:"open",COMPLETED:"closed",CANCELED:"canceled",EXPIRED:"canceled",REJECTED:"canceled"},e,e)}parseOrder(e,t){const s=this.parse8601(this.safeString(e,"child_order_date")),i=this.safeNumber(e,"size"),r=this.safeNumber(e,"outstanding_size"),a=this.safeNumber(e,"executed_size"),n=this.safeNumber(e,"price"),o=this.parseOrderStatus(this.safeString(e,"child_order_state")),c=this.safeStringLower(e,"child_order_type"),d=this.safeStringLower(e,"side"),h=this.safeString(e,"product_code"),u=this.safeSymbol(h,t);let l;const f=this.safeNumber(e,"total_commission");void 0!==f&&(l={cost:f,currency:void 0,rate:void 0});const p=this.safeString(e,"child_order_acceptance_id");return this.safeOrder({id:p,clientOrderId:void 0,info:e,timestamp:s,datetime:this.iso8601(s),lastTradeTimestamp:void 0,status:o,symbol:u,type:c,timeInForce:void 0,postOnly:void 0,side:d,price:n,stopPrice:void 0,cost:void 0,amount:i,filled:a,remaining:r,fee:l,average:void 0,trades:void 0})}async fetchOrders(e,t,s=100,i={}){if(void 0===e)throw new a(this.id+" fetchOrders() requires a `symbol` argument");await this.loadMarkets();const r=this.market(e),n={product_code:r.id,count:s},o=await this.privateGetGetchildorders(this.extend(n,i));let c=this.parseOrders(o,r,t,s);return void 0!==e&&(c=this.filterBy(c,"symbol",e)),c}async fetchOpenOrders(e,t,s=100,i={}){return await this.fetchOrders(e,t,s,this.extend({child_order_state:"ACTIVE"},i))}async fetchClosedOrders(e,t,s=100,i={}){return await this.fetchOrders(e,t,s,this.extend({child_order_state:"COMPLETED"},i))}async fetchOrder(e,t,s={}){if(void 0===t)throw new a(this.id+" fetchOrder() requires a `symbol` argument");const i=await this.fetchOrders(t),r=this.indexBy(i,"id");if(e in r)return r[e];throw new n(this.id+" No order found with id "+e)}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchMyTrades() requires a `symbol` argument");await this.loadMarkets();const r=this.market(e),n={product_code:r.id};void 0!==s&&(n.count=s);const o=await this.privateGetGetexecutions(this.extend(n,i));return this.parseTrades(o,r,t,s)}async fetchPositions(e,t={}){if(void 0===e)throw new a(this.id+" fetchPositions() requires a `symbols` argument, exactly one symbol in an array");await this.loadMarkets();const s={product_code:this.marketIds(e)};return await this.privateGetpositions(this.extend(s,t))}async withdraw(e,t,s,i,a={}){if(this.checkAddress(s),await this.loadMarkets(),"JPY"!==e&&"USD"!==e&&"EUR"!==e)throw new r(this.id+" allows withdrawing JPY, USD, EUR only, "+e+" is not supported");const n={currency_code:this.currency(e).id,amount:t},o=await this.privatePostWithdraw(this.extend(n,a));return{info:o,id:this.safeString(o,"message_id")}}sign(e,t="public",s="GET",i={},r,a){let n="/"+this.version+"/";"private"===t&&(n+="me/"),n+=e,"GET"===s&&Object.keys(i).length&&(n+="?"+this.urlencode(i));const o=this.implodeParams(this.urls.api,{hostname:this.hostname})+n;if("private"===t){this.checkRequiredCredentials();const e=this.nonce().toString();let t=[e,s,n].join("");Object.keys(i).length&&"GET"!==s&&(t+=a=this.json(i)),r={"ACCESS-KEY":this.apiKey,"ACCESS-TIMESTAMP":e,"ACCESS-SIGN":this.hmac(this.encode(t),this.encode(this.secret)),"Content-Type":"application/json"}}return{url:o,method:s,body:a,headers:r}}}},2519:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,AuthenticationError:a,OrderNotFound:n,InsufficientFunds:o,DDoSProtection:c,PermissionDenied:d,BadSymbol:h,InvalidOrder:u}=s(3449),l=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bitforex",name:"Bitforex",countries:["CN"],version:"v1",has:{cancelOrder:!0,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchMarkets:!0,fetchMyTrades:!1,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!1,fetchTicker:!0,fetchTickers:!1,fetchTrades:!0},timeframes:{"1m":"1min","5m":"5min","15m":"15min","30m":"30min","1h":"1hour","2h":"2hour","4h":"4hour","12h":"12hour","1d":"1day","1w":"1week","1M":"1month"},urls:{logo:"https://user-images.githubusercontent.com/51840849/87295553-1160ec00-c50e-11ea-8ea0-df79276a9646.jpg",api:"https://api.bitforex.com",www:"https://www.bitforex.com",doc:"https://github.com/githubdev2020/API_Doc_en/wiki",fees:"https://help.bitforex.com/en_us/?cat=13",referral:"https://www.bitforex.com/en/invitationRegister?inviterId=1867438"},api:{public:{get:["api/v1/market/symbols","api/v1/market/ticker","api/v1/market/depth","api/v1/market/trades","api/v1/market/kline"]},private:{post:["api/v1/fund/mainAccount","api/v1/fund/allAccount","api/v1/trade/placeOrder","api/v1/trade/placeMultiOrder","api/v1/trade/cancelOrder","api/v1/trade/cancelMultiOrder","api/v1/trade/orderInfo","api/v1/trade/multiOrderInfo","api/v1/trade/orderInfos"]}},fees:{trading:{tierBased:!1,percentage:!0,maker:.001,taker:.001},funding:{tierBased:!1,percentage:!0,deposit:{},withdraw:{BTC:5e-4,ETH:.01,BCH:1e-4,LTC:.001,ETC:.005,USDT:5,CMCT:30,AION:3,LVT:0,DATA:40,RHP:50,NEO:0,AIDOC:10,BQT:2,R:2,DPY:.8,GTC:40,AGI:30,DENT:100,SAN:1,SPANK:8,AID:5,OMG:.1,BFT:5,SHOW:150,TRX:20,ABYSS:10,THM:25,ZIL:20,PPT:.2,WTC:.4,LRC:7,BNT:1,CTXC:1,MITH:20,TRUE:4,LYM:10,VEE:100,AUTO:200,REN:50,TIO:2.5,NGC:1.5,PST:10,CRE:200,IPC:5,PTT:1e3,XMCT:20,ATMI:40,TERN:40,XLM:.01,ODE:15,FTM:100,RTE:100,DCC:100,IMT:500,GOT:3,EGT:500,DACC:1e3,UBEX:500,ABL:100,OLT:100,DAV:40,THRT:10,RMESH:3,UPP:20,SDT:0,SHR:10,MTV:3,ESS:100,MET:3,TTC:20,LXT:10,XCLP:100,LUK:100,UBC:100,DTX:10,BEAT:20,DEED:2,BGX:3e3,PRL:20,ELY:50,CARD:300,SQR:15,VRA:400,BWX:3500,MAS:75,FLP:.6,UNC:300,CRNC:15,MFG:70,ZXC:70,TRT:30,ZIX:35,XRA:10,AMO:1600,IPG:3,uDoo:50,URB:30,ARCONA:3,CRAD:5,NOBS:1e3,ADF:2,ELF:5,LX:20,PATH:15,SILK:120,SKYFT:50,EDN:50,ADE:50,EDR:10,TIME:.25,SPRK:20,QTUM:.01,BF:5,ZPR:100,HYB:10,CAN:30,CEL:10,ATS:50,KCASH:1,ACT:.01,MT:300,DXT:30,WAB:4e3,HYDRO:400,LQD:5,OPTC:200,EQUAD:80,LATX:50,LEDU:100,RIT:70,ACDC:500,FSN:2}}},commonCurrencies:{ACE:"ACE Entertainment",CAPP:"Crypto Application Token",CREDIT:"TerraCredit",CTC:"Culture Ticket Chain",GOT:"GoNetwork",HBC:"Hybrid Bank Cash",IQ:"IQ.Cash",UOS:"UOS Network"},exceptions:{4004:n,1013:a,1016:a,1017:d,1019:h,3002:o,4003:u,10204:c}})}async fetchMarkets(e={}){const t=(await this.publicGetApiV1MarketSymbols(e)).data,s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"symbol"),a=r.split("-"),n=a[2],o=a[1],c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o),h=c+"/"+d,u=!0,l={amount:this.safeInteger(i,"amountPrecision"),price:this.safeInteger(i,"pricePrecision")},f={amount:{min:this.safeNumber(i,"minOrderAmount"),max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}};s.push({id:r,symbol:h,base:c,quote:d,baseId:n,quoteId:o,active:u,precision:l,limits:f,info:i})}return s}parseTrade(e,t){let s;void 0!==t&&(s=t.symbol);const i=this.safeInteger(e,"time"),r=this.safeString(e,"tid"),a=this.safeString(e,"price"),n=this.safeString(e,"amount"),o=this.parseNumber(a),c=this.parseNumber(n),d=this.parseNumber(l.stringMul(a,n)),h=this.safeInteger(e,"direction"),u=this.parseSide(h);return{info:e,id:r,timestamp:i,datetime:this.iso8601(i),symbol:s,type:void 0,side:u,price:o,amount:c,cost:d,order:undefined,fee:void 0,takerOrMaker:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r={symbol:this.marketId(e)};void 0!==s&&(r.size=s);const a=this.market(e),n=await this.publicGetApiV1MarketTrades(this.extend(r,i));return this.parseTrades(n.data,a,t,s)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostApiV1FundAllAccount(e),s=t.data,i={info:t};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"currency"),a=this.safeCurrencyCode(r),n=this.account();n.used=this.safeString(t,"frozen"),n.free=this.safeString(t,"active"),n.total=this.safeString(t,"fix"),i[a]=n}return this.parseBalance(i,!1)}async fetchTicker(e,t={}){await this.loadMarkets();const s={symbol:this.markets[e].id},i=await this.publicGetApiV1MarketTicker(this.extend(s,t)),r=i.data,a=this.safeInteger(r,"date");return{symbol:e,timestamp:a,datetime:this.iso8601(a),high:this.safeNumber(r,"high"),low:this.safeNumber(r,"low"),bid:this.safeNumber(r,"buy"),bidVolume:void 0,ask:this.safeNumber(r,"sell"),askVolume:void 0,vwap:void 0,open:void 0,close:this.safeNumber(r,"last"),last:this.safeNumber(r,"last"),previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(r,"vol"),quoteVolume:void 0,info:i}}parseOHLCV(e,t){return[this.safeInteger(e,"time"),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"vol")]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={symbol:a.id,ktype:this.timeframes[t]};void 0!==i&&(n.size=i);const o=await this.publicGetApiV1MarketKline(this.extend(n,r)),c=this.safeValue(o,"data",[]);return this.parseOHLCVs(c,a,t,s,i)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.marketId(e)};void 0!==t&&(i.size=t);const r=await this.publicGetApiV1MarketDepth(this.extend(i,s)),a=this.safeValue(r,"data"),n=this.safeInteger(r,"time");return this.parseOrderBook(a,e,n,"bids","asks","price","amount")}parseOrderStatus(e){const t={0:"open",1:"open",2:"closed",3:"canceled",4:"canceled"};return e in t?t[e]:e}parseSide(e){return 1===e?"buy":2===e?"sell":void 0}parseOrder(e,t){const s=this.safeString(e,"orderId"),i=this.safeNumber(e,"createTime"),r=this.safeNumber(e,"lastTime"),a=t.symbol,n=this.safeInteger(e,"tradeType"),o=this.parseSide(n),c=this.safeNumber(e,"orderPrice"),d=this.safeNumber(e,"avgPrice"),h=this.safeNumber(e,"orderAmount"),u=this.safeNumber(e,"dealAmount"),l=this.parseOrderStatus(this.safeString(e,"orderState")),f=t["buy"===o?"base":"quote"],p={cost:this.safeNumber(e,"tradeFee"),currency:f};return this.safeOrder({info:e,id:s,clientOrderId:void 0,timestamp:i,datetime:this.iso8601(i),lastTradeTimestamp:r,symbol:a,type:undefined,timeInForce:void 0,postOnly:void 0,side:o,price:c,stopPrice:void 0,cost:void 0,average:d,amount:h,filled:u,remaining:void 0,status:l,fee:p,trades:void 0})}async fetchOrder(e,t,s={}){await this.loadMarkets();const i=this.market(t),r={symbol:this.marketId(t),orderId:e},a=await this.privatePostApiV1TradeOrderInfo(this.extend(r,s));return this.parseOrder(a.data,i)}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:this.marketId(e),state:0},n=await this.privatePostApiV1TradeOrderInfos(this.extend(a,i));return this.parseOrders(n.data,r,t,s)}async fetchClosedOrders(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:this.marketId(e),state:1},n=await this.privatePostApiV1TradeOrderInfos(this.extend(a,i));return this.parseOrders(n.data,r,t,s)}async createOrder(e,t,s,i,r,a={}){let n;await this.loadMarkets(),"buy"===s?n=1:"sell"===s&&(n=2);const o={symbol:this.marketId(e),price:r,amount:i,tradeType:n},c=await this.privatePostApiV1TradePlaceOrder(this.extend(o,a)),d=c.data;return{info:c,id:this.safeString(d,"orderId")}}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={orderId:e};void 0!==t&&(i.symbol=this.marketId(t));const r=await this.privatePostApiV1TradeCancelOrder(this.extend(i,s));return{info:r,success:r.success}}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if("public"===t)Object.keys(o).length&&(n+="?"+this.urlencode(o));else{this.checkRequiredCredentials();let t=this.urlencode({accessKey:this.apiKey});o.nonce=this.milliseconds(),Object.keys(o).length&&(t+="&"+this.urlencode(this.keysort(o)));const s="/"+e+"?"+t;a=t+"&signData="+this.hmac(this.encode(s),this.encode(this.secret)),r={"Content-Type":"application/x-www-form-urlencoded"}}return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if("string"==typeof n&&("{"===n[0]||"["===n[0])){const e=this.id+" "+n,t=this.safeValue(o,"success");if(void 0!==t&&!t){const t=this.safeString(o,"code");throw this.throwExactlyMatchedException(this.exceptions,t,e),new r(e)}}}}},829:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ExchangeNotAvailable:a,OnMaintenance:n,ArgumentsRequired:o,BadRequest:c,AccountSuspended:d,InvalidAddress:h,PermissionDenied:u,DDoSProtection:l,InsufficientFunds:f,InvalidNonce:p,CancelPending:m,InvalidOrder:b,OrderNotFound:g,AuthenticationError:y,RequestTimeout:v,NotSupported:w,BadSymbol:k,RateLimitExceeded:S}=s(3449),{TICK_SIZE:_}=s(2115),O=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bitget",name:"Bitget",countries:["SG"],version:"v3",rateLimit:1e3,has:{cancelOrder:!0,cancelOrders:!0,CORS:!1,createOrder:!0,fetchAccounts:!0,fetchBalance:!0,fetchCurrencies:!0,fetchDeposits:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOpenOrders:!0,fetchClosedOrders:!0,fetchOrderTrades:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchWithdrawals:!0},timeframes:{"1m":"1m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","2h":"2h","4h":"4h","6h":"6h","12h":"12h","1d":"1d","1w":"1w"},hostname:"bitget.com",urls:{logo:"https://user-images.githubusercontent.com/51840849/88317935-a8a21c80-cd22-11ea-8e2b-4b9fac5975eb.jpg",api:{data:"https://api.{hostname}",api:"https://api.{hostname}",capi:"https://capi.{hostname}",swap:"https://capi.{hostname}"},www:"https://www.bitget.com",doc:["https://bitgetlimited.github.io/apidoc/en/swap","https://bitgetlimited.github.io/apidoc/en/spot"],fees:"https://www.bitget.cc/zh-CN/rate?tab=1",test:{rest:"https://testnet.bitget.com"},referral:"https://www.bitget.com/expressly?languageType=0&channelCode=ccxt&vipCode=tg9j"},api:{data:{get:["market/history/kline","market/detail/merged","market/tickers","market/allticker","market/depth","market/trade","market/history/trade","market/detail","common/symbols","common/currencys","common/timestamp"]},api:{get:["account/accounts","accounts/{account_id}/balance","order/orders","order/orders/openOrders","order/orders/history","order/deposit_withdraw"],post:["order/orders/place","order/orders/{order_id}/submitcancel","order/orders/batchcancel","order/orders/{order_id}","order/orders/{order_id}/matchresults","order/matchresults"]},capi:{get:["market/time","market/contracts","market/depth","market/tickers","market/ticker","market/trades","market/candles","market/index","market/open_count","market/open_interest","market/price_limit","market/funding_time","market/mark_price","market/open_count","market/historyFundRate"]},swap:{get:["account/accounts","account/account","account/settings","position/allPosition","position/singlePosition","position/holds","order/detail","order/orders","order/fills","order/current","order/currentPlan","order/history","order/historyPlan","trace/closeTrack","trace/currentTrack","trace/historyTrack","trace/summary","trace/profitSettleTokenIdGroup","trace/profitDateGroupList","trace/profitDateList","trace/waitProfitDateList"],post:["account/leverage","account/adjustMargin","account/modifyAutoAppendMargin","order/placeOrder","order/batchOrders","order/cancel_order","order/cancel_batch_orders","order/plan_order","order/cancel_plan","position/changeHoldModel","trace/closeTrackOrder"]}},fees:{spot:{taker:.002,maker:.002},swap:{taker:6e-4,maker:4e-4}},requiredCredentials:{apiKey:!0,secret:!0,password:!0},exceptions:{exact:{1:r,"failure to get a peer from the ring-balancer":a,4010:u,4001:r,4002:r,30001:y,30002:y,30003:y,30004:y,30005:p,30006:y,30007:c,30008:v,30009:r,30010:y,30011:u,30012:y,30013:y,30014:l,30015:y,30016:r,30017:r,30018:r,30019:a,30020:c,30021:c,30022:u,30023:c,30024:k,30025:c,30026:l,30027:y,30028:u,30029:d,30030:r,30031:c,30032:k,30033:c,30034:r,30035:r,30036:r,30037:a,30038:n,32001:d,32002:u,32003:m,32004:r,32005:b,32006:b,32007:b,32008:b,32009:b,32010:r,32011:r,32012:r,32013:r,32014:r,32015:r,32016:r,32017:r,32018:r,32019:r,32020:r,32021:r,32022:r,32023:r,32024:r,32025:r,32026:r,32027:r,32028:d,32029:r,32030:b,32031:o,32038:y,32040:r,32044:r,32045:r,32046:r,32047:r,32048:b,32049:r,32050:b,32051:b,32052:r,32053:r,32057:r,32054:r,32055:b,32056:r,32058:r,32059:b,32060:b,32061:b,32062:b,32063:b,32064:r,32065:r,32066:r,32067:r,32068:r,32069:r,32070:r,32071:r,32072:r,32073:r,32074:r,32075:r,32076:r,32077:r,32078:r,32079:r,32080:r,32083:r,33001:u,33002:d,33003:f,33004:r,33005:r,33006:r,33007:r,33008:f,33009:r,33010:r,33011:r,33012:r,33013:b,33014:g,33015:b,33016:r,33017:f,33018:r,33020:r,33021:c,33022:b,33023:r,33024:b,33025:b,33026:r,33027:b,33028:b,33029:b,33034:r,33035:r,33036:r,33037:r,33038:r,33039:r,33040:r,33041:r,33042:r,33043:r,33044:r,33045:r,33046:r,33047:r,33048:r,33049:r,33050:r,33051:r,33059:c,33060:c,33061:r,33062:r,33063:r,33064:r,33065:r,21009:r,34001:u,34002:h,34003:r,34004:r,34005:r,34006:r,34007:r,34008:f,34009:r,34010:r,34011:r,34012:r,34013:r,34014:r,34015:r,34016:u,34017:d,34018:y,34019:u,34020:u,34021:h,34022:r,34023:u,34026:r,34036:r,34037:r,34038:r,34039:r,35001:r,35002:r,35003:r,35004:r,35005:y,35008:b,35010:b,35012:b,35014:b,35015:b,35017:r,35019:b,35020:b,35021:b,35022:r,35024:r,35025:f,35026:r,35029:g,35030:b,35031:b,35032:r,35037:r,35039:r,35040:b,35044:r,35046:f,35047:f,35048:r,35049:b,35050:b,35052:f,35053:r,35055:f,35057:r,35058:r,35059:c,35060:c,35061:c,35062:b,35063:b,35064:b,35066:b,35067:b,35068:b,35069:b,35070:b,35071:b,35072:b,35073:b,35074:b,35075:b,35076:b,35077:b,35078:b,35079:b,35080:b,35081:b,35082:b,35083:b,35084:b,35085:b,35086:b,35087:b,35088:b,35089:b,35090:r,35091:r,35092:r,35093:r,35094:r,35095:c,35096:r,35097:r,35098:r,35099:r,36001:c,36002:c,36005:r,36101:y,36102:u,36103:d,36104:u,36105:u,36106:d,36107:u,36108:f,36109:u,36201:u,36202:u,36203:b,36204:r,36205:c,36206:c,36207:b,36208:b,36209:b,36210:b,36211:b,36212:b,36213:b,36214:r,36216:g,36217:b,36218:b,36219:b,36220:b,36221:b,36222:b,36223:b,36224:b,36225:b,36226:b,36227:b,36228:b,36229:b,36230:b,400:c,401:y,403:u,404:c,405:c,415:c,429:l,500:a,1001:S,1002:r,1003:r,40001:y,40002:y,40003:y,40004:p,40005:p,40006:y,40007:c,40008:p,40009:y,40010:y,40011:y,40012:y,40013:r,40014:u,40015:r,40016:u,40017:r,40018:u,40102:c,40103:c,40104:r,40105:r,40106:r,40107:r,40108:b,40109:g,40200:n,40201:b,40202:r,40203:c,40204:c,40205:c,40206:c,40207:c,40208:c,40209:c,40300:r,40301:u,40302:c,40303:c,40304:c,40305:c,40306:r,40308:n,40309:k,40400:r,40401:r,40402:c,40403:c,40404:c,40405:c,40406:c,40407:r,40408:r,40409:r,40500:b,40501:r,40502:r,40503:r,40504:r,40505:r,40506:y,40507:y,40508:r,40509:r,40600:r,40601:r,40602:r,40603:r,40604:a,40605:r,40606:r,40607:r,40608:r,40609:r,40700:c,40701:r,40702:r,40703:r,40704:r,40705:c,40706:b,40707:c,40708:c,40709:r,40710:r,40711:f,40712:f,40713:r,40714:r,"invalid sign":y,"invalid currency":k,"invalid symbol":k,"invalid period":c,"invalid user":r,"invalid amount":b,"invalid type":b,"invalid orderId":b,"invalid record":r,"invalid accountId":c,"invalid address":c,"accesskey not null":y,"illegal accesskey":y,"sign not null":y,"req_time is too much difference from server time":p,"permissions not right":u,"illegal sign invalid":y,"user locked":d,"Request Frequency Is Too High":S,"more than a daily rate of cash":c,"more than the maximum daily withdrawal amount":c,"need to bind email or mobile":r,"user forbid":u,"User Prohibited Cash Withdrawal":u,"Cash Withdrawal Is Less Than The Minimum Value":c,"Cash Withdrawal Is More Than The Maximum Value":c,"the account with in 24 hours ban coin":u,"order cancel fail":c,"base symbol error":k,"base date error":r,"api signature not valid":y,"gateway internal error":r,"audit failed":r,"order queryorder invalid":c,"market no need price":b,"limit need price":b,"userid not equal to account_id":r,"your balance is low":f,"address invalid cointype":r,"system exception":r,50003:r,50004:k,50006:u,50007:u,50008:v,50009:S,50010:r,50014:b,50015:b,50016:b,50017:b,50018:b,50019:b,50020:f,50021:b,50026:b,"invalid order query time":r,"invalid start time":c,"invalid end time":c,20003:r,"01001":r},broad:{"invalid size, valid range":r}},precisionMode:_,options:{createMarketBuyOrderRequiresPrice:!0,fetchMarkets:["spot","swap"],parseOHLCV:{volume:{spot:"amount",swap:5}},defaultType:"spot",accountId:void 0,timeframes:{spot:{"1m":"1min","5m":"5min","15m":"15min","30m":"30min","1h":"60min","2h":"120min","4h":"240min","6h":"360min","12h":"720min","1d":"1day","1w":"1week"},swap:{"1m":"60","5m":"300","15m":"900","30m":"1800","1h":"3600","2h":"7200","4h":"14400","6h":"21600","12h":"43200","1d":"86400","1w":"604800"}}}})}async fetchTime(e={}){const t=await this.dataGetCommonTimestamp(e);return this.safeInteger(t,"data")}async fetchMarkets(e={}){let t=this.safeValue(this.options,"fetchMarkets");t.length||(t=[this.options.defaultType]);let s=[];for(let i=0;i<t.length;i++){const r=await this.fetchMarketsByType(t[i],e);s=this.arrayConcat(s,r)}return s}parseMarkets(e){const t=[];for(let s=0;s<e.length;s++)t.push(this.parseMarket(e[s]));return t}parseMarket(e){const t=this.safeString(e,"symbol");let s="spot",i=!0,r=!1;const a=this.safeString2(e,"base_currency","coin"),n=this.safeString(e,"quote_currency");void 0!==this.safeNumber(e,"contract_val")&&(s="swap",i=!1,r=!0);const o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n);let d=t.toUpperCase();i&&(d=o+"/"+c);const h=this.safeString(e,"tick_size"),u=this.safeString(e,"size_increment"),l={amount:this.parseNumber(this.parsePrecision(u)),price:this.parseNumber(this.parsePrecision(h))},f=this.safeNumber2(e,"min_size","base_min_size"),p=this.safeString(e,"status");let m;void 0!==p&&(m="1"===p);const b=this.safeValue2(this.fees,s,"trading",{});return this.extend(b,{id:t,symbol:d,base:o,quote:c,baseId:a,quoteId:n,info:e,type:s,spot:i,swap:r,active:m,precision:l,limits:{amount:{min:f,max:void 0},price:{min:l.price,max:void 0},cost:{min:l.price,max:void 0}}})}async fetchMarketsByType(e,t={}){if("spot"===e){const e=await this.dataGetCommonSymbols(t),s=this.safeValue(e,"data",[]);return this.parseMarkets(s)}if("swap"===e){const e=await this.capiGetMarketContracts(t);return this.parseMarkets(e)}throw new w(this.id+" fetchMarketsByType does not support market type "+e)}async fetchCurrencies(e={}){const t=await this.dataGetCommonCurrencys(e),s={},i=this.safeValue(t,"data",[]);for(let e=0;e<i.length;e++){const t=i[e],r=this.safeCurrencyCode(t);s[r]={id:t,code:r,info:t,type:void 0,name:void 0,active:void 0,fee:void 0,precision:void 0,limits:{amount:{min:void 0,max:void 0},withdraw:{min:void 0,max:void 0}}}}return s}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),r={symbol:i.id};let a;i.spot?(a="dataGetMarketDepth",r.type="step0"):i.swap&&(a="capiGetMarketDepth",r.limit=void 0===t?100:t);const n=await this[a](this.extend(r,s)),o=this.safeValue(n,"data",n),c=this.safeInteger2(o,"timestamp","ts"),d=this.safeInteger(o,"id"),h=this.parseOrderBook(o,e,c);return h.nonce=d,h}parseTicker(e,t){const s=this.safeInteger2(e,"timestamp","id");let i;const r=this.safeString2(e,"instrument_id","symbol");if(r in this.markets_by_id)i=(t=this.markets_by_id[r]).symbol;else if(void 0!==r){const e=r.split("_");if(2===e.length){const[t,s]=e;i=this.safeCurrencyCode(t)+"/"+this.safeCurrencyCode(s)}else i=r}void 0===i&&void 0!==t&&(i=t.symbol);const a=this.safeNumber2(e,"last","close"),n=this.safeNumber(e,"open");let o,c,d=this.safeValue(e,"bid");void 0===d?d=this.safeNumber(e,"best_bid"):(o=this.safeNumber(d,1),d=this.safeNumber(d,0));let h=this.safeValue(e,"ask");void 0===h?h=this.safeNumber(e,"best_ask"):(c=this.safeNumber(h,1),h=this.safeNumber(h,0));const u=this.safeNumber2(e,"amount","volume_24h"),l=this.safeNumber(e,"vol"),f=this.vwap(u,l);let p,m,b;return void 0!==a&&void 0!==n&&(p=a-n,m=p/n*100,b=this.sum(n,a)/2),{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber2(e,"high","high_24h"),low:this.safeNumber2(e,"low","low_24h"),bid:d,bidVolume:o,ask:h,askVolume:c,vwap:f,open:n,close:a,last:a,previousClose:void 0,change:p,percentage:m,average:b,baseVolume:u,quoteVolume:l,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e);let i;s.spot?i="dataGetMarketDetailMerged":s.swap&&(i="capiGetMarketTicker");const r={symbol:s.id},a=await this[i](this.extend(r,t)),n=this.safeValue(a,"data",a);return this.parseTicker(n,s)}async fetchTickersByType(e,t,s={}){let i;await this.loadMarkets(),"spot"===e?i="dataGetMarketTickers":"swap"===e&&(i="capiGetMarketTickers");const r=await this[i](s),a=this.safeValue(r,"data",r);let n;Array.isArray(r)||(n=this.safeInteger(r,"ts"));const o={};for(let e=0;e<a.length;e++){const t=this.parseTicker(this.extend({timestamp:n},a[e]));o[t.symbol]=t}return this.filterByArray(o,"symbol",t)}async fetchTickers(e,t={}){const s=this.safeString2(this.options,"fetchTickers","defaultType"),i=this.safeString(t,"type",s);return await this.fetchTickersByType(i,e,this.omit(t,"type"))}parseTrade(e,t){let s;const i=this.safeString(e,"symbol");let r,a;if(i in this.markets_by_id)s=(t=this.markets_by_id[i]).symbol,r=t.base,a=t.quote;else if(void 0!==i){const e=i.split("_");if(2===e.length){const[t,i]=e;r=this.safeCurrencyCode(t),a=this.safeCurrencyCode(i),s=r+"/"+a}else s=i.toUpperCase()}void 0===s&&void 0!==t&&(s=t.symbol,r=t.base,a=t.quote);let n=this.safeInteger(e,"created_at");n=this.safeInteger2(e,"timestamp","ts",n);const o=this.safeString(e,"price");let c=this.safeString2(e,"filled_amount","order_qty");c=this.safeString2(e,"size","amount",c);const d=this.parseNumber(o),h=this.parseNumber(c),u=this.parseNumber(O.stringMul(o,c));let l=this.safeString2(e,"exec_type","liquidity");"M"===l?l="maker":"T"===l&&(l="taker");let f,p;void 0!==this.safeString(e,"type")?(f=this.safeString(e,"type"),p=this.parseOrderType(f),f=this.parseOrderSide(f)):(f=this.safeString2(e,"side","direction"),p=this.parseOrderType(f),f=this.parseOrderSide(f));let m=this.safeString(e,"fee");m=void 0===m?this.safeString(e,"filled_fees"):O.stringNeg(m);const b=this.parseNumber(m);let g;if(void 0!==b){g={cost:b,currency:"buy"===f?r:a}}const y=this.safeString(e,"order_id"),v=this.safeString2(e,"trade_id","id");return{info:e,timestamp:n,datetime:this.iso8601(n),symbol:s,id:v,order:y,type:p,takerOrMaker:l,side:f,price:d,amount:h,cost:u,fee:g}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id};let n;r.spot?n="dataGetMarketHistoryTrade":r.swap&&(n="capiGetMarketTrades"),r.spot?void 0!==t&&(a.size=t):r.swap&&(void 0===t&&(t=100),a.limit=t);const o=await this[n](this.extend(a,i));let c;if(Array.isArray(o))c=o;else{const e=this.safeValue(o,"data",{});c=this.safeValue2(e,"data",[])}return this.parseTrades(c,r,s,t)}parseOHLCV(e,t,s="1m"){const i=this.safeValue(this.options,"parseOHLCV",{}),r=this.safeValue(i,"volume",{});if(Array.isArray(e)){const s=this.safeString(r,t.type,"amount");return[this.safeInteger(e,0),this.safeNumber(e,1),this.safeNumber(e,2),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,s)]}{const s=this.safeValue(r,t.type,6);return[this.safeInteger(e,"id"),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,s)]}}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={symbol:a.id};let o;const c=a.type,d=this.safeValue(this.options,"timeframes",{}),h=this.safeValue(d,c,{}),u=this.safeValue(h,this.timeframes[t]);if(a.spot)o="dataGetMarketHistoryKline",n.period=u,void 0!==i&&(n.size=i);else if(a.swap){const e=this.parseTimeframe(t);o="capiGetMarketCandles",n.granularity=u;const r=this.milliseconds();void 0===s?(void 0===i&&(i=1e3),n.start=this.iso8601(r-i*e*1e3),n.end=this.iso8601(r)):(n.start=this.iso8601(s),n.end=void 0===i?this.iso8601(r):this.iso8601(this.sum(s,i*e*1e3)))}const l=await this[o](this.extend(n,r));let f=l;return Array.isArray(l)||(f=this.safeValue(l,"data",[])),this.parseOHLCVs(f,a,t,s,i)}parseSpotBalance(e){const t={info:e},s=this.safeValue(e,"data"),i=this.safeValue(s,"list");for(let e=0;e<i.length;e++){const s=i[e],r=this.safeString(s,"currency"),a=this.safeCurrencyCode(r);if(!(a in t)){const e=this.account();t[a]=e}const n=this.safeValue(s,"type");if("trade"===n)t[a].free=this.safeString(s,"balance");else if("frozen"===n||"lock"===n){const e=this.safeString(t[a],"used");t[a].used=O.stringAdd(e,this.safeString(s,"balance"))}}return this.parseBalance(t,!1)}parseSwapBalance(e){const t={};for(let s=0;s<e.length;s++){const i=e[s],r=this.safeString(i,"symbol");let a=r;r in this.markets_by_id&&(a=this.markets_by_id[r].symbol);const n=this.account();n.total=this.safeString(i,"equity"),n.free=this.safeString(i,"total_avail_balance"),t[a]=n}return this.parseBalance(t,!1)}async fetchAccounts(e={}){const t=await this.apiGetAccountAccounts(this.extend({method:"accounts"},e)),s=this.safeValue(t,"data",[]),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"id"),a=this.safeStringLower(t,"type");i.push({id:r,type:a,currency:void 0,info:t})}return i}async findAccountByType(e){await this.loadMarkets(),await this.loadAccounts();const t=this.groupBy(this.accounts,"type"),s=this.safeValue(t,e);if(void 0===s)throw new r(this.id+" findAccountByType() could not find an accountId with type '"+e+"', specify the 'accountId' parameter instead");if(s.length>1)throw new r(this.id+" findAccountByType() found more than one accountId with type '"+e+"', specify the 'accountId' parameter instead");return s[0]}async getAccountId(e){await this.loadMarkets(),await this.loadAccounts();const t=this.safeString(this.options,"accountId"),s=this.safeString(e,"accountId",t);if(void 0!==s)return s;const i=this.safeString(this.options,"defaultType","margin"),r=this.safeString(e,"type",i);if(e=this.omit(e,"type"),void 0===r)throw new o(this.id+" getAccountId() requires an 'accountId' parameter");return(await this.findAccountByType(r)).id}async fetchBalance(e={}){await this.loadMarkets(),await this.loadAccounts();const t=this.safeString2(this.options,"fetchBalance","defaultType"),s=this.safeString(e,"type",t);if(void 0===s)throw new o(this.id+" fetchBalance() requires a 'type' parameter, one of 'spot', 'swap'");let i;const r=this.omit(e,"type");if("spot"===s){const t=await this.getAccountId(e);i="apiGetAccountsAccountIdBalance",r.account_id=t,r.method="balance"}else"swap"===s&&(i="swapGetAccountAccounts");const a=await this[i](r);return this.parseBalanceByType(s,a)}parseBalanceByType(e,t){if("spot"===e)return this.parseSpotBalance(t);if("swap"===e)return this.parseSwapBalance(t);throw new w(this.id+" fetchBalance does not support the '"+e+"' type (the type must be one of 'account', 'spot', 'margin', 'futures', 'swap')")}parseOrderStatus(e){return this.safeString({submitted:"open","partial-filled":"open","partial-canceled":"canceled",filled:"closed",canceled:"canceled","-2":"failed","-1":"canceled",0:"open",1:"open",2:"closed",3:"open",4:"canceled"},e,e)}parseOrderSide(e){return this.safeString({"buy-market":"buy","sell-market":"sell","buy-limit":"buy","sell-limit":"sell",1:"long",2:"short",3:"long",4:"short"},e,e)}parseOrderType(e){return this.safeString({"buy-market":"market","sell-market":"market","buy-limit":"limit","sell-limit":"limit",1:"open",2:"open",3:"close",4:"close"},e,e)}parseOrder(e,t){let s=this.safeString(e,"order_id");s=this.safeString2(e,"id","data",s);const i=this.safeInteger2(e,"created_at","createTime");let r=this.safeString(e,"type");const a=this.parseOrderSide(r);let n;r=this.parseOrderType(r);const o=this.safeString(e,"symbol");void 0!==o&&(o in this.markets_by_id?t=this.markets_by_id[o]:n=o.toUpperCase()),void 0===n&&void 0!==t&&(n=t.symbol);const c=this.safeNumber2(e,"amount","size"),d=this.safeNumber2(e,"filled_amount","filled_qty"),h=this.safeNumber(e,"filled_cash_amount"),u=this.safeNumber(e,"price"),l=this.safeNumber(e,"price_avg"),f=this.parseOrderStatus(this.safeString2(e,"state","status")),p=this.safeNumber2(e,"filled_fees","fee");let m;if(void 0!==p){m={cost:p,currency:void 0}}const b=this.safeString(e,"client_oid");return this.safeOrder({info:e,id:s,clientOrderId:b,timestamp:i,datetime:this.iso8601(i),lastTradeTimestamp:void 0,symbol:n,type:r,timeInForce:void 0,postOnly:void 0,side:a,price:u,stopPrice:void 0,average:l,cost:h,amount:c,filled:d,remaining:void 0,status:f,fee:m,trades:void 0})}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets(),await this.loadAccounts();const n=this.market(e),c={symbol:n.id},d=this.safeString2(a,"client_oid","clientOrderId",this.uuid());let h;if(a=this.omit(a,["client_oid","clientOrderId"]),n.spot){const o=await this.getAccountId({type:n.type});if(h="apiPostOrderOrdersPlace",c.account_id=o,c.method="place",c.type=s+"-"+t,"limit"===t)c.amount=this.amountToPrecision(e,i),c.price=this.priceToPrecision(e,r);else if("market"===t)if("buy"===s){let t=this.safeNumber(a,"amount");if(this.safeValue(this.options,"createMarketBuyOrderRequiresPrice",!0)){if(void 0!==r)void 0===t&&(t=i*r);else if(void 0===t)throw new b(this.id+" createOrder() requires the price argument with market buy orders to calculate total order cost (amount to spend), where cost = amount * price. Supply a price argument to createOrder() call if you want the cost to be calculated for you from price and amount, or, alternatively, add .options['createMarketBuyOrderRequiresPrice'] = false and supply the total cost value in the 'amount' argument or in the 'amount' extra parameter (the exchange-specific behaviour)")}else t=void 0===t?i:t;c.amount=this.costToPrecision(e,t)}else"sell"===s&&(c.amount=this.amountToPrecision(e,i))}else if(n.swap){c.order_type="0",c.client_oid=d;const s=this.safeString(a,"type");if(void 0===s)throw new o(this.id+" createOrder() requires a type parameter, '1' = open long, '2' = open short, '3' = close long, '4' = close short for "+n.type+" orders");c.size=this.amountToPrecision(e,i),c.type=s,"limit"===t?(c.match_price="0",c.price=this.priceToPrecision(e,r)):"market"===t&&(c.match_price="1"),h="swapPostOrderPlaceOrder"}const u=await this[h](this.extend(c,a));return this.parseOrder(u,n)}async cancelOrder(e,t,s={}){let i,r;if(await this.loadMarkets(),void 0===t){const e=this.safeString2(this.options,"cancelOrder","defaultType");if("spot"===this.safeString(s,"type",e)&&void 0===t)throw new o(this.id+" cancelOrder() requires a symbol argument for spot orders")}else i=this.market(t),r=i.type;const a=this.omit(s,"type");let n;const c={};"spot"===r?(n="apiPostOrderOrdersOrderIdSubmitcancel",c.order_id=e,c.method="submitcancel"):"swap"===r&&(n="swapPostOrderCancelOrder",c.orderId=e,c.symbol=i.id);const d=await this[n](this.extend(c,a));return this.parseOrder(d,i)}async cancelOrders(e,t,s={}){if(void 0===t)throw new o(this.id+" cancelOrders() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r=this.safeString(s,"type",i.type);if(void 0===r)throw new o(this.id+" cancelOrders() requires a type parameter (one of 'spot', 'swap').");s=this.omit(s,"type");const a={};let n;if("spot"===r){n="apiPostOrderOrdersBatchcancel",a.method="batchcancel";const t=this.json(e).split('"');a.order_ids=t.join("")}else"swap"===r&&(n="swapPostOrderCancelBatchOrders",a.symbol=i.id,a.ids=e);return await this[n](this.extend(a,s))}async fetchOrder(e,t,s={}){if(void 0===t)throw new o(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r=this.safeString(s,"type",i.type);if(void 0===r)throw new o(this.id+" fetchOrder() requires a type parameter (one of 'spot', 'swap').");let a;const n={};if("spot"===r){const t=this.safeString(s,"client_oid");void 0!==t?(a="apiPostOrderOrdersClientOid",n.client_oid=t):(a="apiPostOrderOrdersOrderId",n.order_id=e),n.method="getOrder"}else"swap"===r&&(a="swapGetOrderDetail",n.symbol=i.id,n.orderId=e);const c=this.omit(s,"type"),d=await this[a](this.extend(n,c)),h=this.safeValue(d,"data",d);return this.parseOrder(h,i)}async fetchOpenOrders(e,t,s,i={}){if(void 0===e)throw new o(this.id+" fetchOpenOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a=this.safeString(i,"type",r.type),n={symbol:r.id};let c;"spot"===a?(c="apiGetOrderOrdersOpenOrders",n.method="openOrders",void 0===s&&(n.size=s)):"swap"===a&&(c="swapGetOrderOrders",n.status="3",n.from="1",n.to="1",void 0===s&&(n.limit=100));const d=this.omit(i,"type"),h=await this[c](this.extend(n,d));let u=h;return Array.isArray(h)||(u=this.safeValue(h,"data",[])),this.parseOrders(u,r,void 0,s)}async fetchClosedOrders(e,t,s,i={}){if(void 0===e)throw new o(this.id+" fetchClosedOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a=this.safeString(i,"type",r.type),n={symbol:r.id};let c;"spot"===a?(c="apiGetOrderOrdersHistory",void 0!==t&&(n.start_time=t),n.method="openOrders",void 0===s&&(n.size=s)):"swap"===a&&(c="swapGetOrderOrders",n.status="2",n.from="1",n.to="1",void 0===s&&(n.limit=100));const d=this.omit(i,"type"),h=await this[c](this.extend(n,d));let u=h;return Array.isArray(h)||(u=this.safeValue(h,"data",[])),this.parseOrders(u,r,void 0,s)}async fetchDeposits(e,t,s,i={}){if(void 0===e)throw new o(this.id+" fetchDeposits() requires a currency code argument");await this.loadMarkets();const r=this.currency(e),a={currency:r.id,method:"deposit_withdraw",type:"deposit",size:12},n=await this.apiGetOrderDepositWithdraw(this.extend(a,i)),c=this.safeValue(n,"data",[]);return this.parseTransactions(c,r,t,s,i)}async fetchWithdrawals(e,t,s,i={}){if(void 0===e)throw new o(this.id+" fetchWithdrawals() requires a currency code argument");await this.loadMarkets();const r=this.currency(e),a={currency:r.id,method:"deposit_withdraw",type:"withdraw",size:12},n=await this.apiGetOrderDepositWithdraw(this.extend(a,i)),c=this.safeValue(n,"data",[]);return this.parseTransactions(c,r,t,s,i)}parseTransactionStatus(e){return this.safeString({WaitForOperation:"pending",OperationLock:"pending",OperationSuccess:"ok",Cancel:"canceled",Sure:"ok",Fail:"failed",WaitForChainSure:"ok",WAIT_0:"pending",WAIT_1:"pending",DATA_CHANGE:"pending",SUCCESS:"ok"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"address"),r=this.safeString(e,"address_tag"),a=r,n=i;let o=this.safeString(e,"type");"withdraw"===o?o="withdrawal":"deposit"===o&&(o="deposit");const c=this.safeString(e,"currency"),d=this.safeCurrencyCode(c),h=this.safeNumber(e,"amount"),u=this.parseTransactionStatus(this.safeString(e,"state")),l=this.safeString(e,"tx_hash"),f=this.safeInteger(e,"created_at"),p=this.safeInteger(e,"updated_at"),m=this.safeNumber(e,"fee");let b;return void 0!==m&&(b={currency:d,cost:m}),{info:e,id:s,currency:d,amount:h,addressFrom:undefined,addressTo:n,address:i,tagFrom:undefined,tagTo:a,tag:r,status:u,type:o,updated:p,txid:l,timestamp:f,datetime:this.iso8601(f),fee:b}}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new o(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a=this.safeString(i,"type",r.type),n=this.omit(i,"type");if("swap"===a)throw new o(this.id+" fetchMyTrades() is not supported for "+a+" type");const c={symbol:r.id,method:"matchresults"};if(void 0!==t){c.start_date=this.ymd(t);const e=this.sum(t,1728e5);c.end_date=this.ymd(e)}void 0!==s&&(c.size=s);const d=await this.apiPostOrderMatchresults(this.extend(c,n)),h=this.safeValue(d,"data",[]);return this.parseTrades(h,r,t,s)}async fetchOrderTrades(e,t,s,i,r={}){if(void 0===t)throw new o(this.id+" fetchOrderTrades() requires a symbol argument");await this.loadMarkets();const a=this.market(t),n=this.safeString(r,"type",a.type);let c;r=this.omit(r,"type");const d={};"spot"===n?(d.order_id=e,d.method="matchresults",c="apiPostOrderOrdersOrderIdMatchresults"):"swap"===n&&(d.orderId=e,d.symbol=a.id,c="swapGetOrderFills");const h=await this[c](this.extend(d,r));let u=h;return Array.isArray(u)||(u=this.safeValue(h,"data",[])),await this.parseTrades(u,a,s,i)}async fetchPosition(e,t={}){await this.loadMarkets();const s={symbol:this.market(e).id};return await this.swapGetPositionSinglePosition(this.extend(s,t))}async fetchPositions(e,t={}){await this.loadMarkets();return await this.swapGetPositionAllPosition(t)}sign(e,t="public",s="GET",i={},r,a){let n="/"+this.implodeParams(e,i);n="capi"===t||"swap"===t?"/api/swap/"+this.version+n:"/"+t+"/v1"+n;let o=this.omit(i,this.extractParams(e)),c=this.implodeParams(this.urls.api[t],{hostname:this.hostname})+n;if("data"===t||"capi"===t)Object.keys(o).length&&(c+="?"+this.urlencode(o));else if("swap"===t){this.checkRequiredCredentials();const e=this.milliseconds().toString();let t=e+s+n;if("POST"===s)t+=a=this.json(i);else if(Object.keys(i).length){const e=this.urlencode(this.keysort(i));c+="?"+e,t+="?"+e}const o=this.hmac(this.encode(t),this.encode(this.secret),"sha256","base64");r={"ACCESS-KEY":this.apiKey,"ACCESS-SIGN":o,"ACCESS-TIMESTAMP":e,"ACCESS-PASSPHRASE":this.password},"POST"===s&&(r["Content-Type"]="application/json")}else if("api"===t){const e=this.milliseconds().toString();let t="";o=this.keysort(o),t=this.rawencode(o);const i=this.hash(this.encode(this.secret),"sha1");let n=t;const d=this.hmac(this.encode(t),this.encode(i),"md5");t.length>0&&(n+="&"),n+="sign="+d+"&req_time="+e+"&accesskey="+this.apiKey,"GET"===s?Object.keys(o).length&&(c+="?"+n):"POST"===s&&(c+="?sign="+d+"&req_time="+e+"&accesskey="+this.apiKey,a=t,r={"Content-Type":"application/x-www-form-urlencoded"})}return{url:c,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(!o)return;const h=this.safeString(o,"err_msg"),u=this.safeString2(o,"code","err_code"),l=this.id+" "+n,f=void 0!==h&&""!==h;f&&(this.throwExactlyMatchedException(this.exceptions.exact,h,l),this.throwBroadlyMatchedException(this.exceptions.broad,h,l));const p=void 0!==u&&"00000"!==u;if(p&&this.throwExactlyMatchedException(this.exceptions.exact,u,l),p||f)throw new r(l)}}},9202:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ExchangeNotAvailable:a,AuthenticationError:n,BadRequest:o,PermissionDenied:c,InvalidAddress:d,ArgumentsRequired:h,InvalidOrder:u}=s(3449),{DECIMAL_PLACES:l,SIGNIFICANT_DIGITS:f,TRUNCATE:p}=s(2115),m=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bithumb",name:"Bithumb",countries:["KR"],rateLimit:500,has:{cancelOrder:!0,CORS:!0,createMarketOrder:!0,createOrder:!0,fetchBalance:!0,fetchMarkets:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,withdraw:!0},hostname:"bithumb.com",urls:{logo:"https://user-images.githubusercontent.com/1294454/30597177-ea800172-9d5e-11e7-804c-b9d4fa9b56b0.jpg",api:{public:"https://api.{hostname}/public",private:"https://api.{hostname}"},www:"https://www.bithumb.com",doc:"https://apidocs.bithumb.com",fees:"https://en.bithumb.com/customer_support/info_fee"},api:{public:{get:["ticker/{currency}","ticker/all","ticker/ALL_BTC","ticker/ALL_KRW","orderbook/{currency}","orderbook/all","transaction_history/{currency}","transaction_history/all","candlestick/{currency}/{interval}"]},private:{post:["info/account","info/balance","info/wallet_address","info/ticker","info/orders","info/user_transactions","info/order_detail","trade/place","trade/cancel","trade/btc_withdrawal","trade/krw_deposit","trade/krw_withdrawal","trade/market_buy","trade/market_sell"]}},fees:{trading:{maker:.0025,taker:.0025}},precisionMode:f,exceptions:{"Bad Request(SSL)":o,"Bad Request(Bad Method)":o,"Bad Request.(Auth Data)":n,"Not Member":n,"Invalid Apikey":n,"Method Not Allowed.(Access IP)":c,"Method Not Allowed.(BTC Adress)":d,"Method Not Allowed.(Access)":c,"Database Fail":a,"Invalid Parameter":o,5600:r,"Unknown Error":r,"After May 23th, recent_transactions is no longer, hence users will not be able to connect to recent_transactions":r},timeframes:{"1m":"1m","3m":"3m","5m":"5m","10m":"10m","30m":"30m","1h":"1h","6h":"6h","12h":"12h","1d":"24h"},options:{quoteCurrencies:{BTC:{limits:{cost:{min:2e-4,max:100}}},KRW:{limits:{cost:{min:500,max:5e9}}}}},commonCurrencies:{SOC:"Soda Coin"}})}amountToPrecision(e,t){return this.decimalToPrecision(t,p,this.markets[e].precision.amount,l)}async fetchMarkets(e={}){const t=[],s=this.safeValue(this.options,"quoteCurrencies",{}),i=Object.keys(s);for(let r=0;r<i.length;r++){const a=i[r],n=this.safeValue(s,a,{}),o="publicGetTickerALL"+a,c=await this[o](e),d=this.safeValue(c,"data"),h=Object.keys(d);for(let e=0;e<h.length;e++){const s=h[e];if("date"===s)continue;const i=d[s],r=this.safeCurrencyCode(s),o=s+"/"+a;let c=!0;if(Array.isArray(i)){0===i.length&&(c=!1)}const u=this.deepExtend({id:s,symbol:o,base:r,quote:a,info:i,active:c,precision:{amount:4,price:4},limits:{amount:{min:void 0,max:void 0},price:{min:void 0,max:void 0},cost:{}},baseId:void 0,quoteId:void 0},n);t.push(u)}}return t}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostInfoBalance(this.extend({currency:"ALL"},e)),s={info:t},i=this.safeValue(t,"data"),r=Object.keys(this.currencies);for(let e=0;e<r.length;e++){const t=r[e],a=this.account(),n=this.currency(t),o=this.safeStringLower(n,"id");a.total=this.safeString(i,"total_"+o),a.used=this.safeString(i,"in_use_"+o),a.free=this.safeString(i,"available_"+o),s[t]=a}return this.parseBalance(s,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),r={currency:i.base+"_"+i.quote};void 0!==t&&(r.count=t);const a=await this.publicGetOrderbookCurrency(this.extend(r,s)),n=this.safeValue(a,"data",{}),o=this.safeInteger(n,"timestamp");return this.parseOrderBook(n,e,o,"bids","asks","price","quantity")}parseTicker(e,t){const s=this.safeInteger(e,"date");let i;void 0!==t&&(i=t.symbol);const r=this.safeNumber(e,"opening_price"),a=this.safeNumber(e,"closing_price");let n,o,c;void 0!==a&&void 0!==r&&(n=a-r,r>0&&(o=n/r*100),c=this.sum(r,a)/2);const d=this.safeNumber(e,"units_traded_24H"),h=this.safeNumber(e,"acc_trade_value_24H"),u=this.vwap(d,h);return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"max_price"),low:this.safeNumber(e,"min_price"),bid:this.safeNumber(e,"buy_price"),bidVolume:void 0,ask:this.safeNumber(e,"sell_price"),askVolume:void 0,vwap:u,open:r,close:a,last:a,previousClose:void 0,change:n,percentage:o,average:c,baseVolume:d,quoteVolume:h,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTickerAll(t),i={},r=this.safeValue(s,"data",{}),a=this.safeInteger(r,"date"),n=this.omit(r,"date"),o=Object.keys(n);for(let e=0;e<o.length;e++){const t=o[e];let s,r=t;t in this.markets_by_id&&(s=this.markets_by_id[t],r=s.symbol);const c=n[t];Array.isArray(c)||(c.date=a,i[r]=this.parseTicker(c,s))}return this.filterByArray(i,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={currency:s.base},r=await this.publicGetTickerCurrency(this.extend(i,t)),a=this.safeValue(r,"data",{});return this.parseTicker(a,s)}parseOHLCV(e,t){return[this.safeInteger(e,0),this.safeNumber(e,1),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,2),this.safeNumber(e,5)]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={currency:a.base,interval:this.timeframes[t]},o=await this.publicGetCandlestickCurrencyInterval(this.extend(n,r)),c=this.safeValue(o,"data",[]);return this.parseOHLCVs(c,a,t,s,i)}parseTrade(e,t){let s;const i=this.safeString(e,"transaction_date");if(void 0!==i){const t=i.split(" ");if(t.length>1){const e=t[0];let i=t[1];i.length<8&&(i="0"+i),s=this.parse8601(e+" "+i)}else s=this.safeIntegerProduct(e,"transaction_date",.001)}void 0!==s&&(s-=324e5);let r=this.safeString(e,"type");r="ask"===r?"sell":"buy";const a=this.safeString(e,"cont_no");let n;void 0!==t&&(n=t.symbol);const o=this.safeString(e,"price"),c=this.safeString2(e,"units_traded","units"),d=this.parseNumber(o),h=this.parseNumber(c);let u,l=this.safeNumber(e,"total");void 0===l&&(l=this.parseNumber(m.stringMul(o,c)));const f=this.safeNumber(e,"fee");if(void 0!==f){const t=this.safeString(e,"fee_currency");u={cost:f,currency:this.commonCurrencyCode(t)}}return{id:a,info:e,timestamp:s,datetime:this.iso8601(s),symbol:n,order:void 0,type:undefined,side:r,takerOrMaker:void 0,price:d,amount:h,cost:l,fee:u}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={currency:r.base};void 0===s&&(a.count=s);const n=await this.publicGetTransactionHistoryCurrency(this.extend(a,i)),o=this.safeValue(n,"data",[]);return this.parseTrades(o,r,t,s)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o={order_currency:n.id,payment_currency:n.quote,units:i};let c="privatePostTradePlace";"limit"===t?(o.price=r,o.type="buy"===s?"bid":"ask"):c="privatePostTradeMarket"+this.capitalize(s);const d=await this[c](this.extend(o,a)),h=this.safeString(d,"order_id");if(void 0===h)throw new u(this.id+" createOrder() did not return an order id");return{info:d,symbol:e,type:t,side:s,id:h}}async fetchOrder(e,t,s={}){if(void 0===t)throw new h(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={order_id:e,count:1,order_currency:i.base,payment_currency:i.quote},a=await this.privatePostInfoOrderDetail(this.extend(r,s)),n=this.safeValue(a,"data");return this.parseOrder(this.extend(n,{order_id:e}),i)}parseOrderStatus(e){return this.safeString({Pending:"open",Completed:"closed",Cancel:"canceled"},e,e)}parseOrder(e,t){const s=this.safeIntegerProduct(e,"order_date",.001),i="bid"===this.safeValue2(e,"type","side")?"buy":"sell",r=this.parseOrderStatus(this.safeString(e,"order_status"));let a=this.safeNumber2(e,"order_price","price"),n="limit";0===a&&(a=void 0,n="market");const o=this.safeNumber2(e,"order_qty","units");let c,d=this.safeNumber(e,"units_remaining");void 0===d&&("closed"===r?d=0:"canceled"!==r&&(d=o));const h=this.safeString(e,"order_currency"),u=this.safeString(e,"payment_currency"),l=this.safeCurrencyCode(h),f=this.safeCurrencyCode(u);void 0!==l&&void 0!==f&&(c=l+"/"+f),void 0===c&&void 0!==t&&(c=t.symbol);const p=this.safeString(e,"order_id"),m=this.safeValue(e,"contract",[]),b=this.parseTrades(m,t,void 0,void 0,{side:i,symbol:c,order:p});return this.safeOrder({info:e,id:p,clientOrderId:void 0,timestamp:s,datetime:this.iso8601(s),lastTradeTimestamp:void 0,symbol:c,type:n,timeInForce:void 0,postOnly:void 0,side:i,price:a,stopPrice:void 0,amount:o,cost:void 0,average:void 0,filled:void 0,remaining:d,status:r,fee:void 0,trades:b})}async fetchOpenOrders(e,t,s,i={}){if(void 0===e)throw new h(this.id+" fetchOpenOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e);void 0===s&&(s=100);const a={count:s,order_currency:r.base,payment_currency:r.quote};void 0!==t&&(a.after=t);const n=await this.privatePostInfoOrders(this.extend(a,i)),o=this.safeValue(n,"data",[]);return this.parseOrders(o,r,t,s)}async cancelOrder(e,t,s={}){if(!("side"in s))throw new h(this.id+" cancelOrder() requires a `side` parameter (sell or buy)");if(void 0===t)throw new h(this.id+" cancelOrder() requires a `symbol` argument");const i=this.market(t),r="buy"===s.side?"bid":"ask";s=this.omit(s,["side","currency"]);const a={order_id:e,type:r,order_currency:i.base,payment_currency:i.quote};return await this.privatePostTradeCancel(this.extend(a,s))}cancelUnifiedOrder(e,t={}){const s={side:e.side};return this.cancelOrder(e.id,e.symbol,this.extend(s,t))}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a=this.currency(e),n={units:t,address:s,currency:a.id};if("XRP"===a||"XMR"===a||"EOS"===a||"STEEM"===a){const t=this.safeString(r,"destination");if(void 0===i&&void 0===t)throw new h(this.id+" "+e+" withdraw() requires a tag argument or an extra destination param");void 0!==i&&(n.destination=i)}return{info:await this.privatePostTradeBtcWithdrawal(this.extend(n,r)),id:void 0}}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){const n="/"+this.implodeParams(e,i);let o=this.implodeParams(this.urls.api[t],{hostname:this.hostname})+n;const c=this.omit(i,this.extractParams(e));if("public"===t)Object.keys(c).length&&(o+="?"+this.urlencode(c));else{this.checkRequiredCredentials(),a=this.urlencode(this.extend({endpoint:n},c));const e=this.nonce().toString(),t=n+"\0"+a+"\0"+e,s=this.hmac(this.encode(t),this.encode(this.secret),"sha512"),i=this.decode(this.stringToBase64(s));r={Accept:"application/json","Content-Type":"application/x-www-form-urlencoded","Api-Key":this.apiKey,"Api-Sign":i,"Api-Nonce":e}}return{url:o,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0!==o&&"status"in o){const e=this.safeString(o,"status"),t=this.safeString(o,"message");if(void 0!==e){if("0000"===e)return;if("거래 진행중인 내역이 존재하지 않습니다"===t)return;const s=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions,e,s),this.throwExactlyMatchedException(this.exceptions,t,s),new r(s)}}}async request(e,t="public",s="GET",i={},a,n){const o=await this.fetch2(e,t,s,i,a,n);if("status"in o){if("0000"===o.status||"거래 진행중인 내역이 존재하지 않습니다"===o.message)return o;throw new r(this.id+" "+this.json(o))}return o}}},9102:(e,t,s)=>{"use strict";const i=s(8819),{AuthenticationError:r,ExchangeNotAvailable:a,AccountSuspended:n,PermissionDenied:o,RateLimitExceeded:c,InvalidNonce:d,InvalidAddress:h,ArgumentsRequired:u,ExchangeError:l,InvalidOrder:f,InsufficientFunds:p,BadRequest:m,OrderNotFound:b,BadSymbol:g,NotSupported:y}=s(3449),{ROUND:v,TICK_SIZE:w,TRUNCATE:k}=s(2115);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bitmart",name:"BitMart",countries:["US","CN","HK","KR"],rateLimit:1e3,version:"v1",has:{cancelAllOrders:!0,cancelOrder:!0,cancelOrders:!0,createOrder:!0,fetchBalance:!0,fetchCanceledOrders:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchOrderTrades:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchStatus:!0,fetchTrades:!0,fetchWithdrawals:!0,withdraw:!0},hostname:"bitmart.com",urls:{logo:"https://user-images.githubusercontent.com/1294454/61835713-a2662f80-ae85-11e9-9d00-6442919701fd.jpg",api:"https://api-cloud.{hostname}",www:"https://www.bitmart.com/",doc:"https://developer-pro.bitmart.com/",referral:"http://www.bitmart.com/?r=rQCFLh",fees:"https://www.bitmart.com/fee/en"},requiredCredentials:{apiKey:!0,secret:!0,uid:!0},api:{public:{system:{get:["time","service"]},account:{get:["currencies"]},spot:{get:["currencies","symbols","symbols/details","ticker","steps","symbols/kline","symbols/book","symbols/trades"]},contract:{get:["contracts","pnls","indexes","tickers","quote","indexquote","trades","depth","fundingrate"]}},private:{account:{get:["wallet","deposit/address","withdraw/charge","deposit-withdraw/history","deposit-withdraw/detail"],post:["withdraw/apply"]},spot:{get:["wallet","order_detail","orders","trades"],post:["submit_order","cancel_order","cancel_orders"]},contract:{get:["userOrders","userOrderInfo","userTrades","orderTrades","accounts","userPositions","userLiqRecords","positionFee"],post:["batchOrders","submitOrder","cancelOrders","marginOper"]}}},timeframes:{"1m":1,"3m":3,"5m":5,"15m":15,"30m":30,"45m":45,"1h":60,"2h":120,"3h":180,"4h":240,"1d":1440,"1w":10080,"1M":43200},fees:{trading:{tierBased:!0,percentage:!0,taker:.0025,maker:.0025,tiers:{taker:[[0,.002],[10,.0018],[50,.0016],[250,.14/100],[1e3,.0012],[5e3,.001],[25e3,8e-4],[5e4,6e-4]],maker:[[0,.001],[10,9e-4],[50,8e-4],[250,.07/100],[1e3,6e-4],[5e3,5e-4],[25e3,4e-4],[5e4,3e-4]]}}},precisionMode:w,exceptions:{exact:{3e4:l,30001:r,30002:r,30003:n,30004:r,30005:r,30006:r,30007:r,30008:r,30010:o,30011:r,30012:r,30013:c,30014:a,6e4:m,60001:m,60002:m,60003:l,60004:l,60005:l,60006:l,60007:h,60008:p,60009:l,60010:l,60011:h,60012:l,60020:o,60021:o,60022:o,60030:m,60031:m,60050:l,60051:l,5e4:m,50001:g,50002:m,50003:m,50004:m,50005:b,50006:f,50007:f,50008:f,50009:f,50010:f,50011:f,50012:f,50013:f,50014:m,50015:m,50016:m,50017:m,50018:m,50019:m,50020:p,50021:m,50022:a,50023:g,53e3:n,57001:m,58001:m,59001:l,59002:l,40001:l,40002:l,40003:l,40004:l,40005:l,40006:o,40007:m,40008:d,40009:m,40010:m,40011:m,40012:l,40013:l,40014:g,40015:g,40016:f,40017:f,40018:f,40019:l,40020:f,40021:l,40022:l,40023:l,40024:l,40025:l,40026:l,40027:p,40028:o,40029:f,40030:f,40031:f,40032:f,40033:f,40034:g},broad:{}},commonCurrencies:{COT:"Community Coin",CPC:"CPCoin",ONE:"Menlo One",PLA:"Plair"},options:{defaultType:"spot",fetchBalance:{type:"spot"},createMarketBuyOrderRequiresPrice:!0}})}async fetchTime(e={}){const t=await this.publicSystemGetTime(e),s=this.safeValue(t,"data",{});return this.safeInteger(s,"server_time")}async fetchStatus(e={}){const t=this.safeValue(this.options,"fetchBalance",{}),s=this.safeString(this.options,"defaultType");let i=this.safeString(t,"type",s);i=this.safeString(e,"type",i),e=this.omit(e,"type");const r=await this.publicSystemGetService(e),a=this.safeValue(r,"data",{}),n=this.safeValue(a,"service",[]),o=this.indexBy(n,"service_type");"swap"!==i&&"future"!==i||(i="contract");const c=this.safeValue(o,i);let d,h;if(void 0!==c){2===this.safeInteger(c,"status")?d="ok":(d="maintenance",h=this.safeInteger(c,"end_time"))}return this.status=this.extend(this.status,{status:d,updated:this.milliseconds(),eta:h}),this.status}async fetchSpotMarkets(e={}){const t=await this.publicSpotGetSymbolsDetails(e),s=this.safeValue(t,"data",{}),i=this.safeValue(s,"symbols",[]),r=[];for(let e=0;e<i.length;e++){const t=i[e],s=this.safeString(t,"symbol"),a=this.safeInteger(t,"symbol_id"),n=this.safeString(t,"base_currency"),o=this.safeString(t,"quote_currency"),c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o),h=c+"/"+d,u=this.safeInteger(t,"price_max_precision"),l={amount:this.safeNumber(t,"base_min_size"),price:parseFloat(this.decimalToPrecision(Math.pow(10,-u),v,10))},f=this.safeNumber(t,"min_buy_amount"),p=this.safeNumber(t,"min_sell_amount"),m=Math.max(f,p),b={amount:{min:this.safeNumber(t,"base_min_size"),max:this.safeNumber(t,"base_max_size")},price:{min:void 0,max:void 0},cost:{min:m,max:void 0}};r.push({id:s,numericId:a,symbol:h,base:c,quote:d,baseId:n,quoteId:o,type:"spot",spot:!0,future:!1,swap:!1,precision:l,limits:b,info:t,active:void 0})}return r}async fetchContractMarkets(e={}){const t=await this.publicContractGetContracts(e),s=this.safeValue(t,"data",{}),i=this.safeValue(s,"contracts",[]),r=[];for(let e=0;e<i.length;e++){const t=i[e],s=this.safeValue(t,"contract",{}),a=this.safeString(s,"contract_id"),n=this.safeInteger(s,"contract_id"),o=this.safeString(s,"base_coin"),c=this.safeString(s,"quote_coin"),d=this.safeCurrencyCode(o),h=this.safeCurrencyCode(c),u=this.safeString(s,"name"),l={amount:this.safeNumber(s,"vol_unit"),price:this.safeNumber(s,"price_unit")},f={amount:{min:this.safeNumber(s,"min_vol"),max:this.safeNumber(s,"max_vol")},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}},p=this.safeValue(s,"contract_type");let m=!1,b=!1,g="contract";1===p?(g="swap",b=!0):2===p&&(g="future",m=!0);const y=this.safeValue(t,"fee_config",{}),v=this.safeNumber(y,"maker_fee"),w=this.safeNumber(y,"taker_fee");r.push({id:a,numericId:n,symbol:u,base:d,quote:h,baseId:o,quoteId:c,maker:v,taker:w,type:g,spot:!1,future:m,swap:b,precision:l,limits:f,info:t,active:void 0})}return r}async fetchMarkets(e={}){const t=await this.fetchSpotMarkets(),s=await this.fetchContractMarkets();return this.arrayConcat(t,s)}parseTicker(e,t){const s=this.safeTimestamp(e,"timestamp",this.milliseconds()),i=this.safeString2(e,"symbol","contract_id"),r=this.safeSymbol(i,t,"_"),a=this.safeNumber2(e,"close_24h","last_price");let n=this.safeNumber(e,"fluctuation","rise_fall_rate");void 0!==n&&(n*=100);const o=this.safeNumber2(e,"base_volume_24h","base_coin_volume"),c=this.safeNumber2(e,"quote_volume_24h","quote_coin_volume"),d=this.vwap(o,c),h=this.safeNumber2(e,"open_24h","open");let u;void 0!==a&&void 0!==h&&(u=this.sum(a,h)/2),u=this.safeNumber(e,"avg_price",u);const l=this.safeValue(e,"depth_price",e);return{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber2(e,"high","high_24h"),low:this.safeNumber2(e,"low","low_24h"),bid:this.safeNumber(l,"best_bid","bid_price"),bidVolume:this.safeNumber(e,"best_bid_size"),ask:this.safeNumber(l,"best_ask","ask_price"),askVolume:this.safeNumber(e,"best_ask_size"),vwap:d,open:this.safeNumber(e,"open_24h"),close:a,last:a,previousClose:void 0,change:void 0,percentage:n,average:u,baseVolume:o,quoteVolume:c,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={};let r;s.swap||s.future?(r="publicContractGetTickers",i.contractID=s.id):s.spot&&(r="publicSpotGetTicker",i.symbol=s.id);const a=await this[r](this.extend(i,t)),n=this.safeValue(a,"data",{}),o=this.safeValue(n,"tickers",[]),c=this.indexBy(o,"symbol"),d=this.safeValue(c,s.id);return this.parseTicker(d,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s=this.safeString(this.options,"defaultType","spot"),i=this.safeString(t,"type",s);let r;t=this.omit(t,"type"),"swap"===i||"future"===i?r="publicContractGetTickers":"spot"===i&&(r="publicSpotGetTicker");const a=await this[r](t),n=this.safeValue(a,"data",{}),o=this.safeValue(n,"tickers",[]),c={};for(let e=0;e<o.length;e++){const t=this.parseTicker(o[e]);c[t.symbol]=t}return this.filterByArray(c,"symbol",e)}async fetchCurrencies(e={}){const t=await this.publicAccountGetCurrencies(e),s=this.safeValue(t,"data",{}),i=this.safeValue(s,"currencies",[]),r={};for(let e=0;e<i.length;e++){const t=i[e],s=this.safeString(t,"currency"),a=this.safeCurrencyCode(s),n=this.safeString(t,"name"),o=this.safeValue(t,"withdraw_enabled"),c=this.safeValue(t,"deposit_enabled"),d=o&&c;r[a]={id:s,code:a,name:n,info:t,active:d,fee:void 0,precision:void 0,limits:{amount:{min:void 0,max:void 0},withdraw:{min:void 0,max:void 0}}}}return r}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),r={};let a;i.spot?(a="publicSpotGetSymbolsBook",r.symbol=i.id):(i.swap||i.future)&&(a="publicContractGetDepth",r.contractID=i.id,void 0!==t&&(r.count=t));const n=await this[a](this.extend(r,s)),o=this.safeValue(n,"data",{});return i.spot?this.parseOrderBook(o,e,void 0,"buys","sells","price","amount"):i.swap||i.future?this.parseOrderBook(o,e,void 0,"buys","sells","price","vol"):void 0}parseTrade(e,t){const s=this.safeString2(e,"trade_id","detail_id");let i=this.safeInteger2(e,"order_time","create_time");void 0===i&&(i=this.parse8601(this.safeString(e,"created_at")));const r=this.safeInteger(e,"way");let a,n=this.safeStringLower2(e,"type","side");void 0===n&&void 0!==r&&(n=r<5?"buy":"sell");const o=this.safeString(e,"exec_type");void 0!==o&&(a="M"===o?"maker":"taker");let c=this.safeNumber2(e,"price","deal_price");c=this.safeNumber(e,"price_avg",c);let d=this.safeNumber2(e,"amount","deal_vol");d=this.safeNumber(e,"size",d);let h=this.safeNumber2(e,"count","notional");void 0===h&&void 0!==c&&void 0!==d&&(h=d*c);const u=this.safeInteger(e,"order_id"),l=this.safeString2(e,"contract_id","symbol"),f=this.safeSymbol(l,t,"_"),p=this.safeNumber(e,"fees");let m;if(void 0!==p){const s=this.safeString(e,"fee_coin_name");let i=this.safeCurrencyCode(s);void 0===i&&void 0!==t&&(i="buy"===n?t.base:t.quote),m={cost:p,currency:i}}return{info:e,id:s,order:u,timestamp:i,datetime:this.iso8601(i),symbol:f,type:undefined,side:n,price:c,amount:d,cost:h,takerOrMaker:a,fee:m}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id};let n;r.spot?(a.symbol=r.id,n="publicSpotGetSymbolsTrades"):(r.swap||r.future)&&(n="publicContractGetTrades",a.contractID=r.id);const o=await this[n](this.extend(a,i)),c=this.safeValue(o,"data",{}),d=this.safeValue(c,"trades",[]);return this.parseTrades(d,r,t,s)}parseOHLCV(e,t){return[this.safeTimestamp(e,"timestamp"),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n=a.type;let o;const c={},d=this.parseTimeframe(t);if("spot"===n){o="publicSpotGetSymbolsKline",c.symbol=a.id,c.step=this.timeframes[t];const e=500;if(void 0===i&&(i=e),i=Math.min(e,i),void 0===s){const e=parseInt(this.milliseconds()/1e3),t=e-i*d;c.from=t,c.to=e}else{const e=parseInt(s/1e3),t=this.sum(e,i*d);c.from=e,c.to=t}}else if("swap"===n||"future"===n){o="publicContractGetQuote",c.contractID=a.id;const e=500;if(void 0===i&&(i=e),void 0===s){const e=parseInt(this.milliseconds()/1e3),t=e-i*d;c.startTime=t,c.endTime=e}else{const e=parseInt(s/1e3),t=this.sum(e,i*d);c.startTime=e,c.endTime=t}c.unit=this.timeframes[t],c.resolution="M"}const h=await this[o](this.extend(c,r)),u=this.safeValue(h,"data",{});if(Array.isArray(u))return this.parseOHLCVs(u,a,t,s,i);{const e=this.safeValue(u,"klines",[]);return this.parseOHLCVs(e,a,t,s,i)}}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new u(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const r=this.market(e);let a;const n={};r.spot?(n.symbol=r.id,n.offset=1,void 0===s&&(s=100),n.limit=s,a="privateSpotGetTrades"):(r.swap||r.future)&&(n.contractID=r.id,void 0!==s&&(n.size=s),a="privateContractGetUserTrades");const o=await this[a](this.extend(n,i)),c=this.safeValue(o,"data",{}),d=this.safeValue(c,"trades",[]);return this.parseTrades(d,r,t,s)}async fetchOrderTrades(e,t,s,i,r={}){if(void 0===t)throw new u(this.id+" fetchOrderTrades() requires a symbol argument");await this.loadMarkets();const a=this.market(t);let n;const o={};a.spot?(o.symbol=a.id,o.order_id=e,n="privateSpotGetTrades"):(a.swap||a.future)&&(o.contractID=a.id,o.orderID=e,n="privateContractGetOrderTrades");const c=await this[n](this.extend(o,r)),d=this.safeValue(c,"data",{}),h=this.safeValue(d,"trades",[]);return this.parseTrades(h,a,s,i)}async fetchBalance(e={}){let t;await this.loadMarkets();const s=this.safeValue(this.options,"fetchBalance",{}),i=this.safeString(this.options,"defaultType","spot");let r=this.safeString(s,"type",i);r=this.safeString(e,"type",r),e=this.omit(e,"type"),"spot"===r?t="privateSpotGetWallet":"account"===r?t="privateAccountGetWallet":"swap"!==r&&"future"!==r&&"contract"!==r||(t="privateContractGetAccounts");const a=await this[t](e),n=this.safeValue(a,"data",{}),o=this.safeValue2(n,"wallet","accounts",[]),c={info:a};for(let e=0;e<o.length;e++){const t=o[e];let s=this.safeString2(t,"id","currency");s=this.safeString(t,"coin_code",s);const i=this.safeCurrencyCode(s),r=this.account();r.free=this.safeString2(t,"available","available_vol"),r.used=this.safeString2(t,"frozen","freeze_vol"),c[i]=r}return this.parseBalance(c,!1)}parseOrder(e,t){let s;"string"==typeof e&&(s=e,e={}),s=this.safeString(e,"order_id",s);let i=this.parse8601(this.safeString(e,"created_at"));i=this.safeInteger(e,"create_time",i);const r=this.safeString2(e,"symbol","contract_id"),a=this.safeSymbol(r,t,"_");let n;void 0!==t&&(n=this.parseOrderStatusByType(t.type,this.safeString(e,"status")));let o=this.safeNumber(e,"price"),c=this.safeNumber2(e,"price_avg","done_avg_price");const d=this.safeNumber2(e,"size","vol"),h=this.safeNumber2(e,"filled_size","done_vol");let u=this.safeString(e,"side");u=this.safeString(e,"way",u);const l=this.safeInteger(e,"category");let f=this.safeString(e,"type");return 1===l?f="limit":2===l&&(f="market"),"market"===f&&(0===o&&(o=void 0),0===c&&(c=void 0)),this.safeOrder({id:s,clientOrderId:void 0,info:e,timestamp:i,datetime:this.iso8601(i),lastTradeTimestamp:void 0,symbol:a,type:f,timeInForce:void 0,postOnly:void 0,side:u,price:o,stopPrice:void 0,amount:d,cost:void 0,average:c,filled:h,remaining:void 0,status:n,fee:void 0,trades:void 0})}parseOrderStatusByType(e,t){const s=this.safeValue({spot:{1:"failed",2:"open",3:"failed",4:"open",5:"open",6:"closed",7:"canceling",8:"canceled"},swap:{1:"open",2:"open",4:"closed"}},e,{});return this.safeString(s,t,t)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o={};let c;if(n.spot){if(o.symbol=n.id,o.side=s,o.type=t,c="privateSpotPostSubmitOrder","limit"===t)o.size=this.amountToPrecision(e,i),o.price=this.priceToPrecision(e,r);else if("market"===t)if("buy"===s){let e=this.safeNumber(a,"notional");if(this.safeValue(this.options,"createMarketBuyOrderRequiresPrice",!0)){if(void 0!==r)void 0===e&&(e=i*r);else if(void 0===e)throw new f(this.id+" createOrder() requires the price argument with market buy orders to calculate total order cost (amount to spend), where cost = amount * price. Supply a price argument to createOrder() call if you want the cost to be calculated for you from price and amount, or, alternatively, add .options['createMarketBuyOrderRequiresPrice'] = false and supply the total cost value in the 'amount' argument or in the 'notional' extra parameter (the exchange-specific behaviour)")}else e=void 0===e?i:e;const t=n.precision.price;o.notional=this.decimalToPrecision(e,k,t,this.precisionMode)}else"sell"===s&&(o.size=this.amountToPrecision(e,i))}else(n.swap||n.future)&&(c="privateContractPostSubmitOrder",o.contractID=n.id,"limit"===t?o.category=1:"market"===t&&(o.category=2),o.way=s,o.custom_id=this.nonce(),o.open_type=1,o.leverage=1,o.price=this.priceToPrecision(e,r),o.vol=this.amountToPrecision(e,i));const d=await this[c](this.extend(o,a)),h=this.safeValue(d,"data",{});return this.parseOrder(h,n)}async cancelOrder(e,t,s={}){if(void 0===t)throw new u(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={};let a;i.spot?(a="privateSpotPostCancelOrder",r.order_id=parseInt(e),r.symbol=i.id):(i.swap||i.future)&&(a="privateContractPostCancelOrders",r.contractID=i.id,r.orders=[parseInt(e)]);const n=await this[a](this.extend(r,s)),o=this.safeValue(n,"data");if(!0===o)return this.parseOrder(e,i);const c=this.safeValue(o,"succeed");if(void 0!==c){if(void 0===(e=this.safeString(c,0)))throw new f(this.id+" cancelOrder() failed to cancel "+t+" order id "+e)}else{if(!this.safeValue(o,"result"))throw new f(this.id+" cancelOrder() "+t+" order id "+e+" is filled or canceled")}const d=this.parseOrder(e,i);return this.extend(d,{id:e})}async cancelAllOrders(e,t={}){if(void 0===e)throw new u(this.id+" cancelAllOrders() requires a symbol argument");const s=this.safeString(t,"side");if(void 0===s)throw new u(this.id+" cancelAllOrders() requires a `side` parameter ('buy' or 'sell')");await this.loadMarkets();const i=this.market(e);if(!i.spot)throw new y(this.id+" cancelAllOrders() does not support "+i.type+" orders, only spot orders are accepted");const r={symbol:i.id,side:s};return await this.privateSpotPostCancelOrders(this.extend(r,t))}async cancelOrders(e,t,s={}){if(void 0===t)throw new u(this.id+" canelOrders() requires a symbol argument");await this.loadMarkets();const i=this.market(t);if(!i.spot)throw new y(this.id+" cancelOrders() does not support "+i.type+" orders, only contract orders are accepted");const r=[];for(let t=0;t<e.length;t++)r.push(parseInt(e[t]));const a={orders:r};return await this.privateContractPostCancelOrders(this.extend(a,s))}async fetchOrdersByStatus(e,t,s,i,r={}){if(void 0===t)throw new u(this.id+" fetchOrdersByStatus() requires a symbol argument");await this.loadMarkets();const a=this.market(t),n={};let o;a.spot?(o="privateSpotGetOrders",n.symbol=a.id,n.offset=1,n.limit=100,n.status="open"===e?9:"closed"===e?6:e):(a.swap||a.future)&&(o="privateContractGetUserOrders",n.contractID=a.id,void 0!==i&&(n.size=i),n.status="open"===e?3:"closed"===e?4:e);const c=await this[o](this.extend(n,r)),d=this.safeValue(c,"data",{}),h=this.safeValue(d,"orders",[]);return this.parseOrders(h,a,s,i)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrdersByStatus("open",e,t,s,i)}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrdersByStatus("closed",e,t,s,i)}async fetchOrders(e,t,s,i={}){if(void 0===e)throw new u(this.id+" fetchOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e);if(!r.swap&&!r.future)throw new y(this.id+" fetchOrders does not support "+r.type+" markets, only contracts are supported");return await this.fetchOrdersByStatus(0,e,t,s,i)}async fetchOrder(e,t,s={}){if(void 0===t)throw new u(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const i={},r=this.market(t);let a;"string"!=typeof e&&(e=e.toString()),r.spot?(i.symbol=r.id,i.order_id=e,a="privateSpotGetOrderDetail"):(r.swap||r.future)&&(i.contractID=r.id,i.orderID=e,a="privateContractGetUserOrderInfo");const n=await this[a](this.extend(i,s)),o=this.safeValue(n,"data");if("orders"in o){const s=this.safeValue(o,"orders",[]),i=this.safeValue(s,0);if(void 0===i)throw new b(this.id+" fetchOrder() could not find "+t+" order id "+e);return this.parseOrder(i,r)}return this.parseOrder(o,r)}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={currency:this.currency(e).id},i=await this.privateAccountGetDepositAddress(this.extend(s,t)),r=this.safeValue(i,"data",{}),a=this.safeString(r,"address"),n=this.safeString(r,"address_memo");return this.checkAddress(a),{currency:e,address:a,tag:n,info:i}}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a=this.currency(e),n={currency:a.id,amount:t,destination:"To Digital Address",address:s};void 0!==i&&(n.address_memo=i);const o=await this.privateAccountPostWithdrawApply(this.extend(n,r)),c=this.safeValue(o,"data"),d=this.parseTransaction(c,a);return this.extend(d,{code:e,address:s,tag:i})}async fetchTransactionsByType(e,t,s,i,r={}){await this.loadMarkets(),void 0===i&&(i=50);const a={operation_type:e,offset:1,limit:i};let n;void 0!==t&&(n=this.currenc(t),a.currency=n.id);const o=await this.privateAccountGetDepositWithdrawHistory(this.extend(a,r)),c=this.safeValue(o,"data",{}),d=this.safeValue(c,"records",[]);return this.parseTransactions(d,n,s,i)}async fetchDeposits(e,t,s,i={}){return await this.fetchTransactionsByType("deposit",e,t,s,i)}async fetchWithdrawals(e,t,s,i={}){return await this.fetchTransactionsByType("withdraw",e,t,s,i)}parseTransactionStatus(e){return this.safeString({0:"pending",1:"pending",2:"pending",3:"ok",4:"canceled",5:"failed"},e,e)}parseTransaction(e,t){let s;const i=this.safeString(e,"withdraw_id"),r=this.safeString(e,"deposit_id");let a;void 0!==i&&""!==i?(a="withdraw",s=i):void 0!==r&&""!==r&&(a="deposit",s=r);const n=this.safeNumber(e,"arrival_amount"),o=this.safeInteger(e,"tapply_timeime"),c=this.safeString(e,"currency"),d=this.safeCurrencyCode(c,t),h=this.parseTransactionStatus(this.safeString(e,"status")),u=this.safeNumber(e,"fee");let l;void 0!==u&&(l={cost:u,currency:d});let f=this.safeString(e,"tx_id");""===f&&(f=void 0);return{info:e,id:s,currency:d,amount:n,address:this.safeString(e,"address"),addressFrom:void 0,addressTo:void 0,tag:this.safeString(e,"address_memo"),tagFrom:void 0,tagTo:void 0,status:h,type:a,updated:void 0,txid:f,timestamp:o,datetime:this.iso8601(o),fee:l}}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){const n=this.implodeParams(this.urls.api,{hostname:this.hostname}),o=this.safeString(t,0),c=this.safeString(t,1);let d=n+"/"+c;"system"!==c&&(d+="/"+this.version),"contract"===c&&(d+="/ifcontract"),d+="/"+this.implodeParams(e,i);const h=this.omit(i,this.extractParams(e));if("system"===c)Object.keys(h).length&&(d+="?"+this.urlencode(h));else if("public"===o)Object.keys(h).length&&(d+="?"+this.urlencode(h));else if("private"===o){this.checkRequiredCredentials();const e=this.milliseconds().toString();let t="";r={"X-BM-KEY":this.apiKey,"X-BM-TIMESTAMP":e},"POST"===s||"PUT"===s?(r["Content-Type"]="application/json",t=a=this.json(h)):Object.keys(h).length&&(t=this.urlencode(h),d+="?"+t);const i=e+"#"+this.uid+"#"+t,n=this.hmac(this.encode(i),this.encode(this.secret));r["X-BM-SIGN"]=n}return{url:d,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,a,n,o,c){if(void 0===n)return;const d=this.safeString(n,"message"),h=this.safeString(n,"code");if(void 0!==h&&"1000"!==h||void 0!==d&&"OK"!==d){const e=this.id+" "+a;throw this.throwExactlyMatchedException(this.exceptions.exact,h,e),this.throwBroadlyMatchedException(this.exceptions.broad,h,e),this.throwExactlyMatchedException(this.exceptions.exact,d,e),this.throwBroadlyMatchedException(this.exceptions.broad,d,e),new l(e)}}}},7763:(e,t,s)=>{"use strict";const i=s(8819),{TICK_SIZE:r}=s(2115),{AuthenticationError:a,BadRequest:n,DDoSProtection:o,ExchangeError:c,ExchangeNotAvailable:d,InsufficientFunds:h,InvalidOrder:u,OrderNotFound:l,PermissionDenied:f,ArgumentsRequired:p}=s(3449),m=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bitmex",name:"BitMEX",countries:["SC"],version:"v1",userAgent:void 0,rateLimit:2e3,pro:!0,has:{cancelAllOrders:!0,cancelOrder:!0,CORS:!1,createOrder:!0,editOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchLedger:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTransactions:"emulated",withdraw:!0},timeframes:{"1m":"1m","5m":"5m","1h":"1h","1d":"1d"},urls:{test:{public:"https://testnet.bitmex.com",private:"https://testnet.bitmex.com"},logo:"https://user-images.githubusercontent.com/1294454/27766319-f653c6e6-5ed4-11e7-933d-f0bc3699ae8f.jpg",api:{public:"https://www.bitmex.com",private:"https://www.bitmex.com"},www:"https://www.bitmex.com",doc:["https://www.bitmex.com/app/apiOverview","https://github.com/BitMEX/api-connectors/tree/master/official-http"],fees:"https://www.bitmex.com/app/fees",referral:"https://www.bitmex.com/register/upZpOX"},api:{public:{get:["announcement","announcement/urgent","funding","instrument","instrument/active","instrument/activeAndIndices","instrument/activeIntervals","instrument/compositeIndex","instrument/indices","insurance","leaderboard","liquidation","orderBook","orderBook/L2","quote","quote/bucketed","schema","schema/websocketHelp","settlement","stats","stats/history","trade","trade/bucketed"]},private:{get:["apiKey","chat","chat/channels","chat/connected","execution","execution/tradeHistory","notification","order","position","user","user/affiliateStatus","user/checkReferralCode","user/commission","user/depositAddress","user/executionHistory","user/margin","user/minWithdrawalFee","user/wallet","user/walletHistory","user/walletSummary"],post:["apiKey","apiKey/disable","apiKey/enable","chat","order","order/bulk","order/cancelAllAfter","order/closePosition","position/isolate","position/leverage","position/riskLimit","position/transferMargin","user/cancelWithdrawal","user/confirmEmail","user/confirmEnableTFA","user/confirmWithdrawal","user/disableTFA","user/logout","user/logoutAll","user/preferences","user/requestEnableTFA","user/requestWithdrawal"],put:["order","order/bulk","user"],delete:["apiKey","order","order/all"]}},exceptions:{exact:{"Invalid API Key.":a,"This key is disabled.":f,"Access Denied":f,"Duplicate clOrdID":u,"orderQty is invalid":u,"Invalid price":u,"Invalid stopPx for ordType":u},broad:{"Signature not valid":a,overloaded:d,"Account has insufficient Available Balance":h,"Service unavailable":d,"Server Error":c,"Unable to cancel order due to existing state":u}},precisionMode:r,options:{"api-expires":5,fetchOHLCVOpenTimestamp:!0}})}async fetchMarkets(e={}){const t=await this.publicGetInstrumentActiveAndIndices(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r="Unlisted"!==i.state,a=i.symbol,n=i.underlying,o=i.quoteCurrency,c=n+o,d=this.safeCurrencyCode(n),h=this.safeCurrencyCode(o),u=a===c,l=this.safeString2(i,"positionCurrency","quoteCurrency");let f,p=!1,m=!1;const b=this.safeCurrencyCode(l);let g=a;u?(f="swap",g=d+"/"+h):a.indexOf("B_")>=0?(m=!0,f="prediction"):(p=!0,f="future");const y={amount:void 0,price:void 0},v=this.safeNumber(i,"lotSize"),w=this.safeNumber(i,"tickSize");void 0!==v&&(y.amount=v),void 0!==w&&(y.price=w);const k={amount:{min:void 0,max:void 0},price:{min:w,max:this.safeNumber(i,"maxPrice")},cost:{min:void 0,max:void 0}};k[b===h?"cost":"amount"]={min:v,max:this.safeNumber(i,"maxOrderQty")},s.push({id:a,symbol:g,base:d,quote:h,baseId:n,quoteId:o,active:r,precision:y,limits:k,taker:this.safeNumber(i,"takerFee"),maker:this.safeNumber(i,"makerFee"),type:f,spot:!1,swap:u,future:p,prediction:m,info:i})}return s}parseBalanceResponse(e){const t={info:e};for(let s=0;s<e.length;s++){const i=e[s],r=this.safeString(i,"currency"),a=this.safeCurrencyCode(r),n=this.account();let o=this.safeString(i,"availableMargin"),c=this.safeString(i,"marginBalance");"BTC"===a&&(o=m.stringDiv(o,"1e8"),c=m.stringDiv(c,"1e8")),n.free=o,n.total=c,t[a]=n}return this.parseBalance(t,!1)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetUserMargin(this.extend({currency:"all"},e));return this.parseBalanceResponse(t)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.market(e).id};void 0!==t&&(i.depth=t);const r=await this.publicGetOrderBookL2(this.extend(i,s)),a={symbol:e,bids:[],asks:[],timestamp:void 0,datetime:void 0,nonce:void 0};for(let e=0;e<r.length;e++){const t=r[e],s="Sell"===t.side?"asks":"bids",i=this.safeNumber(t,"size"),n=this.safeNumber(t,"price");void 0!==n&&a[s].push([n,i])}return a.bids=this.sortBy(a.bids,0,!0),a.asks=this.sortBy(a.asks,0),a}async fetchOrder(e,t,s={}){const i={filter:{orderID:e}},r=await this.fetchOrders(t,void 0,void 0,this.deepExtend(i,s));if(1===r.length)return r[0];throw new l(this.id+": The order "+e+" not found.")}async fetchOrders(e,t,s,i={}){let r;await this.loadMarkets();let a={};void 0!==e&&(r=this.market(e),a.symbol=r.id),void 0!==t&&(a.startTime=this.iso8601(t)),void 0!==s&&(a.count=s),a=this.deepExtend(a,i),"filter"in a&&(a.filter=this.json(a.filter));const n=await this.privateGetOrder(a);return this.parseOrders(n,r,t,s)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.deepExtend({filter:{open:!0}},i))}async fetchClosedOrders(e,t,s,i={}){const r=await this.fetchOrders(e,t,s,i);return this.filterBy(r,"status","closed")}async fetchMyTrades(e,t,s,i={}){let r;await this.loadMarkets();let a={};void 0!==e&&(r=this.market(e),a.symbol=r.id),void 0!==t&&(a.startTime=this.iso8601(t)),void 0!==s&&(a.count=s),a=this.deepExtend(a,i),"filter"in a&&(a.filter=this.json(a.filter));const n=await this.privateGetExecutionTradeHistory(a);return this.parseTrades(n,r,t,s)}parseLedgerEntryType(e){return this.safeString({Withdrawal:"transaction",RealisedPNL:"margin",UnrealisedPNL:"margin",Deposit:"transaction",Transfer:"transfer",AffiliatePayout:"referral"},e,e)}parseLedgerEntry(e,t){const s=this.safeString(e,"transactID"),i=this.safeString(e,"account"),r=this.safeString(e,"tx"),a=this.parseLedgerEntryType(this.safeString(e,"transactType")),n=this.safeString(e,"currency"),o=this.safeCurrencyCode(n,t);let c=this.safeNumber(e,"amount");void 0!==c&&(c/=1e8);let d=this.parse8601(this.safeString(e,"transactTime"));void 0===d&&(d=0);let h=this.safeNumber(e,"fee",0);void 0!==h&&(h/=1e8);const u={cost:h,currency:o};let l=this.safeNumber(e,"walletBalance");void 0!==l&&(l/=1e8);const f=this.sum(l,-c);let p;c<0?(p="out",c=Math.abs(c)):p="in";const m=this.parseTransactionStatus(this.safeString(e,"transactStatus"));return{id:s,info:e,timestamp:d,datetime:this.iso8601(d),direction:p,account:i,referenceId:r,referenceAccount:undefined,type:a,currency:o,amount:c,before:f,after:l,status:m,fee:u}}async fetchLedger(e,t,s,i={}){let r;await this.loadMarkets(),void 0!==e&&(r=this.currency(e));const a={};void 0!==s&&(a.count=s);const n=await this.privateGetUserWalletHistory(this.extend(a,i));return this.parseLedger(n,r,t,s)}async fetchTransactions(e,t,s,i={}){await this.loadMarkets();const r={};void 0!==s&&(r.count=s);const a=await this.privateGetUserWalletHistory(this.extend(r,i)),n=this.filterByArray(a,"transactType",["Withdrawal","Deposit"],!1);let o;return void 0!==e&&(o=this.currency(e)),this.parseTransactions(n,o,t,s)}parseTransactionStatus(e){return this.safeString({Canceled:"canceled",Completed:"ok",Pending:"pending"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"transactID"),i=this.parse8601(this.safeString(e,"transactTime")),r=this.parse8601(this.safeString(e,"timestamp")),a=this.safeStringLower(e,"transactType");let n,o,c;"withdrawal"===a&&(n=this.safeString(e,"address"),o=this.safeString(e,"tx"),c=n);let d=this.safeInteger(e,"amount");void 0!==d&&(d=Math.abs(d)/1e7);let h=this.safeInteger(e,"fee");void 0!==h&&(h/=1e7);const u={cost:h,currency:"BTC"};let l=this.safeString(e,"transactStatus");return void 0!==l&&(l=this.parseTransactionStatus(l)),{info:e,id:s,txid:void 0,timestamp:i,datetime:this.iso8601(i),addressFrom:o,address:n,addressTo:c,tagFrom:void 0,tag:void 0,tagTo:void 0,type:a,amount:d,currency:"BTC",status:l,updated:r,comment:void 0,fee:u}}async fetchTicker(e,t={}){await this.loadMarkets();if(!this.market(e).active)throw new c(this.id+": symbol "+e+" is delisted");const s=await this.fetchTickers([e],t),i=this.safeValue(s,e);if(void 0===i)throw new c(this.id+" ticker symbol "+e+" not found");return i}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetInstrumentActiveAndIndices(t),i={};for(let e=0;e<s.length;e++){const t=this.parseTicker(s[e]),r=this.safeString(t,"symbol");void 0!==r&&(i[r]=t)}return this.filterByArray(i,"symbol",e)}parseTicker(e,t){let s;const i=this.safeString(e,"symbol");void 0!==(t=this.safeValue(this.markets_by_id,i,t))&&(s=t.symbol);const r=this.parse8601(this.safeString(e,"timestamp")),a=this.safeNumber(e,"prevPrice24h"),n=this.safeNumber(e,"lastPrice");let o,c;return void 0!==n&&void 0!==a&&(o=n-a,a>0&&(c=o/a*100)),{symbol:s,timestamp:r,datetime:this.iso8601(r),high:this.safeNumber(e,"highPrice"),low:this.safeNumber(e,"lowPrice"),bid:this.safeNumber(e,"bidPrice"),bidVolume:void 0,ask:this.safeNumber(e,"askPrice"),askVolume:void 0,vwap:this.safeNumber(e,"vwap"),open:a,close:n,last:n,previousClose:void 0,change:o,percentage:c,average:this.sum(a,n)/2,baseVolume:this.safeNumber(e,"homeNotional24h"),quoteVolume:this.safeNumber(e,"foreignNotional24h"),info:e}}parseOHLCV(e,t){return[this.parse8601(this.safeString(e,"timestamp")),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={symbol:a.id,binSize:this.timeframes[t],partial:!0};void 0!==i&&(n.count=i);const o=1e3*this.parseTimeframe(t),c=this.safeValue(this.options,"fetchOHLCVOpenTimestamp",!0);if(void 0!==s){let e=s;c&&(e=this.sum(e,o));const t=this.ymdhms(e);n.startTime=t}else n.reverse=!0;const d=await this.publicGetTradeBucketed(this.extend(n,r)),h=this.parseOHLCVs(d,a,t,s,i);if(c)for(let e=0;e<h.length;e++)h[e][0]=h[e][0]-o;return h}parseTrade(e,t){const s=this.parse8601(this.safeString(e,"timestamp")),i=this.safeNumber2(e,"avgPx","price"),r=this.safeNumber2(e,"size","lastQty"),a=this.safeString(e,"trdMatchID"),n=this.safeString(e,"orderID"),o=this.safeStringLower(e,"side");let c,d,h=this.safeNumber(e,"execCost");if(void 0!==h&&(h=Math.abs(h)/1e8),"execComm"in e){let t=this.safeNumber(e,"execComm");t/=1e8;const s=this.safeString(e,"settlCurrency");c={cost:t,currency:this.safeCurrencyCode(s),rate:this.safeNumber(e,"commission")}}void 0!==c&&(d=c.cost<0?"maker":"taker");const u=this.safeString(e,"symbol"),l=this.safeSymbol(u,t),f=this.safeStringLower(e,"ordType");return{info:e,timestamp:s,datetime:this.iso8601(s),symbol:l,id:a,order:n,type:f,takerOrMaker:d,side:o,price:i,cost:h,amount:r,fee:c}}parseOrderStatus(e){return this.safeString({New:"open",PartiallyFilled:"open",Filled:"closed",DoneForDay:"open",Canceled:"canceled",PendingCancel:"open",PendingNew:"open",Rejected:"rejected",Expired:"expired",Stopped:"open",Untriggered:"open",Triggered:"open"},e,e)}parseTimeInForce(e){return this.safeString({Day:"Day",GoodTillCancel:"GTC",ImmediateOrCancel:"IOC",FillOrKill:"FOK"},e,e)}parseOrder(e,t){const s=this.parseOrderStatus(this.safeString(e,"ordStatus")),i=this.safeString(e,"symbol"),r=this.safeSymbol(i,t),a=this.parse8601(this.safeString(e,"timestamp")),n=this.parse8601(this.safeString(e,"transactTime")),o=this.safeNumber(e,"price"),c=this.safeNumber(e,"orderQty"),d=this.safeNumber(e,"cumQty",0),h=this.safeNumber(e,"avgPx"),u=this.safeString(e,"orderID"),l=this.safeStringLower(e,"ordType"),f=this.safeStringLower(e,"side"),p=this.safeString(e,"clOrdID"),m=this.parseTimeInForce(this.safeString(e,"timeInForce")),b=this.safeNumber(e,"stopPx"),g="ParticipateDoNotInitiate"===this.safeString(e,"execInst");return this.safeOrder({info:e,id:u,clientOrderId:p,timestamp:a,datetime:this.iso8601(a),lastTradeTimestamp:n,symbol:r,type:l,timeInForce:m,postOnly:g,side:f,price:o,stopPrice:b,amount:c,cost:void 0,average:h,filled:d,remaining:void 0,status:s,fee:void 0,trades:void 0})}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id};void 0!==t?a.startTime=this.iso8601(t):a.reverse=!0,void 0!==s&&(a.count=s);const n=await this.publicGetTrade(this.extend(a,i));return this.parseTrades(n,r,t,s)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o=this.capitalize(t),c={symbol:n.id,side:this.capitalize(s),orderQty:parseFloat(this.amountToPrecision(e,i)),ordType:o};if("Stop"===o||"StopLimit"===o||"MarketIfTouched"===o||"LimitIfTouched"===o){const t=this.safeNumber2(a,"stopPx","stopPrice");if(void 0===t)throw new p(this.id+" createOrder() requires a stopPx or stopPrice parameter for the "+o+" order type");c.stopPx=parseFloat(this.priceToPrecision(e,t)),a=this.omit(a,["stopPx","stopPrice"])}"Limit"!==o&&"StopLimit"!==o&&"LimitIfTouched"!==o||(c.price=parseFloat(this.priceToPrecision(e,r)));const d=this.safeString2(a,"clOrdID","clientOrderId");void 0!==d&&(c.clOrdID=d,a=this.omit(a,["clOrdID","clientOrderId"]));const h=await this.privatePostOrder(this.extend(c,a));return this.parseOrder(h,n)}async editOrder(e,t,s,i,r,a,n={}){await this.loadMarkets();const o={},c=this.safeString2(n,"origClOrdID","clientOrderId");if(void 0!==c){o.origClOrdID=c;const e=this.safeString(n,"clOrdID","clientOrderId");void 0!==e&&(o.clOrdID=e),n=this.omit(n,["origClOrdID","clOrdID","clientOrderId"])}else o.orderID=e;void 0!==r&&(o.orderQty=r),void 0!==a&&(o.price=a);const d=await this.privatePutOrder(this.extend(o,n));return this.parseOrder(d)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i=this.safeString2(s,"clOrdID","clientOrderId"),r={};void 0===i?r.orderID=e:(r.clOrdID=i,s=this.omit(s,["clOrdID","clientOrderId"]));const a=await this.privateDeleteOrder(this.extend(r,s)),n=this.safeValue(a,0,{}),o=this.safeString(n,"error");if(void 0!==o&&o.indexOf("Unable to cancel order due to existing state")>=0)throw new l(this.id+" cancelOrder() failed: "+o);return this.parseOrder(n)}async cancelAllOrders(e,t={}){await this.loadMarkets();const s={};let i;void 0!==e&&(i=this.market(e),s.symbol=i.id);const r=await this.privateDeleteOrderAll(this.extend(s,t));return this.parseOrders(r,i)}async fetchPositions(e,t={}){await this.loadMarkets();return await this.privateGetPosition(t)}isFiat(e){return"EUR"===e||"PLN"===e}async withdraw(e,t,s,i,r={}){if(this.checkAddress(s),await this.loadMarkets(),"BTC"!==e)throw new c(this.id+" supoprts BTC withdrawals only, other currencies coming soon...");const a={currency:"XBt",amount:t,address:s},n=await this.privatePostUserRequestWithdrawal(this.extend(a,r));return{info:n,id:this.safeString(n,"transactID")}}handleErrors(e,t,s,i,r,a,d,h,u){if(void 0!==d){if(429===e)throw new o(this.id+" "+a);if(e>=400){const t=this.safeValue(d,"error",{}),s=this.safeString(t,"message"),i=this.id+" "+a;if(this.throwExactlyMatchedException(this.exceptions.exact,s,i),this.throwBroadlyMatchedException(this.exceptions.broad,s,i),400===e)throw new n(i);throw new c(i)}}}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n="/api/"+this.version+"/"+e;if("GET"===s)Object.keys(i).length&&(n+="?"+this.urlencode(i));else{const e=this.safeString(i,"_format");void 0!==e&&(n+="?"+this.urlencode({_format:e}),i=this.omit(i,"_format"))}const o=this.urls.api[t]+n;if(this.apiKey&&this.secret){let e=s+n,t=this.safeInteger(this.options,"api-expires");r={"Content-Type":"application/json","api-key":this.apiKey},t=this.sum(this.seconds(),t),t=t.toString(),e+=t,r["api-expires"]=t,"POST"!==s&&"PUT"!==s&&"DELETE"!==s||Object.keys(i).length&&(e+=a=this.json(i)),r["api-signature"]=this.hmac(this.encode(e),this.encode(this.secret))}return{url:o,method:s,body:a,headers:r}}}},3223:(e,t,s)=>{"use strict";const i=s(8819),{AuthenticationError:r,ExchangeError:a,PermissionDenied:n,BadRequest:o,ArgumentsRequired:c,OrderNotFound:d,InsufficientFunds:h,ExchangeNotAvailable:u,DDoSProtection:l,InvalidAddress:f,InvalidOrder:p}=s(3449);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bitpanda",name:"Bitpanda Pro",countries:["AT"],rateLimit:300,version:"v1",has:{CORS:!1,publicAPI:!0,privateAPI:!0,cancelAllOrders:!0,cancelOrder:!0,cancelOrders:!0,createDepositAddress:!0,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchDeposits:!0,fetchDepositAddress:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrderTrades:!0,fetchTime:!0,fetchTrades:!0,fetchTradingFees:!0,fetchTicker:!0,fetchTickers:!0,fetchWithdrawals:!0,withdraw:!0},timeframes:{"1m":"1/MINUTES","5m":"5/MINUTES","15m":"15/MINUTES","30m":"30/MINUTES","1h":"1/HOURS","4h":"4/HOURS","1d":"1/DAYS","1w":"1/WEEKS","1M":"1/MONTHS"},urls:{logo:"https://user-images.githubusercontent.com/51840849/87591171-9a377d80-c6f0-11ea-94ac-97a126eac3bc.jpg",api:{public:"https://api.exchange.bitpanda.com/public",private:"https://api.exchange.bitpanda.com/public"},www:"https://www.bitpanda.com/en/pro",doc:["https://developers.bitpanda.com/exchange/"],fees:"https://www.bitpanda.com/en/pro/fees"},api:{public:{get:["currencies","candlesticks/{instrument_code}","fees","instruments","order-book/{instrument_code}","market-ticker","market-ticker/{instrument_code}","price-ticks/{instrument_code}","time"]},private:{get:["account/balances","account/deposit/crypto/{currency_code}","account/deposit/fiat/EUR","account/deposits","account/deposits/bitpanda","account/withdrawals","account/withdrawals/bitpanda","account/fees","account/orders","account/orders/{order_id}","account/orders/{order_id}/trades","account/trades","account/trades/{trade_id}","account/trading-volume"],post:["account/deposit/crypto","account/withdraw/crypto","account/withdraw/fiat","account/fees","account/orders"],delete:["account/orders","account/orders/{order_id}","account/orders/client/{client_id}"]}},fees:{trading:{tierBased:!0,percentage:!0,taker:.0015,maker:.001,tiers:[{taker:[[0,.0015],[100,.0013],[250,.0013],[1e3,.001],[5e3,9e-4],[1e4,75e-5],[2e4,65e-5]],maker:[[0,.001],[100,.001],[250,9e-4],[1e3,75e-5],[5e3,6e-4],[1e4,5e-4],[2e4,5e-4]]}]}},requiredCredentials:{apiKey:!0,secret:!1},exceptions:{exact:{INVALID_CLIENT_UUID:p,ORDER_NOT_FOUND:d,ONLY_ONE_ERC20_ADDRESS_ALLOWED:f,DEPOSIT_ADDRESS_NOT_USED:f,INVALID_CREDENTIALS:r,MISSING_CREDENTIALS:r,INVALID_APIKEY:r,INVALID_SCOPES:r,INVALID_SUBJECT:r,INVALID_ISSUER:r,INVALID_AUDIENCE:r,INVALID_DEVICE_ID:r,INVALID_IP_RESTRICTION:r,APIKEY_REVOKED:r,APIKEY_EXPIRED:r,SYNCHRONIZER_TOKEN_MISMATCH:r,SESSION_EXPIRED:r,INTERNAL_ERROR:r,CLIENT_IP_BLOCKED:n,MISSING_PERMISSION:n,ILLEGAL_CHARS:o,UNSUPPORTED_MEDIA_TYPE:o,ACCOUNT_HISTORY_TIME_RANGE_TOO_BIG:o,CANDLESTICKS_TIME_RANGE_TOO_BIG:o,INVALID_INSTRUMENT_CODE:o,INVALID_ORDER_TYPE:o,INVALID_UNIT:o,INVALID_PERIOD:o,INVALID_TIME:o,INVALID_DATE:o,INVALID_CURRENCY:o,INVALID_AMOUNT:o,INVALID_PRICE:o,INVALID_LIMIT:o,INVALID_QUERY:o,INVALID_CURSOR:o,INVALID_ACCOUNT_ID:o,INVALID_SIDE:p,INVALID_ACCOUNT_HISTORY_FROM_TIME:o,INVALID_ACCOUNT_HISTORY_MAX_PAGE_SIZE:o,INVALID_ACCOUNT_HISTORY_TIME_PERIOD:o,INVALID_ACCOUNT_HISTORY_TO_TIME:o,INVALID_CANDLESTICKS_GRANULARITY:o,INVALID_CANDLESTICKS_UNIT:o,INVALID_ORDER_BOOK_DEPTH:o,INVALID_ORDER_BOOK_LEVEL:o,INVALID_PAGE_CURSOR:o,INVALID_TIME_RANGE:o,INVALID_TRADE_ID:o,INVALID_UI_ACCOUNT_SETTINGS:o,NEGATIVE_AMOUNT:p,NEGATIVE_PRICE:p,MIN_SIZE_NOT_SATISFIED:p,BAD_AMOUNT_PRECISION:p,BAD_PRICE_PRECISION:p,BAD_TRIGGER_PRICE_PRECISION:p,MAX_OPEN_ORDERS_EXCEEDED:o,MISSING_PRICE:p,MISSING_ORDER_TYPE:p,MISSING_SIDE:p,MISSING_CANDLESTICKS_PERIOD_PARAM:c,MISSING_CANDLESTICKS_UNIT_PARAM:c,MISSING_FROM_PARAM:c,MISSING_INSTRUMENT_CODE:c,MISSING_ORDER_ID:p,MISSING_TO_PARAM:c,MISSING_TRADE_ID:c,INVALID_ORDER_ID:d,NOT_FOUND:d,INSUFFICIENT_LIQUIDITY:h,INSUFFICIENT_FUNDS:h,NO_TRADING:u,SERVICE_UNAVAILABLE:u,GATEWAY_TIMEOUT:u,RATELIMIT:l,CF_RATELIMIT:l,INTERNAL_SERVER_ERROR:a},broad:{}},commonCurrencies:{MIOTA:"IOTA"},options:{fetchTradingFees:{method:"fetchPrivateTradingFees"},fiat:["EUR","CHF"]}})}async fetchTime(e={}){const t=await this.publicGetTime(e);return this.safeInteger(t,"epoch_millis")}async fetchCurrencies(e={}){const t=await this.publicGetCurrencies(e),s={};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"code"),a=this.safeCurrencyCode(r);s[a]={id:r,code:a,name:void 0,info:i,active:void 0,fee:void 0,precision:this.safeInteger(i,"precision"),limits:{amount:{min:void 0,max:void 0},withdraw:{min:void 0,max:void 0}}}}return s}async fetchMarkets(e={}){const t=await this.publicGetInstruments(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeValue(i,"base",{}),a=this.safeValue(i,"quote",{}),n=this.safeString(r,"code"),o=this.safeString(a,"code"),c=n+"_"+o,d=this.safeCurrencyCode(n),h=this.safeCurrencyCode(o),u=d+"/"+h,l={amount:this.safeInteger(i,"amount_precision"),price:this.safeInteger(i,"market_precision")},f={amount:{min:void 0,max:void 0},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(i,"min_size"),max:void 0}},p="ACTIVE"===this.safeString(i,"state");s.push({id:c,symbol:u,base:d,quote:h,baseId:n,quoteId:o,precision:l,limits:f,info:i,active:p})}return s}async fetchTradingFees(e={}){let t=this.safeString(e,"method");if(e=this.omit(e,"method"),void 0===t){const e=this.safeValue(this.options,"fetchTradingFees",{});t=this.safeString(e,"method","fetchPrivateTradingFees")}return await this[t](e)}async fetchPublicTradingFees(e={}){await this.loadMarkets();const t=await this.publicGetFees(e),s=this.indexBy(t,"fee_group_id"),i=this.safeValue(this.options,"fee_group_id","default"),r=this.safeValue(s,i,{}),a=this.safeValue(r,"fee_tiers"),n={};for(let e=0;e<this.symbols.length;e++){const t=this.symbols[e],s={info:r,symbol:t,maker:void 0,taker:void 0,percentage:!0,tierBased:!0},i=[],o=[];for(let e=0;e<a.length;e++){const t=a[e],r=this.safeNumber(t,"volume");let n=this.safeNumber(t,"taker_fee"),c=this.safeNumber(t,"maker_fee");n/=100,c/=100,i.push([r,n]),o.push([r,c]),0===e&&(s.taker=n,s.maker=c)}const c={taker:i,maker:o};s.tiers=c,n[t]=s}return n}async fetchPrivateTradingFees(e={}){await this.loadMarkets();const t=await this.privateGetAccountFees(e),s=this.safeValue(t,"active_fee_tier",{}),i={info:t,maker:this.safeNumber(s,"maker_fee"),taker:this.safeNumber(s,"taker_fee"),percentage:!0,tierBased:!0},r=this.safeValue(t,"fee_tiers"),a=[],n=[];for(let e=0;e<r.length;e++){const t=r[e],s=this.safeNumber(t,"volume");let i=this.safeNumber(t,"taker_fee"),o=this.safeNumber(t,"maker_fee");i/=100,o/=100,a.push([s,i]),n.push([s,o])}const o={taker:a,maker:n};return i.tiers=o,i}parseTicker(e,t){const s=this.parse8601(this.safeString(e,"time")),i=this.safeString(e,"instrument_code"),r=this.safeSymbol(i,t,"_"),a=this.safeNumber(e,"last_price"),n=this.safeNumber(e,"price_change_percentage"),o=this.safeNumber(e,"price_change");let c,d;void 0!==a&&void 0!==o&&(c=a-o,d=this.sum(a,c)/2);const h=this.safeNumber(e,"base_volume"),u=this.safeNumber(e,"quote_volume"),l=this.vwap(h,u);return{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"best_bid"),bidVolume:void 0,ask:this.safeNumber(e,"best_ask"),askVolume:void 0,vwap:l,open:c,close:a,last:a,previousClose:void 0,change:o,percentage:n,average:d,baseVolume:h,quoteVolume:u,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={instrument_code:s.id},r=await this.publicGetMarketTickerInstrumentCode(this.extend(i,t));return this.parseTicker(r,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetMarketTicker(t),i={};for(let e=0;e<s.length;e++){const t=this.parseTicker(s[e]);i[t.symbol]=t}return this.filterByArray(i,"symbol",e)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={instrument_code:this.marketId(e)};void 0!==t&&(i.depth=t);const r=await this.publicGetOrderBookInstrumentCode(this.extend(i,s)),a=this.parse8601(this.safeString(r,"time"));return this.parseOrderBook(r,e,a,"bids","asks","price","amount")}parseOHLCV(e,t){const s=this.safeValue(e,"granularity"),i=this.safeString(s,"unit"),r=this.safeString(s,"period")+this.safeString({MINUTES:"m",HOURS:"h",DAYS:"d",WEEKS:"w",MONTHS:"M"},i),a=1e3*this.parseTimeframe(r),n=this.parse8601(this.safeString(e,"time")),o=a*parseInt(n/a),c=this.safeValue(this.options,"fetchOHLCV",{}),d=this.safeString(c,"volume","total_amount");return[o,this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,d)]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n=this.safeString(this.timeframes,t),[o,c]=n.split("/"),d=1e3*this.parseTimeframe(t);void 0===i&&(i=1500);const h={instrument_code:a.id,period:o,unit:c};if(void 0===s){const e=this.milliseconds();h.to=this.iso8601(e),h.from=this.iso8601(e-i*d)}else h.from=this.iso8601(s),h.to=this.iso8601(this.sum(s,i*d));const u=await this.publicGetCandlesticksInstrumentCode(this.extend(h,r));return this.parseOHLCVs(u,a,t,s,i)}parseTrade(e,t){const s=this.safeValue(e,"fee",{});e=this.safeValue(e,"trade",e);let i=this.safeInteger(e,"trade_timestamp");void 0===i&&(i=this.parse8601(this.safeString(e,"time")));const r=this.safeStringLower2(e,"side","taker_side"),a=this.safeNumber(e,"price"),n=this.safeNumber(e,"amount");let o=this.safeNumber(e,"volume");void 0===o&&void 0!==n&&void 0!==a&&(o=n*a);const c=this.safeString(e,"instrument_code"),d=this.safeSymbol(c,t,"_"),h=this.safeNumber(s,"fee_amount");let u,l;if(void 0!==h){const e=this.safeString(s,"fee_currency");l={cost:h,currency:this.safeCurrencyCode(e),rate:this.safeNumber(s,"fee_percentage")},u=this.safeStringLower(s,"fee_type")}return{id:this.safeString2(e,"trade_id","sequence"),order:this.safeString(e,"order_id"),timestamp:i,datetime:this.iso8601(i),symbol:d,type:void 0,side:r,price:a,amount:n,cost:o,takerOrMaker:u,fee:l,info:e}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={instrument_code:r.id};void 0!==t&&(a.from=this.iso8601(t),a.to=this.iso8601(this.sum(t,144e5)));const n=await this.publicGetPriceTicksInstrumentCode(this.extend(a,i));return this.parseTrades(n,r,t,s)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetAccountBalances(e),s=this.safeValue(t,"balances",[]),i={info:t};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"currency_code"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(t,"available"),n.used=this.safeString(t,"locked"),i[a]=n}return this.parseBalance(i,!1)}parseDepositAddress(e,t){let s;void 0!==t&&(s=t.code);const i=this.safeString(e,"address"),r=this.safeString(e,"destination_tag");return this.checkAddress(i),{currency:s,address:i,tag:r,info:e}}async createDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e),i={currency:s.id},r=await this.privatePostAccountDepositCrypto(this.extend(i,t));return this.parseDepositAddress(r,s)}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e),i={currency_code:s.id},r=await this.privateGetAccountDepositCryptoCurrencyCode(this.extend(i,t));return this.parseDepositAddress(r,s)}async fetchDeposits(e,t,s,i={}){await this.loadMarkets();const r={};let a;if(void 0!==e&&(a=this.currency(e),r.currency_code=a.id),void 0!==s&&(r.max_page_size=s),void 0!==t){if(void 0===this.safeString(i,"to"))throw new c(this.id+' fetchDeposits() requires a "to" iso8601 string param with the since argument is specified');r.from=this.iso8601(t)}const n=await this.privateGetAccountDeposits(this.extend(r,i)),o=this.safeValue(n,"deposit_history",[]);return this.parseTransactions(o,a,t,s,{type:"deposit"})}async fetchWithdrawals(e,t,s,i={}){await this.loadMarkets();const r={};let a;if(void 0!==e&&(a=this.currency(e),r.currency_code=a.id),void 0!==s&&(r.max_page_size=s),void 0!==t){if(void 0===this.safeString(i,"to"))throw new c(this.id+' fetchWithdrawals() requires a "to" iso8601 string param with the since argument is specified');r.from=this.iso8601(t)}const n=await this.privateGetAccountWithdrawals(this.extend(r,i)),o=this.safeValue(n,"withdrawal_history",[]);return this.parseTransactions(o,a,t,s,{type:"withdrawal"})}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a=this.currency(e),n={currency:e,amount:this.currencyToPrecision(e,t)},o=this.safeValue(this.options,"fiat",[]),d=this.inArray(e,o),h=d?"privatePostAccountWithdrawFiat":"privatePostAccountWithdrawCrypto";if(d){if(void 0===this.safeString(r,"payout_account_id"))throw c(this.id+" withdraw() requires a payout_account_id param for fiat "+e+" withdrawals")}else{const e={address:s};void 0!==i&&(e.destination_tag=i),n.recipient=e}const u=await this[h](this.extend(n,r));return this.parseTransaction(u,a)}parseTransaction(e,t){const s=this.safeString(e,"transaction_id"),i=this.safeNumber(e,"amount"),r=this.parse8601(this.safeString(e,"time")),a=this.safeString(e,"currency");t=this.safeCurrency(a,t);const n=this.safeNumber2(e,"fee_amount","fee");let o;const c=this.safeString(e,"recipient"),d=this.safeString(e,"destination_tag");if(void 0!==n){const t=this.safeString(e,"fee_currency",a);o={cost:n,currency:this.safeCurrencyCode(t)}}return{info:e,id:s,currency:t.code,amount:i,address:c,addressFrom:void 0,addressTo:c,tag:d,tagFrom:void 0,tagTo:d,status:"ok",type:void 0,updated:void 0,txid:this.safeString(e,"blockchain_transaction_id"),timestamp:r,datetime:this.iso8601(r),fee:o}}parseOrderStatus(e){return this.safeString({FILLED:"open",FILLED_FULLY:"closed",FILLED_CLOSED:"canceled",FILLED_REJECTED:"rejected",OPEN:"open",REJECTED:"rejected",CLOSED:"canceled",FAILED:"failed",STOP_TRIGGERED:"triggered"},e,e)}parseOrder(e,t){const s=this.safeValue(e,"order",e),i=this.safeString(s,"order_id"),r=this.safeString(s,"client_id"),a=this.parse8601(this.safeString(s,"time")),n=this.parseOrderStatus(this.safeString(s,"status")),o=this.parseOrderStatus(n),c=this.safeString(s,"instrument_code"),d=this.safeSymbol(c,t,"_"),h=this.safeNumber(s,"price"),u=this.safeNumber(s,"amount"),l=this.safeString(s,"filled_amount"),f=this.parseNumber(l),p=this.safeStringLower(s,"side"),m=this.safeStringLower(s,"type"),b=this.parseTimeInForce(this.safeString(s,"time_in_force")),g=this.safeNumber(s,"trigger_price"),y=this.safeValue(s,"is_post_only"),v=this.safeValue(e,"trades",[]),w=this.parseTrades(v,t,void 0,void 0,{type:m});return this.safeOrder({id:i,clientOrderId:r,info:e,timestamp:a,datetime:this.iso8601(a),lastTradeTimestamp:void 0,symbol:d,type:m,timeInForce:b,postOnly:y,side:p,price:h,stopPrice:g,amount:u,cost:void 0,average:void 0,filled:f,remaining:void 0,status:o,trades:w})}parseTimeInForce(e){return this.safeString({GOOD_TILL_CANCELLED:"GTC",GOOD_TILL_TIME:"GTT",IMMEDIATE_OR_CANCELLED:"IOC",FILL_OR_KILL:"FOK"},e,e)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o=t.toUpperCase(),d={instrument_code:n.id,type:o,side:s.toUpperCase(),amount:this.amountToPrecision(e,i)};let h=!1;if("LIMIT"!==o&&"STOP"!==o||(h=!0),"STOP"===o){const s=this.safeNumber(a,"trigger_price");if(void 0===s)throw new c(this.id+" createOrder() requires a trigger_price param for "+t+" orders");d.trigger_price=this.priceToPrecision(e,s),a=this.omit(a,"trigger_price")}h&&(d.price=this.priceToPrecision(e,r));const u=this.safeString2(a,"clientOrderId","client_id");void 0!==u&&(d.client_id=u,a=this.omit(a,["clientOrderId","client_id"]));const l=await this.privatePostAccountOrders(this.extend(d,a));return this.parseOrder(l,n)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i=this.safeString2(s,"clientOrderId","client_id");s=this.omit(s,["clientOrderId","client_id"]);let r="privateDeleteAccountOrdersOrderId";const a={};void 0!==i?(r="privateDeleteAccountOrdersClientClientId",a.client_id=i):a.order_id=e;return await this[r](this.extend(a,s))}async cancelAllOrders(e,t={}){await this.loadMarkets();const s={};if(void 0!==e){const t=this.market(e);s.instrument_code=t.id}return await this.privateDeleteAccountOrders(this.extend(s,t))}async cancelOrders(e,t,s={}){await this.loadMarkets();const i={ids:e.join(",")};return await this.privateDeleteAccountOrders(this.extend(i,s))}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={order_id:e},r=await this.privateGetAccountOrdersOrderId(this.extend(i,s));return this.parseOrder(r)}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a;if(void 0!==e&&(a=this.market(e),r.instrument_code=a.id),void 0!==t){if(void 0===this.safeString(i,"to"))throw new c(this.id+' fetchOrders() requires a "to" iso8601 string param with the since argument is specified, max range is 100 days');r.from=this.iso8601(t)}void 0!==s&&(r.max_page_size=s);const n=await this.privateGetAccountOrders(this.extend(r,i)),o=this.safeValue(n,"order_history",[]);return this.parseOrders(o,a,t,s)}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOpenOrders(e,t,s,this.extend({with_cancelled_and_rejected:!0},i))}async fetchOrderTrades(e,t,s,i,r={}){await this.loadMarkets();const a={order_id:e};void 0!==i&&(a.max_page_size=i);const n=await this.privateGetAccountOrdersOrderIdTrades(this.extend(a,r)),o=this.safeValue(n,"trade_history",[]);let c;return void 0!==t&&(c=this.market(t)),this.parseTrades(o,c,s,i)}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={};let a;if(void 0!==e&&(a=this.market(e),r.instrument_code=a.id),void 0!==t){if(void 0===this.safeString(i,"to"))throw new c(this.id+' fetchMyTrades() requires a "to" iso8601 string param with the since argument is specified, max range is 100 days');r.from=this.iso8601(t)}void 0!==s&&(r.max_page_size=s);const n=await this.privateGetAccountTrades(this.extend(r,i)),o=this.safeValue(n,"trade_history",[]);return this.parseTrades(o,a,t,s)}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t]+"/"+this.version+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));return"public"===t?Object.keys(o).length&&(n+="?"+this.urlencode(o)):"private"===t&&(this.checkRequiredCredentials(),r={Accept:"application/json",Authorization:"Bearer "+this.apiKey},"POST"===s?(a=this.json(o),r["Content-Type"]="application/json"):Object.keys(o).length&&(n+="?"+this.urlencode(o))),{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,n,o,c,d){if(void 0===o)return;const h=this.safeString(o,"error");if(void 0!==h){const e=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,h,e),this.throwBroadlyMatchedException(this.exceptions.broad,h,e),new a(e)}}}},5686:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,InvalidNonce:a,AuthenticationError:n,OrderNotFound:o}=s(3449),{TICK_SIZE:c}=s(2115),d=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bitso",name:"Bitso",countries:["MX"],rateLimit:2e3,version:"v3",has:{cancelOrder:!0,CORS:!1,createOrder:!0,fetchBalance:!0,fetchDepositAddress:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrderTrades:!0,fetchTicker:!0,fetchTrades:!0,withdraw:!0},urls:{logo:"https://user-images.githubusercontent.com/51840849/87295554-11f98280-c50e-11ea-80d6-15b3bafa8cbf.jpg",api:"https://api.bitso.com",www:"https://bitso.com",doc:"https://bitso.com/api_info",fees:"https://bitso.com/fees",referral:"https://bitso.com/?ref=itej"},precisionMode:c,options:{precision:{XRP:1e-6,MXN:.01,TUSD:.01},defaultPrecision:1e-8},api:{public:{get:["available_books","ticker","order_book","trades"]},private:{get:["account_status","balance","fees","fundings","fundings/{fid}","funding_destination","kyc_documents","ledger","ledger/trades","ledger/fees","ledger/fundings","ledger/withdrawals","mx_bank_codes","open_orders","order_trades/{oid}","orders/{oid}","user_trades","user_trades/{tid}","withdrawals/","withdrawals/{wid}"],post:["bitcoin_withdrawal","debit_card_withdrawal","ether_withdrawal","ripple_withdrawal","bcash_withdrawal","litecoin_withdrawal","orders","phone_number","phone_verification","phone_withdrawal","spei_withdrawal","ripple_withdrawal","bcash_withdrawal","litecoin_withdrawal"],delete:["orders/{oid}","orders/all"]}},exceptions:{"0201":n,104:a}})}async fetchMarkets(e={}){const t=await this.publicGetAvailableBooks(e),s=this.safeValue(t,"payload"),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"book"),[a,n]=r.split("_");let o=a.toUpperCase(),c=n.toUpperCase();o=this.safeCurrencyCode(o),c=this.safeCurrencyCode(c);const h=o+"/"+c,u={amount:{min:this.safeNumber(t,"minimum_amount"),max:this.safeNumber(t,"maximum_amount")},price:{min:this.safeNumber(t,"minimum_price"),max:this.safeNumber(t,"maximum_price")},cost:{min:this.safeNumber(t,"minimum_value"),max:this.safeNumber(t,"maximum_value")}},l=this.safeNumber(this.options.precision,c,this.options.defaultPrecision),f=this.safeNumber(t,"tick_size",l),p={amount:this.safeNumber(this.options.precision,o,this.options.defaultPrecision),price:f},m=this.safeValue(t,"fees",{}),b=this.safeValue(m,"flat_rate",{}),g=this.safeString(b,"maker"),y=this.safeString(b,"taker"),v=this.parseNumber(d.stringDiv(g,"100")),w=this.parseNumber(d.stringDiv(y,"100")),k=this.safeValue(m,"structure",[]),S={taker:w,maker:v,percentage:!0,tierBased:!0},_=[],O=[];for(let e=0;e<k.length;e++){const t=k[e],s=this.safeNumber(t,"volume"),i=this.safeNumber(t,"taker"),r=this.safeNumber(t,"maker");_.push([s,i]),O.push([s,r]),0===e&&(S.taker=i,S.maker=r)}const T={taker:_,maker:O};S.tiers=T,i.push(this.extend({id:r,symbol:h,base:o,quote:c,baseId:a,quoteId:n,info:t,limits:u,precision:p,active:void 0},S))}return i}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetBalance(e),s=this.safeValue(t,"payload",{}),i=this.safeValue(s,"balances"),r={info:t,timestamp:void 0,datetime:void 0};for(let e=0;e<i.length;e++){const t=i[e],s=this.safeString(t,"currency"),a=this.safeCurrencyCode(s),n=this.account();n.free=this.safeString(t,"available"),n.used=this.safeString(t,"locked"),n.total=this.safeString(t,"total"),r[a]=n}return this.parseBalance(r,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={book:this.marketId(e)},r=await this.publicGetOrderBook(this.extend(i,s)),a=this.safeValue(r,"payload"),n=this.parse8601(this.safeString(a,"updated_at"));return this.parseOrderBook(a,e,n,"bids","asks","price","amount")}async fetchTicker(e,t={}){await this.loadMarkets();const s={book:this.marketId(e)},i=await this.publicGetTicker(this.extend(s,t)),r=this.safeValue(i,"payload"),a=this.parse8601(this.safeString(r,"created_at")),n=this.safeNumber(r,"vwap"),o=this.safeNumber(r,"volume");let c;void 0!==o&&void 0!==n&&(c=o*n);const d=this.safeNumber(r,"last");return{symbol:e,timestamp:a,datetime:this.iso8601(a),high:this.safeNumber(r,"high"),low:this.safeNumber(r,"low"),bid:this.safeNumber(r,"bid"),bidVolume:void 0,ask:this.safeNumber(r,"ask"),askVolume:void 0,vwap:n,open:void 0,close:d,last:d,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:o,quoteVolume:c,info:r}}parseTrade(e,t){const s=this.parse8601(this.safeString(e,"created_at")),i=this.safeString(e,"book"),r=this.safeSymbol(i,t,"_"),a=this.safeString2(e,"side","maker_side");let n,o=this.safeNumber2(e,"amount","major");void 0!==o&&(o=Math.abs(o));const c=this.safeNumber(e,"fees_amount");if(void 0!==c){const t=this.safeString(e,"fees_currency");n={cost:c,currency:this.safeCurrencyCode(t)}}let d=this.safeNumber(e,"minor");void 0!==d&&(d=Math.abs(d));const h=this.safeNumber(e,"price"),u=this.safeString(e,"oid");return{id:this.safeString(e,"tid"),info:e,timestamp:s,datetime:this.iso8601(s),symbol:r,order:u,type:void 0,side:a,takerOrMaker:void 0,price:h,amount:o,cost:d,fee:n}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={book:r.id},n=await this.publicGetTrades(this.extend(a,i));return this.parseTrades(n.payload,r,t,s)}async fetchMyTrades(e,t,s=25,i={}){await this.loadMarkets();const a=this.market(e),n="marker"in i;if(void 0!==t&&!n)throw new r(this.id+" fetchMyTrades does not support fetching trades starting from a timestamp with the `since` argument, use the `marker` extra param to filter starting from an integer trade id");n&&(i=this.extend(i,{marker:parseInt(i.marker)}));const o={book:a.id,limit:s},c=await this.privateGetUserTrades(this.extend(o,i));return this.parseTrades(c.payload,a,t,s)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n={book:this.marketId(e),side:s,type:t,major:this.amountToPrecision(e,i)};"limit"===t&&(n.price=this.priceToPrecision(e,r));const o=await this.privatePostOrders(this.extend(n,a));return{info:o,id:this.safeString(o.payload,"oid")}}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={oid:e};return await this.privateDeleteOrdersOid(this.extend(i,s))}parseOrderStatus(e){return this.safeString({"partial-fill":"open",completed:"closed"},e,e)}parseOrder(e,t){const s=this.safeString(e,"oid"),i=this.safeString(e,"side"),r=this.parseOrderStatus(this.safeString(e,"status")),a=this.safeString(e,"book"),n=this.safeSymbol(a,t,"_"),o=this.safeString(e,"type"),c=this.parse8601(this.safeString(e,"created_at")),d=this.safeNumber(e,"price"),h=this.safeNumber(e,"original_amount"),u=this.safeNumber(e,"unfilled_amount"),l=this.safeString(e,"client_id");return this.safeOrder({info:e,id:s,clientOrderId:l,timestamp:c,datetime:this.iso8601(c),lastTradeTimestamp:void 0,symbol:n,type:o,timeInForce:void 0,postOnly:void 0,side:i,price:d,stopPrice:void 0,amount:h,cost:void 0,remaining:u,filled:void 0,status:r,fee:void 0,average:void 0,trades:void 0})}async fetchOpenOrders(e,t,s=25,i={}){await this.loadMarkets();const a=this.market(e),n="marker"in i;if(void 0!==t&&!n)throw new r(this.id+" fetchOpenOrders does not support fetching orders starting from a timestamp with the `since` argument, use the `marker` extra param to filter starting from an integer trade id");n&&(i=this.extend(i,{marker:parseInt(i.marker)}));const o={book:a.id,limit:s},c=await this.privateGetOpenOrders(this.extend(o,i));return this.parseOrders(c.payload,a,t,s)}async fetchOrder(e,t,s={}){await this.loadMarkets();const i=await this.privateGetOrdersOid({oid:e}),r=this.safeValue(i,"payload");if(Array.isArray(r)){if(1===i.payload.length)return this.parseOrder(r[0])}throw new o(this.id+": The order "+e+" not found.")}async fetchOrderTrades(e,t,s,i,r={}){await this.loadMarkets();const a=this.market(t),n={oid:e},o=await this.privateGetOrderTradesOid(this.extend(n,r));return this.parseTrades(o.payload,a)}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={fund_currency:this.currency(e).id},i=await this.privateGetFundingDestination(this.extend(s,t));let r,a=this.safeString(i.payload,"account_identifier");if(a.indexOf("?dt=")>=0){const e=a.split("?dt=");a=this.safeString(e,0),r=this.safeString(e,1)}return this.checkAddress(a),{currency:e,address:a,tag:r,info:i}}async withdraw(e,t,s,i,a={}){this.checkAddress(s),await this.loadMarkets();const n={BTC:"Bitcoin",ETH:"Ether",XRP:"Ripple",BCH:"Bcash",LTC:"Litecoin"},o=e in n?n[e]:void 0;if(void 0===o)throw new r(this.id+" not valid withdraw coin: "+e);const c={amount:t,address:s,destination_tag:i},d="privatePost"+o+"Withdrawal",h=await this[d](this.extend(c,a));return{info:h,id:this.safeString(h.payload,"wid")}}sign(e,t="public",s="GET",i={},r,a){let n="/"+this.version+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));"GET"===s&&Object.keys(o).length&&(n+="?"+this.urlencode(o));const c=this.urls.api+n;if("private"===t){this.checkRequiredCredentials();const e=this.nonce().toString();let t=[e,s,n].join("");"GET"!==s&&Object.keys(o).length&&(t+=a=this.json(o));const i=this.hmac(this.encode(t),this.encode(this.secret));r={Authorization:"Bitso "+(this.apiKey+":"+e+":"+i),"Content-Type":"application/json"}}return{url:c,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0!==o&&"success"in o){let e=this.safeValue(o,"success",!1);if("string"==typeof e&&(e="true"===e||"1"===e),!e){const e=this.id+" "+this.json(o),t=this.safeValue(o,"error");if(void 0===t)throw new r(e);const s=this.safeString(t,"code");throw this.throwExactlyMatchedException(this.exceptions,s,e),new r(e)}}}async request(e,t="public",s="GET",i={},a,n){const o=await this.fetch2(e,t,s,i,a,n);if("success"in o&&o.success)return o;throw new r(this.id+" "+this.json(o))}}},7653:(e,t,s)=>{"use strict";const i=s(8819),{AuthenticationError:r,ExchangeError:a,NotSupported:n,PermissionDenied:o,InvalidNonce:c,OrderNotFound:d,InsufficientFunds:h,InvalidAddress:u,InvalidOrder:l,ArgumentsRequired:f,OnMaintenance:p,ExchangeNotAvailable:m}=s(3449);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bitstamp",name:"Bitstamp",countries:["GB"],rateLimit:1e3,version:"v2",userAgent:this.userAgents.chrome,pro:!0,has:{CORS:!0,cancelAllOrders:!0,cancelOrder:!0,createOrder:!0,fetchBalance:!0,fetchDepositAddress:!0,fetchMarkets:!0,fetchCurrencies:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTrades:!0,fetchTransactions:!0,fetchWithdrawals:!0,withdraw:!0,fetchTradingFee:!0,fetchTradingFees:!0,fetchFundingFees:!0,fetchFees:!0,fetchLedger:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/27786377-8c8ab57e-5fe9-11e7-8ea4-2b05b6bcceec.jpg",api:{public:"https://www.bitstamp.net/api",private:"https://www.bitstamp.net/api",v1:"https://www.bitstamp.net/api"},www:"https://www.bitstamp.net",doc:"https://www.bitstamp.net/api"},timeframes:{"1m":"60","3m":"180","5m":"300","15m":"900","30m":"1800","1h":"3600","2h":"7200","4h":"14400","6h":"21600","12h":"43200","1d":"86400","1w":"259200"},requiredCredentials:{apiKey:!0,secret:!0,uid:!0},api:{public:{get:["ohlc/{pair}/","order_book/{pair}/","ticker_hour/{pair}/","ticker/{pair}/","transactions/{pair}/","trading-pairs-info/"]},private:{post:["balance/","balance/{pair}/","bch_withdrawal/","bch_address/","user_transactions/","user_transactions/{pair}/","open_orders/all/","open_orders/{pair}/","order_status/","cancel_order/","cancel_all_orders/","cancel_all_orders/{pair}/","buy/{pair}/","buy/market/{pair}/","buy/instant/{pair}/","sell/{pair}/","sell/market/{pair}/","sell/instant/{pair}/","btc_withdrawal/","btc_address/","ripple_withdrawal/","ripple_address/","ltc_withdrawal/","ltc_address/","eth_withdrawal/","eth_address/","xrp_withdrawal/","xrp_address/","xlm_withdrawal/","xlm_address/","pax_withdrawal/","pax_address/","link_withdrawal/","link_address/","usdc_withdrawal/","usdc_address/","omg_withdrawal/","omg_address/","dai_withdrawal/","dai_address/","knc_withdrawal/","knc_address/","mkr_withdrawal/","mkr_address/","zrx_withdrawal/","zrx_address/","gusd_withdrawal/","gusd_address/","aave_withdrawal/","aave_address/","bat_withdrawal/","bat_address/","uma_withdrawal/","uma_address/","snx_withdrawal/","snx_address/","uni_withdrawal/","uni_address/","yfi_withdrawal/","yfi_address","audio_withdrawal/","audio_address/","crv_withdrawal/","crv_address/","algo_withdrawal/","algo_address/","comp_withdrawal/","comp_address/","grt_withdrawal","grt_address/","usdt_withdrawal/","usdt_address/","transfer-to-main/","transfer-from-main/","withdrawal-requests/","withdrawal/open/","withdrawal/status/","withdrawal/cancel/","liquidation_address/new/","liquidation_address/info/"]},v1:{post:["unconfirmed_btc/"]}},fees:{trading:{tierBased:!0,percentage:!0,taker:.005,maker:.005,tiers:{taker:[[0,.005],[2e4,.0025],[1e5,.0024],[2e5,.0022],[4e5,.002],[6e5,.0015],[1e6,.14/100],[2e6,.0013],[4e6,.0012],[2e7,.0011],[5e7,.001],[1e8,.07/100],[5e8,5e-4],[2e9,3e-4],[6e9,1e-4],[1e10,5e-5],[10000000001,0]],maker:[[0,.005],[2e4,.0025],[1e5,.0024],[2e5,.0022],[4e5,.002],[6e5,.0015],[1e6,.14/100],[2e6,.0013],[4e6,.0012],[2e7,.0011],[5e7,.001],[1e8,.07/100],[5e8,5e-4],[2e9,3e-4],[6e9,1e-4],[1e10,5e-5],[10000000001,0]]}},funding:{tierBased:!1,percentage:!1,withdraw:{BTC:5e-4,BCH:1e-4,LTC:.001,ETH:.001,XRP:.02,XLM:.005,PAX:.5,USD:25,EUR:3},deposit:{BTC:0,BCH:0,LTC:0,ETH:0,XRP:0,XLM:0,PAX:0,USD:7.5,EUR:0}}},exceptions:{exact:{"No permission found":o,"API key not found":r,"IP address not allowed":o,"Invalid nonce":c,"Invalid signature":r,"Authentication failed":r,"Missing key, signature and nonce parameters":r,"Your account is frozen":o,"Please update your profile with your FATCA information, before using API.":o,"Order not found":d,"Price is more than 20% below market price.":l,"Bitstamp.net is under scheduled maintenance.":p,"Order could not be placed.":m},broad:{"Minimum order size is":l,"Check your account balance for details.":h,"Ensure this value has at least":u}}})}async fetchMarkets(e={}){const t=await this.fetchMarketsFromCache(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"name");let[a,n]=r.split("/");const o=a.toLowerCase(),c=n.toLowerCase();a=this.safeCurrencyCode(a),n=this.safeCurrencyCode(n);const d=a+"/"+n,h=o+"_"+c,u=this.safeString(i,"url_symbol"),l=this.safeString(i,"base_decimals"),f=this.safeString(i,"counter_decimals"),p=this.parsePrecision(l),m=this.parsePrecision(f),b={amount:parseInt(l),price:parseInt(f)},g=this.safeString(i,"minimum_order").split(" ")[0],y="Enabled"===this.safeString(i,"trading");s.push({id:u,symbol:d,base:a,quote:n,baseId:o,quoteId:c,symbolId:h,info:i,active:y,precision:b,limits:{amount:{min:this.parseNumber(p),max:void 0},price:{min:this.parseNumber(m),max:void 0},cost:{min:this.parseNumber(g),max:void 0}}})}return s}constructCurrencyObject(e,t,s,i,r,a){let n="crypto";const o=this.describe();return this.isFiat(t)&&(n="fiat"),{id:e,code:t,info:a,type:n,name:s,active:!0,fee:this.safeNumber(o.fees.funding.withdraw,t),precision:i,limits:{amount:{min:Math.pow(10,-i),max:void 0},price:{min:Math.pow(10,-i),max:void 0},cost:{min:r,max:void 0},withdraw:{min:void 0,max:void 0}}}}async fetchMarketsFromCache(e={}){const t=this.safeValue(this.options,"fetchMarkets",{}),s=this.safeInteger(t,"timestamp"),i=this.safeInteger(t,"expires",1e3),r=this.milliseconds();if(void 0===s||r-s>i){const s=await this.publicGetTradingPairsInfo(e);this.options.fetchMarkets=this.extend(t,{response:s,timestamp:r})}return this.safeValue(this.options.fetchMarkets,"response")}async fetchCurrencies(e={}){const t=await this.fetchMarketsFromCache(e),s={};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"name");let[a,n]=r.split("/");const o=a.toLowerCase(),c=n.toLowerCase();a=this.safeCurrencyCode(a),n=this.safeCurrencyCode(n);const d=this.safeString(i,"description"),[h,u]=d.split(" / "),l=this.safeString(i,"minimum_order").split(" ")[0];if(!(a in s)){const e=this.safeInteger(i,"base_decimals");s[a]=this.constructCurrencyObject(o,a,h,e,void 0,i)}if(!(n in s)){const e=this.safeInteger(i,"counter_decimals");s[n]=this.constructCurrencyObject(c,n,u,e,parseFloat(l),i)}}return s}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={pair:this.marketId(e)},r=await this.publicGetOrderBookPair(this.extend(i,s)),a=this.safeInteger(r,"microtimestamp"),n=parseInt(a/1e3),o=this.parseOrderBook(r,e,n);return o.nonce=a,o}async fetchTicker(e,t={}){await this.loadMarkets();const s={pair:this.marketId(e)},i=await this.publicGetTickerPair(this.extend(s,t)),r=this.safeTimestamp(i,"timestamp"),a=this.safeNumber(i,"vwap"),n=this.safeNumber(i,"volume");let o;void 0!==n&&void 0!==a&&(o=n*a);const c=this.safeNumber(i,"last");return{symbol:e,timestamp:r,datetime:this.iso8601(r),high:this.safeNumber(i,"high"),low:this.safeNumber(i,"low"),bid:this.safeNumber(i,"bid"),bidVolume:void 0,ask:this.safeNumber(i,"ask"),askVolume:void 0,vwap:a,open:this.safeNumber(i,"open"),close:c,last:c,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:n,quoteVolume:o,info:i}}getCurrencyIdFromTransaction(e){const t=this.safeStringLower(e,"currency");if(void 0!==t)return t;e=this.omit(e,["fee","price","datetime","type","status","id"]);const s=Object.keys(e);for(let t=0;t<s.length;t++){const i=s[t];if(i.indexOf("_")<0){const t=this.safeNumber(e,i);if(void 0!==t&&0!==t)return i}}}getMarketFromTrade(e){e=this.omit(e,["fee","price","datetime","tid","type","order_id","side"]);const t=Object.keys(e),s=t.length;if(s>2)throw new a(this.id+" getMarketFromTrade too many keys: "+this.json(t)+" in the trade: "+this.json(e));if(2===s){let e=t[0]+t[1];if(e in this.markets_by_id)return this.markets_by_id[e];if(e=t[1]+t[0],e in this.markets_by_id)return this.markets_by_id[e]}}getMarketFromTrades(e){const t=this.indexBy(e,"symbol"),s=Object.keys(t);if(1===s.length)return this.markets[s[0]]}parseTrade(e,t){const s=this.safeString2(e,"id","tid");let i,r,a=this.safeNumber(e,"price"),n=this.safeNumber(e,"amount");const o=this.safeString(e,"order_id");let c=this.safeNumber(e,"cost");if(void 0===t){const s=Object.keys(e);for(let e=0;e<s.length;e++)if(s[e].indexOf("_")>=0){const i=s[e].replace("_","");i in this.markets_by_id&&(t=this.markets_by_id[i])}void 0===t&&(t=this.getMarketFromTrade(e))}const d=this.safeNumber(e,"fee");let h;void 0!==t&&(a=this.safeNumber(e,t.symbolId,a),n=this.safeNumber(e,t.baseId,n),c=this.safeNumber(e,t.quoteId,c),h=t.quote,i=t.symbol);let u,l=this.safeString2(e,"date","datetime");return void 0!==l&&(l.indexOf(" ")>=0?l=this.parse8601(l):(l=parseInt(l),l*=1e3)),"id"in e?void 0!==n&&(n<0?(r="sell",n=-n):r="buy"):(r=this.safeString(e,"type"),"1"===r?r="sell":"0"===r&&(r="buy")),void 0===c&&void 0!==a&&void 0!==n&&(c=a*n),void 0!==c&&(c=Math.abs(c)),void 0!==d&&(u={cost:d,currency:h}),{id:s,info:e,timestamp:l,datetime:this.iso8601(l),symbol:i,order:o,type:undefined,side:r,takerOrMaker:void 0,price:a,amount:n,cost:c,fee:u}}parseTradingFee(e,t){const s=this.market(t),i=this.safeNumber(e,s.id+"_fee");return{symbol:t,maker:i,taker:i}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={pair:r.id,time:"hour"},n=await this.publicGetTransactionsPair(this.extend(a,i));return this.parseTrades(n,r,t,s)}parseOHLCV(e,t){return[this.safeTimestamp(e,"timestamp"),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={pair:a.id,step:this.timeframes[t]},o=this.parseTimeframe(t);if(void 0===i){if(void 0===s)throw new f(this.id+" fetchOHLCV() requires a since argument or a limit argument");{i=1e3;const e=parseInt(s/1e3);n.start=e,n.end=this.sum(e,i*o),n.limit=i}}else{if(void 0!==s){const e=parseInt(s/1e3);n.start=e,n.end=this.sum(e,i*o)}n.limit=Math.min(i,1e3)}const c=await this.publicGetOhlcPair(this.extend(n,r)),d=this.safeValue(c,"data",{}),h=this.safeValue(d,"ohlc",[]);return this.parseOHLCVs(h,a,t,s,i)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostBalance(e),s={info:t,timestamp:void 0,datetime:void 0},i=Object.keys(this.currencies);for(let e=0;e<i.length;e++){const r=i[e],a=this.currency(r).id,n=this.account();n.free=this.safeString(t,a+"_available"),n.used=this.safeString(t,a+"_reserved"),n.total=this.safeString(t,a+"_balance"),s[r]=n}return this.parseBalance(s,!1)}async fetchTradingFee(e,t={}){await this.loadMarkets();const s={};let i,r="privatePostBalance";void 0!==e&&(i=this.market(e),s.pair=i.id,r+="Pair");const a=await this[r](this.extend(s,t));return{info:a,symbol:e,maker:a.fee,taker:a.fee}}praseTradingFees(e){const t={info:e},s=Object.keys(this.markets);for(let i=0;i<s.length;i++){const r=s[i],a=this.parseTradingFee(e,r);t[r]=a}return t}async fetchTradingFees(e={}){await this.loadMarkets();const t=await this.privatePostBalance(e);return this.praseTradingFees(t)}parseFundingFees(e){const t={},s=Object.keys(e);for(let i=0;i<s.length;i++){const r=s[i];if(r.indexOf("_withdrawal_fee")>=0){const s=r.split("_")[0];t[this.safeCurrencyCode(s)]=this.safeNumber(e,r)}}return{info:e,withdraw:t,deposit:{}}}async fetchFundingFees(e={}){await this.loadMarkets();const t=await this.privatePostBalance(e);return this.parseFundingFees(t)}async fetchFees(e={}){await this.loadMarkets();const t=await this.privatePostBalance(e),s=this.praseTradingFees(t);delete s.info;const i=this.parseFundingFees(t);return delete i.info,{info:t,trading:s,funding:i}}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e);let o="privatePost"+this.capitalize(s);const c={pair:n.id,amount:this.amountToPrecision(e,i)};"market"===t?o+="Market":"instant"===t?o+="Instant":c.price=this.priceToPrecision(e,r),o+="Pair";const d=await this[o](this.extend(c,a)),h=this.parseOrder(d,n);return this.extend(h,{type:t})}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={id:e};return await this.privatePostCancelOrder(this.extend(i,s))}async cancelAllOrders(e,t={}){let s;await this.loadMarkets();const i={};let r="privatePostCancelAllOrders";return void 0!==e&&(s=this.market(e),i.pair=s.id,r="privatePostCancelAllOrdersPair"),await this[r](this.extend(i,t))}parseOrderStatus(e){return this.safeString({"In Queue":"open",Open:"open",Finished:"closed",Canceled:"canceled"},e,e)}async fetchOrderStatus(e,t,s={}){await this.loadMarkets();const i={id:e},r=await this.privatePostOrderStatus(this.extend(i,s));return this.parseOrderStatus(this.safeString(r,"status"))}async fetchOrder(e,t,s={}){let i;await this.loadMarkets(),void 0!==t&&(i=this.market(t));const r={id:e},a=await this.privatePostOrderStatus(this.extend(r,s));return this.parseOrder(a,i)}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={};let a,n="privatePostUserTransactions";void 0!==e&&(a=this.market(e),r.pair=a.id,n+="Pair"),void 0!==s&&(r.limit=s);const o=await this[n](this.extend(r,i)),c=this.filterBy(o,"type","2");return this.parseTrades(c,a,t,s)}async fetchTransactions(e,t,s,i={}){await this.loadMarkets();const r={};void 0!==s&&(r.limit=s);const a=await this.privatePostUserTransactions(this.extend(r,i));let n;void 0!==e&&(n=this.currency(e));const o=this.filterByArray(a,"type",["0","1"],!1);return this.parseTransactions(o,n,t,s)}async fetchWithdrawals(e,t,s,i={}){await this.loadMarkets();const r={};r.timedelta=void 0!==t?this.milliseconds()-t:5e7;const a=await this.privatePostWithdrawalRequests(this.extend(r,i));return this.parseTransactions(a,void 0,t,s)}parseTransaction(e,t){const s=this.parse8601(this.safeString(e,"datetime")),i=this.safeString(e,"id"),r=this.getCurrencyIdFromTransaction(e),a=this.safeCurrencyCode(r,t),n=this.safeNumber(e,"fee");let o,c;"amount"in e?c=this.safeNumber(e,"amount"):void 0!==t?(c=this.safeNumber(e,t.id,c),o=t.code):void 0!==a&&void 0!==r&&(c=this.safeNumber(e,r,c),o=a),void 0!==c&&(c=Math.abs(c));let d,h="ok";if("status"in e&&(h=this.parseTransactionStatus(this.safeString(e,"status"))),"type"in e){const t=this.safeString(e,"type");"0"===t?d="deposit":"1"===t&&(d="withdrawal")}else d="withdrawal";const u=this.safeString(e,"transaction_id");let l,f=this.safeString(e,"address");if(void 0!==f){const e=f.split("?dt=");e.length>1&&(f=e[0],l=e[1])}const p=f,m=l;let b;return void 0!==n&&(b={currency:o,cost:n,rate:void 0}),{info:e,id:i,txid:u,timestamp:s,datetime:this.iso8601(s),addressFrom:undefined,addressTo:p,address:f,tagFrom:undefined,tagTo:m,tag:l,type:d,amount:c,currency:a,status:h,updated:void 0,fee:b}}parseTransactionStatus(e){return this.safeString({0:"pending",1:"pending",2:"ok",3:"canceled",4:"failed"},e,e)}parseOrder(e,t){const s=this.safeString(e,"id");let i=this.safeString(e,"type");void 0!==i&&(i="1"===i?"sell":"buy");const r=this.parse8601(this.safeString(e,"datetime")),a=this.safeStringLower(e,"currency_pair");let n=this.safeSymbol(a,t,"/");const o=this.parseOrderStatus(this.safeString(e,"status")),c=this.safeNumber(e,"amount"),d=this.safeValue(e,"transactions",[]),h=this.parseTrades(d,t);h.length&&(n=h[0].symbol);const u=this.safeNumber(e,"price");return this.safeOrder({id:s,clientOrderId:void 0,datetime:this.iso8601(r),timestamp:r,lastTradeTimestamp:void 0,status:o,symbol:n,type:void 0,timeInForce:void 0,postOnly:void 0,side:i,price:u,stopPrice:void 0,cost:void 0,amount:c,filled:void 0,remaining:void 0,trades:h,fee:void 0,info:e,average:void 0})}parseLedgerEntryType(e){return this.safeString({0:"transaction",1:"transaction",2:"trade",14:"transfer"},e,e)}parseLedgerEntry(e,t){const s=this.parseLedgerEntryType(this.safeString(e,"type"));if("trade"===s){const t=this.parseTrade(e);let i;const r=Object.keys(e);for(let e=0;e<r.length;e++)if(r[e].indexOf("_")>=0){const t=r[e].replace("_","");t in this.markets_by_id&&(i=this.markets_by_id[t])}void 0===i&&(i=this.getMarketFromTrade(e));const a="buy"===t.side?"in":"out";return{id:t.id,info:e,timestamp:t.timestamp,datetime:t.datetime,direction:a,account:void 0,referenceId:t.order,referenceAccount:void 0,type:s,currency:i.base,amount:t.amount,before:void 0,after:void 0,status:"ok",fee:t.fee}}{const t=this.parseTransaction(e);let i;if("amount"in e){i=this.safeNumber(e,"amount")>0?"in":"out"}else if("currency"in t&&void 0!==t.currency){const s=this.currencyId(t.currency);i=this.safeNumber(e,s)>0?"in":"out"}return{id:t.id,info:e,timestamp:t.timestamp,datetime:t.datetime,direction:i,account:void 0,referenceId:t.txid,referenceAccount:void 0,type:s,currency:t.currency,amount:t.amount,before:void 0,after:void 0,status:t.status,fee:t.fee}}}async fetchLedger(e,t,s,i={}){await this.loadMarkets();const r={};void 0!==s&&(r.limit=s);const a=await this.privatePostUserTransactions(this.extend(r,i));let n;return void 0!==e&&(n=this.currency(e)),this.parseLedger(a,n,t,s)}async fetchOpenOrders(e,t,s,i={}){let r;await this.loadMarkets(),void 0!==e&&(r=this.market(e));const a=await this.privatePostOpenOrdersAll(i);return this.parseOrders(a,r,t,s,{status:"open",type:"limit"})}getCurrencyName(e){return e.toLowerCase()}isFiat(e){return"USD"===e||"EUR"===e||"GBP"===e}async fetchDepositAddress(e,t={}){if(this.isFiat(e))throw new n(this.id+" fiat fetchDepositAddress() for "+e+" is not supported!");const s=this.getCurrencyName(e),i="privatePost"+this.capitalize(s)+"Address",r=await this[i](t),a=this.safeString(r,"address"),o=this.safeString2(r,"memo_id","destination_tag");return this.checkAddress(a),{currency:e,address:a,tag:o,info:r}}async withdraw(e,t,s,i,r={}){await this.loadMarkets(),this.checkAddress(s);const a={amount:t};let n;if(this.isFiat(e)){n="privatePostWithdrawalOpen";const t=this.currency(e);a.iban=s,a.account_currency=t.id}else{const t=this.getCurrencyName(e);n="privatePost"+this.capitalize(t)+"Withdrawal","XRP"===e&&void 0!==i&&(a.destination_tag=i),a.address=s}const o=await this[n](this.extend(a,r));return{info:o,id:o.id}}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t]+"/";"v1"!==t&&(n+=this.version+"/"),n+=this.implodeParams(e,i);let o=this.omit(i,this.extractParams(e));if("public"===t)Object.keys(o).length&&(n+="?"+this.urlencode(o));else{this.checkRequiredCredentials();if("v1"===this.safeValue(this.options,"auth","v2")||"v1"===t){const e=this.nonce().toString(),t=e+this.uid+this.apiKey,s=this.encode(this.hmac(this.encode(t),this.encode(this.secret)));o=this.extend({key:this.apiKey,signature:s.toUpperCase(),nonce:e},o),a=this.urlencode(o),r={"Content-Type":"application/x-www-form-urlencoded"}}else{const e="BITSTAMP "+this.apiKey,t=this.uuid(),i=this.milliseconds().toString(),c="v2";let d="";r={"X-Auth":e,"X-Auth-Nonce":t,"X-Auth-Timestamp":i,"X-Auth-Version":c},"POST"===s&&(Object.keys(o).length?(a=this.urlencode(o),d="application/x-www-form-urlencoded",r["Content-Type"]=d):(a=this.urlencode({foo:"bar"}),d="application/x-www-form-urlencoded",r["Content-Type"]=d));const h=a||"",u=e+s+n.replace("https://","")+d+t+i+c+h,l=this.hmac(this.encode(u),this.encode(this.secret));r["X-Auth-Signature"]=l}}return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,n,o,c,d,h){if(void 0===c)return;const u=this.safeString(c,"status"),l=this.safeValue(c,"error");if("error"===u||void 0!==l){let e=[];if("string"==typeof l)e.push(l);else if(void 0!==l){const t=Object.keys(l);for(let s=0;s<t.length;s++){const i=t[s],r=this.safeValue(l,i);Array.isArray(r)?e=this.arrayConcat(e,r):e.push(r)}}const t=this.safeValue(c,"reason",{});if("string"==typeof t)e.push(t);else{const s=this.safeValue(t,"__all__",[]);for(let t=0;t<s.length;t++)e.push(s[t])}if("API0005"===this.safeString(c,"code"))throw new r(this.id+" invalid signature, use the uid for the main account if you have subaccounts");const s=this.id+" "+o;for(let t=0;t<e.length;t++){const i=e[t];this.throwExactlyMatchedException(this.exceptions.exact,i,s),this.throwBroadlyMatchedException(this.exceptions.broad,i,s)}throw new a(s)}}}},2554:(e,t,s)=>{"use strict";const i=s(8819),{BadSymbol:r,ExchangeError:a,NotSupported:n}=s(3449),o=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bitstamp1",name:"Bitstamp",countries:["GB"],rateLimit:1e3,version:"v1",has:{cancelOrder:!0,CORS:!0,createOrder:!0,fetchBalance:!0,fetchMyTrades:!0,fetchOrder:!1,fetchOrderBook:!0,fetchTicker:!0,fetchTrades:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/27786377-8c8ab57e-5fe9-11e7-8ea4-2b05b6bcceec.jpg",api:"https://www.bitstamp.net/api",www:"https://www.bitstamp.net",doc:"https://www.bitstamp.net/api"},requiredCredentials:{apiKey:!0,secret:!0,uid:!0},api:{public:{get:["ticker","ticker_hour","order_book","transactions","eur_usd"]},private:{post:["balance","user_transactions","open_orders","order_status","cancel_order","cancel_all_orders","buy","sell","bitcoin_deposit_address","unconfirmed_btc","ripple_withdrawal","ripple_address","withdrawal_requests","bitcoin_withdrawal"]}},markets:{"BTC/USD":{id:"btcusd",symbol:"BTC/USD",base:"BTC",quote:"USD",baseId:"btc",quoteId:"usd",maker:.005,taker:.005},"BTC/EUR":{id:"btceur",symbol:"BTC/EUR",base:"BTC",quote:"EUR",baseId:"btc",quoteId:"eur",maker:.005,taker:.005},"EUR/USD":{id:"eurusd",symbol:"EUR/USD",base:"EUR",quote:"USD",baseId:"eur",quoteId:"usd",maker:.005,taker:.005},"XRP/USD":{id:"xrpusd",symbol:"XRP/USD",base:"XRP",quote:"USD",baseId:"xrp",quoteId:"usd",maker:.005,taker:.005},"XRP/EUR":{id:"xrpeur",symbol:"XRP/EUR",base:"XRP",quote:"EUR",baseId:"xrp",quoteId:"eur",maker:.005,taker:.005},"XRP/BTC":{id:"xrpbtc",symbol:"XRP/BTC",base:"XRP",quote:"BTC",baseId:"xrp",quoteId:"btc",maker:.005,taker:.005},"LTC/USD":{id:"ltcusd",symbol:"LTC/USD",base:"LTC",quote:"USD",baseId:"ltc",quoteId:"usd",maker:.005,taker:.005},"LTC/EUR":{id:"ltceur",symbol:"LTC/EUR",base:"LTC",quote:"EUR",baseId:"ltc",quoteId:"eur",maker:.005,taker:.005},"LTC/BTC":{id:"ltcbtc",symbol:"LTC/BTC",base:"LTC",quote:"BTC",baseId:"ltc",quoteId:"btc",maker:.005,taker:.005},"ETH/USD":{id:"ethusd",symbol:"ETH/USD",base:"ETH",quote:"USD",baseId:"eth",quoteId:"usd",maker:.005,taker:.005},"ETH/EUR":{id:"etheur",symbol:"ETH/EUR",base:"ETH",quote:"EUR",baseId:"eth",quoteId:"eur",maker:.005,taker:.005},"ETH/BTC":{id:"ethbtc",symbol:"ETH/BTC",base:"ETH",quote:"BTC",baseId:"eth",quoteId:"btc",maker:.005,taker:.005}}})}async fetchOrderBook(e,t,s={}){if("BTC/USD"!==e)throw new a(this.id+" "+this.version+" fetchOrderBook doesn't support "+e+", use it for BTC/USD only");await this.loadMarkets();const i=await this.publicGetOrderBook(s),r=this.safeTimestamp(i,"timestamp");return this.parseOrderBook(i,e,r)}async fetchTicker(e,t={}){if("BTC/USD"!==e)throw new a(this.id+" "+this.version+" fetchTicker doesn't support "+e+", use it for BTC/USD only");await this.loadMarkets();const s=await this.publicGetTicker(t),i=this.safeTimestamp(s,"timestamp"),r=this.safeNumber(s,"vwap"),n=this.safeNumber(s,"volume");let o;void 0!==n&&void 0!==r&&(o=n*r);const c=this.safeNumber(s,"last");return{symbol:e,timestamp:i,datetime:this.iso8601(i),high:this.safeNumber(s,"high"),low:this.safeNumber(s,"low"),bid:this.safeNumber(s,"bid"),bidVolume:void 0,ask:this.safeNumber(s,"ask"),askVolume:void 0,vwap:r,open:this.safeNumber(s,"open"),close:c,last:c,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:n,quoteVolume:o,info:s}}parseTrade(e,t){const s=this.safeTimestamp2(e,"date","datetime"),i=0===e.type?"buy":"sell",r=this.safeString(e,"order_id");"currency_pair"in e&&e.currency_pair in this.markets_by_id&&(t=this.markets_by_id[e.currency_pair]);const a=this.safeString(e,"tid"),n=this.safeString(e,"price"),c=this.safeString(e,"amount"),d=this.parseNumber(n),h=this.parseNumber(c),u=this.parseNumber(o.stringMul(n,c));let l;return void 0!==t&&(l=t.symbol),{id:a,info:e,timestamp:s,datetime:this.iso8601(s),symbol:l,order:r,type:void 0,side:i,takerOrMaker:void 0,price:d,amount:h,cost:u,fee:void 0}}async fetchTrades(e,t,s,i={}){if("BTC/USD"!==e)throw new r(this.id+" "+this.version+" fetchTrades doesn't support "+e+", use it for BTC/USD only");await this.loadMarkets();const a=this.market(e),n=await this.publicGetTransactions(this.extend({time:"minute"},i));return this.parseTrades(n,a,t,s)}async fetchBalance(e={}){const t=await this.privatePostBalance(e),s={info:t},i=Object.keys(this.currencies);for(let e=0;e<i.length;e++){const r=i[e],a=this.currency(r).id,n=this.account();n.free=this.safeString(t,a+"_available"),n.used=this.safeString(t,a+"_reserved"),n.total=this.safeString(t,a+"_balance"),s[r]=n}return this.parseBalance(s,!1)}async createOrder(e,t,s,i,r,n={}){if("limit"!==t)throw new a(this.id+" "+this.version+" accepts limit orders only");if("BTC/USD"!==e)throw new a(this.id+" v1 supports BTC/USD orders only");await this.loadMarkets();const o="privatePost"+this.capitalize(s),c={amount:i,price:r},d=await this[o](this.extend(c,n));return{info:d,id:this.safeString(d,"id")}}async cancelOrder(e,t,s={}){return await this.privatePostCancelOrder({id:e})}parseOrderStatus(e){return this.safeString({"In Queue":"open",Open:"open",Finished:"closed",Canceled:"canceled"},e,e)}async fetchOrderStatus(e,t,s={}){await this.loadMarkets();const i={id:e},r=await this.privatePostOrderStatus(this.extend(i,s));return this.parseOrderStatus(r)}async fetchMyTrades(e,t,s,i={}){let r;await this.loadMarkets(),void 0!==e&&(r=this.market(e));const a={id:r?r.id:"all"},n=await this.privatePostOpenOrdersId(this.extend(a,i));return this.parseTrades(n,r,t,s)}async fetchOrder(e,t,s={}){throw new n(this.id+" fetchOrder is not implemented yet")}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api+"/"+this.implodeParams(e,i),o=this.omit(i,this.extractParams(e));if("public"===t)Object.keys(o).length&&(n+="?"+this.urlencode(o));else{this.checkRequiredCredentials();const e=this.nonce().toString(),t=e+this.uid+this.apiKey,s=this.encode(this.hmac(this.encode(t),this.encode(this.secret)));o=this.extend({key:this.apiKey,signature:s.toUpperCase(),nonce:e},o),a=this.urlencode(o),r={"Content-Type":"application/x-www-form-urlencoded"}}return{url:n,method:s,body:a,headers:r}}async request(e,t="public",s="GET",i={},r,n){const o=await this.fetch2(e,t,s,i,r,n);if("status"in o&&"error"===o.status)throw new a(this.id+" "+this.json(o));return o}}},9461:(e,t,s)=>{"use strict";const i=s(8819),{BadSymbol:r,ExchangeError:a,ExchangeNotAvailable:n,AuthenticationError:o,InvalidOrder:c,InsufficientFunds:d,OrderNotFound:h,DDoSProtection:u,PermissionDenied:l,AddressPending:f,OnMaintenance:p,BadRequest:m,InvalidAddress:b}=s(3449),{TRUNCATE:g,DECIMAL_PLACES:y}=s(2115),v=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bittrex",name:"Bittrex",countries:["US"],version:"v3",rateLimit:1500,certified:!1,pro:!0,has:{CORS:!1,cancelAllOrders:!0,cancelOrder:!0,createDepositAddress:!0,createMarketOrder:!0,createOrder:!0,fetchBalance:!0,fetchDeposits:!0,fetchDepositAddress:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchMarkets:!0,fetchMyTrades:"emulated",fetchOHLCV:!0,fetchOrder:!0,fetchOrderTrades:!0,fetchOrderBook:!0,fetchOpenOrders:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTransactions:!1,fetchWithdrawals:!0,withdraw:!0},timeframes:{"1m":"MINUTE_1","5m":"MINUTE_5","1h":"HOUR_1","1d":"DAY_1"},hostname:"bittrex.com",urls:{logo:"https://user-images.githubusercontent.com/51840849/87153921-edf53180-c2c0-11ea-96b9-f2a9a95a455b.jpg",api:{public:"https://api.bittrex.com",private:"https://api.bittrex.com"},www:"https://bittrex.com",doc:["https://bittrex.github.io/api/v3"],fees:["https://bittrex.zendesk.com/hc/en-us/articles/115003684371-BITTREX-SERVICE-FEES-AND-WITHDRAWAL-LIMITATIONS","https://bittrex.zendesk.com/hc/en-us/articles/115000199651-What-fees-does-Bittrex-charge-"],referral:"https://bittrex.com/Account/Register?referralCode=1ZE-G0G-M3B"},api:{public:{get:["ping","currencies","currencies/{symbol}","markets","markets/tickers","markets/summaries","markets/{marketSymbol}","markets/{marketSymbol}/summary","markets/{marketSymbol}/orderbook","markets/{marketSymbol}/trades","markets/{marketSymbol}/ticker","markets/{marketSymbol}/candles/{candleInterval}/recent","markets/{marketSymbol}/candles/{candleInterval}/historical/{year}/{month}/{day}","markets/{marketSymbol}/candles/{candleInterval}/historical/{year}/{month}","markets/{marketSymbol}/candles/{candleInterval}/historical/{year}"]},private:{get:["account","account/volume","addresses","addresses/{currencySymbol}","balances","balances/{currencySymbol}","deposits/open","deposits/closed","deposits/ByTxId/{txId}","deposits/{depositId}","orders/closed","orders/open","orders/{orderId}","orders/{orderId}/executions","ping","subaccounts/{subaccountId}","subaccounts","withdrawals/open","withdrawals/closed","withdrawals/ByTxId/{txId}","withdrawals/{withdrawalId}","withdrawals/whitelistAddresses","conditional-orders/{conditionalOrderId}","conditional-orders/closed","conditional-orders/open","transfers/sent","transfers/received","transfers/{transferId}"],post:["addresses","orders","subaccounts","withdrawals","conditional-orders","transfers"],delete:["orders/open","orders/{orderId}","withdrawals/{withdrawalId}","conditional-orders/{conditionalOrderId}"]}},fees:{trading:{tierBased:!0,percentage:!0,maker:.0035,taker:.0035},funding:{tierBased:!1,percentage:!1}},exceptions:{exact:{BAD_REQUEST:m,STARTDATE_OUT_OF_RANGE:m,APISIGN_NOT_PROVIDED:o,INVALID_SIGNATURE:o,INVALID_CURRENCY:a,INVALID_PERMISSION:o,INSUFFICIENT_FUNDS:d,INVALID_CEILING_MARKET_BUY:c,INVALID_FIAT_ACCOUNT:c,INVALID_ORDER_TYPE:c,QUANTITY_NOT_PROVIDED:c,MIN_TRADE_REQUIREMENT_NOT_MET:c,ORDER_NOT_OPEN:h,INVALID_ORDER:c,UUID_INVALID:h,RATE_NOT_PROVIDED:c,INVALID_MARKET:r,WHITELIST_VIOLATION_IP:l,DUST_TRADE_DISALLOWED_MIN_VALUE:c,RESTRICTED_MARKET:r,"We are down for scheduled maintenance, but we’ll be back up shortly.":p},broad:{throttled:u,problem:n}},options:{fetchTicker:{method:"publicGetMarketsMarketSymbolTicker"},fetchTickers:{method:"publicGetMarketsTickers"},parseOrderStatus:!1,hasAlreadyAuthenticatedSuccessfully:!1,tag:{NXT:!0,CRYPTO_NOTE_PAYMENTID:!0,BITSHAREX:!0,RIPPLE:!0,NEM:!0,STELLAR:!0,STEEM:!0},subaccountId:void 0,fetchClosedOrdersFilterBySince:!0},commonCurrencies:{REPV2:"REP"}})}costToPrecision(e,t){return this.decimalToPrecision(t,g,this.markets[e].precision.price,y)}feeToPrecision(e,t){return this.decimalToPrecision(t,g,this.markets[e].precision.price,y)}async fetchMarkets(e={}){const t=await this.publicGetMarkets(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"baseCurrencySymbol"),a=this.safeString(i,"quoteCurrencySymbol"),n=this.safeString(i,"symbol"),o=this.safeCurrencyCode(r),c=this.safeCurrencyCode(a),d=o+"/"+c,h={amount:8,price:this.safeInteger(i,"precision",8)},u="ONLINE"===this.safeString(i,"status");s.push({id:n,symbol:d,base:o,quote:c,baseId:r,quoteId:a,active:u,info:i,precision:h,limits:{amount:{min:this.safeNumber(i,"minTradeSize"),max:void 0},price:{min:1/Math.pow(10,h.price),max:void 0},cost:{min:void 0,max:void 0}}})}return s}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetBalances(e),s={info:t},i=this.indexBy(t,"currencySymbol"),r=Object.keys(i);for(let e=0;e<r.length;e++){const t=r[e],a=this.safeCurrencyCode(t),n=this.account(),o=i[t];n.free=this.safeString(o,"available"),n.total=this.safeString(o,"total"),s[a]=n}return this.parseBalance(s,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={marketSymbol:this.marketId(e)};if(void 0!==t){if(1!==t&&25!==t&&500!==t)throw new m(this.id+" fetchOrderBook() limit argument must be undefined, 1, 25 or 500, default is 25");i.depth=t}const r=await this.publicGetMarketsMarketSymbolOrderbook(this.extend(i,s)),a=this.safeInteger(this.last_response_headers,"Sequence"),n=this.parseOrderBook(r,e,void 0,"bid","ask","rate","quantity");return n.nonce=a,n}async fetchCurrencies(e={}){const t=await this.publicGetCurrencies(e),s={};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"symbol"),a=this.safeCurrencyCode(r),n=8,o=this.safeNumber(i,"txFee"),c=this.safeString(i,"status");s[a]={id:r,code:a,address:this.safeString(i,"baseAddress"),info:i,type:this.safeString(i,"coinType"),name:this.safeString(i,"name"),active:"ONLINE"===c,fee:o,precision:n,limits:{amount:{min:1/Math.pow(10,n),max:void 0},withdraw:{min:o,max:void 0}}}}return s}parseTicker(e,t){const s=this.parse8601(this.safeString(e,"updatedAt")),i=this.safeString(e,"symbol"),r=this.safeSymbol(i,t,"-"),a=this.safeNumber(e,"percentChange"),n=this.safeNumber(e,"lastTradeRate");return{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"bidRate"),bidVolume:void 0,ask:this.safeNumber(e,"askRate"),askVolume:void 0,vwap:void 0,open:void 0,close:n,last:n,previousClose:void 0,change:void 0,percentage:a,average:void 0,baseVolume:this.safeNumber(e,"volume"),quoteVolume:this.safeNumber(e,"quoteVolume"),info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=this.safeValue(this.options,"fetchTickers",{}),i=this.safeString(s,"method","publicGetMarketsTickers"),r=this.safeString(t,"method",i);t=this.omit(t,"method");const a=await this[r](t),n=[];for(let e=0;e<a.length;e++){const t=this.parseTicker(a[e]);n.push(t)}return this.filterByArray(n,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={marketSymbol:s.id},r=this.safeValue(this.options,"fetchTicker",{}),a=this.safeString(r,"method","publicGetMarketsMarketSymbolTicker"),n=this.safeString(t,"method",a);t=this.omit(t,"method");const o=await this[n](this.extend(i,t));return this.parseTicker(o,s)}parseTrade(e,t){const s=this.parse8601(this.safeString(e,"executedAt")),i=this.safeString(e,"id"),r=this.safeString(e,"orderId"),a=this.safeString(e,"marketSymbol");t=this.safeMarket(a,t,"-");const n=this.safeString(e,"rate"),o=this.safeString(e,"quantity"),c=this.parseNumber(n),d=this.parseNumber(o),h=this.parseNumber(v.stringMul(n,o));let u;const l=this.safeValue(e,"isTaker");let f;void 0!==l&&(u=l?"taker":"maker");const p=this.safeNumber(e,"commission");void 0!==p&&(f={cost:p,currency:t.quote});const m=this.safeStringLower(e,"takerSide");return{info:e,timestamp:s,datetime:this.iso8601(s),symbol:t.symbol,id:i,order:r,takerOrMaker:u,type:void 0,side:m,price:c,amount:d,cost:h,fee:f}}async fetchTime(e={}){const t=await this.publicGetPing(e);return this.safeInteger(t,"serverTime")}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={marketSymbol:this.marketId(e)},n=await this.publicGetMarketsMarketSymbolTrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}parseOHLCV(e,t){return[this.parse8601(this.safeString(e,"startsAt")),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n=a.baseId+"-"+a.quoteId,o={candleInterval:this.timeframes[t],marketSymbol:n};let c="publicGetMarketsMarketSymbolCandlesCandleIntervalRecent";if(void 0!==s){const e=this.milliseconds(),i=Math.abs(e-s),r=this.ymd(s).split("-"),a=this.safeInteger(r,0),n=this.safeInteger(r,1),d=this.safeInteger(r,2);"1d"===t?i>316224e5&&(c="publicGetMarketsMarketSymbolCandlesCandleIntervalHistoricalYear",o.year=a):"1h"===t?i>26784e5&&(c="publicGetMarketsMarketSymbolCandlesCandleIntervalHistoricalYearMonth",o.year=a,o.month=n):i>864e5&&(c="publicGetMarketsMarketSymbolCandlesCandleIntervalHistoricalYearMonthDay",o.year=a,o.month=n,o.day=d)}const d=await this[c](this.extend(o,r));return this.parseOHLCVs(d,a,t,s,i)}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.market(e),r.marketSymbol=a.id);const n=await this.privateGetOrdersOpen(this.extend(r,i));return this.parseOrders(n,a,t,s)}async fetchOrderTrades(e,t,s,i,r={}){await this.loadMarkets();const a={orderId:e},n=await this.privateGetOrdersOrderIdExecutions(this.extend(a,r));let o;return void 0!==t&&(o=this.market(t)),this.parseTrades(n,o,s,i)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o=t.toUpperCase(),c={marketSymbol:n.baseId+"-"+n.quoteId,direction:s.toUpperCase(),type:o},d="CEILING_LIMIT"===o,h="CEILING_MARKET"===o;if(d||h){let t;d?(c.limit=this.priceToPrecision(e,r),t=this.safeNumber2(a,"ceiling","cost",i)):h&&(t=this.safeNumber2(a,"ceiling","cost"),void 0===t&&(t=void 0===r?i:i*r)),a=this.omit(a,["ceiling","cost"]),c.ceiling=this.costToPrecision(e,t),c.timeInForce="IMMEDIATE_OR_CANCEL"}else c.quantity=this.amountToPrecision(e,i),"LIMIT"===o?(c.limit=this.priceToPrecision(e,r),c.timeInForce="GOOD_TIL_CANCELLED"):c.timeInForce="IMMEDIATE_OR_CANCEL";const u=await this.privatePostOrders(this.extend(c,a));return this.parseOrder(u,n)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={orderId:e},r=await this.privateDeleteOrdersOrderId(this.extend(i,s));return this.extend(this.parseOrder(r),{id:e,info:r,status:"canceled"})}async cancelAllOrders(e,t={}){await this.loadMarkets();const s={};let i;void 0!==e&&(i=this.market(e),s.marketSymbol=i.id);const r=await this.privateDeleteOrdersOpen(this.extend(s,t)),a=[];for(let e=0;e<r.length;e++){const t=this.safeValue(r[e],"result",{});a.push(t)}return this.parseOrders(a,i)}async fetchDeposits(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.currencySymbol=a.id);const n=await this.privateGetDepositsClosed(this.extend(r,i));return this.parseTransactions(n,a,void 0,s)}async fetchWithdrawals(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.currencySymbol=a.id);const n=await this.privateGetWithdrawalsClosed(this.extend(r,i));return this.parseTransactions(n,a,t,s)}parseTransaction(e,t){const s=this.safeString(e,"id"),i=this.safeNumber(e,"quantity"),r=this.safeString(e,"cryptoAddress"),a=this.safeString(e,"txId"),n=this.parse8601(this.safeString(e,"updatedAt")),o=this.parse8601(this.safeString(e,"createdAt")),c=o||n,d=void 0===o?"deposit":"withdrawal",h=this.safeString(e,"currencySymbol"),u=this.safeCurrencyCode(h,t);let l="pending";if("deposit"===d)l="ok";else{const t=this.safeString(e,"status");"ERROR_INVALID_ADDRESS"===t?l="failed":"CANCELLED"===t?l="canceled":"PENDING"===t?l="pending":("COMPLETED"===t||"AUTHORIZED"===t&&void 0!==a)&&(l="ok")}let f=this.safeNumber(e,"txCost");return void 0===f&&"deposit"===d&&(f=0),{info:e,id:s,currency:u,amount:i,address:r,tag:void 0,status:l,type:d,updated:n,txid:a,timestamp:c,datetime:this.iso8601(c),fee:{currency:u,cost:f}}}parseTimeInForce(e){return this.safeString({GOOD_TIL_CANCELLED:"GTC",IMMEDIATE_OR_CANCEL:"IOC",FILL_OR_KILL:"FOK",POST_ONLY_GOOD_TIL_CANCELLED:"PO"},e,e)}parseOrder(e,t){const s=this.safeString(e,"marketSymbol"),i=(t=this.safeMarket(s,t,"-")).symbol,r=t.quote,a=this.safeStringLower(e,"direction"),n=this.safeString(e,"createdAt"),o=this.safeString(e,"updatedAt"),c=this.safeString(e,"closedAt");let d;void 0!==c?d=this.parse8601(c):o&&(d=this.parse8601(o));const h=this.parse8601(n),u=this.safeStringLower(e,"type"),l=this.safeNumber(e,"quantity"),f=this.safeNumber(e,"limit"),p=this.safeNumber(e,"fillQuantity"),m=this.safeNumber(e,"commission"),b=this.safeNumber(e,"proceeds"),g=this.safeStringLower(e,"status"),y=this.parseTimeInForce(this.safeString(e,"timeInForce")),v="PO"===y;return this.safeOrder({id:this.safeString(e,"id"),clientOrderId:void 0,timestamp:h,datetime:this.iso8601(h),lastTradeTimestamp:d,symbol:i,type:u,timeInForce:y,postOnly:v,side:a,price:f,stopPrice:void 0,cost:b,average:void 0,amount:l,filled:p,remaining:void 0,status:g,fee:{cost:m,currency:r},info:e,trades:void 0})}parseOrders(e,t,s,i,r={}){return this.options.fetchClosedOrdersFilterBySince?super.parseOrders(e,t,s,i,r):super.parseOrders(e,t,void 0,i,r)}parseOrderStatus(e){return this.safeString({CLOSED:"closed",OPEN:"open",CANCELLED:"canceled",CANCELED:"canceled"},e,e)}async fetchOrder(e,t,s={}){let i;await this.loadMarkets();try{const t={orderId:e};i=await this.privateGetOrdersOrderId(this.extend(t,s))}catch(e){if(this.last_json_response){if("UUID_INVALID"===this.safeString(this.last_json_response,"message"))throw new h(this.id+" fetchOrder() error: "+this.last_http_response)}throw e}return this.parseOrder(i)}orderToTrade(e){const t=this.safeInteger2(e,"lastTradeTimestamp","timestamp");return{id:this.safeString(e,"id"),side:this.safeString(e,"side"),order:this.safeString(e,"id"),type:this.safeString(e,"type"),price:this.safeNumber(e,"average"),amount:this.safeNumber(e,"filled"),cost:this.safeNumber(e,"cost"),symbol:this.safeString(e,"symbol"),timestamp:t,datetime:this.iso8601(t),fee:this.safeValue(e,"fee"),info:e,takerOrMaker:void 0}}ordersToTrades(e){const t=[];for(let s=0;s<e.length;s++)t.push(this.orderToTrade(e[s]));return t}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==s&&(r.pageSize=s),void 0!==t&&(r.startDate=this.ymdhms(t,"T")+"Z"),void 0!==e&&(a=this.market(e),r.marketSymbol=a.base+"-"+a.quote);const n=await this.privateGetOrdersClosed(this.extend(r,i)),o=this.parseOrders(n,a),c=this.ordersToTrades(o);return this.filterBySymbolSinceLimit(c,e,t,s)}async fetchClosedOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==s&&(r.pageSize=s),void 0!==t&&(r.startDate=this.ymdhms(t,"T")+"Z"),void 0!==e&&(a=this.market(e),r.marketSymbol=a.base+"-"+a.quote);const n=await this.privateGetOrdersClosed(this.extend(r,i));return this.parseOrders(n,a,t,s)}async createDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e),i={currencySymbol:s.id},r=await this.privatePostAddresses(this.extend(i,t));let a=this.safeString(r,"cryptoAddress");const n=this.safeString(r,"status");if(!a||"REQUESTED"===n)throw new f(this.id+" the address for "+e+" is being generated (pending, not ready yet, retry again later)");let o=this.safeString(r,"cryptoAddressTag");return void 0===o&&s.type in this.options.tag&&(o=a,a=s.address),this.checkAddress(a),{currency:e,address:a,tag:o,info:r}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e),i={currencySymbol:s.id},r=await this.privateGetAddressesCurrencySymbol(this.extend(i,t));let a=this.safeString(r,"cryptoAddress");const n=this.safeString(r,"status");if(!a||"REQUESTED"===n)throw new f(this.id+" the address for "+e+" is being generated (pending, not ready yet, retry again later)");let o=this.safeString(r,"cryptoAddressTag");return void 0===o&&s.type in this.options.tag&&(o=a,a=s.address),this.checkAddress(a),{currency:e,address:a,tag:o,info:r}}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a={currencySymbol:this.currency(e).id,quantity:t,cryptoAddress:s};void 0!==i&&(a.cryptoAddressTag=i);const n=await this.privatePostWithdrawals(this.extend(a,r));return{info:n,id:this.safeString(n,"id")}}sign(e,t="v3",s="GET",i={},r,a){let n=this.implodeParams(this.urls.api[t],{hostname:this.hostname})+"/";if("private"===t){n+=this.version+"/",this.checkRequiredCredentials(),n+=this.implodeParams(e,i),i=this.omit(i,this.extractParams(e));let t="";"POST"===s?t=a=this.json(i):Object.keys(i).length&&(n+="?"+this.rawencode(i));const o=this.hash(this.encode(t),"sha512","hex"),c=this.milliseconds().toString();let d=c+n+s+o;const h=this.safeValue(this.options,"subaccountId");void 0!==h&&(d+=h);const u=this.hmac(this.encode(d),this.encode(this.secret),"sha512");r={"Api-Key":this.apiKey,"Api-Timestamp":c,"Api-Content-Hash":o,"Api-Signature":u},void 0!==h&&(r["Api-Subaccount-Id"]=h),"POST"===s&&(r["Content-Type"]="application/json")}else"public"===t&&(n+=this.version+"/"),n+=this.implodeParams(e,i),i=this.omit(i,this.extractParams(e)),Object.keys(i).length&&(n+="?"+this.urlencode(i));return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,n,c,d,l){if(void 0!==c&&"{"===n[0]){const e=this.id+" "+n;let t=this.safeValue(c,"success");if(void 0===t){const t=this.safeString(c,"code");if(void 0!==t&&(this.throwExactlyMatchedException(this.exceptions.exact,t,e),this.throwBroadlyMatchedException(this.exceptions.broad,t,e)),"NOT_FOUND"===t&&s.indexOf("addresses")>=0)throw new b(e);return}if("string"==typeof t&&(t="true"===t),!t){const t=this.safeString(c,"message");if("APIKEY_INVALID"===t)throw this.options.hasAlreadyAuthenticatedSuccessfully?new u(e):new o(e);if("INVALID_ORDER"===t){const e="cancel";if(s.indexOf(e)>=0){const e=s.split("?");if(e.length>1){const t=e[1].split("&"),s=t.length;let i;for(let e=0;e<s;e++){const s=t[e].split("=");if("uuid"===s[0]){i=s[1];break}}throw new h(void 0!==i?this.id+" cancelOrder "+i+" "+this.json(c):this.id+" cancelOrder "+this.json(c))}}}throw this.throwExactlyMatchedException(this.exceptions.exact,t,e),void 0!==t&&this.throwBroadlyMatchedException(this.exceptions.broad,t,e),new a(e)}}}}},4253:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,BadSymbol:a,AuthenticationError:n,InsufficientFunds:o,InvalidOrder:c,ArgumentsRequired:d,OrderNotFound:h,InvalidAddress:u,BadRequest:l,RateLimitExceeded:f,PermissionDenied:p,ExchangeNotAvailable:m,AccountSuspended:b,OnMaintenance:g}=s(3449),{SIGNIFICANT_DIGITS:y,DECIMAL_PLACES:v,TRUNCATE:w,ROUND:k}=s(2115),S=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bitvavo",name:"Bitvavo",countries:["NL"],rateLimit:500,version:"v2",certified:!0,pro:!0,has:{CORS:!1,publicAPI:!0,privateAPI:!0,cancelAllOrders:!0,cancelOrder:!0,createOrder:!0,editOrder:!0,fetchBalance:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrders:!0,fetchOrderBook:!0,fetchMarkets:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchWithdrawals:!0,withdraw:!0},timeframes:{"1m":"1m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","2h":"2h","4h":"4h","6h":"6h","8h":"8h","12h":"12h","1d":"1d"},urls:{logo:"https://user-images.githubusercontent.com/1294454/83165440-2f1cf200-a116-11ea-9046-a255d09fb2ed.jpg",api:{public:"https://api.bitvavo.com",private:"https://api.bitvavo.com"},www:"https://bitvavo.com/",doc:"https://docs.bitvavo.com/",fees:"https://bitvavo.com/en/fees",referral:"https://bitvavo.com/?a=24F34952F7"},api:{public:{get:["time","markets","assets","{market}/book","{market}/trades","{market}/candles","ticker/price","ticker/book","ticker/24h"]},private:{get:["order","orders","ordersOpen","trades","balance","deposit","depositHistory","withdrawalHistory"],post:["order","withdrawal"],put:["order"],delete:["order","orders"]}},fees:{trading:{tierBased:!0,percentage:!0,taker:.0025,maker:.002,tiers:{taker:[[0,.0025],[5e4,.0024],[1e5,.0022],[25e4,.002],[5e5,.0018],[1e6,.0016],[25e5,.0014],[5e6,.0012],[1e7,.001]],maker:[[0,.002],[5e4,.0015],[1e5,.001],[25e4,6e-4],[5e5,3e-4],[1e6,1e-4],[25e5,-1e-4],[5e6,-3e-4],[1e7,-5e-4]]}}},requiredCredentials:{apiKey:!0,secret:!0},exceptions:{exact:{101:r,102:l,103:f,104:f,105:p,107:m,108:m,109:m,110:l,200:l,201:l,202:l,203:a,204:l,205:l,206:l,210:c,211:c,212:c,213:c,214:c,215:c,216:o,217:c,230:r,231:r,232:l,233:c,234:c,235:r,236:l,240:h,300:n,301:n,302:n,303:n,304:n,305:n,306:n,307:p,308:n,309:n,310:p,311:p,312:p,315:l,317:b,400:r,401:r,402:p,403:p,404:g,405:r,406:l,407:r,408:o,409:u,410:r,411:l,412:u,413:u,414:r},broad:{"start parameter is invalid":l,"symbol parameter is invalid":a,"amount parameter is invalid":c,"orderId parameter is invalid":c}},options:{"BITVAVO-ACCESS-WINDOW":1e4,fetchCurrencies:{expires:1e3}},precisionMode:y,commonCurrencies:{MIOTA:"IOTA"}})}currencyToPrecision(e,t){return this.decimalToPrecision(t,0,this.currencies[e].precision)}amountToPrecision(e,t){return this.decimalToPrecision(t,w,this.markets[e].precision.amount,v)}priceToPrecision(e,t){return t=this.decimalToPrecision(t,k,this.markets[e].precision.price,this.precisionMode),this.decimalToPrecision(t,w,8,v)}async fetchTime(e={}){const t=await this.publicGetTime(e);return this.safeInteger(t,"time")}async fetchMarkets(e={}){const t=await this.publicGetMarkets(e),s=await this.fetchCurrenciesFromCache(e),i=this.indexBy(s,"symbol"),r=[];for(let e=0;e<t.length;e++){const s=t[e],a=this.safeString(s,"market"),n=this.safeString(s,"base"),o=this.safeString(s,"quote"),c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o),h=c+"/"+d,u="trading"===this.safeString(s,"status"),l=this.safeValue(i,n);let f;void 0!==l&&(f=this.safeInteger(l,"decimals",8));const p={price:this.safeInteger(s,"pricePrecision"),amount:f};r.push({id:a,symbol:h,base:c,quote:d,baseId:n,quoteId:o,info:s,active:u,precision:p,limits:{amount:{min:this.safeNumber(s,"minOrderInBaseAsset"),max:void 0},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(s,"minOrderInQuoteAsset"),max:void 0}}})}return r}async fetchCurrenciesFromCache(e={}){const t=this.safeValue(this.options,"fetchCurrencies",{}),s=this.safeInteger(t,"timestamp"),i=this.safeInteger(t,"expires",1e3),r=this.milliseconds();if(void 0===s||r-s>i){const s=await this.publicGetAssets(e);this.options.fetchCurrencies=this.extend(t,{response:s,timestamp:r})}return this.safeValue(this.options.fetchCurrencies,"response")}async fetchCurrencies(e={}){const t=await this.fetchCurrenciesFromCache(e),s={};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"symbol"),a=this.safeCurrencyCode(r),n="OK"===this.safeValue(i,"depositStatus"),o="OK"===this.safeValue(i,"withdrawalStatus"),c=n&&o,d=this.safeString(i,"name"),h=this.safeInteger(i,"decimals",8);s[a]={id:r,info:i,code:a,name:d,active:c,fee:this.safeNumber(i,"withdrawalFee"),precision:h,limits:{amount:{min:void 0,max:void 0},withdraw:{min:this.safeNumber(i,"withdrawalMinAmount"),max:void 0}}}}return s}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={market:s.id},r=await this.publicGetTicker24h(this.extend(i,t));return this.parseTicker(r,s)}parseTicker(e,t){const s=this.safeString(e,"market"),i=this.safeSymbol(s,t,"-"),r=this.safeInteger(e,"timestamp"),a=this.safeNumber(e,"last"),n=this.safeNumber(e,"volume"),o=this.safeNumber(e,"volumeQuote"),c=this.vwap(n,o);let d,h,u;const l=this.safeNumber(e,"open");void 0!==l&&void 0!==a&&(d=a-l,l>0&&(h=d/l*100),u=this.sum(l,a)/2);return{symbol:i,timestamp:r,datetime:this.iso8601(r),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"bid"),bidVolume:this.safeNumber(e,"bidSize"),ask:this.safeNumber(e,"ask"),askVolume:this.safeNumber(e,"askSize"),vwap:c,open:l,close:a,last:a,previousClose:void 0,change:d,percentage:h,average:u,baseVolume:n,quoteVolume:o,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTicker24h(t);return this.parseTickers(s,e)}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={market:r.id};void 0!==s&&(a.limit=s),void 0!==t&&(a.start=t);const n=await this.publicGetMarketTrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}parseTrade(e,t){const s=this.safeString(e,"price"),i=this.safeString(e,"amount"),r=this.parseNumber(s),a=this.parseNumber(i),n=this.parseNumber(S.stringMul(s,i)),o=this.safeInteger(e,"timestamp"),c=this.safeString(e,"side"),d=this.safeString2(e,"id","fillId"),h=this.safeInteger(e,"market"),u=this.safeSymbol(h,t,"-"),l=this.safeValue(e,"taker");let f;void 0!==l&&(f=l?"taker":"maker");const p=this.safeNumber(e,"fee");let m;if(void 0!==p){const t=this.safeString(e,"feeCurrency");m={cost:p,currency:this.safeCurrencyCode(t)}}const b=this.safeString(e,"orderId");return{info:e,id:d,symbol:u,timestamp:o,datetime:this.iso8601(o),order:b,type:void 0,side:c,takerOrMaker:f,price:r,amount:a,cost:n,fee:m}}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={market:this.marketId(e)};void 0!==t&&(i.depth=t);const r=await this.publicGetMarketBook(this.extend(i,s)),a=this.parseOrderBook(r,e);return a.nonce=this.safeInteger(r,"nonce"),a}parseOHLCV(e,t){return[this.safeInteger(e,0),this.safeNumber(e,1),this.safeNumber(e,2),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,5)]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={market:a.id,interval:this.timeframes[t]};if(void 0!==s){const e=this.parseTimeframe(t);n.start=s,void 0===i&&(i=1440),n.end=this.sum(s,i*e*1e3)}void 0!==i&&(n.limit=i);const o=await this.publicGetMarketCandles(this.extend(n,r));return this.parseOHLCVs(o,a,t,s,i)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetBalance(e),s={info:t,timestamp:void 0,datetime:void 0};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"symbol"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(i,"available"),n.used=this.safeString(i,"inOrder"),s[a]=n}return this.parseBalance(s,!1)}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={symbol:this.currency(e).id},i=await this.privateGetDeposit(this.extend(s,t)),r=this.safeString(i,"address"),a=this.safeString(i,"paymentId");return this.checkAddress(r),{currency:e,address:r,tag:a,info:i}}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o={market:n.id,side:s,orderType:t},c="stopLossLimit"===t||"takeProfitLimit"===t,h="stopLoss"===t||"takeProfit"===t;if("market"===t){let t;if(t=void 0!==r?i*r:this.safeNumber2(a,"cost","amountQuote"),void 0!==t){const e=n.precision.price;o.amountQuote=this.decimalToPrecision(t,w,e,this.precisionMode)}else o.amount=this.amountToPrecision(e,i);a=this.omit(a,["cost","amountQuote"])}else if("limit"===t)o.price=this.priceToPrecision(e,r),o.amount=this.amountToPrecision(e,i);else if(h||c){let s=this.safeNumber2(a,"stopPrice","triggerAmount");if(void 0===s){if(c)throw new d(this.id+" createOrder requires a stopPrice parameter for a "+t+" order");if(h){if(void 0===r)throw new d(this.id+" createOrder requires a price argument or a stopPrice parameter for a "+t+" order");s=r}}c&&(o.price=this.priceToPrecision(e,r)),a=this.omit(a,["stopPrice","triggerAmount"]),o.triggerAmount=this.priceToPrecision(e,s),o.triggerType="price",o.amount=this.amountToPrecision(e,i)}const u=await this.privatePostOrder(this.extend(o,a));return this.parseOrder(u,n)}async editOrder(e,t,s,i,r,a,n={}){await this.loadMarkets();const o=this.market(t);let c={};const h=this.safeNumber(n,"amountRemaining");if(n=this.omit(n,"amountRemaining"),void 0!==a&&(c.price=this.priceToPrecision(t,a)),void 0!==r&&(c.amount=this.amountToPrecision(t,r)),void 0!==h&&(c.amountRemaining=this.amountToPrecision(t,h)),c=this.extend(c,n),Object.keys(c).length){c.orderId=e,c.market=o.id;const t=await this.privatePutOrder(this.extend(c,n));return this.parseOrder(t,o)}throw new d(this.id+" editOrder() requires an amount argument, or a price argument, or non-empty params")}async cancelOrder(e,t,s={}){if(void 0===t)throw new d(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={orderId:e,market:i.id},a=await this.privateDeleteOrder(this.extend(r,s));return this.parseOrder(a,i)}async cancelAllOrders(e,t={}){await this.loadMarkets();const s={};let i;void 0!==e&&(i=this.market(e),s.market=i.id);const r=await this.privateDeleteOrders(this.extend(s,t));return this.parseOrders(r,i)}async fetchOrder(e,t,s={}){if(void 0===t)throw new d(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={orderId:e,market:i.id},a=await this.privateGetOrder(this.extend(r,s));return this.parseOrder(a,i)}async fetchOrders(e,t,s,i={}){if(void 0===e)throw new d(this.id+" fetchOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a={market:r.id};void 0!==t&&(a.start=t),void 0!==s&&(a.limit=s);const n=await this.privateGetOrders(this.extend(a,i));return this.parseOrders(n,r,t,s)}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.market(e),r.market=a.id);const n=await this.privateGetOrdersOpen(this.extend(r,i));return this.parseOrders(n,a,t,s)}parseOrderStatus(e){return this.safeString({new:"open",canceled:"canceled",canceledAuction:"canceled",canceledSelfTradePrevention:"canceled",canceledIOC:"canceled",canceledFOK:"canceled",canceledMarketProtection:"canceled",canceledPostOnly:"canceled",filled:"closed",partiallyFilled:"open",expired:"canceled",rejected:"canceled",awaitingTrigger:"open"},e,e)}parseOrder(e,t){const s=this.safeString(e,"orderId"),i=this.safeInteger(e,"created"),r=this.safeString(e,"market"),a=this.safeSymbol(r,t,"-"),n=this.parseOrderStatus(this.safeString(e,"status")),o=this.safeString(e,"side"),c=this.safeString(e,"orderType"),d=this.safeNumber(e,"price"),h=this.safeNumber(e,"amount"),u=this.safeNumber(e,"amountRemaining"),l=this.safeNumber(e,"filledAmount"),f=this.safeNumber(e,"filledAmountQuote");let p;const m=this.safeNumber(e,"feePaid");if(void 0!==m){const t=this.safeString(e,"feeCurrency");p={cost:m,currency:this.safeCurrencyCode(t)}}const b=this.safeValue(e,"fills",[]),g=this.parseTrades(b,t,void 0,void 0,{symbol:a,order:s,side:o,type:c}),y=this.safeString(e,"timeInForce"),v=this.safeValue(e,"postOnly"),w=this.safeNumber(e,"triggerPrice");return this.safeOrder({info:e,id:s,clientOrderId:void 0,timestamp:i,datetime:this.iso8601(i),lastTradeTimestamp:void 0,symbol:a,type:c,timeInForce:y,postOnly:v,side:o,price:d,stopPrice:w,amount:h,cost:f,average:void 0,filled:l,remaining:u,status:n,fee:p,trades:g})}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new d(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a={market:r.id};void 0!==t&&(a.start=t),void 0!==s&&(a.limit=s);const n=await this.privateGetTrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a=this.currency(e),n={symbol:a.id,amount:this.currencyToPrecision(e,t),address:s};void 0!==i&&(n.paymentId=i);const o=await this.privatePostWithdrawal(this.extend(n,r));return this.parseTransaction(o,a)}async fetchWithdrawals(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.symbol=a.id),void 0!==t&&(r.start=t),void 0!==s&&(r.limit=s);const n=await this.privateGetWithdrawalHistory(this.extend(r,i));return this.parseTransactions(n,a,t,s)}async fetchDeposits(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.symbol=a.id),void 0!==t&&(r.start=t),void 0!==s&&(r.limit=s);const n=await this.privateGetDepositHistory(this.extend(r,i));return this.parseTransactions(n,a,t,s)}parseTransactionStatus(e){return this.safeString({awaiting_processing:"pending",awaiting_email_confirmation:"pending",awaiting_bitvavo_inspection:"pending",approved:"pending",sending:"pending",in_mempool:"pending",processed:"pending",completed:"ok",canceled:"canceled"},e,e)}parseTransaction(e,t){const s=this.safeInteger(e,"timestamp"),i=this.safeString(e,"symbol"),r=this.safeCurrencyCode(i,t),a=this.parseTransactionStatus(this.safeString(e,"status")),n=this.safeNumber(e,"amount"),o=this.safeString(e,"address"),c=this.safeString(e,"txId");let d;const h=this.safeNumber(e,"fee");let u;void 0!==h&&(d={cost:h,currency:r}),u="success"in e?"withdrawal":void 0===a?"deposit":"withdrawal";const l=this.safeString(e,"paymentId");return{info:e,id:undefined,txid:c,timestamp:s,datetime:this.iso8601(s),addressFrom:void 0,address:o,addressTo:o,tagFrom:void 0,tag:l,tagTo:l,type:u,amount:n,currency:r,status:a,updated:void 0,fee:d}}sign(e,t="public",s="GET",i={},r,a){const n=this.omit(i,this.extractParams(e));let o="/"+this.version+"/"+this.implodeParams(e,i);const c="GET"===s||"DELETE"===s;if(c&&Object.keys(n).length&&(o+="?"+this.urlencode(n)),"private"===t){this.checkRequiredCredentials();let e="";c||Object.keys(n).length&&(e=a=this.json(n));const t=this.milliseconds().toString(),i=t+s+o+e,d=this.hmac(this.encode(i),this.encode(this.secret)),h=this.safeString(this.options,"BITVAVO-ACCESS-WINDOW","10000");r={"BITVAVO-ACCESS-KEY":this.apiKey,"BITVAVO-ACCESS-SIGNATURE":d,"BITVAVO-ACCESS-TIMESTAMP":t,"BITVAVO-ACCESS-WINDOW":h},c||(r["Content-Type"]="application/json")}return o=this.urls.api[t]+o,{url:o,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0===o)return;const h=this.safeString(o,"errorCode"),u=this.safeString(o,"error");if(void 0!==h){const e=this.id+" "+n;throw this.throwBroadlyMatchedException(this.exceptions.broad,u,e),this.throwExactlyMatchedException(this.exceptions.exact,h,e),new r(e)}}}},6424:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,ExchangeNotAvailable:n,PermissionDenied:o,InvalidOrder:c,AuthenticationError:d,InsufficientFunds:h,OrderNotFound:u,DDoSProtection:l,OnMaintenance:f,RateLimitExceeded:p}=s(3449),m=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bitz",name:"Bit-Z",countries:["HK"],rateLimit:2e3,version:"v2",userAgent:this.userAgents.chrome,has:{cancelOrder:!0,cancelOrders:!0,createOrder:!0,createMarketOrder:!1,fetchBalance:!0,fetchDeposits:!0,fetchClosedOrders:!0,fetchMarkets:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTransactions:!1,fetchWithdrawals:!0,withdraw:!0},timeframes:{"1m":"1min","5m":"5min","15m":"15min","30m":"30min","1h":"60min","4h":"4hour","1d":"1day","5d":"5day","1w":"1week","1M":"1mon"},hostname:"apiv2.bitz.com",urls:{logo:"https://user-images.githubusercontent.com/51840849/87443304-fec5e000-c5fd-11ea-98f8-ba8e67f7eaff.jpg",api:{market:"https://{hostname}",trade:"https://{hostname}",assets:"https://{hostname}"},www:"https://www.bitz.com",doc:"https://apidocv2.bitz.plus/en/",fees:"https://www.bitz.com/fee?type=1",referral:"https://u.bitz.com/register?invite_code=1429193"},api:{market:{get:["ticker","depth","order","tickerall","kline","symbolList","getServerTime","currencyRate","currencyCoinRate","coinRate","getContractCoin","getContractKline","getContractOrderBook","getContractTradesHistory","getContractTickers"]},trade:{post:["addEntrustSheet","cancelEntrustSheet","cancelAllEntrustSheet","coinOut","getUserHistoryEntrustSheet","getUserNowEntrustSheet","getEntrustSheetInfo","depositOrWithdraw","getCoinAddress","getCoinAddressList","marketTrade","addEntrustSheetBatch"]},assets:{post:["getUserAssets"]},contract:{post:["addContractTrade","cancelContractTrade","getContractActivePositions","getContractAccountInfo","getContractMyPositions","getContractOrderResult","getContractTradeResult","getContractOrder","getContractMyHistoryTrade","getContractMyTrades"]}},fees:{trading:{maker:.002,taker:.002},funding:{withdraw:{BTC:"0.5%",DKKT:"0.5%",ETH:.01,USDT:"0.5%",LTC:"0.5%",FCT:"0.5%",LSK:"0.5%",HXI:"0.8%",ZEC:"0.5%",DOGE:"0.5%",MZC:"0.5%",ETC:"0.5%",GXS:"0.5%",XPM:"0.5%",PPC:"0.5%",BLK:"0.5%",XAS:"0.5%",HSR:"0.5%",NULS:5,VOISE:350,PAY:1.5,EOS:.6,YBCT:35,OMG:.3,OTN:.4,BTX:"0.5%",QTUM:"0.5%",DASH:"0.5%",GAME:"0.5%",BCH:"0.5%",GNT:9,SSS:1500,ARK:"0.5%",PART:"0.5%",LEO:"0.5%",DGB:"0.5%",ZSC:130,VIU:350,BTG:"0.5%",ARN:10,VTC:"0.5%",BCD:"0.5%",TRX:200,HWC:"0.5%",UNIT:"0.5%",OXY:"0.5%",MCO:.35,SBTC:"0.5%",BCX:"0.5%",ETF:"0.5%",PYLNT:.4,XRB:"0.5%",ETP:"0.5%"}}},precision:{amount:8,price:8},options:{fetchOHLCVVolume:!0,fetchOHLCVWarning:!0,lastNonceTimestamp:0},commonCurrencies:{BOX:"BOX Token",LEO:"LeoCoin",XRB:"NANO",PXC:"Pixiecoin",VTC:"VoteCoin",TTC:"TimesChain"},exceptions:{"-102":r,"-103":d,"-104":n,"-105":d,"-106":n,"-109":d,"-110":l,"-111":o,"-112":f,"-114":p,"-117":d,"-100015":d,"-100044":r,"-100101":r,"-100201":r,"-100301":r,"-100401":r,"-100302":r,"-100303":r,"-200003":d,"-200005":o,"-200025":n,"-200027":c,"-200028":c,"-200029":c,"-200030":c,"-200031":h,"-200032":r,"-200033":r,"-200034":u,"-200035":u,"-200037":c,"-200038":r,"-200055":u,"-300069":d,"-300101":r,"-300102":c,"-300103":d,"-301001":n}})}async fetchMarkets(e={}){const t=await this.marketGetSymbolList(e),s=this.safeValue(t,"data"),i=Object.keys(s),r=[];for(let e=0;e<i.length;e++){const t=i[e],a=s[t],n=this.safeString(a,"id"),o=this.safeString(a,"coinFrom"),c=this.safeString(a,"coinTo");let d=o.toUpperCase(),h=c.toUpperCase();d=this.safeCurrencyCode(d),h=this.safeCurrencyCode(h);const u=d+"/"+h,l=this.safeString(a,"priceFloat"),f=this.parsePrecision(l),p={amount:this.safeInteger(a,"numberFloat"),price:parseInt(l)},b=this.safeString(a,"minTrade");r.push({info:a,id:t,numericId:n,symbol:u,base:d,quote:h,baseId:o,quoteId:c,active:!0,precision:p,limits:{amount:{min:this.parseNumber(b),max:this.safeNumber(a,"maxTrade")},price:{min:this.parseNumber(f),max:void 0},cost:{min:this.parseNumber(m.stringMul(f,b)),max:void 0}}})}return r}async fetchBalance(e={}){await this.loadMarkets();const t=await this.assetsPostGetUserAssets(e),s=this.safeValue(t.data,"info"),i=this.parseMicrotime(this.safeString(t,"microtime")),r={info:t,timestamp:i,datetime:this.iso8601(i)};for(let e=0;e<s.length;e++){const t=s[e],i=this.safeString(t,"name"),a=this.safeCurrencyCode(i),n=this.account();n.used=this.safeString(t,"lock"),n.total=this.safeString(t,"num"),n.free=this.safeString(t,"over"),r[a]=n}return this.parseBalance(r,!1)}parseTicker(e,t){const s=void 0,i=this.safeString(e,"symbol"),r=this.safeSymbol(i,t,"_"),a=this.safeNumber(e,"now"),n=this.safeNumber(e,"open");let o,c;return void 0!==a&&void 0!==n&&(o=a-n,c=this.sum(a,n)/2),{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"bidPrice"),bidVolume:this.safeNumber(e,"bidQty"),ask:this.safeNumber(e,"askPrice"),askVolume:this.safeNumber(e,"askQty"),vwap:void 0,open:n,close:a,last:a,previousClose:void 0,change:o,percentage:this.safeNumber(e,"priceChange24h"),average:c,baseVolume:this.safeNumber(e,"volume"),quoteVolume:this.safeNumber(e,"quoteVolume"),info:e}}parseMicrotime(e){if(void 0===e)return e;const t=e.split(" "),s=parseFloat(t[0]),i=parseInt(t[1]),r=this.sum(i,s);return parseInt(1e3*r)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.marketGetTicker(this.extend(i,t)),a=this.parseTicker(r.data,s),n=this.parseMicrotime(this.safeString(r,"microtime"));return this.extend(a,{timestamp:n,datetime:this.iso8601(n)})}async fetchTickers(e,t={}){await this.loadMarkets();const s={};if(void 0!==e){const t=this.marketIds(e);s.symbols=t.join(",")}const i=await this.marketGetTickerall(this.extend(s,t)),r=this.safeValue(i,"data"),a=this.parseMicrotime(this.safeString(i,"microtime")),n={},o=Object.keys(r);for(let e=0;e<o.length;e++){const t=o[e];let s,i=r[t];t in this.markets_by_id&&(s=this.markets_by_id[t]),i=this.parseTicker(r[t],s);let c=i.symbol;if(void 0===c)if(void 0!==s)c=s.symbol;else{const[e,s]=t.split("_");c=this.safeCurrencyCode(e)+"/"+this.safeCurrencyCode(s)}void 0!==c&&(n[c]=this.extend(i,{timestamp:a,datetime:this.iso8601(a)}))}return this.filterByArray(n,"symbol",e)}async fetchTime(e={}){const t=await this.marketGetGetServerTime(e);return this.safeTimestamp(t,"time")}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.marketId(e)},r=await this.marketGetDepth(this.extend(i,s)),a=this.safeValue(r,"data"),n=this.parseMicrotime(this.safeString(r,"microtime"));return this.parseOrderBook(a,e,n)}parseTrade(e,t){const s=this.safeString(e,"id"),i=this.safeTimestamp(e,"T");let r;void 0!==t&&(r=t.symbol);const a=this.safeString(e,"p"),n=this.safeString(e,"n"),o=this.parseNumber(a),c=this.parseNumber(n),d=this.parseNumber(m.stringMul(a,n)),h=this.safeString(e,"s");return{timestamp:i,datetime:this.iso8601(i),symbol:r,id:s,order:void 0,type:"limit",side:h,takerOrMaker:void 0,price:o,amount:c,cost:d,fee:void 0,info:e}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id},n=await this.marketGetOrder(this.extend(a,i));return this.parseTrades(n.data,r,t,s)}parseOHLCV(e,t){return[this.safeInteger(e,"time"),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const n=1e3*this.parseTimeframe(t),o=this.market(e),c={symbol:o.id,resolution:this.timeframes[t]};if(void 0!==i)c.size=Math.min(i,300),void 0!==s&&(c.to=this.sum(s,i*n*1e3));else if(void 0!==s)throw new a(this.id+" fetchOHLCV() requires a limit argument if the since argument is specified");const d=await this.marketGetKline(this.extend(c,r)),h=this.safeValue(d,"data",{}),u=this.safeValue(h,"bars",[]);return this.parseOHLCVs(u,o,t,s,i)}parseOrderStatus(e){return this.safeString({0:"open",1:"open",2:"closed",3:"canceled"},e,e)}parseOrder(e,t){const s=this.safeString(e,"id");let i;if(void 0===t){const s=this.safeString(e,"coinFrom"),r=this.safeString(e,"coinTo");if(void 0!==s&&void 0!==r){const e=s+"_"+r;if(e in this.markets_by_id)t=this.safeValue(this.markets_by_id,e);else{i=this.safeCurrencyCode(s)+"/"+this.safeCurrencyCode(r)}}}void 0!==t&&(i=t.symbol);let r=this.safeString(e,"flag");void 0!==r&&(r="sale"===r?"sell":"buy");const a=this.safeNumber(e,"price"),n=this.safeNumber(e,"number"),o=this.safeNumber(e,"numberOver"),c=this.safeNumber(e,"numberDeal");let d=this.safeInteger(e,"timestamp");void 0===d&&(d=this.safeTimestamp(e,"created"));const h=this.safeNumber(e,"orderTotalPrice"),u=this.parseOrderStatus(this.safeString(e,"status"));return this.safeOrder({id:s,clientOrderId:void 0,datetime:this.iso8601(d),timestamp:d,lastTradeTimestamp:void 0,status:u,symbol:i,type:"limit",timeInForce:void 0,postOnly:void 0,side:r,price:a,stopPrice:void 0,cost:h,amount:n,filled:c,remaining:o,trades:void 0,fee:void 0,info:e,average:void 0})}async createOrder(e,t,s,i,a,n={}){if(await this.loadMarkets(),"limit"!==t)throw new r(this.id+" createOrder allows limit orders only");const o=this.market(e),c="buy"===s?"1":"2";if(!this.password)throw new r(this.id+' createOrder() requires you to set exchange.password = "YOUR_TRADING_PASSWORD" (a trade password is NOT THE SAME as your login password)');const d={symbol:o.id,type:c,price:this.priceToPrecision(e,a),number:this.amountToPrecision(e,i),tradePwd:this.password},h=await this.tradePostAddEntrustSheet(this.extend(d,n)),u=this.parseMicrotime(this.safeString(h,"microtime")),l=this.extend({timestamp:u},h.data);return this.parseOrder(l,o)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={entrustSheetId:e};return await this.tradePostCancelEntrustSheet(this.extend(i,s))}async cancelOrders(e,t,s={}){await this.loadMarkets();const i={ids:e.join(",")};return await this.tradePostCancelEntrustSheet(this.extend(i,s))}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={entrustSheetId:e},r=await this.tradePostGetEntrustSheetInfo(this.extend(i,s));return this.parseOrder(r.data)}async fetchOrdersWithMethod(e,t,s,i,r={}){if(void 0===t)throw new a(this.id+" fetchOpenOrders() requires a symbol argument");await this.loadMarkets();const n=this.market(t),o={coinFrom:n.baseId,coinTo:n.quoteId};void 0!==i&&(o.page=1,o.pageSize=i),void 0!==s&&(o.startTime=parseInt(s/1e3));const c=await this[e](this.extend(o,r)),d=this.safeValue(c.data,"data",[]);return this.parseOrders(d,void 0,s,i)}async fetchOrders(e,t,s,i={}){return await this.fetchOrdersWithMethod("tradePostGetUserHistoryEntrustSheet",e,t,s,i)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrdersWithMethod("tradePostGetUserNowEntrustSheet",e,t,s,i)}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrdersWithMethod("tradePostGetUserHistoryEntrustSheet",e,t,s,i)}parseTransactionStatus(e){return this.safeString({1:"pending",2:"pending",3:"pending",4:"ok",5:"canceled"},e,e)}parseTransaction(e,t){let s=this.safeInteger(e,"updated");0===s&&(s=void 0);const i=this.safeString(e,"coin"),r=this.safeCurrencyCode(i,t),a=this.safeStringLower(e,"type"),n=this.parseTransactionStatus(this.safeString(e,"status"));let o;const c=this.safeNumber(e,"network_fee");return void 0!==c&&(o={cost:c,code:r}),{id:this.safeString(e,"id"),txid:this.safeString(e,"txid"),timestamp:s,datetime:this.iso8601(s),address:this.safeString(e,"wallet"),tag:this.safeString(e,"memo"),type:a,amount:this.safeNumber(e,"number"),currency:r,status:n,updated:s,fee:o,info:e}}parseTransactionsByType(e,t,s,i,r){const a=[];for(let s=0;s<t.length;s++){const i=this.parseTransaction(this.extend({type:e},t[s]));a.push(i)}return this.filterByCurrencySinceLimit(a,s,i,r)}parseTransactionType(e){return this.safeInteger({deposit:1,withdrawal:2},e,e)}async fetchDeposits(e,t,s,i={}){return await this.fetchTransactionsForType("deposit",e,t,s,i)}async fetchWithdrawals(e,t,s,i={}){return await this.fetchTransactionsForType("withdrawal",e,t,s,i)}async fetchTransactionsForType(e,t,s,i,r={}){if(void 0===t)throw new a(this.id+" fetchTransactions() requires a currency `code` argument");await this.loadMarkets();const n={coin:this.currency(t).id,type:this.parseTransactionType(e)};void 0!==s&&(n.startTime=parseInt(s/1e3).toString()),void 0!==i&&(n.page=1,n.pageSize=i);const o=await this.tradePostDepositOrWithdraw(this.extend(n,r)),c=this.safeValue(o.data,"data",[]);return this.parseTransactionsByType(e,c,t,s,i)}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a=this.currency(e),n={coin:a.id,number:this.currencyToPrecision(e,t),address:s};void 0!==i&&(n.memo=i);const o=await this.tradePostCoinOut(this.extend(n,r)),c=this.safeValue(o,"data",{});return this.parseTransaction(c,a)}nonce(){const e=this.seconds();return e>this.options.lastNonceTimestamp&&(this.options.lastNonceTimestamp=e,this.options.lastNonce=1e5),this.options.lastNonce=this.sum(this.options.lastNonce,1),this.options.lastNonce}sign(e,t="market",s="GET",i={},r,a){let n,o=this.implodeParams(this.urls.api[t],{hostname:this.hostname})+"/"+this.capitalize(t)+"/"+e;return"market"===t?(n=this.urlencode(i),n.length&&(o+="?"+n)):(this.checkRequiredCredentials(),a=this.rawencode(this.keysort(this.extend({apiKey:this.apiKey,timeStamp:this.seconds(),nonce:this.nonce()},i))),a+="&sign="+this.hash(this.encode(a+this.secret)),r={"Content-type":"application/x-www-form-urlencoded"}),{url:o,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0===o)return;const h=this.safeString(o,"status");if(void 0!==h){const e=this.id+" "+n;if("200"===h){const t=this.safeInteger(o,"data");if(void 0!==t)throw this.throwExactlyMatchedException(this.exceptions,t,e),new r(e);return}throw this.throwExactlyMatchedException(this.exceptions,h,e),new r(e)}}}},5480:(e,t,s)=>{"use strict";const i=s(8819),r=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bl3p",name:"BL3P",countries:["NL","EU"],rateLimit:1e3,version:"1",comment:"An exchange market by BitonicNL",has:{CORS:!1,cancelOrder:!0,createOrder:!0,fetchBalance:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTrades:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/28501752-60c21b82-6feb-11e7-818b-055ee6d0e754.jpg",api:"https://api.bl3p.eu",www:"https://bl3p.eu",doc:["https://github.com/BitonicNL/bl3p-api/tree/master/docs","https://bl3p.eu/api","https://bitonic.nl/en/api"]},api:{public:{get:["{market}/ticker","{market}/orderbook","{market}/trades"]},private:{post:["{market}/money/depth/full","{market}/money/order/add","{market}/money/order/cancel","{market}/money/order/result","{market}/money/orders","{market}/money/orders/history","{market}/money/trades/fetch","GENMKT/money/info","GENMKT/money/deposit_address","GENMKT/money/new_deposit_address","GENMKT/money/wallet/history","GENMKT/money/withdraw"]}},markets:{"BTC/EUR":{id:"BTCEUR",symbol:"BTC/EUR",base:"BTC",quote:"EUR",baseId:"BTC",quoteId:"EUR",maker:.0025,taker:.0025},"LTC/EUR":{id:"LTCEUR",symbol:"LTC/EUR",base:"LTC",quote:"EUR",baseId:"LTC",quoteId:"EUR",maker:.0025,taker:.0025}}})}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostGENMKTMoneyInfo(e),s=this.safeValue(t,"data",{}),i=this.safeValue(s,"wallets"),r={info:s},a=Object.keys(this.currencies);for(let e=0;e<a.length;e++){const t=a[e],s=this.currency(t).id,n=this.safeValue(i,s,{}),o=this.safeValue(n,"available",{}),c=this.safeValue(n,"balance",{}),d=this.account();d.free=this.safeString(o,"value"),d.total=this.safeString(c,"value"),r[t]=d}return this.parseBalance(r,!1)}parseBidAsk(e,t=0,s=1){return[this.safeNumber(e,t)/1e5,this.safeNumber(e,s)/1e8]}async fetchOrderBook(e,t,s={}){const i={market:this.market(e).id},r=await this.publicGetMarketOrderbook(this.extend(i,s)),a=this.safeValue(r,"data");return this.parseOrderBook(a,e,void 0,"bids","asks","price_int","amount_int")}async fetchTicker(e,t={}){const s={market:this.marketId(e)},i=await this.publicGetMarketTicker(this.extend(s,t)),r=this.safeTimestamp(i,"timestamp"),a=this.safeNumber(i,"last");return{symbol:e,timestamp:r,datetime:this.iso8601(r),high:this.safeNumber(i,"high"),low:this.safeNumber(i,"low"),bid:this.safeNumber(i,"bid"),bidVolume:void 0,ask:this.safeNumber(i,"ask"),askVolume:void 0,vwap:void 0,open:void 0,close:a,last:a,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(i.volume,"24h"),quoteVolume:void 0,info:i}}parseTrade(e,t){const s=this.safeString(e,"trade_id"),i=this.safeInteger(e,"date");let a=this.safeString(e,"price_int");a=r.stringDiv(a,"100000");let n=this.safeString(e,"amount_int");n=r.stringDiv(n,"100000000");const o=this.parseNumber(a),c=this.parseNumber(n),d=this.parseNumber(r.stringMul(a,n));let h;return void 0!==t&&(h=t.symbol),{id:s,info:e,timestamp:i,datetime:this.iso8601(i),symbol:h,type:void 0,side:void 0,order:void 0,takerOrMaker:void 0,price:o,amount:c,cost:d,fee:void 0}}async fetchTrades(e,t,s,i={}){const r=this.market(e),a=await this.publicGetMarketTrades(this.extend({market:r.id},i));return this.parseTrades(a.data.trades,r,t,s)}async createOrder(e,t,s,i,r,a={}){const n=this.market(e),o={market:n.id,amount_int:parseInt(1e8*i),fee_currency:n.quote,type:"buy"===s?"bid":"ask"};"limit"===t&&(o.price_int=parseInt(1e5*r));const c=await this.privatePostMarketMoneyOrderAdd(this.extend(o,a));return{info:c,id:this.safeString(c.data,"order_id")}}async cancelOrder(e,t,s={}){const i={order_id:e};return await this.privatePostMarketMoneyOrderCancel(this.extend(i,s))}sign(e,t="public",s="GET",i={},r,a){const n=this.implodeParams(e,i);let o=this.urls.api+"/"+this.version+"/"+n;const c=this.omit(i,this.extractParams(e));if("public"===t)Object.keys(c).length&&(o+="?"+this.urlencode(c));else{this.checkRequiredCredentials();const e=this.nonce();a=this.urlencode(this.extend({nonce:e},c));const t=this.base64ToBinary(this.secret),s=n+"\0"+a,i=this.hmac(this.encode(s),t,"sha512","base64");r={"Content-Type":"application/x-www-form-urlencoded","Rest-Key":this.apiKey,"Rest-Sign":i}}return{url:o,method:s,body:a,headers:r}}}},6147:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,InvalidOrder:a,AuthenticationError:n,ArgumentsRequired:o}=s(3449),c=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"braziliex",name:"Braziliex",countries:["BR"],rateLimit:1e3,has:{cancelOrder:!0,createOrder:!0,fetchBalance:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/34703593-c4498674-f504-11e7-8d14-ff8e44fb78c1.jpg",api:"https://braziliex.com/api/v1",www:"https://braziliex.com/",doc:"https://braziliex.com/exchange/api.php",fees:"https://braziliex.com/exchange/fees.php",referral:"https://braziliex.com/?ref=5FE61AB6F6D67DA885BC98BA27223465"},api:{public:{get:["currencies","ticker","ticker/{market}","orderbook/{market}","tradehistory/{market}"]},private:{post:["balance","complete_balance","open_orders","trade_history","deposit_address","sell","buy","cancel_order","order_status"]}},commonCurrencies:{EPC:"Epacoin",ABC:"Anti Bureaucracy Coin"},fees:{trading:{maker:.005,taker:.005}},precision:{amount:8,price:8},options:{fetchCurrencies:{expires:1e3}}})}async fetchCurrenciesFromCache(e={}){const t=this.safeValue(this.options,"fetchCurrencies",{}),s=this.safeInteger(t,"timestamp"),i=this.safeInteger(t,"expires",1e3),r=this.milliseconds();if(void 0===s||r-s>i){const s=await this.publicGetCurrencies(e);this.options.fetchCurrencies=this.extend(t,{response:s,timestamp:r})}return this.safeValue(this.options.fetchCurrencies,"response")}async fetchCurrencies(e={}){const t=await this.fetchCurrenciesFromCache(e);this.options.currencies={timestamp:this.milliseconds(),response:t};const s=Object.keys(t),i={};for(let e=0;e<s.length;e++){const r=s[e],a=t[r],n=this.safeInteger(a,"decimal"),o=this.safeCurrencyCode(r);let c=1===this.safeInteger(a,"active");0!==this.safeInteger(a,"under_maintenance")&&(c=!1);const d=1===this.safeInteger(a,"is_withdrawal_active"),h=1===this.safeInteger(a,"is_deposit_active");d&&h||(c=!1),i[o]={id:r,code:o,name:a.name,active:c,precision:n,funding:{withdraw:{active:d,fee:this.safeNumber(a,"txWithdrawalFee")},deposit:{active:h,fee:this.safeNumber(a,"txDepositFee")}},limits:{amount:{min:Math.pow(10,-n),max:Math.pow(10,n)},withdraw:{min:this.safeNumber(a,"MinWithdrawal"),max:Math.pow(10,n)},deposit:{min:this.safeNumber(a,"minDeposit"),max:void 0}},info:a}}return i}async fetchMarkets(e={}){const t=await this.fetchCurrenciesFromCache(e),s=await this.publicGetTicker(),i=Object.keys(s),r=[];for(let e=0;e<i.length;e++){const a=i[e],n=s[a],[o,c]=a.split("_"),d=o.toUpperCase(),h=c.toUpperCase(),u=this.safeCurrencyCode(d),l=this.safeCurrencyCode(h),f=u+"/"+l,p=this.safeValue(t,o,{}),m=this.safeValue(t,c,{});let b;b=this.safeInteger(m,"is_fiat",0)?this.safeNumber(p,"minAmountTradeFIAT"):this.safeNumber(p,"minAmountTrade"+h);const g=1===this.safeInteger(n,"active"),y={amount:8,price:8};r.push({id:a,symbol:f,base:u,quote:l,baseId:o,quoteId:c,active:g,precision:y,limits:{amount:{min:Math.pow(10,-y.amount),max:Math.pow(10,y.amount)},price:{min:Math.pow(10,-y.price),max:Math.pow(10,y.price)},cost:{min:b,max:void 0}},info:n})}return r}parseTicker(e,t){let s;void 0!==t&&(s=t.symbol);const i=this.milliseconds(),r=this.safeNumber(e,"last");return{symbol:s,timestamp:i,datetime:this.iso8601(i),high:this.safeNumber(e,"highestBid24"),low:this.safeNumber(e,"lowestAsk24"),bid:this.safeNumber(e,"highestBid"),bidVolume:void 0,ask:this.safeNumber(e,"lowestAsk"),askVolume:void 0,vwap:void 0,open:void 0,close:r,last:r,previousClose:void 0,change:this.safeNumber(e,"percentChange"),percentage:void 0,average:void 0,baseVolume:this.safeNumber(e,"baseVolume24"),quoteVolume:this.safeNumber(e,"quoteVolume24"),info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={market:s.id},r=await this.publicGetTickerMarket(this.extend(i,t));return this.parseTicker(r,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTicker(t),i={},r=Object.keys(s);for(let e=0;e<r.length;e++){const t=r[e],a=this.safeMarket(t);i[a.symbol]=this.parseTicker(s[t],a)}return this.filterByArray(i,"symbol",e)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={market:this.marketId(e)},r=await this.publicGetOrderbookMarket(this.extend(i,s));return this.parseOrderBook(r,e,void 0,"bids","asks","price","amount")}parseTrade(e,t){const s=this.parse8601(this.safeString2(e,"date_exec","date")),i=this.safeString(e,"price"),r=this.safeString(e,"amount"),a=this.parseNumber(i),n=this.parseNumber(r);let o;void 0!==t&&(o=t.symbol);let d=this.safeNumber(e,"total");void 0===d&&(d=this.parseNumber(c.stringMul(i,r)));const h=this.safeString(e,"order_number"),u=this.safeString(e,"type");return{id:this.safeString(e,"_id"),info:e,timestamp:s,datetime:this.iso8601(s),symbol:o,order:h,type:"limit",side:u,takerOrMaker:void 0,price:a,amount:n,cost:d,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={market:r.id},n=await this.publicGetTradehistoryMarket(this.extend(a,i));return this.parseTrades(n,r,t,s)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostCompleteBalance(e),s={info:t},i=Object.keys(t);for(let e=0;e<i.length;e++){const r=i[e],a=t[r],n=this.safeCurrencyCode(r),o=this.account();o.free=this.safeString(a,"available"),o.total=this.safeString(a,"total"),s[n]=o}return this.parseBalance(s,!1)}parseOrder(e,t){const s=this.safeString(e,"market"),i=this.safeSymbol(s,t,"_");let r=this.safeInteger(e,"timestamp");void 0===r&&(r=this.parse8601(this.safeString(e,"date")));const a=this.safeNumber(e,"price"),n=this.safeNumber(e,"total"),o=this.safeNumber(e,"amount"),c=this.safeNumber(e,"progress"),d=o*c,h=this.safeString(e,"order_number"),u=this.safeValue(e,"fee"),l=1===c?"closed":"open",f=this.safeString(e,"type");return this.safeOrder({id:h,clientOrderId:void 0,datetime:this.iso8601(r),timestamp:r,lastTradeTimestamp:void 0,status:l,symbol:i,type:"limit",timeInForce:void 0,postOnly:void 0,side:f,price:a,stopPrice:void 0,cost:n,amount:o,filled:d,remaining:void 0,trades:void 0,fee:u,info:e,average:void 0})}async createOrder(e,t,s,i,r,n={}){await this.loadMarkets();const o=this.market(e),c="privatePost"+this.capitalize(s),d={market:o.id,price:r,amount:i},h=await this[c](this.extend(d,n));if(1!==this.safeInteger(h,"success"))throw new a(this.id+" "+this.json(h));let u=this.safeString(h,"message").split(" / ");u=u.slice(1);const l=u[5].split(" "),f=u[2].split(" "),p=u[3].split(" "),m=u[4].split(" ");return this.parseOrder({timestamp:this.milliseconds(),order_number:h.order_number,type:this.safeStringLower(u,0),market:u[0].toLowerCase(),amount:this.safeString(f,1),price:this.safeString(p,1),total:this.safeString(m,1),fee:{cost:this.safeNumber(l,1),currency:this.safeString(l,2)},progress:"0.0",info:h},o)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={order_number:e,market:this.market(t).id};return await this.privatePostCancelOrder(this.extend(i,s))}async fetchOrder(e,t,s={}){if(void 0===t)throw new o(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={order_number:e,market:i.id},a=await this.privatePostOrderStatus(this.extend(r,s));return this.parseOrder(a,i)}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={market:r.id},n=await this.privatePostOpenOrders(this.extend(a,i)),o=this.safeValue(n,"order_open",[]);return this.parseOrders(o,r,t,s)}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={market:r.id},n=await this.privatePostTradeHistory(this.extend(a,i)),o=this.safeValue(n,"trade_history",[]);return this.parseTrades(o,r,t,s)}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={currency:this.currency(e).id},i=await this.privatePostDepositAddress(this.extend(s,t)),r=this.safeString(i,"deposit_address");this.checkAddress(r);return{currency:e,address:r,tag:this.safeString(i,"payment_id"),info:i}}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api+"/"+t,o=this.omit(i,this.extractParams(e));if("public"===t)n+="/"+this.implodeParams(e,i),Object.keys(o).length&&(n+="?"+this.urlencode(o));else{this.checkRequiredCredentials(),o=this.extend({command:e,nonce:this.nonce()},o),a=this.urlencode(o);const t=this.hmac(this.encode(a),this.encode(this.secret),"sha512");r={"Content-type":"application/x-www-form-urlencoded",Key:this.apiKey,Sign:t}}return{url:n,method:s,body:a,headers:r}}async request(e,t="public",s="GET",i={},a,o){const c=await this.fetch2(e,t,s,i,a,o);if("string"==typeof c&&c.length<1)throw new r(this.id+" returned empty response");if("success"in c){if(0===this.safeInteger(c,"success")){const e=this.safeString(c,"message");if("Invalid APIKey"===e)throw new n(e);throw new r(e)}}return c}}},6492:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,AuthenticationError:a,DDoSProtection:n,InvalidOrder:o,InsufficientFunds:c}=s(3449),d=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"btcalpha",name:"BTC-Alpha",countries:["US"],version:"v1",has:{cancelOrder:!0,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!1,fetchTrades:!0},timeframes:{"1m":"1","5m":"5","15m":"15","30m":"30","1h":"60","4h":"240","1d":"D"},urls:{logo:"https://user-images.githubusercontent.com/1294454/42625213-dabaa5da-85cf-11e8-8f99-aa8f8f7699f0.jpg",api:"https://btc-alpha.com/api",www:"https://btc-alpha.com",doc:"https://btc-alpha.github.io/api-docs",fees:"https://btc-alpha.com/fees/",referral:"https://btc-alpha.com/?r=123788"},api:{public:{get:["currencies/","pairs/","orderbook/{pair_name}/","exchanges/","charts/{pair}/{type}/chart/"]},private:{get:["wallets/","orders/own/","order/{id}/","exchanges/own/","deposits/","withdraws/"],post:["order/","order-cancel/"]}},fees:{trading:{maker:.002,taker:.002},funding:{withdraw:{BTC:.00135,LTC:.0035,XMR:.018,ZEC:.002,ETH:.01,ETC:.01,SIB:1.5,CCRB:4,PZM:.05,ITI:.05,DCY:5,R:5,ATB:.05,BRIA:.05,KZC:.05,HWC:1,SPA:1,SMS:.001,REC:.01,SUP:1,BQ:100,GDS:.1,EVN:300,TRKC:.01,UNI:1,STN:1,BCH:void 0,QBIC:.5}}},commonCurrencies:{CBC:"Cashbery"},exceptions:{exact:{},broad:{"Out of balance":c}}})}async fetchMarkets(e={}){const t=await this.publicGetPairs(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"name"),a=this.safeString(i,"currency1"),n=this.safeString(i,"currency2"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),h=o+"/"+c,u=this.safeString(i,"price_precision"),l=this.parsePrecision(u),f={amount:8,price:parseInt(u)},p=this.safeString(i,"minimum_order_size");s.push({id:r,symbol:h,base:o,quote:c,active:!0,precision:f,limits:{amount:{min:this.parseNumber(p),max:this.safeNumber(i,"maximum_order_size")},price:{min:this.parseNumber(l),max:void 0},cost:{min:this.parseNumber(d.stringMul(l,p)),max:void 0}},info:i,baseId:void 0,quoteId:void 0})}return s}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={pair_name:this.marketId(e)};t&&(i.limit_sell=t,i.limit_buy=t);const r=await this.publicGetOrderbookPairName(this.extend(i,s));return this.parseOrderBook(r,e,void 0,"buy","sell","price","amount")}parseBidsAsks(e,t=0,s=1){const i=[];for(let r=0;r<e.length;r++){const a=e[r];a&&i.push(this.parseBidAsk(a,t,s))}return i}parseTrade(e,t){let s;void 0===t&&(t=this.safeValue(this.markets_by_id,e.pair)),void 0!==t&&(s=t.symbol);const i=this.safeTimestamp(e,"timestamp"),r=this.safeString(e,"price"),a=this.safeString(e,"amount"),n=this.parseNumber(r),o=this.parseNumber(a),c=this.parseNumber(d.stringMul(r,a)),h=this.safeString2(e,"id","tid"),u=this.safeString2(e,"my_side","side"),l=this.safeString(e,"o_id");return{id:h,info:e,timestamp:i,datetime:this.iso8601(i),symbol:s,order:l,type:"limit",side:u,takerOrMaker:void 0,price:n,amount:o,cost:c,fee:void 0}}async fetchTrades(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.market(e),a.pair=r.id),void 0!==s&&(a.limit=s);const n=await this.publicGetExchanges(this.extend(a,i));return this.parseTrades(n,r,t,s)}parseOHLCV(e,t){return[this.safeTimestamp(e,"time"),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}async fetchOHLCV(e,t="5m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={pair:a.id,type:this.timeframes[t]};void 0!==i&&(n.limit=i),void 0!==s&&(n.since=parseInt(s/1e3));const o=await this.publicGetChartsPairTypeChart(this.extend(n,r));return this.parseOHLCVs(o,a,t,s,i)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetWallets(e),s={info:t};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"currency"),a=this.safeCurrencyCode(r),n=this.account();n.used=this.safeString(i,"reserve"),n.total=this.safeString(i,"balance"),s[a]=n}return this.parseBalance(s,!1)}parseOrderStatus(e){return this.safeString({1:"open",2:"canceled",3:"closed"},e,e)}parseOrder(e,t){let s;void 0===t&&(t=this.safeValue(this.markets_by_id,e.pair)),void 0!==t&&(s=t.symbol);const i=this.safeTimestamp(e,"date"),r=this.safeNumber(e,"price"),a=this.safeNumber(e,"amount"),n=this.parseOrderStatus(this.safeString(e,"status")),o=this.safeString2(e,"oid","id");let c=this.safeValue(e,"trades",[]);c=this.parseTrades(c,t);const d=this.safeString2(e,"my_side","type");let h;const u=c.length;if(u>0){h=0;for(let e=0;e<u;e++)h=this.sum(h,c[e].amount)}let l;return void 0!==a&&a>0&&void 0!==h&&(l=Math.max(0,a-h)),{id:o,clientOrderId:void 0,datetime:this.iso8601(i),timestamp:i,status:n,symbol:s,type:"limit",timeInForce:void 0,postOnly:void 0,side:d,price:r,stopPrice:void 0,cost:void 0,amount:a,filled:h,remaining:l,trades:c,fee:void 0,info:e,lastTradeTimestamp:void 0,average:void 0}}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),c={pair:n.id,type:s,amount:i,price:this.priceToPrecision(e,r)},d=await this.privatePostOrder(this.extend(c,a));if(!d.success)throw new o(this.id+" "+this.json(d));const h=this.parseOrder(d,n);return i=h.amount>0?h.amount:i,this.extend(h,{amount:i})}async cancelOrder(e,t,s={}){const i={order:e};return await this.privatePostOrderCancel(this.extend(i,s))}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={id:e},r=await this.privateGetOrderId(this.extend(i,s));return this.parseOrder(r)}async fetchOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.market(e),r.pair=a.id),void 0!==s&&(r.limit=s);const n=await this.privateGetOrdersOwn(this.extend(r,i));return this.parseOrders(n,a,t,s)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({status:"1"},i))}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({status:"3"},i))}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={};if(void 0!==e){const t=this.market(e);r.pair=t.id}void 0!==s&&(r.limit=s);const a=await this.privateGetExchangesOwn(this.extend(r,i));return this.parseTrades(a,void 0,t,s)}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){const n=this.urlencode(this.keysort(this.omit(i,this.extractParams(e))));let o=this.urls.api+"/";if("charts/{pair}/{type}/chart/"!==e&&(o+="v1/"),o+=this.implodeParams(e,i),r={Accept:"application/json"},"public"===t)n.length&&(o+="?"+n);else{this.checkRequiredCredentials();let e=this.apiKey;"POST"===s?(r["Content-Type"]="application/x-www-form-urlencoded",e+=a=n):n.length&&(o+="?"+n),r["X-KEY"]=this.apiKey,r["X-SIGN"]=this.hmac(this.encode(e),this.encode(this.secret)),r["X-NONCE"]=this.nonce().toString()}return{url:o,method:s,body:a,headers:r}}handleErrors(e,t,s,i,o,c,d,h,u){if(void 0===d)return;const l=this.safeString(d,"error"),f=this.id+" "+c;if(void 0!==l&&(this.throwExactlyMatchedException(this.exceptions.exact,l,f),this.throwBroadlyMatchedException(this.exceptions.broad,l,f)),401===e||403===e)throw new a(f);if(429===e)throw new n(f);if(!(e<400))throw new r(f)}}},6142:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,InsufficientFunds:a,InvalidOrder:n,AuthenticationError:o,PermissionDenied:c,InvalidNonce:d,OrderNotFound:h,DDoSProtection:u}=s(3449),l=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"btcbox",name:"BtcBox",countries:["JP"],rateLimit:1e3,version:"v1",has:{cancelOrder:!0,CORS:!1,createOrder:!0,fetchBalance:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTickers:!1,fetchTrades:!0},urls:{logo:"https://user-images.githubusercontent.com/51840849/87327317-98c55400-c53c-11ea-9a11-81f7d951cc74.jpg",api:"https://www.btcbox.co.jp/api",www:"https://www.btcbox.co.jp/",doc:"https://blog.btcbox.jp/en/archives/8762",fees:"https://support.btcbox.co.jp/hc/en-us/articles/360001235694-Fees-introduction"},api:{public:{get:["depth","orders","ticker"]},private:{post:["balance","trade_add","trade_cancel","trade_list","trade_view","wallet"]}},markets:{"BTC/JPY":{id:"btc",symbol:"BTC/JPY",base:"BTC",quote:"JPY",baseId:"btc",quoteId:"jpy",taker:5e-4,maker:5e-4},"ETH/JPY":{id:"eth",symbol:"ETH/JPY",base:"ETH",quote:"JPY",baseId:"eth",quoteId:"jpy",taker:.001,maker:.001},"LTC/JPY":{id:"ltc",symbol:"LTC/JPY",base:"LTC",quote:"JPY",baseId:"ltc",quoteId:"jpy",taker:.001,maker:.001},"BCH/JPY":{id:"bch",symbol:"BCH/JPY",base:"BCH",quote:"JPY",baseId:"bch",quoteId:"jpy",taker:.001,maker:.001}},exceptions:{104:o,105:c,106:d,107:n,200:a,201:n,202:n,203:h,401:h,402:u}})}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostBalance(e),s={info:t},i=Object.keys(this.currencies);for(let e=0;e<i.length;e++){const r=i[e],a=this.currency(r).id,n=a+"_balance";if(n in t){const e=this.account(),i=a+"_lock";e.free=this.safeString(t,n),e.used=this.safeString(t,i),s[r]=e}}return this.parseBalance(s,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),r={};this.symbols.length>1&&(r.coin=i.baseId);const a=await this.publicGetDepth(this.extend(r,s));return this.parseOrderBook(a,e)}parseTicker(e,t){const s=this.milliseconds();let i;void 0!==t&&(i=t.symbol);const r=this.safeNumber(e,"last");return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"buy"),bidVolume:void 0,ask:this.safeNumber(e,"sell"),askVolume:void 0,vwap:void 0,open:void 0,close:r,last:r,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(e,"vol"),quoteVolume:this.safeNumber(e,"volume"),info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={};this.symbols.length>1&&(i.coin=s.baseId);const r=await this.publicGetTicker(this.extend(i,t));return this.parseTicker(r,s)}parseTrade(e,t){const s=this.safeTimestamp(e,"date");let i;void 0!==t&&(i=t.symbol);const r=this.safeString(e,"tid"),a=this.safeString(e,"price"),n=this.safeString(e,"amount"),o=this.parseNumber(a),c=this.parseNumber(n),d=this.parseNumber(l.stringMul(a,n)),h=this.safeString(e,"type");return{info:e,id:r,order:void 0,timestamp:s,datetime:this.iso8601(s),symbol:i,type:undefined,side:h,takerOrMaker:void 0,price:o,amount:c,cost:d,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={};this.symbols.length>1&&(a.coin=r.baseId);const n=await this.publicGetOrders(this.extend(a,i));return this.parseTrades(n,r,t,s)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o={amount:i,price:r,type:s,coin:n.baseId},c=await this.privatePostTradeAdd(this.extend(o,a));return this.parseOrder(c,n)}async cancelOrder(e,t,s={}){await this.loadMarkets(),void 0===t&&(t="BTC/JPY");const i=this.market(t),r={id:e,coin:i.baseId},a=await this.privatePostTradeCancel(this.extend(r,s));return this.parseOrder(a,i)}parseOrderStatus(e){return this.safeString({part:"open",all:"closed",cancelled:"canceled",closed:"closed",no:"closed"},e,e)}parseOrder(e,t){const s=this.safeString(e,"id");let i;void 0!==this.safeString(e,"datetime")&&(i=this.parse8601(e.datetime+"+09:00"));const r=this.safeNumber(e,"amount_original"),a=this.safeNumber(e,"amount_outstanding"),n=this.safeNumber(e,"price");let o=this.parseOrderStatus(this.safeString(e,"status"));void 0===o&&void 0!==a&&0===a&&(o="closed");let c;void 0!==t&&(c=t.symbol);const d=this.safeString(e,"type");return this.safeOrder({id:s,clientOrderId:void 0,timestamp:i,datetime:this.iso8601(i),lastTradeTimestamp:void 0,amount:r,remaining:a,filled:void 0,side:d,type:void 0,timeInForce:void 0,postOnly:void 0,status:o,symbol:c,price:n,stopPrice:void 0,cost:void 0,trades:undefined,fee:void 0,info:e,average:void 0})}async fetchOrder(e,t,s={}){await this.loadMarkets(),void 0===t&&(t="BTC/JPY");const i=this.market(t),r=this.extend({id:e,coin:i.baseId},s),a=await this.privatePostTradeView(this.extend(r,s));return this.parseOrder(a,i)}async fetchOrdersByType(e,t,s,i,r={}){await this.loadMarkets(),void 0===t&&(t="BTC/JPY");const a=this.market(t),n={type:e,coin:a.baseId},o=await this.privatePostTradeList(this.extend(n,r)),c=this.parseOrders(o,a,s,i);if("open"===e)for(let e=0;e<c.length;e++)c[e].status="open";return c}async fetchOrders(e,t,s,i={}){return await this.fetchOrdersByType("all",e,t,s,i)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrdersByType("open",e,t,s,i)}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api+"/"+this.version+"/"+e;if("public"===t)Object.keys(i).length&&(n+="?"+this.urlencode(i));else{this.checkRequiredCredentials();const e=this.nonce().toString(),t=this.extend({key:this.apiKey,nonce:e},i),s=this.urlencode(t),n=this.hash(this.encode(this.secret));t.signature=this.hmac(this.encode(s),this.encode(n)),a=this.urlencode(t),r={"Content-Type":"application/x-www-form-urlencoded"}}return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0===o)return;if(e>=400)return;const h=this.safeValue(o,"result");if(void 0===h||!0===h)return;const u=this.safeValue(o,"code"),l=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions,u,l),new r(l)}async request(e,t="public",s="GET",i={},a,n){let o=await this.fetch2(e,t,s,i,a,n);if("string"==typeof o){if(o=this.strip(o),!this.isJsonEncodedObject(o))throw new r(this.id+" "+o);o=JSON.parse(o)}return o}}},9284:(e,t,s)=>{"use strict";const i=s(8819),{ArgumentsRequired:r,ExchangeError:a,OrderNotFound:n,InvalidOrder:o,InsufficientFunds:c,DDoSProtection:d,BadRequest:h}=s(3449),u=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"btcmarkets",name:"BTC Markets",countries:["AU"],rateLimit:1e3,version:"v3",has:{cancelOrder:!0,cancelOrders:!0,CORS:!1,createOrder:!0,fetchBalance:!0,fetchClosedOrders:"emulated",fetchDeposits:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTime:!0,fetchTrades:!0,fetchTransactions:!0,fetchWithdrawals:!0},urls:{logo:"https://user-images.githubusercontent.com/51840849/89731817-b3fb8480-da52-11ea-817f-783b08aaf32b.jpg",api:{public:"https://api.btcmarkets.net",private:"https://api.btcmarkets.net"},www:"https://btcmarkets.net",doc:["https://api.btcmarkets.net/doc/v3","https://github.com/BTCMarkets/API"]},api:{public:{get:["markets","markets/{marketId}/ticker","markets/{marketId}/trades","markets/{marketId}/orderbook","markets/{marketId}/candles","markets/tickers","markets/orderbooks","time"]},private:{get:["orders","orders/{id}","batchorders/{ids}","trades","trades/{id}","withdrawals","withdrawals/{id}","deposits","deposits/{id}","transfers","transfers/{id}","addresses","withdrawal-fees","assets","accounts/me/trading-fees","accounts/me/withdrawal-limits","accounts/me/balances","accounts/me/transactions","reports/{id}"],post:["orders","batchorders","withdrawals","reports"],delete:["orders","orders/{id}","batchorders/{ids}"],put:["orders/{id}"]}},timeframes:{"1m":"1m","1h":"1h","1d":"1d"},exceptions:{3:o,6:d,InsufficientFund:c,InvalidPrice:o,InvalidAmount:o,MissingArgument:o,OrderAlreadyCancelled:o,OrderNotFound:n,OrderStatusIsFinal:o,InvalidPaginationParameter:h},fees:{percentage:!0,tierBased:!0,maker:-5e-4,taker:.002},options:{fees:{AUD:{maker:.0085,taker:.0085}}}})}async fetchTransactionsWithMethod(e,t,s,i,r={}){await this.loadMarkets();const a={};let n;void 0!==i&&(a.limit=i),void 0!==s&&(a.after=s),void 0!==t&&(n=this.currency(t));const o=await this[e](this.extend(a,r));return this.parseTransactions(o,n,s,i)}async fetchTransactions(e,t,s,i={}){return await this.fetchTransactionsWithMethod("privateGetTransfers",e,t,s,i)}async fetchDeposits(e,t,s,i={}){return await this.fetchTransactionsWithMethod("privateGetDeposits",e,t,s,i)}async fetchWithdrawals(e,t,s,i={}){return await this.fetchTransactionsWithMethod("privateGetWithdrawals",e,t,s,i)}parseTransactionStatus(e){return this.safeString({Complete:"ok"},e,e)}parseTransactionType(e){return this.safeString({Withdraw:"withdrawal",Deposit:"deposit"},e,e)}parseTransaction(e,t){const s=this.parse8601(this.safeString(e,"creationTime")),i=this.parse8601(this.safeString(e,"lastUpdate"));let r=this.parseTransactionType(this.safeStringLower(e,"type"));"withdraw"===r&&(r="withdrawal");const a=this.safeValue(e,"paymentDetail",{}),n=this.safeString(a,"txId");let o,c=this.safeString(a,"address");if(void 0!==c){const e=c.split("?dt=");e.length>1&&(c=e[0],o=e[1])}const d=c,h=o,u=this.safeNumber(e,"fee"),l=this.parseTransactionStatus(this.safeString(e,"status")),f=this.safeString(e,"assetName"),p=this.safeCurrencyCode(f);let m=this.safeNumber(e,"amount");return u&&(m-=u),{id:this.safeString(e,"id"),txid:n,timestamp:s,datetime:this.iso8601(s),address:c,addressTo:d,addressFrom:undefined,tag:o,tagTo:h,tagFrom:undefined,type:r,amount:m,currency:p,status:l,updated:i,fee:{currency:p,cost:u},info:e}}async fetchMarkets(e={}){const t=await this.publicGetMarkets(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"baseAssetName"),a=this.safeString(i,"quoteAssetName"),n=this.safeString(i,"marketId"),o=this.safeCurrencyCode(r),c=this.safeCurrencyCode(a),d=o+"/"+c,h=this.safeValue(this.safeValue(this.options,"fees",{}),c,this.fees),u=this.safeNumber(i,"priceDecimals"),l=this.safeNumber(i,"amountDecimals"),f=this.safeNumber(i,"minOrderAmount"),p=this.safeNumber(i,"maxOrderAmount");let m;"AUD"===c&&(m=Math.pow(10,-u));const b={amount:l,price:u},g={amount:{min:f,max:p},price:{min:m,max:void 0},cost:{min:void 0,max:void 0}};s.push({info:i,id:n,symbol:d,base:o,quote:c,baseId:r,quoteId:a,active:void 0,maker:h.maker,taker:h.taker,limits:g,precision:b})}return s}async fetchTime(e={}){const t=await this.publicGetTime(e);return this.parse8601(this.safeString(t,"timestamp"))}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetAccountsMeBalances(e),s={info:t};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"assetName"),a=this.safeCurrencyCode(r),n=this.account();n.used=this.safeString(i,"locked"),n.total=this.safeString(i,"balance"),s[a]=n}return this.parseBalance(s,!1)}parseOHLCV(e,t){return[this.parse8601(this.safeString(e,0)),this.safeNumber(e,1),this.safeNumber(e,2),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,5)]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={marketId:a.id,timeWindow:this.timeframes[t]};void 0!==s&&(n.from=this.iso8601(s)),void 0!==i&&(n.limit=i);const o=await this.publicGetMarketsMarketIdCandles(this.extend(n,r));return this.parseOHLCVs(o,a,t,s,i)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={marketId:this.market(e).id},r=await this.publicGetMarketsMarketIdOrderbook(this.extend(i,s)),a=this.safeIntegerProduct(r,"snapshotId",.001),n=this.parseOrderBook(r,e,a);return n.nonce=this.safeInteger(r,"snapshotId"),n}parseTicker(e,t){let s;const i=this.safeString(e,"marketId");if(void 0!==i)if(i in this.markets_by_id)t=this.markets_by_id[i];else{const[e,t]=i.split("-");s=this.safeCurrencyCode(e)+"/"+this.safeCurrencyCode(t)}void 0===s&&void 0!==t&&(s=t.symbol);const r=this.parse8601(this.safeString(e,"timestamp")),a=this.safeNumber(e,"lastPrice"),n=this.safeNumber(e,"volume24h"),o=this.safeNumber(e,"volumeQte24h"),c=this.vwap(n,o),d=this.safeNumber(e,"price24h"),h=this.safeNumber(e,"pricePct24h");return{symbol:s,timestamp:r,datetime:this.iso8601(r),high:this.safeNumber(e,"high24h"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"bestBid"),bidVolume:void 0,ask:this.safeNumber(e,"bestAsk"),askVolume:void 0,vwap:c,open:void 0,close:a,last:a,previousClose:void 0,change:d,percentage:h,average:void 0,baseVolume:n,quoteVolume:o,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={marketId:s.id},r=await this.publicGetMarketsMarketIdTicker(this.extend(i,t));return this.parseTicker(r,s)}async fetchTicker2(e,t={}){await this.loadMarkets();const s=this.market(e),i={id:s.id},r=await this.publicGetMarketIdTick(this.extend(i,t));return this.parseTicker(r,s)}parseTrade(e,t){const s=this.parse8601(this.safeString(e,"timestamp")),i=this.safeString(e,"marketId");let r,a,n,o;if(void 0!==i)if(i in this.markets_by_id)t=this.markets_by_id[i];else{const[e,t]=i.split("-");a=this.safeCurrencyCode(e),n=this.safeCurrencyCode(t),r=a+"/"+n}void 0===r&&void 0!==t&&(r=t.symbol,a=t.base,n=t.quote),o="AUD"===n?n:a;let c=this.safeString(e,"side");"Bid"===c?c="buy":"Ask"===c&&(c="sell");const d=this.safeString(e,"id"),h=this.safeString(e,"price"),l=this.safeString(e,"amount"),f=this.parseNumber(h),p=this.parseNumber(l),m=this.parseNumber(u.stringMul(h,l)),b=this.safeString(e,"orderId");let g;const y=this.safeNumber(e,"fee");void 0!==y&&(g={cost:y,currency:o});const v=this.safeStringLower(e,"liquidityType");return{info:e,id:d,timestamp:s,datetime:this.iso8601(s),order:b,symbol:r,type:void 0,side:c,price:f,amount:p,cost:m,takerOrMaker:v,fee:g}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={marketId:r.id},n=await this.publicGetMarketsMarketIdTrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}async createOrder(e,t,s,i,a,n={}){await this.loadMarkets();const o=this.market(e),c={marketId:o.id,amount:this.amountToPrecision(e,i),side:"buy"===s?"Bid":"Ask"},d=t.toLowerCase(),h=this.safeValue(this.options,"orderTypes",{limit:"Limit",market:"Market",stop:"Stop","stop limit":"Stop Limit","take profit":"Take Profit"});c.type=this.safeString(h,d,t);let u=!1,l=!1;if("limit"===d?u=!0:"stop limit"===d?(l=!0,u=!0):("take profit"===d||"stop"===d)&&(l=!0),u){if(void 0===a)throw new r(this.id+" createOrder() requires a price argument for a "+t+"order");c.price=this.priceToPrecision(e,a)}if(l){const s=this.safeNumber(n,"triggerPrice");if(n=this.omit(n,"triggerPrice"),void 0===s)throw new r(this.id+" createOrder() requires a triggerPrice parameter for a "+t+"order");c.triggerPrice=this.priceToPrecision(e,s)}const f=this.safeString(n,"clientOrderId");void 0!==f&&(c.clientOrderId=f),n=this.omit(n,"clientOrderId");const p=await this.privatePostOrders(this.extend(c,n));return this.parseOrder(p,o)}async cancelOrders(e,t,s={}){await this.loadMarkets();for(let t=0;t<e.length;t++)e[t]=parseInt(e[t]);const i={ids:e};return await this.privateDeleteBatchordersIds(this.extend(i,s))}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={id:e};return await this.privateDeleteOrdersId(this.extend(i,s))}calculateFee(e,t,s,i,r,a="taker",n={}){const o=this.markets[e],c=o[a];let d,h;return"AUD"===o.quote?(d=o.quote,h=parseFloat(this.costToPrecision(e,i*r))):(d=o.base,h=parseFloat(this.amountToPrecision(e,i))),{type:a,currency:d,rate:c,cost:parseFloat(this.feeToPrecision(e,c*h))}}parseOrderStatus(e){return this.safeString({Accepted:"open",Placed:"open","Partially Matched":"open","Fully Matched":"closed",Cancelled:"canceled","Partially Cancelled":"canceled",Failed:"rejected"},e,e)}parseOrder(e,t){const s=this.parse8601(this.safeString(e,"creationTime")),i=this.safeString(e,"marketId");let r;if(void 0!==i)if(i in this.markets_by_id)t=this.markets_by_id[i];else{const[e,t]=i.split("-");r=this.safeCurrencyCode(e)+"/"+this.safeCurrencyCode(t)}void 0===r&&void 0!==t&&(r=t.symbol);let a=this.safeString(e,"side");"Bid"===a?a="buy":"Ask"===a&&(a="sell");const n=this.safeStringLower(e,"type"),o=this.safeNumber(e,"price"),c=this.safeNumber(e,"amount"),d=this.safeNumber(e,"openAmount"),h=this.parseOrderStatus(this.safeString(e,"status")),u=this.safeString(e,"orderId"),l=this.safeString(e,"clientOrderId"),f=this.safeString(e,"timeInForce"),p=this.safeNumber(e,"triggerPrice"),m=this.safeValue(e,"postOnly");return this.safeOrder({info:e,id:u,clientOrderId:l,timestamp:s,datetime:this.iso8601(s),lastTradeTimestamp:void 0,symbol:r,type:n,timeInForce:f,postOnly:m,side:a,price:o,stopPrice:p,cost:void 0,amount:c,filled:void 0,remaining:d,average:void 0,status:h,trades:void 0,fee:void 0})}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={id:e},r=await this.privateGetOrdersId(this.extend(i,s));return this.parseOrder(r)}async fetchOrders(e,t,s,i={}){await this.loadMarkets();const r={status:"all"};let a;void 0!==e&&(a=this.market(e),r.marketId=a.id),void 0!==t&&(r.after=t),void 0!==s&&(r.limit=s);const n=await this.privateGetOrders(this.extend(r,i));return this.parseOrders(n,a,t,s)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({status:"open"},i))}async fetchClosedOrders(e,t,s,i={}){const r=await this.fetchOrders(e,t,s,i);return this.filterBy(r,"status","closed")}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.market(e),r.marketId=a.id),void 0!==t&&(r.after=t),void 0!==s&&(r.limit=s);const n=await this.privateGetTrades(this.extend(r,i));return this.parseTrades(n,a,t,s)}lookupSymbolFromMarketId(e){let t,s;if(void 0!==e)if(e in this.markets_by_id)t=this.markets_by_id[e];else{const[t,i]=e.split("-");s=this.safeCurrencyCode(t)+"/"+this.safeCurrencyCode(i)}return void 0===s&&void 0!==t&&(s=t.symbol),s}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n="/"+this.version+"/"+this.implodeParams(e,i);const o=this.keysort(this.omit(i,this.extractParams(e)));if("private"===t){this.checkRequiredCredentials();const e=this.nonce().toString(),t=this.base64ToBinary(this.encode(this.secret));let i=s+n+e;"GET"===s||"DELETE"===s?Object.keys(o).length&&(n+="?"+this.urlencode(o)):i+=a=this.json(o);const c=this.hmac(this.encode(i),t,"sha512","base64");r={Accept:"application/json","Accept-Charset":"UTF-8","Content-Type":"application/json","BM-AUTH-APIKEY":this.apiKey,"BM-AUTH-TIMESTAMP":e,"BM-AUTH-SIGNATURE":c}}else"public"===t&&Object.keys(o).length&&(n+="?"+this.urlencode(o));return{url:this.urls.api[t]+n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,n,o,c,d){if(void 0!==o){if("success"in o&&!o.success){const e=this.safeString(o,"errorCode"),t=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions,e,t),new a(t)}if(e>=400){const e=this.safeString(o,"code"),t=this.safeString(o,"message"),s=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions,e,s),this.throwExactlyMatchedException(this.exceptions,t,s),new a(s)}}}}},233:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a}=s(3449),n=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"btctradeua",name:"BTC Trade UA",countries:["UA"],rateLimit:3e3,has:{cancelOrder:!0,CORS:!1,createMarketOrder:!1,createOrder:!0,fetchBalance:!0,fetchOpenOrders:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTrades:!0,signIn:!0},urls:{referral:"https://btc-trade.com.ua/registration/22689",logo:"https://user-images.githubusercontent.com/1294454/27941483-79fc7350-62d9-11e7-9f61-ac47f28fcd96.jpg",api:"https://btc-trade.com.ua/api",www:"https://btc-trade.com.ua",doc:"https://docs.google.com/document/d/1ocYA0yMy_RXd561sfG3qEPZ80kyll36HUxvCRe5GbhE/edit"},api:{public:{get:["deals/{symbol}","trades/sell/{symbol}","trades/buy/{symbol}","japan_stat/high/{symbol}"]},private:{post:["auth","ask/{symbol}","balance","bid/{symbol}","buy/{symbol}","my_orders/{symbol}","order/status/{id}","remove/order/{id}","sell/{symbol}"]}},markets:{"BCH/UAH":{id:"bch_uah",symbol:"BCH/UAH",base:"BCH",quote:"UAH",baseId:"bch",quoteId:"uah"},"BTC/UAH":{id:"btc_uah",symbol:"BTC/UAH",base:"BTC",quote:"UAH",baseId:"btc",quoteId:"uah",precision:{price:1},limits:{amount:{min:1e-10}}},"DASH/BTC":{id:"dash_btc",symbol:"DASH/BTC",base:"DASH",quote:"BTC",baseId:"dash",quoteId:"btc"},"DASH/UAH":{id:"dash_uah",symbol:"DASH/UAH",base:"DASH",quote:"UAH",baseId:"dash",quoteId:"uah"},"DOGE/BTC":{id:"doge_btc",symbol:"DOGE/BTC",base:"DOGE",quote:"BTC",baseId:"doge",quoteId:"btc"},"DOGE/UAH":{id:"doge_uah",symbol:"DOGE/UAH",base:"DOGE",quote:"UAH",baseId:"doge",quoteId:"uah"},"ETH/UAH":{id:"eth_uah",symbol:"ETH/UAH",base:"ETH",quote:"UAH",baseId:"eth",quoteId:"uah"},"ITI/UAH":{id:"iti_uah",symbol:"ITI/UAH",base:"ITI",quote:"UAH",baseId:"iti",quoteId:"uah"},"KRB/UAH":{id:"krb_uah",symbol:"KRB/UAH",base:"KRB",quote:"UAH",baseId:"krb",quoteId:"uah"},"LTC/BTC":{id:"ltc_btc",symbol:"LTC/BTC",base:"LTC",quote:"BTC",baseId:"ltc",quoteId:"btc"},"LTC/UAH":{id:"ltc_uah",symbol:"LTC/UAH",base:"LTC",quote:"UAH",baseId:"ltc",quoteId:"uah"},"NVC/BTC":{id:"nvc_btc",symbol:"NVC/BTC",base:"NVC",quote:"BTC",baseId:"nvc",quoteId:"btc"},"NVC/UAH":{id:"nvc_uah",symbol:"NVC/UAH",base:"NVC",quote:"UAH",baseId:"nvc",quoteId:"uah"},"PPC/BTC":{id:"ppc_btc",symbol:"PPC/BTC",base:"PPC",quote:"BTC",baseId:"ppc",quoteId:"btc"},"SIB/UAH":{id:"sib_uah",symbol:"SIB/UAH",base:"SIB",quote:"UAH",baseId:"sib",quoteId:"uah"},"XMR/UAH":{id:"xmr_uah",symbol:"XMR/UAH",base:"XMR",quote:"UAH",baseId:"xmr",quoteId:"uah"},"ZEC/UAH":{id:"zec_uah",symbol:"ZEC/UAH",base:"ZEC",quote:"UAH",baseId:"zec",quoteId:"uah"}},fees:{trading:{maker:.001,taker:.001},funding:{withdraw:{BTC:6e-4,LTC:.01,NVC:.01,DOGE:10}}}})}async signIn(e={}){return await this.privatePostAuth(e)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostBalance(e),s={info:t},i=this.safeValue(t,"accounts");for(let e=0;e<i.length;e++){const t=i[e],r=this.safeString(t,"currency"),a=this.safeCurrencyCode(r),n=this.account();n.total=this.safeString(t,"balance"),s[a]=n}return this.parseBalance(s,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.market(e).id},r=await this.publicGetTradesBuySymbol(this.extend(i,s)),a=await this.publicGetTradesSellSymbol(this.extend(i,s)),n={bids:[],asks:[]};return r&&"list"in r&&(n.bids=r.list),a&&"list"in a&&(n.asks=a.list),this.parseOrderBook(n,e,void 0,"bids","asks","price","currency_trade")}async fetchTicker(e,t={}){await this.loadMarkets();const s={symbol:this.marketId(e)},i=await this.publicGetJapanStatHighSymbol(this.extend(s,t)),r=this.safeValue(i,"trades"),a=this.milliseconds(),n={symbol:e,timestamp:a,datetime:this.iso8601(a),high:void 0,low:void 0,bid:void 0,bidVolume:void 0,ask:void 0,askVolume:void 0,vwap:void 0,open:void 0,close:void 0,last:void 0,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:void 0,quoteVolume:void 0,info:r},o=r.length;if(o>0){for(let e=Math.max(o-48,0);e<r.length;e++){const t=r[e];void 0===n.open&&(n.open=t[1]),(void 0===n.high||n.high<t[2])&&(n.high=t[2]),(void 0===n.low||n.low>t[3])&&(n.low=t[3]),void 0===n.baseVolume?n.baseVolume=-t[5]:n.baseVolume-=t[5]}const e=o-1;n.last=r[e][4],n.close=n.last,n.baseVolume=-1*n.baseVolume}return n}convertCyrillicMonthNameToString(e){return this.safeString({января:"01",февраля:"02",марта:"03",апреля:"04",мая:"05",июня:"06",июля:"07",августа:"08",сентября:"09",октября:"10",ноября:"11",декабря:"12"},e)}parseCyrillicDatetime(e){const t=e.split(" ");let s=t[0];const i=this.convertCyrillicMonthNameToString(t[1]);if(!i)throw new r(this.id+" parseTrade() undefined month name: "+e);const a=t[2];let n=t[4];7===n.length&&(n="0"+n),1===s.length&&(s="0"+s);const o=[a,i,s].join("-")+"T"+n,c=this.parse8601(o);let d=[i,s].join("");return d=parseInt(d),d<325||d>1028?c-72e5:c-108e5}parseTrade(e,t){const s=this.parseCyrillicDatetime(this.safeString(e,"pub_date")),i=this.safeString(e,"id"),r=this.safeString(e,"type"),a=this.safeString(e,"price"),o=this.safeString(e,"amnt_trade"),c=this.parseNumber(a),d=this.parseNumber(o),h=this.parseNumber(n.stringMul(a,o));let u;return void 0!==t&&(u=t.symbol),{id:i,info:e,timestamp:s,datetime:this.iso8601(s),symbol:u,type:"limit",side:r,order:void 0,takerOrMaker:void 0,price:c,amount:d,cost:h,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id},n=await this.publicGetDealsSymbol(this.extend(a,i)),o=[];for(let e=0;e<n.length;e++)n[e].id%2&&o.push(n[e]);return this.parseTrades(o,r,t,s)}async createOrder(e,t,s,i,a,n={}){if("market"===t)throw new r(this.id+" allows limit orders only");await this.loadMarkets();const o=this.market(e),c="privatePost"+this.capitalize(s)+"Id",d={count:i,currency1:o.quoteId,currency:o.baseId,price:a};return this[c](this.extend(d,n))}async cancelOrder(e,t,s={}){const i={id:e};return await this.privatePostRemoveOrderId(this.extend(i,s))}parseOrder(e,t){const s=this.milliseconds();let i;return void 0!==t&&(i=t.symbol),{id:this.safeString(e,"id"),clientOrderId:void 0,timestamp:s,datetime:this.iso8601(s),lastTradeTimestamp:void 0,status:"open",symbol:i,type:void 0,timeInForce:void 0,postOnly:void 0,side:this.safeString(e,"type"),price:this.safeNumber(e,"price"),stopPrice:void 0,amount:this.safeNumber(e,"amnt_trade"),filled:0,remaining:this.safeNumber(e,"amnt_trade"),trades:void 0,info:e,cost:void 0,average:void 0,fee:void 0}}async fetchOpenOrders(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchOpenOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),n={symbol:r.id},o=await this.privatePostMyOrdersSymbol(this.extend(n,i)),c=this.safeValue(o,"your_open_orders");return this.parseOrders(c,r,t,s)}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if("public"===t)Object.keys(o).length&&(n+=this.implodeParams(e,o));else{this.checkRequiredCredentials();const e=this.nonce(),t=(a=this.urlencode(this.extend({out_order_id:e,nonce:e},o)))+this.secret;r={"public-key":this.apiKey,"api-sign":this.hash(this.encode(t),"sha256"),"Content-Type":"application/x-www-form-urlencoded"}}return{url:n,method:s,body:a,headers:r}}}},1899:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,InsufficientFunds:a,InvalidOrder:n}=s(3449),o=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"btcturk",name:"BTCTurk",countries:["TR"],rateLimit:1e3,has:{cancelOrder:!0,CORS:!0,createOrder:!0,fetchBalance:!0,fetchMarkets:!0,fetchOHLCV:!0,fetchOrderBook:!0,fetchOpenOrders:!0,fetchOrders:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchMyTrades:!0},timeframes:{"1d":"1d"},urls:{logo:"https://user-images.githubusercontent.com/51840849/87153926-efbef500-c2c0-11ea-9842-05b63612c4b9.jpg",api:{public:"https://api.btcturk.com/api/v2",private:"https://api.btcturk.com/api/v1",graph:"https://graph-api.btcturk.com/v1"},www:"https://www.btcturk.com",doc:"https://github.com/BTCTrader/broker-api-docs"},api:{public:{get:["orderbook","ticker","trades","server/exchangeinfo"]},private:{get:["users/balances","openOrders","allOrders","users/transactions/trade"],post:["order","cancelOrder"],delete:["order"]},graph:{get:["ohlcs"]}},fees:{trading:{maker:.00236,taker:.003*1.18}},exceptions:{exact:{FAILED_ORDER_WITH_OPEN_ORDERS:a,FAILED_LIMIT_ORDER:n,FAILED_MARKET_ORDER:n}}})}async fetchMarkets(e={}){const t=await this.publicGetServerExchangeinfo(e),s=this.safeValue(t,"data"),i=this.safeValue(s,"symbols",[]),r=[];for(let e=0;e<i.length;e++){const t=i[e],s=this.safeString(t,"name"),a=this.safeString(t,"numerator"),n=this.safeString(t,"denominator"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d=o+"/"+c,h=this.safeValue(t,"filters");let u,l,f,p,m;for(let e=0;e<h.length;e++){const t=h[e];"PRICE_FILTER"===this.safeString(t,"filterType")&&(u=this.safeNumber(t,"minPrice"),l=this.safeNumber(t,"maxPrice"),f=this.safeNumber(t,"minAmount"),p=this.safeNumber(t,"maxAmount"),m=this.safeNumber(t,"minExchangeValue"))}const b="TRADING"===this.safeString(t,"status"),g={price:{min:u,max:l},amount:{min:f,max:p},cost:{min:m,max:void 0}},y={price:this.safeInteger(t,"denominatorScale"),amount:this.safeInteger(t,"numeratorScale")};r.push({info:t,symbol:d,id:s,base:o,quote:c,baseId:a,quoteId:n,limits:g,precision:y,active:b})}return r}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetUsersBalances(e),s=this.safeValue(t,"data",[]),i={info:t,timestamp:void 0,datetime:void 0};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"asset"),a=this.safeCurrencyCode(r),n=this.account();n.total=this.safeString(t,"balance"),n.free=this.safeString(t,"free"),n.used=this.safeString(t,"locked"),i[a]=n}return this.parseBalance(i,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={pairSymbol:this.market(e).id},r=await this.publicGetOrderbook(this.extend(i,s)),a=this.safeValue(r,"data"),n=this.safeInteger(a,"timestamp");return this.parseOrderBook(a,e,n,"bids","asks",0,1)}parseTicker(e,t){const s=this.safeString(e,"pair"),i=this.safeSymbol(s,t),r=this.safeInteger(e,"timestamp"),a=this.safeNumber(e,"last");return{symbol:i,timestamp:r,datetime:this.iso8601(r),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"bid"),bidVolume:void 0,ask:this.safeNumber(e,"ask"),askVolume:void 0,vwap:void 0,open:this.safeNumber(e,"open"),close:a,last:a,previousClose:void 0,change:this.safeNumber(e,"daily"),percentage:this.safeNumber(e,"dailyPercent"),average:this.safeNumber(e,"average"),baseVolume:this.safeNumber(e,"volume"),quoteVolume:void 0,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTicker(t),i=this.safeValue(s,"data");return this.parseTickers(i,e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=await this.fetchTickers([e],t);return this.safeValue(s,e)}parseTrade(e,t){const s=this.safeInteger2(e,"date","timestamp"),i=this.safeString2(e,"tid","id"),r=this.safeString(e,"orderId"),a=this.safeString(e,"price"),n=o.stringAbs(this.safeString(e,"amount")),c=this.parseNumber(a),d=this.parseNumber(n),h=this.parseNumber(o.stringMul(a,n)),u=this.safeString(e,"pair"),l=this.safeSymbol(u,t),f=this.safeString2(e,"side","orderType");let p;const m=this.safeString(e,"fee");if(void 0!==m){const t=this.safeString(e,"denominatorSymbol");p={cost:this.parseNumber(o.stringAbs(m)),currency:this.safeCurrencyCode(t)}}return{info:e,id:i,order:r,timestamp:s,datetime:this.iso8601(s),symbol:l,type:void 0,side:f,takerOrMaker:void 0,price:c,amount:d,cost:h,fee:p}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={pairSymbol:r.id};void 0!==s&&(a.last=s);const n=await this.publicGetTrades(this.extend(a,i)),o=this.safeValue(n,"data");return this.parseTrades(o,r,t,s)}parseOHLCV(e,t){return[this.safeTimestamp(e,"time"),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}async fetchOHLCV(e,t="1d",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={pair:a.id};void 0!==i&&(n.last=i);const o=await this.graphGetOhlcs(this.extend(n,r));return this.parseOHLCVs(o,a,t,s,i)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o={orderType:s,orderMethod:t,pairSymbol:n.id,quantity:this.amountToPrecision(e,i)};"market"!==t&&(o.price=this.priceToPrecision(e,r)),"clientOrderId"in a?o.newClientOrderId=a.clientOrderId:"newClientOrderId"in a||(o.newClientOrderId=this.uuid());const c=await this.privatePostOrder(this.extend(o,a)),d=this.safeValue(c,"data");return this.parseOrder(d,n)}async cancelOrder(e,t,s={}){const i={id:e};return await this.privateDeleteOrder(this.extend(i,s))}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.market(e),r.pairSymbol=a.id);const n=await this.privateGetOpenOrders(this.extend(r,i)),o=this.safeValue(n,"data"),c=this.safeValue(o,"bids",[]),d=this.safeValue(o,"asks",[]);return this.parseOrders(this.arrayConcat(c,d),a,t,s)}async fetchOrders(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={pairSymbol:r.id};void 0!==s&&(a.last=s),void 0!==t&&(a.startTime=Math.floor(t/1e3));const n=await this.privateGetAllOrders(this.extend(a,i)),o=this.safeValue(n,"data");return this.parseOrders(o,r,t,s)}parseOrderStatus(e){return this.safeString({Untouched:"open",Partial:"open",Canceled:"canceled",Closed:"closed"},e,e)}parseOrder(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"price"),r=new o(i);let a;"0"===r.toString()||(a=this.parseNumber(r));const n=this.safeString(e,"quantity"),c=this.parseNumber(o.stringAbs(n)),d=this.safeNumber(e,"leftAmount"),h=this.safeNumber(e,"pairSymbol"),u=this.safeSymbol(h,t),l=this.safeString(e,"type"),f=this.safeString(e,"method"),p=this.safeString(e,"orderClientId"),m=this.safeInteger2(e,"updateTime","datetime"),b=this.safeString(e,"status"),g=this.parseOrderStatus(b);return this.safeOrder({info:e,id:s,price:a,amount:c,remaining:d,filled:void 0,cost:void 0,average:void 0,status:g,side:l,type:f,clientOrderId:p,timestamp:m,datetime:this.iso8601(m),symbol:u,fee:void 0})}async fetchMyTrades(e,t,s,i={}){let r;await this.loadMarkets(),void 0!==e&&(r=this.market(e));const a=await this.privateGetUsersTransactionsTrade(),n=this.safeValue(a,"data");return this.parseTrades(n,r,t,s)}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},a,n){if("btctrader"===this.id)throw new r(this.id+" is an abstract base API for BTCExchange, BTCTurk");let o=this.urls.api[t]+"/"+e;if("GET"===s||"DELETE"===s?Object.keys(i).length&&(o+="?"+this.urlencode(i)):n=this.json(i),"private"===t){this.checkRequiredCredentials();const e=this.nonce().toString(),t=this.base64ToBinary(this.secret),s=this.apiKey+e;a={"X-PCK":this.apiKey,"X-Stamp":e,"X-Signature":this.hmac(this.encode(s),t,"sha256","base64"),"Content-Type":"application/json"}}return{url:o,method:s,body:n,headers:a}}handleErrors(e,t,s,i,a,n,o,c,d){const h=this.safeString(o,"code","0"),u=this.safeString(o,"message"),l=void 0===u?n:u;if(this.throwExactlyMatchedException(this.exceptions.exact,u,this.id+" "+l),"0"!==h)throw new r(this.id+" "+l)}}},4875:(e,t,s)=>{"use strict";const i=s(8819),{AddressPending:r,AuthenticationError:a,ExchangeError:n,NotSupported:o,PermissionDenied:c,ArgumentsRequired:d}=s(3449),h=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"buda",name:"Buda",countries:["AR","CL","CO","PE"],rateLimit:1e3,version:"v2",has:{cancelOrder:!0,CORS:!1,createDepositAddress:!0,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchFundingFees:!0,fetchMarkets:!0,fetchMyTrades:!1,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTrades:!0,fetchTicker:!0,fetchWithdrawals:!0,withdraw:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/47380619-8a029200-d706-11e8-91e0-8a391fe48de3.jpg",api:"https://www.buda.com/api",www:"https://www.buda.com",doc:"https://api.buda.com",fees:"https://www.buda.com/comisiones"},status:{status:"error",updated:void 0,eta:void 0,url:void 0},api:{public:{get:["pairs","markets","currencies","markets/{market}","markets/{market}/ticker","markets/{market}/volume","markets/{market}/order_book","markets/{market}/trades","currencies/{currency}/fees/deposit","currencies/{currency}/fees/withdrawal","tv/history"],post:["markets/{market}/quotations"]},private:{get:["balances","balances/{currency}","currencies/{currency}/balances","orders","orders/{id}","markets/{market}/orders","deposits","currencies/{currency}/deposits","withdrawals","currencies/{currency}/withdrawals","currencies/{currency}/receive_addresses","currencies/{currency}/receive_addresses/{id}"],post:["markets/{market}/orders","currencies/{currency}/deposits","currencies/{currency}/withdrawals","currencies/{currency}/simulated_withdrawals","currencies/{currency}/receive_addresses"],put:["orders/{id}"]}},timeframes:{"1m":"1","5m":"5","30m":"30","1h":"60","2h":"120","1d":"D","1w":"W"},fees:{trading:{tierBased:!0,percentage:!0,taker:.008,maker:.004,tiers:{taker:[[0,.008],[2e3,.007],[2e4,.006],[1e5,.005],[5e5,.004],[25e5,.003],[125e5,.002]],maker:[[0,.004],[2e3,.0035],[2e4,.003],[1e5,.0025],[5e5,.002],[25e5,.0015],[125e5,.001]]}}},exceptions:{not_authorized:a,forbidden:c,invalid_record:n,not_found:n,parameter_missing:n,bad_parameter:n}})}async fetchCurrencyInfo(e,t){if(!t){const e=await this.publicGetCurrencies();t=this.safeValue(e,"currencies")}for(let s=0;s<t.length;s++){const i=t[s];if(i.id===e)return i}}async fetchMarkets(e={}){const t=await this.publicGetMarkets(e),s=this.safeValue(t,"markets"),i=await this.publicGetCurrencies(),r=this.safeValue(i,"currencies"),a=[];for(let e=0;e<s.length;e++){const t=s[e],i=this.safeString(t,"id"),n=this.safeString(t,"base_currency"),o=this.safeString(t,"quote_currency"),c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o),h=await this.fetchCurrencyInfo(n,r),u=await this.fetchCurrencyInfo(o,r),l=c+"/"+d,f=this.safeString(u,"input_decimals"),p=this.parsePrecision(f),m={amount:this.safeInteger(h,"input_decimals"),price:parseInt(f)},b=this.safeValue(t,"minimum_order_amount",[]),g={amount:{min:this.safeNumber(b,0),max:void 0},price:{min:p,max:void 0},cost:{min:void 0,max:void 0}};a.push({id:i,symbol:l,base:c,quote:d,baseId:n,quoteId:o,active:!0,precision:m,limits:g,info:t})}return a}async fetchCurrencies(e={}){const t=(await this.publicGetCurrencies()).currencies,s={};for(let e=0;e<t.length;e++){const i=t[e];if(!i.managed)continue;const r=this.safeString(i,"id"),a=this.safeCurrencyCode(r),n=this.safeNumber(i,"input_decimals"),o=Math.pow(10,-n);s[a]={id:r,code:a,info:i,name:void 0,active:!0,fee:void 0,precision:n,limits:{amount:{min:o,max:void 0},deposit:{min:parseFloat(i.deposit_minimum[0]),max:void 0},withdraw:{min:parseFloat(i.withdrawal_minimum[0])}}}}return s}async fetchFundingFees(e,t={}){await this.loadMarkets();const s={},i={},r={};void 0===e&&(e=Object.keys(this.currencies));for(let t=0;t<e.length;t++){const a=e[t],n={currency:this.currency(a).id},o=await this.publicGetCurrenciesCurrencyFeesWithdrawal(n),c=await this.publicGetCurrenciesCurrencyFeesDeposit(n);s[a]=this.parseFundingFee(o.fee),i[a]=this.parseFundingFee(c.fee),r[a]={withdraw:o,deposit:c}}return{withdraw:s,deposit:i,info:r}}parseFundingFee(e,t){return void 0===t&&(t=e.name),"withdrawal"===t&&(t="withdraw"),{type:t,currency:e.base[1],rate:e.percent,cost:parseFloat(e.base[0])}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={market:s.id},r=await this.publicGetMarketsMarketTicker(this.extend(i,t)),a=this.safeValue(r,"ticker");return this.parseTicker(a,s)}parseTicker(e,t){const s=this.milliseconds();let i;void 0!==t&&(i=t.symbol);const r=parseFloat(e.last_price[0]),a=parseFloat(e.price_variation_24h),n=parseFloat(this.priceToPrecision(i,r/(a+1))),o=r-n,c=this.sum(r,n)/2;return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:void 0,low:void 0,bid:parseFloat(e.max_bid[0]),bidVolume:void 0,ask:parseFloat(e.min_ask[0]),askVolume:void 0,vwap:void 0,open:n,close:r,last:r,previousClose:n,change:o,percentage:100*a,average:c,baseVolume:parseFloat(e.volume[0]),quoteVolume:void 0,info:e}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={market:r.id};void 0!==s&&(a.limit=s);const n=await this.publicGetMarketsMarketTrades(this.extend(a,i));return this.parseTrades(n.trades.entries,r,t,s)}parseTrade(e,t){let s,i;let r,a,n;let o;t&&(o=t.symbol),Array.isArray(e)&&(s=this.safeInteger(e,0),r=this.safeString(e,1),a=this.safeString(e,2),i=this.safeString(e,3),n=this.safeString(e,4));const c=this.parseNumber(r),d=this.parseNumber(a),u=this.parseNumber(h.stringMul(r,a));return{id:n,order:undefined,info:e,timestamp:s,datetime:this.iso8601(s),symbol:o,type:undefined,side:i,takerOrMaker:void 0,price:c,amount:d,cost:u,fee:undefined}}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={market:this.market(e).id},r=await this.publicGetMarketsMarketOrderBook(this.extend(i,s)),a=this.safeValue(r,"order_book");return this.parseOrderBook(a,e)}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e);void 0===s&&(s=this.milliseconds()-864e5);const n={symbol:a.id,resolution:this.timeframes[t],from:s/1e3,to:this.seconds()},o=await this.publicGetTvHistory(this.extend(n,r));return this.parseTradingViewOHLCV(o,a,t,s,i)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetBalances(e),s={info:t},i=this.safeValue(t,"balances");for(let e=0;e<i.length;e++){const t=i[e],r=this.safeString(t,"id"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(t.available_amount,0),n.total=this.safeString(t.amount,0),s[a]=n}return this.parseBalance(s,!1)}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={id:parseInt(e)},r=await this.privateGetOrdersId(this.extend(i,s)),a=this.safeValue(r,"order");return this.parseOrder(a)}async fetchOrders(e,t,s,i={}){let r;await this.loadMarkets(),void 0!==e&&(r=this.market(e));const a={market:r.id,per:s},n=await this.privateGetMarketsMarketOrders(this.extend(a,i)),o=this.safeValue(n,"orders");return this.parseOrders(o,r,t,s)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({state:"pending"},i))}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({state:"traded"},i))}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets(),s="buy"===s?"Bid":"Ask";const n={market:this.marketId(e),price_type:t,type:s,amount:this.amountToPrecision(e,i)};"limit"===t&&(n.limit=this.priceToPrecision(e,r));const o=await this.privatePostMarketsMarketOrders(this.extend(n,a)),c=this.safeValue(o,"order");return this.parseOrder(c)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={id:parseInt(e),state:"canceling"},r=await this.privatePutOrdersId(this.extend(i,s)),a=this.safeValue(r,"order");return this.parseOrder(a)}parseOrderStatus(e){return this.safeString({traded:"closed",received:"open",canceling:"canceled"},e,e)}parseOrder(e,t){const s=this.safeString(e,"id"),i=this.parse8601(this.safeString(e,"created_at")),r=this.safeString(e,"market_id"),a=this.safeSymbol(r,t,"-"),n=this.safeString(e,"price_type"),o=this.safeStringLower(e,"type"),c=this.parseOrderStatus(this.safeString(e,"state")),d=this.safeValue(e,"original_amount",[]),h=this.safeNumber(d,0),u=this.safeValue(e,"amount",[]),l=this.safeNumber(u,0),f=this.safeValue(e,"traded_amount",[]),p=this.safeNumber(f,0),m=this.safeValue(e,"totalExchanged",[]),b=this.safeNumber(m,0),g=this.safeValue(e,"limit",[]);let y=this.safeNumber(g,0);void 0===y&&void 0!==g&&(y=g);const v=this.safeValue(e,"paid_fee",[]),w=this.safeNumber(v,0);let k;if(void 0!==w){const e=this.safeString(v,1);k={cost:w,code:this.safeCurrencyCode(e)}}return this.safeOrder({info:e,id:s,clientOrderId:void 0,datetime:this.iso8601(i),timestamp:i,lastTradeTimestamp:void 0,status:c,symbol:a,type:n,timeInForce:void 0,postOnly:void 0,side:o,price:y,stopPrice:void 0,average:void 0,cost:b,amount:h,filled:p,remaining:l,trades:void 0,fee:k})}isFiat(e){return this.safeValue({ARS:!0,CLP:!0,COP:!0,PEN:!0},e,!1)}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e);if(this.isFiat(e))throw new o(this.id+" fetchDepositAddress() for fiat "+e+" is not supported");const i={currency:s.id},a=await this.privateGetCurrenciesCurrencyReceiveAddresses(this.extend(i,t)),n=this.safeValue(a,"receive_addresses"),c=[];for(let e=1;e<n.length;e++){const t=n[e];if(t.ready){const e=t.address;this.checkAddress(e),c.push(e)}}if(c.length<1)throw new r(this.id+": there are no addresses ready for receiving "+e+", retry again later)");return{currency:e,address:c[0],tag:void 0,info:n}}async createDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e);if(this.isFiat(e))throw new o(this.id+": fiat fetchDepositAddress() for "+e+" is not supported");const i={currency:s.id},r=await this.privatePostCurrenciesCurrencyReceiveAddresses(this.extend(i,t));return{currency:e,address:this.safeString(r.receive_address,"address"),tag:void 0,info:r}}parseTransactionStatus(e){return this.safeString({rejected:"failed",confirmed:"ok",anulled:"canceled",retained:"canceled",pending_confirmation:"pending"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"id"),i=this.parse8601(this.safeString(e,"created_at")),r=this.safeString(e,"currency"),a=this.safeCurrencyCode(r,t),n=parseFloat(e.amount[0]),o=parseFloat(e.fee[0]),c=e.fee[1],d=this.parseTransactionStatus(this.safeString(e,"state")),h="deposit_data"in e?"deposit":"withdrawal",u=this.safeValue(e,h+"_data",{}),l=this.safeValue(u,"target_address"),f=this.safeString(u,"tx_hash"),p=this.parse8601(this.safeString(u,"updated_at"));return{info:e,id:s,txid:f,timestamp:i,datetime:this.iso8601(i),address:l,type:h,amount:n,currency:a,status:d,updated:p,fee:{cost:o,rate:c}}}async fetchDeposits(e,t,s,i={}){if(await this.loadMarkets(),void 0===e)throw new d(this.id+": fetchDeposits() requires a currency code argument");const r=this.currency(e),a={currency:r.id,per:s},n=await this.privateGetCurrenciesCurrencyDeposits(this.extend(a,i)),o=this.safeValue(n,"deposits");return this.parseTransactions(o,r,t,s)}async fetchWithdrawals(e,t,s,i={}){if(await this.loadMarkets(),void 0===e)throw new d(this.id+": fetchDeposits() requires a currency code argument");const r=this.currency(e),a={currency:r.id,per:s},n=await this.privateGetCurrenciesCurrencyWithdrawals(this.extend(a,i)),o=this.safeValue(n,"withdrawals");return this.parseTransactions(o,r,t,s)}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a={currency:this.currency(e).id,amount:t,withdrawal_data:{target_address:s}},n=await this.privatePostCurrenciesCurrencyWithdrawals(this.extend(a,r)),o=this.safeValue(n,"withdrawal");return this.parseTransaction(o)}nonce(){return this.microseconds()}sign(e,t="public",s="GET",i={},r,a){let n=this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));Object.keys(o).length&&("GET"===s?n+="?"+this.urlencode(o):a=this.json(o));const c=this.urls.api+"/"+this.version+"/"+n;if("private"===t){this.checkRequiredCredentials();const e=this.nonce().toString(),t=[s,"/api/"+this.version+"/"+n];if(a){const e=this.stringToBase64(a);t.push(this.decode(e))}t.push(e);const i=t.join(" "),o=this.hmac(this.encode(i),this.encode(this.secret),"sha384");r={"X-SBTC-APIKEY":this.apiKey,"X-SBTC-SIGNATURE":o,"X-SBTC-NONCE":e,"Content-Type":"application/json"}}return{url:c,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,a,o,c,d){if(void 0!==o&&e>=400){const e=this.safeString(o,"code"),t=this.safeString(o,"message",a),s=this.id+" "+t;if(void 0!==e)throw this.throwExactlyMatchedException(this.exceptions,e,s),new n(s)}}}},1520:(e,t,s)=>{"use strict";const i=s(8819),{RateLimitExceeded:r,BadSymbol:a,OrderNotFound:n,ExchangeError:o,AuthenticationError:c,ArgumentsRequired:d,ExchangeNotAvailable:h}=s(3449),u=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bw",name:"BW",countries:["CN"],rateLimit:1500,version:"v1",has:{cancelAllOrders:!1,cancelOrder:!0,cancelOrders:!1,CORS:!1,createDepositAddress:!1,createLimitOrder:!0,createMarketOrder:!1,createOrder:!0,deposit:!1,editOrder:!1,fetchBalance:!0,fetchBidsAsks:!1,fetchClosedOrders:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchFundingFees:!1,fetchL2OrderBook:!1,fetchLedger:!1,fetchMarkets:!0,fetchMyTrades:!1,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrderBooks:!1,fetchOrders:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTradingFee:!1,fetchTradingFees:!1,fetchTradingLimits:!1,fetchTransactions:!1,fetchWithdrawals:!0,privateAPI:!1,publicAPI:!1,withdraw:!1},timeframes:{"1m":"1M","5m":"5M","15m":"15M","30m":"30M","1h":"1H","1w":"1W"},hostname:"bw.com",urls:{logo:"https://user-images.githubusercontent.com/1294454/69436317-31128c80-0d52-11ea-91d1-eb7bb5818812.jpg",api:"https://www.{hostname}",www:"https://www.bw.com",doc:"https://github.com/bw-exchange/api_docs_en/wiki",fees:"https://www.bw.com/feesRate",referral:"https://www.bw.com/regGetCommission/N3JuT1R3bWxKTE0"},requiredCredentials:{apiKey:!0,secret:!0},fees:{trading:{tierBased:!1,percentage:!0,taker:.002,maker:.002},funding:{}},exceptions:{exact:{999:c,1e3:h,2012:n,5017:a,10001:r}},api:{public:{get:["api/data/v1/klines","api/data/v1/ticker","api/data/v1/tickers","api/data/v1/trades","api/data/v1/entrusts","exchange/config/controller/website/marketcontroller/getByWebId","exchange/config/controller/website/currencycontroller/getCurrencyList"]},private:{get:["exchange/entrust/controller/website/EntrustController/getEntrustById","exchange/entrust/controller/website/EntrustController/getUserEntrustRecordFromCacheWithPage","exchange/entrust/controller/website/EntrustController/getUserEntrustList","exchange/fund/controller/website/fundwebsitecontroller/getwithdrawaddress","exchange/fund/controller/website/fundwebsitecontroller/getpayoutcoinrecord","exchange/entrust/controller/website/EntrustController/getUserEntrustList"],post:["exchange/fund/controller/website/fundcontroller/getPayinAddress","exchange/fund/controller/website/fundcontroller/getPayinCoinRecord","exchange/fund/controller/website/fundcontroller/findbypage","exchange/entrust/controller/website/EntrustController/addEntrust","exchange/entrust/controller/website/EntrustController/cancelEntrust"]}}})}async fetchMarkets(e={}){const t=await this.publicGetExchangeConfigControllerWebsiteMarketcontrollerGetByWebId(e),s=this.safeValue(t,"datas",[]),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"marketId"),a=parseInt(r),n=this.safeStringUpper(t,"name");let[o,c]=n.split("_");o=this.safeCurrencyCode(o),c=this.safeCurrencyCode(c);const d=this.safeString(t,"sellerCurrencyId"),h=this.safeString(t,"buyerCurrencyId"),u=parseInt(d),l=parseInt(h),f=o+"/"+c,p=1===this.safeInteger(t,"state"),m=this.safeNumber(t,"defaultFee");i.push({id:r,active:p,numericId:a,symbol:f,base:o,quote:c,baseId:d,quoteId:h,baseNumericId:u,quoteNumericId:l,maker:m,taker:m,info:t,precision:{amount:this.safeInteger(t,"amountDecimal"),price:this.safeInteger(t,"priceDecimal")},limits:{amount:{min:this.safeNumber(t,"minAmount"),max:void 0},price:{min:0,max:void 0},cost:{min:0,max:void 0}}})}return i}async fetchCurrencies(e={}){const t=await this.publicGetExchangeConfigControllerWebsiteCurrencycontrollerGetCurrencyList(e),s=this.safeValue(t,"datas",[]),i={};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"currencyId"),a=this.safeCurrencyCode(this.safeStringUpper(t,"name")),n=1===this.safeInteger(t,"state");i[a]={id:r,code:a,info:t,name:a,active:n,fee:this.safeNumber(t,"drawFee"),precision:void 0,limits:{amount:{min:this.safeNumber(t,"limitAmount",0),max:void 0},withdraw:{min:void 0,max:this.safeNumber(t,"onceDrawLimit")}}}}return i}parseTicker(e,t){const s=this.safeString(e,0),i=this.safeSymbol(s,t),r=this.milliseconds(),a=parseFloat(this.safeValue(e,1)),n=this.safeValue(e,"bid",{}),o=this.safeValue(e,"ask",{});return{symbol:i,timestamp:r,datetime:this.iso8601(r),high:parseFloat(this.safeValue(e,2)),low:parseFloat(this.safeValue(e,3)),bid:parseFloat(this.safeValue(e,7)),bidVolume:this.safeNumber(n,"quantity"),ask:parseFloat(this.safeValue(e,8)),askVolume:this.safeNumber(o,"quantity"),vwap:void 0,open:void 0,close:a,last:a,previousClose:void 0,change:parseFloat(this.safeValue(e,5)),percentage:void 0,average:void 0,baseVolume:parseFloat(this.safeValue(e,4)),quoteVolume:parseFloat(this.safeValue(e,9)),info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={marketId:s.id},r=await this.publicGetApiDataV1Ticker(this.extend(i,t)),a=this.safeValue(r,"datas",[]);return this.parseTicker(a,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetApiDataV1Tickers(t),i=this.safeValue(s,"datas",[]),r={};for(let t=0;t<i.length;t++){const s=this.parseTicker(i[t]),a=s.symbol;(void 0===e||this.inArray(a,e))&&(r[a]=s)}return this.filterByArray(r,"symbol",e)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={marketId:this.market(e).id};void 0!==t&&(i.dataSize=t);const r=await this.publicGetApiDataV1Entrusts(this.extend(i,s)),a=this.safeValue(r,"datas",[]),n=this.safeTimestamp(a,"timestamp");return this.parseOrderBook(a,e,n)}parseTrade(e,t){const s=this.safeTimestamp(e,2),i=this.safeString(e,5),r=this.safeString(e,6),a=this.parseNumber(i),n=this.parseNumber(r),o=this.parseNumber(u.stringMul(i,r)),c=this.safeString(e,1);let d;if(void 0!==c)if(c in this.markets_by_id)t=this.markets_by_id[c];else{const t=this.safeString(e,3),[s,i]=t.split("_");d=this.safeCurrencyCode(s)+"/"+this.safeCurrencyCode(i)}void 0===d&&void 0!==t&&(d=t.symbol);const h="ask"===this.safeString(e,4)?"sell":"buy";return{id:void 0,timestamp:s,datetime:this.iso8601(s),symbol:d,order:void 0,type:"limit",side:h,takerOrMaker:void 0,price:a,amount:n,cost:o,fee:void 0,info:e}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={marketId:r.id};void 0!==s&&(a.dataSize=s);const n=await this.publicGetApiDataV1Trades(this.extend(a,i)),o=this.safeValue(n,"datas",[]);return this.parseTrades(o,r,t,s)}parseOHLCV(e,t){return[this.safeTimestamp(e,3),this.safeNumber(e,4),this.safeNumber(e,5),this.safeNumber(e,6),this.safeNumber(e,7),this.safeNumber(e,8)]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={marketId:a.id,type:this.timeframes[t],dataSize:500};void 0!==i&&(n.dataSize=i);const o=await this.publicGetApiDataV1Klines(this.extend(n,r)),c=this.safeValue(o,"datas",[]);return this.parseOHLCVs(c,a,t,s,i)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostExchangeFundControllerWebsiteFundcontrollerFindbypage(e),s=this.safeValue(t,"datas",{}),i=this.safeValue(s,"list",[]),r={info:t};for(let e=0;e<i.length;e++){const t=i[e],s=this.safeString(t,"currencyTypeId"),a=this.safeCurrencyCode(s),n=this.account();n.free=this.safeString(t,"amount"),n.used=this.safeString(t,"freeze"),r[a]=n}return this.parseBalance(r,!1)}async createOrder(e,t,s,i,r,a={}){if(void 0===r)throw new o(this.id+" allows limit orders only");await this.loadMarkets();const n=this.market(e),c={amount:this.amountToPrecision(e,i),price:this.priceToPrecision(e,r),type:"buy"===s?1:0,rangeType:0,marketId:n.id},d=await this.privatePostExchangeEntrustControllerWebsiteEntrustControllerAddEntrust(this.extend(c,a)),h=this.safeValue(d,"datas");return{id:this.safeString(h,"entrustId"),info:d,timestamp:void 0,datetime:void 0,lastTradeTimestamp:void 0,symbol:e,type:t,side:s,price:r,amount:i,cost:void 0,average:void 0,filled:void 0,remaining:void 0,status:"open",fee:void 0,trades:void 0,clientOrderId:void 0}}parseOrderStatus(e){return this.safeString({"-3":"canceled","-2":"canceled","-1":"canceled",0:"open",1:"canceled",2:"closed",3:"open",4:"canceled"},e,e)}parseOrder(e,t){const s=this.safeString(e,"marketId"),i=this.safeSymbol(s,t),r=this.safeInteger(e,"createTime");let a=this.safeString(e,"type");"0"===a?a="sell":"1"===a&&(a="buy");const n=this.safeNumber(e,"amount"),o=this.safeNumber(e,"price"),c=this.safeNumber(e,"completeAmount"),d=this.safeNumber2(e,"availabelAmount","availableAmount"),h=this.safeNumber(e,"totalMoney"),u=this.parseOrderStatus(this.safeString(e,"status"));return this.safeOrder({info:e,id:this.safeString(e,"entrustId"),clientOrderId:void 0,timestamp:r,datetime:this.iso8601(r),lastTradeTimestamp:void 0,symbol:i,type:"limit",timeInForce:void 0,postOnly:void 0,side:a,price:o,stopPrice:void 0,amount:n,cost:h,average:void 0,filled:c,remaining:d,status:u,fee:void 0,trades:void 0})}async fetchOrder(e,t,s={}){if(void 0===t)throw new d(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={marketId:i.id,entrustId:e},a=await this.privateGetExchangeEntrustControllerWebsiteEntrustControllerGetEntrustById(this.extend(r,s)),n=this.safeValue(a,"datas",{});return this.parseOrder(n,i)}async cancelOrder(e,t,s={}){if(void 0===t)throw new d(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const i={marketId:this.market(t).id,entrustId:e};return{info:await this.privatePostExchangeEntrustControllerWebsiteEntrustControllerCancelEntrust(this.extend(i,s)),id:e}}async fetchOpenOrders(e,t,s,i={}){if(void 0===e)throw new d(this.id+" fetchOpenOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a={marketId:r.id};void 0!==s&&(a.pageSize=s);const n=await this.privateGetExchangeEntrustControllerWebsiteEntrustControllerGetUserEntrustRecordFromCacheWithPage(this.extend(a,i)),o=this.safeValue(n,"datas",{}),c=this.safeValue(o,"entrustList",[]);return this.parseOrders(c,r,t,s)}async fetchClosedOrders(e,t,s,i={}){if(void 0===e)throw new d(this.id+" fetchClosedOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a={marketId:r.id};void 0!==s&&(a.pageSize=s),void 0!==t&&(a.startDateTime=t);const n=await this.privateGetExchangeEntrustControllerWebsiteEntrustControllerGetUserEntrustList(this.extend(a,i)),o=this.safeValue(n,"datas",{}),c=this.safeValue(o,"entrustList",[]);return this.parseOrders(c,r,t,s)}async fetchOrders(e,t,s,i={}){if(void 0===e)throw new d(this.id+" fetchOpenOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a={marketId:r.id};void 0!==t&&(a.startDateTime=t),void 0!==s&&(a.pageSize=s);const n=await this.privateGetExchangeEntrustControllerWebsiteEntrustControllerGetUserEntrustList(this.extend(a,i)),o=this.safeValue(n,"datas",{}),c=this.safeValue(o,"entrustList",[]);return this.parseOrders(c,r,t,s)}sign(e,t="public",s="GET",i={},r,a){let n=this.implodeParams(this.urls.api,{hostname:this.hostname})+"/"+e;if("GET"===s?Object.keys(i).length&&(n+="?"+this.urlencode(i)):a=this.json(i),"private"===t){const e=this.milliseconds().toString();let t="";if("GET"===s){const e=this.keysort(i),s=Object.keys(e);for(let i=0;i<s.length;i++){const r=s[i];t+=r+e[r].toString()}}else t=a;const n=this.apiKey+e+t+this.secret,o=this.hash(this.encode(n),"md5");r||(r={}),r.Apiid=this.apiKey,r.Timestamp=e,r.Sign=o}return{url:n,method:s,body:a,headers:r}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={currencyTypeName:this.currency(e).name},i=await this.privatePostExchangeFundControllerWebsiteFundcontrollerGetPayinAddress(this.extend(s,t)),r=this.safeValue(i,"datas",{}),a=this.safeString(r,"address"),n=this.safeString(r,"memo");return this.checkAddress(a),{currency:e,address:this.checkAddress(a),tag:n,info:i}}parseTransactionStatus(e){return this.safeString({"-1":"canceled",0:"pending",1:"ok"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"depositId","withdrawalId"),i=this.safeString2(e,"depositAddress","withdrawalAddress"),r=this.safeString2(e,"currencyId","currencyTypeId");let a;r in this.currencies_by_id&&(t=this.currencies_by_id[r]),void 0===a&&void 0!==t&&(a=t.code);const n="depositId"in e?"deposit":"withdrawal",o=this.safeNumber2(e,"actuallyAmount","amount"),c=this.parseTransactionStatus(this.safeString2(e,"verifyStatus","state")),d=this.safeInteger(e,"createTime"),h=this.safeString(e,"txId");let u;const l=this.safeNumber(e,"fees");return void 0!==l&&(u={cost:l,currency:a}),{info:e,id:s,txid:h,timestamp:d,datetime:this.iso8601(d),addressFrom:void 0,address:i,addressTo:void 0,tagFrom:void 0,tag:void 0,tagTo:void 0,type:n,amount:o,currency:a,status:c,updated:void 0,fee:u}}async fetchDeposits(e,t,s,i={}){if(void 0===e)throw new d(this.id+" fetchDeposits() requires a currency code argument");await this.loadMarkets();const r={currencyTypeName:this.currency(e).name};void 0!==s&&(r.pageSize=s);const a=await this.privatePostExchangeFundControllerWebsiteFundcontrollerGetPayinCoinRecord(this.extend(r,i)),n=this.safeValue(a,"datas",{}),o=this.safeValue(n,"list",[]);return this.parseTransactions(o,e,t,s)}async fetchWithdrawals(e,t,s,i={}){if(void 0===e)throw new d(this.id+" fetchWithdrawals() requires a currency code argument");await this.loadMarkets();const r={currencyId:this.currency(e).id};void 0!==s&&(r.pageSize=s);const a=await this.privateGetExchangeFundControllerWebsiteFundwebsitecontrollerGetpayoutcoinrecord(this.extend(r,i)),n=this.safeValue(a,"datas",{}),o=this.safeValue(n,"list",[]);return this.parseTransactions(o,e,t,s)}handleErrors(e,t,s,i,r,a,n,c,d){if(!n)return;const h=this.safeValue(n,"resMsg"),u=this.safeString(h,"code");if("1"!==u){const e=this.id+" "+this.json(n);throw this.throwExactlyMatchedException(this.exceptions.exact,u,e),new o(e)}}}},3803:(e,t,s)=>{"use strict";const i=s(8819),{TICK_SIZE:r}=s(2115),{AuthenticationError:a,ExchangeError:n,ArgumentsRequired:o,PermissionDenied:c,InvalidOrder:d,OrderNotFound:h,InsufficientFunds:u,BadRequest:l,RateLimitExceeded:f,InvalidNonce:p}=s(3449),m=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bybit",name:"Bybit",countries:["VG"],version:"v2",userAgent:void 0,rateLimit:100,hostname:"bybit.com",has:{cancelOrder:!0,CORS:!0,cancelAllOrders:!0,createOrder:!0,editOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchDeposits:!0,fetchLedger:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchOrderTrades:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTransactions:!1,fetchWithdrawals:!0,fetchPositions:!0},timeframes:{"1m":"1","3m":"3","5m":"5","15m":"15","30m":"30","1h":"60","2h":"120","4h":"240","6h":"360","12h":"720","1d":"D","1w":"W","1M":"M","1y":"Y"},urls:{test:{futures:"https://api-testnet.{hostname}",v2:"https://api-testnet.{hostname}",public:"https://api-testnet.{hostname}",private:"https://api-testnet.{hostname}"},logo:"https://user-images.githubusercontent.com/51840849/76547799-daff5b80-649e-11ea-87fb-3be9bac08954.jpg",api:{futures:"https://api.{hostname}",v2:"https://api.{hostname}",public:"https://api.{hostname}",private:"https://api.{hostname}"},www:"https://www.bybit.com",doc:["https://bybit-exchange.github.io/docs/inverse/","https://bybit-exchange.github.io/docs/linear/","https://github.com/bybit-exchange"],fees:"https://help.bybit.com/hc/en-us/articles/360039261154",referral:"https://www.bybit.com/app/register?ref=X7Prm"},api:{futures:{private:{get:["order/list","order","stop-order/list","stop-order","position/list","execution/list","trade/closed-pnl/list"],post:["order/create","order/cancel","order/cancelAll","order/replace","stop-order/create","stop-order/cancel","stop-order/cancelAll","stop-order/replace","position/change-position-margin","position/trading-stop","position/leverage/save","position/switch-mode","position/switch-isolated","position/risk-limit"]}},v2:{public:{get:["orderBook/L2","kline/list","tickers","trading-records","symbols","liq-records","mark-price-kline","index-price-kline","premium-index-kline","open-interest","big-deal","account-ratio","time","announcement","funding/prev-funding-rate","risk-limit/list"]},private:{get:["order/list","order","stop-order/list","stop-order","position/list","execution/list","trade/closed-pnl/list","funding/prev-funding-rate","funding/prev-funding","funding/predicted-funding","account/api-key","account/lcp","wallet/balance","wallet/fund/records","wallet/withdraw/list","exchange-order/list"],post:["order/create","order/cancel","order/cancelAll","order/replace","stop-order/create","stop-order/cancel","stop-order/cancelAll","stop-order/replace","position/change-position-margin","position/trading-stop","position/leverage/save","position/switch-mode","position/switch-isolated","position/risk-limit"]}},public:{linear:{get:["kline","recent-trading-records","funding/prev-funding-rate","mark-price-kline","index-price-kline","premium-index-kline","risk-limit"]}},private:{linear:{get:["order/list","order/search","stop-order/list","stop-order/search","position/list","trade/execution/list","trade/closed-pnl/list","funding/predicted-funding","funding/prev-funding"],post:["order/create","order/cancel","order/cancel-all","order/replace","stop-order/create","stop-order/cancel","stop-order/cancel-all","stop-order/replace","position/set-auto-add-margin","position/switch-isolated","tpsl/switch-mode","position/add-margin","position/set-leverage","position/trading-stop","position/set-risk"]}}},httpExceptions:{403:f},exceptions:{exact:{10001:l,10002:p,10003:a,10004:a,10005:c,10006:f,10007:a,10010:c,10017:l,10018:f,20001:h,20003:d,20004:d,20005:d,20006:d,20007:d,20008:d,20009:d,20010:d,20011:d,20012:d,20013:d,20014:d,20015:d,20016:d,20017:d,20018:d,20019:d,20020:d,20021:d,20022:l,20023:l,20031:l,20070:l,20071:l,20084:l,30001:l,30003:d,30004:d,30005:d,30007:d,30008:d,30009:n,30010:u,30011:c,30012:c,30013:c,30014:d,30015:d,30016:n,30017:d,30018:d,30019:d,30020:d,30021:d,30022:d,30023:d,30024:d,30025:d,30026:d,30027:d,30028:d,30029:d,30030:d,30031:u,30032:d,30033:f,30034:h,30035:f,30036:n,30037:d,30041:n,30042:u,30043:d,30044:d,30045:d,30049:u,30050:n,30051:n,30052:n,30054:n,30057:n,30063:n,30067:u,30068:n,30074:d,30075:d,33004:a,34026:n},broad:{"unknown orderInfo":h,"invalid api_key":a}},precisionMode:r,options:{marketTypes:{"BTC/USDT":"linear","BCH/USDT":"linear","ETH/USDT":"linear","LTC/USDT":"linear","XTZ/USDT":"linear","LINK/USDT":"linear","ADA/USDT":"linear","DOT/USDT":"linear","UNI/USDT":"linear","AAVE/USDT":"linear","SUSHI/USDT":"linear","XRP/USDT":"linear","XEM/USDT":"linear","BTC/USD":"inverse","ETH/USD":"inverse","EOS/USD":"inverse","XRP/USD":"inverse"},defaultType:"linear",code:"BTC",cancelAllOrders:{},recvWindow:5e3,timeDifference:0,adjustForTimeDifference:!1},fees:{trading:{tierBased:!1,percentage:!0,taker:75e-5,maker:-25e-5},funding:{tierBased:!1,percentage:!1,withdraw:{},deposit:{}}}})}nonce(){return this.milliseconds()-this.options.timeDifference}async loadTimeDifference(e={}){const t=await this.fetchTime(e),s=this.milliseconds();return this.options.timeDifference=s-t,this.options.timeDifference}async fetchTime(e={}){const t=await this.v2PublicGetTime(e);return this.safeTimestamp(t,"time_now")}async fetchMarkets(e={}){this.options.adjustForTimeDifference&&await this.loadTimeDifference();const t=await this.v2PublicGetSymbols(e),s=this.safeValue(t,"result",[]),i=this.safeValue(this.options,"fetchMarkets",{}),r=this.safeValue(i,"linear",{USDT:!0}),a=[];for(let e=0;e<s.length;e++){const t=s[e],i=this.safeString2(t,"name","symbol"),n=this.safeString(t,"base_currency"),o=this.safeString(t,"quote_currency"),c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o),h=d in r,u=!h;let l=c+"/"+d;let f="swap";c+d!==i&&(l=i,f="futures");const p=this.safeValue(t,"lot_size_filter",{}),m=this.safeValue(t,"price_filter",{}),b={amount:this.safeNumber(p,"qty_step"),price:this.safeNumber(m,"tick_size")},g=this.safeString(t,"status");let y;void 0!==g&&(y="Trading"===g);const v="spot"===f,w="swap"===f,k="futures"===f,S="option"===f;a.push({id:i,symbol:l,base:c,quote:d,active:y,precision:b,taker:this.safeNumber(t,"taker_fee"),maker:this.safeNumber(t,"maker_fee"),type:f,spot:v,swap:w,futures:k,option:S,linear:h,inverse:u,limits:{amount:{min:this.safeNumber(p,"min_trading_qty"),max:this.safeNumber(p,"max_trading_qty")},price:{min:this.safeNumber(m,"min_price"),max:this.safeNumber(m,"max_price")},cost:{min:void 0,max:void 0}},info:t})}return a}parseTicker(e,t){const s=void 0,i=this.safeString(e,"symbol"),r=this.safeSymbol(i,t),a=this.safeNumber(e,"last_price"),n=this.safeNumber(e,"prev_price_24h");let o,c,d=this.safeNumber(e,"price_24h_pcnt");void 0!==d&&(d*=100),void 0!==a&&void 0!==n&&(o=a-n,c=this.sum(n,a)/2);const h=this.safeNumber(e,"turnover_24h"),u=this.safeNumber(e,"volume_24h"),l=this.vwap(h,u);return{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high_price_24h"),low:this.safeNumber(e,"low_price_24h"),bid:this.safeNumber(e,"bid_price"),bidVolume:void 0,ask:this.safeNumber(e,"ask_price"),askVolume:void 0,vwap:l,open:n,close:a,last:a,previousClose:void 0,change:o,percentage:d,average:c,baseVolume:h,quoteVolume:u,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.v2PublicGetTickers(this.extend(i,t)),a=this.safeValue(r,"result",[]),n=this.safeValue(a,0),o=this.safeTimestamp(r,"time_now"),c=this.parseTicker(n,s);return c.timestamp=o,c.datetime=this.iso8601(o),c}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.v2PublicGetTickers(t),i=this.safeValue(s,"result",[]),r={};for(let e=0;e<i.length;e++){const t=this.parseTicker(i[e]);r[t.symbol]=t}return this.filterByArray(r,"symbol",e)}parseOHLCV(e,t){return[this.safeTimestamp2(e,"open_time","start_at"),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber2(e,"turnover","volume")]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={symbol:a.id,interval:this.timeframes[t]},c=this.parseTimeframe(t),d=this.seconds();if(void 0===s){if(void 0===i)throw new o(this.id+" fetchOHLCV() requires a since argument or a limit argument");n.from=d-i*c}else n.from=parseInt(s/1e3);void 0!==i&&(n.limit=i);const h=a.linear?"publicLinearGetKline":"v2PublicGetKlineList",u=await this[h](this.extend(n,r)),l=this.safeValue(u,"result",{});return this.parseOHLCVs(l,a,t,s,i)}parseTrade(e,t){const s=this.safeString2(e,"id","exec_id"),i=this.safeString(e,"symbol"),r=(t=this.safeMarket(i,t)).symbol,a=this.safeString2(e,"qty","exec_qty"),n=this.safeString2(e,"exec_price","price");let o=this.safeNumber(e,"exec_value");const c=this.parseNumber(a),d=this.parseNumber(n);void 0===o&&(o=this.parseNumber(m.stringMul(n,a)));let h=this.parse8601(this.safeString(e,"time"));void 0===h&&(h=this.safeInteger(e,"trade_time_ms"));const u=this.safeStringLower(e,"side"),l="AddedLiquidity"===this.safeString(e,"last_liquidity_ind")?"maker":"taker",f=this.safeNumber(e,"exec_fee");let p;if(void 0!==f){p={cost:f,currency:t.inverse?t.base:t.quote,rate:this.safeNumber(e,"fee_rate")}}return{id:s,info:e,timestamp:h,datetime:this.iso8601(h),symbol:r,order:this.safeString(e,"order_id"),type:this.safeStringLower(e,"order_type"),side:u,takerOrMaker:l,price:d,amount:c,cost:o,fee:p}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id};void 0!==s&&(a.count=s);const n=r.linear?"publicLinearGetRecentTradingRecords":"v2PublicGetTradingRecords",o=await this[n](this.extend(a,i)),c=this.safeValue(o,"result",{});return this.parseTrades(c,r,t,s)}parseOrderBook(e,t,s,i="Buy",r="Sell",a="price",o="size"){const c=[],d=[];for(let t=0;t<e.length;t++){const s=e[t],i=this.safeString(s,"side");if("Buy"===i)c.push(this.parseBidAsk(s,a,o));else{if("Sell"!==i)throw new n(this.id+" parseOrderBook encountered an unrecognized bidask format: "+this.json(s));d.push(this.parseBidAsk(s,a,o))}}return{symbol:t,bids:this.sortBy(c,0,!0),asks:this.sortBy(d,0),timestamp:s,datetime:this.iso8601(s),nonce:void 0}}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.market(e).id},r=await this.v2PublicGetOrderBookL2(this.extend(i,s)),a=this.safeValue(r,"result",[]),n=this.safeTimestamp(r,"time_now");return this.parseOrderBook(a,e,n,"Buy","Sell","price","size")}async fetchBalance(e={}){await this.loadMarkets();const t={},s=this.safeString(e,"coin"),i=this.safeString(e,"code");if(void 0!==s)t.coin=s;else if(void 0!==i){const e=this.currency(i);t.coin=e.id}const r=await this.v2PrivateGetWalletBalance(this.extend(t,e)),a={info:r},n=this.safeValue(r,"result",{}),o=Object.keys(n);for(let e=0;e<o.length;e++){const t=o[e],s=n[t],i=this.safeCurrencyCode(t),r=this.account();r.free=this.safeString(s,"available_balance"),r.used=this.safeString(s,"used_margin"),r.total=this.safeString(s,"equity"),a[i]=r}return this.parseBalance(a,!1)}parseOrderStatus(e){return this.safeString({Created:"open",Rejected:"rejected",New:"open",PartiallyFilled:"open",Filled:"closed",Cancelled:"canceled",PendingCancel:"canceling",Active:"open",Untriggered:"open",Triggered:"closed",Deactivated:"canceled"},e,e)}parseTimeInForce(e){return this.safeString({GoodTillCancel:"GTC",ImmediateOrCancel:"IOC",FillOrKill:"FOK",PostOnly:"PO"},e,e)}parseOrder(e,t){const s=this.safeString(e,"symbol"),i=(t=this.safeMarket(s,t)).symbol;let r;const a=this.parse8601(this.safeString(e,"created_at")),n=this.safeString2(e,"order_id","stop_order_id"),o=this.safeStringLower(e,"order_type");let c=this.safeNumber(e,"price");0===c&&(c=void 0);const d=this.safeNumber(e,"average_price"),h=this.safeNumber(e,"qty"),u=this.safeNumber(e,"cum_exec_value"),l=this.safeNumber(e,"cum_exec_qty"),f=this.safeNumber(e,"leaves_qty"),p=this.safeValue(this.options,"marketTypes",{}),m=this.safeString(p,i);void 0!==t&&(r="linear"===m?t.quote:t.base);let b=this.safeTimestamp(e,"last_exec_time");0===b&&(b=void 0);const g=this.parseOrderStatus(this.safeString2(e,"order_status","stop_order_status")),y=this.safeStringLower(e,"side");let v,w=this.safeNumber(e,"cum_exec_fee");void 0!==w&&(w=Math.abs(w),v={cost:w,currency:r});let k=this.safeString(e,"order_link_id");void 0!==k&&k.length<1&&(k=void 0);const S=this.parseTimeInForce(this.safeString(e,"time_in_force")),_=this.safeNumber2(e,"trigger_price","stop_px"),O="PO"===S;return this.safeOrder({info:e,id:n,clientOrderId:k,timestamp:a,datetime:this.iso8601(a),lastTradeTimestamp:b,symbol:i,type:o,timeInForce:S,postOnly:O,side:y,price:c,stopPrice:_,amount:h,cost:u,average:d,filled:l,remaining:f,status:g,fee:v,trades:void 0})}async fetchOrder(e,t,s={}){if(void 0===t)throw new o(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={symbol:i.id};let a;i.swap?i.linear?a="privateLinearGetOrderSearch":i.inverse&&(a="v2PrivateGetOrder"):i.futures&&(a="futuresPrivateGetOrder");if(void 0===this.safeString(s,"stop_order_id")){void 0===this.safeString(s,"order_link_id")&&(r.order_id=e)}else i.swap?i.linear?a="privateLinearGetStopOrderSearch":i.inverse&&(a="v2PrivateGetStopOrder"):i.futures&&(a="futuresPrivateGetStopOrder");const n=await this[a](this.extend(r,s)),c=this.safeValue(n,"result");return this.parseOrder(c,i)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e);let c=this.amountToPrecision(e,i);c=n.inverse?parseInt(c):parseFloat(c);const d={side:this.capitalize(s),symbol:n.id,order_type:this.capitalize(t),qty:c,time_in_force:"GoodTillCancel"};let h=!1;if("limit"===t&&(h=!0),h){if(void 0===r)throw new o(this.id+" createOrder() requires a price argument for a "+t+" order");d.price=parseFloat(this.priceToPrecision(e,r))}const u=this.safeString2(a,"order_link_id","clientOrderId");void 0!==u&&(d.order_link_id=u,a=this.omit(a,["order_link_id","clientOrderId"]));const l=this.safeValue2(a,"stop_px","stopPrice"),f=this.safeValue(a,"base_price");let p;if(n.swap?n.linear?(p="privateLinearPostOrderCreate",d.reduce_only=!1,d.close_on_trigger=!1):n.inverse&&(p="v2PrivatePostOrderCreate"):n.futures&&(p="futuresPrivatePostOrderCreate"),void 0!==l){if(void 0===f)throw new o(this.id+" createOrder() requires both the stop_px and base_price params for a conditional "+t+" order");n.swap?n.linear?p="privateLinearPostStopOrderCreate":n.inverse&&(p="v2PrivatePostStopOrderCreate"):n.futures&&(p="futuresPrivatePostStopOrderCreate"),d.stop_px=parseFloat(this.priceToPrecision(e,l)),d.base_price=parseFloat(this.priceToPrecision(e,f)),a=this.omit(a,["stop_px","stopPrice","base_price"])}else if(void 0!==f)throw new o(this.id+" createOrder() requires both the stop_px and base_price params for a conditional "+t+" order");const m=await this[p](this.extend(d,a)),b=this.safeValue(m,"result");return this.parseOrder(b,n)}async editOrder(e,t,s,i,r,a,n={}){if(void 0===t)throw new o(this.id+" editOrder() requires an symbol argument");await this.loadMarkets();const c=this.market(t),d={symbol:c.id};let h;c.swap?c.linear?h="privateLinearPostOrderReplace":c.inverse&&(h="v2PrivatePostOrderReplace"):c.futures&&(h="futuresPrivatePostOrderReplace");const u=this.safeString(n,"stop_order_id");if(void 0!==u?(c.swap?c.linear?h="privateLinearPostStopOrderReplace":c.inverse&&(h="v2PrivatePostStopOrderReplace"):c.futures&&(h="futuresPrivatePostStopOrderReplace"),d.stop_order_id=u,n=this.omit(n,["stop_order_id"])):d.order_id=e,void 0!==r){let e=this.amountToPrecision(t,r);e=c.inverse?parseInt(e):parseFloat(e),d.p_r_qty=e}void 0!==a&&(d.p_r_price=parseFloat(this.priceToPrecision(t,a)));const l=await this[h](this.extend(d,n)),f=this.safeValue(l,"result",{});return{info:l,id:this.safeString2(f,"order_id","stop_order_id"),order_id:this.safeString(f,"order_id"),stop_order_id:this.safeString(f,"stop_order_id")}}async cancelOrder(e,t,s={}){if(void 0===t)throw new o(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={symbol:i.id};let a;i.swap?i.linear?a="privateLinearPostOrderCancel":i.inverse&&(a="v2PrivatePostOrderCancel"):i.futures&&(a="futuresPrivatePostOrderCancel");if(void 0===this.safeString(s,"stop_order_id")){void 0===this.safeString(s,"order_link_id")&&(r.order_id=e)}else i.swap?i.linear?a="privateLinearPostStopOrderCancel":i.inverse&&(a="v2PrivatePostStopOrderCancel"):i.futures&&(a="futuresPrivatePostStopOrderCancel");const n=await this[a](this.extend(r,s)),c=this.safeValue(n,"result",{});return this.parseOrder(c,i)}async cancelAllOrders(e,t={}){if(void 0===e)throw new o(this.id+" cancelAllOrders() requires a symbol argument");await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=this.safeValue(this.options,"cancelAllOrders",{});let a;s.swap?s.linear?a="privateLinearPostOrderCancelAll":s.inverse&&(a="v2PrivatePostOrderCancelAll"):s.futures&&(a="futuresPrivatePostOrderCancelAll");const n=this.safeString(r,"method",a),c=await this[n](this.extend(i,t)),d=this.safeValue(c,"result",[]);return this.parseOrders(d,s)}async fetchOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.market(e),r.symbol=a.id),void 0!==s&&(r.limit=s);const n=this.safeValue(this.options,"fetchOrders",{}),o=this.safeString(this.options,"defaultType","linear"),c=this.safeValue(this.options,"marketTypes",{}),d=this.safeString(c,e,o);let h;const u=void 0!==a,l=u&&a.linear||"linear"===d,f=u&&a.swap&&a.inverse||"inverse"===d,p=u&&a.futures||"futures"===d;l?h="privateLinearGetOrderList":f?h="v2PrivateGetOrderList":p&&(h="futuresPrivateGetOrderList");let m=i;if("stop_order_id"in i||"stop_order_status"in i){let e=this.safeValue(i,"stop_order_status");void 0!==e&&(Array.isArray(e)&&(e=e.join(",")),r.stop_order_status=e,m=this.omit(i,"stop_order_status")),l?h="privateLinearGetStopOrderList":f?h="v2PrivateGetStopOrderList":p&&(h="futuresPrivateGetStopOrderList")}const b=this.safeString(n,"method",h),g=await this[b](this.extend(r,m)),y=this.safeValue(g,"result",{}),v=this.safeValue(y,"data",[]);return this.parseOrders(v,a,t,s)}async fetchClosedOrders(e,t,s,i={}){const r=this.safeValue(this.options,"fetchClosedOrders",{});let a=this.safeValue(r,"order_status",["Rejected","Filled","Cancelled"]);Array.isArray(a)&&(a=a.join(","));const n={},o=this.safeValue(i,"stop_order_status");return void 0===o?n.order_status=a:n.stop_order_status=o,await this.fetchOrders(e,t,s,this.extend(n,i))}async fetchOpenOrders(e,t,s,i={}){const r=this.safeValue(this.options,"fetchOpenOrders",{});let a=this.safeValue(r,"order_status",["Created","New","PartiallyFilled","PendingCancel"]);Array.isArray(a)&&(a=a.join(","));const n={},o=this.safeValue(i,"stop_order_status");return void 0===o?n.order_status=a:n.stop_order_status=o,await this.fetchOrders(e,t,s,this.extend(n,i))}async fetchOrderTrades(e,t,s,i,r={}){const a={order_id:e};return await this.fetchMyTrades(t,s,i,this.extend(a,r))}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={};let a;if(void 0===e){const e=this.safeString(i,"order_id");if(void 0===e)throw new o(this.id+" fetchMyTrades() requires a symbol argument or an order_id param");r.order_id=e,i=this.omit(i,"order_id")}else a=this.market(e),r.symbol=a.id;void 0!==t&&(r.start_time=t),void 0!==s&&(r.limit=s);const n=this.safeString(this.options,"defaultType","linear"),c=this.safeValue(this.options,"marketTypes",{}),d=this.safeString(c,e,n),h=void 0!==a,u=h&&a.linear||"linear"===d,l=h&&a.swap&&a.inverse||"inverse"===d,f=h&&a.futures||"futures"===d;let p;u?p="privateLinearGetTradeExecutionList":l?p="v2PrivateGetExecutionList":f&&(p="futuresPrivateGetExecutionList");const m=await this[p](this.extend(r,i)),b=this.safeValue(m,"result",{}),g=this.safeValue2(b,"trade_list","data",[]);return this.parseTrades(g,a,t,s)}async fetchDeposits(e,t,s,i={}){await this.loadMarkets();const r={wallet_fund_type:"Deposit"};let a;void 0!==e&&(a=this.currency(e),r.coin=a.id),void 0!==t&&(r.start_date=this.ymd(t)),void 0!==s&&(r.limit=s);const n=await this.v2PrivateGetWalletFundRecords(this.extend(r,i)),o=this.safeValue(n,"result",{}),c=this.safeValue(o,"data",[]);return this.parseTransactions(c,a,t,s,{type:"deposit"})}async fetchWithdrawals(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.coin=a.id),void 0!==t&&(r.start_date=this.ymd(t)),void 0!==s&&(r.limit=s);const n=await this.v2PrivateGetWalletWithdrawList(this.extend(r,i)),o=this.safeValue(n,"result",{}),c=this.safeValue(o,"data",[]);return this.parseTransactions(c,a,t,s,{type:"withdrawal"})}parseTransactionStatus(e){return this.safeString({ToBeConfirmed:"pending",UnderReview:"pending",Pending:"pending",Success:"ok",CancelByUser:"canceled",Reject:"rejected",Expire:"expired"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"coin"),i=this.safeCurrencyCode(s,t),r=this.parse8601(this.safeString2(e,"submited_at","exec_time")),a=this.parse8601(this.safeString(e,"updated_at")),n=this.parseTransactionStatus(this.safeString(e,"status")),o=this.safeString(e,"address"),c=this.safeNumber(e,"fee"),d=this.safeStringLower(e,"type");let h;return void 0!==c&&(h={cost:c,currency:i}),{info:e,id:this.safeString(e,"id"),txid:this.safeString(e,"tx_id"),timestamp:r,datetime:this.iso8601(r),address:o,addressTo:void 0,addressFrom:void 0,tag:void 0,tagTo:void 0,tagFrom:void 0,type:d,amount:this.safeNumber(e,"amount"),currency:i,status:n,updated:a,fee:h}}async fetchLedger(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.coin=a.id),void 0!==t&&(r.start_date=this.ymd(t)),void 0!==s&&(r.limit=s);const n=await this.v2PrivateGetWalletFundRecords(this.extend(r,i)),o=this.safeValue(n,"result",{}),c=this.safeValue(o,"data",[]);return this.parseLedger(c,a,t,s)}parseLedgerEntry(e,t){const s=this.safeString(e,"coin"),i=this.safeCurrencyCode(s,t),r=this.safeNumber(e,"amount"),a=this.safeNumber(e,"wallet_balance"),n=r<0?"out":"in";let o;if(void 0!==a&&void 0!==r){const e="out"===n?r:-r;o=this.sum(a,e)}const c=this.parse8601(this.safeString(e,"exec_time")),d=this.parseLedgerEntryType(this.safeString(e,"type")),h=this.safeString(e,"id"),u=this.safeString(e,"tx_id");return{id:h,currency:i,account:this.safeString(e,"wallet_id"),referenceAccount:void 0,referenceId:u,status:void 0,amount:r,before:o,after:a,fee:void 0,direction:n,timestamp:c,datetime:this.iso8601(c),type:d,info:e}}parseLedgerEntryType(e){return this.safeString({Deposit:"transaction",Withdraw:"transaction",RealisedPNL:"trade",Commission:"fee",Refund:"cashback",Prize:"prize",ExchangeOrderWithdraw:"transaction",ExchangeOrderDeposit:"transaction"},e,e)}async fetchPositions(e,t={}){await this.loadMarkets();const s={};if(Array.isArray(e)){if(1!==e.length)throw new o(this.id+" fetchPositions takes exactly one symbol");s.symbol=this.marketId(e[0])}const i=this.safeString(this.options,"defaultType","linear"),r=this.safeString(t,"type",i);let a;return t=this.omit(t,"type"),"linear"===r?a=await this.privateLinearGetPositionList(this.extend(s,t)):"inverse"===r?a=await this.v2PrivateGetPositionList(this.extend(s,t)):"inverseFuture"===r&&(a=await this.futuresPrivateGetPositionList(this.extend(s,t))),this.safeValue(a,"result")}sign(e,t="public",s="GET",i={},r,a){const n=this.safeString(t,0),o=this.safeString(t,1);let c=this.implodeParams(this.urls.api[n],{hostname:this.hostname}),d="/"+n+"/"+o+"/"+e;if("public"===o)Object.keys(i).length&&(d+="?"+this.rawencode(i));else if("public"===n)Object.keys(i).length&&(d+="?"+this.rawencode(i));else{this.checkRequiredCredentials();const e=this.nonce(),t=this.extend(i,{api_key:this.apiKey,recv_window:this.options.recvWindow,timestamp:e}),n=this.keysort(t),o=this.rawencode(n),c=this.hmac(this.encode(o),this.encode(this.secret));"POST"===s?(a=this.json(this.extend(t,{sign:c})),r={"Content-Type":"application/json"}):d+="?"+this.urlencode(n)+"&sign="+c}return c+=d,{url:c,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,a,o,c,d){if(!o)return;const h=this.safeString(o,"ret_code");if("0"!==h){const e=this.id+" "+a;throw this.throwExactlyMatchedException(this.exceptions.exact,h,e),this.throwBroadlyMatchedException(this.exceptions.broad,a,e),new n(e)}}}},2291:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,BadRequest:n,AuthenticationError:o,DDoSProtection:c,BadResponse:d}=s(3449),{TRUNCATE:h,NO_PADDING:u,DECIMAL_PLACES:l}=s(2115),f=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"bytetrade",name:"ByteTrade",countries:["HK"],rateLimit:500,requiresWeb3:!0,certified:!0,has:{cancelOrder:!0,CORS:!1,createOrder:!0,fetchBalance:!0,fetchBidsAsks:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchWithdrawals:!0,withdraw:!0},timeframes:{"1m":"1m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","4h":"4h","1d":"1d","5d":"5d","1w":"1w","1M":"1M"},urls:{test:{market:"https://api-v2-test.byte-trade.com",public:"https://api-v2-test.byte-trade.com"},logo:"https://user-images.githubusercontent.com/1294454/67288762-2f04a600-f4e6-11e9-9fd6-c60641919491.jpg",api:{market:"https://api-v2.byte-trade.com",public:"https://api-v2.byte-trade.com"},www:"https://www.byte-trade.com",doc:"https://docs.byte-trade.com/#description"},api:{market:{get:["klines","depth","trades","tickers"]},public:{get:["symbols","currencies","balance","orders/open","orders/closed","orders/all","orders","orders/trades","depositaddress","withdrawals","deposits","transfers"],post:["transaction/createorder","transaction/cancelorder","transaction/withdraw","transaction/transfer"]}},fees:{trading:{taker:8e-4,maker:8e-4}},commonCurrencies:{1:"ByteTrade",44:"ByteHub",48:"Blocktonic",133:"TerraCredit"},exceptions:{"vertify error":o,"verify error":o,"transaction already in network":n,"invalid argument":n},options:{orderExpiration:31536e6}})}async fetchCurrencies(e={}){const t=await this.publicGetCurrencies(e),s={};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"code");let a;a=r in this.commonCurrencies?this.commonCurrencies[r]:this.safeString(i,"name");const n=this.safeString(i,"fullname"),o=this.safeValue(i,"active"),c=this.safeValue(i,"limits"),d=this.safeValue(c,"deposit"),h=this.safeInteger(i,"basePrecision");let u=this.safeNumber(d,"max");-1===u&&(u=void 0);const l=this.safeValue(c,"withdraw");let f=this.safeNumber(l,"max");-1===f&&(f=void 0),s[a]={id:r,code:a,name:n,active:o,precision:h,fee:void 0,limits:{amount:{min:void 0,max:void 0},deposit:{min:this.safeNumber(d,"min"),max:u},withdraw:{min:this.safeNumber(l,"min"),max:f}},info:i}}return s}async fetchMarkets(e={}){const t=await this.publicGetSymbols(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"symbol");let a=this.safeString(i,"baseName"),n=this.safeString(i,"quoteName");const o=this.safeString(i,"base"),c=this.safeString(i,"quote"),d=a.split("@"+o)[0];let h=n.split("@"+c)[0];"126"===c&&(h="ZAR");const u=d+"/"+h;o in this.commonCurrencies&&(a=this.commonCurrencies[o]),c in this.commonCurrencies&&(n=this.commonCurrencies[c]);const l=a+"/"+n,f=this.safeValue(i,"limits",{}),p=this.safeValue(f,"amount",{}),m=this.safeValue(f,"price",{}),b=this.safeValue(i,"precision",{}),g={id:r,symbol:l,base:a,quote:n,baseId:o,quoteId:c,info:i,active:this.safeString(i,"active"),precision:{amount:this.safeInteger(b,"amount"),price:this.safeInteger(b,"price")},normalSymbol:u,limits:{amount:{min:this.safeNumber(p,"min"),max:this.safeNumber(p,"max")},price:{min:this.safeNumber(m,"min"),max:this.safeNumber(m,"max")},cost:{min:void 0,max:void 0}}};s.push(g)}return s}async fetchBalance(e={}){if(!("userid"in e)&&void 0===this.apiKey)throw new a(this.id+" fetchDeposits() requires this.apiKey or userid argument");await this.loadMarkets();const t={userid:this.apiKey},s=await this.publicGetBalance(this.extend(t,e)),i={info:s};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"code"),a=this.safeCurrencyCode(r,void 0),n=this.account();n.free=this.safeString(t,"free"),n.used=this.safeString(t,"used"),i[a]=n}return this.parseBalance(i,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.market(e).id};void 0!==t&&(i.limit=t);const r=await this.marketGetDepth(this.extend(i,s)),a=this.safeValue(r,"timestamp");return this.parseOrderBook(r,e,a)}parseTicker(e,t){const s=this.safeInteger(e,"timestamp");let i;const r=this.safeString(e,"symbol");if(r in this.markets_by_id)t=this.markets_by_id[r];else{const t=this.safeString(e,"base"),s=this.safeString(e,"quote");if(void 0!==t&&void 0!==s){i=this.safeCurrencyCode(t)+"/"+this.safeCurrencyCode(s)}}return void 0===i&&void 0!==t&&(i=t.symbol),{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:void 0,bidVolume:void 0,ask:void 0,askVolume:void 0,vwap:this.safeNumber(e,"weightedAvgPrice"),open:this.safeNumber(e,"open"),close:this.safeNumber(e,"close"),last:this.safeNumber(e,"last"),previousClose:void 0,change:this.safeNumber(e,"change"),percentage:this.safeNumber(e,"percentage"),average:void 0,baseVolume:this.safeNumber(e,"baseVolume"),quoteVolume:this.safeNumber(e,"quoteVolume"),info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.marketGetTickers(this.extend(i,t));if(Array.isArray(r)){const e=this.safeValue(r,0);if(void 0===e)throw new d(this.id+" fetchTicker() returned an empty response");return this.parseTicker(e,s)}return this.parseTicker(r,s)}async fetchBidsAsks(e,t={}){await this.loadMarkets();const s=await this.marketGetDepth(t);return this.parseTickers(s,e)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.marketGetTickers(t);return this.parseTickers(s,e)}parseOHLCV(e,t){return[this.safeInteger(e,0),this.safeNumber(e,1),this.safeNumber(e,2),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,5)]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={symbol:a.id,timeframe:this.timeframes[t]};void 0!==s&&(n.since=s),void 0!==i&&(n.limit=i);const o=await this.marketGetKlines(this.extend(n,r));return this.parseOHLCVs(o,a,t,s,i)}parseTrade(e,t){const s=this.safeInteger(e,"timestamp"),i=this.safeNumber(e,"price"),r=this.safeNumber(e,"amount"),a=this.safeNumber(e,"cost"),n=this.safeString(e,"id"),o=this.safeString(e,"type"),c=this.safeString(e,"takerOrMaker"),d=this.safeString(e,"side"),h=this.iso8601(s),u=this.safeString(e,"order");let l;if(void 0===t){const s=this.safeString(e,"symbol");t=this.safeValue(this.markets_by_id,s)}void 0!==t&&(l=t.symbol);const f=this.safeValue(e,"fee"),p=this.safeNumber(f,"cost"),m=this.safeNumber(f,"rate"),b=this.safeString(f,"code");return{info:e,timestamp:s,datetime:h,symbol:l,id:n,order:u,type:o,takerOrMaker:c,side:d,price:i,amount:r,cost:a,fee:{currency:this.safeCurrencyCode(b),cost:p,rate:m}}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id};void 0!==t&&(a.since=t),void 0!==s&&(a.limit=s);const n=await this.marketGetTrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}parseOrder(e,t){const s=this.safeString(e,"status");let i;const r=this.safeString(e,"symbol");if(r in this.markets_by_id)t=this.markets_by_id[r];else{const t=this.safeString(e,"base"),s=this.safeString(e,"quote");if(void 0!==t&&void 0!==s){i=this.safeCurrencyCode(t)+"/"+this.safeCurrencyCode(s)}}void 0===i&&void 0!==t&&(i=t.symbol);const a=this.safeInteger(e,"timestamp"),n=this.safeString(e,"datetime"),o=this.safeInteger(e,"lastTradeTimestamp"),c=this.safeNumber(e,"price"),d=this.safeNumber(e,"amount"),h=this.safeNumber(e,"filled"),u=this.safeNumber(e,"remaining"),l=this.safeNumber(e,"cost"),f=this.safeNumber(e,"average"),p=this.safeString(e,"id"),m=this.safeString(e,"type"),b=this.safeString(e,"side"),g=this.safeValue(e,"fee"),y=this.safeNumber(g,"cost"),v=this.safeNumber(g,"rate"),w=this.safeString(g,"code");return{info:e,id:p,clientOrderId:void 0,timestamp:a,datetime:n,lastTradeTimestamp:o,symbol:i,type:m,timeInForce:void 0,postOnly:void 0,side:b,price:c,stopPrice:void 0,amount:d,cost:l,average:f,filled:h,remaining:u,status:s,fee:{currency:this.safeCurrencyCode(w),cost:y,rate:v},trades:void 0}}async createOrder(e,t,s,i,r,n={}){if(this.checkRequiredDependencies(),void 0===this.apiKey)throw new a("createOrder() requires this.apiKey or userid in params");await this.loadMarkets();const o=this.market(e);let c,d;c="sell"===s?1:2,"limit"===t?d=1:(d=2,r=0);const h=o.normalSymbol,u=o.baseId,l=this.currency(o.base),p=this.amountToPrecision(e,i),m=this.toWei(p,l.precision),b=this.numberToString(m),g=o.quoteId,y=this.currency(o.quote),v=this.priceToPrecision(e,r),w=this.toWei(v,y.precision),k=this.numberToString(w),S=this.milliseconds(),_=this.safeInteger(this.options,"orderExpiration",31536e6),O=this.milliseconds()+_;let T=this.iso8601(S);T=T.split(".")[0];let x=this.iso8601(O);x=x.split(".")[0];const C=this.safeString(n,"dappId","Sagittarius"),I=this.safeString(this.options,"fee","300000000000000"),M=this.safeString(n,"totalFeeRate",8),N=this.safeString(n,"chainFeeRate",1),A=this.safeString(n,"fee",I),E=f.stringPow("2","64"),P=[this.numberToBE(1,32),this.numberToLE(Math.floor(S/1e3),4),this.numberToLE(1,1),this.numberToLE(Math.floor(O/1e3),4),this.numberToLE(1,1),this.numberToLE(32,1),this.numberToLE(0,8),this.numberToLE(A,8),this.numberToLE(this.apiKey.length,1),this.stringToBinary(this.encode(this.apiKey)),this.numberToLE(c,1),this.numberToLE(d,1),this.numberToLE(h.length,1),this.stringToBinary(this.encode(h)),this.numberToLE(f.stringDiv(b,E,0),8),this.numberToLE(f.stringMod(b,E),8),this.numberToLE(f.stringDiv(k,E,0),8),this.numberToLE(f.stringMod(k,E),8),this.numberToLE(0,2),this.numberToLE(Math.floor(S/1e3),4),this.numberToLE(Math.floor(O/1e3),4),this.numberToLE(1,1),this.numberToLE(parseInt(N),2),this.numberToLE(1,1),this.numberToLE(parseInt(M),2),this.numberToLE(parseInt(g),4),this.numberToLE(parseInt(u),4),this.numberToLE(0,1),this.numberToLE(1,1),this.numberToLE(C.length,1),this.stringToBinary(this.encode(C)),this.numberToLE(0,1)],B=[this.numberToLE(Math.floor(S/1e3),4),this.numberToLE(1,1),this.numberToLE(Math.floor(O/1e3),4),this.numberToLE(1,1),this.numberToLE(32,1),this.numberToLE(0,8),this.numberToLE(A,8),this.numberToLE(this.apiKey.length,1),this.stringToBinary(this.encode(this.apiKey)),this.numberToLE(c,1),this.numberToLE(d,1),this.numberToLE(h.length,1),this.stringToBinary(this.encode(h)),this.numberToLE(f.stringDiv(b,E,0),8),this.numberToLE(f.stringMod(b,E),8),this.numberToLE(f.stringDiv(k,E,0),8),this.numberToLE(f.stringMod(k,E),8),this.numberToLE(0,2),this.numberToLE(Math.floor(S/1e3),4),this.numberToLE(Math.floor(O/1e3),4),this.numberToLE(1,1),this.numberToLE(parseInt(N),2),this.numberToLE(1,1),this.numberToLE(parseInt(M),2),this.numberToLE(parseInt(g),4),this.numberToLE(parseInt(u),4),this.numberToLE(0,1),this.numberToLE(1,1),this.numberToLE(C.length,1),this.stringToBinary(this.encode(C)),this.numberToLE(0,1)],V=this.binaryConcatArray(B),L=this.hash(V,"sha256","hex").slice(0,40),q=[this.numberToLE(L.length,1),this.stringToBinary(this.encode(L)),this.numberToBE(0,4)],D=this.binaryConcatArray(q),R=this.hash(D,"sha256","hex").slice(0,40),G=this.binaryConcatArray(P),F=this.hash(G,"sha256","hex"),U=this.ecdsa(F,this.secret,"secp256k1",void 0,!0),j=this.binaryToBase16(this.numberToLE(this.sum(U.v,31),1))+U.r+U.s,H={timestamp:T,expiration:x,operations:[[32,{now:T,expiration:x,fee:A,creator:this.apiKey,side:c,order_type:d,market_name:h,amount:m,price:w,use_btt_as_fee:!1,money_id:parseInt(g),stock_id:parseInt(u),custom_no_btt_fee_rate:parseInt(M),custom_btt_fee_rate:parseInt(N)}]],validate_type:0,dapp:C,signatures:[j]},z={trObj:this.json(H)},W=await this.publicPostTransactionCreateorder(z),K=this.milliseconds(),X="0"===this.safeString(W,"code")?"open":"failed";return{info:W,id:R,timestamp:K,datetime:this.iso8601(K),lastTradeTimestamp:void 0,status:X,symbol:void 0,type:void 0,side:void 0,price:void 0,amount:void 0,filled:void 0,remaining:void 0,cost:void 0,trades:void 0,fee:void 0,clientOrderId:void 0,average:void 0}}async fetchOrder(e,t,s={}){if(!("userid"in s)&&void 0===this.apiKey)throw new a("fetchOrder() requires this.apiKey or userid argument");await this.loadMarkets();const i={userid:this.apiKey};let r;void 0!==t&&(r=this.markets[t],i.symbol=r.id),i.id=e;const n=await this.publicGetOrders(this.extend(i,s));return this.parseOrder(n,r)}async fetchOpenOrders(e,t,s,i={}){if(!("userid"in i)&&void 0===this.apiKey)throw new a("fetchOpenOrders() requires this.apiKey or userid argument");await this.loadMarkets();const r={userid:this.apiKey};let n;void 0!==e&&(n=this.market(e),r.symbol=n.id),void 0!==s&&(r.limit=s),void 0!==t&&(r.since=t);const o=await this.publicGetOrdersOpen(this.extend(r,i));return this.parseOrders(o,n,t,s)}async fetchClosedOrders(e,t,s,i={}){if(!("userid"in i)&&void 0===this.apiKey)throw new a("fetchClosedOrders() requires this.apiKey or userid argument");let r;await this.loadMarkets();const n={userid:this.apiKey};void 0!==e&&(r=this.market(e),n.symbol=r.id),void 0!==s&&(n.limit=s),void 0!==t&&(n.since=t);const o=await this.publicGetOrdersClosed(this.extend(n,i));return this.parseOrders(o,r,t,s)}async fetchOrders(e,t,s,i={}){if(!("userid"in i)&&void 0===this.apiKey)throw new a("fetchOrders() requires this.apiKey or userid argument");let r;await this.loadMarkets();const n={userid:this.apiKey};void 0!==e&&(r=this.market(e),n.symbol=r.id),void 0!==s&&(n.limit=s),void 0!==t&&(n.since=t);const o=await this.publicGetOrdersAll(this.extend(n,i));return this.parseOrders(o,r,t,s)}async cancelOrder(e,t,s={}){if(void 0===this.apiKey)throw new a("cancelOrder() requires hasAlreadyAuthenticatedSuccessfully");if(void 0===t)throw new a(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r=i.baseId,n=i.quoteId,o=i.normalSymbol,c="300000000000000",d=this.milliseconds();let h=this.iso8601(d);h=h.split(".")[0];let u=this.iso8601(0);u=u.split(".")[0];const l=this.safeString(s,"dappId","Sagittarius"),f=[this.numberToBE(1,32),this.numberToLE(Math.floor(d/1e3),4),this.numberToLE(1,1),this.numberToLE(0,4),this.numberToLE(1,1),this.numberToLE(33,1),this.numberToLE(0,8),this.numberToLE(c,8),this.numberToLE(this.apiKey.length,1),this.stringToBinary(this.encode(this.apiKey)),this.numberToLE(o.length,1),this.stringToBinary(this.encode(o)),this.base16ToBinary(e),this.numberToLE(parseInt(n),4),this.numberToLE(parseInt(r),4),this.numberToLE(0,1),this.numberToLE(1,1),this.numberToLE(l.length,1),this.stringToBinary(this.encode(l)),this.numberToLE(0,1)],p=this.binaryConcatArray(f),m=this.hash(p,"sha256","hex"),b=this.ecdsa(m,this.secret,"secp256k1",void 0,!0),g=this.binaryToBase16(this.numberToLE(this.sum(b.v,31),1))+b.r+b.s,y={timestamp:h,expiration:u,operations:[[33,{fee:c,creator:this.apiKey,order_id:e,market_name:o,money_id:parseInt(n),stock_id:parseInt(r)}]],validate_type:0,dapp:l,signatures:[g]},v={trObj:this.json(y)},w=await this.publicPostTransactionCancelorder(v),k=this.milliseconds(),S="0"===this.safeString(w,"code")?"canceled":"failed";return{info:w,id:void 0,timestamp:k,datetime:this.iso8601(k),lastTradeTimestamp:void 0,status:S,symbol:void 0,type:void 0,side:void 0,price:void 0,amount:void 0,filled:void 0,remaining:void 0,cost:void 0,trades:void 0,fee:void 0,clientOrderId:void 0,average:void 0}}async transfer(e,t,s,i,r={}){if(this.checkRequiredDependencies(),void 0===this.apiKey)throw new a("transfer() requires this.apiKey");await this.loadMarkets();const n=this.currency(e),o=this.decimalToPrecision(t,h,n.info.basePrecision-n.info.transferPrecision,l,u),c=this.toWei(o,n.precision),d=this.numberToString(c),p=parseInt(n.id),m=this.milliseconds(),b=m;let g=this.iso8601(m);g=g.split(".")[0];let y=this.iso8601(b);y=y.split(".")[0];const v=this.safeString(r,"message",""),w=this.safeString(r,"dappId","Sagittarius"),k=f.stringPow("2","64"),S=[this.numberToBE(1,32),this.numberToLE(Math.floor(m/1e3),4),this.numberToLE(1,1),this.numberToLE(Math.floor(b/1e3),4),this.numberToLE(1,1),this.numberToLE(28,1),this.numberToLE(0,8),this.numberToLE("300000000000000",8),this.numberToLE(this.apiKey.length,1),this.stringToBinary(this.encode(this.apiKey)),this.numberToLE(i.length,1),this.stringToBinary(this.encode(i)),this.numberToLE(p,4),this.numberToLE(f.stringDiv(d,k,0),8),this.numberToLE(f.stringMod(d,k),8),this.numberToLE(1,1),this.numberToLE(v.length,1),this.stringToBinary(this.encode(v)),this.numberToLE(0,1),this.numberToLE(1,1),this.numberToLE(w.length,1),this.stringToBinary(this.encode(w)),this.numberToLE(0,1)],_=this.binaryConcatArray(S),O=this.hash(_,"sha256","hex"),T=this.ecdsa(O,this.secret,"secp256k1",void 0,!0),x=this.binaryToBase16(this.numberToLE(this.sum(T.v,31),1))+T.r+T.s,C={timestamp:g,expiration:y,operations:[[28,{fee:"300000000000000",from:this.apiKey,to:i,asset_type:parseInt(n.id),amount:c.toString(),message:v}]],validate_type:0,dapp:w,signatures:[x]},I={trObj:this.json(C)},M=await this.publicPostTransactionTransfer(I),N=this.milliseconds();let A="";return A="0"===this.safeString(M,"code")?"submit success":"submit fail",{info:M,id:"",timestamp:N,datetime:this.iso8601(N),lastTradeTimestamp:void 0,status:A,symbol:void 0,type:void 0,side:void 0,price:void 0,amount:void 0,filled:void 0,remaining:void 0,cost:void 0,fee:void 0,clientOrderId:void 0,average:void 0,trades:void 0}}async fetchMyTrades(e,t,s,i={}){if(!("userid"in i)&&void 0===this.apiKey)throw new a("fetchMyTrades() requires this.apiKey or userid argument");await this.loadMarkets();const r=this.market(e),n={userid:this.apiKey};void 0!==e&&(n.symbol=r.id),void 0!==s&&(n.limit=s),void 0!==t&&(n.since=t);const o=await this.publicGetOrdersTrades(this.extend(n,i));return this.parseTrades(o,r,t,s)}async fetchDeposits(e,t,s,i={}){if(await this.loadMarkets(),!("userid"in i)&&void 0===this.apiKey)throw new a("fetchDeposits() requires this.apiKey or userid argument");let r;const n={userid:this.apiKey};void 0!==e&&(r=this.currency(e),n.currency=r.id),void 0!==t&&(n.since=t),void 0!==s&&(n.limit=s);const o=await this.publicGetDeposits(this.extend(n,i));return this.parseTransactions(o,r,t,s)}async fetchWithdrawals(e,t,s,i={}){if(await this.loadMarkets(),!("userid"in i)&&void 0===this.apiKey)throw new a("fetchWithdrawals() requires this.apiKey or userid argument");let r;const n={userid:this.apiKey};void 0!==e&&(r=this.currency(e),n.currency=r.id),void 0!==t&&(n.since=t),void 0!==s&&(n.limit=s);const o=await this.publicGetWithdrawals(this.extend(n,i));return this.parseTransactions(o,r,t,s)}parseTransactionStatus(e){return this.safeString({DEPOSIT_FAILED:"failed",FEE_SEND_FAILED:"failed",FEE_FAILED:"failed",PAY_SEND_FAILED:"failed",PAY_FAILED:"failed",BTT_FAILED:"failed",WITHDDRAW_FAILED:"failed",USER_FAILED:"failed",FEE_EXECUED:"pending",PAY_EXECUED:"pending",WITHDDRAW_EXECUTED:"pending",USER_EXECUED:"pending",BTT_SUCCED:"ok"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"address");let r=this.safeString(e,"tag");void 0!==r&&r.length<1&&(r=void 0);const a=this.safeValue(e,"txid"),n=this.safeString(e,"code"),o=this.safeCurrencyCode(n,t),c=this.safeInteger(e,"timestamp"),d=this.safeString(e,"datetime"),h=this.safeString(e,"type"),u=this.parseTransactionStatus(this.safeString(e,"status")),l=this.safeNumber(e,"amount"),f=this.safeValue(e,"fee"),p=this.safeNumber(f,"cost"),m=this.safeString(f,"code");return{info:e,id:s,txid:a,timestamp:c,datetime:d,address:i,tag:r,type:h,amount:l,currency:o,status:u,updated:void 0,fee:{cost:p,currency:this.safeCurrencyCode(m,t)}}}async fetchDepositAddress(e,t={}){if(await this.loadMarkets(),!("userid"in t)&&void 0===this.apiKey)throw new a("fetchDepositAddress() requires this.apiKey or userid argument");const s=this.currency(e),i={userid:this.apiKey,code:s.id},r=await this.publicGetDepositaddress(i),n=this.safeString(r[0],"address"),o=this.safeString(r[0],"tag"),c=this.safeString(r[0],"chainType");return this.checkAddress(n),{currency:e,address:n,tag:o,chainType:c,info:r}}async withdraw(e,t,s,i,r={}){if(this.checkRequiredDependencies(),this.checkAddress(s),await this.loadMarkets(),void 0===this.apiKey)throw new a(this.id+" withdraw() requires this.apiKey");const n=await this.fetchDepositAddress(e),o=this.safeString(n,"chainType"),c=this.safeString(n.info[0],"chainId");let d="";d="eos"===o?s:this.safeString(n,"address");let p=18;"ethereum"!==o&&"etc"!==o&&"eos"!==o&&"cmt"!==o&&"naka"!==o&&(p=26);const m=this.milliseconds();let b=this.iso8601(m);b=b.split(".")[0];let g=this.iso8601(0);g=g.split(".")[0];const y=this.safeString(r,"dappId","Sagittarius"),v="300000000000000",w=this.currency(e),k=w.id,S=this.decimalToPrecision(t,h,w.info.basePrecision-w.info.transferPrecision,l,u),_=this.toWei(S,w.info.externalPrecision),O=this.numberToString(_),T=f.stringPow("2","64");let x=0,C=[];26===p?(x=w.info.fee,C=[this.numberToBE(1,32),this.numberToLE(Math.floor(m/1e3),4),this.numberToLE(1,1),this.numberToLE(Math.floor(0),4),this.numberToLE(1,1),this.numberToLE(p,1),this.numberToLE(0,8),this.numberToLE(v,8),this.numberToLE(this.apiKey.length,1),this.stringToBinary(this.encode(this.apiKey)),this.numberToLE(s.length,1),this.stringToBinary(this.encode(s)),this.numberToLE(parseInt(k),4),this.numberToLE(f.stringDiv(O,T,0),8),this.numberToLE(f.stringMod(O,T),8),this.numberToLE(1,1),this.numberToLE(f.stringDiv(x,T,0),8),this.numberToLE(f.stringMod(x,T),8),this.numberToLE(0,1),this.numberToLE(1,1),this.numberToLE(y.length,1),this.stringToBinary(this.encode(y)),this.numberToLE(0,1)]):C=[this.numberToBE(1,32),this.numberToLE(Math.floor(m/1e3),4),this.numberToLE(1,1),this.numberToLE(Math.floor(0),4),this.numberToLE(1,1),this.numberToLE(p,1),this.numberToLE(0,8),this.numberToLE(v,8),this.numberToLE(this.apiKey.length,1),this.stringToBinary(this.encode(this.apiKey)),this.numberToLE(Math.floor(m/1e3),4),this.numberToLE(1,1),this.numberToLE(4,1),this.numberToLE(0,8),this.numberToLE(v,8),this.numberToLE(this.apiKey.length,1),this.stringToBinary(this.encode(this.apiKey)),this.numberToLE(d.length,1),this.stringToBinary(this.encode(d)),this.numberToLE(parseInt(k),4),this.numberToLE(f.stringDiv(O,T,0),8),this.numberToLE(f.stringMod(O,T),8),this.numberToLE(0,1),this.numberToLE(1,1),this.numberToLE(y.length,1),this.stringToBinary(this.encode(y)),this.numberToLE(0,1)];const I=this.binaryConcatArray(C),M=this.hash(I,"sha256","hex"),N=this.ecdsa(M,this.secret,"secp256k1",void 0,!0),A=this.binaryToBase16(this.numberToLE(this.sum(N.v,31),1))+N.r+N.s;let E,P,B;const V=this.safeString(w.info,"chainContractAddress");if(26===p)B={fee:v,from:this.apiKey,to_external_address:s,asset_type:parseInt(k),amount:_,asset_fee:x},E={timestamp:b,expiration:g,operations:[[p,B]],validate_type:0,dapp:y,signatures:[A]},P={chainType:c,trObj:this.json(E),chainContractAddress:V};else{B={fee:v,from:this.apiKey,to_external_address:d,asset_type:parseInt(k),amount:_,asset_fee:x};E={timestamp:b,expiration:g,operations:[[p,{fee:v,proposaler:this.apiKey,expiration_time:b,proposed_ops:[{op:[4,B]}]}]],validate_type:0,dapp:y,signatures:[A]},P="eos"===o?{chainType:c,toExternalAddress:"noneed",trObj:this.json(E),chainContractAddress:V}:{chainType:c,toExternalAddress:s,trObj:this.json(E),chainContractAddress:V}}const L=await this.publicPostTransactionWithdraw(P);return{info:L,id:this.safeString(L,"id")}}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t];return n+="/"+e,Object.keys(i).length&&(n+="?"+this.urlencode(i)),{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,d,h){if(503===e)throw new c(this.id+" "+e.toString()+" "+t+" "+n);if(void 0!==o&&"code"in o){if("1"===this.safeString(o,"code")){const e=this.safeString(o,"msg"),t=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions,e,t),new r(t)}}}}},9124:(e,t,s)=>{"use strict";const i=s(3775);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"cdax",name:"CDAX",countries:["RU"],hostname:"cdax.io",pro:!1,urls:{logo:"https://user-images.githubusercontent.com/1294454/102157692-fd406280-3e90-11eb-8d46-4511b617cd17.jpg",api:{market:"https://{hostname}/api",public:"https://{hostname}/api",private:"https://{hostname}/api",v2Public:"https://{hostname}/api",v2Private:"https://{hostname}/api"},www:"https://cdax.io",referral:"https://cdax.io/invite?invite_code=esc74",doc:"https://github.com/cloudapidoc/API_Docs",fees:"https://cdax.io/about/fee"}})}}},4228:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,AuthenticationError:n,NullResponse:o,InvalidOrder:c,NotSupported:d,InsufficientFunds:h,InvalidNonce:u,OrderNotFound:l,RateLimitExceeded:f,DDoSProtection:p}=s(3449),m=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"cex",name:"CEX.IO",countries:["GB","EU","CY","RU"],rateLimit:1500,has:{cancelOrder:!0,CORS:!1,createOrder:!0,editOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchMarkets:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0},timeframes:{"1m":"1m"},urls:{logo:"https://user-images.githubusercontent.com/1294454/27766442-8ddc33b0-5ed8-11e7-8b98-f786aef0f3c9.jpg",api:"https://cex.io/api",www:"https://cex.io",doc:"https://cex.io/cex-api",fees:["https://cex.io/fee-schedule","https://cex.io/limits-commissions"],referral:"https://cex.io/r/0/up105393824/0/"},requiredCredentials:{apiKey:!0,secret:!0,uid:!0},api:{public:{get:["currency_profile","currency_limits/","last_price/{pair}/","last_prices/{currencies}/","ohlcv/hd/{yyyymmdd}/{pair}","order_book/{pair}/","ticker/{pair}/","tickers/{currencies}/","trade_history/{pair}/"],post:["convert/{pair}","price_stats/{pair}"]},private:{post:["active_orders_status/","archived_orders/{pair}/","balance/","cancel_order/","cancel_orders/{pair}/","cancel_replace_order/{pair}/","close_position/{pair}/","get_address/","get_myfee/","get_order/","get_order_tx/","open_orders/{pair}/","open_orders/","open_position/{pair}/","open_positions/{pair}/","place_order/{pair}/","raw_tx_history"]}},fees:{trading:{maker:.0016,taker:.0025},funding:{withdraw:{BTC:.001,ETH:.01,BCH:.001,DASH:.01,BTG:.001,ZEC:.001,XRP:.02},deposit:{BTC:0,ETH:0,BCH:0,DASH:0,BTG:0,ZEC:0,XRP:0,XLM:0}}},exceptions:{exact:{},broad:{"Insufficient funds":h,"Nonce must be incremented":u,"Invalid Order":c,"Order not found":l,"limit exceeded":f,"Invalid API key":n,"There was an error while placing your order":c,"Sorry, too many clients already":p}},options:{fetchOHLCVWarning:!0,createMarketBuyOrderRequiresPrice:!0,order:{status:{c:"canceled",d:"closed",cd:"canceled",a:"open"}}}})}async fetchCurrenciesFromCache(e={}){const t=this.safeValue(this.options,"fetchCurrencies",{}),s=this.safeInteger(t,"timestamp"),i=this.safeInteger(t,"expires",1e3),r=this.milliseconds();if(void 0===s||r-s>i){const s=await this.publicGetCurrencyProfile(e);this.options.fetchCurrencies=this.extend(t,{response:s,timestamp:r})}return this.safeValue(this.options.fetchCurrencies,"response")}async fetchCurrencies(e={}){const t=await this.fetchCurrenciesFromCache(e);this.options.currencies={timestamp:this.milliseconds(),response:t};const s=this.safeValue(t,"data",[]),i=this.safeValue(s,"symbols",[]),r={};for(let e=0;e<i.length;e++){const t=i[e],s=this.safeString(t,"code"),a=this.safeCurrencyCode(s),n=this.safeInteger(t,"precision"),o=!0;r[a]={id:s,code:a,name:s,active:o,precision:n,fee:void 0,limits:{amount:{min:this.safeNumber(t,"minimumCurrencyAmount"),max:void 0},withdraw:{min:this.safeNumber(t,"minimalWithdrawalAmount"),max:void 0}},info:t}}return r}async fetchMarkets(e={}){const t=await this.fetchCurrenciesFromCache(e),s=this.safeValue(t,"data",{}),i=this.safeValue(s,"symbols",[]),r=this.indexBy(i,"code"),a=this.safeValue(s,"pairs",[]),n=await this.publicGetCurrencyLimits(e),o=[],c=this.safeValue(n.data,"pairs");for(let e=0;e<c.length;e++){const t=c[e],s=this.safeString(t,"symbol1"),i=this.safeString(t,"symbol2"),n=s+"/"+i,d=this.safeCurrencyCode(s),h=this.safeCurrencyCode(i),u=d+"/"+h,l=this.safeValue(r,s,{}),f=this.safeValue(r,i,{});let p=this.safeInteger(f,"precision",8);for(let e=0;e<a.length;e++){const t=a[e];t.symbol1===s&&t.symbol2===i&&(p=this.safeInteger(t,"pricePrecision",p))}const m={amount:this.safeInteger(l,"precision",8)-this.safeInteger(l,"scale",0),price:p};o.push({id:n,info:t,symbol:u,base:d,quote:h,baseId:s,quoteId:i,precision:m,limits:{amount:{min:this.safeNumber(t,"minLotSize"),max:this.safeNumber(t,"maxLotSize")},price:{min:this.safeNumber(t,"minPrice"),max:this.safeNumber(t,"maxPrice")},cost:{min:this.safeNumber(t,"minLotSizeS2"),max:void 0}},active:void 0})}return o}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostBalance(e),s={info:t},i=this.omit(t,["username","timestamp"]),r=Object.keys(i);for(let e=0;e<r.length;e++){const t=r[e],a=this.safeValue(i,t,{}),n=this.account();n.free=this.safeString(a,"available"),n.used=this.safeString(a,"orders","0");s[this.safeCurrencyCode(t)]=n}return this.parseBalance(s,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={pair:this.marketId(e)};void 0!==t&&(i.depth=t);const r=await this.publicGetOrderBookPair(this.extend(i,s)),a=this.safeTimestamp(r,"timestamp");return this.parseOrderBook(r,e,a)}parseOHLCV(e,t){return[this.safeTimestamp(e,0),this.safeNumber(e,1),this.safeNumber(e,2),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,5)]}async fetchOHLCV(e,t="1m",s,i,a={}){await this.loadMarkets();const n=this.market(e);if(void 0===s)s=this.milliseconds()-864e5;else if(this.options.fetchOHLCVWarning)throw new r(this.id+" fetchOHLCV warning: CEX can return historical candles for a certain date only, this might produce an empty or null reply. Set exchange.options['fetchOHLCVWarning'] = false or add ({ 'options': { 'fetchOHLCVWarning': false }}) to constructor params to suppress this warning message.");let c=this.ymd(s);c=c.split("-"),c=c.join("");const d={pair:n.id,yyyymmdd:c};try{const e=await this.publicGetOhlcvHdYyyymmddPair(this.extend(d,a)),r="data"+this.timeframes[t],o=this.safeString(e,r),c=JSON.parse(o);return this.parseOHLCVs(c,n,t,s,i)}catch(e){if(e instanceof o)return[]}}parseTicker(e,t){const s=this.safeTimestamp(e,"timestamp"),i=this.safeNumber(e,"volume"),r=this.safeNumber(e,"high"),a=this.safeNumber(e,"low"),n=this.safeNumber(e,"bid"),o=this.safeNumber(e,"ask"),c=this.safeNumber(e,"last");let d;return t&&(d=t.symbol),{symbol:d,timestamp:s,datetime:this.iso8601(s),high:r,low:a,bid:n,bidVolume:void 0,ask:o,askVolume:void 0,vwap:void 0,open:void 0,close:c,last:c,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:i,quoteVolume:void 0,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s={currencies:Object.keys(this.currencies).join("/")},i=(await this.publicGetTickersCurrencies(this.extend(s,t))).data,r={};for(let e=0;e<i.length;e++){const t=i[e],s=t.pair.replace(":","/"),a=this.markets[s];r[s]=this.parseTicker(t,a)}return this.filterByArray(r,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={pair:s.id},r=await this.publicGetTickerPair(this.extend(i,t));return this.parseTicker(r,s)}parseTrade(e,t){const s=this.safeTimestamp(e,"date"),i=this.safeString(e,"tid"),r=this.safeString(e,"type"),a=this.safeString(e,"price"),n=this.safeString(e,"amount"),o=this.parseNumber(a),c=this.parseNumber(n),d=this.parseNumber(m.stringMul(a,n));let h;return void 0!==t&&(h=t.symbol),{info:e,id:i,timestamp:s,datetime:this.iso8601(s),symbol:h,type:undefined,side:r,order:void 0,takerOrMaker:void 0,price:o,amount:c,cost:d,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={pair:r.id},n=await this.publicGetTradeHistoryPair(this.extend(a,i));return this.parseTrades(n,r,t,s)}async createOrder(e,t,s,i,r,a={}){if("market"===t&&"buy"===s&&this.options.createMarketBuyOrderRequiresPrice){if(void 0===r)throw new c(this.id+" createOrder() requires the price argument with market buy orders to calculate total order cost (amount to spend), where cost = amount * price. Supply a price argument to createOrder() call if you want the cost to be calculated for you from price and amount, or, alternatively, add .options['createMarketBuyOrderRequiresPrice'] = false to supply the cost in the amount argument (the exchange-specific behaviour)");i*=r}await this.loadMarkets();const n={pair:this.marketId(e),type:s,amount:i};"limit"===t?n.price=r:n.order_type=t;const o=await this.privatePostPlaceOrderPair(this.extend(n,a)),d=this.safeNumber(o,"amount"),h=this.safeNumber(o,"pending"),u=this.safeValue(o,"time"),l=this.safeValue(o,"complete")?"closed":"open";let f;return void 0!==d&&void 0!==h&&(f=Math.max(d-h,0)),{id:this.safeString(o,"id"),info:o,clientOrderId:void 0,timestamp:u,datetime:this.iso8601(u),lastTradeTimestamp:void 0,type:t,side:this.safeString(o,"type"),symbol:e,status:l,price:this.safeNumber(o,"price"),amount:d,cost:void 0,average:void 0,remaining:h,filled:f,fee:void 0,trades:void 0}}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={id:e};return await this.privatePostCancelOrder(this.extend(i,s))}parseOrder(e,t){let s,i=this.safeValue(e,"time");if(i="string"==typeof i&&i.indexOf("T")>=0?this.parse8601(i):parseInt(i),void 0===t){const i=this.safeString(e,"symbol1"),r=this.safeString(e,"symbol2");s=this.safeCurrencyCode(i)+"/"+this.safeCurrencyCode(r),s in this.markets&&(t=this.market(s))}const r=this.parseOrderStatus(this.safeString(e,"status")),a=this.safeNumber(e,"price");let n=this.safeNumber(e,"amount");void 0!==n&&(n=Math.abs(n));const o=this.safeNumber2(e,"pending","remains"),c=n-o;let d,h;if(void 0!==t){s=t.symbol;const i=this.safeNumber(e,"ta:"+t.quote),r=this.safeNumber(e,"tta:"+t.quote);h=this.sum(i,r);const a="fa:"+t.base,n="tfa:"+t.base,o="fa:"+t.quote,c="tfa:"+t.quote;let u=this.safeNumber(e,"tradingFeeMaker");if(u||(u=this.safeNumber(e,"tradingFeeTaker",u)),u&&(u/=100),a in e||n in e){const s=this.safeNumber2(e,a,n);d={currency:t.base,rate:u,cost:s}}else if(o in e||c in e){const s=this.safeNumber2(e,o,c);d={currency:t.quote,rate:u,cost:s}}}h||(h=a*c);const u=e.type;let l;const f=e.id;if("vtx"in e){l=[];for(let i=0;i<e.vtx.length;i++){const r=e.vtx[i],a=this.safeString(r,"type");if("cancel"===a)continue;const n=this.safeNumber(r,"price");if(void 0===n)continue;if("costsNothing"===a)continue;const o=this.parse8601(this.safeString(r,"time")),c=this.safeNumber(r,"amount"),d=this.safeNumber(r,"fee_amount");let h,u=c<0?-c:c;"sell"===a?(h=u,u=this.sum(d,h)/n):h=u*n,l.push({id:this.safeString(r,"id"),timestamp:o,datetime:this.iso8601(o),order:f,symbol:s,price:n,amount:u,cost:h,side:a,fee:{cost:d,currency:t.quote},info:r,type:void 0,takerOrMaker:void 0})}}return{id:f,clientOrderId:void 0,datetime:this.iso8601(i),timestamp:i,lastTradeTimestamp:void 0,status:r,symbol:s,type:void 0===a?"market":"limit",timeInForce:void 0,postOnly:void 0,side:u,price:a,stopPrice:void 0,cost:h,amount:n,filled:c,remaining:o,trades:l,fee:d,info:e,average:void 0}}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a,n="privatePostOpenOrders";void 0!==e&&(a=this.market(e),r.pair=a.id,n+="Pair");const o=await this[n](this.extend(r,i));for(let e=0;e<o.length;e++)o[e]=this.extend(o[e],{status:"open"});return this.parseOrders(o,a,t,s)}async fetchClosedOrders(e,t,s,i={}){await this.loadMarkets();if(void 0===e)throw new a(this.id+" fetchClosedOrders() requires a symbol argument");const r=this.market(e),n={pair:r.id},o=await this.privatePostArchivedOrdersPair(this.extend(n,i));return this.parseOrders(o,r,t,s)}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={id:e.toString()},r=await this.privatePostGetOrderTx(this.extend(i,s)),a=this.safeValue(r,"data",{});return this.parseOrder(a)}async fetchOrders(e,t,s,i={}){await this.loadMarkets();const r={limit:s,pair:this.market(e).id,dateFrom:t},a=await this.privatePostArchivedOrdersPair(this.extend(r,i)),n=[];for(let e=0;e<a.length;e++){const t=a[e],s=this.parseOrderStatus(this.safeString(t,"status")),i=this.safeString(t,"symbol1"),r=this.safeString(t,"symbol2"),o=this.safeCurrencyCode(i),c=this.safeCurrencyCode(r),d=o+"/"+c,h=this.safeString(t,"type"),u=this.safeNumber(t,"a:"+i+":cds"),l=this.safeNumber(t,"a:"+r+":cds"),f=this.safeNumber(t,"f:"+r+":cds"),p=this.safeNumber(t,"amount"),m=this.safeNumber(t,"price"),b=this.safeNumber(t,"remains"),g=p-b;let y,v,w,k;if(m){const e=this.safeNumber(t,"ta:"+r,0),s=this.safeNumber(t,"tta:"+r,0),i=this.safeNumber(t,"fa:"+r,0),a=this.safeNumber(t,"tfa:"+r,0);v="sell"===h?this.sum(this.sum(e,s),this.sum(i,a)):this.sum(e,s)-this.sum(i,a),k="limit",y=p,w=v/g}else k="market",y=u,v=l,w=y/v;const S=this.safeString(t,"time"),_=this.safeString(t,"lastTxTime"),O=this.parse8601(S);n.push({id:this.safeString(t,"id"),timestamp:O,datetime:this.iso8601(O),lastUpdated:this.parse8601(_),status:s,symbol:d,side:h,price:m,amount:y,average:w,type:k,filled:g,cost:v,remaining:b,fee:{cost:f,currency:c},info:t})}return n}parseOrderStatus(e){return this.safeString(this.options.order.status,e,e)}async editOrder(e,t,s,i,r,n,o={}){if(void 0===r)throw new a(this.id+" editOrder() requires a amount argument");if(void 0===n)throw new a(this.id+" editOrder() requires a price argument");await this.loadMarkets();const c=this.market(t),d={pair:c.id,type:i,amount:r,price:n,order_id:e},h=await this.privatePostCancelReplaceOrderPair(this.extend(d,o));return this.parseOrder(h,c)}async fetchDepositAddress(e,t={}){if("XRP"===e||"XLM"===e)throw new d(this.id+" fetchDepositAddress does not support XRP and XLM addresses yet (awaiting docs from CEX.io)");await this.loadMarkets();const s={currency:this.currency(e).id},i=await this.privatePostGetAddress(this.extend(s,t)),r=this.safeString(i,"data");return this.checkAddress(r),{currency:e,address:r,tag:void 0,info:i}}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if("public"===t)Object.keys(o).length&&(n+="?"+this.urlencode(o));else{this.checkRequiredCredentials();const e=this.nonce().toString(),t=e+this.uid+this.apiKey,s=this.hmac(this.encode(t),this.encode(this.secret));a=this.json(this.extend({key:this.apiKey,signature:s.toUpperCase(),nonce:e},o)),r={"Content-Type":"application/json"}}return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,c,d,h){if(Array.isArray(c))return c;if("true"!==n){if(void 0===c)throw new o(this.id+" returned "+this.json(c));if((!("e"in c)||!("ok"in c)||"ok"!==c.ok)&&"error"in c){const e=this.safeString(c,"error"),t=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,e,t),this.throwBroadlyMatchedException(this.exceptions.broad,e,t),new r(t)}}}}},2939:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,AuthenticationError:n,RateLimitExceeded:o,InvalidNonce:c}=s(3449),d=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"coinbase",name:"Coinbase",countries:["US"],rateLimit:400,version:"v2",userAgent:this.userAgents.chrome,headers:{"CB-VERSION":"2018-05-30"},has:{CORS:!0,cancelOrder:!1,createDepositAddress:!0,createOrder:!1,deposit:!1,fetchBalance:!0,fetchClosedOrders:!1,fetchCurrencies:!0,fetchDepositAddress:!1,fetchMarkets:!0,fetchMyTrades:!1,fetchOHLCV:!1,fetchOpenOrders:!1,fetchOrder:!1,fetchOrderBook:!1,fetchL2OrderBook:!1,fetchLedger:!0,fetchOrders:!1,fetchTicker:!0,fetchTickers:!1,fetchTime:!0,fetchBidsAsks:!1,fetchTrades:!1,withdraw:!1,fetchTransactions:!1,fetchDeposits:!0,fetchWithdrawals:!0,fetchMySells:!0,fetchMyBuys:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/40811661-b6eceae2-653a-11e8-829e-10bfadb078cf.jpg",api:"https://api.coinbase.com",www:"https://www.coinbase.com",doc:"https://developers.coinbase.com/api/v2",fees:"https://support.coinbase.com/customer/portal/articles/2109597-buy-sell-bank-transfer-fees",referral:"https://www.coinbase.com/join/58cbe25a355148797479dbd2"},requiredCredentials:{apiKey:!0,secret:!0},api:{public:{get:["currencies","time","exchange-rates","users/{user_id}","prices/{symbol}/buy","prices/{symbol}/sell","prices/{symbol}/spot"]},private:{get:["accounts","accounts/{account_id}","accounts/{account_id}/addresses","accounts/{account_id}/addresses/{address_id}","accounts/{account_id}/addresses/{address_id}/transactions","accounts/{account_id}/transactions","accounts/{account_id}/transactions/{transaction_id}","accounts/{account_id}/buys","accounts/{account_id}/buys/{buy_id}","accounts/{account_id}/sells","accounts/{account_id}/sells/{sell_id}","accounts/{account_id}/deposits","accounts/{account_id}/deposits/{deposit_id}","accounts/{account_id}/withdrawals","accounts/{account_id}/withdrawals/{withdrawal_id}","payment-methods","payment-methods/{payment_method_id}","user","user/auth"],post:["accounts","accounts/{account_id}/primary","accounts/{account_id}/addresses","accounts/{account_id}/transactions","accounts/{account_id}/transactions/{transaction_id}/complete","accounts/{account_id}/transactions/{transaction_id}/resend","accounts/{account_id}/buys","accounts/{account_id}/buys/{buy_id}/commit","accounts/{account_id}/sells","accounts/{account_id}/sells/{sell_id}/commit","accounts/{account_id}/deposists","accounts/{account_id}/deposists/{deposit_id}/commit","accounts/{account_id}/withdrawals","accounts/{account_id}/withdrawals/{withdrawal_id}/commit"],put:["accounts/{account_id}","user"],delete:["accounts/{id}","accounts/{account_id}/transactions/{transaction_id}"]}},exceptions:{exact:{two_factor_required:n,param_required:r,validation_error:r,invalid_request:r,personal_details_required:n,identity_verification_required:n,jumio_verification_required:n,jumio_face_match_verification_required:n,unverified_email:n,authentication_error:n,invalid_token:n,revoked_token:n,expired_token:n,invalid_scope:n,not_found:r,rate_limit_exceeded:o,internal_server_error:r},broad:{"request timestamp expired":c}},commonCurrencies:{CGLD:"CELO"},options:{fetchCurrencies:{expires:5e3},accounts:["wallet","fiat"]}})}async fetchTime(e={}){const t=await this.publicGetTime(e),s=this.safeValue(t,"data",{});return this.safeTimestamp(s,"epoch")}async fetchAccounts(e={}){await this.loadMarkets();const t=await this.privateGetAccounts(this.extend({limit:100},e)),s=this.safeValue(t,"data",[]),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeValue(t,"currency",{}),a=this.safeString(r,"code"),n=this.safeCurrencyCode(a);i.push({id:this.safeString(t,"id"),type:this.safeString(t,"type"),code:n,info:t})}return i}async createDepositAddress(e,t={}){let s=this.safeString(t,"account_id");if(t=this.omit(t,"account_id"),void 0===s){await this.loadAccounts();for(let t=0;t<this.accounts.length;t++){const i=this.accounts[t];if(i.code===e&&"wallet"===i.type){s=i.id;break}}}if(void 0===s)throw new r(this.id+" createDepositAddress could not find the account with matching currency code, specify an `account_id` extra param");const i={account_id:s},a=await this.privatePostAccountsAccountIdAddresses(this.extend(i,t)),n=this.safeValue(a,"data",{});return{currency:e,tag:this.safeString(n,"destination_tag"),address:this.safeString(n,"address"),info:a}}async fetchMySells(e,t,s,i={}){const r=await this.prepareAccountRequest(s,i);await this.loadMarkets();const a=this.omit(i,["account_id","accountId"]),n=await this.privateGetAccountsAccountIdSells(this.extend(r,a));return this.parseTrades(n.data,void 0,t,s)}async fetchMyBuys(e,t,s,i={}){const r=await this.prepareAccountRequest(s,i);await this.loadMarkets();const a=this.omit(i,["account_id","accountId"]),n=await this.privateGetAccountsAccountIdBuys(this.extend(r,a));return this.parseTrades(n.data,void 0,t,s)}async fetchTransactionsWithMethod(e,t,s,i,r={}){const a=await this.prepareAccountRequestWithCurrencyCode(t,i,r);await this.loadMarkets();const n=this.omit(r,["account_id","accountId"]),o=await this[e](this.extend(a,n));return this.parseTransactions(o.data,void 0,s,i)}async fetchWithdrawals(e,t,s,i={}){return await this.fetchTransactionsWithMethod("privateGetAccountsAccountIdWithdrawals",e,t,s,i)}async fetchDeposits(e,t,s,i={}){return await this.fetchTransactionsWithMethod("privateGetAccountsAccountIdDeposits",e,t,s,i)}parseTransactionStatus(e){return this.safeString({created:"pending",completed:"ok",canceled:"canceled"},e,e)}parseTransaction(e,t){const s=this.safeValue(e,"subtotal",{}),i=this.safeValue(e,"fee",{}),r=this.safeString(e,"id"),a=this.parse8601(this.safeValue(e,"created_at")),n=this.parse8601(this.safeValue(e,"updated_at")),o=this.safeString(e,"resource"),c=this.safeNumber(s,"amount"),d=this.safeString(s,"currency"),h=this.safeCurrencyCode(d),u=this.safeNumber(i,"amount"),l=this.safeString(i,"currency"),f={cost:u,currency:this.safeCurrencyCode(l)};let p=this.parseTransactionStatus(this.safeString(e,"status"));if(void 0===p){p=this.safeValue(e,"committed")?"ok":"pending"}return{info:e,id:r,txid:r,timestamp:a,datetime:this.iso8601(a),address:void 0,tag:void 0,type:o,amount:c,currency:h,status:p,updated:n,fee:f}}parseTrade(e,t){let s;const i=this.safeValue(e,"total",{}),r=this.safeValue(e,"amount",{}),a=this.safeValue(e,"subtotal",{}),n=this.safeValue(e,"fee",{}),o=this.safeString(e,"id"),c=this.parse8601(this.safeValue(e,"created_at"));if(void 0===t){const e=this.safeString(r,"currency"),t=this.safeString(i,"currency");if(void 0!==e&&void 0!==t){s=this.safeCurrencyCode(e)+"/"+this.safeCurrencyCode(t)}}const h=this.safeString(e,"resource"),u=this.safeString(a,"amount"),l=this.safeString(r,"amount"),f=this.parseNumber(u),p=this.parseNumber(l),m=this.parseNumber(d.stringDiv(u,l)),b=this.safeNumber(n,"amount"),g=this.safeString(n,"currency"),y={cost:b,currency:this.safeCurrencyCode(g)};return{info:e,id:o,order:undefined,timestamp:c,datetime:this.iso8601(c),symbol:s,type:undefined,side:h,takerOrMaker:void 0,price:m,amount:p,cost:f,fee:y}}async fetchMarkets(e={}){const t=await this.fetchCurrenciesFromCache(e),s=this.safeValue(t,"currencies",{}),i=this.safeValue(t,"exchangeRates",{}),r=this.safeValue(s,"data",[]),a=this.indexBy(r,"id"),n=this.safeValue(this.safeValue(i,"data",{}),"rates",{}),o=Object.keys(n),c=[];for(let e=0;e<o.length;e++){const t=o[e],s=this.safeCurrencyCode(t);if("crypto"===(t in a?"fiat":"crypto"))for(let e=0;e<r.length;e++){const i=r[e],a=this.safeString(i,"id"),n=this.safeCurrencyCode(a),o=s+"/"+n,d=t+"-"+a;c.push({id:d,symbol:o,base:s,quote:n,baseId:t,quoteId:a,active:void 0,info:i,precision:{amount:void 0,price:void 0},limits:{amount:{min:void 0,max:void 0},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(i,"min_size"),max:void 0}}})}}return c}async fetchCurrenciesFromCache(e={}){const t=this.safeValue(this.options,"fetchCurrencies",{}),s=this.safeInteger(t,"timestamp"),i=this.safeInteger(t,"expires",1e3),r=this.milliseconds();if(void 0===s||r-s>i){const s=await this.publicGetCurrencies(e),i=await this.publicGetExchangeRates(e);this.options.fetchCurrencies=this.extend(t,{currencies:s,exchangeRates:i,timestamp:r})}return this.safeValue(this.options,"fetchCurrencies",{})}async fetchCurrencies(e={}){const t=await this.fetchCurrenciesFromCache(e),s=this.safeValue(t,"currencies",{}),i=this.safeValue(t,"exchangeRates",{}),r=this.safeValue(s,"data",[]),a=this.indexBy(r,"id"),n=this.safeValue(this.safeValue(i,"data",{}),"rates",{}),o=Object.keys(n),c={};for(let e=0;e<o.length;e++){const t=o[e],s=t in a?"fiat":"crypto",i=this.safeValue(a,t,{}),r=this.safeString(i,"id",t),n=this.safeString(i,"name"),d=this.safeCurrencyCode(r);c[d]={id:r,code:d,info:i,type:s,name:n,active:!0,fee:void 0,precision:void 0,limits:{amount:{min:this.safeNumber(i,"min_size"),max:void 0},withdraw:{min:void 0,max:void 0}}}}return c}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.seconds(),i=this.market(e),r=this.extend({symbol:i.id},t),a=await this.publicGetPricesSymbolBuy(r),n=await this.publicGetPricesSymbolSell(r),o=await this.publicGetPricesSymbolSpot(r),c=this.safeNumber(a.data,"amount"),d=this.safeNumber(n.data,"amount"),h=this.safeNumber(o.data,"amount");return{symbol:e,timestamp:s,datetime:this.iso8601(s),bid:d,ask:c,last:h,high:void 0,low:void 0,bidVolume:void 0,askVolume:void 0,vwap:void 0,open:void 0,close:h,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:void 0,quoteVolume:void 0,info:{buy:a,sell:n,spot:o}}}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetAccounts(this.extend({limit:100},e)),s=this.safeValue(t,"data"),i=this.safeValue(e,"type",this.options.accounts),r={info:t};for(let e=0;e<s.length;e++){const t=s[e],a=this.safeString(t,"type");if(this.inArray(a,i)){const e=this.safeValue(t,"balance");if(void 0!==e){const t=this.safeString(e,"currency"),s=this.safeCurrencyCode(t),i=this.safeString(e,"amount"),a=i;let n=this.safeValue(r,s);void 0===n?(n=this.account(),n.free=a,n.total=i):(n.free=d.stringAdd(n.free,i),n.total=d.stringAdd(n.total,i)),r[s]=n}}}return this.parseBalance(r,!1)}async fetchLedger(e,t,s,i={}){let r;await this.loadMarkets(),void 0!==e&&(r=this.currency(e));const a=await this.prepareAccountRequestWithCurrencyCode(e,s,i),n=this.omit(i,["account_id","accountId"]),o=await this.privateGetAccountsAccountIdTransactions(this.extend(a,n));return this.parseLedger(o.data,r,t,s)}parseLedgerEntryStatus(e){return this.safeString({completed:"ok"},e,e)}parseLedgerEntryType(e){return this.safeString({buy:"trade",sell:"trade",fiat_deposit:"transaction",fiat_withdrawal:"transaction",exchange_deposit:"transaction",exchange_withdrawal:"transaction",send:"transaction",pro_deposit:"transaction",pro_withdrawal:"transaction"},e,e)}parseLedgerEntry(e,t){const s=this.safeValue(e,"amount",{});let i,r=this.safeNumber(s,"amount");r<0?(i="out",r=-r):i="in";const a=this.safeString(s,"currency"),n=this.safeCurrencyCode(a,t);let o;const c=this.safeValue(e,"network",{}),d=this.safeValue(c,"transaction_fee");if(void 0!==d){const e=this.safeString(d,"currency"),s=this.safeCurrencyCode(e,t);o={cost:this.safeNumber(d,"amount"),currency:s}}const h=this.parse8601(this.safeValue(e,"created_at")),u=this.safeString(e,"id"),l=this.parseLedgerEntryType(this.safeString(e,"type")),f=this.parseLedgerEntryStatus(this.safeString(e,"status")),p=this.safeString(e,"resource_path");let m;if(void 0!==p){const e=p.split("/");e.length>3&&(m=e[3])}return{info:e,id:u,timestamp:h,datetime:this.iso8601(h),direction:i,account:m,referenceId:void 0,referenceAccount:void 0,type:l,currency:n,amount:r,before:void 0,after:void 0,status:f,fee:o}}async findAccountId(e){await this.loadMarkets(),await this.loadAccounts();for(let t=0;t<this.accounts.length;t++){const s=this.accounts[t];if(s.code===e)return s.id}}prepareAccountRequest(e,t={}){const s=this.safeString2(t,"account_id","accountId");if(void 0===s)throw new a(this.id+" method requires an account_id (or accountId) parameter");const i={account_id:s};return void 0!==e&&(i.limit=e),i}async prepareAccountRequestWithCurrencyCode(e,t,s={}){let i=this.safeString2(s,"account_id","accountId");if(void 0===i){if(void 0===e)throw new a(this.id+" method requires an account_id (or accountId) parameter OR a currency code argument");if(i=await this.findAccountId(e),void 0===i)throw new r(this.id+" could not find account id for "+e)}const n={account_id:i};return void 0!==t&&(n.limit=t),n}sign(e,t="public",s="GET",i={},r,a){let n="/"+this.version+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));"GET"===s&&Object.keys(o).length&&(n+="?"+this.urlencode(o));const c=this.urls.api+n;if("private"===t){this.checkRequiredCredentials();const e=this.nonce().toString();let t="";"GET"!==s&&Object.keys(o).length&&(t=a=this.json(o));const i=e+s+n+t,c=this.hmac(this.encode(i),this.encode(this.secret));r={"CB-ACCESS-KEY":this.apiKey,"CB-ACCESS-SIGN":c,"CB-ACCESS-TIMESTAMP":e,"Content-Type":"application/json"}}return{url:c,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0===o)return;const h=this.id+" "+n;let u=this.safeString(o,"error");if(void 0!==u){const e=this.safeString(o,"error_description");throw this.throwExactlyMatchedException(this.exceptions.exact,u,h),this.throwBroadlyMatchedException(this.exceptions.broad,e,h),new r(h)}const l=this.safeValue(o,"errors");if(void 0!==l&&Array.isArray(l)){if(l.length>0){u=this.safeString(l[0],"id");const e=this.safeString(l[0],"message");if(void 0!==u)throw this.throwExactlyMatchedException(this.exceptions.exact,u,h),this.throwBroadlyMatchedException(this.exceptions.broad,e,h),new r(h)}}if(void 0===this.safeValue(o,"data"))throw new r(this.id+" failed due to a malformed response "+this.json(o))}}},8806:(e,t,s)=>{"use strict";const i=s(1241);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"coinbaseprime",name:"Coinbase Prime",pro:!0,hostname:"exchange.coinbase.com",urls:{test:{public:"https://public.sandbox.exchange.coinbase.com",private:"https://public.sandbox.exchange.coinbase.com"},logo:"https://user-images.githubusercontent.com/1294454/44539184-29f26e00-a70c-11e8-868f-e907fc236a7c.jpg",api:{public:"https://api.{hostname}",private:"https://api.{hostname}"},www:"https://exchange.coinbase.com",doc:"https://docs.exchange.coinbase.com"}})}}},1241:(e,t,s)=>{"use strict";const i=s(8819),{InsufficientFunds:r,ArgumentsRequired:a,ExchangeError:n,InvalidOrder:o,InvalidAddress:c,AuthenticationError:d,NotSupported:h,OrderNotFound:u,OnMaintenance:l,PermissionDenied:f,RateLimitExceeded:p}=s(3449),{TICK_SIZE:m}=s(2115),b=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"coinbasepro",name:"Coinbase Pro",countries:["US"],rateLimit:1e3,userAgent:this.userAgents.chrome,pro:!0,has:{cancelAllOrders:!0,cancelOrder:!0,CORS:!0,createDepositAddress:!0,createOrder:!0,deposit:!0,fetchAccounts:!0,fetchBalance:!0,fetchCurrencies:!0,fetchClosedOrders:!0,fetchDepositAddress:!1,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchOrderTrades:!0,fetchTime:!0,fetchTicker:!0,fetchTrades:!0,fetchTransactions:!0,withdraw:!0,fetchDeposits:!0,fetchWithdrawals:!0},timeframes:{"1m":60,"5m":300,"15m":900,"1h":3600,"6h":21600,"1d":86400},hostname:"pro.coinbase.com",urls:{test:{public:"https://api-public.sandbox.pro.coinbase.com",private:"https://api-public.sandbox.pro.coinbase.com"},logo:"https://user-images.githubusercontent.com/1294454/41764625-63b7ffde-760a-11e8-996d-a6328fa9347a.jpg",api:{public:"https://api.{hostname}",private:"https://api.{hostname}"},www:"https://pro.coinbase.com/",doc:"https://docs.pro.coinbase.com",fees:["https://docs.pro.coinbase.com/#fees","https://support.pro.coinbase.com/customer/en/portal/articles/2945310-fees"]},requiredCredentials:{apiKey:!0,secret:!0,password:!0},api:{public:{get:["currencies","products","products/{id}","products/{id}/book","products/{id}/candles","products/{id}/stats","products/{id}/ticker","products/{id}/trades","time"]},private:{get:["accounts","accounts/{id}","accounts/{id}/holds","accounts/{id}/ledger","accounts/{id}/transfers","coinbase-accounts","fills","funding","fees","margin/profile_information","margin/buying_power","margin/withdrawal_power","margin/withdrawal_power_all","margin/exit_plan","margin/liquidation_history","margin/position_refresh_amounts","margin/status","oracle","orders","orders/{id}","orders/client:{client_oid}","otc/orders","payment-methods","position","profiles","profiles/{id}","reports/{report_id}","transfers","transfers/{transfer_id}","users/self/exchange-limits","users/self/hold-balances","users/self/trailing-volume","withdrawals/fee-estimate"],post:["conversions","deposits/coinbase-account","deposits/payment-method","coinbase-accounts/{id}/addresses","funding/repay","orders","position/close","profiles/margin-transfer","profiles/transfer","reports","withdrawals/coinbase","withdrawals/coinbase-account","withdrawals/crypto","withdrawals/payment-method"],delete:["orders","orders/client:{client_oid}","orders/{id}"]}},commonCurrencies:{CGLD:"CELO"},precisionMode:m,fees:{trading:{tierBased:!0,percentage:!0,maker:.005,taker:.005},funding:{tierBased:!1,percentage:!1,withdraw:{BCH:0,BTC:0,LTC:0,ETH:0,EUR:.15,USD:25},deposit:{BCH:0,BTC:0,LTC:0,ETH:0,EUR:.15,USD:10}}},exceptions:{exact:{"Insufficient funds":r,NotFound:u,"Invalid API Key":d,"invalid signature":d,"Invalid Passphrase":d,"Invalid order id":o,"Private rate limit exceeded":p,"Trading pair not available":f,"Product not found":o},broad:{"Order already done":u,"order not found":u,"price too small":o,"price too precise":o,"under maintenance":l,"size is too small":o,"Cancel only mode":l}}})}async fetchCurrencies(e={}){const t=await this.publicGetCurrencies(e),s={};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"id"),a=this.safeString(i,"name"),n=this.safeCurrencyCode(r),o=this.safeValue(i,"details",{}),c=this.safeNumber(i,"max_precision"),d="online"===this.safeString(i,"status");s[n]={id:r,code:n,info:i,type:this.safeString(o,"type"),name:a,active:d,fee:void 0,precision:c,limits:{amount:{min:this.safeNumber(o,"min_size"),max:void 0},withdraw:{min:this.safeNumber(o,"min_withdrawal_amount"),max:void 0}}}}return s}async fetchMarkets(e={}){const t=await this.publicGetProducts(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"id"),a=this.safeString(i,"base_currency"),n=this.safeString(i,"quote_currency"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d=o+"/"+c,h={min:this.safeNumber(i,"quote_increment"),max:void 0},u={amount:this.safeNumber(i,"base_increment"),price:this.safeNumber(i,"quote_increment")},l="online"===this.safeString(i,"status");s.push(this.extend(this.fees.trading,{id:r,symbol:d,baseId:a,quoteId:n,base:o,quote:c,precision:u,limits:{amount:{min:this.safeNumber(i,"base_min_size"),max:this.safeNumber(i,"base_max_size")},price:h,cost:{min:this.safeNumber(i,"min_market_funds"),max:this.safeNumber(i,"max_market_funds")}},active:l,info:i}))}return s}async fetchAccounts(e={}){await this.loadMarkets();const t=await this.privateGetAccounts(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"id"),a=this.safeString(i,"currency"),n=this.safeCurrencyCode(a);s.push({id:r,type:void 0,currency:n,info:i})}return s}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetAccounts(e),s={info:t};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"currency"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(i,"available"),n.used=this.safeString(i,"hold"),n.total=this.safeString(i,"balance"),s[a]=n}return this.parseBalance(s,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={id:this.marketId(e),level:2},r=await this.publicGetProductsIdBook(this.extend(i,s)),a=this.parseOrderBook(r,e);return a.nonce=this.safeInteger(r,"sequence"),a}parseTicker(e,t){const s=this.parse8601(this.safeValue(e,"time")),i=this.safeNumber(e,"bid"),r=this.safeNumber(e,"ask"),a=this.safeNumber(e,"price");return{symbol:void 0===t?void 0:t.symbol,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:i,bidVolume:void 0,ask:r,askVolume:void 0,vwap:void 0,open:this.safeNumber(e,"open"),close:a,last:a,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(e,"volume"),quoteVolume:void 0,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={id:s.id},r=this.safeString(this.options,"fetchTickerMethod","publicGetProductsIdTicker"),a=await this[r](this.extend(i,t));return this.parseTicker(a,s)}parseTrade(e,t){const s=this.parse8601(this.safeString2(e,"time","created_at")),i=this.safeString(e,"product_id"),r=this.safeSymbol(i,t,"-");let a,n,o,c;if(void 0!==t){const s=this.safeStringLower(t,"quoteId")+"_value";c=this.safeNumber(e,s),n=t.quote;const i=this.safeString(e,"liquidity");void 0!==i&&(o="T"===i?"taker":"maker",a=t[o])}const d={cost:this.safeNumber2(e,"fill_fees","fee"),currency:n,rate:a},h=this.safeString(e,"trade_id");let u="buy"===e.side?"sell":"buy";const l=this.safeString(e,"order_id"),f=this.safeString(e,"maker_order_id"),p=this.safeString(e,"taker_order_id");(void 0!==l||void 0!==f&&void 0!==p)&&(u="buy"===e.side?"buy":"sell");const m=this.safeString(e,"price"),g=this.safeString(e,"size"),y=this.parseNumber(m),v=this.parseNumber(g);return void 0===c&&(c=this.parseNumber(b.stringMul(m,g))),{id:h,order:l,info:e,timestamp:s,datetime:this.iso8601(s),symbol:r,type:undefined,takerOrMaker:o,side:u,price:y,amount:v,fee:d,cost:c}}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const r=this.market(e),n={product_id:r.id};void 0!==s&&(n.limit=s);const o=await this.privateGetFills(this.extend(n,i));return this.parseTrades(o,r,t,s)}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={id:r.id};void 0!==s&&(a.limit=s);const n=await this.publicGetProductsIdTrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}parseOHLCV(e,t){return[this.safeTimestamp(e,0),this.safeNumber(e,3),this.safeNumber(e,2),this.safeNumber(e,1),this.safeNumber(e,4),this.safeNumber(e,5)]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n=this.timeframes[t],o={id:a.id,granularity:n};void 0!==s&&(o.start=this.iso8601(s),i=void 0===i?300:Math.min(300,i),o.end=this.iso8601(this.sum((i-1)*n*1e3,s)));const c=await this.publicGetProductsIdCandles(this.extend(o,r));return this.parseOHLCVs(c,a,t,s,i)}async fetchTime(e={}){const t=await this.publicGetTime(e);return this.safeTimestamp(t,"epoch")}parseOrderStatus(e){return this.safeString({pending:"open",active:"open",open:"open",done:"closed",canceled:"canceled",canceling:"open"},e,e)}parseOrder(e,t){const s=this.parse8601(this.safeString(e,"created_at")),i=this.safeString(e,"product_id");t=this.safeMarket(i,t,"-");const r=this.parseOrderStatus(this.safeString(e,"status")),a=this.safeNumber(e,"price"),n=this.safeNumber(e,"filled_size"),o=this.safeNumber(e,"size",n),c=this.safeNumber(e,"executed_value"),d=this.safeNumber(e,"fill_fees");let h;if(void 0!==d){let e;void 0!==t&&(e=t.quote),h={cost:d,currency:e,rate:void 0}}const u=this.safeString(e,"id"),l=this.safeString(e,"type"),f=this.safeString(e,"side"),p=this.safeString(e,"time_in_force"),m=this.safeValue(e,"post_only"),b=this.safeNumber(e,"stop_price"),g=this.safeString(e,"client_oid");return this.safeOrder({id:u,clientOrderId:g,info:e,timestamp:s,datetime:this.iso8601(s),lastTradeTimestamp:void 0,status:r,symbol:t.symbol,type:l,timeInForce:p,postOnly:m,side:f,price:a,stopPrice:b,cost:c,amount:o,filled:n,remaining:void 0,fee:h,average:void 0,trades:void 0})}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={},r=this.safeString2(s,"clientOrderId","client_oid");let a;void 0===r?(a="privateGetOrdersId",i.id=e):(a="privateGetOrdersClientClientOid",i.client_oid=r,s=this.omit(s,["clientOrderId","client_oid"]));const n=await this[a](this.extend(i,s));return this.parseOrder(n)}async fetchOrderTrades(e,t,s,i,r={}){let a;await this.loadMarkets(),void 0!==t&&(a=this.market(t));const n={order_id:e},o=await this.privateGetFills(this.extend(n,r));return this.parseTrades(o,a,s,i)}async fetchOrders(e,t,s,i={}){return await this.fetchOpenOrders(e,t,s,this.extend({status:"all"},i))}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.market(e),r.product_id=a.id),void 0!==s&&(r.limit=s);const n=await this.privateGetOrders(this.extend(r,i));return this.parseOrders(n,a,t,s)}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOpenOrders(e,t,s,this.extend({status:"done"},i))}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o={type:t,side:s,product_id:n.id},c=this.safeString2(a,"clientOrderId","client_oid");void 0!==c&&(o.client_oid=c,a=this.omit(a,["clientOrderId","client_oid"]));const d=this.safeNumber2(a,"stopPrice","stop_price");void 0!==d&&(o.stop_price=this.priceToPrecision(e,d),a=this.omit(a,["stopPrice","stop_price"]));const h=this.safeString2(a,"timeInForce","time_in_force");if(void 0!==h&&(o.time_in_force=h,a=this.omit(a,["timeInForce","time_in_force"])),"limit"===t)o.price=this.priceToPrecision(e,r),o.size=this.amountToPrecision(e,i);else if("market"===t){let t=this.safeNumber2(a,"cost","funds");void 0===t?void 0!==r&&(t=i*r):a=this.omit(a,["cost","funds"]),void 0!==t?o.funds=this.costToPrecision(e,t):o.size=this.amountToPrecision(e,i)}const u=await this.privatePostOrders(this.extend(o,a));return this.parseOrder(u,n)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={},r=this.safeString2(s,"clientOrderId","client_oid");let a,n;return void 0===r?(a="privateDeleteOrdersId",i.id=e):(a="privateDeleteOrdersClientClientOid",i.client_oid=r,s=this.omit(s,["clientOrderId","client_oid"])),void 0!==t&&(n=this.market(t),i.product_id=n.symbol),await this[a](this.extend(i,s))}async cancelAllOrders(e,t={}){await this.loadMarkets();const s={};let i;return void 0!==e&&(i=this.market(e),s.product_id=i.symbol),await this.privateDeleteOrders(this.extend(s,t))}async fetchPaymentMethods(e={}){return await this.privateGetPaymentMethods(e)}async deposit(e,t,s,i={}){await this.loadMarkets();const r={currency:this.currency(e).id,amount:t};let a="privatePostDeposits";if("payment_method_id"in i)a+="PaymentMethod";else{if(!("coinbase_account_id"in i))throw new h(this.id+" deposit() requires one of `coinbase_account_id` or `payment_method_id` extra params");a+="CoinbaseAccount"}const o=await this[a](this.extend(r,i));if(!o)throw new n(this.id+" deposit() error: "+this.json(o));return{info:o,id:o.id}}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a={currency:this.currency(e).id,amount:t};let o="privatePostWithdrawals";"payment_method_id"in r?o+="PaymentMethod":"coinbase_account_id"in r?o+="CoinbaseAccount":(o+="Crypto",a.crypto_address=s,void 0!==i&&(a.destination_tag=i));const c=await this[o](this.extend(a,r));if(!c)throw new n(this.id+" withdraw() error: "+this.json(c));return{info:c,id:c.id}}async fetchTransactions(e,t,s,i={}){let r;await this.loadMarkets(),await this.loadAccounts();let a=this.safeString(i,"id");if(void 0===a&&void 0!==e){r=this.currency(e);const t=this.indexBy(this.accounts,"currency"),s=this.safeValue(t,e);if(void 0===s)throw new n(this.id+" fetchTransactions() could not find account id for "+e);a=s.id}const o={};let c;if(void 0!==a&&(o.id=a),void 0!==s&&(o.limit=s),void 0===a){c=await this.privateGetTransfers(this.extend(o,i));for(let e=0;e<c.length;e++){const t=this.safeString(c[e],"account_id"),s=this.safeValue(this.accountsById,t),i=this.safeString(s,"currency");c[e].currency=i}}else{c=await this.privateGetAccountsIdTransfers(this.extend(o,i));for(let t=0;t<c.length;t++)c[t].currency=e}return this.parseTransactions(c,r,t,s)}async fetchDeposits(e,t,s,i={}){return this.fetchTransactions(e,t,s,this.extend(i,{type:"deposit"}))}async fetchWithdrawals(e,t,s,i={}){return this.fetchTransactions(e,t,s,this.extend(i,{type:"withdraw"}))}parseTransactionStatus(e){if(this.safeValue(e,"canceled_at"))return"canceled";const t=this.safeValue(e,"processed_at"),s=this.safeValue(e,"completed_at");return s?"ok":t&&!s?"failed":"pending"}parseTransaction(e,t){const s=this.safeValue(e,"details",{}),i=this.safeString(e,"id"),r=this.safeString(s,"crypto_transaction_hash"),a=this.parse8601(this.safeString(e,"created_at")),n=this.parse8601(this.safeString(e,"processed_at")),o=this.safeString(e,"currency"),c=this.safeCurrencyCode(o,t),d=this.parseTransactionStatus(e);let h=this.safeNumber(e,"amount"),u=this.safeString(e,"type"),l=this.safeString(s,"crypto_address");const f=this.safeString(s,"destination_tag");let p;if(l=this.safeString(e,"crypto_address",l),"withdraw"===u){u="withdrawal",l=this.safeString(s,"sent_to_address",l);const e=this.safeNumber(s,"fee");void 0!==e&&(void 0!==h&&(h-=e),p={cost:e,currency:c})}return{info:e,id:i,txid:r,timestamp:a,datetime:this.iso8601(a),address:l,tag:f,type:u,amount:h,currency:c,status:d,updated:n,fee:p}}async createDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e);let i=this.safeValue(this.options,"coinbaseAccounts");void 0===i&&(i=await this.privateGetCoinbaseAccounts(),this.options.coinbaseAccounts=i,this.options.coinbaseAccountsByCurrencyId=this.indexBy(i,"currency"));const r=s.id,a=this.safeValue(this.options.coinbaseAccountsByCurrencyId,r);if(void 0===a)throw new c(this.id+" fetchDepositAddress() could not find currency code "+e+" with id = "+r+" in this.options['coinbaseAccountsByCurrencyId']");const n={id:a.id},o=await this.privatePostCoinbaseAccountsIdAddresses(this.extend(n,t)),d=this.safeString(o,"address"),h=this.safeString(o,"destination_tag");return{currency:e,address:this.checkAddress(d),tag:h,info:o}}sign(e,t="public",s="GET",i={},r,a){let n="/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));"GET"===s&&Object.keys(o).length&&(n+="?"+this.urlencode(o));const c=this.implodeParams(this.urls.api[t],{hostname:this.hostname})+n;if("private"===t){this.checkRequiredCredentials();const e=this.nonce().toString();let t="";"GET"!==s&&Object.keys(o).length&&(t=a=this.json(o));const i=e+s+n+t,c=this.base64ToBinary(this.secret),d=this.hmac(this.encode(i),c,"sha256","base64");r={"CB-ACCESS-KEY":this.apiKey,"CB-ACCESS-SIGN":d,"CB-ACCESS-TIMESTAMP":e,"CB-ACCESS-PASSPHRASE":this.password,"Content-Type":"application/json"}}return{url:c,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,a,o,c,d){if(400===e||404===e){if("{"===a[0]){const e=this.safeString(o,"message"),t=this.id+" "+e;throw this.throwExactlyMatchedException(this.exceptions.exact,e,t),this.throwBroadlyMatchedException(this.exceptions.broad,e,t),new n(t)}throw new n(this.id+" "+a)}}async request(e,t="public",s="GET",i={},r,a){const o=await this.fetch2(e,t,s,i,r,a);if("string"!=typeof o&&"message"in o)throw new n(this.id+" "+this.json(o));return o}}},1770:(e,t,s)=>{"use strict";const i=s(8819),{BadSymbol:r,ExchangeError:a}=s(3449),n=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"coincheck",name:"coincheck",countries:["JP","ID"],rateLimit:1500,has:{cancelOrder:!0,CORS:!1,createOrder:!0,fetchBalance:!0,fetchMyTrades:!0,fetchOrderBook:!0,fetchOpenOrders:!0,fetchTicker:!0,fetchTrades:!0},urls:{logo:"https://user-images.githubusercontent.com/51840849/87182088-1d6d6380-c2ec-11ea-9c64-8ab9f9b289f5.jpg",api:"https://coincheck.com/api",www:"https://coincheck.com",doc:"https://coincheck.com/documents/exchange/api",fees:["https://coincheck.com/exchange/fee","https://coincheck.com/info/fee"]},api:{public:{get:["exchange/orders/rate","order_books","rate/{pair}","ticker","trades"]},private:{get:["accounts","accounts/balance","accounts/leverage_balance","bank_accounts","deposit_money","exchange/orders/opens","exchange/orders/transactions","exchange/orders/transactions_pagination","exchange/leverage/positions","lending/borrows/matches","send_money","withdraws"],post:["bank_accounts","deposit_money/{id}/fast","exchange/orders","exchange/transfers/to_leverage","exchange/transfers/from_leverage","lending/borrows","lending/borrows/{id}/repay","send_money","withdraws"],delete:["bank_accounts/{id}","exchange/orders/{id}","withdraws/{id}"]}},markets:{"BTC/JPY":{id:"btc_jpy",symbol:"BTC/JPY",base:"BTC",quote:"JPY",baseId:"btc",quoteId:"jpy"},"ETC/JPY":{id:"etc_jpy",symbol:"ETC/JPY",base:"ETC",quote:"JPY",baseId:"etc",quoteId:"jpy"},"FCT/JPY":{id:"fct_jpy",symbol:"FCT/JPY",base:"FCT",quote:"JPY",baseId:"fct",quoteId:"jpy"},"MONA/JPY":{id:"mona_jpy",symbol:"MONA/JPY",base:"MONA",quote:"JPY",baseId:"mona",quoteId:"jpy"},"ETC/BTC":{id:"etc_btc",symbol:"ETC/BTC",base:"ETC",quote:"BTC",baseId:"etc",quoteId:"btc"}},fees:{trading:{tierBased:!1,percentage:!0,maker:0,taker:0}}})}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetAccountsBalance(e),s={info:t},i=Object.keys(this.currencies);for(let e=0;e<i.length;e++){const r=i[e],a=this.currencyId(r);if(a in t){const e=this.account(),i=a+"_reserved";e.free=this.safeString(t,a),e.used=this.safeString(t,i),s[r]=e}}return this.parseBalance(s,!1)}async fetchOpenOrders(e,t,s,i={}){let r;await this.loadMarkets(),void 0!==e&&(r=this.market(e));const a=await this.privateGetExchangeOrdersOpens(i),n=this.safeValue(a,"orders",[]),o=this.parseOrders(n,r,t,s),c=[];for(let e=0;e<o.length;e++)c.push(this.extend(o[e],{status:"open"}));return c}parseOrder(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"order_type"),r=this.parse8601(this.safeString(e,"created_at")),a=this.safeNumber(e,"pending_amount"),n=this.safeNumber(e,"pending_amount"),o=this.safeNumber(e,"rate"),c=this.safeString(e,"pair"),d=this.safeSymbol(c,t,"_");return this.safeOrder({id:s,clientOrderId:void 0,timestamp:r,datetime:this.iso8601(r),lastTradeTimestamp:void 0,amount:a,remaining:n,filled:void 0,side:i,type:void 0,timeInForce:void 0,postOnly:void 0,status:undefined,symbol:d,price:o,stopPrice:void 0,cost:void 0,fee:void 0,info:e,average:void 0,trades:void 0})}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={pair:this.market(e).id},r=await this.publicGetOrderBooks(this.extend(i,s));return this.parseOrderBook(r,e)}async fetchTicker(e,t={}){if("BTC/JPY"!==e)throw new r(this.id+" fetchTicker () supports BTC/JPY only");await this.loadMarkets();const s={pair:this.market(e).id},i=await this.publicGetTicker(this.extend(s,t)),a=this.safeTimestamp(i,"timestamp"),n=this.safeNumber(i,"last");return{symbol:e,timestamp:a,datetime:this.iso8601(a),high:this.safeNumber(i,"high"),low:this.safeNumber(i,"low"),bid:this.safeNumber(i,"bid"),bidVolume:void 0,ask:this.safeNumber(i,"ask"),askVolume:void 0,vwap:void 0,open:void 0,close:n,last:n,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(i,"volume"),quoteVolume:void 0,info:i}}parseTrade(e,t){const s=this.parse8601(this.safeString(e,"created_at")),i=this.safeString(e,"id"),r=this.safeString(e,"rate"),a=this.safeString(e,"pair");let o,c,d,h,u,l,f,p,m;if(t=this.safeValue(this.markets_by_id,a,t),void 0!==a)if(a in this.markets_by_id)c=(t=this.markets_by_id[a]).baseId,d=t.quoteId,o=t.symbol;else{const e=a.split("_");c=e[0],d=e[1];o=this.safeCurrencyCode(c)+"/"+this.safeCurrencyCode(d)}if(void 0===o&&void 0!==t&&(o=t.symbol),"liquidity"in e){"T"===this.safeString(e,"liquidity")?h="taker":"M"===this.safeString(e,"liquidity")&&(h="maker");const t=this.safeValue(e,"funds",{});u=this.safeString(t,c),l=this.safeNumber(t,d),p={currency:this.safeString(e,"fee_currency"),cost:this.safeNumber(e,"fee")},f=this.safeString(e,"side"),m=this.safeString(e,"order_id")}else u=this.safeString(e,"amount"),f=this.safeString(e,"order_type");const b=this.parseNumber(r),g=this.parseNumber(u);return void 0===l&&(l=this.parseNumber(n.stringMul(r,u))),{id:i,info:e,datetime:this.iso8601(s),timestamp:s,symbol:o,type:void 0,side:f,order:m,takerOrMaker:h,price:b,amount:g,cost:l,fee:p}}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a=await this.privateGetExchangeOrdersTransactions(this.extend({},i)),n=this.safeValue(a,"transactions",[]);return this.parseTrades(n,r,t,s)}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={pair:r.id};void 0!==s&&(a.limit=s);const n=await this.publicGetTrades(this.extend(a,i)),o=this.safeValue(n,"data",[]);return this.parseTrades(o,r,t,s)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n={pair:this.marketId(e)};if("market"===t){const e=t+"_"+s;n.order_type=e;n[("buy"===s?e+"_":"")+"amount"]=i}else n.order_type=s,n.rate=r,n.amount=i;const o=await this.privatePostExchangeOrders(this.extend(n,a));return{info:o,id:this.safeString(o,"id")}}async cancelOrder(e,t,s={}){const i={id:e};return await this.privateDeleteExchangeOrdersId(this.extend(i,s))}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if("public"===t)Object.keys(o).length&&(n+="?"+this.urlencode(o));else{this.checkRequiredCredentials();const e=this.nonce().toString();let t="";"GET"===s?Object.keys(o).length&&(n+="?"+this.urlencode(this.keysort(o))):Object.keys(o).length&&(t=a=this.urlencode(this.keysort(o)));const i=e+n+t;r={"Content-Type":"application/x-www-form-urlencoded","ACCESS-KEY":this.apiKey,"ACCESS-NONCE":e,"ACCESS-SIGNATURE":this.hmac(this.encode(i),this.encode(this.secret))}}return{url:n,method:s,body:a,headers:r}}async request(e,t="public",s="GET",i={},r,n){const o=await this.fetch2(e,t,s,i,r,n);if("public"===t)return o;if("success"in o&&o.success)return o;throw new a(this.id+" "+this.json(o))}}},6347:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,AuthenticationError:a,InvalidNonce:n,InsufficientFunds:o,InvalidOrder:c,OrderNotFound:d,DDoSProtection:h}=s(3449),u=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"coinegg",name:"CoinEgg",countries:["CN","UK"],has:{cancelOrder:!0,createOrder:!0,fetchBalance:!0,fetchMarkets:!0,fetchMyTrades:!1,fetchOpenOrders:"emulated",fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTickers:!1,fetchTrades:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/36770310-adfa764e-1c5a-11e8-8e09-449daac3d2fb.jpg",api:{web:"https://trade.coinegg.com/web",rest:"https://api.coinegg.com/api/v1"},www:"https://www.coinegg.com",doc:"https://www.coinegg.com/explain.api.html",fees:"https://www.coinegg.com/fee.html",referral:"https://www.coinegg.com/user/register?invite=523218"},api:{web:{get:["symbol/ticker?right_coin={quote}","{quote}/trends","{quote}/{base}/order","{quote}/{base}/trades","{quote}/{base}/depth.js"]},public:{get:["ticker/region/{quote}","depth/region/{quote}","orders/region/{quote}"]},private:{post:["balance","trade_add/region/{quote}","trade_cancel/region/{quote}","trade_view/region/{quote}","trade_list/region/{quote}"]}},fees:{trading:{maker:.001,taker:.001},funding:{withdraw:{BTC:.008,BCH:.002,LTC:.001,ETH:.01,ETC:.01,NEO:0,QTUM:"1%",XRP:"1%",DOGE:"1%",LSK:"1%",XAS:"1%",BTS:"1%",GAME:"1%",GOOC:"1%",NXT:"1%",IFC:"1%",DNC:"1%",BLK:"1%",VRC:"1%",XPM:"1%",VTC:"1%",TFC:"1%",PLC:"1%",EAC:"1%",PPC:"1%",FZ:"1%",ZET:"1%",RSS:"1%",PGC:"1%",SKT:"1%",JBC:"1%",RIO:"1%",LKC:"1%",ZCC:"1%",MCC:"1%",QEC:"1%",MET:"1%",YTC:"1%",HLB:"1%",MRYC:"1%",MTC:"1%",KTC:0}}},exceptions:{103:a,104:a,105:a,106:n,200:o,201:c,202:c,203:d,402:h},errorMessages:{100:"Required parameters can not be empty",101:"Illegal parameter",102:"coin does not exist",103:"Key does not exist",104:"Signature does not match",105:"Insufficient permissions",106:"Request expired(nonce error)",200:"Lack of balance",201:"Too small for the number of trading",202:"Price must be in 0 - 1000000",203:"Order does not exist",204:"Pending order amount must be above 0.001 BTC",205:"Restrict pending order prices",206:"Decimal place error",401:"System error",402:"Requests are too frequent",403:"Non-open API",404:"IP restriction does not request the resource",405:"Currency transactions are temporarily closed"},options:{quoteIds:["btc","eth","usc","usdt"]},commonCurrencies:{JBC:"JubaoCoin",SBTC:"Super Bitcoin"}})}async fetchMarkets(e={}){const t=this.options.quoteIds,s=[];for(let e=0;e<t.length;e++){const i=t[e],r=await this.webGetSymbolTickerRightCoinQuote({quote:i}),a=this.safeValue(r,"data",[]);for(let e=0;e<a.length;e++){const t=a[e],r=t.symbol,n=r.split("_")[0];let o=n.toUpperCase(),c=i.toUpperCase();o=this.safeCurrencyCode(o),c=this.safeCurrencyCode(c);const d=o+"/"+c,h={amount:8,price:8};s.push({id:r,symbol:d,base:o,quote:c,baseId:n,quoteId:i,active:!0,precision:h,limits:{amount:{min:Math.pow(10,-h.amount),max:Math.pow(10,h.amount)},price:{min:Math.pow(10,-h.price),max:Math.pow(10,h.price)},cost:{min:void 0,max:void 0}},info:t})}}return s}parseTicker(e,t){const s=t.symbol,i=this.milliseconds(),r=this.safeNumber(e,"last"),a=this.safeNumber(e,"change");let n,o,c;if(void 0!==a){const e=a/100;n=r/this.sum(1,e),o=r-n,c=this.sum(r,n)/2}return{symbol:s,timestamp:i,datetime:this.iso8601(i),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"buy"),bidVolume:void 0,ask:this.safeNumber(e,"sell"),askVolume:void 0,vwap:void 0,open:n,close:r,last:r,previousClose:void 0,change:o,percentage:a,average:c,baseVolume:this.safeNumber(e,"vol"),quoteVolume:this.safeNumber(e,"quoteVol"),info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={coin:s.baseId,quote:s.quoteId},r=await this.publicGetTickerRegionQuote(this.extend(i,t));return this.parseTicker(r,s)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),r={coin:i.baseId,quote:i.quoteId},a=await this.publicGetDepthRegionQuote(this.extend(r,s));return this.parseOrderBook(a,e)}parseTrade(e,t){const s=this.safeTimestamp(e,"date"),i=this.safeString(e,"price"),r=this.safeString(e,"amount"),a=this.parseNumber(i),n=this.parseNumber(r),o=this.parseNumber(u.stringMul(i,r)),c=t.symbol,d=this.safeString(e,"type");return{id:this.safeString(e,"tid"),info:e,timestamp:s,datetime:this.iso8601(s),symbol:c,order:void 0,type:"limit",side:d,takerOrMaker:void 0,price:a,amount:n,cost:o,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={coin:r.baseId,quote:r.quoteId},n=await this.publicGetOrdersRegionQuote(this.extend(a,i));return this.parseTrades(n,r,t,s)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostBalance(e),s={info:t},i=this.safeValue(t,"data",{}),r=this.omit(i,"uid"),a=Object.keys(r);for(let e=0;e<a.length;e++){const t=a[e],[i,n]=t.split("_"),o=this.safeCurrencyCode(i);o in s||(s[o]=this.account());const c="lock"===n?"used":"free";s[o][c]=this.safeString(r,t)}return this.parseBalance(s,!1)}parseOrder(e,t){let s;void 0!==t&&(s=t.symbol);const i=this.parse8601(this.safeString(e,"datetime")),r=this.safeNumber(e,"price"),a=this.safeNumber(e,"amount_original"),n=this.safeNumber(e,"amount_outstanding");let o=this.safeString(e,"status");o="cancelled"===o?"canceled":n?"open":"closed";const c=this.safeValue(e,"info",e),d=this.safeString(e,"type"),h=this.safeString(e,"id");return this.safeOrder({id:h,clientOrderId:void 0,datetime:this.iso8601(i),timestamp:i,lastTradeTimestamp:void 0,status:o,symbol:s,type:"limit",timeInForce:void 0,postOnly:void 0,side:d,price:r,stopPrice:void 0,cost:void 0,amount:a,filled:void 0,remaining:n,trades:void 0,fee:void 0,info:c,average:void 0})}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o={coin:n.baseId,quote:n.quoteId,type:s,amount:i,price:r},c=await this.privatePostTradeAddRegionQuote(this.extend(o,a)),d=this.safeString(c,"id");return this.parseOrder({id:d,datetime:this.ymdhms(this.milliseconds()),amount_original:i,amount_outstanding:i,price:r,type:s,info:c},n)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i=this.market(t),r={id:e,coin:i.baseId,quote:i.quoteId};return await this.privatePostTradeCancelRegionQuote(this.extend(r,s))}async fetchOrder(e,t,s={}){await this.loadMarkets();const i=this.market(t),r={id:e,coin:i.baseId,quote:i.quoteId},a=await this.privatePostTradeViewRegionQuote(this.extend(r,s)),n=this.safeValue(a,"data");return this.parseOrder(n,i)}async fetchOrders(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={coin:r.baseId,quote:r.quoteId};void 0!==t&&(a.since=t/1e3);const n=await this.privatePostTradeListRegionQuote(this.extend(a,i)),o=this.safeValue(n,"data",[]);return this.parseOrders(o,r,t,s)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({type:"open"},i))}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n="rest";"web"===t&&(n=t);let o=this.urls.api[n]+"/"+this.implodeParams(e,i),c=this.omit(i,this.extractParams(e));if("public"===t||"web"===t)Object.keys(c).length&&(o+="?"+this.urlencode(c));else{this.checkRequiredCredentials(),c=this.urlencode(this.extend({key:this.apiKey,nonce:this.nonce()},c));const e=this.hash(this.encode(this.secret));c+="&signature="+this.hmac(this.encode(c),this.encode(e)),"GET"===s?o+="?"+c:(r={"Content-type":"application/x-www-form-urlencoded"},a=c)}return{url:o,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0===o)return;const h=this.safeValue(o,"result");if(void 0===h)return;if(!0===h)return;const u=this.safeString(o,"code"),l=this.errorMessages,f=this.safeString(l,u,"Unknown Error"),p=this.id+" "+f;throw this.throwExactlyMatchedException(this.exceptions,u,p),new r(this.id+" "+f)}}},8427:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,InsufficientFunds:n,OrderNotFound:o,InvalidOrder:c,AuthenticationError:d}=s(3449),h=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"coinex",name:"CoinEx",version:"v1",countries:["CN"],rateLimit:1e3,has:{cancelOrder:!0,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchDeposits:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchWithdrawals:!0,withdraw:!0},timeframes:{"1m":"1min","3m":"3min","5m":"5min","15m":"15min","30m":"30min","1h":"1hour","2h":"2hour","4h":"4hour","6h":"6hour","12h":"12hour","1d":"1day","3d":"3day","1w":"1week"},urls:{logo:"https://user-images.githubusercontent.com/51840849/87182089-1e05fa00-c2ec-11ea-8da9-cc73b45abbbc.jpg",api:{public:"https://api.coinex.com",private:"https://api.coinex.com",perpetualPublic:"https://api.coinex.com/perpetual",perpetualPrivate:"https://api.coinex.com/perpetual"},www:"https://www.coinex.com",doc:"https://github.com/coinexcom/coinex_exchange_api/wiki",fees:"https://www.coinex.com/fees",referral:"https://www.coinex.com/register?refer_code=yw5fz"},api:{public:{get:["common/currency/rate","common/asset/config","market/info","market/list","market/ticker","market/ticker/all","market/depth","market/deals","market/kline"]},private:{get:["balance/coin/deposit","balance/coin/withdraw","balance/info","future/account","future/config","future/limitprice","future/loan/history","future/market","margin/account","margin/config","margin/loan/history","margin/market","order","order/deals","order/finished","order/finished/{id}","order/pending","order/status","order/status/batch","order/user/deals","sub_account/balance","sub_account/transfer/history"],post:["balance/coin/withdraw","future/flat","future/loan","future/transfer","margin/flat","margin/loan","margin/transfer","order/batchlimit","order/ioc","order/limit","order/market","sub_account/transfer"],delete:["balance/coin/withdraw","order/pending/batch","order/pending"]},perpetualPublic:{get:["ping","time","market/list","market/limit_config","market/ticker","market/ticker/all","market/depth","market/deals","market/funding_history","market/user_deals","market/kline"]},perpetualPrivate:{get:["asset/query","order/pending","order/finished","order/stop_pending","order/status","position/pending","position/funding"],post:["market/adjust_leverage","market/position_expect","order/put_limit","order/put_market","order/put_stop_limit","order/cancel","order/cancel_all","order/cancel_stop","order/cancel_stop_all","order/close_limit","order/close_market","position/adjust_margin"]}},fees:{trading:{maker:.001,taker:.001},funding:{withdraw:{BCH:0,BTC:.001,LTC:.001,ETH:.001,ZEC:1e-4,DASH:1e-4}}},limits:{amount:{min:.001,max:void 0}},precision:{amount:8,price:8},options:{createMarketBuyOrderRequiresPrice:!0}})}async fetchMarkets(e={}){const t=await this.publicGetMarketInfo(e),s=this.safeValue(t,"data",{}),i=[],r=Object.keys(s);for(let e=0;e<r.length;e++){const t=s[r[e]],a=this.safeString(t,"name"),n=this.safeString(t,"trading_name"),o=n,c=this.safeString(t,"pricing_name"),d=this.safeCurrencyCode(o),h=this.safeCurrencyCode(c);let u=d+"/"+h;n===a&&(u=a);const l={amount:this.safeInteger(t,"trading_decimal"),price:this.safeInteger(t,"pricing_decimal")},f=void 0;i.push({id:a,symbol:u,base:d,quote:h,baseId:o,quoteId:c,active:f,taker:this.safeNumber(t,"taker_fee_rate"),maker:this.safeNumber(t,"maker_fee_rate"),info:t,precision:l,limits:{amount:{min:this.safeNumber(t,"min_amount"),max:void 0},price:{min:Math.pow(10,-l.price),max:void 0}}})}return i}parseTicker(e,t){const s=this.safeInteger(e,"date");let i;void 0!==t&&(i=t.symbol),e=this.safeValue(e,"ticker",{});const r=this.safeNumber(e,"last");return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"buy"),bidVolume:void 0,ask:this.safeNumber(e,"sell"),askVolume:void 0,vwap:void 0,open:void 0,close:r,last:r,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber2(e,"vol","volume"),quoteVolume:void 0,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={market:s.id},r=await this.publicGetMarketTicker(this.extend(i,t));return this.parseTicker(r.data,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetMarketTickerAll(t),i=this.safeValue(s,"data"),r=this.safeInteger(i,"date"),a=this.safeValue(i,"ticker"),n=Object.keys(a),o={};for(let e=0;e<n.length;e++){const t=n[e],s=this.safeMarket(t),i=s.symbol,c=this.parseTicker({date:r,ticker:a[t]},s);c.symbol=i,o[i]=c}return this.filterByArray(o,"symbol",e)}async fetchOrderBook(e,t=20,s={}){await this.loadMarkets(),void 0===t&&(t=20);const i={market:this.marketId(e),merge:"0.0000000001",limit:t.toString()},r=await this.publicGetMarketDepth(this.extend(i,s));return this.parseOrderBook(r.data,e)}parseTrade(e,t){let s=this.safeTimestamp(e,"create_time");void 0===s&&(s=this.safeInteger(e,"date_ms"));const i=this.safeString(e,"id"),r=this.safeString(e,"order_id"),a=this.safeString(e,"price"),n=this.safeString(e,"amount"),o=this.parseNumber(a),c=this.parseNumber(n),d=this.safeString(e,"market"),u=this.safeSymbol(d,t);let l,f=this.safeNumber(e,"deal_money");void 0===f&&(f=this.parseNumber(h.stringMul(a,n)));const p=this.safeNumber(e,"fee");if(void 0!==p){const t=this.safeString(e,"fee_asset");l={cost:p,currency:this.safeCurrencyCode(t)}}const m=this.safeString(e,"role"),b=this.safeString(e,"type");return{info:e,timestamp:s,datetime:this.iso8601(s),symbol:u,id:i,order:r,type:void 0,side:b,takerOrMaker:m,price:o,amount:c,cost:f,fee:l}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={market:r.id},n=await this.publicGetMarketDeals(this.extend(a,i));return this.parseTrades(n.data,r,t,s)}parseOHLCV(e,t){return[this.safeTimestamp(e,0),this.safeNumber(e,1),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,2),this.safeNumber(e,5)]}async fetchOHLCV(e,t="5m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={market:a.id,type:this.timeframes[t]};void 0!==i&&(n.limit=i);const o=await this.publicGetMarketKline(this.extend(n,r)),c=this.safeValue(o,"data",[]);return this.parseOHLCVs(c,a,t,s,i)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetBalanceInfo(e),s={info:t},i=this.safeValue(t,"data",{}),r=Object.keys(i);for(let e=0;e<r.length;e++){const t=r[e],a=this.safeCurrencyCode(t),n=this.safeValue(i,t,{}),o=this.account();o.free=this.safeString(n,"available"),o.used=this.safeString(n,"frozen"),s[a]=o}return this.parseBalance(s,!1)}parseOrderStatus(e){return this.safeString({not_deal:"open",part_deal:"open",done:"closed",cancel:"canceled"},e,e)}parseOrder(e,t){const s=this.safeTimestamp(e,"create_time"),i=this.safeNumber(e,"price"),r=this.safeNumber(e,"deal_money"),a=this.safeNumber(e,"amount"),n=this.safeNumber(e,"deal_amount"),o=this.safeNumber(e,"avg_price");let c;const d=this.safeString(e,"market");t=this.safeMarket(d,t);const h=this.safeString(e,"fee_asset");let u=this.safeCurrencyCode(h);void 0!==t&&(c=t.symbol,void 0===u&&(u=t.quote));const l=this.safeNumber(e,"left"),f=this.parseOrderStatus(this.safeString(e,"status")),p=this.safeString(e,"order_type"),m=this.safeString(e,"type");return this.safeOrder({id:this.safeString(e,"id"),clientOrderId:void 0,datetime:this.iso8601(s),timestamp:s,lastTradeTimestamp:void 0,status:f,symbol:c,type:p,timeInForce:void 0,postOnly:void 0,side:m,price:i,stopPrice:void 0,cost:r,average:o,amount:a,filled:n,remaining:l,trades:void 0,fee:{currency:u,cost:this.safeNumber(e,"deal_fee")},info:e})}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n="privatePostOrder"+this.capitalize(t),o=this.market(e),d={market:o.id,type:s};if(i=parseFloat(i),"market"===t&&"buy"===s)if(this.options.createMarketBuyOrderRequiresPrice){if(void 0===r)throw new c(this.id+" createOrder() requires the price argument with market buy orders to calculate total order cost (amount to spend), where cost = amount * price. Supply a price argument to createOrder() call if you want the cost to be calculated for you from price and amount, or, alternatively, add .options['createMarketBuyOrderRequiresPrice'] = false to supply the cost in the amount argument (the exchange-specific behaviour)");r=parseFloat(r),d.amount=this.costToPrecision(e,i*r)}else d.amount=this.costToPrecision(e,i);else d.amount=this.amountToPrecision(e,i);"limit"!==t&&"ioc"!==t||(d.price=this.priceToPrecision(e,r));const h=await this[n](this.extend(d,a)),u=this.safeValue(h,"data");return this.parseOrder(u,o)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i=this.market(t),r={id:e,market:i.id},a=await this.privateDeleteOrderPending(this.extend(r,s)),n=this.safeValue(a,"data");return this.parseOrder(n,i)}async fetchOrder(e,t,s={}){if(void 0===t)throw new a(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={id:e,market:i.id},n=await this.privateGetOrder(this.extend(r,s)),o=this.safeValue(n,"data");return this.parseOrder(o,i)}async fetchOrdersByStatus(e,t,s,i,r={}){await this.loadMarkets(),void 0===i&&(i=100);const a={page:1,limit:i};let n;void 0!==t&&(n=this.market(t),a.market=n.id);const o="privateGetOrder"+this.capitalize(e),c=await this[o](this.extend(a,r)),d=this.safeValue(c,"data"),h=this.safeValue(d,"data",[]);return this.parseOrders(h,n,s,i)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrdersByStatus("pending",e,t,s,i)}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrdersByStatus("finished",e,t,s,i)}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets(),void 0===s&&(s=100);const r={page:1,limit:s};let a;void 0!==e&&(a=this.market(e),r.market=a.id);const n=await this.privateGetOrderUserDeals(this.extend(r,i)),o=this.safeValue(n,"data"),c=this.safeValue(o,"data",[]);return this.parseTrades(c,a,t,s)}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a=this.currency(e);i&&(s=s+":"+i);const n={coin_type:a.id,coin_address:s,actual_amount:parseFloat(t),transfer_method:"onchain"},o=await this.privatePostBalanceCoinWithdraw(this.extend(n,r)),c=this.safeValue(o,"data",{});return this.parseTransaction(c,a)}parseTransactionStatus(e){return this.safeString({audit:"pending",pass:"pending",processing:"pending",confirming:"pending",not_pass:"failed",cancel:"canceled",finish:"ok",fail:"failed"},e,e)}parseTransaction(e,t){const s=this.safeString2(e,"coin_withdraw_id","coin_deposit_id"),i=this.safeString(e,"coin_address");let r=this.safeString(e,"remark");void 0!==r&&r.length<1&&(r=void 0);let a=this.safeValue(e,"tx_id");void 0!==a&&a.length<1&&(a=void 0);const n=this.safeString(e,"coin_type"),o=this.safeCurrencyCode(n,t),c=this.safeTimestamp(e,"create_time"),d="coin_withdraw_id"in e?"withdraw":"deposit",h=this.parseTransactionStatus(this.safeString(e,"status"));let u=this.safeNumber(e,"amount"),l=this.safeNumber(e,"tx_fee");"deposit"===d&&(l=0);const f={cost:l,currency:o};return void 0!==u&&(u-=l),{info:e,id:s,txid:a,timestamp:c,datetime:this.iso8601(c),address:i,tag:r,type:d,amount:u,currency:o,status:h,updated:void 0,fee:f}}async fetchWithdrawals(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchWithdrawals() requires a currency code argument");await this.loadMarkets();const r=this.currency(e),n={coin_type:r.id};void 0!==s&&(n.Limit=s);const o=await this.privateGetBalanceCoinWithdraw(this.extend(n,i));let c=this.safeValue(o,"data");return Array.isArray(c)||(c=this.safeValue(c,"data",[])),this.parseTransactions(c,r,t,s)}async fetchDeposits(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchDeposits() requires a currency code argument");await this.loadMarkets();const r=this.currency(e),n={coin_type:r.id};void 0!==s&&(n.Limit=s);const o=await this.privateGetBalanceCoinDeposit(this.extend(n,i));let c=this.safeValue(o,"data");return Array.isArray(c)||(c=this.safeValue(c,"data",[])),this.parseTransactions(c,r,t,s)}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){e=this.implodeParams(e,i);let n=this.urls.api[t]+"/"+this.version+"/"+e,o=this.omit(i,this.extractParams(e));if("public"===t||"perpetualPublic"===t)Object.keys(o).length&&(n+="?"+this.urlencode(o));else{this.checkRequiredCredentials();const e=this.nonce();o=this.extend({access_id:this.apiKey,tonce:e.toString()},o),o=this.keysort(o);const t=this.rawencode(o);r={Authorization:this.hash(this.encode(t+"&secret_key="+this.secret)).toUpperCase(),"Content-Type":"application/json"},"GET"===s||"DELETE"===s?n+="?"+t:a=this.json(o)}return{url:n,method:s,body:a,headers:r}}async request(e,t="public",s="GET",i={},a,h){const u=await this.fetch2(e,t,s,i,a,h),l=this.safeString(u,"code"),f=this.safeValue(u,"data"),p=this.safeString(u,"message");if("0"!==l||void 0===f||"Success"!==p&&"Ok"!==p&&!f){const e={24:d,25:d,107:n,600:o,601:c,602:c,606:c};throw new(this.safeValue(e,l,r))(u.message)}return u}}},6810:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,AuthenticationError:a,RateLimitExceeded:n,ArgumentsRequired:o}=s(3449),c=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"coinfalcon",name:"CoinFalcon",countries:["GB"],rateLimit:1e3,version:"v1",has:{cancelOrder:!0,createOrder:!0,fetchBalance:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/41822275-ed982188-77f5-11e8-92bb-496bcd14ca52.jpg",api:"https://coinfalcon.com",www:"https://coinfalcon.com",doc:"https://docs.coinfalcon.com",fees:"https://coinfalcon.com/fees",referral:"https://coinfalcon.com/?ref=CFJSVGTUPASB"},api:{public:{get:["markets","markets/{market}","markets/{market}/orders","markets/{market}/trades"]},private:{get:["user/accounts","user/orders","user/orders/{id}","user/orders/{id}/trades","user/trades","user/fees","account/withdrawals/{id}","account/withdrawals","account/deposit/{id}","account/deposits","account/deposit_address"],post:["user/orders","account/withdraw"],delete:["user/orders/{id}","account/withdrawals/{id}"]}},fees:{trading:{tierBased:!0,maker:0,taker:.002}},precision:{amount:8,price:8}})}async fetchMarkets(e={}){const t=await this.publicGetMarkets(e),s=this.safeValue(t,"data"),i=[];for(let e=0;e<s.length;e++){const t=s[e],[r,a]=t.name.split("-"),n=this.safeCurrencyCode(r),o=this.safeCurrencyCode(a),c=n+"/"+o,d={amount:this.safeInteger(t,"size_precision"),price:this.safeInteger(t,"price_precision")};i.push({id:t.name,symbol:c,base:n,quote:o,baseId:r,quoteId:a,active:!0,precision:d,limits:{amount:{min:Math.pow(10,-d.amount),max:void 0},price:{min:Math.pow(10,-d.price),max:void 0},cost:{min:void 0,max:void 0}},info:t})}return i}parseTicker(e,t){const s=this.safeString(e,"name"),i=this.safeSymbol(s,t,"-"),r=this.milliseconds(),a=parseFloat(e.last_price);return{symbol:i,timestamp:r,datetime:this.iso8601(r),high:void 0,low:void 0,bid:void 0,bidVolume:void 0,ask:void 0,askVolume:void 0,vwap:void 0,open:void 0,close:a,last:a,previousClose:void 0,change:this.safeNumber(e,"change_in_24h"),percentage:void 0,average:void 0,baseVolume:void 0,quoteVolume:this.safeNumber(e,"volume"),info:e}}async fetchTicker(e,t={}){await this.loadMarkets();return(await this.fetchTickers(t))[e]}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetMarkets(t),i=this.safeValue(s,"data"),r={};for(let e=0;e<i.length;e++){const t=this.parseTicker(i[e]);r[t.symbol]=t}return this.filterByArray(r,"symbol",e)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={market:this.marketId(e),level:"3"},r=await this.publicGetMarketsMarketOrders(this.extend(i,s)),a=this.safeValue(r,"data",{});return this.parseOrderBook(a,e,void 0,"bids","asks","price","size")}parseTrade(e,t){const s=this.parse8601(this.safeString(e,"created_at")),i=this.safeString(e,"price"),r=this.safeString(e,"size"),a=this.parseNumber(i),n=this.parseNumber(r),o=this.parseNumber(c.stringMul(i,r)),d=t.symbol,h=this.safeString(e,"id"),u=this.safeString(e,"side"),l=this.safeString(e,"order_id");let f;const p=this.safeNumber(e,"fee");if(void 0!==p){const t=this.safeString(e,"fee_currency_code");f={cost:p,currency:this.safeCurrencyCode(t)}}return{info:e,timestamp:s,datetime:this.iso8601(s),symbol:d,id:h,order:l,type:void 0,side:u,takerOrMaker:void 0,price:a,amount:n,cost:o,fee:f}}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new o(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a={market:r.id};void 0!==t&&(a.start_time=this.iso8601(t)),void 0!==s&&(a.limit=s);const n=await this.privateGetUserTrades(this.extend(a,i)),c=this.safeValue(n,"data",[]);return this.parseTrades(c,r,t,s)}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={market:r.id};void 0!==t&&(a.since=this.iso8601(t));const n=await this.publicGetMarketsMarketTrades(this.extend(a,i)),o=this.safeValue(n,"data",[]);return this.parseTrades(o,r,t,s)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetUserAccounts(e),s={info:t},i=this.safeValue(t,"data");for(let e=0;e<i.length;e++){const t=i[e],r=this.safeString(t,"currency_code"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(t,"available_balance"),n.used=this.safeString(t,"hold_balance"),n.total=this.safeString(t,"balance"),s[a]=n}return this.parseBalance(s,!1)}parseOrderStatus(e){return this.safeString({fulfilled:"closed",canceled:"canceled",pending:"open",open:"open",partially_filled:"open"},e,e)}parseOrder(e,t){const s=this.safeString(e,"market"),i=this.safeSymbol(s,t,"-"),r=this.parse8601(this.safeString(e,"created_at")),a=this.safeNumber(e,"price"),n=this.safeNumber(e,"size"),o=this.safeNumber(e,"size_filled"),c=this.parseOrderStatus(this.safeString(e,"status"));let d=this.safeString(e,"operation_type");void 0!==d&&(d=d.split("_"),d=d[0]);const h=this.safeString(e,"order_type"),u=this.safeValue(e,"post_only");return this.safeOrder({id:this.safeString(e,"id"),clientOrderId:void 0,datetime:this.iso8601(r),timestamp:r,status:c,symbol:i,type:d,timeInForce:void 0,postOnly:u,side:h,price:a,stopPrice:void 0,cost:void 0,amount:n,filled:o,remaining:void 0,trades:void 0,fee:void 0,info:e,lastTradeTimestamp:void 0,average:void 0})}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o={market:n.id,size:this.amountToPrecision(e,i),order_type:s};"limit"===t&&(r=this.priceToPrecision(e,r),o.price=r.toString()),o.operation_type=t+"_order";const c=await this.privatePostUserOrders(this.extend(o,a)),d=this.safeValue(c,"data",{});return this.parseOrder(d,n)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={id:e},r=await this.privateDeleteUserOrdersId(this.extend(i,s)),a=this.market(t),n=this.safeValue(r,"data",{});return this.parseOrder(n,a)}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={id:e},r=await this.privateGetUserOrdersId(this.extend(i,s)),a=this.safeValue(r,"data",{});return this.parseOrder(a)}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.market(e),r.market=a.id),void 0!==t&&(r.since_time=this.iso8601(t));const n=await this.privateGetUserOrders(this.extend(r,i)),o=this.safeValue(n,"data",[]),c=this.filterByArray(o,"status",["pending","open","partially_filled"],!1);return this.parseOrders(c,a,t,s)}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n="/api/"+this.version+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if("public"===t)Object.keys(o).length&&(n+="?"+this.urlencode(o));else{this.checkRequiredCredentials(),"GET"===s?Object.keys(o).length&&(n+="?"+this.urlencode(o)):a=this.json(o);const e=this.seconds().toString();let t=[e,s,n].join("|");a&&(t+="|"+a);const i=this.hmac(this.encode(t),this.encode(this.secret));r={"CF-API-KEY":this.apiKey,"CF-API-TIMESTAMP":e,"CF-API-SIGNATURE":i,"Content-Type":"application/json"}}return{url:this.urls.api+n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,o,c,d,h,u){if(e<400)return;throw new(this.safeValue({401:a,429:n},e,r))(c)}}},1224:(e,t,s)=>{"use strict";const i=s(8819),{InsufficientFunds:r,ExchangeError:a,InvalidNonce:n,InvalidOrder:o,ArgumentsRequired:c}=s(3449),d=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"coinfloor",name:"coinfloor",rateLimit:1e3,countries:["UK"],has:{cancelOrder:!0,CORS:!1,createOrder:!0,fetchBalance:!0,fetchLedger:!0,fetchOpenOrders:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTrades:!0},urls:{logo:"https://user-images.githubusercontent.com/51840849/87153925-ef265e80-c2c0-11ea-91b5-020c804b90e0.jpg",api:"https://webapi.coinfloor.co.uk/v2/bist",www:"https://www.coinfloor.co.uk",doc:["https://github.com/coinfloor/api","https://www.coinfloor.co.uk/api"]},requiredCredentials:{apiKey:!0,secret:!1,password:!0,uid:!0},api:{public:{get:["{id}/ticker/","{id}/order_book/","{id}/transactions/"]},private:{post:["{id}/balance/","{id}/user_transactions/","{id}/open_orders/","{symbol}/cancel_order/","{id}/buy/","{id}/sell/","{id}/buy_market/","{id}/sell_market/","{id}/estimate_sell_market/","{id}/estimate_buy_market/"]}},markets:{"BTC/GBP":{id:"XBT/GBP",symbol:"BTC/GBP",base:"BTC",quote:"GBP",baseId:"XBT",quoteId:"GBP",precision:{price:0,amount:4}},"BTC/EUR":{id:"XBT/EUR",symbol:"BTC/EUR",base:"BTC",quote:"EUR",baseId:"XBT",quoteId:"EUR",precision:{price:0,amount:4}}},exceptions:{exact:{"You have insufficient funds.":r,"Tonce is out of sequence.":n}}})}async fetchBalance(e={}){let t;await this.loadMarkets();let s=e;void 0!==this.safeString(e,"symbol")&&(t=this.market(e.symbol),s=this.omit(e,"symbol"));const i=this.safeString(e,"id");if(i in this.markets_by_id&&(t=this.markets_by_id[i]),void 0===t)throw new c(this.id+" fetchBalance() requires a symbol param");const r={id:t.id},a=await this.privatePostIdBalance(this.extend(r,s)),n={info:a},o=t.base,d=t.quote,h=this.safeStringLower(t,"baseId"),u=this.safeStringLower(t,"quoteId");return n[o]={free:this.safeString(a,h+"_available"),used:this.safeString(a,h+"_reserved"),total:this.safeString(a,h+"_balance")},n[d]={free:this.safeString(a,u+"_available"),used:this.safeString(a,u+"_reserved"),total:this.safeString(a,u+"_balance")},this.parseBalance(n,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={id:this.marketId(e)},r=await this.publicGetIdOrderBook(this.extend(i,s));return this.parseOrderBook(r,e)}parseTicker(e,t){const s=this.milliseconds();let i;void 0!==t&&(i=t.symbol);const r=this.safeNumber(e,"vwap"),a=this.safeNumber(e,"volume");let n;void 0!==r&&(n=a*r);const o=this.safeNumber(e,"last");return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"bid"),bidVolume:void 0,ask:this.safeNumber(e,"ask"),askVolume:void 0,vwap:r,open:void 0,close:o,last:o,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:a,quoteVolume:n,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={id:s.id},r=await this.publicGetIdTicker(this.extend(i,t));return this.parseTicker(r,s)}parseTrade(e,t){const s=this.safeTimestamp(e,"date"),i=this.safeString(e,"tid"),r=this.safeString(e,"price"),a=this.safeString(e,"amount"),n=this.parseNumber(r),o=this.parseNumber(a),c=this.parseNumber(d.stringMul(r,a));let h;return void 0!==t&&(h=t.symbol),{info:e,id:i,order:void 0,timestamp:s,datetime:this.iso8601(s),symbol:h,type:void 0,side:void 0,takerOrMaker:void 0,price:n,amount:o,cost:c,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={id:r.id},n=await this.publicGetIdTransactions(this.extend(a,i));return this.parseTrades(n,r,t,s)}async fetchLedger(e,t,s,i={}){let r;if(await this.loadMarkets(),void 0!==e&&(r=this.market(e),void 0===r))throw new c(this.id+" fetchTransactions() requires a code argument (a market symbol)");const a={id:r.id,limit:s},n=await this.privatePostIdUserTransactions(this.extend(a,i));return this.parseLedger(n,void 0,t,void 0)}parseLedgerEntryStatus(e){return this.safeString({completed:"ok"},e,e)}parseLedgerEntryType(e){return this.safeString({0:"transaction",1:"transaction",2:"trade"},e,e)}parseLedgerEntry(e,t){const s=Object.keys(e);let i,r,a,n;for(let t=0;t<s.length;t++){const o=s[t];if(o.indexOf("_")>0){const t=o.split("_");if(2===t.length){const s=this.safeNumber(e,t[0]),o=this.safeNumber(e,t[1]);void 0!==s&&void 0!==o&&(i=t[0],r=t[1],a=s,n=o)}}}const o=this.safeCurrencyCode(i),c=this.safeCurrencyCode(r),d=this.parseLedgerEntryType(this.safeString(e,"type")),h=this.safeString(e,"id"),u=this.parse8601(this.safeString(e,"datetime"));let l;const f=this.safeNumber(e,"fee"),p={id:void 0,timestamp:u,datetime:this.iso8601(u),amount:void 0,direction:void 0,currency:void 0,type:d,referenceId:h,referenceAccount:void 0,before:void 0,after:void 0,status:"ok",fee:l,info:e};if("trade"===d)return void 0!==f&&(l={cost:f,currency:c}),[this.extend(p,{currency:o,amount:Math.abs(a),direction:a>0?"in":"out"}),this.extend(p,{currency:c,amount:Math.abs(n),direction:n>0?"in":"out",fee:l})];{const e=0===a?n:a,t=0===a?c:o,s=e>0?"in":"out";return void 0!==f&&(l={cost:f,currency:t}),this.extend(p,{currency:t,amount:Math.abs(e),direction:s,fee:l})}}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n={id:this.marketId(e)};let o="privatePostId"+this.capitalize(s);"market"===t?(n.quantity=i,o+="Market"):(n.price=r,n.amount=i);const c=await this[o](this.extend(n,a)),d=this.parse8601(this.safeString(c,"datetime"));return{id:this.safeString(c,"id"),clientOrderId:void 0,datetime:this.iso8601(d),timestamp:d,type:t,price:this.safeNumber(c,"price"),remaining:this.safeNumber(c,"amount"),info:c}}async cancelOrder(e,t,s={}){if(void 0===t)throw new c(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const i={symbol:this.market(t).id,id:e},r=await this.privatePostSymbolCancelOrder(i);if("false"===r)throw new o(this.id+" cancel was rejected");return r}parseOrder(e,t){const s=this.parse8601(this.safeString(e,"datetime")),i=this.safeNumber(e,"price"),r=this.safeNumber(e,"amount");let a;const n=this.safeString(e,"status"),o=this.safeString(e,"type");let c;"0"===o?a="buy":"1"===o&&(a="sell"),void 0!==t&&(c=t.symbol);const d=this.safeString(e,"id");return this.safeOrder({info:e,id:d,clientOrderId:void 0,datetime:this.iso8601(s),timestamp:s,lastTradeTimestamp:void 0,status:n,symbol:c,type:"limit",timeInForce:void 0,postOnly:void 0,side:a,price:i,stopPrice:void 0,amount:void 0,filled:void 0,remaining:r,cost:void 0,fee:void 0,average:void 0,trades:void 0})}async fetchOpenOrders(e,t,s,i={}){if(void 0===e)throw new c(this.id+" fetchOpenOrders() requires a symbol param");await this.loadMarkets();const r=this.market(e),a={id:r.id},n=await this.privatePostIdOpenOrders(this.extend(a,i));return this.parseOrders(n,r,t,s,{status:"open"})}handleErrors(e,t,s,i,r,n,o,c,d){if(e<400)return;if(void 0===o)return;const h=this.safeString(o,"error_msg"),u=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,h,u),new a(u)}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if("public"===t)Object.keys(o).length&&(n+="?"+this.urlencode(o));else{this.checkRequiredCredentials();const e=this.nonce();a=this.urlencode(this.extend({nonce:e},o));const t=this.uid+"/"+this.apiKey+":"+this.password;r={"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic "+this.decode(this.stringToBase64(t))}}return{url:n,method:s,body:a,headers:r}}}},6410:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r}=s(3449);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"coinmarketcap",name:"CoinMarketCap",rateLimit:1e4,version:"v1",countries:["US"],has:{cancelOrder:!1,CORS:!0,createLimitOrder:!1,createMarketOrder:!1,createOrder:!1,editOrder:!1,privateAPI:!1,fetchBalance:!1,fetchCurrencies:!0,fetchL2OrderBook:!1,fetchMarkets:!0,fetchOHLCV:!1,fetchOrderBook:!1,fetchTicker:!0,fetchTickers:!0,fetchTrades:!1},urls:{logo:"https://user-images.githubusercontent.com/51840849/87182086-1cd4cd00-c2ec-11ea-9ec4-d0cf2a2abf62.jpg",api:{public:"https://api.coinmarketcap.com",files:"https://files.coinmarketcap.com",charts:"https://graph.coinmarketcap.com"},www:"https://coinmarketcap.com",doc:"https://coinmarketcap.com/api"},requiredCredentials:{apiKey:!1,secret:!1},api:{files:{get:["generated/stats/global.json"]},graphs:{get:["currencies/{name}/"]},public:{get:["ticker/","ticker/{id}/","global/"]}},currencyCodes:["AUD","BRL","CAD","CHF","CNY","EUR","GBP","HKD","IDR","INR","JPY","KRW","MXN","RUB","USD","BTC","ETH","LTC"]})}async fetchOrderBook(e,t,s={}){throw new r("Fetching order books is not supported by the API of "+this.id)}currencyCode(e,t){return this.safeValue({ACChain:"ACChain",AdCoin:"AdCoin",BatCoin:"BatCoin","BigONE Token":"BigONE Token",Bitgem:"Bitgem",BlazeCoin:"BlazeCoin",BlockCAT:"BlockCAT","Blocktrade Token":"Blocktrade Token","BOX Token":"BOX Token",Catcoin:"Catcoin",CanYaCoin:"CanYaCoin",CryptoBossCoin:"CryptoBossCoin",Comet:"Comet",CPChain:"CPChain",CrowdCoin:"CrowdCoin",Cryptaur:"Cryptaur",Cubits:"Cubits","DAO.Casino":"DAO.Casino",DefiBox:"DefiBox","E-Dinar Coin":"E-Dinar Coin",EDRcoin:"EDRcoin",ENTCash:"ENTCash",FairCoin:"FairCoin","Fabric Token":"Fabric Token",GHOSTPRISM:"GHOSTPRISM","Global Tour Coin":"Global Tour Coin",GuccioneCoin:"GuccioneCoin",HarmonyCoin:"HarmonyCoin","Harvest Masternode Coin":"Harvest Masternode Coin","HOT Token":"HOT Token","Hydro Protocol":"Hydro Protocol",Huncoin:"Huncoin",iCoin:"iCoin","Infinity Economics":"Infinity Economics","IQ.cash":"IQ.cash","KingN Coin":"KingN Coin",LiteBitcoin:"LiteBitcoin",Maggie:"Maggie","Menlo One":"Menlo One","Mobilian Coin":"Mobilian Coin",Monarch:"Monarch","MTC Mesh Network":"MTC Mesh Network",IOTA:"IOTA",NetCoin:"NetCoin",PCHAIN:"PCHAIN",Penta:"Penta",Plair:"Plair",PlayChip:"PlayChip",Polcoin:"Polcoin",PutinCoin:"PutinCoin",Rcoin:"Rcoin",SBTCT:"SiamBitcoin","Super Bitcoin":"Super Bitcoin",TerraCredit:"TerraCredit",Themis:"Themis","UNI COIN":"UNI COIN","UNICORN Token":"UNICORN Token",Universe:"Universe"},t,e)}async fetchMarkets(e={}){const t=await this.publicGetTicker(this.extend({limit:0},e)),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.currencyCodes;for(let e=0;e<r.length;e++){const t=r[e],a=t.toLowerCase(),n=i.id,o=this.currencyCode(i.symbol,i.name),c=o+"/"+t,d=n+"/"+a;s.push({id:d,symbol:c,base:o,quote:t,baseId:n,quoteId:a,info:i,active:void 0,precision:this.precision,limits:this.limits})}}return s}async fetchGlobal(e="USD"){await this.loadMarkets();const t={};return e&&(t.convert=e),await this.publicGetGlobal(t)}parseTicker(e,t){let s=this.safeTimestamp(e,"last_updated");void 0===s&&(s=this.milliseconds());const i=this.safeNumber(e,"percent_change_24h");let r,a,n;if(void 0!==t){a=t.symbol;const s="price_"+t.quoteId;r=this.safeNumber(e,s);const i="24h_volume_"+t.quoteId;n=this.safeNumber(e,i)}return{symbol:a,timestamp:s,datetime:this.iso8601(s),high:void 0,low:void 0,bid:void 0,bidVolume:void 0,ask:void 0,askVolume:void 0,vwap:void 0,open:void 0,close:r,last:r,previousClose:void 0,change:void 0,percentage:i,average:void 0,baseVolume:void 0,quoteVolume:n,info:e}}async fetchTickers(e="USD",t={}){await this.loadMarkets();const s={limit:1e4};e&&(s.convert=e);const i=await this.publicGetTicker(this.extend(s,t)),r={};for(let t=0;t<i.length;t++){const s=i[t],a=e.toLowerCase(),n=s.id+"/"+a;let o,c=n;n in this.markets_by_id&&(o=this.markets_by_id[n],c=o.symbol),r[c]=this.parseTicker(s,o)}return r}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={convert:s.quote,id:s.baseId},r=(await this.publicGetTickerId(this.extend(i,t)))[0];return this.parseTicker(r,s)}async fetchCurrencies(e={}){const t=await this.publicGetTicker(this.extend({limit:0},e)),s={};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"symbol"),a=this.safeString(i,"name"),n=8,o=this.currencyCode(r,a);s[o]={id:r,code:o,info:i,name:a,active:!0,fee:void 0,precision:n,limits:{amount:{min:Math.pow(10,-n),max:Math.pow(10,n)},price:{min:Math.pow(10,-n),max:Math.pow(10,n)},cost:{min:void 0,max:void 0},withdraw:{min:void 0,max:void 0}}}}return s}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t]+"/"+this.version+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));return Object.keys(o).length&&(n+="?"+this.urlencode(o)),{url:n,method:s,body:a,headers:r}}async request(e,t="public",s="GET",i={},a,n){const o=await this.fetch2(e,t,s,i,a,n);if("error"in o&&o.error)throw new r(this.id+" "+this.json(o));return o}}},948:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,InvalidOrder:n,OrderNotFound:o,RateLimitExceeded:c,InsufficientFunds:d}=s(3449),h=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"coinmate",name:"CoinMate",countries:["GB","CZ","EU"],rateLimit:1e3,has:{cancelOrder:!0,CORS:!0,createOrder:!0,fetchBalance:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTrades:!0,fetchTransactions:!0},urls:{logo:"https://user-images.githubusercontent.com/51840849/87460806-1c9f3f00-c616-11ea-8c46-a77018a8f3f4.jpg",api:"https://coinmate.io/api",www:"https://coinmate.io",fees:"https://coinmate.io/fees",doc:["https://coinmate.docs.apiary.io","https://coinmate.io/developers"],referral:"https://coinmate.io?referral=YTFkM1RsOWFObVpmY1ZjMGREQmpTRnBsWjJJNVp3PT0"},requiredCredentials:{apiKey:!0,secret:!0,uid:!0},api:{public:{get:["orderBook","ticker","transactions","tradingPairs"]},private:{post:["balances","bitcoinCashWithdrawal","bitcoinCashDepositAddresses","bitcoinDepositAddresses","bitcoinWithdrawal","bitcoinWithdrawalFees","buyInstant","buyLimit","cancelOrder","cancelOrderWithInfo","createVoucher","dashDepositAddresses","dashWithdrawal","ethereumWithdrawal","ethereumDepositAddresses","litecoinWithdrawal","litecoinDepositAddresses","openOrders","order","orderHistory","orderById","pusherAuth","redeemVoucher","replaceByBuyLimit","replaceByBuyInstant","replaceBySellLimit","replaceBySellInstant","rippleDepositAddresses","rippleWithdrawal","sellInstant","sellLimit","transactionHistory","traderFees","tradeHistory","transfer","transferHistory","unconfirmedBitcoinDeposits","unconfirmedBitcoinCashDeposits","unconfirmedDashDeposits","unconfirmedEthereumDeposits","unconfirmedLitecoinDeposits","unconfirmedRippleDeposits"]}},fees:{trading:{tierBased:!0,percentage:!0,maker:.0012,taker:.0025,tiers:{taker:[[0,.0025],[1e4,.0023],[1e5,.0021],[25e4,.002],[5e5,.0015],[1e6,.0013],[3e6,.001],[15e6,5e-4]],maker:[[0,.0012],[1e4,.0011],[1e6,.001],[25e4,8e-4],[5e5,5e-4],[1e6,3e-4],[3e6,2e-4],[15e6,0]]}},promotional:{trading:{maker:5e-4,taker:.0015,tiers:{taker:[[0,.0015],[1e4,.14/100],[1e5,.0013],[25e4,.0012],[5e5,.0011],[1e6,.001],[3e6,8e-4],[15e6,5e-4]],maker:[[0,5e-4],[1e4,4e-4],[1e6,3e-4],[25e4,2e-4],[5e5,0],[1e6,0],[3e6,0],[15e6,0]]}}}},options:{promotionalMarkets:["ETH/EUR","ETH/CZK","ETH/BTC","XRP/EUR","XRP/CZK","XRP/BTC","DASH/EUR","DASH/CZK","DASH/BTC","BCH/EUR","BCH/CZK","BCH/BTC"]},exceptions:{exact:{"No order with given ID":o},broad:{"Not enough account balance available":d,"Incorrect order ID":n,"Minimum Order Size ":n,"TOO MANY REQUESTS":c}}})}async fetchMarkets(e={}){const t=await this.publicGetTradingPairs(e),s=this.safeValue(t,"data"),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"name"),a=this.safeString(t,"firstCurrency"),n=this.safeString(t,"secondCurrency"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d=o+"/"+c,h=this.safeValue(this.options,"promotionalMarkets",[]);let u=this.safeValue(this.fees,"trading");if(this.inArray(d,h)){const e=this.safeValue(this.fees,"promotional",{});u=this.safeValue(e,"trading",u)}i.push({id:r,symbol:d,base:o,quote:c,baseId:a,quoteId:n,active:void 0,maker:u.maker,taker:u.taker,info:t,precision:{price:this.safeInteger(t,"priceDecimals"),amount:this.safeInteger(t,"lotDecimals")},limits:{amount:{min:this.safeNumber(t,"minAmount"),max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}}})}return i}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostBalances(e),s=this.safeValue(t,"data"),i={info:t},r=Object.keys(s);for(let e=0;e<r.length;e++){const t=r[e],a=this.safeCurrencyCode(t),n=this.safeValue(s,t),o=this.account();o.free=this.safeString(n,"available"),o.used=this.safeString(n,"reserved"),o.total=this.safeString(n,"balance"),i[a]=o}return this.parseBalance(i,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={currencyPair:this.marketId(e),groupByPriceLimit:"False"},r=(await this.publicGetOrderBook(this.extend(i,s))).data,a=this.safeTimestamp(r,"timestamp");return this.parseOrderBook(r,e,a,"bids","asks","price","amount")}async fetchTicker(e,t={}){await this.loadMarkets();const s={currencyPair:this.marketId(e)},i=await this.publicGetTicker(this.extend(s,t)),r=this.safeValue(i,"data"),a=this.safeTimestamp(r,"timestamp"),n=this.safeNumber(r,"last");return{symbol:e,timestamp:a,datetime:this.iso8601(a),high:this.safeNumber(r,"high"),low:this.safeNumber(r,"low"),bid:this.safeNumber(r,"bid"),bidVolume:void 0,ask:this.safeNumber(r,"ask"),vwap:void 0,askVolume:void 0,open:void 0,close:n,last:n,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(r,"amount"),quoteVolume:void 0,info:r}}async fetchTransactions(e,t,s,i={}){await this.loadMarkets();const r={limit:1e3};void 0!==s&&(r.limit=s),void 0!==t&&(r.timestampFrom=t),void 0!==e&&(r.currency=this.currencyId(e));const a=(await this.privatePostTransferHistory(this.extend(r,i))).data;return this.parseTransactions(a,void 0,t,s)}parseTransactionStatus(e){return this.safeString({COMPLETED:"ok"},e,e)}parseTransaction(e,t){const s=this.safeInteger(e,"timestamp"),i=this.safeNumber(e,"amount"),r=this.safeNumber(e,"fee"),a=this.safeString(e,"txid"),n=this.safeString(e,"destination"),o=this.safeString(e,"destinationTag"),c=this.safeString(e,"amountCurrency"),d=this.safeCurrencyCode(c,t),h=this.safeStringLower(e,"transferType"),u=this.parseTransactionStatus(this.safeString(e,"transferStatus"));return{id:this.safeString(e,"transactionId"),timestamp:s,datetime:this.iso8601(s),currency:d,amount:i,type:h,txid:a,address:n,tag:o,status:u,fee:{cost:r,currency:d},info:e}}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets(),void 0===s&&(s=1e3);const r={limit:s};if(void 0!==e){const t=this.market(e);r.currencyPair=t.id}void 0!==t&&(r.timestampFrom=t);const a=(await this.privatePostTradeHistory(this.extend(r,i))).data;return this.parseTrades(a,void 0,t,s)}parseTrade(e,t){const s=this.safeString(e,"currencyPair");t=this.safeMarket(s,t,"_");const i=this.safeString(e,"price"),r=this.safeString(e,"amount"),a=this.parseNumber(i),n=this.parseNumber(r),o=this.parseNumber(h.stringMul(i,r)),c=this.safeStringLower2(e,"type","tradeType"),d=this.safeStringLower(e,"orderType"),u=this.safeString(e,"orderId"),l=this.safeString(e,"transactionId"),f=this.safeInteger2(e,"timestamp","createdTimestamp");let p;const m=this.safeNumber(e,"fee");void 0!==m&&(p={cost:m,currency:t.quote});let b=this.safeString(e,"feeType");return b="MAKER"===b?"maker":"taker",{id:l,info:e,timestamp:f,datetime:this.iso8601(f),symbol:t.symbol,type:d,side:c,order:u,takerOrMaker:b,price:a,amount:n,cost:o,fee:p}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={currencyPair:r.id,minutesIntoHistory:10},n=await this.publicGetTransactions(this.extend(a,i)),o=this.safeValue(n,"data",[]);return this.parseTrades(o,r,t,s)}async fetchOpenOrders(e,t,s,i={}){const r=await this.privatePostOpenOrders(this.extend({},i));return this.parseOrders(r.data,void 0,t,s,{status:"open"})}async fetchOrders(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),n={currencyPair:r.id};void 0!==s&&(n.limit=s);const o=await this.privatePostOrderHistory(this.extend(n,i));return this.parseOrders(o.data,r,t,s)}parseOrderStatus(e){return this.safeString({FILLED:"closed",CANCELLED:"canceled",PARTIALLY_FILLED:"open",OPEN:"open"},e,e)}parseOrderType(e){return this.safeString({LIMIT:"limit",MARKET:"market"},e,e)}parseOrder(e,t){const s=this.safeString(e,"id"),i=this.safeInteger(e,"timestamp"),r=this.safeStringLower(e,"type"),a=this.safeNumber(e,"price"),n=this.safeNumber(e,"originalAmount");let o=this.safeNumber(e,"remainingAmount");void 0===o&&(o=this.safeNumber(e,"amount"));const c=this.parseOrderStatus(this.safeString(e,"status")),d=this.parseOrderType(this.safeString(e,"orderTradeType")),h=this.safeNumber(e,"avgPrice"),u=this.safeString(e,"currencyPair"),l=this.safeSymbol(u,t,"_"),f=this.safeString(e,"clientOrderId"),p=this.safeNumber(e,"stopPrice");return this.safeOrder({id:s,clientOrderId:f,timestamp:i,datetime:this.iso8601(i),lastTradeTimestamp:void 0,symbol:l,type:d,timeInForce:void 0,postOnly:void 0,side:r,price:a,stopPrice:p,amount:n,cost:void 0,average:h,filled:void 0,remaining:o,status:c,trades:void 0,info:e,fee:void 0})}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();let n="privatePost"+this.capitalize(s);const o={currencyPair:this.marketId(e)};"market"===t?("buy"===s?o.total=this.amountToPrecision(e,i):o.amount=this.amountToPrecision(e,i),n+="Instant"):(o.amount=this.amountToPrecision(e,i),o.price=this.priceToPrecision(e,r),n+=this.capitalize(t));const c=await this[n](this.extend(o,a));return{info:c,id:this.safeString(c,"data")}}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={orderId:e};let r;t&&(r=this.market(t));const a=await this.privatePostOrderById(this.extend(i,s)),n=this.safeValue(a,"data");return this.parseOrder(n,r)}async cancelOrder(e,t,s={}){const i={orderId:e};return{info:await this.privatePostCancelOrderWithInfo(this.extend(i,s))}}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api+"/"+e;if("public"===t)Object.keys(i).length&&(n+="?"+this.urlencode(i));else{this.checkRequiredCredentials();const e=this.nonce().toString(),t=e+this.uid+this.apiKey,s=this.hmac(this.encode(t),this.encode(this.secret));a=this.urlencode(this.extend({clientId:this.uid,nonce:e,publicKey:this.apiKey,signature:s.toUpperCase()},i)),r={"Content-Type":"application/x-www-form-urlencoded"}}return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0!==o&&"error"in o&&o.error){const e=this.safeString(o,"errorMessage"),t=this.id+" "+e;throw this.throwExactlyMatchedException(this.exceptions.exact,e,t),this.throwBroadlyMatchedException(this.exceptions.broad,e,t),new r(this.id+" "+this.json(o))}if(e>400){if(n){const e=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,n,e),this.throwBroadlyMatchedException(this.exceptions.broad,n,e),new r(e)}throw new r(this.id+" "+n)}}}},9261:(e,t,s)=>{"use strict";const i=s(8819),{BadSymbol:r,BadRequest:a,ExchangeError:n,ArgumentsRequired:o,OrderNotFound:c,OnMaintenance:d}=s(3449),h=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"coinone",name:"CoinOne",countries:["KR"],rateLimit:667,version:"v2",has:{cancelOrder:!0,CORS:!1,createMarketOrder:!1,createOrder:!0,fetchBalance:!0,fetchCurrencies:!1,fetchMarkets:!0,fetchMyTrades:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchClosedOrders:!1},urls:{logo:"https://user-images.githubusercontent.com/1294454/38003300-adc12fba-323f-11e8-8525-725f53c4a659.jpg",api:"https://api.coinone.co.kr",www:"https://coinone.co.kr",doc:"https://doc.coinone.co.kr"},requiredCredentials:{apiKey:!0,secret:!0},api:{public:{get:["orderbook/","trades/","ticker/"]},private:{post:["account/btc_deposit_address/","account/balance/","account/daily_balance/","account/user_info/","account/virtual_account/","order/cancel_all/","order/cancel/","order/limit_buy/","order/limit_sell/","order/complete_orders/","order/limit_orders/","order/order_info/","transaction/auth_number/","transaction/history/","transaction/krw/history/","transaction/btc/","transaction/coin/"]}},fees:{trading:{tierBased:!1,percentage:!0,taker:.002,maker:.002}},precision:{price:4,amount:4,cost:8},exceptions:{405:d,104:c,108:r,107:a},commonCurrencies:{SOC:"Soda Coin"}})}async fetchMarkets(e={}){const t=await this.publicGetTicker({currency:"all"}),s=[],i=this.safeCurrencyCode("krw"),r=Object.keys(t);for(let e=0;e<r.length;e++){const a=r[e],n=this.safeValue(t,a,{});if(void 0===this.safeValue(n,"currency"))continue;const o=this.safeCurrencyCode(a);s.push({info:n,id:a,symbol:o+"/"+i,base:o,quote:i,baseId:a,quoteId:"krw",active:!0})}return s}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostAccountBalance(e),s={info:t},i=this.omit(t,["errorCode","result","normalWallets"]),r=Object.keys(i);for(let e=0;e<r.length;e++){const t=r[e],a=i[t],n=this.safeCurrencyCode(t),o=this.account();o.free=this.safeString(a,"avail"),o.total=this.safeString(a,"balance"),s[n]=o}return this.parseBalance(s,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={currency:this.market(e).id,format:"json"},r=await this.publicGetOrderbook(this.extend(i,s)),a=this.safeTimestamp(r,"timestamp");return this.parseOrderBook(r,e,a,"bid","ask","price","qty")}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTicker(this.extend({currency:"all",format:"json"},t)),i={},r=Object.keys(s),a=this.safeTimestamp(s,"timestamp");for(let e=0;e<r.length;e++){const t=r[e];let n,o=t;if(t in this.markets_by_id){n=this.markets_by_id[t],o=n.symbol;const e=s[t];i[o]=this.parseTicker(e,n),i[o].timestamp=a}}return this.filterByArray(i,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={currency:s.id,format:"json"},r=await this.publicGetTicker(this.extend(i,t));return this.parseTicker(r,s)}parseTicker(e,t){const s=this.safeTimestamp(e,"timestamp"),i=this.safeNumber(e,"first"),r=this.safeNumber(e,"last");let a;void 0!==i&&void 0!==r&&(a=this.sum(i,r)/2);const n=this.safeNumber(e,"yesterday_last");let o,c;void 0!==r&&void 0!==n&&(o=r-n,0!==n&&(c=o/n*100));return{symbol:void 0!==t?t.symbol:void 0,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:void 0,bidVolume:void 0,ask:void 0,askVolume:void 0,vwap:void 0,open:i,close:r,last:r,previousClose:n,change:o,percentage:c,average:a,baseVolume:this.safeNumber(e,"volume"),quoteVolume:void 0,info:e}}parseTrade(e,t){const s=this.safeTimestamp(e,"timestamp"),i=void 0!==t?t.symbol:void 0,r=this.safeString(e,"is_ask");let a=this.safeString(e,"type");void 0!==r?"1"===r?a="sell":"0"===r&&(a="buy"):"ask"===a?a="sell":"bid"===a&&(a="buy");const n=this.safeString(e,"price"),o=this.safeString(e,"qty"),c=this.parseNumber(n),d=this.parseNumber(o),u=this.parseNumber(h.stringMul(n,o)),l=this.safeString(e,"orderId");let f,p=this.safeNumber(e,"fee");if(void 0!==p){p=Math.abs(p);let s,i=this.safeNumber(e,"feeRate");i=Math.abs(i),void 0!==t&&(s="sell"===a?t.quote:t.base),f={cost:p,currency:s,rate:i}}return{id:this.safeString(e,"id"),info:e,timestamp:s,datetime:this.iso8601(s),order:l,symbol:i,type:void 0,side:a,takerOrMaker:void 0,price:c,amount:d,cost:u,fee:f}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={currency:r.id,format:"json"},n=await this.publicGetTrades(this.extend(a,i)),o=this.safeValue(n,"completeOrders",[]);return this.parseTrades(o,r,t,s)}async createOrder(e,t,s,i,r,a={}){if("limit"!==t)throw new n(this.id+" allows limit orders only");await this.loadMarkets();const o={price:r,currency:this.marketId(e),qty:i},c="privatePostOrder"+this.capitalize(t)+this.capitalize(s),d=await this[c](this.extend(o,a));return this.parseOrder(d)}async fetchOrder(e,t,s={}){if(void 0===t)throw new o(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={order_id:e,currency:i.id},a=await this.privatePostOrderOrderInfo(this.extend(r,s)),n=this.safeValue(a,"info",{});return n.status=this.safeString(n,"status"),this.parseOrder(n,i)}parseOrderStatus(e){return this.safeString({live:"open",partially_filled:"open",filled:"closed"},e,e)}parseOrder(e,t){const s=this.safeString(e,"orderId"),i=this.safeNumber(e,"price"),r=this.safeTimestamp(e,"timestamp");let a=this.safeString(e,"type");"ask"===a?a="sell":"bid"===a&&(a="buy");const n=this.safeNumber(e,"remainQty"),o=this.safeNumber(e,"qty");let c,d,h,u=this.safeString(e,"status");"live"===u&&void 0!==n&&void 0!==o&&n<o&&(u="canceled"),u=this.parseOrderStatus(u);const l=this.safeStringLower(e,"currency");let f;void 0!==l&&(l in this.markets_by_id?t=this.markets_by_id[l]:(d=this.safeCurrencyCode(l),h="KRW",c=d+"/"+h)),void 0===c&&void 0!==t&&(c=t.symbol,d=t.base,h=t.quote);const p=this.safeNumber(e,"fee");if(void 0!==p){const t="sell"===a?h:d;f={cost:p,rate:this.safeNumber(e,"feeRate"),currency:t}}return this.safeOrder({info:e,id:s,clientOrderId:void 0,timestamp:r,datetime:this.iso8601(r),lastTradeTimestamp:void 0,symbol:c,type:"limit",timeInForce:void 0,postOnly:void 0,side:a,price:i,stopPrice:void 0,cost:void 0,average:void 0,amount:o,filled:void 0,remaining:n,status:u,fee:f,trades:void 0})}async fetchOpenOrders(e,t,s,i={}){if(void 0===e)throw new n(this.id+" allows fetching closed orders with a specific symbol");await this.loadMarkets();const r=this.market(e),a={currency:r.id},o=await this.privatePostOrderLimitOrders(this.extend(a,i)),c=this.safeValue(o,"limitOrders",[]);return this.parseOrders(c,r,t,s)}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new o(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a={currency:r.id},n=await this.privatePostOrderCompleteOrders(this.extend(a,i)),c=this.safeValue(n,"completeOrders",[]);return this.parseTrades(c,r,t,s)}async cancelOrder(e,t,s={}){if(void 0===t)throw new o(this.id+" cancelOrder() requires a symbol argument. To cancel the order, pass a symbol argument and {'price': 12345, 'qty': 1.2345, 'is_ask': 0} in the params argument of cancelOrder.");const i=this.safeNumber(s,"price"),r=this.safeNumber(s,"qty"),a=this.safeInteger(s,"is_ask");if(void 0===i||void 0===r||void 0===a)throw new o(this.id+" cancelOrder() requires {'price': 12345, 'qty': 1.2345, 'is_ask': 0} in the params argument.");await this.loadMarkets();const n={order_id:e,price:i,qty:r,is_ask:a,currency:this.marketId(t)};return await this.privatePostOrderCancel(this.extend(n,s))}sign(e,t="public",s="GET",i={},r,a){const n=this.implodeParams(e,i),o=this.omit(i,this.extractParams(e));let c=this.urls.api+"/";if("public"===t)c+=n,Object.keys(o).length&&(c+="?"+this.urlencode(o));else{this.checkRequiredCredentials(),c+=this.version+"/"+n;const e=this.nonce().toString(),t=this.json(this.extend({access_token:this.apiKey,nonce:e},i)),s=this.stringToBase64(t);a=this.decode(s);const o=this.secret.toUpperCase();r={"Content-Type":"application/json","X-COINONE-PAYLOAD":s,"X-COINONE-SIGNATURE":this.hmac(s,this.encode(o),"sha512")}}return{url:c,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,a,o,c,d){if(void 0!==o){if(!("result"in o))throw new n(this.id+" "+a);if("success"!==o.result){const e=this.safeString(o,"errorCode"),t=this.id+" "+a;throw this.throwExactlyMatchedException(this.exceptions,e,t),new n(t)}}}}},8974:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,AuthenticationError:n}=s(3449),o=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"coinspot",name:"CoinSpot",countries:["AU"],rateLimit:1e3,has:{cancelOrder:!1,CORS:!1,createMarketOrder:!1,createOrder:!0,fetchBalance:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTrades:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/28208429-3cacdf9a-6896-11e7-854e-4c79a772a30f.jpg",api:{public:"https://www.coinspot.com.au/pubapi",private:"https://www.coinspot.com.au/api"},www:"https://www.coinspot.com.au",doc:"https://www.coinspot.com.au/api",referral:"https://www.coinspot.com.au/register?code=PJURCU"},api:{public:{get:["latest"]},private:{post:["orders","orders/history","my/coin/deposit","my/coin/send","quote/buy","quote/sell","my/balances","my/orders","my/buy","my/sell","my/buy/cancel","my/sell/cancel","ro/my/balances","ro/my/balances/{cointype}","ro/my/deposits","ro/my/withdrawals","ro/my/transactions","ro/my/transactions/{cointype}","ro/my/transactions/open","ro/my/transactions/{cointype}/open","ro/my/sendreceive","ro/my/affiliatepayments","ro/my/referralpayments"]}},markets:{"BTC/AUD":{id:"btc",symbol:"BTC/AUD",base:"BTC",quote:"AUD",baseId:"btc",quoteId:"aud"},"ETH/AUD":{id:"eth",symbol:"ETH/AUD",base:"ETH",quote:"AUD",baseId:"eth",quoteId:"aud"},"XRP/AUD":{id:"xrp",symbol:"XRP/AUD",base:"XRP",quote:"AUD",baseId:"xrp",quoteId:"aud"},"LTC/AUD":{id:"ltc",symbol:"LTC/AUD",base:"LTC",quote:"AUD",baseId:"ltc",quoteId:"aud"},"DOGE/AUD":{id:"doge",symbol:"DOGE/AUD",base:"DOGE",quote:"AUD",baseId:"doge",quoteId:"aud"},"RFOX/AUD":{id:"rfox",symbol:"RFOX/AUD",base:"RFOX",quote:"AUD",baseId:"rfox",quoteId:"aud"},"POWR/AUD":{id:"powr",symbol:"POWR/AUD",base:"POWR",quote:"AUD",baseId:"powr",quoteId:"aud"},"NEO/AUD":{id:"neo",symbol:"NEO/AUD",base:"NEO",quote:"AUD",baseId:"neo",quoteId:"aud"},"TRX/AUD":{id:"trx",symbol:"TRX/AUD",base:"TRX",quote:"AUD",baseId:"trx",quoteId:"aud"},"EOS/AUD":{id:"eos",symbol:"EOS/AUD",base:"EOS",quote:"AUD",baseId:"eos",quoteId:"aud"},"XLM/AUD":{id:"xlm",symbol:"XLM/AUD",base:"XLM",quote:"AUD",baseId:"xlm",quoteId:"aud"},"RHOC/AUD":{id:"rhoc",symbol:"RHOC/AUD",base:"RHOC",quote:"AUD",baseId:"rhoc",quoteId:"aud"},"GAS/AUD":{id:"gas",symbol:"GAS/AUD",base:"GAS",quote:"AUD",baseId:"gas",quoteId:"aud"}},commonCurrencies:{DRK:"DASH"},options:{fetchBalance:"private_post_my_balances"}})}async fetchBalance(e={}){await this.loadMarkets();const t=this.safeString(this.options,"fetchBalance","private_post_my_balances"),s=await this[t](e),i={info:s},r=this.safeValue2(s,"balance","balances");if(Array.isArray(r))for(let e=0;e<r.length;e++){const t=r[e],s=Object.keys(t);for(let e=0;e<s.length;e++){const r=s[e],a=t[r],n=this.safeCurrencyCode(r),o=this.account();o.total=this.safeString(a,"balance"),i[n]=o}}else{const e=Object.keys(r);for(let t=0;t<e.length;t++){const s=e[t],a=this.safeCurrencyCode(s),n=this.account();n.total=this.safeString(r,s),i[a]=n}}return this.parseBalance(i,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={cointype:this.market(e).id},r=await this.privatePostOrders(this.extend(i,s));return this.parseOrderBook(r,e,void 0,"buyorders","sellorders","rate","amount")}async fetchTicker(e,t={}){await this.loadMarkets();const s=await this.publicGetLatest(t);let i=this.marketId(e);i=i.toLowerCase();const r=s.prices[i],a=this.milliseconds(),n=this.safeNumber(r,"last");return{symbol:e,timestamp:a,datetime:this.iso8601(a),high:void 0,low:void 0,bid:this.safeNumber(r,"bid"),bidVolume:void 0,ask:this.safeNumber(r,"ask"),askVolume:void 0,vwap:void 0,open:void 0,close:n,last:n,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:void 0,quoteVolume:void 0,info:r}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={cointype:r.id},n=await this.privatePostOrdersHistory(this.extend(a,i)),o=this.safeValue(n,"orders",[]);return this.parseTrades(o,r,t,s)}parseTrade(e,t){const s=this.safeString(e,"rate"),i=this.safeString(e,"amount"),r=this.parseNumber(s),a=this.parseNumber(i);let n=this.safeNumber(e,"total");void 0===n&&(n=this.parseNumber(o.stringMul(s,i)));const c=this.safeInteger(e,"solddate"),d=this.safeString(e,"market");return{info:e,id:void 0,symbol:this.safeSymbol(d,t,"/"),timestamp:c,datetime:this.iso8601(c),order:void 0,type:void 0,side:void 0,takerOrMaker:void 0,price:r,amount:a,cost:n,fee:void 0}}async createOrder(e,t,s,i,a,n={}){await this.loadMarkets();const o="privatePostMy"+this.capitalize(s);if("market"===t)throw new r(this.id+" allows limit orders only");const c={cointype:this.marketId(e),amount:i,rate:a};return await this[o](this.extend(c,n))}async cancelOrder(e,t,s={}){const i=this.safeString(s,"side");if("buy"!==i&&"sell"!==i)throw new a(this.id+' cancelOrder() requires a side parameter, "buy" or "sell"');s=this.omit(s,"side");const r="privatePostMy"+this.capitalize(i)+"Cancel",n={id:e};return await this[r](this.extend(n,s))}sign(e,t="public",s="GET",i={},r,a){if(!this.apiKey)throw new n(this.id+" requires apiKey for all requests");const o=this.urls.api[t]+"/"+e;if("private"===t){this.checkRequiredCredentials();const e=this.nonce();a=this.json(this.extend({nonce:e},i)),r={"Content-Type":"application/json",key:this.apiKey,sign:this.hmac(this.encode(a),this.encode(this.secret),"sha512")}}return{url:o,method:s,body:a,headers:r}}}},7268:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,BadRequest:a,InvalidNonce:n,RequestTimeout:o,ExchangeNotAvailable:c,InsufficientFunds:d,OrderNotFound:h,InvalidOrder:u,DDoSProtection:l,AuthenticationError:f,BadSymbol:p}=s(3449),{TICK_SIZE:m}=s(2115),b=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"crex24",name:"CREX24",countries:["EE"],rateLimit:500,version:"v2",has:{cancelAllOrders:!0,cancelOrder:!0,CORS:!1,createOrder:!0,editOrder:!0,fetchBalance:!0,fetchBidsAsks:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchFundingFees:!1,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchOrderTrades:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTradingFee:!1,fetchTradingFees:!1,fetchTransactions:!0,fetchWithdrawals:!0,withdraw:!0},timeframes:{"1m":"1m","3m":"3m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","4h":"4h","1d":"1d","1w":"1w","1M":"1mo"},urls:{logo:"https://user-images.githubusercontent.com/1294454/47813922-6f12cc00-dd5d-11e8-97c6-70f957712d47.jpg",api:"https://api.crex24.com",www:"https://crex24.com",referral:"https://crex24.com/?refid=slxsjsjtil8xexl9hksr",doc:"https://docs.crex24.com/trade-api/v2",fees:"https://crex24.com/fees"},api:{public:{get:["currencies","instruments","tickers","recentTrades","orderBook","ohlcv"]},trading:{get:["orderStatus","orderTrades","activeOrders","orderHistory","tradeHistory","tradeFee","moneyTransferStatus"],post:["placeOrder","modifyOrder","cancelOrdersById","cancelOrdersByInstrument","cancelAllOrders"]},account:{get:["balance","depositAddress","moneyTransfers","moneyTransferStatus","previewWithdrawal"],post:["withdraw"]}},precisionMode:m,fees:{trading:{tierBased:!0,percentage:!0,taker:.001,maker:-1e-4},funding:{tierBased:!1,percentage:!1,withdraw:{},deposit:{}}},commonCurrencies:{BCC:"BCH",BIT:"BitMoney",BULL:"BuySell",CREDIT:"TerraCredit",EPS:"Epanus",FUND:"FUNDChains",GHOST:"GHOSTPRISM",GTC:"GastroCoin",IQ:"IQ.Cash",PUT:"PutinCoin",SBTC:"SBTCT",UNI:"Universe",YOYO:"YOYOW"},options:{fetchOrdersMethod:"tradingGetOrderHistory",fetchClosedOrdersMethod:"tradingGetOrderHistory",fetchTickersMethod:"publicGetTicker24hr",defaultTimeInForce:"GTC",hasAlreadyAuthenticatedSuccessfully:!1,warnOnFetchOpenOrdersWithoutSymbol:!0,parseOrderToPrecision:!1,newOrderRespType:"RESULT"},exceptions:{exact:{"Parameter 'filter' contains invalid value.":a,"Mandatory parameter 'instrument' is missing.":a,"The value of parameter 'till' must be greater than or equal to the value of parameter 'from'.":a,"Failed to verify request signature.":f,"Nonce error. Make sure that the value passed in the 'X-CREX24-API-NONCE' header is greater in each consecutive request than in the previous one for the corresponding API-Key provided in 'X-CREX24-API-KEY' header.":n,"Market orders are not supported by the instrument currently.":u,"Parameter 'instrument' contains invalid value.":p},broad:{"try again later":c,"API Key":f,"Insufficient funds":d,"has been delisted.":p,"is currently suspended.":p,"Mandatory parameter":a}}})}nonce(){return this.milliseconds()}async fetchMarkets(e={}){const t=await this.publicGetInstruments(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"symbol"),a=this.safeString(i,"baseCurrency"),n=this.safeString(i,"quoteCurrency"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d=o+"/"+c,h=this.safeNumber(i,"tickSize"),u=this.safeNumber(i,"minPrice"),l=this.safeNumber(i,"minVolume"),f={amount:l,price:h},p="active"===i.state;s.push({id:r,symbol:d,base:o,quote:c,baseId:a,quoteId:n,info:i,active:p,precision:f,limits:{amount:{min:l,max:void 0},price:{min:u,max:void 0},cost:{min:void 0,max:void 0}}})}return s}async fetchCurrencies(e={}){const t=await this.publicGetCurrencies(e),s={};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"symbol"),a=this.safeCurrencyCode(r),n=this.safeInteger(i,"withdrawalPrecision"),o=Math.pow(10,-n),c=this.safeValue(i,"BaseAddress"),d=i.depositsAllowed&&i.withdrawalsAllowed&&!i.isDelisted,h=i.isFiat?"fiat":"crypto";s[a]={id:r,code:a,address:c,info:i,type:h,name:this.safeString(i,"name"),active:d,fee:this.safeNumber(i,"flatWithdrawalFee"),precision:o,limits:{amount:{min:Math.pow(10,-o),max:Math.pow(10,o)},deposit:{min:this.safeNumber(i,"minDeposit"),max:void 0},withdraw:{min:this.safeNumber(i,"minWithdrawal"),max:this.safeNumber(i,"maxWithdrawal")}}}}return s}async fetchBalance(e={}){await this.loadMarkets();const t=await this.accountGetBalance(this.extend({},e)),s={info:t};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"currency"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(i,"available"),n.used=this.safeString(i,"reserved"),s[a]=n}return this.parseBalance(s,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={instrument:this.market(e).id};void 0!==t&&(i.limit=t);const r=await this.publicGetOrderBook(this.extend(i,s));return this.parseOrderBook(r,e,void 0,"buyLevels","sellLevels","price","volume")}parseTicker(e,t){const s=this.parse8601(this.safeString(e,"timestamp")),i=this.safeString(e,"instrument"),r=this.safeSymbol(i,t,"-"),a=this.safeNumber(e,"last");return{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"bid"),bidVolume:void 0,ask:this.safeNumber(e,"ask"),askVolume:void 0,vwap:void 0,open:void 0,close:a,last:a,previousClose:void 0,change:void 0,percentage:this.safeNumber(e,"percentChange"),average:void 0,baseVolume:this.safeNumber(e,"baseVolume"),quoteVolume:this.safeNumber(e,"quoteVolume"),info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={instrument:s.id},a=await this.publicGetTickers(this.extend(i,t));if(a.length<1)throw new r(this.id+" fetchTicker could not load quotes for symbol "+e);return this.parseTicker(a[0],s)}async fetchTickers(e,t={}){await this.loadMarkets();const s={};if(void 0!==e){const t=this.marketIds(e);s.instrument=t.join(",")}const i=await this.publicGetTickers(this.extend(s,t));return this.parseTickers(i,e)}parseTrade(e,t){const s=this.parse8601(this.safeString(e,"timestamp")),i=this.safeString(e,"price"),r=this.safeString(e,"volume"),a=this.parseNumber(i),n=this.parseNumber(r),o=this.parseNumber(b.stringMul(i,r)),c=this.safeString(e,"id"),d=this.safeString(e,"side"),h=this.safeString(e,"orderId"),u=this.safeString(e,"instrument"),l=this.safeSymbol(u,t,"-");let f;const p=this.safeString(e,"feeCurrency"),m=this.safeCurrencyCode(p),g=this.safeNumber(e,"fee");void 0!==g&&(f={cost:g,currency:m});return{info:e,timestamp:s,datetime:this.iso8601(s),symbol:l,id:c,order:h,type:void 0,takerOrMaker:undefined,side:d,price:a,cost:o,amount:n,fee:f}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={instrument:r.id};void 0!==s&&(a.limit=s);const n=await this.publicGetRecentTrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}parseOHLCV(e,t){return[this.parse8601(this.safeString(e,"timestamp")),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={granularity:this.timeframes[t],instrument:a.id};void 0!==i&&(n.limit=i);const o=await this.publicGetOhlcv(this.extend(n,r));return this.parseOHLCVs(o,a,t,s,i)}parseOrderStatus(e){const t={submitting:"open",unfilledActive:"open",partiallyFilledActive:"open",filled:"closed",partiallyFilledCancelled:"canceled",unfilledCancelled:"canceled"};return e in t?t[e]:e}parseOrder(e,t){const s=this.parseOrderStatus(this.safeString(e,"status")),i=this.safeString(e,"instrument"),r=this.safeSymbol(i,t,"-"),a=this.parse8601(this.safeString(e,"timestamp")),n=this.safeNumber(e,"price"),o=this.safeNumber(e,"volume"),c=this.safeNumber(e,"remainingVolume"),d=this.parse8601(this.safeString(e,"lastUpdate")),h=this.safeString(e,"id"),u=this.safeString(e,"type"),l=this.safeString(e,"side"),f=this.safeString(e,"timeInForce"),p=this.safeNumber(e,"stopPrice");return this.safeOrder({info:e,id:h,clientOrderId:void 0,timestamp:a,datetime:this.iso8601(a),lastTradeTimestamp:d,symbol:r,type:u,timeInForce:f,side:l,price:n,stopPrice:p,amount:o,cost:void 0,average:undefined,filled:void 0,remaining:c,status:s,fee:undefined,trades:undefined})}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o={instrument:n.id,volume:this.amountToPrecision(e,i),type:t,side:s};let c=!1,d=!1;if("limit"===t?c=!0:"stopLimit"===t&&(c=!0,d=!0),c){if(void 0===r)throw new u(this.id+" createOrder() requires a price argument for a "+t+" order");o.price=this.priceToPrecision(e,r)}if(d){const s=this.safeNumber(a,"stopPrice");if(void 0===s)throw new u(this.id+" createOrder() requires a stopPrice extra param for a "+t+" order");o.stopPrice=this.priceToPrecision(e,s),a=this.omit(a,"stopPrice")}const h=await this.tradingPostPlaceOrder(this.extend(o,a));return this.parseOrder(h,n)}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={id:e},r=await this.tradingGetOrderStatus(this.extend(i,s));if(r.length<1)throw new h(this.id+" fetchOrder could not fetch order id "+e);return this.parseOrder(r[0])}async fetchOrders(e,t,s,i={}){await this.loadMarkets();const r={};if(void 0!==t&&(r.from=this.ymdhms(t,"T")),void 0!==s&&(r.limit=s),void 0!==e){const t=this.market(e);r.instrument=t.id}const a=this.safeString(this.options,"fetchOrdersMethod","tradingGetOrderHistory"),n=await this[a](this.extend(r,i));return this.parseOrders(n)}async fetchOrdersByIds(e,t,s,i={}){await this.loadMarkets();const r={id:e.join(",")},a=await this.tradingGetOrderStatus(this.extend(r,i));return this.parseOrders(a,void 0,t,s)}async fetchOpenOrders(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.market(e),a.instrument=r.id);const n=await this.tradingGetActiveOrders(this.extend(a,i));return this.parseOrders(n,r,t,s)}async fetchClosedOrders(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.market(e),a.instrument=r.id),void 0!==t&&(a.from=this.ymdhms(t,"T")),void 0!==s&&(a.limit=s);const n=this.safeString(this.options,"fetchClosedOrdersMethod","tradingGetOrderHistory"),o=await this[n](this.extend(a,i));return this.parseOrders(o,r,t,s)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={ids:[parseInt(e)]},r=await this.tradingPostCancelOrdersById(this.extend(i,s));return this.parseOrder(r)}async cancelAllOrders(e,t={}){return await this.tradingPostCancelAllOrders(t)}async fetchMyTrades(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.market(e),a.instrument=r.id),void 0!==t&&(a.from=this.ymdhms(t,"T")),void 0!==s&&(a.limit=s);const n=await this.tradingGetTradeHistory(this.extend(a,i));return this.parseTrades(n,r,t,s)}async fetchTransactions(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.currency(e),a.currency=r.id),void 0!==t&&(a.from=this.ymd(t,"T"));const n=await this.accountGetMoneyTransfers(this.extend(a,i));return this.parseTransactions(n,r,t,s)}async fetchDeposits(e,t,s,i={}){return this.fetchTransactions(e,t,s,this.extend({type:"deposit"},i))}async fetchWithdrawals(e,t,s,i={}){return this.fetchTransactions(e,t,s,this.extend({type:"withdrawal"},i))}parseTransactionStatus(e){return this.safeString({pending:"pending",success:"ok",failed:"failed"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"address"),r=this.safeString(e,"paymentId"),a=this.safeValue(e,"txId"),n=this.safeString(e,"currency"),o=this.safeCurrencyCode(n,t),c=this.safeString(e,"type"),d=this.parse8601(this.safeString(e,"createdAt")),h=this.parse8601(this.safeString(e,"processedAt")),u=this.parseTransactionStatus(this.safeString(e,"status")),l=this.safeNumber(e,"amount"),f={cost:this.safeNumber(e,"fee"),currency:o};return{info:e,id:s,txid:a,timestamp:d,datetime:this.iso8601(d),address:i,tag:r,type:c,amount:l,currency:o,status:u,updated:h,fee:f}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={currency:this.currency(e).id},i=await this.accountGetDepositAddress(this.extend(s,t)),r=this.safeString(i,"address"),a=this.safeString(i,"paymentId");return{currency:e,address:this.checkAddress(r),tag:a,info:i}}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a=this.currency(e),n={currency:a.id,address:s,amount:parseFloat(this.currencyToPrecision(e,t)),feeCurrency:a.id};void 0!==i&&(n.paymentId=i);const o=await this.accountPostWithdraw(this.extend(n,r));return this.parseTransaction(o)}sign(e,t="public",s="GET",i={},r,a){let n="/"+this.version+"/"+t+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));"GET"===s&&Object.keys(o).length&&(n+="?"+this.urlencode(o));const c=this.urls.api+n;if("trading"===t||"account"===t){this.checkRequiredCredentials();const e=this.nonce().toString(),t=this.base64ToBinary(this.secret);let o=n+e;r={"X-CREX24-API-KEY":this.apiKey,"X-CREX24-API-NONCE":e},"POST"===s&&(r["Content-Type"]="application/json",o+=a=this.json(i)),r["X-CREX24-API-SIGN"]=this.hmac(this.encode(o),t,"sha512","base64")}return{url:c,method:s,body:a,headers:r}}handleErrors(e,t,s,i,n,d,h,u,p){if(!this.isJsonEncodedObject(d))return;if(e>=200&&e<300)return;const m=this.safeString(h,"errorDescription"),b=this.id+" "+d;if(this.throwExactlyMatchedException(this.exceptions.exact,m,b),this.throwBroadlyMatchedException(this.exceptions.broad,m,b),400===e)throw new a(b);if(401===e)throw new f(b);if(403===e)throw new f(b);if(429===e)throw new l(b);if(500===e)throw new r(b);if(503===e)throw new c(b);if(504===e)throw new o(b);throw new r(b)}}},9610:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,ExchangeNotAvailable:n,InsufficientFunds:o,OrderNotFound:c,InvalidOrder:d,DDoSProtection:h,InvalidNonce:u,AuthenticationError:l,BadRequest:f}=s(3449),{TICK_SIZE:p}=s(2115),m=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"currencycom",name:"Currency.com",countries:["BY"],rateLimit:500,certified:!0,pro:!0,version:"v1",has:{cancelOrder:!0,CORS:!1,createOrder:!0,fetchAccounts:!0,fetchBalance:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTradingFees:!0,fetchTrades:!0},timeframes:{"1m":"1m","3m":"3m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","4h":"4h","1d":"1d","1w":"1w"},urls:{logo:"https://user-images.githubusercontent.com/1294454/83718672-36745c00-a63e-11ea-81a9-677b1f789a4d.jpg",api:{public:"https://api-adapter.backend.currency.com/api",private:"https://api-adapter.backend.currency.com/api"},www:"https://www.currency.com",referral:"https://currency.com/trading/signup?c=362jaimv&pid=referral",doc:["https://currency.com/api"],fees:"https://currency.com/fees-charges"},api:{public:{get:["time","exchangeInfo","depth","aggTrades","klines","ticker/24hr"]},private:{get:["leverageSettings","openOrders","tradingPositions","account","myTrades"],post:["order","updateTradingPosition","updateTradingOrder","closeTradingPosition"],delete:["order"]}},fees:{trading:{feeSide:"get",tierBased:!1,percentage:!0,taker:.002,maker:.002}},precisionMode:p,options:{defaultTimeInForce:"GTC",warnOnFetchOpenOrdersWithoutSymbol:!0,recvWindow:5e3,timeDifference:0,adjustForTimeDifference:!1,parseOrderToPrecision:!1,newOrderRespType:{market:"FULL",limit:"RESULT",stop:"RESULT"}},exceptions:{broad:{"FIELD_VALIDATION_ERROR Cancel is available only for LIMIT order":d,"API key does not exist":l,"Order would trigger immediately.":d,"Account has insufficient balance for requested action.":o,"Rest API trading is not enabled.":n},exact:{"-1000":n,"-1013":d,"-1021":u,"-1022":l,"-1100":d,"-1104":r,"-1025":l,"-1128":f,"-2010":r,"-2011":c,"-2013":c,"-2014":l,"-2015":l}},commonCurrencies:{BNS:"Bank of Nova Scotia",ETN:"Eaton",IQ:"iQIYI",PLAY:"Dave & Buster's Entertainment"}})}nonce(){return this.milliseconds()-this.options.timeDifference}async fetchTime(e={}){const t=await this.publicGetTime(e);return this.safeInteger(t,"serverTime")}async loadTimeDifference(e={}){const t=await this.publicGetTime(e),s=this.milliseconds();return this.options.timeDifference=parseInt(s-t.serverTime),this.options.timeDifference}async fetchMarkets(e={}){const t=await this.publicGetExchangeInfo(e);this.options.adjustForTimeDifference&&await this.loadTimeDifference();const s=this.safeValue(t,"symbols"),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"symbol"),a=this.safeString(t,"baseAsset"),n=this.safeString(t,"quoteAsset"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n);let d=o+"/"+c;r.indexOf("/")>=0&&(d=r);const h=this.safeValue(t,"filters",[]),u=this.indexBy(h,"filterType"),l={amount:1/Math.pow(1,this.safeInteger(t,"baseAssetPrecision")),price:this.safeNumber(t,"tickSize")},f="TRADING"===this.safeString(t,"status");let p=this.safeStringLower(t,"marketType");"leverage"===p&&(p="margin");const m={id:r,symbol:d,base:o,quote:c,baseId:a,quoteId:n,type:p,spot:"spot"===p,margin:"margin"===p,info:t,active:f,precision:l,limits:{amount:{min:Math.pow(10,-l.amount),max:void 0},price:{min:void 0,max:void 0},cost:{min:-Math.log10(l.amount),max:void 0}}},b=this.safeNumber2(t,"exchangeFee","tradingFee"),g=this.safeNumber(t,"makerFee",b),y=this.safeNumber(t,"takerFee",b);if(void 0!==g&&(m.maker=g/100),void 0!==y&&(m.taker=y/100),"PRICE_FILTER"in u){const e=this.safeValue(u,"PRICE_FILTER",{});m.precision.price=this.safeNumber(e,"tickSize"),m.limits.price={min:this.safeNumber(e,"minPrice"),max:void 0};const t=this.safeNumber(e,"maxPrice");void 0!==t&&t>0&&(m.limits.price.max=t)}if("LOT_SIZE"in u){const e=this.safeValue(u,"LOT_SIZE",{});m.precision.amount=this.safeNumber(e,"stepSize"),m.limits.amount={min:this.safeNumber(e,"minQty"),max:this.safeNumber(e,"maxQty")}}if("MARKET_LOT_SIZE"in u){const e=this.safeValue(u,"MARKET_LOT_SIZE",{});m.limits.market={min:this.safeNumber(e,"minQty"),max:this.safeNumber(e,"maxQty")}}if("MIN_NOTIONAL"in u){const e=this.safeValue(u,"MIN_NOTIONAL",{});m.limits.cost.min=this.safeNumber(e,"minNotional")}i.push(m)}return i}async fetchAccounts(e={}){const t=await this.privateGetAccount(e),s=this.safeValue(t,"balances",[]),i=[];for(let e=0;e<s.length;e++){const r=s[e],a=this.safeInteger(r,"accountId"),n=this.safeString(r,"asset"),o=this.safeCurrencyCode(n);i.push({id:a,type:void 0,currency:o,info:t})}return i}async fetchTradingFees(e={}){await this.loadMarkets();const t=await this.privateGetAccount(e);return{info:t,maker:this.safeNumber(t,"makerCommission"),taker:this.safeNumber(t,"takerCommission")}}parseBalanceResponse(e){const t={info:e},s=this.safeValue(e,"balances",[]);for(let e=0;e<s.length;e++){const i=s[e],r=this.safeString(i,"asset"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(i,"free"),n.used=this.safeString(i,"locked"),t[a]=n}return this.parseBalance(t,!1)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetAccount(e);return this.parseBalanceResponse(t)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.market(e).id};void 0!==t&&(i.limit=t);const r=await this.publicGetDepth(this.extend(i,s)),a=this.parseOrderBook(r,e);return a.nonce=this.safeInteger(r,"lastUpdateId"),a}parseTicker(e,t){const s=this.safeInteger(e,"closeTime"),i=this.safeString(e,"symbol"),r=this.safeSymbol(i,t),a=this.safeNumber(e,"lastPrice"),n=this.safeNumber(e,"openPrice");let o;return void 0!==n&&void 0!==a&&(o=this.sum(n,a)/2),{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"highPrice"),low:this.safeNumber(e,"lowPrice"),bid:this.safeNumber(e,"bidPrice"),bidVolume:this.safeNumber(e,"bidQty"),ask:this.safeNumber(e,"askPrice"),askVolume:this.safeNumber(e,"askQty"),vwap:this.safeNumber(e,"weightedAvgPrice"),open:n,close:a,last:a,previousClose:this.safeNumber(e,"prevClosePrice"),change:this.safeNumber(e,"priceChange"),percentage:this.safeNumber(e,"priceChangePercent"),average:o,baseVolume:this.safeNumber(e,"volume"),quoteVolume:this.safeNumber(e,"quoteVolume"),info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.publicGetTicker24hr(this.extend(i,t));return this.parseTicker(r,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTicker24hr(t);return this.parseTickers(s,e)}parseOHLCV(e,t){return[this.safeInteger(e,0),this.safeNumber(e,1),this.safeNumber(e,2),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,5)]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={symbol:a.id,interval:this.timeframes[t]};void 0!==s&&(n.startTime=s),void 0!==i&&(n.limit=i);const o=await this.publicGetKlines(this.extend(n,r));return this.parseOHLCVs(o,a,t,s,i)}parseTrade(e,t){const s=this.safeInteger2(e,"T","time"),i=this.safeString2(e,"p","price"),r=this.safeString2(e,"q","qty"),a=this.parseNumber(i),n=this.parseNumber(r),o=this.parseNumber(m.stringMul(i,r)),c=this.safeString2(e,"a","id");let d;const h=this.safeString(e,"orderId");let u,l;"m"in e?d=e.m?"sell":"buy":"isBuyerMaker"in e?d=e.isBuyerMaker?"sell":"buy":"isBuyer"in e&&(d=e.isBuyer?"buy":"sell"),"commission"in e&&(u={cost:this.safeNumber(e,"commission"),currency:this.safeCurrencyCode(this.safeString(e,"commissionAsset"))}),"isMaker"in e&&(l=e.isMaker?"maker":"taker");const f=this.safeString(e,"symbol"),p=this.safeSymbol(f,t);return{info:e,timestamp:s,datetime:this.iso8601(s),symbol:p,id:c,order:h,type:void 0,takerOrMaker:l,side:d,price:a,amount:n,cost:o,fee:u}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id};void 0!==s&&(a.limit=s);const n=await this.publicGetAggTrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}parseOrderStatus(e){return this.safeString({NEW:"open",PARTIALLY_FILLED:"open",FILLED:"closed",CANCELED:"canceled",PENDING_CANCEL:"canceling",REJECTED:"rejected",EXPIRED:"expired"},e,e)}parseOrder(e,t){const s=this.parseOrderStatus(this.safeString(e,"status")),i=this.safeString(e,"symbol"),r=this.safeSymbol(i,t,"/");let a;"time"in e?a=this.safeInteger(e,"time"):"transactTime"in e&&(a=this.safeInteger(e,"transactTime"));const n=this.safeNumber(e,"price"),o=this.safeNumber(e,"origQty"),c=this.safeNumber(e,"executedQty"),d=this.safeNumber(e,"cummulativeQuoteQty"),h=this.safeString(e,"orderId"),u=this.safeStringLower(e,"type"),l=this.safeStringLower(e,"side");let f;const p=this.safeValue(e,"fills");void 0!==p&&(f=this.parseTrades(p,t));const m=this.safeString(e,"timeInForce");return this.safeOrder({info:e,id:h,timestamp:a,datetime:this.iso8601(a),lastTradeTimestamp:void 0,symbol:r,type:u,timeInForce:m,side:l,price:n,stopPrice:void 0,amount:o,cost:d,average:void 0,filled:c,remaining:undefined,status:s,fee:void 0,trades:f})}async createOrder(e,t,s,i,r,n={}){await this.loadMarkets();const o=this.market(e);let c;if(o.margin&&(c=this.safeInteger(n,"accountId"),void 0===c))throw new a(this.id+" createOrder() requires an accountId parameter for "+o.type+" market "+e);const d=t.toUpperCase(),h=this.safeValue(this.options.newOrderRespType,t,"RESULT"),u={symbol:o.id,quantity:this.amountToPrecision(e,i),type:d,side:s.toUpperCase(),newOrderRespType:h};"LIMIT"===d?(u.price=this.priceToPrecision(e,r),u.timeInForce=this.options.defaultTimeInForce):"STOP"===d&&(u.price=this.priceToPrecision(e,r));const l=await this.privatePostOrder(this.extend(u,n));return this.parseOrder(l,o)}async fetchOpenOrders(e,t,s,i={}){let a;await this.loadMarkets();const n={};if(void 0!==e)a=this.market(e),n.symbol=a.id;else if(this.options.warnOnFetchOpenOrdersWithoutSymbol){const e=this.symbols.length,t=parseInt(e/2);throw new r(this.id+" fetchOpenOrders() WARNING: fetching open orders without specifying a symbol is rate-limited to one call per "+t.toString()+" seconds. Do not call this method frequently to avoid ban. Set "+this.id+'.options["warnOnFetchOpenOrdersWithoutSymbol"] = false to suppress this warning message.')}const o=await this.privateGetOpenOrders(this.extend(n,i));return this.parseOrders(o,a,t,s)}async cancelOrder(e,t,s={}){if(void 0===t)throw new a(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r=this.safeValue(s,"origClientOrderId"),n={symbol:i.id};void 0===r?n.orderId=e:n.origClientOrderId=r;const o=await this.privateDeleteOrder(this.extend(n,s));return this.parseOrder(o,i)}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const r=this.market(e),n={symbol:r.id};void 0!==s&&(n.limit=s);const o=await this.privateGetMyTrades(this.extend(n,i));return this.parseTrades(o,r,t,s)}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t]+"/"+this.version+"/"+e;if("historicalTrades"===e&&(r={"X-MBX-APIKEY":this.apiKey}),"private"===t){this.checkRequiredCredentials();let e=this.urlencode(this.extend({timestamp:this.nonce(),recvWindow:this.options.recvWindow},i));e+="&signature="+this.hmac(this.encode(e),this.encode(this.secret)),r={"X-MBX-APIKEY":this.apiKey},"GET"===s||"DELETE"===s?n+="?"+e:(a=e,r["Content-Type"]="application/x-www-form-urlencoded")}else Object.keys(i).length&&(n+="?"+this.urlencode(i));return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,u){if(418===e||429===e)throw new h(this.id+" "+e.toString()+" "+t+" "+n);if(e>=400){if(n.indexOf("Price * QTY is zero or less")>=0)throw new d(this.id+" order cost = amount * price is zero or less "+n);if(n.indexOf("LOT_SIZE")>=0)throw new d(this.id+" order amount should be evenly divisible by lot size "+n);if(n.indexOf("PRICE_FILTER")>=0)throw new d(this.id+" order price is invalid, i.e. exceeds allowed price precision, exceeds min price or max price limits or is invalid float value in general, use this.priceToPrecision (symbol, amount) "+n)}if(void 0===o)return;const l=this.safeString(o,"code");if(void 0!==l&&"0"!==l){const e=this.id+" "+this.json(o);this.throwExactlyMatchedException(this.exceptions.exact,l,e);const t=this.safeString(o,"msg");throw this.throwBroadlyMatchedException(this.exceptions.broad,t,e),new r(e)}}}},4237:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,InsufficientFunds:a,BadRequest:n,BadSymbol:o,InvalidOrder:c,AuthenticationError:d,ArgumentsRequired:h,OrderNotFound:u,ExchangeNotAvailable:l}=s(3449),{TICK_SIZE:f}=s(2115),p=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"delta",name:"Delta Exchange",countries:["VC"],rateLimit:300,version:"v2",has:{cancelAllOrders:!0,cancelOrder:!0,createOrder:!0,editOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchDepositAddress:!0,fetchCurrencies:!0,fetchLedger:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrderBook:!0,fetchStatus:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0},timeframes:{"1m":"1m","3m":"3m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","2h":"2h","4h":"4h","6h":"6h","1d":"1d","7d":"7d","1w":"1w","2w":"2w","1M":"30d"},urls:{logo:"https://user-images.githubusercontent.com/1294454/99450025-3be60a00-2931-11eb-9302-f4fd8d8589aa.jpg",test:{public:"https://testnet-api.delta.exchange",private:"https://testnet-api.delta.exchange"},api:{public:"https://api.delta.exchange",private:"https://api.delta.exchange"},www:"https://www.delta.exchange",doc:["https://docs.delta.exchange"],fees:"https://www.delta.exchange/fees",referral:"https://www.delta.exchange/app/signup/?code=IULYNB"},api:{public:{get:["assets","settings","indices","products","tickers","tickers/{symbol}","l2orderbook/{symbol}","trades/{symbol}","history/candles","history/sparklines"]},private:{get:["orders","orders/leverage","positions","positions/margined","orders/history","fills","fills/history/download/csv","wallet/balances","wallet/transactions","wallet/transactions/download","deposits/address"],post:["orders","orders/batch","orders/leverage","positions/change_margin"],put:["orders","orders/batch"],delete:["orders","orders/all","orders/batch"]}},fees:{trading:{tierBased:!0,percentage:!0,taker:.0015,maker:.001,tiers:{taker:[[0,.0015],[100,.0013],[250,.0013],[1e3,.001],[5e3,9e-4],[1e4,75e-5],[2e4,65e-5]],maker:[[0,.001],[100,.001],[250,9e-4],[1e3,75e-5],[5e3,6e-4],[1e4,5e-4],[2e4,5e-4]]}}},precisionMode:f,requiredCredentials:{apiKey:!0,secret:!1},exceptions:{exact:{insufficient_margin:a,order_size_exceed_available:c,risk_limits_breached:n,invalid_contract:o,immediate_liquidation:c,out_of_bankruptcy:c,self_matching_disrupted_post_only:c,immediate_execution_post_only:c,bad_schema:n,invalid_api_key:d,invalid_signature:d,open_order_not_found:u,unavailable:l},broad:{}}})}async fetchTime(e={}){const t=await this.publicGetSettings(e),s=this.safeValue(t,"result",{});return this.safeIntegerProduct(s,"server_time",.001)}async fetchStatus(e={}){const t=await this.publicGetSettings(e),s=this.safeValue(t,"result",{}),i="true"===this.safeValue(s,"under_maintenance")?"maintenance":"ok",r=this.safeIntegerProduct(s,"server_time",.001);return this.status=this.extend(this.status,{status:i,updated:r}),this.status}async fetchCurrencies(e={}){const t=await this.publicGetAssets(e),s=this.safeValue(t,"result",[]),i={};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"symbol"),a=this.safeInteger(t,"id"),n=this.safeCurrencyCode(r),o=this.safeString(t,"deposit_status"),c="enabled"===this.safeString(t,"withdrawal_status"),d="enabled"===o&&c,h=this.safeInteger(t,"precision");i[n]={id:r,numericId:a,code:n,name:this.safeString(t,"name"),info:t,active:d,fee:this.safeNumber(t,"base_withdrawal_fee"),precision:1/Math.pow(10,h),limits:{amount:{min:void 0,max:void 0},withdraw:{min:this.safeNumber(t,"min_withdrawal_amount"),max:void 0}}}}return i}async loadMarkets(e=!1,t={}){const s=await super.loadMarkets(e,t);(void 0===this.safeValue(this.options,"currenciesByNumericId")||e)&&(this.options.currenciesByNumericId=this.indexBy(this.currencies,"numericId"));return(void 0===this.safeValue(this.options,"marketsByNumericId")||e)&&(this.options.marketsByNumericId=this.indexBy(this.markets,"numericId")),s}async fetchMarkets(e={}){const t=await this.publicGetProducts(e),s=this.safeValue(t,"result",[]),i=[];for(let e=0;e<s.length;e++){const t=s[e];let r=this.safeString(t,"contract_type");const a=this.safeValue(t,"quoting_asset",{}),n=this.safeValue(t,"underlying_asset",{}),o=this.safeString(n,"symbol"),c=this.safeString(a,"symbol"),d=this.safeString(t,"symbol"),h=this.safeInteger(t,"id"),u=this.safeCurrencyCode(o),l=this.safeCurrencyCode(c);let f=d,p=!1,m=!1,b=!1;"perpetual_futures"===r?(r="swap",p=!0,m=!1,b=!1,d.indexOf("_")<0&&(f=u+"/"+l)):"call_options"===r||"put_options"===r||"move_options"===r?(r="option",p=!1,b=!0,m=!1):"futures"===r&&(r="future",p=!1,b=!1,m=!0);const g={amount:1,price:this.safeNumber(t,"tick_size")},y={amount:{min:1,max:this.safeNumber(t,"position_size_limit")},price:{min:g.price,max:void 0},cost:{min:this.safeNumber(t,"min_size"),max:void 0}},v="live"===this.safeString(t,"state"),w=this.safeNumber(t,"maker_commission_rate"),k=this.safeNumber(t,"taker_commission_rate");i.push({id:d,numericId:h,symbol:f,base:u,quote:l,baseId:o,quoteId:c,type:r,option:b,swap:p,future:m,maker:w,taker:k,precision:g,limits:y,info:t,active:v})}return i}parseTicker(e,t){const s=this.safeIntegerProduct(e,"timestamp",.001),i=this.safeString(e,"symbol"),r=this.safeSymbol(i,t),a=this.safeNumber(e,"close"),n=this.safeNumber(e,"open");let o,c,d;void 0!==n&&void 0!==a&&(o=a-n,c=this.sum(a,n)/2,0!==n&&(d=o/n*100));const h=this.safeNumber(e,"volume"),u=this.safeNumber(e,"turnover"),l=this.vwap(h,u);return{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:void 0,bidVolume:void 0,ask:void 0,askVolume:void 0,vwap:l,open:n,close:a,last:a,previousClose:void 0,change:o,percentage:d,average:c,baseVolume:h,quoteVolume:u,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.publicGetTickersSymbol(this.extend(i,t)),a=this.safeValue(r,"result",{});return this.parseTicker(a,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTickers(t),i=this.safeValue(s,"result",[]),r={};for(let e=0;e<i.length;e++){const t=this.parseTicker(i[e]);r[t.symbol]=t}return this.filterByArray(r,"symbol",e)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.marketId(e)};void 0!==t&&(i.depth=t);const r=await this.publicGetL2orderbookSymbol(this.extend(i,s)),a=this.safeValue(r,"result",{});return this.parseOrderBook(a,e,void 0,"buy","sell","price","size")}parseTrade(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"order_id");let r=this.parse8601(this.safeString(e,"created_at"));r=this.safeIntegerProduct(e,"timestamp",.001,r);const a=this.safeString(e,"price"),n=this.safeString(e,"size"),o=this.parseNumber(a),c=this.parseNumber(n),d=this.parseNumber(p.stringMul(a,n)),h=this.safeValue(e,"product",{}),u=this.safeString(h,"symbol"),l=this.safeSymbol(u,t),f=this.safeString(e,"seller_role");let m=this.safeString(e,"side");void 0===m&&("taker"===f?m="sell":"maker"===f&&(m="buy"));const b=this.safeString(e,"role"),g=this.safeValue(e,"meta_data",{});let y=this.safeString(g,"order_type");void 0!==y&&(y=y.replace("_order",""));const v=this.safeNumber(e,"commission");let w;if(void 0!==v){const e=this.safeValue(h,"settling_asset",{}),t=this.safeString(e,"symbol");w={cost:v,currency:this.safeCurrencyCode(t)}}return{id:s,order:i,timestamp:r,datetime:this.iso8601(r),symbol:l,type:y,side:m,price:o,amount:c,cost:d,takerOrMaker:b,fee:w,info:e}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id},n=await this.publicGetTradesSymbol(this.extend(a,i)),o=this.safeValue(n,"result",[]);return this.parseTrades(o,r,t,s)}parseOHLCV(e,t){return[this.safeTimestamp(e,"time"),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={symbol:a.id,resolution:this.timeframes[t]},o=this.parseTimeframe(t);if(i=i||2e3,void 0===s){const e=this.seconds();n.end=e,n.start=e-i*o}else{const e=parseInt(s/1e3);n.start=e,n.end=this.sum(e,i*o)}const c=await this.publicGetHistoryCandles(this.extend(n,r)),d=this.safeValue(c,"result",[]);return this.parseOHLCVs(d,a,t,s,i)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetWalletBalances(e),s=this.safeValue(t,"result",[]),i={info:t},r=this.safeValue(this.options,"currenciesByNumericId",{});for(let e=0;e<s.length;e++){const t=s[e],a=this.safeString(t,"asset_id"),n=this.safeValue(r,a),o=void 0===n?a:n.code,c=this.account();c.total=this.safeString(t,"balance"),c.free=this.safeString(t,"available_balance"),i[o]=c}return this.parseBalance(i,!1)}async fetchPosition(e,t){await this.loadMarkets();const s={product_id:this.market(e).numericId},i=await this.privateGetPositions(this.extend(s,t));return this.safeValue(i,"result",{})}async fetchPositions(e,t={}){await this.loadMarkets();const s=await this.privateGetPositionsMargined(t);return this.safeValue(s,"result",[])}parseOrderStatus(e){return this.safeString({open:"open",pending:"open",closed:"closed",cancelled:"canceled"},e,e)}parseOrder(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"client_order_id"),r=this.parse8601(this.safeString(e,"created_at")),a=this.safeString(e,"product_id"),n=this.safeValue(this.options,"marketsByNumericId",{}),o=void 0===(t=this.safeValue(n,a,t))?a:t.symbol,c=this.parseOrderStatus(this.safeString(e,"state")),d=this.safeString(e,"side");let h=this.safeString(e,"order_type");h=h.replace("_order","");const u=this.safeNumber(e,"limit_price"),l=this.safeNumber(e,"size"),f=this.safeNumber(e,"unfilled_size"),p=this.safeNumber(e,"average_fill_price");let m;const b=this.safeNumber(e,"paid_commission");if(void 0!==b){let e;if(void 0!==t){const s=this.safeValue(t.info,"settling_asset",{}),i=this.safeString(s,"symbol");e=this.safeCurrencyCode(i)}m={cost:b,currency:e}}return this.safeOrder({info:e,id:s,clientOrderId:i,timestamp:r,datetime:this.iso8601(r),lastTradeTimestamp:void 0,symbol:o,type:h,side:d,price:u,amount:l,cost:void 0,average:p,filled:void 0,remaining:f,status:c,fee:m,trades:void 0})}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=t+"_order",o=this.market(e),c={product_id:o.numericId,size:this.amountToPrecision(e,i),side:s,order_type:n};"limit"===t&&(c.limit_price=this.priceToPrecision(e,r));const d=this.safeString2(a,"clientOrderId","client_order_id");a=this.omit(a,["clientOrderId","client_order_id"]),void 0!==d&&(c.client_order_id=d);const h=await this.privatePostOrders(this.extend(c,a)),u=this.safeValue(h,"result",{});return this.parseOrder(u,o)}async editOrder(e,t,s,i,r,a,n={}){await this.loadMarkets();const o=this.market(t),c={id:parseInt(e),product_id:o.numericId};void 0!==r&&(c.size=parseInt(this.amountToPrecision(t,r))),void 0!==a&&(c.limit_price=this.priceToPrecision(t,a));const d=await this.privatePutOrders(this.extend(c,n)),h=this.safeValue(d,"result");return this.parseOrder(h,o)}async cancelOrder(e,t,s={}){if(void 0===t)throw new h(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={id:parseInt(e),product_id:i.numericId},a=await this.privateDeleteOrders(this.extend(r,s)),n=this.safeValue(a,"result");return this.parseOrder(n,i)}async cancelAllOrders(e,t={}){if(void 0===e)throw new h(this.id+" cancelAllOrders() requires a symbol argument");await this.loadMarkets();const s={product_id:this.market(e).numericId};return this.privateDeleteOrdersAll(this.extend(s,t))}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrdersWithMethod("privateGetOrders",e,t,s,i)}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrdersWithMethod("privateGetOrdersHistory",e,t,s,i)}async fetchOrdersWithMethod(e,t,s,i,r={}){await this.loadMarkets();const a={};let n;void 0!==t&&(n=this.market(t),a.product_ids=n.numericId),void 0!==s&&(a.start_time=s.toString()+"000"),void 0!==i&&(a.page_size=i);const o=await this[e](this.extend(a,r)),c=this.safeValue(o,"result",[]);return this.parseOrders(c,n,s,i)}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.market(e),r.product_ids=a.numericId),void 0!==t&&(r.start_time=t.toString()+"000"),void 0!==s&&(r.page_size=s);const n=await this.privateGetFills(this.extend(r,i)),o=this.safeValue(n,"result",[]);return this.parseTrades(o,a,t,s)}async fetchLedger(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.asset_id=a.numericId),void 0!==s&&(r.page_size=s);const n=await this.privateGetWalletTransactions(this.extend(r,i)),o=this.safeValue(n,"result",[]);return this.parseLedger(o,a,t,s)}parseLedgerEntryType(e){return this.safeString({pnl:"pnl",deposit:"transaction",withdrawal:"transaction",commission:"fee",conversion:"trade",referral_bonus:"referral",commission_rebate:"rebate"},e,e)}parseLedgerEntry(e,t){const s=this.safeString(e,"uuid");let i;const r=this.safeValue(e,"meta_data",{}),a=this.safeString(r,"transaction_id");let n=this.safeString(e,"transaction_type");"deposit"===n||"commission_rebate"===n||"referral_bonus"===n||"pnl"===n||"withdrawal_cancellation"===n||"promo_credit"===n?i="in":"withdrawal"!==n&&"commission"!==n&&"conversion"!==n&&"perpetual_futures_funding"!==n||(i="out"),n=this.parseLedgerEntryType(n);const o=this.safeInteger(e,"asset_id"),c=this.safeValue(this.options,"currenciesByNumericId"),d=void 0===(t=this.safeValue(c,o,t))?void 0:t.code,h=this.safeNumber(e,"amount"),u=this.parse8601(this.safeString(e,"created_at")),l=this.safeNumber(e,"balance");return{info:e,id:s,direction:i,account:undefined,referenceId:a,referenceAccount:undefined,type:n,currency:d,amount:h,before:Math.max(0,l-h),after:l,status:"ok",timestamp:u,datetime:this.iso8601(u),fee:void 0}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={asset_symbol:this.currency(e).id},i=await this.privateGetDepositsAddress(this.extend(s,t)),r=this.safeValue(i,"result",{}),a=this.safeString(r,"address");return this.checkAddress(a),{currency:e,address:a,tag:void 0,info:i}}sign(e,t="public",s="GET",i={},r,a){const n="/"+this.version+"/"+this.implodeParams(e,i);let o=this.urls.api[t]+n;const c=this.omit(i,this.extractParams(e));if("public"===t)Object.keys(c).length&&(o+="?"+this.urlencode(c));else if("private"===t){this.checkRequiredCredentials();const e=this.seconds().toString();r={"api-key":this.apiKey,timestamp:e};let t=s+e+n;if("GET"===s||"DELETE"===s){if(Object.keys(c).length){const e="?"+this.urlencode(c);t+=e,o+=e}}else t+=a=this.json(c),r["Content-Type"]="application/json";const i=this.hmac(this.encode(t),this.encode(this.secret));r.signature=i}return{url:o,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0===o)return;const h=this.safeValue(o,"error",{}),u=this.safeString(h,"code");if(void 0!==u){const e=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,u,e),this.throwBroadlyMatchedException(this.exceptions.broad,u,e),new r(e)}}}},1680:(e,t,s)=>{"use strict";const i=s(8819),{TICK_SIZE:r}=s(2115),{AuthenticationError:a,ExchangeError:n,ArgumentsRequired:o,PermissionDenied:c,InvalidOrder:d,OrderNotFound:h,DDoSProtection:u,NotSupported:l,ExchangeNotAvailable:f,InsufficientFunds:p,BadRequest:m,InvalidAddress:b,OnMaintenance:g}=s(3449),y=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"deribit",name:"Deribit",countries:["NL"],version:"v2",userAgent:void 0,rateLimit:500,has:{cancelAllOrders:!0,cancelOrder:!0,CORS:!0,createDepositAddress:!0,createOrder:!0,editOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!1,fetchOrderTrades:!0,fetchStatus:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTransactions:!1,fetchWithdrawals:!0,withdraw:!0},timeframes:{"1m":"1","3m":"3","5m":"5","10m":"10","15m":"15","30m":"30","1h":"60","2h":"120","3h":"180","6h":"360","12h":"720","1d":"1D"},urls:{test:"https://test.deribit.com",logo:"https://user-images.githubusercontent.com/1294454/41933112-9e2dd65a-798b-11e8-8440-5bab2959fcb8.jpg",api:"https://www.deribit.com",www:"https://www.deribit.com",doc:["https://docs.deribit.com/v2","https://github.com/deribit"],fees:"https://www.deribit.com/pages/information/fees",referral:"https://www.deribit.com/reg-1189.4038"},api:{public:{get:["auth","exchange_token","fork_token","set_heartbeat","disable_heartbeat","get_time","hello","test","subscribe","unsubscribe","get_announcements","get_book_summary_by_currency","get_book_summary_by_instrument","get_contract_size","get_currencies","get_funding_chart_data","get_funding_rate_history","get_funding_rate_value","get_historical_volatility","get_index","get_index_price","get_index_price_names","get_instruments","get_last_settlements_by_currency","get_last_settlements_by_instrument","get_last_trades_by_currency","get_last_trades_by_currency_and_time","get_last_trades_by_instrument","get_last_trades_by_instrument_and_time","get_order_book","get_trade_volumes","get_tradingview_chart_data","ticker"]},private:{get:["logout","enable_cancel_on_disconnect","disable_cancel_on_disconnect","get_cancel_on_disconnect","subscribe","unsubscribe","change_api_key_name","change_scope_in_api_key","change_subaccount_name","create_api_key","create_subaccount","disable_api_key","disable_tfa_for_subaccount","enable_api_key","get_account_summary","get_email_language","get_new_announcements","get_position","get_positions","get_subaccounts","list_api_keys","remove_api_key","reset_api_key","set_announcement_as_read","set_api_key_as_default","set_email_for_subaccount","set_email_language","set_password_for_subaccount","toggle_notifications_from_subaccount","toggle_subaccount_login","execute_block_trade","get_block_trade","get_last_block_trades_by_currency","invalidate_block_trade_signature","verify_block_trade","buy","sell","edit","cancel","cancel_all","cancel_all_by_currency","cancel_all_by_instrument","cancel_by_label","close_position","get_margins","get_open_orders_by_currency","get_open_orders_by_instrument","get_order_history_by_currency","get_order_history_by_instrument","get_order_margin_by_ids","get_order_state","get_stop_order_history","get_user_trades_by_currency","get_user_trades_by_currency_and_time","get_user_trades_by_instrument","get_user_trades_by_instrument_and_time","get_user_trades_by_order","get_settlement_history_by_instrument","get_settlement_history_by_currency","cancel_transfer_by_id","cancel_withdrawal","create_deposit_address","get_current_deposit_address","get_deposits","get_transfers","get_withdrawals","submit_transfer_to_subaccount","submit_transfer_to_user","withdraw"]}},exceptions:{9999:c,1e4:a,10001:n,10002:d,10003:d,10004:h,10005:d,10006:d,10007:d,10008:d,10009:p,10010:h,10011:d,10012:d,10013:c,10014:c,10015:c,10016:c,10017:c,10018:c,10019:c,10020:n,10021:d,10022:d,10023:d,10024:d,10025:d,10026:d,10027:d,10028:u,10029:h,10030:n,10031:n,10032:d,10033:l,10034:d,10035:d,10036:d,10040:f,10041:g,10043:d,10044:d,10045:d,10046:d,10047:u,10048:n,11008:d,11029:m,11030:n,11031:n,11035:u,11036:d,11037:m,11038:d,11039:d,11041:d,11042:c,11043:m,11044:d,11045:m,11046:m,11047:m,11048:n,11049:m,11050:m,11051:g,11052:n,11053:n,11090:b,11091:b,11092:b,11093:u,11094:n,11095:n,11096:n,12e3:a,12001:u,12002:n,12998:a,12003:a,12004:a,12005:a,12100:n,12999:a,13e3:a,13001:a,13002:c,13003:a,13004:a,13005:a,13006:a,13007:a,13008:n,13009:a,13010:m,13011:m,13012:c,13013:m,13014:m,13015:m,13016:m,13017:n,13018:n,13019:n,13020:n,13021:c,13025:n,"-32602":m,"-32601":m,"-32700":m,"-32000":m},precisionMode:r,options:{code:"BTC",fetchBalance:{code:"BTC"}}})}async fetchTime(e={}){const t=await this.publicGetGetTime(e);return this.safeInteger(t,"result")}codeFromOptions(e){const t=this.safeValue(this.options,"code","BTC"),s=this.safeValue(this.options,e,{});return this.safeValue(s,"code",t)}async fetchStatus(e={}){return await this.publicGetTest(this.extend({},e)),this.status=this.extend(this.status,{status:"ok",updated:this.milliseconds()}),this.status}async fetchMarkets(e={}){const t=await this.publicGetGetCurrencies(e),s=this.safeValue(t,"result",[]),i=[];for(let t=0;t<s.length;t++){const r={currency:this.safeString(s[t],"currency")},a=await this.publicGetGetInstruments(this.extend(r,e)),n=this.safeValue(a,"result",[]);for(let e=0;e<n.length;e++){const t=n[e],s=this.safeString(t,"instrument_name"),r=this.safeString(t,"base_currency"),a=this.safeString(t,"quote_currency"),o=this.safeCurrencyCode(r),c=this.safeCurrencyCode(a),d=this.safeString(t,"kind"),h="future"===d,u="option"===d,l=this.safeValue(t,"is_active"),f=this.safeNumber(t,"min_trade_amount"),p=this.safeNumber(t,"tick_size"),m={amount:f,price:p};i.push({id:s,symbol:s,base:o,quote:c,active:l,precision:m,taker:this.safeNumber(t,"taker_commission"),maker:this.safeNumber(t,"maker_commission"),limits:{amount:{min:f,max:void 0},price:{min:p,max:void 0},cost:{min:void 0,max:void 0}},type:d,spot:!1,future:h,option:u,info:t})}}return i}async fetchBalance(e={}){await this.loadMarkets();const t=this.codeFromOptions("fetchBalance"),s={currency:this.currency(t).id},i=await this.privateGetGetAccountSummary(this.extend(s,e)),r={info:i},a=this.safeValue(i,"result",{}),n=this.safeString(a,"currency"),o=this.safeCurrencyCode(n),c=this.account();return c.free=this.safeString(a,"availableFunds"),c.used=this.safeString(a,"maintenanceMargin"),c.total=this.safeString(a,"equity"),r[o]=c,this.parseBalance(r,!1)}async createDepositAddress(e,t={}){await this.loadMarkets();const s={currency:this.currency(e).id},i=await this.privateGetCreateDepositAddress(this.extend(s,t)),r=this.safeValue(i,"result",{}),a=this.safeString(r,"address");return this.checkAddress(a),{currency:e,address:a,tag:void 0,info:i}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={currency:this.currency(e).id},i=await this.privateGetGetCurrentDepositAddress(this.extend(s,t)),r=this.safeValue(i,"result",{}),a=this.safeString(r,"address");return this.checkAddress(a),{currency:e,address:a,tag:void 0,info:i}}parseTicker(e,t){const s=this.safeInteger2(e,"timestamp","creation_timestamp"),i=this.safeString(e,"instrument_name"),r=this.safeSymbol(i,t),a=this.safeNumber2(e,"last_price","last"),n=this.safeValue(e,"stats",e);return{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber2(n,"high","max_price"),low:this.safeNumber2(n,"low","min_price"),bid:this.safeNumber2(e,"best_bid_price","bid_price"),bidVolume:this.safeNumber(e,"best_bid_amount"),ask:this.safeNumber2(e,"best_ask_price","ask_price"),askVolume:this.safeNumber(e,"best_ask_amount"),vwap:void 0,open:void 0,close:a,last:a,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:void 0,quoteVolume:this.safeNumber(n,"volume"),info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={instrument_name:s.id},r=await this.publicGetTicker(this.extend(i,t)),a=this.safeValue(r,"result");return this.parseTicker(a,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s=this.codeFromOptions("fetchTickers"),i={currency:this.currency(s).id},r=await this.publicGetGetBookSummaryByCurrency(this.extend(i,t)),a=this.safeValue(r,"result",[]),n={};for(let e=0;e<a.length;e++){const t=this.parseTicker(a[e]);n[t.symbol]=t}return this.filterByArray(n,"symbol",e)}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={instrument_name:a.id,resolution:this.timeframes[t]},c=this.parseTimeframe(t),d=this.milliseconds();if(void 0===s){if(void 0===i)throw new o(this.id+" fetchOHLCV() requires a since argument or a limit argument");n.start_timestamp=d-(i-1)*c*1e3,n.end_timestamp=d}else n.start_timestamp=s,n.end_timestamp=void 0===i?d:this.sum(s,i*c*1e3);const h=await this.publicGetGetTradingviewChartData(this.extend(n,r)),u=this.safeValue(h,"result",{}),l=this.convertTradingViewToOHLCV(u,"ticks","open","high","low","close","volume",!0);return this.parseOHLCVs(l,a,t,s,i)}parseTrade(e,t){const s=this.safeString(e,"trade_id"),i=this.safeString(e,"instrument_name"),r=this.safeSymbol(i,t),a=this.safeInteger(e,"timestamp"),n=this.safeString(e,"direction"),o=this.safeString(e,"price"),c=this.safeString(e,"amount"),d=this.parseNumber(o),h=this.parseNumber(c),u=this.parseNumber(y.stringMul(o,c)),l=this.safeString(e,"liquidity");let f;void 0!==l&&(f="M"===l?"maker":"taker");const p=this.safeNumber(e,"fee");let m;if(void 0!==p){const t=this.safeString(e,"fee_currency");m={cost:p,currency:this.safeCurrencyCode(t)}}return{id:s,info:e,timestamp:a,datetime:this.iso8601(a),symbol:r,order:this.safeString(e,"order_id"),type:this.safeString(e,"order_type"),side:n,takerOrMaker:f,price:d,amount:h,cost:u,fee:m}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={instrument_name:r.id,include_old:!0},n=void 0===t?"publicGetGetLastTradesByInstrument":"publicGetGetLastTradesByInstrumentAndTime";void 0!==t&&(a.start_timestamp=t),void 0!==s&&(a.count=s);const o=await this[n](this.extend(a,i)),c=this.safeValue(o,"result",{}),d=this.safeValue(c,"trades",[]);return this.parseTrades(d,r,t,s)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={instrument_name:this.market(e).id};void 0!==t&&(i.depth=t);const r=await this.publicGetGetOrderBook(this.extend(i,s)),a=this.safeValue(r,"result",{}),n=this.safeInteger(a,"timestamp"),o=this.safeInteger(a,"change_id"),c=this.parseOrderBook(a,e,n);return c.nonce=o,c}parseOrderStatus(e){return this.safeString({open:"open",cancelled:"canceled",filled:"closed",rejected:"rejected",untriggered:"open"},e,e)}parseTimeInForce(e){return this.safeString({good_til_cancelled:"GTC",fill_or_kill:"FOK",immediate_or_cancel:"IOC"},e,e)}parseOrder(e,t){const s=this.safeInteger(e,"creation_timestamp"),i=this.safeInteger(e,"last_update_timestamp"),r=this.safeString(e,"order_id"),a=this.safeNumber(e,"price"),n=this.safeNumber(e,"average_price"),o=this.safeNumber(e,"amount"),c=this.safeNumber(e,"filled_amount");let d;void 0!==c&&c>0&&(d=i);const h=this.parseOrderStatus(this.safeString(e,"order_state")),u=this.safeString(e,"instrument_name");t=this.safeMarket(u,t);const l=this.safeStringLower(e,"direction");let f,p=this.safeNumber(e,"commission");void 0!==p&&(p=Math.abs(p),f={cost:p,currency:t.base});const m=this.safeString(e,"order_type");let b=this.safeValue(e,"trades");void 0!==b&&(b=this.parseTrades(b,t));const g=this.parseTimeInForce(this.safeString(e,"time_in_force")),y=this.safeValue(e,"stop_price"),v=this.safeValue(e,"post_only");return this.safeOrder({info:e,id:r,clientOrderId:void 0,timestamp:s,datetime:this.iso8601(s),lastTradeTimestamp:d,symbol:t.symbol,type:m,timeInForce:g,postOnly:v,side:l,price:a,stopPrice:y,amount:o,cost:void 0,average:n,filled:c,remaining:void 0,status:h,fee:f,trades:b})}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={order_id:e},r=await this.privateGetGetOrderState(this.extend(i,s)),a=this.safeValue(r,"result");return this.parseOrder(a)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),c={instrument_name:n.id,amount:this.amountToPrecision(e,i),type:t};let d=!1,h=!1;if("limit"===t?d=!0:"stop_limit"===t&&(d=!0,h=!0),d){if(void 0===r)throw new o(this.id+" createOrder() requires a price argument for a "+t+" order");c.price=this.priceToPrecision(e,r)}if(h){const s=this.safeNumber2(a,"stop_price","stopPrice");if(void 0===s)throw new o(this.id+" createOrder() requires a stop_price or stopPrice param for a "+t+" order");c.stop_price=this.priceToPrecision(e,s),a=this.omit(a,["stop_price","stopPrice"])}const u="privateGet"+this.capitalize(s),l=await this[u](this.extend(c,a)),f=this.safeValue(l,"result",{}),p=this.safeValue(f,"order"),m=this.safeValue(f,"trades",[]);return p.trades=m,this.parseOrder(p,n)}async editOrder(e,t,s,i,r,a,n={}){if(void 0===r)throw new o(this.id+" editOrder() requires an amount argument");if(void 0===a)throw new o(this.id+" editOrder() requires a price argument");await this.loadMarkets();const c={order_id:e,amount:this.amountToPrecision(t,r),price:this.priceToPrecision(t,a)},d=await this.privateGetEdit(this.extend(c,n)),h=this.safeValue(d,"result",{}),u=this.safeValue(h,"order"),l=this.safeValue(h,"trades",[]);return u.trades=l,this.parseOrder(u)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={order_id:e},r=await this.privateGetCancel(this.extend(i,s)),a=this.safeValue(r,"result",{});return this.parseOrder(a)}async cancelAllOrders(e,t={}){await this.loadMarkets();const s={};let i;if(void 0===e)i="privateGetCancelAll";else{i="privateGetCancelAllByInstrument";const t=this.market(e);s.instrument_name=t.id}return await this[i](this.extend(s,t))}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a,n;if(void 0===e){const e=this.codeFromOptions("fetchOpenOrders"),t=this.currency(e);r.currency=t.id,n="privateGetGetOpenOrdersByCurrency"}else a=this.market(e),r.instrument_name=a.id,n="privateGetGetOpenOrdersByInstrument";const o=await this[n](this.extend(r,i)),c=this.safeValue(o,"result",[]);return this.parseOrders(c,a,t,s)}async fetchClosedOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a,n;if(void 0===e){const e=this.codeFromOptions("fetchClosedOrders"),t=this.currency(e);r.currency=t.id,n="privateGetGetOrderHistoryByCurrency"}else a=this.market(e),r.instrument_name=a.id,n="privateGetGetOrderHistoryByInstrument";const o=await this[n](this.extend(r,i)),c=this.safeValue(o,"result",[]);return this.parseOrders(c,a,t,s)}async fetchOrderTrades(e,t,s,i,r={}){await this.loadMarkets();const a={order_id:e},n=await this.privateGetGetUserTradesByOrder(this.extend(a,r)),o=this.safeValue(n,"result",{}),c=this.safeValue(o,"trades",[]);return this.parseTrades(c,void 0,s,i)}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={include_old:!0};let a,n;if(void 0===e){const e=this.codeFromOptions("fetchMyTrades"),s=this.currency(e);r.currency=s.id,void 0===t?n="privateGetGetUserTradesByCurrency":(n="privateGetGetUserTradesByCurrencyAndTime",r.start_timestamp=t)}else a=this.market(e),r.instrument_name=a.id,void 0===t?n="privateGetGetUserTradesByInstrument":(n="privateGetGetUserTradesByInstrumentAndTime",r.start_timestamp=t);void 0!==s&&(r.count=s);const o=await this[n](this.extend(r,i)),c=this.safeValue(o,"result",{}),d=this.safeValue(c,"trades",[]);return this.parseTrades(d,a,t,s)}async fetchDeposits(e,t,s,i={}){if(void 0===e)throw new o(this.id+" fetchDeposits() requires a currency code argument");await this.loadMarkets();const r=this.currency(e),a={currency:r.id};void 0!==s&&(a.count=s);const n=await this.privateGetGetDeposits(this.extend(a,i)),c=this.safeValue(n,"result",{}),d=this.safeValue(c,"data",[]);return this.parseTransactions(d,r,t,s,i)}async fetchWithdrawals(e,t,s,i={}){if(void 0===e)throw new o(this.id+" fetchWithdrawals() requires a currency code argument");await this.loadMarkets();const r=this.currency(e),a={currency:r.id};void 0!==s&&(a.count=s);const n=await this.privateGetGetWithdrawals(this.extend(a,i)),c=this.safeValue(n,"result",{}),d=this.safeValue(c,"data",[]);return this.parseTransactions(d,r,t,s,i)}parseTransactionStatus(e){return this.safeString({completed:"ok",unconfirmed:"pending"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"currency"),i=this.safeCurrencyCode(s,t),r=this.safeInteger2(e,"created_timestamp","received_timestamp"),a=this.safeInteger(e,"updated_timestamp"),n=this.parseTransactionStatus(this.safeString(e,"state")),o=this.safeString(e,"address"),c=this.safeNumber(e,"fee");let d,h="deposit";return void 0!==c&&(h="withdrawal",d={cost:c,currency:i}),{info:e,id:this.safeString(e,"id"),txid:this.safeString(e,"transaction_id"),timestamp:r,datetime:this.iso8601(r),address:o,addressTo:o,addressFrom:void 0,tag:void 0,tagTo:void 0,tagFrom:void 0,type:h,amount:this.safeNumber(e,"amount"),currency:i,status:n,updated:a,fee:d}}async fetchPosition(e,t={}){await this.loadMarkets();const s={instrument_name:this.market(e).id},i=await this.privateGetGetPosition(this.extend(s,t));return this.safeValue(i,"result")}async fetchPositions(e,t={}){await this.loadMarkets();const s=this.codeFromOptions("fetchPositions"),i={currency:this.currency(s).id},r=await this.privateGetGetPositions(this.extend(i,t));return this.safeValue(r,"result",[])}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a={currency:this.currency(e).id,address:s,amount:t};void 0!==this.twofa&&(a.tfa=this.oath());const n=await this.privateGetWithdraw(this.extend(a,r));return{info:n,id:this.safeString(n,"id")}}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n="/api/"+this.version+"/"+t+"/"+e;if("public"===t&&Object.keys(i).length&&(n+="?"+this.urlencode(i)),"private"===t){this.checkRequiredCredentials();const e=this.nonce().toString(),t=this.milliseconds().toString(),a="";Object.keys(i).length&&(n+="?"+this.urlencode(i));const o=t+"\n"+e+"\n"+(s+"\n"+n+"\n"+a+"\n"),c=this.hmac(this.encode(o),this.encode(this.secret),"sha256");r={Authorization:"deri-hmac-sha256 id="+this.apiKey+",ts="+t+",sig="+c+",nonce="+e}}return{url:this.urls.api+n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,a,o,c,d){if(!o)return;const h=this.safeValue(o,"error");if(void 0!==h){const e=this.safeString(h,"code"),t=this.id+" "+a;throw this.throwExactlyMatchedException(this.exceptions,e,t),new n(t)}}}},6755:(e,t,s)=>{"use strict";const i=s(8819),{AccountSuspended:r,BadRequest:a,BadResponse:n,NetworkError:o,DDoSProtection:c,AuthenticationError:d,PermissionDenied:h,ExchangeError:u,InsufficientFunds:l,InvalidOrder:f,InvalidNonce:p,OrderNotFound:m,InvalidAddress:b,RateLimitExceeded:g,BadSymbol:y}=s(3449),v=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"digifinex",name:"DigiFinex",countries:["SG"],version:"v3",rateLimit:900,has:{cancelOrder:!0,cancelOrders:!0,createOrder:!0,fetchBalance:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchLedger:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchStatus:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchWithdrawals:!0,withdraw:!0},timeframes:{"1m":"1","5m":"5","15m":"15","30m":"30","1h":"60","4h":"240","12h":"720","1d":"1D","1w":"1W"},urls:{logo:"https://user-images.githubusercontent.com/51840849/87443315-01283a00-c5fe-11ea-8628-c2a0feaf07ac.jpg",api:"https://openapi.digifinex.com",www:"https://www.digifinex.com",doc:["https://docs.digifinex.com"],fees:"https://digifinex.zendesk.com/hc/en-us/articles/360000328422-Fee-Structure-on-DigiFinex",referral:"https://www.digifinex.com/en-ww/from/DhOzBg?channelCode=ljaUPp"},api:{public:{get:["{market}/symbols","kline","margin/currencies","margin/symbols","markets","order_book","ping","spot/symbols","time","trades","trades/symbols","ticker","currencies"]},private:{get:["{market}/financelog","{market}/mytrades","{market}/order","{market}​/order​/detail","{market}/order/current","{market}/order/history","margin/assets","margin/financelog","margin/mytrades","margin/order","margin/order/current","margin/order/history","margin/positions","otc/financelog","spot/assets","spot/financelog","spot/mytrades","spot/order","spot/order/current","spot/order/history","deposit/address","deposit/history","withdraw/history"],post:["{market}/order/cancel","{market}/order/new","{market}​/order​/batch_new","margin/order/cancel","margin/order/new","margin/position/close","spot/order/cancel","spot/order/new","transfer","withdraw/new","withdraw/cancel"]}},fees:{trading:{tierBased:!1,percentage:!0,maker:.002,taker:.002}},exceptions:{exact:{10001:[a,"Wrong request method, please check it's a GET ot POST request"],10002:[d,"Invalid ApiKey"],10003:[d,"Sign doesn't match"],10004:[a,"Illegal request parameters"],10005:[c,"Request frequency exceeds the limit"],10006:[h,"Unauthorized to execute this request"],10007:[h,"IP address Unauthorized"],10008:[p,"Timestamp for this request is invalid, timestamp must within 1 minute"],10009:[o,"Unexist endpoint, please check endpoint URL"],10011:[r,"ApiKey expired. Please go to client side to re-create an ApiKey"],20001:[h,"Trade is not open for this trading pair"],20002:[h,"Trade of this trading pair is suspended"],20003:[f,"Invalid price or amount"],20007:[f,"Price precision error"],20008:[f,"Amount precision error"],20009:[f,"Amount is less than the minimum requirement"],20010:[f,"Cash Amount is less than the minimum requirement"],20011:[l,"Insufficient balance"],20012:[a,"Invalid trade type, valid value: buy/sell)"],20013:[f,"No order info found"],20014:[a,"Invalid date, Valid format: 2018-07-25)"],20015:[a,"Date exceeds the limit"],20018:[h,"Your trading rights have been banned by the system"],20019:[a,'Wrong trading pair symbol. Correct format:"usdt_btc". Quote asset is in the front'],20020:[c,"You have violated the API operation trading rules and temporarily forbid trading. At present, we have certain restrictions on the user's transaction rate and withdrawal rate."],5e4:[u,"Exception error"],20021:[a,"Invalid currency"],20022:[a,"The ending timestamp must be larger than the starting timestamp"],20023:[a,"Invalid transfer type"],20024:[a,"Invalid amount"],20025:[a,"This currency is not transferable at the moment"],20026:[l,"Transfer amount exceed your balance"],20027:[h,"Abnormal account status"],20028:[h,"Blacklist for transfer"],20029:[h,"Transfer amount exceed your daily limit"],20030:[a,"You have no position on this trading pair"],20032:[h,"Withdrawal limited"],20033:[a,"Wrong Withdrawal ID"],20034:[h,"Withdrawal service of this crypto has been closed"],20035:[h,"Withdrawal limit"],20036:[u,"Withdrawal cancellation failed"],20037:[b,"The withdrawal address, Tag or chain type is not included in the withdrawal management list"],20038:[b,"The withdrawal address is not on the white list"],20039:[u,"Can't be canceled in current status"],20040:[g,"Withdraw too frequently; limitation: 3 times a minute, 100 times a day"],20041:[h,"Beyond the daily withdrawal limit"],20042:[y,"Current trading pair does not support API trading"]},broad:{}},options:{defaultType:"spot",types:["spot","margin","otc"]},commonCurrencies:{BHT:"Black House Test",EPS:"Epanus",MBN:"Mobilian Coin",TEL:"TEL666"}})}async fetchCurrencies(e={}){const t=await this.publicGetCurrencies(e),s=this.safeValue(t,"data",[]),i={};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"currency"),a=this.safeCurrencyCode(r),n=this.safeValue(t,"deposit_status",1),o=this.safeValue(t,"withdraw_status",1),c=n&&o,d=this.safeNumber(t,"withdraw_fee_rate");a in i?Array.isArray(i[a].info)?i[a].info.push(t):i[a].info=[i[a].info,t]:i[a]={id:r,code:a,info:t,type:void 0,name:void 0,active:c,fee:d,precision:8,limits:{amount:{min:void 0,max:void 0},withdraw:{min:this.safeNumber(t,"min_withdraw_amount"),max:void 0}}}}return i}async fetchMarkets(e={}){const t=this.safeValue(this.options,"fetchMarkets",{}),s=this.safeString(t,"method","fetch_markets_v2");return await this[s](e)}async fetchMarketsV2(e={}){const t=await this.publicGetTradesSymbols(e),s=this.safeValue(t,"symbol_list",[]),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"symbol"),a=this.safeString(t,"base_asset"),n=this.safeString(t,"quote_asset"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d=o+"/"+c,h={amount:this.safeInteger(t,"amount_precision"),price:this.safeInteger(t,"price_precision")},u={amount:{min:this.safeNumber(t,"minimum_amount"),max:void 0},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(t,"minimum_value"),max:void 0}},l=!!this.safeInteger(t,"is_allow",1),f="spot",p="spot"===f,m="margin"===f;i.push({id:r,symbol:d,base:o,quote:c,baseId:a,quoteId:n,active:l,type:f,spot:p,margin:m,precision:h,limits:u,info:t})}return i}async fetchMarketsV1(e={}){const t=await this.publicGetMarkets(e),s=this.safeValue(t,"data",[]),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"market"),[a,n]=r.split("_"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d=o+"/"+c,h={amount:this.safeInteger(t,"volume_precision"),price:this.safeInteger(t,"price_precision")},u={amount:{min:this.safeNumber(t,"min_volume"),max:void 0},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(t,"min_amount"),max:void 0}},l=void 0;i.push({id:r,symbol:d,base:o,quote:c,baseId:a,quoteId:n,active:l,precision:h,limits:u,info:t})}return i}async fetchBalance(e={}){const t=this.safeString(this.options,"defaultType","spot"),s=this.safeString(e,"type",t);e=this.omit(e,"type");const i="privateGet"+this.capitalize(s)+"Assets",r=await this[i](e),a=this.safeValue(r,"list",[]),n={info:r};for(let e=0;e<a.length;e++){const t=a[e],s=this.safeString(t,"currency"),i=this.safeCurrencyCode(s),r=this.account();r.used=this.safeString(t,"frozen"),r.free=this.safeString(t,"free"),r.total=this.safeString(t,"total"),n[i]=r}return this.parseBalance(n,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.market(e).id};void 0!==t&&(i.limit=t);const r=await this.publicGetOrderBook(this.extend(i,s)),a=this.safeTimestamp(r,"date");return this.parseOrderBook(r,e,a)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTicker(t),i={},r=this.safeValue(s,"ticker",[]),a=this.safeInteger(s,"date");for(let e=0;e<r.length;e++){const t=this.extend({date:a},r[e]),s=this.parseTicker(t);i[s.symbol]=s}return this.filterByArray(i,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.publicGetTicker(this.extend(i,t)),a=this.safeInteger(r,"date"),n=this.safeValue(r,"ticker",[]),o=this.safeValue(n,0,{}),c=this.extend({date:a},o);return this.parseTicker(c,s)}parseTicker(e,t){const s=this.safeStringUpper(e,"symbol"),i=this.safeSymbol(s,t,"_"),r=this.safeTimestamp(e,"date"),a=this.safeNumber(e,"last"),n=this.safeNumber(e,"change");return{symbol:i,timestamp:r,datetime:this.iso8601(r),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"buy"),bidVolume:void 0,ask:this.safeNumber(e,"sell"),askVolume:void 0,vwap:void 0,open:void 0,close:a,last:a,previousClose:void 0,change:void 0,percentage:n,average:void 0,baseVolume:this.safeNumber(e,"vol"),quoteVolume:this.safeNumber(e,"base_vol"),info:e}}parseTrade(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"order_id"),r=this.safeTimestamp2(e,"date","timestamp"),a=this.safeString2(e,"type","side"),n=this.safeString(e,"price"),o=this.safeString(e,"amount"),c=this.parseNumber(n),d=this.parseNumber(o),h=this.parseNumber(v.stringMul(n,o)),u=this.safeString(e,"symbol"),l=this.safeSymbol(u,t,"_"),f=this.safeValue(e,"is_maker"),p=this.safeNumber(e,"fee");let m;if(void 0!==p){const t=this.safeString(e,"fee_currency");m={cost:p,currency:this.safeCurrencyCode(t)}}return{id:s,info:e,timestamp:r,datetime:this.iso8601(r),symbol:l,type:void 0,order:i,side:a,price:c,amount:d,cost:h,takerOrMaker:f,fee:m}}async fetchTime(e={}){const t=await this.publicGetTime(e);return this.safeTimestamp(t,"server_time")}async fetchStatus(e={}){return await this.publicGetPing(e),this.status=this.extend(this.status,{status:"ok",updated:this.milliseconds()}),this.status}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id};void 0!==s&&(a.limit=s);const n=await this.publicGetTrades(this.extend(a,i)),o=this.safeValue(n,"data",[]);return this.parseTrades(o,r,t,s)}parseOHLCV(e,t){return[this.safeTimestamp(e,0),this.safeNumber(e,5),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,2),this.safeNumber(e,1)]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={symbol:a.id,period:this.timeframes[t]};if(void 0!==s){const e=parseInt(s/1e3);if(n.start_time=e,void 0!==i){const s=this.parseTimeframe(t);n.end_time=this.sum(e,i*s)}}else if(void 0!==i){const e=this.seconds(),s=this.parseTimeframe(t);n.startTime=this.sum(e,-i*s)}const o=await this.publicGetKline(this.extend(n,r)),c=this.safeValue(o,"data",[]);return this.parseOHLCVs(c,a,t,s,i)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o=this.safeString(this.options,"defaultType","spot"),c=this.safeString(a,"type",o);a=this.omit(a,"type");const d={market:c,symbol:n.id,amount:this.amountToPrecision(e,i)};let h="";"market"===t?h="_market":d.price=this.priceToPrecision(e,r),d.type=s+h;const u=await this.privatePostMarketOrderNew(this.extend(d,a)),l=this.parseOrder(u,n);return this.extend(l,{symbol:e,side:s,type:t,amount:i,price:r})}async cancelOrder(e,t,s={}){await this.loadMarkets();const i=this.safeString(this.options,"defaultType","spot"),r=this.safeString(s,"type",i);s=this.omit(s,"type");const a={market:r,order_id:e},n=await this.privatePostMarketOrderCancel(this.extend(a,s));if(1!==this.safeValue(n,"success",[]).length)throw new m(this.id+" cancelOrder "+e+" not found");return n}async cancelOrders(e,t,s={}){await this.loadMarkets();const i=this.safeString(this.options,"defaultType","spot"),r=this.safeString(s,"type",i);s=this.omit(s,"type");const a={market:r,order_id:e.join(",")},n=await this.privatePostCancelOrder(this.extend(a,s));if(this.safeValue(n,"success",[]).length<1)throw new m(this.id+" cancelOrders error");return n}parseOrderStatus(e){return this.safeString({0:"open",1:"open",2:"closed",3:"canceled",4:"canceled"},e,e)}parseOrder(e,t){const s=this.safeString(e,"order_id"),i=this.safeTimestamp(e,"created_date"),r=this.safeTimestamp(e,"finished_date");let a,n=this.safeString(e,"type");if(void 0!==n){const e=n.split("_");e.length>1?(n=e[0],a=e[1]):a="limit"}const o=this.parseOrderStatus(this.safeString(e,"status")),c=this.safeString(e,"symbol"),d=this.safeSymbol(c,t,"_"),h=this.safeNumber(e,"amount"),u=this.safeNumber(e,"executed_amount"),l=this.safeNumber(e,"price"),f=this.safeNumber(e,"avg_price");return this.safeOrder({info:e,id:s,clientOrderId:void 0,timestamp:i,datetime:this.iso8601(i),lastTradeTimestamp:r,symbol:d,type:a,timeInForce:void 0,postOnly:void 0,side:n,price:l,stopPrice:void 0,amount:h,filled:u,remaining:void 0,cost:void 0,average:f,status:o,fee:void 0,trades:void 0})}async fetchOpenOrders(e,t,s,i={}){const r=this.safeString(this.options,"defaultType","spot"),a=this.safeString(i,"type",r);let n;i=this.omit(i,"type"),await this.loadMarkets();const o={market:a};void 0!==e&&(n=this.market(e),o.symbol=n.id);const c=await this.privateGetMarketOrderCurrent(this.extend(o,i)),d=this.safeValue(c,"data",[]);return this.parseOrders(d,n,t,s)}async fetchOrders(e,t,s,i={}){const r=this.safeString(this.options,"defaultType","spot"),a=this.safeString(i,"type",r);let n;i=this.omit(i,"type"),await this.loadMarkets();const o={market:a};void 0!==e&&(n=this.market(e),o.symbol=n.id),void 0!==t&&(o.start_time=parseInt(t/1e3)),void 0!==s&&(o.limit=s);const c=await this.privateGetMarketOrderHistory(this.extend(o,i)),d=this.safeValue(c,"data",[]);return this.parseOrders(d,n,t,s)}async fetchOrder(e,t,s={}){const i=this.safeString(this.options,"defaultType","spot"),r=this.safeString(s,"type",i);let a;s=this.omit(s,"type"),await this.loadMarkets(),void 0!==t&&(a=this.market(t));const n={market:r,order_id:e},o=await this.privateGetMarketOrder(this.extend(n,s)),c=this.safeValue(o,"data",[]),d=this.safeValue(c,0);if(void 0===d)throw new m(this.id+" fetchOrder() order "+e+" not found");return this.parseOrder(d,a)}async fetchMyTrades(e,t,s,i={}){const r=this.safeString(this.options,"defaultType","spot"),a=this.safeString(i,"type",r);let n;i=this.omit(i,"type"),await this.loadMarkets();const o={market:a};void 0!==e&&(n=this.market(e),o.symbol=n.id),void 0!==t&&(o.start_time=parseInt(t/1e3)),void 0!==s&&(o.limit=s);const c=await this.privateGetMarketMytrades(this.extend(o,i)),d=this.safeValue(c,"list",[]);return this.parseTrades(d,n,t,s)}parseLedgerEntryType(e){return this.safeString({},e,e)}parseLedgerEntry(e,t){const s=this.safeString(e,"num"),i=this.parseLedgerEntryType(this.safeString(e,"type")),r=this.safeCurrencyCode(this.safeString(e,"currency_mark"),t),a=this.safeTimestamp(e,"time");return{info:e,id:s,direction:void 0,account:undefined,referenceId:void 0,referenceAccount:void 0,type:i,currency:r,amount:void 0,before:undefined,after:this.safeNumber(e,"balance"),status:"ok",timestamp:a,datetime:this.iso8601(a),fee:void 0}}async fetchLedger(e,t,s,i={}){const r=this.safeString(this.options,"defaultType","spot"),a=this.safeString(i,"type",r);i=this.omit(i,"type"),await this.loadMarkets();const n={market:a};let o;void 0!==e&&(o=this.currency(e),n.currency_mark=o.id),void 0!==t&&(n.start_time=parseInt(t/1e3)),void 0!==s&&(n.limit=s);const c=await this.privateGetMarketFinancelog(this.extend(n,i)),d=this.safeValue(c,"data",{}),h=this.safeValue(d,"finance",[]);return this.parseLedger(h,o,t,s)}parseDepositAddress(e,t){const s=this.safeString(e,"address"),i=this.safeString(e,"addressTag"),r=this.safeStringUpper(e,"currency");return{info:e,code:this.safeCurrencyCode(r),address:s,tag:i}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={currency:this.currency(e).id},i=await this.privateGetDepositAddress(this.extend(s,t)),r=this.safeValue(i,"data",[]),a=this.parseDepositAddresses(r),n=this.safeValue(a,e);if(void 0===n)throw new b(this.id+" fetchDepositAddress did not return an address for "+e+" - create the deposit address in the user settings on the exchange website first.");return n}async fetchTransactionsByType(e,t,s,i,r={}){let a;await this.loadMarkets();const n={};void 0!==t&&(a=this.currency(t),n.currency=a.id),void 0!==i&&(n.size=Math.min(500,i));const o="deposit"===e?"privateGetDepositHistory":"privateGetWithdrawHistory",c=await this[o](this.extend(n,r)),d=this.safeValue(c,"data",[]);return this.parseTransactions(d,a,s,i,{type:e})}async fetchDeposits(e,t,s,i={}){return await this.fetchTransactionsByType("deposit",e,t,s,i)}async fetchWithdrawals(e,t,s,i={}){return await this.fetchTransactionsByType("withdrawal",e,t,s,i)}parseTransactionStatus(e){return this.safeString({0:"pending",1:"canceled",2:"pending",3:"failed",4:"pending",5:"failed",6:"ok"},e,e)}parseTransaction(e,t){const s=this.safeString2(e,"id","withdraw_id"),i=this.safeString(e,"address");let r=this.safeString(e,"memo");void 0!==r&&r.length<1&&(r=void 0);const a=this.safeString(e,"hash"),n=this.safeStringUpper(e,"currency"),o=this.safeCurrencyCode(n,t),c=this.parse8601(this.safeString(e,"created_date")),d=this.parse8601(this.safeString(e,"finished_date")),h=this.parseTransactionStatus(this.safeString(e,"state")),u=this.safeNumber(e,"amount"),l=this.safeNumber(e,"fee");let f;return void 0!==l&&(f={currency:o,cost:l}),{info:e,id:s,txid:a,timestamp:c,datetime:this.iso8601(c),address:i,addressTo:i,addressFrom:void 0,tag:r,tagTo:r,tagFrom:void 0,type:void 0,amount:u,currency:o,status:h,updated:d,fee:f}}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a=this.currency(e),n={address:s,amount:parseFloat(t),currency:a.id};void 0!==i&&(n.memo=i);const o=await this.privatePostWithdrawNew(this.extend(n,r));return this.parseTransaction(o,a)}sign(e,t="public",s="GET",i={},r,a){const n=this.version;let o=this.urls.api+"/"+n+"/"+this.implodeParams(e,i);const c=this.omit(i,this.extractParams(e)),d=this.urlencode(this.keysort(c));if("private"===t){const e=this.nonce().toString(),t=d,i=this.hmac(this.encode(t),this.encode(this.secret));"GET"===s?d&&(o+="?"+d):"POST"===s&&(r={"Content-Type":"application/x-www-form-urlencoded"},d&&(a=d)),r={"ACCESS-KEY":this.apiKey,"ACCESS-SIGN":i,"ACCESS-TIMESTAMP":e}}else d&&(o+="?"+d);return{url:o,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,a,o,c,d){if(!o)return;const h=this.safeString(o,"code");if("0"===h||"200"===h)return;const l=this.id+" "+a;if(void 0===h)throw new n(l);const f=[u,l],[p,m]=this.safeValue(this.exceptions.exact,h,f);throw new p(m)}}},8170:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,BadSymbol:n}=s(3449),o=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"eqonex",name:"EQONEX",countries:["US","SG"],rateLimit:10,has:{CORS:!1,cancelOrder:!0,createOrder:!0,editOrder:!0,fetchBalance:!0,fetchCanceledOrders:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!1,fetchTrades:!0,fetchTradingFees:!0,fetchWithdrawals:!0,withdraw:!0},timeframes:{"1m":1,"5m":2,"15m":3,"1h":4,"6h":5,"1d":6,"7d":7},urls:{logo:"https://user-images.githubusercontent.com/51840849/122649755-1a076c80-d138-11eb-8f2e-9a9166a03d79.jpg",test:{public:"https://testnet.eqonex.com/api",private:"https://testnet.eqonex.com/api"},api:{public:"https://eqonex.com/api",private:"https://eqonex.com/api"},www:"https://eqonex.com",doc:["https://developer.eqonex.com"],referral:"https://eqonex.com?referredByCode=zpa8kij4ouvBFup3"},api:{public:{get:["health","getInstruments","getInstrumentPairs","getOrderBook","getRisk","getTradeHistory","getFundingRateHistory","getChart","getExchangeInfo"]},private:{post:["logon","order","cancelOrder","cancelReplaceOrder","getOrder","getOrders","getOrderStatus","getOrderHistory","userTrades","getPositions","cancelAll","getUserHistory","getRisk","getDepositAddresses","getDepositHistory","getWithdrawRequests","sendWithdrawRequest","getTransferHistory"]}},requiredCredentials:{apiKey:!0,secret:!0,uid:!0},exceptions:{broad:{"symbol not found":n}}})}async fetchMarkets(e={}){const t=await this.publicGetGetInstrumentPairs(this.extend({verbose:!0},e)),s=this.safeValue(t,"instrumentPairs",[]),i=[];for(let e=0;e<s.length;e++){const t=this.parseMarket(s[e]);i.push(t)}return i}parseMarket(e){const t=this.safeString(e,"instrumentId"),s=this.safeString(e,"symbol"),i=this.safeString(e,"assetType"),r="PAIR"===i,a="PERPETUAL_SWAP"===i,n=a?"swap":"spot",o=this.safeString(e,"currency"),c=this.safeString(e,"contAmtCurr"),d=this.safeCurrencyCode(o),h=this.safeCurrencyCode(c);return{id:t,uppercaseId:s,symbol:a?s:d+"/"+h,base:d,quote:h,baseId:o,quoteId:c,type:n,spot:r,swap:a,active:1===this.safeInteger(e,"securityStatus"),precision:{amount:this.safeInteger(e,"quantity_scale"),price:this.safeInteger(e,"price_scale")},limits:{amount:{min:this.safeNumber(e,"minTradeVol"),max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}},info:e}}async fetchCurrencies(e={}){const t=await this.publicGetGetInstruments(e),s={},i=this.safeValue(t,"instruments",[]);for(let e=0;e<i.length;e++){const t=this.parseCurrency(i[e]);s[t.code]=t}return s}parseCurrency(e){const t=this.safeString(e,0),s=this.safeString(e,1),i=this.safeCurrencyCode(s),r=this.safeInteger(e,2),a=this.safeInteger(e,3),n=Math.max(r,a),o=this.safeString(e,6),c=1===this.safeInteger(e,4);return{id:t,info:e,uppercaseId:s,code:i,name:o,precision:n,fee:this.safeNumber(e,5),active:c,limits:{amount:{min:void 0,max:void 0},withdraw:{min:void 0,max:void 0}}}}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={pairId:parseInt(a.id),timespan:this.timeframes[t]};void 0!==i&&(n.limit=i);const o=await this.publicGetGetChart(this.extend(n,r)),c=this.safeValue(o,"chart",[]);return this.parseOHLCVs(c,a,t,s,i)}parseOHLCV(e,t){return[this.safeInteger(e,0),this.parseNumber(this.convertFromScale(this.safeString(e,1),t.precision.price)),this.parseNumber(this.convertFromScale(this.safeString(e,2),t.precision.price)),this.parseNumber(this.convertFromScale(this.safeString(e,3),t.precision.price)),this.parseNumber(this.convertFromScale(this.safeString(e,4),t.precision.price)),this.parseNumber(this.convertFromScale(this.safeString(e,5),t.precision.amount))]}parseBidAsk(e,t=0,s=1,i){if(void 0===i)throw new a(this.id+" parseBidAsk() requires a market argument");const r=this.safeString(e,t),n=this.safeString(e,s);return[this.parseNumber(this.convertFromScale(r,i.precision.price)),this.parseNumber(this.convertFromScale(n,i.precision.amount))]}parseOrderBook(e,t,s,i="bids",r="asks",a=0,n=1,o){const c={timestamp:s,datetime:this.iso8601(s),nonce:void 0},d=[i,r];for(let t=0;t<d.length;t++){const s=d[t],i=[],r=this.safeValue(e,s);for(let e=0;e<r.length;e++)i.push(this.parseBidAsk(r[e],a,n,o));c[s]=i}return c[i]=this.sortBy(c[i],0,!0),c[r]=this.sortBy(c[r],0),c}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),r={pairId:parseInt(i.id)},a=await this.publicGetGetOrderBook(this.extend(r,s));return this.parseOrderBook(a,e,void 0,"bids","asks",0,1,i)}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={pairId:parseInt(r.id)},n=await this.publicGetGetTradeHistory(this.extend(a,i)),o=this.safeValue(n,"trades",[]);return this.parseTrades(o,r,t,s,i)}parseTrade(e,t){let s,i,r,a,n,c,d,h,u;if(Array.isArray(e)){s=this.safeString(e,3),c=this.convertFromScale(this.safeString(e,0),t.precision.price),d=this.convertFromScale(this.safeString(e,1),t.precision.amount),i=this.toMilliseconds(this.safeString(e,2));const r=this.safeInteger(e,4);1===r?n="buy":2===r&&(n="sell")}else{s=this.safeString(e,"execId"),i=this.safeInteger(e,"time");const o=this.safeString(e,"symbol");u=this.safeSymbol(o,t),r=this.safeString(e,"orderId"),n=this.safeStringLower(e,"side"),a=this.parseOrderType(this.safeString(e,"ordType")),c=this.safeString(e,"lastPx"),d=this.safeString(e,"qty");let l=this.safeNumber(e,"commission");if(void 0!==l){l=-l;const t=this.safeString(e,"commCurrency");h={cost:l,currency:this.safeCurrencyCode(t)}}}void 0===u&&void 0!==t&&(u=t.symbol);const l=this.parseNumber(o.stringMul(d,c)),f=this.parseNumber(c),p=this.parseNumber(d);return{info:e,id:s,timestamp:i,datetime:this.iso8601(i),symbol:u,order:r,type:a,side:n,takerOrMaker:void 0,price:f,amount:p,cost:l,fee:h}}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostGetPositions(e),s=this.safeValue(t,"positions",[]),i={info:t};for(let e=0;e<s.length;e++){const t=s[e];if("ASSET"===this.safeString(t,"assetType")){const e=this.safeString(t,"symbol"),s=this.safeCurrencyCode(e),r=this.safeString(t,"quantity"),a=this.safeString(t,"availableQuantity"),n=this.safeInteger(t,"quantity_scale"),o=this.account();o.free=this.convertFromScale(a,n),o.total=this.convertFromScale(r,n),i[s]=o}}return this.parseBalance(i,!1)}async createOrder(e,t,s,i,r,n={}){await this.loadMarkets();const o=this.market(e),c="buy"===s?1:2,d=this.getScale(i),h={instrumentId:parseInt(o.id),symbol:o.uppercaseId,side:c,quantity:this.convertToScale(this.numberToString(i),d),quantity_scale:d};if("market"===t)h.ordType=1;else if("limit"===t)h.ordType=2,h.price=this.convertToScale(this.numberToString(r),this.getScale(r));else{const e=this.safeNumber2(n,"stopPrice","stopPx");if(n=this.omit(n,["stopPrice","stopPx"]),void 0===e){if("stop"===t){if(void 0===r)throw new a(this.id+" createOrder() requires a price argument or a stopPrice parameter or a stopPx parameter for "+t+" orders");h.ordType=3,h.stopPx=this.convertToScale(this.numberToString(r),this.getScale(r))}else if("stop limit"===t)throw new a(this.id+" createOrder() requires a stopPrice parameter or a stopPx parameter for "+t+" orders")}else if("stop"===t)h.ordType=3,h.stopPx=this.convertToScale(this.numberToString(e),this.getScale(e));else if("stop limit"===t){h.ordType=4;const t=this.getScale(r),s=this.getScale(e);h.price_scale=t,h.stopPx_scale=s,h.stopPx=this.convertToScale(this.numberToString(e),s),h.price=this.convertToScale(this.numberToString(r),t)}}const u=await this.privatePostOrder(this.extend(h,n));return this.parseOrder(u,o)}async cancelOrder(e,t,s={}){if(void 0===t)throw new a(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={origOrderId:parseInt(e),instrumentId:parseInt(i.id)},n=await this.privatePostCancelOrder(this.extend(r,s));return this.parseOrder(n,i)}async editOrder(e,t,s,i,r,n,o={}){await this.loadMarkets();const c=this.market(t),d="buy"===i?1:2,h=this.getScale(r),u={origOrderId:e,instrumentId:parseInt(c.id),symbol:c.uppercaseId,side:d,quantity:this.convertToScale(this.numberToString(r),h),quantity_scale:h};if("market"===s)u.ordType=1;else if("limit"===s)u.ordType=2,u.price=this.convertToScale(this.numberToString(n),this.getScale(n));else{const e=this.safeNumber2(o,"stopPrice","stopPx");if(o=this.omit(o,["stopPrice","stopPx"]),void 0===e){if("stop"===s){if(void 0===n)throw new a(this.id+" editOrder() requires a price argument or a stopPrice parameter or a stopPx parameter for "+s+" orders");u.ordType=3,u.stopPx=this.convertToScale(this.numberToString(n),this.getScale(n))}else if("stop limit"===s)throw new a(this.id+" editOrder() requires a stopPrice parameter or a stopPx parameter for "+s+" orders")}else if("stop"===s)u.ordType=3,u.stopPx=this.convertToScale(this.numberToString(e),this.getScale(e));else if("stop limit"===s){u.ordType=4;const t=this.getScale(n),s=this.getScale(e);u.price_scale=t,u.stopPx_scale=s,u.stopPx=this.convertToScale(this.numberToString(e),s),u.price=this.convertToScale(this.numberToString(n),t)}}const l=await this.privatePostOrder(this.extend(u,o));return this.parseOrder(l,c)}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={orderId:parseInt(e)},r=await this.privatePostGetOrderStatus(this.extend(i,s));return this.parseOrder(r)}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({ordStatus:"2"},i))}async fetchCanceledOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({ordStatus:"4"},i))}async fetchOrders(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.market(e),a.instrumentId=parseInt(r.id)),void 0!==s&&(a.limit=s);const n=await this.privatePostGetOrders(this.extend(a,i)),o=this.safeValue(n,"orders",[]);return this.parseOrders(o,r,t,s,i)}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.market(e),r.instrumentId=a.id),void 0!==t&&(r.startTime=t);const n=await this.privatePostUserTrades(this.extend(r,i)),o=this.safeValue(n,"trades",[]);return this.parseTrades(o,a,t,s,i)}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e),i={instrumentId:parseInt(s.id)},r=await this.privatePostGetDepositAddresses(this.extend(i,t)),a=this.safeValue(r,"addresses",[]),n=this.safeValue(a,0);return this.parseDepositAddress(n,s)}parseDepositAddress(e,t){const s=this.safeString(e,"symbol"),i=this.safeCurrencyCode(s,t),r=this.safeString(e,"address");return this.checkAddress(r),{currency:i,address:r,tag:void 0,info:e}}async fetchDeposits(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.instrumentId=parseInt(a.id));const n=await this.privatePostGetDepositHistory(this.extend(r,i)),o=this.safeValue(n,"deposits",[]);return this.parseTransactions(o,a,t,s,{type:"deposit"})}async fetchWithdrawals(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.instrumentId=parseInt(a.id));const n=await this.privatePostGetWithdrawRequests(this.extend(r,i)),o=this.safeValue(n,"addresses",[]);return this.parseTransactions(o,a,t,s,{type:"withdrawal"})}parseTransaction(e,t){const s=this.safeString(e,"id","transactionId"),i=this.safeString(e,"transactionUuid"),r=this.safeInteger(e,"timestamp");let a=this.safeString(e,"address");"null"===a&&(a=void 0);const n=this.safeString(e,"type");let o=this.safeNumber(e,"balance_change");if(void 0===o){o=this.safeString(e,"quantity");const t=this.safeInteger(e,"quantity_scale");o=this.parseNumber(this.convertFromScale(o,t))}const c=this.safeString(e,"symbol"),d=this.safeCurrencyCode(c,t),h=this.parseTransactionStatus(this.safeString(e,"status"));return{info:e,id:s,txid:i,timestamp:r,datetime:this.iso8601(r),addressFrom:void 0,address:a,addressTo:void 0,tagFrom:void 0,tag:void 0,tagTo:void 0,type:n,amount:o,currency:d,status:h,updated:void 0,comment:void 0,fee:void 0}}parseTransactionStatus(e){return this.safeString({0:"pending",1:"ok"},e,e)}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a=this.currency(e),n=this.getScale(t),o=this.convertToScale(t,n),c={instrumentId:parseInt(a.id),symbol:a.uppercaseId,quantity:o,quantity_scale:n,address:s},d=await this.privatePostSendWithdrawRequest(this.extend(c,r));return this.parseTransaction(d,a)}async fetchTradingFees(e={}){const t=await this.publicGetGetExchangeInfo(e),s=this.safeValue(t,"spotFees",[]),i={},r={};for(let e=0;e<s.length;e++){const t=s[e];void 0!==this.safeString(t,"tier")&&(i[t.tier]=this.safeNumber(t,"taker"),r[t.tier]=this.safeNumber(t,"maker"))}return{info:s,tierBased:!0,maker:r,taker:i}}async fetchTradingLimits(e,t={}){await this.loadMarkets();const s=await this.publicGetGetExchangeInfo(t);return{info:this.safeValue(s,"tradingLimits",[]),limits:{amount:{min:void 0,max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}}}}async fetchFundingLimits(e={}){const t=await this.publicGetGetExchangeInfo(e);return{info:this.safeValue(t,"withdrawLimits",[]),withdraw:void 0}}parseOrder(e,t){let s=this.safeString2(e,"orderId","id");s=this.safeString(e,"origOrderId",s);const i=this.safeString(e,"clOrdId"),r=this.parseOrderType(this.safeString(e,"ordType")),a=this.parseOrderSide(this.safeString(e,"side")),n=this.parseOrderStatus(this.safeString(e,"ordStatus")),c=this.safeString(e,"instrumentId"),d=this.safeSymbol(c,t),h=this.toMilliseconds(this.safeString(e,"timeStamp")),u=this.safeString(e,"price"),l=this.safeInteger(e,"price_scale"),f=this.parseNumber(this.convertFromScale(u,l)),p=this.safeString(e,"quantity"),m=this.safeInteger(e,"quantity_scale"),b=this.parseNumber(this.convertFromScale(p,m)),g=this.safeString(e,"cumQty"),y=this.safeInteger(e,"cumQty_scale"),v=this.parseNumber(this.convertFromScale(g,y)),w=this.safeString(e,"leavesQty"),k=this.safeInteger(e,"leavesQty_scale"),S=this.parseNumber(this.convertFromScale(w,k));let _;const O=this.safeInteger(e,"feeInstrumentId"),T=this.safeCurrencyCode(O);let x=this.safeString(e,"feeTotal");const C=this.safeInteger(e,"fee_scale");void 0!==x&&(x=o.stringNeg(x),x=this.parseNumber(this.convertFromScale(x,C))),void 0!==x&&(_={currency:T,cost:x,rate:void 0});let I=this.parseTimeInForce(this.safeString(e,"timeInForce"));"0"===I&&(I=void 0);const M=this.safeInteger(e,"stopPx_scale",0),N=this.parseNumber(this.convertFromScale(this.safeString(e,"stopPx"),M));return this.safeOrder({info:e,id:s,clientOrderId:i,timestamp:h,datetime:this.iso8601(h),lastTradeTimestamp:undefined,symbol:d,type:r,timeInForce:I,postOnly:void 0,side:a,price:f,stopPrice:N,amount:b,cost:void 0,average:void 0,filled:v,remaining:S,status:n,fee:_,trades:void 0})}parseOrderStatus(e){return this.safeString({0:"open",1:"open",2:"closed",3:"open",4:"canceled",5:"canceled",6:"canceling",7:"canceled",8:"rejected",9:"canceled",A:"open",B:"open",C:"expired",D:"open",E:"canceling",F:"open"},e,e)}parseOrderSide(e){return this.safeString({1:"buy",2:"sell"},e,e)}parseOrderType(e){return this.safeString({1:"market",2:"limit",3:"stop",4:"stop limit"},e,e)}parseTimeInForce(e){return this.safeString({1:"GTC",3:"IOC",4:"FOK",5:"GTX",6:"GTD"},e,e)}toMilliseconds(e){if(void 0===e)return e;const t=e.split("-"),s=this.safeString(t,0),i=this.safeString(t,1);if(void 0===s||void 0===i)return;if(8!==s.length)return;const r=s.slice(0,4)+"-"+s.slice(4,6)+"-"+s.slice(6,8);return this.parse8601(r+" "+i)}convertFromScale(e,t){if(void 0===e)return;const s=new o(e);return s.decimals=s.decimals+t,s.reduce(),s.toString()}getScale(e){const t=this.numberToString(e);return this.precisionFromString(t)}convertToScale(e,t){if(void 0!==e&&void 0!==t)return parseInt(this.toWei(e,t))}nonce(){return this.milliseconds()}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0===o)return;const h=this.safeString(o,"error");if(void 0!==h){const e=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions,h,e),this.throwBroadlyMatchedException(this.exceptions,n,e),new r(this.id+" "+n)}}sign(e,t="public",s="GET",i={},r,a){let n=this.implodeParams(e,i),o=this.omit(i,this.extractParams(e));if("public"===t)Object.keys(o).length&&(n+="?"+this.urlencode(o));else if("private"===t){const e=this.safeValue(i,"format"),t=this.safeValue(i,"type"),s={};void 0!==e&&(s.format=e),void 0!==t&&(s.type=t),Object.keys(s).length&&(n+="?"+this.urlencode(s)),i=this.omit(i,["format","type"]),this.checkRequiredCredentials();const c=this.nonce();o=this.extend(o,{userId:this.uid,nonce:c}),i.nonce=this.nonce(),a=this.json(o);const d=this.hmac(this.encode(a),this.encode(this.secret),"sha384");r={"Content-Type":"application/json",requestToken:this.apiKey,signature:d}}return n=this.urls.api[t]+"/"+n,{url:n,method:s,body:a,headers:r}}}},6159:(e,t,s)=>{"use strict";const i=s(8170);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"equos",name:"EQUOS",urls:{logo:"https://user-images.githubusercontent.com/1294454/107758499-05edd180-6d38-11eb-9e09-0b69602a7a15.jpg"}})}}},4101:(e,t,s)=>{"use strict";const i=s(8819),{ArgumentsRequired:r,ExchangeError:a,OrderNotFound:n,AuthenticationError:o,InsufficientFunds:c,InvalidOrder:d,InvalidNonce:h,NotSupported:u,OnMaintenance:l,RateLimitExceeded:f,BadRequest:p,PermissionDenied:m}=s(3449),b=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"exmo",name:"EXMO",countries:["ES","RU"],rateLimit:350,version:"v1.1",has:{cancelOrder:!0,CORS:!1,createOrder:!0,fetchBalance:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchFundingFees:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:"emulated",fetchOrderBook:!0,fetchOrderBooks:!0,fetchOrderTrades:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTradingFee:!0,fetchTradingFees:!0,fetchTransactions:!0,withdraw:!0},timeframes:{"1m":"1","5m":"5","15m":"15","30m":"30","45m":"45","1h":"60","2h":"120","3h":"180","4h":"240","1d":"D","1w":"W","1M":"M"},urls:{logo:"https://user-images.githubusercontent.com/1294454/27766491-1b0ea956-5eda-11e7-9225-40d67b481b8d.jpg",api:{public:"https://api.exmo.com",private:"https://api.exmo.com",web:"https://exmo.me"},www:"https://exmo.me",referral:"https://exmo.me/?ref=131685",doc:["https://exmo.me/en/api_doc?ref=131685","https://github.com/exmo-dev/exmo_api_lib/tree/master/nodejs"],fees:"https://exmo.com/en/docs/fees"},api:{web:{get:["ctrl/feesAndLimits","en/docs/fees"]},public:{get:["currency","currency/list/extended","order_book","pair_settings","ticker","trades","candles_history","required_amount","payments/providers/crypto/list"]},private:{post:["user_info","order_create","order_cancel","stop_market_order_create","stop_market_order_cancel","user_open_orders","user_trades","user_cancelled_orders","order_trades","deposit_address","withdraw_crypt","withdraw_get_txid","excode_create","excode_load","code_check","wallet_history","wallet_operations"]}},fees:{trading:{feeSide:"get",tierBased:!1,percentage:!0,maker:.002,taker:.002},funding:{tierBased:!1,percentage:!1}},options:{useWebapiForFetchingFees:!1,feesAndLimits:{success:1,ctlr:"feesAndLimits",error:"",data:{limits:[{pair:"BTC/USD",min_q:"0.0001",max_q:"1000",min_p:"1",max_p:"30000",min_a:"1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"BTC/RUB",min_q:"0.0001",max_q:"1000",min_p:"1",max_p:"2000000",min_a:"10",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"BTC/EUR",min_q:"0.0001",max_q:"1000",min_p:"1",max_p:"30000",min_a:"1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"BTC/GBP",min_q:"0.0001",max_q:"1000",min_p:"1",max_p:"30000",min_a:"1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"BTC/UAH",min_q:"0.0001",max_q:"1000",min_p:"1",max_p:"15000000",min_a:"10",max_a:"15000000",taker:"0.4",maker:"0.4"},{pair:"BTC/PLN",min_q:"0.0001",max_q:"1000",min_p:"1",max_p:"20000000",min_a:"50",max_a:"2000000",taker:"0.4",maker:"0.4"},{pair:"BTC/TRY",min_q:"0.0001",max_q:"1000",min_p:"1",max_p:"800000",min_a:"40",max_a:"6000000",taker:"0.4",maker:"0.4"},{pair:"BTC/KZT",min_q:"0.0001",max_q:"1000",min_p:"1000",max_p:"12000000",min_a:"1000",max_a:"100000000",taker:"0.4",maker:"0.4"},{pair:"BTC/USDT",min_q:"0.0001",max_q:"1000",min_p:"0.01",max_p:"30000",min_a:"3",max_a:"500000",taker:"0",maker:"0"},{pair:"ETH/BTC",min_q:"0.001",max_q:"5000",min_p:"0.00000001",max_p:"10",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"ETH/USD",min_q:"0.001",max_q:"5000",min_p:"0.01",max_p:"100000",min_a:"3",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"ETH/RUB",min_q:"0.001",max_q:"5000",min_p:"0.01",max_p:"100000",min_a:"150",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"XRP/BTC",min_q:"1",max_q:"5000000",min_p:"0.0000001",max_p:"1",min_a:"0.00001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"XRP/USD",min_q:"1",max_q:"5000000",min_p:"0.001",max_p:"1000",min_a:"0.001",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"XRP/RUB",min_q:"1",max_q:"5000000",min_p:"0.000001",max_p:"1000",min_a:"0.01",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"ADA/BTC",min_q:"1",max_q:"10000000",min_p:"0.00000001",max_p:"1",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"ADA/ETH",min_q:"0.01",max_q:"10000000",min_p:"0.00000001",max_p:"10",min_a:"0.001",max_a:"5000",taker:"0.4",maker:"0.4"},{pair:"ADA/USD",min_q:"0.01",max_q:"10000000",min_p:"0.0001",max_p:"1000",min_a:"0.01",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"ALGO/EXM",min_q:"1",max_q:"1000000",min_p:"0.001",max_p:"10000",min_a:"1",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"ALGO/BTC",min_q:"1",max_q:"1000000",min_p:"0.00000001",max_p:"1",min_a:"0.000001",max_a:"50",taker:"0.4",maker:"0.4"},{pair:"ALGO/USDT",min_q:"1",max_q:"1000000",min_p:"0.001",max_p:"1000",min_a:"1",max_a:"500000",taker:"0",maker:"0"},{pair:"ALGO/RUB",min_q:"1",max_q:"1000000",min_p:"0.000001",max_p:"10000",min_a:"1",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"ALGO/EUR",min_q:"1",max_q:"1000000",min_p:"0.001",max_p:"1000",min_a:"1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"ATOM/EXM",min_q:"1",max_q:"500000",min_p:"0.01",max_p:"100000",min_a:"200",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"ATOM/BTC",min_q:"1",max_q:"500000",min_p:"0.00000001",max_p:"1",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"ATOM/USD",min_q:"1",max_q:"500000",min_p:"0.001",max_p:"1000",min_a:"0.5",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"ATOM/EUR",min_q:"1",max_q:"500000",min_p:"0.001",max_p:"1000",min_a:"0.5",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"BCH/USD",min_q:"0.003",max_q:"5000",min_p:"0.00000001",max_p:"30000",min_a:"0.0001",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"BCH/RUB",min_q:"0.003",max_q:"5000",min_p:"0.00000001",max_p:"2000000",min_a:"0.0001",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"BCH/EUR",min_q:"0.003",max_q:"5000",min_p:"0.01",max_p:"300000",min_a:"3",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"BCH/UAH",min_q:"0.003",max_q:"5000",min_p:"0.1",max_p:"30000",min_a:"10",max_a:"15000000",taker:"0.4",maker:"0.4"},{pair:"BCH/BTC",min_q:"0.003",max_q:"5000",min_p:"0.00000001",max_p:"5",min_a:"0.0001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"BCH/ETH",min_q:"0.003",max_q:"5000",min_p:"0.0000001",max_p:"200",min_a:"0.0001",max_a:"5000",taker:"0.4",maker:"0.4"},{pair:"BCH/USDT",min_q:"0.003",max_q:"5000",min_p:"0.01",max_p:"5000",min_a:"3",max_a:"500000",taker:"0",maker:"0"},{pair:"BTG/USD",min_q:"0.01",max_q:"100000",min_p:"0.001",max_p:"1000",min_a:"3",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"BTG/BTC",min_q:"0.01",max_q:"100000",min_p:"0.00000001",max_p:"1",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"BTG/ETH",min_q:"0.01",max_q:"100000",min_p:"0.0001",max_p:"100",min_a:"0.01",max_a:"5000",taker:"0.4",maker:"0.4"},{pair:"BTT/RUB",min_q:"1",max_q:"500000000",min_p:"0.000001",max_p:"1000",min_a:"0.000001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"BTT/UAH",min_q:"1",max_q:"500000000",min_p:"0.000001",max_p:"1000",min_a:"0.000001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"BTT/BTC",min_q:"1",max_q:"500000000",min_p:"0.00000001",max_p:"0.1",min_a:"0.00001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"CRON/BTC",min_q:"1",max_q:"100000",min_p:"0.0000001",max_p:"1",min_a:"0.00001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"CRON/ETH",min_q:"1",max_q:"100000",min_p:"0.0000001",max_p:"10",min_a:"0.00001",max_a:"5000",taker:"0.4",maker:"0.4"},{pair:"CRON/USDT",min_q:"1",max_q:"100000",min_p:"0.001",max_p:"1000",min_a:"0.001",max_a:"500000",taker:"0",maker:"0"},{pair:"CRON/EXM",min_q:"1",max_q:"100000000",min_p:"0.00000001",max_p:"1000",min_a:"0.01",max_a:"100000",taker:"0.4",maker:"0.4"},{pair:"DAI/USD",min_q:"1",max_q:"500000",min_p:"0.001",max_p:"1000",min_a:"0.1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"DAI/RUB",min_q:"1",max_q:"500000",min_p:"0.01",max_p:"100000",min_a:"0.5",max_a:"30000000",taker:"0.4",maker:"0.4"},{pair:"DAI/BTC",min_q:"1",max_q:"500000",min_p:"0.0000001",max_p:"0.1",min_a:"0.00001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"DAI/ETH",min_q:"1",max_q:"500000",min_p:"0.000001",max_p:"10",min_a:"0.0001",max_a:"5000",taker:"0.4",maker:"0.4"},{pair:"DASH/USD",min_q:"0.01",max_q:"10000",min_p:"0.01",max_p:"10000",min_a:"3",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"DASH/RUB",min_q:"0.01",max_q:"10000",min_p:"0.01",max_p:"100000",min_a:"150",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"DASH/UAH",min_q:"0.01",max_q:"10000",min_p:"0.01",max_p:"200000",min_a:"10",max_a:"15000000",taker:"0.4",maker:"0.4"},{pair:"DASH/BTC",min_q:"0.01",max_q:"10000",min_p:"0.0001",max_p:"1",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"DASH/USDT",min_q:"0.01",max_q:"10000",min_p:"0.01",max_p:"5000",min_a:"3",max_a:"500000",taker:"0",maker:"0"},{pair:"DCR/RUB",min_q:"0.01",max_q:"50000",min_p:"0.00001",max_p:"100000",min_a:"0.5",max_a:"3000000",taker:"0.4",maker:"0.4"},{pair:"DCR/UAH",min_q:"0.01",max_q:"50000",min_p:"0.00001",max_p:"100000",min_a:"0.25",max_a:"1000000",taker:"0.4",maker:"0.4"},{pair:"DCR/BTC",min_q:"0.01",max_q:"50000",min_p:"0.00000001",max_p:"1",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"DOGE/USD",min_q:"100",max_q:"500000000",min_p:"0.0000001",max_p:"1000",min_a:"0.01",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"DOGE/BTC",min_q:"100",max_q:"500000000",min_p:"0.0000001",max_p:"1",min_a:"0.0001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"EOS/USD",min_q:"0.01",max_q:"500000",min_p:"0.01",max_p:"1000",min_a:"0.5",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"EOS/EUR",min_q:"0.01",max_q:"500000",min_p:"0.001",max_p:"1000",min_a:"0.5",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"EOS/BTC",min_q:"0.01",max_q:"500000",min_p:"0.00000001",max_p:"1",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"ETC/USD",min_q:"0.2",max_q:"100000",min_p:"0.01",max_p:"10000",min_a:"0.01",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"ETC/RUB",min_q:"0.2",max_q:"100000",min_p:"0.01",max_p:"10000",min_a:"0.01",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"ETC/BTC",min_q:"0.2",max_q:"100000",min_p:"0.0001",max_p:"0.5",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"ETH/EUR",min_q:"0.001",max_q:"5000",min_p:"0.01",max_p:"100000",min_a:"3",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"ETH/GBP",min_q:"0.001",max_q:"5000",min_p:"0.01",max_p:"100000",min_a:"3",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"ETH/UAH",min_q:"0.001",max_q:"5000",min_p:"0.01",max_p:"1000000",min_a:"90",max_a:"15000000",taker:"0.4",maker:"0.4"},{pair:"ETH/PLN",min_q:"0.001",max_q:"5000",min_p:"0.01",max_p:"100000",min_a:"50",max_a:"2000000",taker:"0.4",maker:"0.4"},{pair:"ETH/TRY",min_q:"0.001",max_q:"5000",min_p:"0.1",max_p:"80000",min_a:"10",max_a:"6000000",taker:"0.4",maker:"0.4"},{pair:"ETH/KZT",min_q:"0.001",max_q:"5000",min_p:"4",max_p:"40000000",min_a:"3",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"ETH/USDT",min_q:"0.001",max_q:"5000",min_p:"0.01",max_p:"100000",min_a:"3",max_a:"500000",taker:"0",maker:"0"},{pair:"ETH/LTC",min_q:"0.001",max_q:"5000",min_p:"0.00000001",max_p:"100000",min_a:"0.05",max_a:"100000",taker:"0.4",maker:"0.4"},{pair:"ETZ/BTC",min_q:"1",max_q:"50000000",min_p:"0.00000001",max_p:"1",min_a:"0.0001",max_a:"10",taker:"0.4",maker:"0.4"},{pair:"ETZ/ETH",min_q:"1",max_q:"50000000",min_p:"0.00000001",max_p:"100",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"ETZ/USDT",min_q:"1",max_q:"50000000",min_p:"0.000001",max_p:"1000",min_a:"0.01",max_a:"1000",taker:"0",maker:"0"},{pair:"EXM/USDT",min_q:"1",max_q:"100000000",min_p:"0.00000001",max_p:"1000",min_a:"0.01",max_a:"100000",taker:"0",maker:"0"},{pair:"EXM/ETH",min_q:"1",max_q:"100000000",min_p:"0.00000001",max_p:"1",min_a:"0.0001",max_a:"5000",taker:"0.4",maker:"0.4"},{pair:"GAS/USD",min_q:"0.01",max_q:"500000",min_p:"0.01",max_p:"50000",min_a:"0.1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"GAS/BTC",min_q:"0.01",max_q:"500000",min_p:"0.00000001",max_p:"1",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"GNT/BTC",min_q:"1",max_q:"10000000",min_p:"0.00000001",max_p:"1",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"GNT/ETH",min_q:"0.01",max_q:"10000000",min_p:"0.00000001",max_p:"10",min_a:"0.01",max_a:"5000",taker:"0.4",maker:"0.4"},{pair:"GUSD/USD",min_q:"1",max_q:"500000",min_p:"0.1",max_p:"10",min_a:"0.1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"GUSD/RUB",min_q:"1",max_q:"500000",min_p:"0.01",max_p:"1000",min_a:"10",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"GUSD/BTC",min_q:"1",max_q:"500000",min_p:"0.00000001",max_p:"1",min_a:"0.0015",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"HP/BTC",min_q:"1",max_q:"100000000",min_p:"0.00000001",max_p:"0.1",min_a:"0.00001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"HB/BTC",min_q:"10",max_q:"100000000",min_p:"0.00000001",max_p:"1",min_a:"0.000001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"LSK/USD",min_q:"0.1",max_q:"500000",min_p:"0.1",max_p:"1000",min_a:"1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"LSK/RUB",min_q:"0.1",max_q:"500000",min_p:"0.001",max_p:"100000",min_a:"0.5",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"LSK/BTC",min_q:"1",max_q:"500000",min_p:"0.0000001",max_p:"1",min_a:"0.0015",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"LTC/USD",min_q:"0.05",max_q:"10000",min_p:"0.01",max_p:"10000",min_a:"3",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"LTC/RUB",min_q:"0.05",max_q:"10000",min_p:"0.01",max_p:"100000",min_a:"150",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"LTC/EUR",min_q:"0.05",max_q:"10000",min_p:"0.01",max_p:"10000",min_a:"3",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"LTC/UAH",min_q:"0.05",max_q:"10000",min_p:"0.01",max_p:"300000",min_a:"5",max_a:"18000000",taker:"0.4",maker:"0.4"},{pair:"LTC/BTC",min_q:"0.05",max_q:"10000",min_p:"0.00000001",max_p:"1",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"MKR/BTC",min_q:"0.0001",max_q:"1000",min_p:"0.0001",max_p:"100",min_a:"0.000001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"MKR/DAI",min_q:"0.0001",max_q:"1000",min_p:"0.5",max_p:"500000",min_a:"0.005",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"MNC/USD",min_q:"10",max_q:"500000000",min_p:"0.000001",max_p:"10000",min_a:"0.01",max_a:"100000",taker:"0.4",maker:"0.4"},{pair:"MNC/BTC",min_q:"10",max_q:"500000000",min_p:"0.00000001",max_p:"1",min_a:"0.000001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"MNC/ETH",min_q:"10",max_q:"500000000",min_p:"0.0000001",max_p:"10",min_a:"0.00001",max_a:"1000",taker:"0.4",maker:"0.4"},{pair:"NEO/USD",min_q:"0.01",max_q:"100000",min_p:"0.01",max_p:"50000",min_a:"0.1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"NEO/RUB",min_q:"0.01",max_q:"100000",min_p:"0.001",max_p:"1500000",min_a:"50",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"NEO/BTC",min_q:"0.1",max_q:"100000",min_p:"0.00000001",max_p:"1",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"OMG/USD",min_q:"0.01",max_q:"500000",min_p:"0.01",max_p:"1000",min_a:"0.5",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"OMG/BTC",min_q:"1",max_q:"500000",min_p:"0.00000001",max_p:"1",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"OMG/ETH",min_q:"0.01",max_q:"500000",min_p:"0.00000001",max_p:"10",min_a:"0.01",max_a:"5000",taker:"0.4",maker:"0.4"},{pair:"ONG/EXM",min_q:"1",max_q:"1000000",min_p:"0.01",max_p:"100000",min_a:"100",max_a:"15000000",taker:"0.4",maker:"0.4"},{pair:"ONG/BTC",min_q:"1",max_q:"1000000",min_p:"0.00000001",max_p:"1",min_a:"0.00001",max_a:"10",taker:"0.4",maker:"0.4"},{pair:"ONG/RUB",min_q:"1",max_q:"1000000",min_p:"0.01",max_p:"100000",min_a:"100",max_a:"250000",taker:"0.4",maker:"0.4"},{pair:"ONG/UAH",min_q:"1",max_q:"1000000",min_p:"0.01",max_p:"100000",min_a:"50",max_a:"6000000",taker:"0.4",maker:"0.4"},{pair:"ONT/EXM",min_q:"1",max_q:"500000",min_p:"0.01",max_p:"100000",min_a:"200",max_a:"15000000",taker:"0.4",maker:"0.4"},{pair:"ONT/BTC",min_q:"1",max_q:"500000",min_p:"0.00000001",max_p:"1",min_a:"0.00001",max_a:"10",taker:"0.4",maker:"0.4"},{pair:"ONT/RUB",min_q:"1",max_q:"500000",min_p:"0.01",max_p:"100000",min_a:"100",max_a:"6000000",taker:"0.4",maker:"0.4"},{pair:"ONT/UAH",min_q:"1",max_q:"500000",min_p:"0.01",max_p:"100000",min_a:"200",max_a:"250000",taker:"0.4",maker:"0.4"},{pair:"PTI/RUB",min_q:"1",max_q:"50000000",min_p:"0.00000001",max_p:"600000",min_a:"10",max_a:"600000",taker:"0.4",maker:"0.4"},{pair:"PTI/BTC",min_q:"1",max_q:"50000000",min_p:"0.00000001",max_p:"1",min_a:"0.000001",max_a:"10",taker:"0.4",maker:"0.4"},{pair:"PTI/EOS",min_q:"1",max_q:"50000000",min_p:"0.0000001",max_p:"5000",min_a:"0.01",max_a:"20000",taker:"0.4",maker:"0.4"},{pair:"PTI/USDT",min_q:"1",max_q:"50000000",min_p:"0.000001",max_p:"10000",min_a:"0.01",max_a:"100000",taker:"0",maker:"0"},{pair:"QTUM/USD",min_q:"0.1",max_q:"500000",min_p:"0.00000001",max_p:"10000",min_a:"0.1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"QTUM/BTC",min_q:"0.1",max_q:"500000",min_p:"0.00000001",max_p:"1",min_a:"0.0001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"QTUM/ETH",min_q:"0.1",max_q:"500000",min_p:"0.00000001",max_p:"100",min_a:"0.001",max_a:"5000",taker:"0.4",maker:"0.4"},{pair:"ROOBEE/BTC",min_q:"1",max_q:"10000000",min_p:"0.00000001",max_p:"0.1",min_a:"0.00001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"SMART/USD",min_q:"10",max_q:"100000000",min_p:"0.000001",max_p:"1000",min_a:"1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"SMART/RUB",min_q:"10",max_q:"100000000",min_p:"0.0001",max_p:"100000",min_a:"10",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"SMART/EUR",min_q:"10",max_q:"100000000",min_p:"0.000001",max_p:"1000",min_a:"1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"SMART/BTC",min_q:"10",max_q:"100000000",min_p:"0.00000001",max_p:"1",min_a:"0.00001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"TRX/USD",min_q:"1",max_q:"50000000",min_p:"0.0001",max_p:"1000",min_a:"0.01",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"TRX/EUR",min_q:"0.01",max_q:"50000000",min_p:"0.0001",max_p:"1000",min_a:"0.01",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"TRX/RUB",min_q:"1",max_q:"50000000",min_p:"0.000001",max_p:"100000",min_a:"0.1",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"TRX/UAH",min_q:"1",max_q:"50000000",min_p:"0.000001",max_p:"100000",min_a:"0.1",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"TRX/BTC",min_q:"1",max_q:"50000000",min_p:"0.00000001",max_p:"1",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"USDC/USD",min_q:"1",max_q:"500000",min_p:"0.0001",max_p:"1000",min_a:"3",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"USDC/BTC",min_q:"1",max_q:"500000",min_p:"0.00000001",max_p:"1",min_a:"0.0001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"USDC/ETH",min_q:"1",max_q:"500000",min_p:"0.0000001",max_p:"100",min_a:"0.001",max_a:"1000",taker:"0.4",maker:"0.4"},{pair:"USDC/USDT",min_q:"1",max_q:"500000",min_p:"0.0001",max_p:"1000",min_a:"3",max_a:"500000",taker:"0",maker:"0"},{pair:"USDT/USD",min_q:"1",max_q:"500000",min_p:"0.5",max_p:"10",min_a:"0.1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"USDT/RUB",min_q:"1",max_q:"500000",min_p:"0.01",max_p:"1000",min_a:"10",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"USDT/EUR",min_q:"0.01",max_q:"500000",min_p:"0.1",max_p:"10",min_a:"0.1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"USDT/GBP",min_q:"1",max_q:"500000",min_p:"0.5",max_p:"10",min_a:"0.1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"USDT/UAH",min_q:"0.01",max_q:"500000",min_p:"1",max_p:"3000",min_a:"2",max_a:"15000000",taker:"0.4",maker:"0.4"},{pair:"USDT/KZT",min_q:"1",max_q:"500000",min_p:"200",max_p:"4000",min_a:"0.1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"VLX/BTC",min_q:"1",max_q:"10000000",min_p:"0.00000001",max_p:"0.1",min_a:"0.00001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"WAVES/USD",min_q:"0.5",max_q:"500000",min_p:"0.001",max_p:"3500",min_a:"0.5",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"WAVES/RUB",min_q:"0.5",max_q:"500000",min_p:"0.01",max_p:"10000",min_a:"1",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"WAVES/BTC",min_q:"0.5",max_q:"500000",min_p:"0.000001",max_p:"1",min_a:"0.0001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"WAVES/ETH",min_q:"0.5",max_q:"500000",min_p:"0.00001",max_p:"30",min_a:"0.0035",max_a:"3500",taker:"0.4",maker:"0.4"},{pair:"XEM/USD",min_q:"10",max_q:"10000000",min_p:"0.00001",max_p:"1000",min_a:"0.1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"XEM/EUR",min_q:"10",max_q:"10000000",min_p:"0.00001",max_p:"1000",min_a:"0.1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"XEM/UAH",min_q:"1",max_q:"10000000",min_p:"0.0001",max_p:"30000",min_a:"10",max_a:"15000000",taker:"0.4",maker:"0.4"},{pair:"XEM/BTC",min_q:"10",max_q:"10000000",min_p:"0.0000001",max_p:"1",min_a:"0.00015",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"XLM/USD",min_q:"0.01",max_q:"5000000",min_p:"0.0001",max_p:"1000",min_a:"0.01",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"XLM/RUB",min_q:"0.01",max_q:"5000000",min_p:"0.00001",max_p:"100000",min_a:"0.1",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"XLM/TRY",min_q:"0.01",max_q:"5000000",min_p:"0.00001",max_p:"100000",min_a:"0.1",max_a:"6000000",taker:"0.4",maker:"0.4"},{pair:"XLM/BTC",min_q:"1",max_q:"5000000",min_p:"0.00000001",max_p:"1",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"XMR/USD",min_q:"0.01",max_q:"10000",min_p:"0.001",max_p:"1000",min_a:"0.1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"XMR/RUB",min_q:"0.01",max_q:"10000",min_p:"0.001",max_p:"600000",min_a:"10",max_a:"16000000",taker:"0.4",maker:"0.4"},{pair:"XMR/EUR",min_q:"0.01",max_q:"10000",min_p:"0.001",max_p:"1000",min_a:"0.1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"XMR/UAH",min_q:"0.01",max_q:"10000",min_p:"0.001",max_p:"300000",min_a:"5",max_a:"16000000",taker:"0.4",maker:"0.4"},{pair:"XMR/BTC",min_q:"0.01",max_q:"10000",min_p:"0.0001",max_p:"1",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"XMR/ETH",min_q:"0.01",max_q:"10000",min_p:"0.00000001",max_p:"100",min_a:"0.001",max_a:"5000",taker:"0.4",maker:"0.4"},{pair:"XRP/EUR",min_q:"1",max_q:"5000000",min_p:"0.001",max_p:"1000",min_a:"0.001",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"XRP/GBP",min_q:"1",max_q:"5000000",min_p:"0.001",max_p:"1000",min_a:"0.001",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"XRP/TRY",min_q:"1",max_q:"5000000",min_p:"0.0001",max_p:"1000",min_a:"0.01",max_a:"6000000",taker:"0.4",maker:"0.4"},{pair:"XRP/UAH",min_q:"1",max_q:"5000000",min_p:"0.0001",max_p:"1000",min_a:"0.01",max_a:"15000000",taker:"0.4",maker:"0.4"},{pair:"XRP/USDT",min_q:"1",max_q:"5000000",min_p:"0.001",max_p:"1000",min_a:"0.001",max_a:"500000",taker:"0",maker:"0"},{pair:"XRP/ETH",min_q:"1",max_q:"5000000",min_p:"0.00000001",max_p:"10",min_a:"0.00001",max_a:"5000",taker:"0.4",maker:"0.4"},{pair:"XTZ/USD",min_q:"0.1",max_q:"100000",min_p:"0.0001",max_p:"1000",min_a:"0.1",max_a:"100000",taker:"0.4",maker:"0.4"},{pair:"XTZ/RUB",min_q:"0.1",max_q:"100000",min_p:"0.00001",max_p:"100000",min_a:"0.5",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"XTZ/BTC",min_q:"0.1",max_q:"100000",min_p:"0.00000001",max_p:"1",min_a:"0.00001",max_a:"10",taker:"0.4",maker:"0.4"},{pair:"XTZ/ETH",min_q:"0.1",max_q:"100000",min_p:"0.0000001",max_p:"10",min_a:"0.0001",max_a:"1000",taker:"0.4",maker:"0.4"},{pair:"ZEC/USD",min_q:"0.01",max_q:"10000",min_p:"0.001",max_p:"5000",min_a:"0.1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"ZEC/RUB",min_q:"0.01",max_q:"10000",min_p:"0.001",max_p:"100000",min_a:"0.1",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"ZEC/EUR",min_q:"0.01",max_q:"10000",min_p:"0.001",max_p:"5000",min_a:"0.1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"ZEC/BTC",min_q:"0.01",max_q:"10000",min_p:"0.00001",max_p:"10",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"ZRX/USD",min_q:"0.01",max_q:"10000000",min_p:"0.00001",max_p:"1000",min_a:"0.1",max_a:"500000",taker:"0.4",maker:"0.4"},{pair:"ZRX/BTC",min_q:"1",max_q:"10000000",min_p:"0.00000001",max_p:"1",min_a:"0.001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"ZRX/ETH",min_q:"0.01",max_q:"10000000",min_p:"0.00000001",max_p:"10",min_a:"0.01",max_a:"5000",taker:"0.4",maker:"0.4"},{pair:"ZAG/BTC",min_q:"1",max_q:"10000000",min_p:"0.00000001",max_p:"0.1",min_a:"0.00001",max_a:"100",taker:"0.4",maker:"0.4"},{pair:"USD/RUB",min_q:"1",max_q:"500000",min_p:"0.01",max_p:"1000",min_a:"10",max_a:"50000000",taker:"0.4",maker:"0.4"},{pair:"EXM/BTC",min_q:"1",max_q:"100000000",min_p:"0.00000001",max_p:"1",min_a:"0.0000001",max_a:"1",taker:"0.4",maker:"0.4"}],fees:[{group:"crypto",title:"Cryptocurrency",items:[{prov:"EXM",dep:"0%",wd:"1 EXM"},{prov:"BTC",dep:"0%",wd:"0.0004 BTC"},{prov:"LTC",dep:"0%",wd:"0.01 LTC"},{prov:"DOGE",dep:"0%",wd:"1 Doge"},{prov:"DASH",dep:"0%",wd:"0.002 DASH"},{prov:"ETH",dep:"0%",wd:"0.003 ETH"},{prov:"WAVES",dep:"0%",wd:"0.001 WAVES"},{prov:"ZEC",dep:"0%",wd:"0.001 ZEC"},{prov:"USDT",dep:"0%",wd:""},{prov:"XMR",dep:"0%",wd:"0.001 XMR"},{prov:"XRP",dep:"0%",wd:"0.02 XRP"},{prov:"ETC",dep:"0%",wd:"0.01 ETC"},{prov:"BCH",dep:"0%",wd:"0.001 BCH"},{prov:"BTG",dep:"0%",wd:"0.001 BTG"},{prov:"EOS",dep:"0%",wd:"0.05 EOS"},{prov:"XLM",dep:"0%",wd:"0.01 XLM"},{prov:"OMG",dep:"0.1 OMG",wd:"0.5 OMG"},{prov:"TRX",dep:"0%",wd:"1 TRX"},{prov:"ADA",dep:"0%",wd:"1 ADA"},{prov:"NEO",dep:"0%",wd:"0%"},{prov:"GAS",dep:"0%",wd:"0%"},{prov:"ZRX",dep:"0%",wd:"1 ZRX"},{prov:"GNT",dep:"0%",wd:"1 GNT"},{prov:"GUSD",dep:"0%",wd:"0.5 GUSD"},{prov:"LSK",dep:"0%",wd:"0.1 LSK"},{prov:"XEM",dep:"0%",wd:"5 XEM"},{prov:"SMART",dep:"0%",wd:"0.5 SMART"},{prov:"QTUM",dep:"0%",wd:"0.01 QTUM"},{prov:"HB",dep:"0%",wd:"10 HB"},{prov:"DAI",dep:"0%",wd:"1 DAI"},{prov:"MKR",dep:"0%",wd:"0.005 MKR"},{prov:"MNC",dep:"0%",wd:"15 MNC"},{prov:"PTI",dep:"-",wd:"10 PTI"},{prov:"ETZ",dep:"0%",wd:"1 ETZ"},{prov:"USDC",dep:"0%",wd:"0.5 USDC"},{prov:"ROOBEE",dep:"0%",wd:"200 ROOBEE"},{prov:"DCR",dep:"0%",wd:"0.01 DCR"},{prov:"ZAG",dep:"0%",wd:"0%"},{prov:"BTT",dep:"0 BTT",wd:"100 BTT"},{prov:"VLX",dep:"0%",wd:"1 VLX"},{prov:"CRON",dep:"0%",wd:"5 CRON"},{prov:"ONT",dep:"0%",wd:"1 ONT"},{prov:"ONG",dep:"0%",wd:"5 ONG"},{prov:"ALGO",dep:"0%",wd:"0.01 ALGO"},{prov:"ATOM",dep:"0%",wd:"0.05 ATOM"}]},{group:"usd",title:"USD",items:[{prov:"Payeer",dep:"3.95%",wd:"-"},{prov:"EX-CODE",dep:"",wd:"0.2%"},{prov:"AdvCash",dep:"0%",wd:"2.49%"},{prov:"Visa/MasterCard (Simplex)",dep:"4.5% + 0.5 USD",wd:"-"},{prov:"Visa",dep:"3.45%",wd:"-"},{prov:"Frick Bank",dep:"0 USD",wd:"-"}]},{group:"eur",title:"EUR",items:[{prov:"Visa/MasterCard",dep:"4.5% + 0.5  EUR",wd:"-"},{prov:"EX-CODE",dep:"",wd:"0.2%"},{prov:"Visa",dep:"2.95%",wd:"-"},{prov:"Frick Internal Transfer",dep:"0 EUR",wd:"-"},{prov:"SEPA Frick Bank",dep:"0 EUR",wd:"1 EUR"},{prov:"WIRE Frick Bank",dep:"0%",wd:"20 EUR"},{prov:"SEPA Weg Ag",dep:"-",wd:"1 EUR"}]},{group:"gbp",title:"GBP",items:[{prov:"EX-CODE",dep:"",wd:"0.2%"},{prov:"WIRE Frick Bank",dep:"10 GBP",wd:"-"}]},{group:"rub",title:"RUB",items:[{prov:"Payeer",dep:"2.49%",wd:"3.49%"},{prov:"EX-CODE",dep:"",wd:"0.2%"},{prov:"Qiwi",dep:"1.49%",wd:"2.49%"},{prov:"Yandex Money",dep:"1.49%",wd:"1.95 %"},{prov:"AdvCash",dep:"0.99%",wd:"0.99%"},{prov:"Visa/MasterCard",dep:"2.99%",wd:"3.99% + 60 RUB"}]},{group:"pln",title:"PLN",items:[{prov:"EX-CODE",dep:"",wd:"0.2%"}]},{group:"try",title:"TRY",items:[{prov:"EX-CODE",dep:"",wd:"0.2%"},{prov:"Visa",dep:"3.05%",wd:"-"},{prov:"Visa/MasterCard (Simplex)",dep:"4.5% + 2 TRY",wd:"-"},{prov:"AdvCash",dep:"0%",wd:"-"}]},{group:"uah",title:"UAH",items:[{prov:"EX-CODE",dep:"",wd:"0.2%"},{prov:"Terminal",dep:"2.6%",wd:"-"},{prov:"Visa/MasterCard EasyTransfer",dep:"-",wd:"2.99%"},{prov:"Visa/MasterCard",dep:"1% + 5 UAH",wd:"-"}]},{group:"kzt",title:"KZT",items:[{prov:"Visa/MasterCard",dep:"3.5%",wd:"2.99% + 450 KZT"},{prov:"EX-CODE",dep:"",wd:"0.2%"},{prov:"AdvCash",dep:"0%",wd:"-"}]}]}}},exceptions:{exact:{40005:o,40009:h,40015:a,40016:l,40017:o,40032:m,40034:f,50052:c,50054:c,50304:n,50173:n,50277:d,50319:d,50321:d},broad:{"range period is too long":p,"invalid syntax":p,"API rate limit exceeded":f}},orders:{}})}async fetchTradingFees(e={}){if(this.options.useWebapiForFetchingFees){let t=(await this.webGetEnDocsFees(e)).split('<td class="th_fees_2" colspan="2">'),s=t.length;if(2!==s)throw new u(this.id+" fetchTradingFees format has changed");if(t=t[1].split("</td>"),s=t.length,s<2)throw new u(this.id+" fetchTradingFees format has changed");const i=.01*parseFloat(t[0].replace("%",""));return{maker:i,taker:i}}return{maker:this.fees.trading.maker,taker:this.fees.trading.taker}}parseFixedFloatValue(e){if(void 0===e||"-"===e)return;if(""===e)return 0;const t=e.indexOf("%")>=0,s=e.split(" ")[0].replace("%",""),i=parseFloat(s);if(i>0&&t)throw new a(this.id+" parseFixedFloatValue detected an unsupported non-zero percentage-based fee "+e);return i}async fetchFundingFees(e={}){let t;t=this.options.useWebapiForFetchingFees?await this.webGetCtrlFeesAndLimits(e):this.options.feesAndLimits;const s={},i={},r=this.safeValue(t.data,"fees"),a=this.indexBy(r,"group"),n=a.crypto.items;for(let e=0;e<n.length;e++){const t=n[e],r=this.safeCurrencyCode(this.safeString(t,"prov")),a=this.safeString(t,"wd"),o=this.safeString(t,"dep");void 0!==a&&(s[r]=this.parseFixedFloatValue(a)),void 0!==o&&(i[r]=this.parseFixedFloatValue(o))}const o=this.toArray(this.omit(a,"crypto"));for(let e=0;e<o.length;e++){const t=this.safeCurrencyCode(this.safeString(o[e],"title"));s[t]=void 0,i[t]=void 0}const c={info:t,withdraw:s,deposit:i};return this.options.fundingFees=c,c}async fetchCurrencies(e={}){const t=await this.fetchFundingFees(e),s=Object.keys(t.withdraw),i=this.indexBy(t.info.data.limits,"pair"),r=Object.keys(i),a={},n={},o={},c={},d={},h={};for(let e=0;e<r.length;e++){const t=r[e],s=i[t],[u,l]=t.split("/"),f=this.safeCurrencyCode(u),p=this.safeCurrencyCode(l),m=this.safeNumber(s,"max_q"),b=this.safeNumber(s,"max_p"),g=this.safeNumber(s,"max_a"),y=this.safeNumber(s,"min_q"),v=this.safeNumber(s,"min_p"),w=this.safeNumber(s,"min_a");a[f]=Math.min(this.safeNumber(a,f,y),y),c[f]=Math.max(this.safeNumber(c,f,m),m),n[p]=Math.min(this.safeNumber(n,p,v),v),o[p]=Math.min(this.safeNumber(o,p,w),w),d[p]=Math.max(this.safeNumber(d,p,b),b),h[p]=Math.max(this.safeNumber(h,p,g),g)}const u={};for(let e=0;e<s.length;e++){const i=s[e],r=this.safeCurrencyCode(i),l=this.safeValue(t.withdraw,r),f=!0;u[r]={id:i,code:r,name:r,active:f,fee:l,precision:8,limits:{amount:{min:this.safeNumber(a,r),max:this.safeNumber(c,r)},price:{min:this.safeNumber(n,r),max:this.safeNumber(d,r)},cost:{min:this.safeNumber(o,r),max:this.safeNumber(h,r)}},info:i}}return u}async fetchMarkets(e={}){const t=await this.publicGetPairSettings(e),s=Object.keys(t),i=[];for(let e=0;e<s.length;e++){const r=s[e],a=t[r],n=r.replace("_","/"),[o,c]=n.split("/"),d=this.safeCurrencyCode(o),h=this.safeCurrencyCode(c),u=this.safeString(a,"commission_taker_percent"),l=this.safeString(a,"commission_maker_percent"),f=this.parseNumber(b.stringDiv(u,"100")),p=this.parseNumber(b.stringDiv(l,"100"));i.push({id:r,symbol:n,base:d,quote:h,baseId:o,quoteId:c,active:!0,taker:f,maker:p,limits:{amount:{min:this.safeNumber(a,"min_quantity"),max:this.safeNumber(a,"max_quantity")},price:{min:this.safeNumber(a,"min_price"),max:this.safeNumber(a,"max_price")},cost:{min:this.safeNumber(a,"min_amount"),max:this.safeNumber(a,"max_amount")}},precision:{amount:8,price:this.safeInteger(a,"price_precision")},info:a})}return i}async fetchOHLCV(e,t="1m",s,i,a={}){await this.loadMarkets();const n=this.market(e),o={symbol:n.id,resolution:this.timeframes[t]},c=this.safeValue(this.options,"fetchOHLCV"),d=this.safeInteger(c,"maxLimit",3e3),h=this.parseTimeframe(t),u=this.milliseconds();if(void 0===s){if(void 0===i)throw new r(this.id+" fetchOHLCV() requires a since argument or a limit argument");if(i>d)throw new p(this.id+" fetchOHLCV will serve "+d.toString()+" candles at most");o.from=parseInt(u/1e3)-i*h-1,o.to=parseInt(u/1e3)}else if(o.from=parseInt(s/1e3)-1,void 0===i)o.to=parseInt(u/1e3);else{if(i>d)throw new p(this.id+" fetchOHLCV will serve "+d.toString()+" candles at most");const e=this.sum(s,i*h*1e3);o.to=parseInt(e/1e3)}const l=await this.publicGetCandlesHistory(this.extend(o,a)),f=this.safeValue(l,"candles",[]);return this.parseOHLCVs(f,n,t,s,i)}parseOHLCV(e,t){return[this.safeInteger(e,"t"),this.safeNumber(e,"o"),this.safeNumber(e,"h"),this.safeNumber(e,"l"),this.safeNumber(e,"c"),this.safeNumber(e,"v")]}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostUserInfo(e),s={info:t},i=this.safeValue(t,"balances",{}),r=this.safeValue(t,"reserved",{}),a=Object.keys(i);for(let e=0;e<a.length;e++){const t=a[e],n=this.currencyId(t),o=this.account();n in i&&(o.free=this.safeString(i,n)),n in r&&(o.used=this.safeString(r,n)),s[t]=o}return this.parseBalance(s,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),r={pair:i.id};void 0!==t&&(r.limit=t);const a=await this.publicGetOrderBook(this.extend(r,s)),n=this.safeValue(a,i.id);return this.parseOrderBook(n,e,void 0,"bid","ask")}async fetchOrderBooks(e,t,s={}){let i;if(await this.loadMarkets(),void 0===e){if(i=this.ids.join(","),i.length>2048){const e=this.ids.length;throw new a(this.id+" has "+e.toString()+" symbols exceeding max URL length, you are required to specify a list of symbols in the first argument to fetchOrderBooks")}}else i=this.marketIds(e),i=i.join(",");const r={pair:i};void 0!==t&&(r.limit=t);const n=await this.publicGetOrderBook(this.extend(r,s)),o={},c=Object.keys(n);for(let e=0;e<c.length;e++){const t=c[e];let s=t;if(t in this.markets_by_id){s=this.markets_by_id[t].symbol}o[s]=this.parseOrderBook(n[t],void 0,"bid","ask")}return o}parseTicker(e,t){const s=this.safeTimestamp(e,"updated");let i;void 0!==t&&(i=t.symbol);const r=this.safeNumber(e,"last_trade");return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"buy_price"),bidVolume:void 0,ask:this.safeNumber(e,"sell_price"),askVolume:void 0,vwap:void 0,open:void 0,close:r,last:r,previousClose:void 0,change:void 0,percentage:void 0,average:this.safeNumber(e,"avg"),baseVolume:this.safeNumber(e,"vol"),quoteVolume:this.safeNumber(e,"vol_curr"),info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTicker(t),i={},r=Object.keys(s);for(let e=0;e<r.length;e++){const t=r[e],a=this.markets_by_id[t],n=a.symbol,o=s[t];i[n]=this.parseTicker(o,a)}return this.filterByArray(i,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=await this.publicGetTicker(t),i=this.market(e);return this.parseTicker(s[i.id],i)}parseTrade(e,t){const s=this.safeTimestamp(e,"date");let i;const r=this.safeString(e,"trade_id"),a=this.safeString(e,"order_id"),n=this.safeNumber(e,"price"),o=this.safeNumber(e,"quantity"),c=this.safeNumber(e,"amount"),d=this.safeString(e,"type"),h=this.safeString(e,"pair");if(void 0!==h)if(h in this.markets_by_id)t=this.markets_by_id[h];else{const[e,t]=h.split("_");i=this.safeCurrencyCode(e)+"/"+this.safeCurrencyCode(t)}void 0===i&&void 0!==t&&(i=t.symbol);const u=this.safeString(e,"exec_type");let l;const f=this.safeNumber(e,"commission_amount");if(void 0!==f){const t=this.safeString(e,"commission_currency"),s=this.safeCurrencyCode(t);let i=this.safeNumber(e,"commission_percent");void 0!==i&&(i/=1e3),l={cost:f,currency:s,rate:i}}return{id:r,info:e,timestamp:s,datetime:this.iso8601(s),symbol:i,order:a,type:undefined,side:d,takerOrMaker:u,price:n,amount:o,cost:c,fee:l}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={pair:r.id},n=await this.publicGetTrades(this.extend(a,i)),o=this.safeValue(n,r.id,[]);return this.parseTrades(o,r,t,s)}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new r(this.id+" fetchMyTrades() requires a symbol argument (a single symbol or an array)");let a,n;if(await this.loadMarkets(),Array.isArray(e)){if(e.length<1)throw new r(this.id+" fetchMyTrades() requires a non-empty symbol array");a=this.marketIds(e).join(",")}else n=this.market(e),a=n.id;const o={pair:a};void 0!==s&&(o.limit=s);const c=await this.privatePostUserTrades(this.extend(o,i));let d=[];const h=Object.keys(c);for(let e=0;e<h.length;e++){const i=h[e];let r;if(i in this.markets_by_id)n=this.markets_by_id[i],r=n.symbol;else{const[e,t]=i.split("_");r=this.safeCurrencyCode(e)+"/"+this.safeCurrencyCode(t)}const a=c[i],o=this.parseTrades(a,n,t,s,{symbol:r});d=this.arrayConcat(d,o)}return this.filterBySinceLimit(d,t,s)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n="market"===t?t+"_":"";"market"===t&&void 0===r&&(r=0);const o={pair:this.market(e).id,quantity:this.amountToPrecision(e,i),type:n+s,price:this.priceToPrecision(e,r)},c=await this.privatePostOrderCreate(this.extend(o,a)),d=this.safeString(c,"order_id"),h=this.milliseconds();i=parseFloat(i),r=parseFloat(r);return{id:d,info:c,timestamp:h,datetime:this.iso8601(h),lastTradeTimestamp:void 0,status:"open",symbol:e,type:t,side:s,price:r,cost:r*i,amount:i,remaining:i,filled:0,fee:void 0,trades:void 0,clientOrderId:void 0,average:void 0}}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={order_id:e};return await this.privatePostOrderCancel(this.extend(i,s))}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={order_id:e.toString()},r=await this.privatePostOrderTrades(this.extend(i,s)),a=this.parseOrder(r);return this.extend(a,{id:e.toString()})}async fetchOrderTrades(e,t,s,i,r={}){let a;void 0!==t&&(a=this.market(t));const n={order_id:e.toString()},o=await this.privatePostOrderTrades(this.extend(n,r)),c=this.safeValue(o,"trades");return this.parseTrades(c,a,s,i)}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r=await this.privatePostUserOpenOrders(i),a=Object.keys(r);let n=[];for(let e=0;e<a.length;e++){const t=a[e];let s;t in this.markets_by_id&&(s=this.markets_by_id[t]);const i=this.parseOrders(r[t],s);n=this.arrayConcat(n,i)}return this.filterBySymbolSinceLimit(n,e,t,s)}parseOrder(e,t){let s,i=this.safeString(e,"order_id"),r=this.safeTimestamp(e,"created");const a=this.safeString(e,"type");if(void 0===t){let s;"pair"in e?s=e.pair:"in_currency"in e&&"out_currency"in e&&(s="buy"===a?e.in_currency+"_"+e.out_currency:e.out_currency+"_"+e.in_currency),void 0!==s&&s in this.markets_by_id&&(t=this.markets_by_id[s])}let n=this.safeNumber(e,"quantity");if(void 0===n){const t="buy"===a?"in_amount":"out_amount";n=this.safeNumber(e,t)}let o=this.safeNumber(e,"price"),c=this.safeNumber(e,"amount"),d=0;const h=[],u=this.safeValue(e,"trades",[]);let l,f,p;const m=u.length;if(m>0){l=0;for(let e=0;e<m;e++){const s=this.parseTrade(u[e],t);void 0===i&&(i=s.order),void 0===r&&(r=s.timestamp),r>s.timestamp&&(r=s.timestamp),d=this.sum(d,s.amount),l=this.sum(l,s.fee.cost),h.push(s)}f=h[m-1].timestamp}let b,g,y=this.safeString(e,"status");void 0!==n&&(b=n-d,y=d>=n?"closed":"open"),void 0===t&&(t=this.getMarketFromTrades(h)),void 0!==t&&(s=t.symbol,g=t.quote),void 0===c?void 0!==o&&(c=o*d):d>0&&(void 0===p&&(p=c/d),void 0===o&&(o=c/d));const v={cost:l,currency:g};return{id:i,clientOrderId:void 0,datetime:this.iso8601(r),timestamp:r,lastTradeTimestamp:f,status:y,symbol:s,type:"limit",timeInForce:void 0,postOnly:void 0,side:a,price:o,stopPrice:void 0,cost:c,amount:n,filled:d,remaining:b,average:p,trades:h,fee:v,info:e}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=await this.privatePostDepositAddress(t),i=this.safeString(s,e);let r,a;if(i){const e=i.split(",");r=e[0];e.length>1&&(a=e[1])}return this.checkAddress(r),{currency:e,address:r,tag:a,info:s}}getMarketFromTrades(e){const t=this.indexBy(e,"pair"),s=Object.keys(t);if(1===s.length)return this.markets[s[0]]}async withdraw(e,t,s,i,r={}){await this.loadMarkets();const a={amount:t,currency:this.currency(e).id,address:s};void 0!==i&&(a.invoice=i);const n=await this.privatePostWithdrawCrypt(this.extend(a,r));return{info:n,id:n.task_id}}parseTransactionStatus(e){return this.safeString({transferred:"ok",paid:"ok",pending:"pending",processing:"pending"},e,e)}parseTransaction(e,t){const s=this.safeTimestamp(e,"dt");let i=this.safeNumber(e,"amount");void 0!==i&&(i=Math.abs(i));const r=this.parseTransactionStatus(this.safeString(e,"status")),a=this.safeString(e,"txid"),n=this.safeString(e,"type"),o=this.safeString(e,"curr"),c=this.safeCurrencyCode(o,t);let d;const h=void 0;let u;const l=this.safeString(e,"account");if("deposit"===n)u=l;else if("withdrawal"===n&&(d=l,void 0!==d)){const e=d.split(":");2===e.length&&(d=this.safeString(e,1),d=d.replace(" ",""))}let f;if(!this.fees.funding.percentage){const t="withdrawal"===n?"withdraw":"deposit";let s=this.safeNumber(this.options.fundingFees[t],c);"cashback"===this.safeString(e,"provider")&&(s=0),void 0!==s&&("withdrawal"===n&&(i-=s),f={cost:s,currency:c,rate:void 0})}return{info:e,id:void 0,timestamp:s,datetime:this.iso8601(s),currency:c,amount:i,address:d,addressTo:d,addressFrom:void 0,tag:h,tagTo:h,tagFrom:void 0,status:r,type:n,updated:void 0,comment:u,txid:a,fee:f}}async fetchTransactions(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==t&&(r.date=parseInt(t/1e3)),void 0!==e&&(a=this.currency(e));const n=await this.privatePostWalletHistory(this.extend(r,i));return this.parseTransactions(n.history,a,t,s)}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t]+"/";if("web"!==t&&(n+=this.version+"/"),n+=e,"public"===t||"web"===t)Object.keys(i).length&&(n+="?"+this.urlencode(i));else if("private"===t){this.checkRequiredCredentials();const e=this.nonce();a=this.urlencode(this.extend({nonce:e},i)),r={"Content-Type":"application/x-www-form-urlencoded",Key:this.apiKey,Sign:this.hmac(this.encode(a),this.encode(this.secret),"sha512")}}return{url:n,method:s,body:a,headers:r}}nonce(){return this.milliseconds()}handleErrors(e,t,s,i,r,n,o,c,d){if(void 0!==o&&("result"in o||"errmsg"in o)){let e=this.safeValue(o,"result",!1);if("string"==typeof e&&(e="true"===e||"1"===e),!e){let e;const t=this.safeString2(o,"error","errmsg"),s=t.split(":");if(s.length>1){const t=s[0].split(" ");e=t.length>1?t[1]:t[0]}const i=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,e,i),this.throwBroadlyMatchedException(this.exceptions.broad,t,i),new a(i)}}}}},5982:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,AuthenticationError:a,ExchangeNotAvailable:n,ArgumentsRequired:o}=s(3449),c=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"exx",name:"EXX",countries:["CN"],rateLimit:100,userAgent:this.userAgents.chrome,has:{cancelOrder:!0,createOrder:!0,fetchBalance:!0,fetchMarkets:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/37770292-fbf613d0-2de4-11e8-9f79-f2dc451b8ccb.jpg",api:{public:"https://api.exx.com/data/v1",private:"https://trade.exx.com/api"},www:"https://www.exx.com/",doc:"https://www.exx.com/help/restApi",fees:"https://www.exx.com/help/rate",referral:"https://www.exx.com/r/fde4260159e53ab8a58cc9186d35501f?recommQd=1"},api:{public:{get:["markets","tickers","ticker","depth","trades"]},private:{get:["order","cancel","getOrder","getOpenOrders","getBalance"]}},fees:{trading:{maker:.001,taker:.001},funding:{withdraw:{BCC:3e-4,BCD:0,BOT:10,BTC:.001,BTG:0,BTM:25,BTS:3,EOS:1,ETC:.01,ETH:.01,ETP:.012,HPY:0,HSR:.001,INK:20,LTC:.005,MCO:.6,MONA:.01,QASH:5,QCASH:5,QTUM:.01,USDT:5}}},commonCurrencies:{DOS:"DEMOS",TV:"TIV"},exceptions:{103:a}})}async fetchMarkets(e={}){const t=await this.publicGetMarkets(e),s=Object.keys(t),i=[];for(let e=0;e<s.length;e++){const r=s[e],a=t[r],[n,o]=r.split("_"),c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o),h=c+"/"+d,u=!0===a.isOpen,l=this.safeString(a,"amountScale"),f=this.safeString(a,"priceScale"),p=this.parsePrecision(l),m=this.parsePrecision(f),b={amount:parseInt(l),price:parseInt(f)};i.push({id:r,symbol:h,base:c,quote:d,baseId:n,quoteId:o,active:u,precision:b,limits:{amount:{min:this.parseNumber(p),max:void 0},price:{min:this.parseNumber(m),max:void 0},cost:{min:this.safeNumber(a,"minAmount"),max:void 0}},info:a})}return i}parseTicker(e,t){const s=t.symbol,i=this.safeInteger(e,"date");e=e.ticker;const r=this.safeNumber(e,"last");return{symbol:s,timestamp:i,datetime:this.iso8601(i),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"buy"),bidVolume:void 0,ask:this.safeNumber(e,"sell"),askVolume:void 0,vwap:void 0,open:void 0,close:r,last:r,previousClose:void 0,change:this.safeNumber(e,"riseRate"),percentage:void 0,average:void 0,baseVolume:this.safeNumber(e,"vol"),quoteVolume:void 0,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={currency:s.id},r=await this.publicGetTicker(this.extend(i,t));return this.parseTicker(r,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTickers(t),i={},r=this.milliseconds(),a=Object.keys(s);for(let e=0;e<a.length;e++){const t=a[e];if(!(t in this.markets_by_id))continue;const n=this.markets_by_id[t],o=n.symbol,c={date:r,ticker:s[t]};i[o]=this.parseTicker(c,n)}return this.filterByArray(i,"symbol",e)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={currency:this.marketId(e)},r=await this.publicGetDepth(this.extend(i,s)),a=this.safeTimestamp(r,"timestamp");return this.parseOrderBook(r,e,a)}parseTrade(e,t){const s=this.safeTimestamp(e,"date"),i=this.safeString(e,"price"),r=this.safeString(e,"amount"),a=this.parseNumber(i),n=this.parseNumber(r),o=this.parseNumber(c.stringMul(i,r));let d;void 0!==t&&(d=t.symbol);const h=this.safeString(e,"type");return{id:this.safeString(e,"tid"),info:e,timestamp:s,datetime:this.iso8601(s),symbol:d,order:void 0,type:"limit",side:h,takerOrMaker:void 0,price:a,amount:n,cost:o,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={currency:r.id},n=await this.publicGetTrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetGetBalance(e),s={info:t},i=this.safeValue(t,"funds"),r=Object.keys(i);for(let e=0;e<r.length;e++){const t=r[e],a=i[t],n=this.safeCurrencyCode(t),o=this.account();o.free=this.safeString(a,"balance"),o.used=this.safeString(a,"freeze"),o.total=this.safeString(a,"total"),s[n]=o}return this.parseBalance(s,!1)}parseOrder(e,t){const s=t.symbol,i=parseInt(e.trade_date),r=this.safeNumber(e,"price"),a=this.safeNumber(e,"trade_money"),n=this.safeNumber(e,"total_amount"),o=this.safeNumber(e,"trade_amount",0);let c,d=this.safeInteger(e,"status");return d=1===d?"canceled":2===d?"closed":"open","fees"in e&&(c={cost:this.safeNumber(e,"fees"),currency:t.quote}),this.safeOrder({id:this.safeString(e,"id"),clientOrderId:void 0,datetime:this.iso8601(i),timestamp:i,lastTradeTimestamp:void 0,status:d,symbol:s,type:"limit",timeInForce:void 0,postOnly:void 0,side:e.type,price:r,stopPrice:void 0,cost:a,amount:n,filled:o,remaining:void 0,trades:void 0,fee:c,info:e,average:void 0})}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o={currency:n.id,type:s,price:r,amount:i},c=await this.privateGetOrder(this.extend(o,a)),d=this.safeString(c,"id");return this.parseOrder({id:d,trade_date:this.milliseconds(),total_amount:i,price:r,type:s,info:c},n)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={id:e,currency:this.market(t).id};return await this.privateGetCancel(this.extend(i,s))}async fetchOrder(e,t,s={}){await this.loadMarkets();const i=this.market(t),r={id:e,currency:i.id},a=await this.privateGetGetOrder(this.extend(r,s));return this.parseOrder(a,i)}async fetchOpenOrders(e,t,s,i={}){if(await this.loadMarkets(),void 0===e)throw new o(this.id+" fetchOpenOrders() requires a symbol argument");const r=this.market(e),a={currency:r.id},n=await this.privateGetGetOpenOrders(this.extend(a,i));return Array.isArray(n)?this.parseOrders(n,r,t,s):[]}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t]+"/"+e;if("public"===t)Object.keys(i).length&&(n+="?"+this.urlencode(i));else{this.checkRequiredCredentials();const e=this.urlencode(this.keysort(this.extend({accesskey:this.apiKey,nonce:this.nonce()},i)));n+="?"+e+"&signature="+this.hmac(this.encode(e),this.encode(this.secret),"sha512"),r={"Content-Type":"application/x-www-form-urlencoded"}}return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,o,c,d,h){if(void 0===c)return;const u=this.safeString(c,"code"),l=this.safeString(c,"message"),f=this.id+" "+o;if("100"===u)return;if(void 0!==u){if(this.throwExactlyMatchedException(this.exceptions,u,f),"308"===u)return;throw new r(f)}const p=this.safeValue(c,"result");if(void 0!==p&&!p)throw"服务端忙碌"===l?new n(f):new r(f)}}},3513:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r}=s(3449),a=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"flowbtc",name:"flowBTC",countries:["BR"],version:"v1",rateLimit:1e3,has:{cancelOrder:!0,CORS:!1,createOrder:!0,fetchBalance:!0,fetchMarkets:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTrades:!0},urls:{logo:"https://user-images.githubusercontent.com/51840849/87443317-01c0d080-c5fe-11ea-95c2-9ebe1a8fafd9.jpg",api:"https://publicapi.flowbtc.com.br",www:"https://www.flowbtc.com.br",doc:"https://www.flowbtc.com.br/api.html"},requiredCredentials:{apiKey:!0,secret:!0,uid:!0},api:{public:{post:["GetTicker","GetTrades","GetTradesByDate","GetOrderBook","GetProductPairs","GetProducts"]},private:{post:["CreateAccount","GetUserInfo","SetUserInfo","GetAccountInfo","GetAccountTrades","GetDepositAddresses","Withdraw","CreateOrder","ModifyOrder","CancelOrder","CancelAllOrders","GetAccountOpenOrders","GetOrderFee"]}},fees:{trading:{tierBased:!1,percentage:!0,maker:.0025,taker:.005}}})}async fetchMarkets(e={}){const t=await this.publicPostGetProductPairs(e),s=this.safeValue(t,"productPairs"),i={};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"name"),a=this.safeString(t,"product1Label"),n=this.safeString(t,"product2Label"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d={amount:this.safeInteger(t,"product1DecimalPlaces"),price:this.safeInteger(t,"product2DecimalPlaces")},h=o+"/"+c;i[h]={id:r,symbol:h,base:o,quote:c,baseId:a,quoteId:n,precision:d,limits:{amount:{min:void 0,max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}},info:t,active:void 0}}return i}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostGetAccountInfo(e),s=this.safeValue(t,"currencies"),i={info:t};for(let e=0;e<s.length;e++){const t=s[e],r=t.name,a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(t,"balance"),n.total=this.safeString(t,"hold"),i[a]=n}return this.parseBalance(i,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={productPair:this.market(e).id},r=await this.publicPostGetOrderBook(this.extend(i,s));return this.parseOrderBook(r,e,void 0,"bids","asks","px","qty")}async fetchTicker(e,t={}){await this.loadMarkets();const s={productPair:this.market(e).id},i=await this.publicPostGetTicker(this.extend(s,t)),r=this.milliseconds(),a=this.safeNumber(i,"last");return{symbol:e,timestamp:r,datetime:this.iso8601(r),high:this.safeNumber(i,"high"),low:this.safeNumber(i,"low"),bid:this.safeNumber(i,"bid"),bidVolume:void 0,ask:this.safeNumber(i,"ask"),askVolume:void 0,vwap:void 0,open:void 0,close:a,last:a,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(i,"volume24hr"),quoteVolume:this.safeNumber(i,"volume24hrProduct2"),info:i}}parseTrade(e,t){const s=this.safeTimestamp(e,"unixtime"),i=0===e.incomingOrderSide?"buy":"sell",r=this.safeString(e,"tid"),n=this.safeString(e,"px"),o=this.safeString(e,"qty"),c=this.parseNumber(n),d=this.parseNumber(o),h=this.parseNumber(a.stringMul(n,o));return{info:e,timestamp:s,datetime:this.iso8601(s),symbol:t.symbol,id:r,order:void 0,type:void 0,side:i,price:c,amount:d,cost:h,takerOrMaker:void 0,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={ins:r.id,startIndex:-1},n=await this.publicPostGetTrades(this.extend(a,i));return this.parseTrades(n.trades,r,t,s)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n="market"===t?1:0,o={ins:this.marketId(e),side:s,orderType:n,qty:i,px:this.priceToPrecision(e,r)},c=await this.privatePostCreateOrder(this.extend(o,a));return{info:c,id:c.serverOrderId}}async cancelOrder(e,t,s={}){if(await this.loadMarkets(),"ins"in s){const t={serverOrderId:e};return await this.privatePostCancelOrder(this.extend(t,s))}throw new r(this.id+" cancelOrder() requires an `ins` symbol parameter for cancelling an order")}sign(e,t="public",s="GET",i={},r,a){const n=this.urls.api+"/"+this.version+"/"+e;if("public"===t)Object.keys(i).length&&(a=this.json(i));else{this.checkRequiredCredentials();const e=this.nonce(),t=e.toString()+this.uid+this.apiKey,s=this.hmac(this.encode(t),this.encode(this.secret));a=this.json(this.extend({apiKey:this.apiKey,apiNonce:e,apiSig:s.toUpperCase()},i)),r={"Content-Type":"application/json"}}return{url:n,method:s,body:a,headers:r}}async request(e,t="public",s="GET",i={},a,n){const o=await this.fetch2(e,t,s,i,a,n);if("isAccepted"in o&&o.isAccepted)return o;throw new r(this.id+" "+this.json(o))}}},9636:(e,t,s)=>{"use strict";const i=s(8819),{TICK_SIZE:r}=s(2115),{ExchangeError:a,InvalidOrder:n,BadRequest:o,InsufficientFunds:c,OrderNotFound:d,AuthenticationError:h,RateLimitExceeded:u,ExchangeNotAvailable:l,CancelPending:f,ArgumentsRequired:p,PermissionDenied:m,BadSymbol:b,DuplicateOrderId:g}=s(3449),y=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"ftx",name:"FTX",countries:["HK"],rateLimit:50,certified:!0,pro:!0,hostname:"ftx.com",urls:{logo:"https://user-images.githubusercontent.com/1294454/67149189-df896480-f2b0-11e9-8816-41593e17f9ec.jpg",www:"https://ftx.com",api:{public:"https://{hostname}",private:"https://{hostname}"},doc:"https://github.com/ftexchange/ftx",fees:"https://ftexchange.zendesk.com/hc/en-us/articles/360024479432-Fees",referral:{url:"https://ftx.com/#a=ccxt",discount:.05}},has:{cancelAllOrders:!0,cancelOrder:!0,createOrder:!0,editOrder:!0,fetchBalance:!0,fetchClosedOrders:!1,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchFundingFees:!1,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchPositions:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTradingFees:!0,fetchWithdrawals:!0,withdraw:!0},timeframes:{"15s":"15","1m":"60","5m":"300","15m":"900","1h":"3600","4h":"14400","1d":"86400"},api:{public:{get:["coins","markets","markets/{market_name}","markets/{market_name}/orderbook","markets/{market_name}/trades","markets/{market_name}/candles","futures","futures/{future_name}","futures/{future_name}/stats","funding_rates","indexes/{index_name}/weights","expired_futures","indexes/{market_name}/candles","lt/tokens","lt/{token_name}","options/requests","options/trades","stats/24h_options_volume","options/historical_volumes/BTC","options/open_interest/BTC","options/historical_open_interest/BTC","spot_margin/history"]},private:{get:["account","positions","wallet/coins","wallet/balances","wallet/all_balances","wallet/deposit_address/{coin}","wallet/deposits","wallet/withdrawals","wallet/withdrawal_fee","wallet/airdrops","wallet/saved_addresses","orders","orders/history","orders/{order_id}","orders/by_client_id/{client_order_id}","conditional_orders","conditional_orders/{conditional_order_id}/triggers","conditional_orders/history","spot_margin/borrow_rates","spot_margin/lending_rates","spot_margin/borrow_summary","spot_margin/market_info","spot_margin/borrow_history","spot_margin/lending_history","spot_margin/offers","spot_margin/lending_info","fills","funding_payments","lt/balances","lt/creations","lt/redemptions","subaccounts","subaccounts/{nickname}/balances","otc/quotes/{quoteId}","options/my_requests","options/requests/{request_id}/quotes","options/my_quotes","options/account_info","options/positions","options/fills","staking/stakes","staking/unstake_requests","staking/balances","staking/staking_rewards"],post:["account/leverage","wallet/withdrawals","wallet/saved_addresses","orders","conditional_orders","orders/{order_id}/modify","orders/by_client_id/{client_order_id}/modify","conditional_orders/{order_id}/modify","spot_margin/offers","lt/{token_name}/create","lt/{token_name}/redeem","subaccounts","subaccounts/update_name","subaccounts/transfer","otc/quotes/{quote_id}/accept","otc/quotes","options/requests","options/requests/{request_id}/quotes","options/quotes/{quote_id}/accept","staking/unstake_requests","srm_stakes/stakes"],delete:["wallet/saved_addresses/{saved_address_id}","orders/{order_id}","orders/by_client_id/{client_order_id}","orders","conditional_orders/{order_id}","subaccounts","options/requests/{request_id}","options/quotes/{quote_id}","staking/unstake_requests/{request_id}"]}},fees:{trading:{tierBased:!0,percentage:!0,maker:2e-4,taker:.07/100,tiers:{taker:[[0,.07/100],[1e6,6e-4],[5e6,55e-5],[1e7,5e-4],[15e6,45e-5],[35e6,4e-4]],maker:[[0,2e-4],[1e6,2e-4],[5e6,15e-5],[1e7,15e-5],[15e6,1e-4],[35e6,1e-4]]}},funding:{withdraw:{}}},exceptions:{exact:{"Please slow down":u,"Size too small for provide":n,"Not logged in":h,"Not enough balances":c,InvalidPrice:n,"Size too small":n,"Size too large":n,"Missing parameter price":n,"Order not found":d,"Order already closed":n,"Trigger price too high":n,"Trigger price too low":n,"Order already queued for cancellation":f,"Duplicate client order ID":g,"Spot orders cannot be reduce-only":n,"Invalid reduce-only order":n},broad:{"Account does not have enough margin for order":c,"Invalid parameter":o,"The requested URL was not found on the server":o,"No such coin":o,"No such future":b,"No such market":b,"Do not send more than":u,"An unexpected error occurred":l,"Please retry request":l,"Please try again":l,"Try again":l,"Only have permissions for subaccount":m}},precisionMode:r,options:{cancelOrder:{method:"privateDeleteOrdersOrderId"},fetchOpenOrders:{method:"privateGetOrders"},fetchOrders:{method:"privateGetOrdersHistory"},sign:{"ftx.com":"FTX","ftx.us":"FTXUS"}}})}async fetchCurrencies(e={}){const t=await this.publicGetCoins(e),s=this.safeValue(t,"result",[]),i={};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"id"),a=this.safeCurrencyCode(r),n=this.safeString(t,"name");i[a]={id:r,code:a,info:t,type:void 0,name:n,active:void 0,fee:void 0,precision:void 0,limits:{withdraw:{min:void 0,max:void 0},amount:{min:void 0,max:void 0}}}}return i}async fetchMarkets(e={}){const t=await this.publicGetMarkets(e),s=[],i=this.safeValue(t,"result",[]);for(let e=0;e<i.length;e++){const t=i[e],r=this.safeString(t,"name"),a=this.safeString2(t,"baseCurrency","underlying"),n=this.safeString(t,"quoteCurrency","USD"),o=this.safeString(t,"type"),c=this.safeCurrencyCode(a),d=this.safeCurrencyCode(n),h="future"===o?this.safeString(t,"name"):c+"/"+d,u=this.safeValue(t,"enabled"),l=this.safeNumber(t,"sizeIncrement"),f=this.safeNumber(t,"priceIncrement"),p={amount:l,price:f};s.push({id:r,symbol:h,base:c,quote:d,baseId:a,quoteId:n,type:o,future:"future"===o,spot:"spot"===o,active:u,precision:p,limits:{amount:{min:l,max:void 0},price:{min:f,max:void 0},cost:{min:void 0,max:void 0}},info:t})}return s}parseTicker(e,t){let s;const i=this.safeString(e,"name");if(i in this.markets_by_id)t=this.markets_by_id[i];else{if("future"===this.safeString(e,"type"))s=i;else{const t=this.safeCurrencyCode(this.safeString(e,"baseCurrency")),i=this.safeCurrencyCode(this.safeString(e,"quoteCurrency"));void 0!==t&&void 0!==i&&(s=t+"/"+i)}}void 0===s&&void 0!==t&&(s=t.symbol);const r=this.safeNumber(e,"last"),a=this.safeTimestamp(e,"time",this.milliseconds());return{symbol:s,timestamp:a,datetime:this.iso8601(a),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"bid"),bidVolume:this.safeNumber(e,"bidSize"),ask:this.safeNumber(e,"ask"),askVolume:this.safeNumber(e,"askSize"),vwap:void 0,open:void 0,close:r,last:r,previousClose:void 0,change:void 0,percentage:this.safeNumber(e,"change24h"),average:void 0,baseVolume:void 0,quoteVolume:this.safeNumber(e,"quoteVolume24h"),info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={market_name:s.id},r=await this.publicGetMarketsMarketName(this.extend(i,t)),a=this.safeValue(r,"result",{});return this.parseTicker(a,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetMarkets(t),i=this.safeValue(s,"result",[]);return this.parseTickers(i,e)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={market_name:this.market(e).id};void 0!==t&&(i.depth=t);const r=await this.publicGetMarketsMarketNameOrderbook(this.extend(i,s)),a=this.safeValue(r,"result",{});return this.parseOrderBook(a,e)}parseOHLCV(e,t){return[this.safeInteger(e,"time"),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}getMarketId(e,t,s={}){const i=this.getMarketParams(e,t,s);return this.safeString(i,1,e)}getMarketParams(e,t,s={}){let i,r;return e in this.markets?(i=this.market(e),r=i.id):r=this.safeString(s,t,e),[i,r]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const[a,n]=this.getMarketParams(e,"market_name",r),o={resolution:this.timeframes[t],market_name:n};i=void 0===i?1501:i,void 0===s?(o.end_time=this.seconds(),o.limit=i,o.start_time=o.end_time-i*this.parseTimeframe(t)):(o.start_time=parseInt(s/1e3),o.limit=i,o.end_time=this.sum(o.start_time,i*this.parseTimeframe(t)));const c=await this.publicGetMarketsMarketNameCandles(this.extend(o,r)),d=this.safeValue(c,"result",[]);return this.parseOHLCVs(d,a,t,s,i)}parseTrade(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"liquidity"),r=this.safeString(e,"market");let a;if(r in this.markets_by_id)a=(t=this.markets_by_id[r]).symbol;else{const t=this.safeCurrencyCode(this.safeString(e,"baseCurrency")),s=this.safeCurrencyCode(this.safeString(e,"quoteCurrency"));a=void 0!==t&&void 0!==s?t+"/"+s:r}const n=this.parse8601(this.safeString(e,"time")),o=this.safeString(e,"price"),c=this.safeString(e,"size"),d=this.parseNumber(o),h=this.parseNumber(c),u=this.parseNumber(y.stringMul(o,c));void 0===a&&void 0!==t&&(a=t.symbol);const l=this.safeString(e,"side");let f;const p=this.safeNumber(e,"fee");if(void 0!==p){const t=this.safeString(e,"feeCurrency");f={cost:p,currency:this.safeCurrencyCode(t),rate:this.safeNumber(e,"feeRate")}}const m=this.safeString(e,"orderId");return{info:e,timestamp:n,datetime:this.iso8601(n),symbol:a,id:s,order:m,type:void 0,takerOrMaker:i,side:l,price:d,amount:h,cost:u,fee:f}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const[r,a]=this.getMarketParams(e,"market_name",i),n={market_name:a};void 0!==t&&(n.start_time=parseInt(t/1e3),n.end_time=this.seconds()),void 0!==s&&(n.limit=s);const o=await this.publicGetMarketsMarketNameTrades(this.extend(n,i)),c=this.safeValue(o,"result",[]);return this.parseTrades(c,r,t,s)}async fetchTradingFees(e={}){await this.loadMarkets();const t=await this.privateGetAccount(e),s=this.safeValue(t,"result",{});return{info:t,maker:this.safeNumber(s,"makerFee"),taker:this.safeNumber(s,"takerFee")}}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetWalletBalances(e),s={info:t},i=this.safeValue(t,"result",[]);for(let e=0;e<i.length;e++){const t=i[e],r=this.safeCurrencyCode(this.safeString(t,"coin")),a=this.account();a.free=this.safeString(t,"free"),a.total=this.safeString(t,"total"),s[r]=a}return this.parseBalance(s,!1)}parseOrderStatus(e){return this.safeString({new:"open",open:"open",closed:"closed",triggered:"closed"},e,e)}parseOrder(e,t){const s=this.safeString(e,"id"),i=this.parse8601(this.safeString(e,"createdAt"));let r=this.parseOrderStatus(this.safeString(e,"status"));const a=this.safeNumber(e,"size"),n=this.safeNumber(e,"filledSize");let o,c=this.safeNumber(e,"remainingSize");0===c&&void 0!==a&&void 0!==n&&(c=Math.max(a-n,0),c>0&&(r="canceled"));const d=this.safeString(e,"market");void 0!==d&&(o=d in this.markets_by_id?(t=this.markets_by_id[d]).symbol:d),void 0===o&&void 0!==t&&(o=t.symbol);const h=this.safeString(e,"side"),u=this.safeString(e,"type"),l=this.safeNumber(e,"avgFillPrice"),f=this.safeNumber2(e,"price","triggerPrice",l);let p;void 0!==n&&void 0!==f&&(p=n*f);const m=this.parse8601(this.safeString(e,"triggeredAt")),b=this.safeString(e,"clientId"),g=this.safeNumber(e,"triggerPrice"),y=this.safeValue(e,"postOnly");return{info:e,id:s,clientOrderId:b,timestamp:i,datetime:this.iso8601(i),lastTradeTimestamp:m,symbol:o,type:u,timeInForce:void 0,postOnly:y,side:h,price:f,stopPrice:g,amount:a,cost:p,average:l,filled:n,remaining:c,status:r,fee:void 0,trades:void 0}}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const o=this.market(e),c={market:o.id,side:s,type:t,size:parseFloat(this.amountToPrecision(e,i))},d=this.safeString2(a,"clientId","clientOrderId");let h;if(void 0!==d&&(c.clientId=d,a=this.omit(a,["clientId","clientOrderId"])),"limit"===t)h="privatePostOrders",c.price=parseFloat(this.priceToPrecision(e,r));else if("market"===t)h="privatePostOrders",c.price=null;else if("stop"===t||"takeProfit"===t){h="privatePostConditionalOrders";const s=this.safeNumber2(a,"stopPrice","triggerPrice");if(void 0===s)throw new p(this.id+" createOrder () requires a stopPrice parameter or a triggerPrice parameter for "+t+" orders");a=this.omit(a,["stopPrice","triggerPrice"]),c.triggerPrice=parseFloat(this.priceToPrecision(e,s)),void 0!==r&&(c.orderPrice=parseFloat(this.priceToPrecision(e,r)))}else{if("trailingStop"!==t)throw new n(this.id+" createOrder () does not support order type "+t+", only limit, market, stop, trailingStop, or takeProfit orders are supported");h="privatePostConditionalOrders",c.trailValue=parseFloat(this.priceToPrecision(e,r))}const u=await this[h](this.extend(c,a)),l=this.safeValue(u,"result",[]);return this.parseOrder(l,o)}async editOrder(e,t,s,i,r,a,n={}){await this.loadMarkets();const o=this.market(t),c={};let d;const h=this.safeString2(n,"client_order_id","clientOrderId"),u=this.safeNumber(n,"triggerPrice"),l=this.safeNumber(n,"orderPrice"),f=this.safeNumber(n,"trailValue");n=this.omit(n,["client_order_id","clientOrderId","triggerPrice","orderPrice","trailValue"]);const p=void 0!==u,m=void 0!==l,b=void 0!==f;p||m||b?(d="privatePostConditionalOrdersOrderIdModify",c.order_id=e,p&&(c.triggerPrice=parseFloat(this.priceToPrecision(t,u))),m&&(c.orderPrice=parseFloat(this.priceToPrecision(t,l))),b&&(c.trailValue=parseFloat(this.priceToPrecision(t,f)))):(void 0===h?(d="privatePostOrdersOrderIdModify",c.order_id=e):(d="privatePostOrdersByClientIdClientOrderIdModify",c.client_order_id=h),void 0!==a&&(c.price=parseFloat(this.priceToPrecision(t,a)))),void 0!==r&&(c.size=parseFloat(this.amountToPrecision(t,r)));const g=await this[d](this.extend(c,n)),y=this.safeValue(g,"result",{});return this.parseOrder(y,o)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={},r=this.safeValue(this.options,"cancelOrder",{}),a=this.safeString(r,"method","privateDeleteOrdersOrderId");let n=this.safeString(s,"method",a);const o=this.safeValue(s,"type"),c=this.safeValue2(s,"client_order_id","clientOrderId");void 0===c?(i.order_id=parseInt(e),"stop"!==o&&"trailingStop"!==o&&"takeProfit"!==o||(n="privateDeleteConditionalOrdersOrderId")):(i.client_order_id=c,n="privateDeleteOrdersByClientIdClientOrderId");const d=this.omit(s,["method","type","client_order_id","clientOrderId"]),h=await this[n](this.extend(i,d));return this.safeValue(h,"result",{})}async cancelAllOrders(e,t={}){await this.loadMarkets();const s={},i=this.getMarketId(e,"market",t);void 0!==i&&(s.market=i);const r=await this.privateDeleteOrders(this.extend(s,t));return this.safeValue(r,"result",{})}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={},r=this.safeValue2(s,"client_order_id","clientOrderId");let a="privateGetOrdersOrderId";void 0===r?i.order_id=e:(i.client_order_id=r,s=this.omit(s,["client_order_id","clientOrderId"]),a="privateGetOrdersByClientIdClientOrderId");const n=await this[a](this.extend(i,s)),o=this.safeValue(n,"result",{});return this.parseOrder(o)}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r={},[a,n]=this.getMarketParams(e,"market",i);void 0!==n&&(r.market=n);const o=this.safeValue(this.options,"fetchOpenOrders",{}),c=this.safeString(o,"method","privateGetOrders");let d=this.safeString(i,"method",c);const h=this.safeValue(i,"type");"stop"!==h&&"trailingStop"!==h&&"takeProfit"!==h||(d="privateGetConditionalOrders");const u=this.omit(i,["method","type"]),l=await this[d](this.extend(r,u)),f=this.safeValue(l,"result",[]);return this.parseOrders(f,a,t,s)}async fetchOrders(e,t,s,i={}){await this.loadMarkets();const r={},[a,n]=this.getMarketParams(e,"market",i);void 0!==n&&(r.market=n),void 0!==s&&(r.limit=s),void 0!==t&&(r.start_time=parseInt(t/1e3));const o=this.safeValue(this.options,"fetchOrders",{}),c=this.safeString(o,"method","privateGetOrdersHistory");let d=this.safeString(i,"method",c);const h=this.safeValue(i,"type");"stop"!==h&&"trailingStop"!==h&&"takeProfit"!==h||(d="privateGetConditionalOrdersHistory");const u=this.omit(i,["method","type"]),l=await this[d](this.extend(r,u)),f=this.safeValue(l,"result",[]);return this.parseOrders(f,a,t,s)}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const[r,a]=this.getMarketParams(e,"market",i),n={};void 0!==a&&(n.market=a),void 0!==t&&(n.start_time=parseInt(t/1e3),n.end_time=this.seconds());const o=await this.privateGetFills(this.extend(n,i)),c=this.safeValue(o,"result",[]);return this.parseTrades(c,r,t,s)}async withdraw(e,t,s,i,r={}){await this.loadMarkets(),this.checkAddress(s);const a=this.currency(e),n={coin:a.id,size:t,address:s};void 0!==this.password&&(n.password=this.password),void 0!==i&&(n.tag=i);const o=await this.privatePostWalletWithdrawals(this.extend(n,r)),c=this.safeValue(o,"result",{});return this.parseTransaction(c,a)}async fetchPositions(e,t={}){await this.loadMarkets();const s=await this.privateGetAccount(t),i=this.safeValue(s,"result",{});return this.safeValue(i,"positions",[])}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={coin:this.currency(e).id},i=await this.privateGetWalletDepositAddressCoin(this.extend(s,t)),r=this.safeValue(i,"result",{}),a=this.safeString(r,"address"),n=this.safeString(r,"tag");return this.checkAddress(a),{currency:e,address:a,tag:n,info:i}}parseTransactionStatus(e){return this.safeString({confirmed:"ok",complete:"ok"},e,e)}parseTransaction(e,t){const s=this.safeCurrencyCode(this.safeString(e,"coin")),i=this.safeString(e,"id"),r=this.safeNumber(e,"size"),a=this.parseTransactionStatus(this.safeString(e,"status")),n=this.parse8601(this.safeString(e,"time")),o=this.safeString(e,"txid");let c,d=this.safeValue(e,"address");if("string"!=typeof d&&(c=this.safeString(d,"tag"),d=this.safeString(d,"address")),void 0===d){const t=this.safeString(e,"notes");void 0!==t&&t.indexOf("Transfer to")>=0&&(d=t.slice(12))}const h=this.safeNumber(e,"fee");return{info:e,id:i,txid:o,timestamp:n,datetime:this.iso8601(n),addressFrom:void 0,address:d,addressTo:d,tagFrom:void 0,tag:c,tagTo:c,type:void 0,amount:r,currency:s,status:a,updated:void 0,fee:{currency:s,cost:h,rate:void 0}}}async fetchDeposits(e,t,s,i={}){await this.loadMarkets();const r=await this.privateGetWalletDeposits(i),a=this.safeValue(r,"result",[]);let n;return void 0!==e&&(n=this.currency(e)),this.parseTransactions(a,n,t,s,{type:"deposit"})}async fetchWithdrawals(e,t,s,i={}){await this.loadMarkets();const r=await this.privateGetWalletWithdrawals(i),a=this.safeValue(r,"result",[]);let n;return void 0!==e&&(n=this.currency(e)),this.parseTransactions(a,n,t,s,{type:"withdrawal"})}sign(e,t="public",s="GET",i={},r,a){let n="/api/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));let c=this.implodeParams(this.urls.api[t],{hostname:this.hostname})+n;if("POST"!==s&&Object.keys(o).length){const e="?"+this.urlencode(o);c+=e,n+=e}if("private"===t){this.checkRequiredCredentials();const e=this.milliseconds().toString();let t=e+s+n;r={},"POST"!==s&&"DELETE"!==s||(t+=a=this.json(o),r["Content-Type"]="application/json");const i=this.hmac(this.encode(t),this.encode(this.secret),"sha256"),c=this.safeValue(this.options,"sign",{}),d=this.safeString(c,this.hostname,"FTX"),h=d+"-TS",u=d+"-SIGN";r[d+"-KEY"]=this.apiKey,r[h]=e,r[u]=i}return{url:c,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,n,o,c,d){if(void 0===o)return;if(!this.safeValue(o,"success")){const e=this.id+" "+n,t=this.safeString(o,"error");throw this.throwExactlyMatchedException(this.exceptions.exact,t,e),this.throwBroadlyMatchedException(this.exceptions.broad,t,e),new a(e)}}}},4663:(e,t,s)=>{"use strict";const i=s(8819),{AuthenticationError:r,ExchangeError:a,ArgumentsRequired:n,InvalidAddress:o,OrderNotFound:c,NotSupported:d,DDoSProtection:h,InsufficientFunds:u,InvalidOrder:l}=s(3449),f=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"gateio",name:"Gate.io",countries:["CN"],version:"2",rateLimit:1e3,pro:!0,has:{cancelOrder:!0,CORS:!1,createDepositAddress:!0,createMarketOrder:!1,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!1,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchOrderTrades:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTransactions:!0,fetchWithdrawals:!0,withdraw:!0,fetchFundingFees:!0},timeframes:{"1m":60,"5m":300,"10m":600,"15m":900,"30m":1800,"1h":3600,"2h":7200,"4h":14400,"6h":21600,"12h":43200,"1d":86400,"1w":604800},urls:{logo:"https://user-images.githubusercontent.com/1294454/31784029-0313c702-b509-11e7-9ccc-bc0da6a0e435.jpg",api:{public:"https://data.gate.io/api",private:"https://data.gate.io/api"},www:"https://gate.io/",doc:"https://gate.io/api2",fees:["https://gate.io/fee","https://support.gate.io/hc/en-us/articles/115003577673"],referral:"https://www.gate.io/signup/2436035"},api:{public:{get:["candlestick2/{id}","pairs","coininfo","marketinfo","marketlist","coininfo","tickers","ticker/{id}","orderBook/{id}","trade/{id}","tradeHistory/{id}","tradeHistory/{id}/{tid}"]},private:{post:["balances","depositAddress","newAddress","depositsWithdrawals","buy","sell","cancelOrder","cancelAllOrders","getOrder","openOrders","tradeHistory","feelist","withdraw","get_sub_account_available","sub_account_transfer"]}},fees:{trading:{tierBased:!0,percentage:!0,maker:.002,taker:.002}},exceptions:{exact:{4:h,5:r,6:r,7:d,8:d,9:d,15:h,16:c,17:c,20:l,21:u},errorCodeNames:{1:"Invalid request",2:"Invalid version",3:"Invalid request",4:"Too many attempts",5:"Invalid sign",6:"Invalid sign",7:"Currency is not supported",8:"Currency is not supported",9:"Currency is not supported",10:"Verified failed",11:"Obtaining address failed",12:"Empty params",13:"Internal error, please report to administrator",14:"Invalid user",15:"Cancel order too fast, please wait 1 min and try again",16:"Invalid order id or order is already closed",17:"Invalid orderid",18:"Invalid amount",19:"Not permitted or trade is disabled",20:"Your order size is too small",21:"You don't have enough fund"}},options:{limits:{cost:{min:{BTC:"0.0001",ETH:"0.001",USDT:"1"}}}},commonCurrencies:{"88MPH":"MPH",BIFI:"Bitcoin File",BOX:"DefiBox",BTCBEAR:"BEAR",BTCBULL:"BULL",GTC:"Game.com",GTC_HT:"Game.com HT",GTC_BSC:"Game.com BSC",HIT:"HitChain",MPH:"Morpher",RAI:"Rai Reflex Index",SBTC:"Super Bitcoin",TNC:"Trinity Network Credit",VAI:"VAIOT"}})}async fetchCurrencies(e={}){const t=await this.publicGetCoininfo(e),s=this.safeValue(t,"coins");if(!s)throw new a(this.id+" fetchCurrencies got an unrecognized response");const i={};for(let e=0;e<s.length;e++){const t=s[e],r=Object.keys(t);for(let e=0;e<r.length;e++){const s=r[e],a=t[s],n=this.safeCurrencyCode(s),o=this.safeValue(a,"delisted",0),c=0===this.safeInteger2(a,"withdraw_disabled",0),d=0===this.safeInteger2(a,"deposit_disabled",0),h=0===this.safeInteger2(a,"trade_disabled",0),u=0===o&&c&&d&&h;i[n]={id:s,code:n,active:u,info:a,name:void 0,fee:void 0,precision:void 0,limits:{amount:{min:void 0,max:void 0},withdraw:{min:void 0,max:void 0}}}}}return i}async fetchMarkets(e={}){const t=await this.publicGetMarketinfo(e),s=this.safeValue(t,"pairs");if(!s)throw new a(this.id+" fetchMarkets got an unrecognized response");const i=[];for(let e=0;e<s.length;e++){const t=s[e],r=Object.keys(t),a=this.safeString(r,0),n=t[a],o=a.split("_"),c=o.length;let d=o[0],h=o[1];c>2&&(d=o[0]+"_"+o[1],h=o[2]);const u=this.safeCurrencyCode(d),l=this.safeCurrencyCode(h),p=u+"/"+l,m=this.safeString(n,"decimal_places"),b=this.parsePrecision(m),g={amount:this.safeInteger(n,"amount_decimal_places"),price:parseInt(m)},y=this.safeString(n,"min_amount"),v={min:this.parseNumber(y),max:void 0},w={min:this.parseNumber(b),max:void 0},k=this.parseNumber(f.stringMul(y,b)),S={amount:v,price:w,cost:{min:this.safeNumber(this.options.limits.cost.min,l,k),max:void 0}},_=!this.safeInteger(n,"trade_disabled"),O=a.toUpperCase(),T=this.safeString(n,"fee"),x=f.stringDiv(T,"100");i.push({id:a,uppercaseId:O,symbol:p,base:u,quote:l,baseId:d,quoteId:h,info:t,active:_,maker:this.parseNumber(x),taker:this.parseNumber(x),precision:g,limits:S})}return i}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostBalances(e),s={info:t};let i=this.safeValue(t,"available",{});Array.isArray(i)&&(i={});const r=this.safeValue(t,"locked",{}),a=Object.keys(i);for(let e=0;e<a.length;e++){const t=a[e],n=this.safeCurrencyCode(t),o=this.account();o.free=this.safeString(i,t),o.used=this.safeString(r,t),s[n]=o}return this.parseBalance(s,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={id:this.marketId(e)},r=await this.publicGetOrderBookId(this.extend(i,s));return this.parseOrderBook(r,e)}parseOHLCV(e,t){return[this.safeInteger(e,0),this.safeNumber(e,5),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,2),this.safeNumber(e,1)]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={id:a.id,group_sec:this.timeframes[t]},o=await this.publicGetCandlestick2Id(this.extend(n,r)),c=this.safeValue(o,"data",[]);return this.parseOHLCVs(c,a,t,s,i)}parseTicker(e,t){const s=this.milliseconds();let i;t&&(i=t.symbol);const r=this.safeNumber(e,"last"),a=this.safeNumber(e,"percentChange");let n,o,c;if(void 0!==r&&void 0!==a){const e=a/100;n=r/this.sum(1,e),o=r-n,c=this.sum(r,n)/2}return n=this.safeNumber(e,"open",n),o=this.safeNumber(e,"change",o),{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber2(e,"high24hr","high"),low:this.safeNumber2(e,"low24hr","low"),bid:this.safeNumber(e,"highestBid"),bidVolume:void 0,ask:this.safeNumber(e,"lowestAsk"),askVolume:void 0,vwap:void 0,open:n,close:r,last:r,previousClose:void 0,change:o,percentage:a,average:c,baseVolume:this.safeNumber(e,"quoteVolume"),quoteVolume:this.safeNumber(e,"baseVolume"),info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTickers(t),i={},r=Object.keys(s);for(let e=0;e<r.length;e++){const t=r[e],a=this.safeMarket(t,void 0,"_");i[a.symbol]=this.parseTicker(s[t],a)}return this.filterByArray(i,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i=await this.publicGetTickerId(this.extend({id:s.id},t));return this.parseTicker(i,s)}parseTrade(e,t){let s=this.safeTimestamp2(e,"timestamp","time_unix");s=this.safeTimestamp(e,"time",s);const i=this.safeString2(e,"tradeID","id"),r=this.safeString2(e,"orderid","orderNumber"),a=this.safeString2(e,"rate","price"),n=this.safeString(e,"amount"),o=this.parseNumber(a),c=this.parseNumber(n),d=this.parseNumber(f.stringMul(a,n)),h=this.safeString(e,"type"),u=this.safeString(e,"role");let l,p;void 0!==t&&(l=t.symbol);let m=this.safeCurrencyCode(this.safeString(e,"fee_coin")),b=this.safeNumber(e,"point_fee");return void 0===b||0===b?(b=this.safeNumber(e,"gt_fee"),void 0===b||0===b?b=this.safeNumber(e,"fee"):m=this.safeCurrencyCode("GT")):m=this.safeCurrencyCode("POINT"),void 0!==b&&(p={cost:b,currency:m}),{id:i,info:e,timestamp:s,datetime:this.iso8601(s),symbol:l,order:r,type:void 0,side:h,takerOrMaker:u,price:o,amount:c,cost:d,fee:p}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={id:r.id};let n;n="tid"in i?"publicGetTradeHistoryIdTid":"publicGetTradeHistoryId";const o=await this[n](this.extend(a,i));return this.parseTrades(o.data,r,t,s)}async fetchOrders(e,t,s,i={}){const r=await this.privatePostOpenOrders(i);return this.parseOrders(r.orders,void 0,t,s)}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={orderNumber:e,currencyPair:this.marketId(t)},r=await this.privatePostGetOrder(this.extend(i,s));return this.parseOrder(r.order)}parseOrderStatus(e){return this.safeString({cancelled:"canceled"},e,e)}parseOrder(e,t){const s=this.safeString2(e,"orderNumber","id"),i=this.safeString(e,"currencyPair"),r=this.safeSymbol(i,t,"_"),a=this.safeTimestamp2(e,"timestamp","ctime"),n=this.safeTimestamp(e,"mtime"),o=this.parseOrderStatus(this.safeString(e,"status"));let c=this.safeString(e,"type");"1"===c?c="sell":"2"===c&&(c="buy");const d=this.safeNumber2(e,"initialRate","rate"),h=this.safeNumber(e,"filledRate"),u=this.safeNumber2(e,"initialAmount","amount"),l=this.safeNumber(e,"filledAmount"),f=this.safeNumber2(e,"leftAmount","left"),p=this.safeNumber(e,"feeValue"),m=this.safeString(e,"feeCurrency"),b=this.safeCurrencyCode(m);let g=this.safeNumber(e,"feePercentage");return void 0!==g&&(g/=100),this.safeOrder({id:s,clientOrderId:void 0,datetime:this.iso8601(a),timestamp:a,lastTradeTimestamp:n,status:o,symbol:r,type:"limit",timeInForce:void 0,postOnly:void 0,side:c,price:d,stopPrice:void 0,cost:void 0,amount:u,filled:l,remaining:f,average:h,trades:void 0,fee:{cost:p,currency:b,rate:g},info:e})}async createOrder(e,t,s,i,r,n={}){if("market"===t)throw new a(this.id+" allows limit orders only");await this.loadMarkets();const o="privatePost"+this.capitalize(s),c=this.market(e),d={currencyPair:c.id,rate:r,amount:i},h=await this[o](this.extend(d,n));return this.parseOrder(this.extend({status:"open",type:s,initialAmount:i},h),c)}async cancelOrder(e,t,s={}){if(void 0===t)throw new n(this.id+" cancelOrder() requires symbol argument");await this.loadMarkets();const i={orderNumber:e,currencyPair:this.marketId(t)};return await this.privatePostCancelOrder(this.extend(i,s))}async queryDepositAddress(e,t,s={}){await this.loadMarkets();e="privatePost"+e+"Address";const i={currency:this.currency(t).id},r=await this[e](this.extend(i,s));let a,n=this.safeString(r,"addr");if(void 0!==n&&n.indexOf("address")>=0)throw new o(this.id+" queryDepositAddress "+n);if("XRP"===t||"HBAR"===t||"STEEM"===t||"XLM"===t||"EOS"===t){const e=n.split(" ");n=e[0],a=e[1]}return{currency:t,address:n,tag:a,info:r}}async createDepositAddress(e,t={}){return await this.queryDepositAddress("New",e,t)}async fetchDepositAddress(e,t={}){return await this.queryDepositAddress("Deposit",e,t)}async fetchOpenOrders(e,t,s,i={}){let r;await this.loadMarkets(),void 0!==e&&(r=this.market(e));const a=await this.privatePostOpenOrders(i);return this.parseOrders(a.orders,r,t,s)}async fetchOrderTrades(e,t,s,i,r={}){if(void 0===t)throw new n(this.id+" fetchOrderTrades() requires a symbol argument");await this.loadMarkets();const a=this.market(t),o={currencyPair:a.id,orderNumber:e},c=await this.privatePostTradeHistory(this.extend(o,r));return this.parseTrades(c.trades,a,s,i)}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new n(this.id+" fetchMyTrades() requires symbol argument");await this.loadMarkets();const r=this.market(e),a={currencyPair:r.id},o=await this.privatePostTradeHistory(this.extend(a,i));return this.parseTrades(o.trades,r,t,s)}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a={currency:this.currency(e).id,amount:t,address:s};void 0!==i&&(a.address+=" "+i);const n=await this.privatePostWithdraw(this.extend(a,r));return{info:n,id:this.safeString(n,"withdrawid")}}async fetchTransactionsByType(e,t,s,i,r={}){await this.loadMarkets();const a={};void 0!==s&&(a.start=s);const n=await this.privatePostDepositsWithdrawals(this.extend(a,r));let o,c;if(void 0===e){const e=this.safeValue(n,"deposits",[]),t=this.safeValue(n,"withdraws",[]);o=this.arrayConcat(e,t)}else o=this.safeValue(n,e,[]);return void 0!==t&&(c=this.currency(t)),this.parseTransactions(o,c,s,i)}async fetchTransactions(e,t,s,i={}){return await this.fetchTransactionsByType(void 0,e,t,s,i)}async fetchDeposits(e,t,s,i={}){return await this.fetchTransactionsByType("deposits",e,t,s,i)}async fetchWithdrawals(e,t,s,i={}){return await this.fetchTransactionsByType("withdraws",e,t,s,i)}parseTransaction(e,t){const s=this.safeString(e,"currency"),i=this.safeCurrencyCode(s,t),r=this.safeString(e,"id"),a=this.safeString(e,"txid");let n=this.safeNumber(e,"amount"),o=this.safeString(e,"address");"false"===o&&(o=void 0);const c=this.safeTimestamp(e,"timestamp"),d=this.parseTransactionStatus(this.safeString(e,"status")),h=this.parseTransactionType(r[0]),u=this.safeNumber(e,"fee");let l;return void 0!==u&&(l={currency:i,cost:u},void 0!==n&&(n-=u)),{info:e,id:r,txid:a,currency:i,amount:n,address:o,tag:void 0,status:d,type:h,timestamp:c,datetime:this.iso8601(c),fee:l}}parseTransactionStatus(e){return this.safeString({PEND:"pending",REQUEST:"pending",DMOVE:"pending",CANCEL:"failed",DONE:"ok"},e,e)}parseTransactionType(e){return this.safeString({d:"deposit",w:"withdrawal"},e,e)}handleErrors(e,t,s,i,r,a,n,o,c){if(void 0===n)return;if("false"!==this.safeString(n,"result",""))return;const d=this.safeString(n,"code"),h=this.safeString(n,"message",a);if(void 0!==d){const e=this.safeString(this.exceptions.errorCodeNames,d,h);this.throwExactlyMatchedException(this.exceptions.exact,d,e)}}async fetchFundingFees(e={}){await this.loadMarkets();const t=await this.privatePostFeelist(e),s={},i={},r=Object.keys(t);for(let e=0;e<r.length;e++){const a=r[e],n=t[a],o=this.safeCurrencyCode(a);s[o]={},i[o]=this.safeNumber(n,"deposit");const c=Object.keys(n);let d=!0;for(let e=0;e<c.length;e++){const t=c[e];if("withdraw_fix_on_chain_"===t.slice(0,22)){d=!1;const e=t.slice(22),i=this.safeCurrencyCode(e),r=this.safeNumber(n,t);s[o][i]=r}}d&&(s[o][o]=this.safeNumber(n,"withdraw_fix"))}return{info:t,withdraw:s,deposit:i}}sign(e,t="public",s="GET",i={},r,a){const n="private"===t?t+"/":"";let o=this.urls.api[t]+this.version+"/1/"+n+this.implodeParams(e,i);const c=this.omit(i,this.extractParams(e));if("public"===t)Object.keys(c).length&&(o+="?"+this.urlencode(c));else{this.checkRequiredCredentials();const e={nonce:this.nonce()};a=(a=this.rawencode(this.extend(e,c))).replace("+"," ");const t=this.hmac(this.encode(a),this.encode(this.secret),"sha512");r={Key:this.apiKey,Sign:t,"Content-Type":"application/x-www-form-urlencoded"}}return{url:o,method:s,body:a,headers:r}}}},3094:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,BadRequest:n,OrderNotFound:o,InvalidOrder:c,InvalidNonce:d,InsufficientFunds:h,AuthenticationError:u,PermissionDenied:l,NotSupported:f,OnMaintenance:p,RateLimitExceeded:m,ExchangeNotAvailable:b}=s(3449),{TICK_SIZE:g}=s(2115),y=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"gemini",name:"Gemini",countries:["US"],rateLimit:1500,version:"v1",has:{cancelOrder:!0,CORS:!1,createDepositAddress:!0,createMarketOrder:!1,createOrder:!0,fetchBalance:!0,fetchBidsAsks:!1,fetchClosedOrders:!1,fetchDepositAddress:!1,fetchDeposits:!1,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!1,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTransactions:!0,fetchWithdrawals:!1,withdraw:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/27816857-ce7be644-6096-11e7-82d6-3c257263229c.jpg",api:{public:"https://api.gemini.com",private:"https://api.gemini.com",web:"https://docs.gemini.com"},www:"https://gemini.com/",doc:["https://docs.gemini.com/rest-api","https://docs.sandbox.gemini.com"],test:{public:"https://api.sandbox.gemini.com",private:"https://api.sandbox.gemini.com",web:"https://docs.gemini.com"},fees:["https://gemini.com/api-fee-schedule","https://gemini.com/trading-fees","https://gemini.com/transfer-fees"]},api:{web:{get:["rest-api"]},public:{get:["v1/symbols","v1/pricefeed","v1/pubticker/{symbol}","v1/book/{symbol}","v1/trades/{symbol}","v1/auction/{symbol}","v1/auction/{symbol}/history","v2/candles/{symbol}/{timeframe}","v2/ticker/{symbol}"]},private:{post:["v1/order/new","v1/order/cancel","v1/order/cancel/session","v1/order/cancel/all","v1/order/status","v1/orders","v1/mytrades","v1/notionalvolume","v1/tradevolume","v1/transfers","v1/balances","v1/deposit/{currency}/newAddress","v1/withdraw/{currency}","v1/heartbeat","v1/transfers"]}},precisionMode:g,fees:{trading:{taker:.0035,maker:.001}},httpExceptions:{400:n,403:l,404:o,406:h,429:m,500:r,502:b,503:p},timeframes:{"1m":"1m","5m":"5m","15m":"15m","30m":"30m","1h":"1hr","6h":"6hr","1d":"1day"},exceptions:{exact:{AuctionNotOpen:n,ClientOrderIdTooLong:n,ClientOrderIdMustBeString:n,ConflictingOptions:n,EndpointMismatch:n,EndpointNotFound:n,IneligibleTiming:n,InsufficientFunds:h,InvalidJson:n,InvalidNonce:d,InvalidOrderType:c,InvalidPrice:c,InvalidQuantity:c,InvalidSide:c,InvalidSignature:u,InvalidSymbol:n,InvalidTimestampInPayload:n,Maintenance:p,MarketNotOpen:c,MissingApikeyHeader:u,MissingOrderField:c,MissingRole:u,MissingPayloadHeader:u,MissingSignatureHeader:u,NoSSL:u,OptionsMustBeArray:n,OrderNotFound:o,RateLimit:m,System:r,UnsupportedOption:n},broad:{"The Gemini Exchange is currently undergoing maintenance.":p,"We are investigating technical issues with the Gemini Exchange.":b}},options:{fetchMarketsMethod:"fetch_markets_from_web",fetchTickerMethod:"fetchTickerV1"}})}async fetchMarkets(e={}){const t=this.safeValue(this.options,"fetchMarketsMethod","fetch_markets_from_api");return await this[t](e)}async fetchMarketsFromWeb(e={}){const t=(await this.webGetRestApi(e)).split('<h1 id="symbols-and-minimums">Symbols and minimums</h1>'),s=t.length,i=this.id+" the "+this.name+" API doc HTML markup has changed, breaking the parser of order limits and precision info for "+this.name+" markets.";if(2!==s)throw new f(i);const r=t[1].split("tbody>");if(r.length<2)throw new f(i);const a=r[1].split("\n<tr>\n"),n=a.length;if(n<2)throw new f(i);const o=[];for(let e=1;e<n;e++){const t=a[e],s=t.split("</td>\n");if(s.length<5)throw new f(i);const r=s[0].replace("<td>",""),n=s[1].replace("<td>","").split(" "),c=this.safeNumber(n,0),d=s[2].replace("<td>","").split(" "),h=this.safeNumber(d,0),u=r.length-0,l=r.slice(u-3,u),p=this.safeCurrencyCode(l),m=s[3].replace("<td>","").split(" "),b=this.safeNumber(m,0),g=r.replace(l,""),y=this.safeCurrencyCode(g),v=y+"/"+p,w=void 0;o.push({id:r,info:t,symbol:v,base:y,quote:p,baseId:g,quoteId:l,active:w,precision:{amount:h,price:b},limits:{amount:{min:c,max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}}})}return o}async fetchMarketsFromAPI(e={}){const t=await this.publicGetV1Symbols(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=i,a=i.length-0,n=i.slice(0,a-3),o=i.slice(a-3,a),c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o),h=c+"/"+d,u={amount:void 0,price:void 0};s.push({id:i,info:r,symbol:h,base:c,quote:d,baseId:n,quoteId:o,precision:u,limits:{amount:{min:void 0,max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}},active:void 0})}return s}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.marketId(e)};void 0!==t&&(i.limit_bids=t,i.limit_asks=t);const r=await this.publicGetV1BookSymbol(this.extend(i,s));return this.parseOrderBook(r,e,void 0,"bids","asks","price","amount")}async fetchTickerV1(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.publicGetV1PubtickerSymbol(this.extend(i,t));return this.parseTicker(r,s)}async fetchTickerV2(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.publicGetV2TickerSymbol(this.extend(i,t));return this.parseTicker(r,s)}async fetchTickerV1AndV2(e,t={}){const s=await this.fetchTickerV1(e,t),i=await this.fetchTickerV2(e,t);return this.deepExtend(s,{open:i.open,high:i.high,low:i.low,change:i.change,percentage:i.percentage,average:i.average,info:i.info})}async fetchTicker(e,t={}){const s=this.safeValue(this.options,"fetchTickerMethod","fetchTickerV1");return await this[s](e,t)}parseTicker(e,t){const s=this.safeValue(e,"volume",{}),i=this.safeInteger(s,"timestamp");let r;const a=this.safeString(e,"pair");let n,o,c,d;if(void 0!==a)if(a in this.markets_by_id)t=this.markets_by_id[a];else{7===a.length-0?(n=a.slice(0,4),o=a.slice(4,7)):(n=a.slice(0,3),o=a.slice(3,6)),c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o),r=c+"/"+d}void 0===r&&void 0!==t&&(r=t.symbol,n=t.baseId.toUpperCase(),o=t.quoteId.toUpperCase(),c=t.base,d=t.quote);const h=this.safeNumber(e,"price"),u=this.safeNumber2(e,"last","close",h);let l,f,p=this.safeNumber(e,"percentChange24h"),m=this.safeNumber(e,"open");void 0!==u&&(void 0!==m?(l=u-m,0!==m&&(p=l/m*100),f=this.sum(u,m)/2):void 0!==p&&(l=u*p,void 0===m&&(m=u-l),f=this.sum(u,m)/2));const b=this.safeNumber(s,n),g=this.safeNumber(s,o),y=this.vwap(b,g);return{symbol:r,timestamp:i,datetime:this.iso8601(i),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"bid"),bidVolume:void 0,ask:this.safeNumber(e,"ask"),askVolume:void 0,vwap:y,open:m,close:u,last:u,previousClose:void 0,change:l,percentage:p,average:f,baseVolume:b,quoteVolume:g,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetV1Pricefeed(t);return this.parseTickers(s,e)}parseTrade(e,t){const s=this.safeInteger(e,"timestampms"),i=this.safeString(e,"tid"),r=this.safeString(e,"order_id"),a=this.safeString(e,"fee_currency"),n=this.safeCurrencyCode(a),o={cost:this.safeNumber(e,"fee_amount"),currency:n},c=this.safeString(e,"price"),d=this.safeString(e,"amount"),h=this.parseNumber(c),u=this.parseNumber(d),l=this.parseNumber(y.stringMul(c,d)),f=this.safeStringLower(e,"type"),p=this.safeSymbol(void 0,t);return{id:i,order:r,info:e,timestamp:s,datetime:this.iso8601(s),symbol:p,type:undefined,side:f,takerOrMaker:void 0,price:h,cost:l,amount:u,fee:o}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id},n=await this.publicGetV1TradesSymbol(this.extend(a,i));return this.parseTrades(n,r,t,s)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostV1Balances(e),s={info:t};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"currency"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(i,"available"),n.total=this.safeString(i,"amount"),s[a]=n}return this.parseBalance(s,!1)}parseOrder(e,t){const s=this.safeInteger(e,"timestampms"),i=this.safeNumber(e,"original_amount"),r=this.safeNumber(e,"remaining_amount"),a=this.safeNumber(e,"executed_amount");let n="closed";e.is_live&&(n="open"),e.is_cancelled&&(n="canceled");const o=this.safeNumber(e,"price"),c=this.safeNumber(e,"avg_execution_price");let d=this.safeString(e,"type");d="exchange limit"===d?"limit":"market buy"===d||"market sell"===d?"market":e.type;const h=this.safeString(e,"symbol"),u=this.safeSymbol(h,t),l=this.safeString(e,"order_id"),f=this.safeStringLower(e,"side"),p=this.safeString(e,"client_order_id");return this.safeOrder({id:l,clientOrderId:p,info:e,timestamp:s,datetime:this.iso8601(s),lastTradeTimestamp:void 0,status:n,symbol:u,type:d,timeInForce:void 0,postOnly:void 0,side:f,price:o,stopPrice:void 0,average:c,cost:void 0,amount:i,filled:a,remaining:r,fee:undefined,trades:void 0})}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={order_id:e},r=await this.privatePostV1OrderStatus(this.extend(i,s));return this.parseOrder(r)}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r=await this.privatePostV1Orders(i);let a;return void 0!==e&&(a=this.market(e)),this.parseOrders(r,a,t,s)}async createOrder(e,t,s,i,a,n={}){if(await this.loadMarkets(),"market"===t)throw new r(this.id+" allows limit orders only");const o={client_order_id:this.nonce().toString(),symbol:this.marketId(e),amount:i.toString(),price:a.toString(),side:s,type:"exchange limit"},c=await this.privatePostV1OrderNew(this.extend(o,n));return{info:c,id:c.order_id}}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={order_id:e};return await this.privatePostV1OrderCancel(this.extend(i,s))}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const r=this.market(e),n={symbol:r.id};void 0!==s&&(n.limit_trades=s),void 0!==t&&(n.timestamp=parseInt(t/1e3));const o=await this.privatePostV1Mytrades(this.extend(n,i));return this.parseTrades(o,r,t,s)}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a={currency:this.currency(e).id,amount:t,address:s},n=await this.privatePostV1WithdrawCurrency(this.extend(a,r));return{info:n,id:this.safeString(n,"txHash")}}nonce(){return this.milliseconds()}async fetchTransactions(e,t,s,i={}){await this.loadMarkets();const r={};void 0!==s&&(r.limit_transfers=s),void 0!==t&&(r.timestamp=t);const a=await this.privatePostV1Transfers(this.extend(r,i));return this.parseTransactions(a)}parseTransaction(e,t){const s=this.safeInteger(e,"timestampms"),i=this.safeString(e,"currency"),r=this.safeCurrencyCode(i,t),a=this.safeString(e,"destination"),n=this.safeStringLower(e,"type");let o,c="pending";e.status&&(c="ok");const d=this.safeNumber(e,"feeAmount");return void 0!==d&&(o={cost:d,currency:r}),{info:e,id:this.safeString(e,"eid"),txid:this.safeString(e,"txHash"),timestamp:s,datetime:this.iso8601(s),address:a,tag:void 0,type:n,amount:this.safeNumber(e,"amount"),currency:r,status:c,updated:void 0,fee:o}}sign(e,t="public",s="GET",i={},r,a){let n="/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if("private"===t){this.checkRequiredCredentials();const e=this.nonce(),t=this.extend({request:n,nonce:e},o);let s=this.json(t);s=this.stringToBase64(s);const i=this.hmac(s,this.encode(this.secret),"sha384");r={"Content-Type":"text/plain","X-GEMINI-APIKEY":this.apiKey,"X-GEMINI-PAYLOAD":this.decode(s),"X-GEMINI-SIGNATURE":i}}else Object.keys(o).length&&(n+="?"+this.urlencode(o));return n=this.urls.api[t]+n,{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0===o){if("string"==typeof n){const e=this.id+" "+n;this.throwBroadlyMatchedException(this.exceptions.broad,n,e)}return}if("error"===this.safeString(o,"result")){const e=this.safeString(o,"reason"),t=this.safeString(o,"message"),s=this.id+" "+t;throw this.throwExactlyMatchedException(this.exceptions.exact,e,s),this.throwExactlyMatchedException(this.exceptions.exact,t,s),this.throwBroadlyMatchedException(this.exceptions.broad,t,s),new r(s)}}async createDepositAddress(e,t={}){await this.loadMarkets();const s={currency:this.currency(e).id},i=await this.privatePostV1DepositCurrencyNewAddress(this.extend(s,t)),r=this.safeString(i,"address");return this.checkAddress(r),{currency:e,address:r,tag:void 0,info:i}}async fetchOHLCV(e,t="5m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={timeframe:this.timeframes[t],symbol:a.id},o=await this.publicGetV2CandlesSymbolTimeframe(this.extend(n,r));return this.parseOHLCVs(o,a,t,s,i)}}},6039:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,InvalidOrder:a,AuthenticationError:n,InsufficientFunds:o,BadSymbol:c,OrderNotFound:d,InvalidAddress:h,BadRequest:u}=s(3449),{TRUNCATE:l}=s(2115),f=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"gopax",name:"GOPAX",countries:["KR"],version:"v1",rateLimit:50,hostname:"gopax.co.kr",certified:!0,pro:!0,has:{cancelOrder:!0,createMarketOrder:!0,createOrder:!0,fetchBalance:!0,fetchCurrencies:!0,fetchDepositAddress:"emulated",fetchDepositAddresses:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTransactions:!0},timeframes:{"1m":"1","5m":"5","30m":"30","1d":"1440"},urls:{logo:"https://user-images.githubusercontent.com/1294454/102897212-ae8a5e00-4478-11eb-9bab-91507c643900.jpg",api:{public:"https://api.{hostname}",private:"https://api.{hostname}"},www:"https://www.gopax.co.kr",doc:"https://gopax.github.io/API/index.en.html",fees:"https://www.gopax.com/feeinfo"},api:{public:{get:["notices","assets","price-tick-size","trading-pairs","trading-pairs/{tradingPair}/ticker","trading-pairs/{tradingPair}/book","trading-pairs/{tradingPair}/trades","trading-pairs/{tradingPair}/stats","trading-pairs/{tradingPair}/price-tick-size","trading-pairs/stats","trading-pairs/{tradingPair}/candles","time"]},private:{get:["balances","balances/{assetName}","orders","orders/{orderId}","orders/clientOrderId/{clientOrderId}","trades","deposit-withdrawal-status","crypto-deposit-addresses","crypto-withdrawal-addresses"],post:["orders"],delete:["orders/{orderId}","orders/clientOrderId/{clientOrderId}"]}},fees:{trading:{percentage:!0,tierBased:!1,maker:4e-4,taker:4e-4}},exceptions:{broad:{ERROR_INVALID_ORDER_TYPE:a,ERROR_INVALID_AMOUNT:a,ERROR_INVALID_TRADING_PAIR:c,"No such order ID":d,"Forbidden order type":a,"the client order ID will be reusable which order has already been completed or canceled":a,ERROR_NO_SUCH_TRADING_PAIR:c,ERROR_INVALID_ORDER_SIDE:a,ERROR_NOT_HEDGE_TOKEN_USER:a,ORDER_EVENT_ERROR_NOT_ALLOWED_BID_ORDER:a,ORDER_EVENT_ERROR_INSUFFICIENT_BALANCE:o,"Invalid option combination":a,"No such client order ID":d},exact:{100:c,101:c,103:a,104:c,105:c,106:c,107:a,108:a,111:a,201:o,202:a,203:a,204:a,205:a,206:a,10004:n,10041:u,10056:u,10057:c,10059:c,10062:u,10069:d,10155:n,10166:u,10212:a,10221:d,10222:a,10223:a,10227:a,10319:u,10358:a,10359:a,10360:a,10361:a,10362:a,10363:a}},options:{createMarketBuyOrderRequiresPrice:!0}})}async fetchTime(e={}){const t=await this.publicGetTime(e);return this.safeInteger(t,"serverTime")}async fetchMarkets(e={}){const t=await this.publicGetTradingPairs(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"name"),a=this.safeInteger(i,"id"),n=this.safeString(i,"baseAsset"),o=this.safeString(i,"quoteAsset"),c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o),h=c+"/"+d,u={price:this.safeInteger(i,"quoteAssetScale"),amount:this.safeInteger(i,"baseAssetScale")},l=this.safeValue(i,"restApiOrderAmountMin",{}),p=this.safeValue(l,"marketAsk",{}),m=this.safeValue(l,"marketBid",{}),b=this.safeString(i,"takerFeePercent"),g=this.safeString(i,"makerFeePercent"),y=this.parseNumber(f.stringDiv(b,"100")),v=this.parseNumber(f.stringDiv(g,"100"));s.push({id:r,info:i,numericId:a,symbol:h,base:c,quote:d,baseId:this.safeString(i,"baseAsset"),quoteId:this.safeString(i,"quoteAsset"),active:!0,taker:y,maker:v,precision:u,limits:{amount:{min:this.safeNumber(p,"amount"),max:void 0},price:{min:this.safeNumber(i,"priceMin"),max:void 0},cost:{min:this.safeNumber(m,"amount"),max:void 0}}})}return s}async fetchCurrencies(e={}){const t=await this.publicGetAssets(e),s={};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"id"),a=this.safeCurrencyCode(r),n=this.safeString(i,"name"),o=this.safeNumber(i,"withdrawalFee"),c=this.safeNumber(i,"scale");s[a]={id:r,info:i,code:a,name:n,active:!0,fee:o,precision:c,limits:{amount:{min:void 0,max:void 0},withdraw:{min:this.safeNumber(i,"withdrawalAmountMin"),max:void 0}}}}return s}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={tradingPair:this.market(e).id},r=await this.publicGetTradingPairsTradingPairBook(this.extend(i,s)),a=this.safeInteger(r,"sequence"),n=this.parseOrderBook(r,e,void 0,"bid","ask",1,2);return n.nonce=a,n}parseTicker(e,t){const s=this.safeString(e,"name"),i=this.safeSymbol(s,t,"-"),r=this.parse8601(this.safeString(e,"time")),a=this.safeNumber(e,"open"),n=this.safeNumber2(e,"price","close");let o,c,d;void 0!==n&&void 0!==a&&(d=this.sum(n,a)/2,o=n-a,a>0&&(c=o/a*100));const h=this.safeNumber(e,"volume"),u=this.safeNumber(e,"quoteVolume"),l=this.vwap(h,u);return{symbol:i,info:e,timestamp:r,datetime:this.iso8601(r),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"bid"),bidVolume:this.safeNumber(e,"bidVolume"),ask:this.safeNumber(e,"ask"),askVolume:this.safeNumber(e,"askVolume"),vwap:l,open:a,close:n,last:n,previousClose:void 0,change:o,percentage:c,average:d,baseVolume:h,quoteVolume:u}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={tradingPair:s.id},r=await this.publicGetTradingPairsTradingPairTicker(this.extend(i,t));return this.parseTicker(r,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTradingPairsStats(t);return this.parseTickers(s,e)}parsePublicTrade(e,t){const s=this.parse8601(this.safeString(e,"time")),i=this.safeNumber(e,"price"),r=this.safeNumber(e,"amount");let a;return"symbol"in t&&(a=this.safeString(t,"symbol")),{info:e,id:this.safeString(e,"id"),timestamp:s,datetime:this.iso8601(s),symbol:a,order:void 0,type:void 0,side:this.safeString(e,"side"),takerOrMaker:void 0,price:i,amount:r,cost:i*r,fee:void 0}}parsePrivateTrade(e,t){const s=this.parse8601(this.safeString(e,"timestamp")),i=this.safeString(e,"tradingPairName").replace("-","/"),r=this.safeString(e,"side"),a=this.safeNumber(e,"price"),n=this.safeNumber(e,"baseAmount");let o=i.slice(0,3);"sell"===r&&(o=i.slice(4));const c={cost:this.safeNumber(e,"fee"),currency:o,rate:void 0};return{info:e,id:this.safeString(e,"id"),timestamp:s,datetime:this.iso8601(s),symbol:i,order:this.safeInteger(e,"orderId"),type:void 0,side:r,takerOrMaker:this.safeString(e,"position"),price:a,amount:n,cost:a*n,fee:c}}parseTrade(e,t){const s=this.safeString2(e,"id","tradeId"),i=this.safeInteger(e,"orderId");let r=this.parse8601(this.safeString2(e,"time","timestamp"));r=this.safeTimestamp(e,"occuredAt",r);const a=this.safeString(e,"tradingPairName"),n=(t=this.safeMarket(a,t,"-")).symbol;let o=this.safeString(e,"side");"1"===o?o="buy":"2"===o&&(o="sell");let c=this.safeString(e,"type");"1"===c?c="limit":"2"===c&&(c="market");const d=this.safeString(e,"price"),h=this.safeString2(e,"amount","baseAmount"),u=this.parseNumber(d),l=this.parseNumber(h);let p=this.safeNumber(e,"quoteAmount");void 0===p&&(p=this.parseNumber(f.stringMul(d,h)));const m=this.safeNumber(e,"fee");let b;void 0!==m&&(b={cost:m,currency:t.base});const g=this.safeString(e,"position");return{info:e,id:s,timestamp:r,datetime:this.iso8601(r),symbol:n,order:i,type:void 0,side:o,takerOrMaker:g,price:u,amount:l,cost:p,fee:b}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={tradingPair:r.id};void 0!==t&&(a.after=parseInt(t/1e3)),void 0!==s&&(a.limit=s);const n=await this.publicGetTradingPairsTradingPairTrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}parseOHLCV(e,t){return[this.safeInteger(e,0),this.safeNumber(e,3),this.safeNumber(e,2),this.safeNumber(e,1),this.safeNumber(e,4),this.safeNumber(e,5)]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e);i=void 0===i?1024:i;const n={tradingPair:a.id,interval:this.timeframes[t]},o=this.parseTimeframe(t);if(void 0===s){const e=this.milliseconds();n.end=e,n.start=e-i*o*1e3}else n.start=s,n.end=this.sum(s,i*o*1e3);const c=await this.publicGetTradingPairsTradingPairCandles(this.extend(n,r));return this.parseOHLCVs(c,a,t,s,i)}parseBalanceResponse(e){const t={info:e};for(let s=0;s<e.length;s++){const i=e[s],r=this.safeString2(i,"asset","isoAlpha3"),a=this.safeCurrencyCode(r),n=this.safeString(i,"hold"),o=this.safeString(i,"pendingWithdrawal"),c=this.account();c.free=this.safeString(i,"avail"),c.used=f.stringAdd(n,o),t[a]=c}return this.parseBalance(t,!1)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetBalances(e);return this.parseBalanceResponse(t)}parseOrderStatus(e){return this.safeString({placed:"open",cancelled:"canceled",completed:"closed",updated:"open",reserved:"open"},e,e)}parseOrder(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"clientOrderId"),r=this.parse8601(this.safeString(e,"createdAt")),a=this.safeString(e,"type"),n=this.safeString(e,"side"),o=this.safeStringUpper(e,"timeInForce"),c=this.safeNumber(e,"price"),d=this.safeNumber(e,"amount"),h=this.safeNumber(e,"stopPrice"),u=this.safeNumber(e,"remaining"),l=this.safeString(e,"tradingPairName");t=this.safeMarket(l,t,"-");const f=this.parseOrderStatus(this.safeString(e,"status")),p=this.safeValue(e,"balanceChange",{}),m=this.safeNumber(p,"baseNet");let b,g,y,v=this.safeNumber(p,"quoteNet");if(void 0!==v&&(v=Math.abs(v)),void 0!==m&&m>0&&(b=this.parse8601(this.safeString(e,"updatedAt"))),"buy"===n){const e=this.safeValue(p,"baseFee",{}),s=this.safeNumber(e,"taking"),i=this.safeNumber(e,"making");g={currency:t.base,cost:this.sum(s,i)}}else{const e=this.safeValue(p,"quoteFee",{}),s=this.safeNumber(e,"taking"),i=this.safeNumber(e,"making");g={currency:t.quote,cost:this.sum(s,i)}}return void 0!==o&&(y="PO"===o),this.safeOrder({id:s,clientOrderId:i,datetime:this.iso8601(r),timestamp:r,lastTradeTimestamp:b,status:f,symbol:t.symbol,type:a,timeInForce:o,postOnly:y,side:n,price:c,stopPrice:h,average:void 0,amount:d,filled:m,remaining:u,cost:v,trades:void 0,fee:g,info:e})}async fetchOrder(e,t,s={}){let i;await this.loadMarkets();const r=this.safeString(s,"clientOrderId");s=this.omit(s,"clientOrderId");const a={};void 0===r?(i="privateGetOrdersOrderId",a.orderId=e):(i="privateGetOrdersClientOrderIdClientOrderId",a.clientOrderId=r);const n=await this[i](this.extend(a,s));return this.parseOrder(n)}async fetchOrders(e,t,s,i={}){await this.loadMarkets();let r;void 0!==e&&(r=this.market(e));const a=await this.privateGetOrders(this.extend({includePast:"true"},i));return this.parseOrders(a,r,t,s)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({includePast:"false"},i))}async createOrder(e,t,s,i,r,n={}){await this.loadMarkets();const o=this.market(e),c={tradingPairName:o.id,side:s,type:t};if("limit"===t)c.price=this.priceToPrecision(e,r),c.amount=this.amountToPrecision(e,i);else if("market"===t)if("buy"===s){let e=i;if(this.safeValue(this.options,"createMarketBuyOrderRequiresPrice",!0)){if(void 0===r)throw new a(this.id+" createOrder() requires the price argument with market buy orders to calculate total order cost (amount to spend), where cost = amount * price. Supply a price argument to createOrder() call if you want the cost to be calculated for you from price and amount, or, alternatively, add .options['createMarketBuyOrderRequiresPrice'] = false and supply the total cost value in the 'amount' argument");e=r*i}const t=o.precision.price;c.amount=this.decimalToPrecision(e,l,t,this.precisionMode)}else c.amount=this.amountToPrecision(e,i);const d=this.safeString(n,"clientOrderId");void 0!==d&&(c.clientOrderId=d,n=this.omit(n,"clientOrderId"));const h=this.safeNumber(n,"stopPrice");void 0!==h&&(c.stopPrice=this.priceToPrecision(e,h),n=this.omit(n,"stopPrice"));const u=this.safeStringLower(n,"timeInForce");void 0!==u&&(c.timeInForce=u,n=this.omit(n,"timeInForce"));const f=await this.privatePostOrders(this.extend(c,n));return this.parseOrder(f,o)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={},r=this.safeString(s,"clientOrderId");let a;void 0===r?(a="privateDeleteOrdersOrderId",i.orderId=e):(a="privateDeleteOrdersClientOrderIdClientOrderId",i.clientOrderId=r,s=this.omit(s,"clientOrderId"));const n=await this[a](this.extend(i,s)),o=this.parseOrder(n);return this.extend(o,{id:e})}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={deepSearch:"true"};void 0!==t&&(r.after=parseInt(t/1e3)),void 0!==s&&(r.limit=s);const a=await this.privateGetTrades(this.extend(r,i));let n;return void 0!==e&&(n=this.market(e)),this.parseTrades(a,n,t,s)}parseDepositAddress(e,t){const s=this.safeString(e,"address"),i=this.safeString(e,"memoId"),r=this.safeString(e,"asset"),a=this.safeCurrencyCode(r);return this.checkAddress(s),{currency:a,address:s,tag:i,info:e}}async fetchDepositAddresses(e,t={}){await this.loadMarkets();const s=await this.privateGetCryptoDepositAddresses(t);return this.parseDepositAddresses(s,e)}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=await this.fetchDepositAddresses(void 0,t),i=this.safeValue(s,e);if(void 0===i)throw new h(this.id+" fetchDepositAddress() "+e+" address not found");return i}parseTransactionStatus(e){return this.safeString({reviewing:"pending",rejected:"rejected",processing:"pending",failed:"failed",completed:"ok"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"txId"),r=this.safeString(e,"asset"),a=this.safeCurrencyCode(r,t);let n=this.safeString(e,"type");"crypto_withdrawal"===n||"fiat_withdrawal"===n?n="withdrawal":"crypto_deposit"!==n&&"fiat_deposit"!==n||(n="deposit");const o=this.safeNumber(e,"netAmount"),c=this.safeNumber(e,"feeAmount");let d;void 0!==c&&(d={cost:c,currency:a});const h=this.safeTimestamp(e,"reviewStartedAt"),u=this.safeTimestamp(e,"completedAt"),l=this.safeString(e,"sourceAddress"),f=this.safeString(e,"destinationAddress"),p=this.safeString(e,"sourceMemoId"),m=this.safeString(e,"destinationMemoId"),b=this.parseTransactionStatus(this.safeString(e,"status"));return{info:e,id:s,txid:i,timestamp:h,datetime:this.iso8601(h),addressFrom:l,address:f,addressTo:f,tagFrom:p,tag:m,tagTo:m,type:n,amount:o,currency:a,status:b,updated:u,comment:void 0,fee:d}}async fetchTransactions(e,t,s,i={}){await this.loadMarkets();const r={};void 0!==t&&(r.before=t),void 0!==s&&(r.limit=s);const a=await this.privateGetDepositWithdrawalStatus(this.extend(r,i));let n;return void 0!==e&&(n=this.currency(e)),this.parseTransactions(a,n,t,s,i)}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){const n="/"+this.implodeParams(e,i);let o=this.implodeParams(this.urls.api[t],{hostname:this.hostname})+n;const c=this.omit(i,this.extractParams(e));if("public"===t)Object.keys(c).length&&(o+="?"+this.urlencode(c));else if("private"===t){this.checkRequiredCredentials();const e=this.nonce().toString();let t="t"+e+s+n;if(r={"api-key":this.apiKey,timestamp:e},"POST"===s)r["Content-Type"]="application/json",t+=a=this.json(i);else if("/orders"===n){if(Object.keys(c).length){const e="?"+this.urlencode(c);t+=e,o+=e}}else"GET"===s&&Object.keys(c).length&&(o+="?"+this.urlencode(c));const d=this.base64ToBinary(this.secret),h=this.hmac(this.encode(t),d,"sha512","base64");r.signature=h}return{url:o,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0!==o&&!Array.isArray(o)){const e=this.safeString(o,"errorCode"),t=this.safeString(o,"errorMessage"),s=this.id+" "+n;if(void 0!==t&&this.throwBroadlyMatchedException(this.exceptions.broad,n,s),void 0!==e&&this.throwExactlyMatchedException(this.exceptions.exact,e,s),void 0!==e||void 0!==t)throw new r(s)}}}},4493:(e,t,s)=>{"use strict";const i=s(8819),{AuthenticationError:r,ExchangeError:a,OrderNotFound:n,ArgumentsRequired:o,BadSymbol:c,BadRequest:d,NullResponse:h,InvalidOrder:u,BadResponse:l,NotSupported:f,ExchangeNotAvailable:p,RequestTimeout:m,RateLimitExceeded:b,PermissionDenied:g,InsufficientFunds:y,InvalidAddress:v}=s(3449),{TICK_SIZE:w,TRUNCATE:k}=s(2115),S=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"hbtc",name:"HBTC",countries:["CN"],rateLimit:2e3,version:"v1",has:{cancelOrder:!0,CORS:!1,createOrder:!0,fetchAccounts:!0,fetchBalance:!0,fetchBidAsk:!0,fetchBidsAsks:!0,fetchClosedOrders:!0,fetchCurrencies:!1,fetchDepositAddress:!1,fetchDeposits:!0,fetchLedger:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!1,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTradingLimits:!0,fetchWithdrawals:!0,withdraw:!0},timeframes:{"1m":"1m","3m":"3m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","2h":"2h","4h":"4h","6h":"6h","8h":"8h","12h":"12h","1d":"1d","3d":"3d","1w":"1w","1M":"1M"},urls:{logo:"https://user-images.githubusercontent.com/51840849/80134449-70663300-85a7-11ea-8942-e204cdeaab5d.jpg",api:{quote:"https://api.hbtc.com/openapi/quote",contract:"https://api.hbtc.com/openapi/contract",option:"https://api.hbtc.com/openapi/option",public:"https://api.hbtc.com/openapi",private:"https://api.hbtc.com/openapi",zendesk:"https://hbtc.zendesk.com/hc/en-us"},www:"https://www.hbtc.com",referral:"https://www.hbtc.com/register/O2S8NS",doc:"https://github.com/bhexopen/BHEX-OpenApi/tree/master/doc",fees:"https://hbtc.zendesk.com/hc/zh-cn/articles/360009274694"},api:{public:{get:["ping","time","brokerInfo","getOptions"]},quote:{get:["depth","depth/merged","trades","klines","ticker/24hr","ticker/price","ticker/bookTicker","contract/index","contract/depth","contract/depth/merged","contract/trades","contract/klines","contract/ticker/24hr","option/index","option/depth","option/depth/merged","option/trades","option/klines","option/ticker/24hr"]},contract:{get:["insurance","fundingRate","openOrders","historyOrders","getOrder","myTrades","positions","account"],post:["order","modifyMargin"],delete:["order/cancel","order/batchCancel"]},option:{get:["openOrders","positions","historyOrders","myTrades","settlements","account"],post:["order"],delete:["order/cancel"]},private:{get:["order","openOrders","historyOrders","account","myTrades","depositOrders","withdrawalOrders","withdraw/detail","balance_flow"],post:["order","order/test","userDataStream","subAccount/query","transfer","user/transfer","withdraw"],put:["userDataStream"],delete:["order","userDataStream"]}},precisionMode:w,fees:{trading:{tierBased:!1,percentage:!0,maker:.001,taker:.001}},exceptions:{exact:{"-1000":a,"-1001":a,"-1002":r,"-1003":b,"-1004":d,"-1005":g,"-1006":l,"-1007":m,"-1014":u,"-1015":b,"-1016":p,"-1020":f,"-1021":d,"-1022":r,"-1100":d,"-1101":d,"-1102":d,"-1103":d,"-1104":d,"-1105":d,"-1106":d,"-1111":d,"-1112":h,"-1114":u,"-1115":u,"-1116":u,"-1117":u,"-1118":u,"-1119":u,"-1120":d,"-1121":c,"-1125":r,"-1127":d,"-1128":d,"-1130":d,"-1131":y,"-1132":u,"-1133":u,"-1134":u,"-1135":u,"-1136":u,"-1137":u,"-1138":u,"-1139":u,"-1140":u,"-1141":u,"-1142":u,"-1143":n,"-1144":u,"-1145":u,"-1146":m,"-1147":m,"-1149":u,"-1187":v,"-2010":u,"-2011":u,"-2013":n,"-2014":r,"-2015":r,"-2016":a}},options:{fetchTickers:{method:"quoteGetTicker24hr"}},commonCurrencies:{MIS:"Themis Protocol"}})}async fetchTime(e={}){const t=await this.publicGetTime(e);return this.safeInteger(t,"serverTime")}parseMarket(e,t="spot"){const s=this.safeValue(e,"filters",[]),i=this.safeString(e,"symbol");let r=this.safeString(e,"baseAsset");const a=this.safeString(e,"quoteAsset");let n=this.safeCurrencyCode(r);const o=this.safeCurrencyCode(a);let c=n+"/"+o,d=!0,h=!1,u=!1,l=!1;"future"===t?(c=i,d=!1,h=!0,l=this.safeValue(e,"inverse",!1),r=this.safeString(e,"underlying"),n=this.safeCurrencyCode(r)):"option"===t&&(c=i,d=!1,u=!0);const f=this.safeValue(e,"allowMargin",void 0);let p,m,b,g,y,v,w=!0;!0===this.safeValue(e,"isAggregate",void 0)&&(w=!1);for(let e=0;e<s.length;e++){const t=s[e],i=this.safeString(t,"filterType");"LOT_SIZE"===i&&(p=this.safeNumber(t,"minQty"),v=this.safeNumber(t,"stepSize")),"PRICE_FILTER"===i&&(m=this.safeNumber(t,"minPrice"),b=this.safeNumber(t,"maxPrice"),y=this.safeNumber(t,"tickSize"))}void 0!==p&&void 0!==m&&(g=p*m);return{id:i,symbol:c,base:n,quote:o,baseId:r,quoteId:a,active:w,type:t,spot:d,future:h,option:u,margin:f,inverse:l,precision:{price:y,amount:v,base:this.safeNumber(e,"baseAssetPrecision"),quote:this.safeNumber2(e,"quotePrecision","quoteAssetPrecision")},limits:{amount:{min:p,max:void 0},price:{min:m,max:b},cost:{min:g,max:void 0}},info:e}}async fetchMarkets(e={}){const t=await this.publicGetBrokerInfo(e),s=[],i=this.safeValue(t,"symbols",[]);for(let e=0;e<i.length;e++){const t=this.parseMarket(i[e],"spot");s.push(t)}const r=this.safeValue(t,"options",[]);for(let e=0;e<r.length;e++){const t=this.parseMarket(r[e],"option");s.push(t)}const a=this.safeValue(t,"contracts",[]);for(let e=0;e<a.length;e++){const t=this.parseMarket(a[e],"future");s.push(t)}return s}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.market(e).id};void 0!==t&&(i.limit=t);const r=await this.quoteGetDepth(this.extend(i,s)),a=this.safeInteger(r,"time");return this.parseOrderBook(r,e,a)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.quoteGetTicker24hr(this.extend(i,t));return this.parseTicker(r,s)}async fetchBidAsk(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.quoteGetTickerBookTicker(this.extend(i,t));return this.parseTicker(r,s)}async fetchBidsAsks(e,t={}){await this.loadMarkets();const s=await this.quoteGetTickerBookTicker(t);return this.parseTickers(s,e)}async fetchTickers(e,t={}){await this.loadMarkets();const s=this.safeValue(this.options,"fetchTickers",{}),i=this.safeString(s,"method","quoteGetTicker24hr"),r=this.safeString(s,"type","spot"),a=this.safeString(t,"type",r),n=this.omit(t,"type");let o=i;"future"===a?o="quoteGetContractTicker24hr":"option"===a&&(o="quoteGetOptionTicker24hr");const c=await this[o](n);return this.parseTickers(c,e)}async fetchBalance(e={}){await this.loadMarkets();const t=this.safeValue(this.options,"fetchBalance",{}),s=this.safeString(t,"type","spot"),i=this.safeString(e,"type",s),r=this.omit(e,"type");let a="privateGetAccount";"future"===i?a="contractGetAccount":"option"===i&&(a="optionGetAccount");const n=await this[a](r),o=this.safeValue(n,"balances"),c={info:n,timestamp:void 0,datetime:void 0};if(void 0!==o)for(let e=0;e<o.length;e++){const t=o[e],s=this.safeString2(t,"asset","tokenName"),i=this.safeCurrencyCode(s),r=this.account();r.free=this.safeString(t,"free"),r.used=this.safeString(t,"locked"),c[i]=r}else{const e=Object.keys(n);for(let t=0;t<e.length;t++){const s=e[t],i=this.safeCurrencyCode(s),r=n[s],a=this.account();a.free=this.safeString(r,"availableMargin"),a.total=this.safeString(r,"total"),c[i]=a}}return this.parseBalance(c,!1)}async fetchTrades(e,t,s=50,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id};void 0!==s&&(a.limit=s);const n=await this.quoteGetTrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}parseOHLCV(e,t){return[this.safeInteger(e,0),this.safeNumber(e,1),this.safeNumber(e,2),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,5)]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={symbol:a.id,interval:this.timeframes[t]};void 0!==s&&(n.startTime=s),void 0!==i&&(n.limit=i);const o=await this.quoteGetKlines(this.extend(n,r));return this.parseOHLCVs(o,a,t,s,i)}async fetchMyTrades(e,t,s,i={}){let r;await this.loadMarkets();const a={},n=this.safeString(this.options,"type","spot"),c=this.safeValue(this.options,"fetchMyTrades",{}),d=this.safeString(c,"type",n);let h=this.safeString(i,"type",d);void 0!==e&&(r=this.market(e),a.symbol=r.id,h=r.type);const u=this.omit(i,"type");void 0!==s&&(a.limit=s);let l="privateGetMyTrades";if("future"===h)l="contractGetMyTrades";else if("option"===h)l="optionGetMyTrades";else{if(void 0===e)throw new o(this.id+" fetchMyTrades() requires a `symbol` argument for "+h+" markets");const s=this.market(e);a.symbol=s.id,void 0!==t&&(a.startTime=t)}void 0!==t&&(a.startTime=t);const f=await this[l](this.extend(a,u));return this.parseTrades(f,r,t,s)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),c=s.toUpperCase(),d=t.toUpperCase(),h={symbol:n.id,side:c};let l=a,p="privatePostOrder";if("future"===n.type){if("BUY_OPEN"!==c&&"SELL_OPEN"!==c&&"BUY_CLOSE"!==c&&"SELL_CLOSE"!==c)throw new f(this.id+" createOrder() does not support order side "+s+" for "+n.type+" markets, only BUY_OPEN, SELL_OPEN, BUY_CLOSE and SELL_CLOSE are supported");if("LIMIT"!==d&&"STOP"!==d)throw new f(this.id+" createOrder() does not support order type "+t+" for "+n.type+" markets, only LIMIT and STOP are supported");const u=this.safeValue(a,"clientOrderId");if(void 0===u)throw new o(this.id+" createOrder() requires a clientOrderId parameter for "+n.type+" markets, supply clientOrderId in the params argument");const l=this.safeValue(a,"leverage");if(void 0===l&&("BUY_OPEN"===c||"SELL_OPEN"===c))throw new f(this.id+" createOrder() requires a leverage parameter for "+n.type+" markets if orderSide is BUY_OPEN or SELL_OPEN");p="contractPostOrder";const m=this.safeString(a,"priceType");void 0===m?h.price=this.priceToPrecision(e,r):(h.priceType=m,"INPUT"===m&&(h.price=this.priceToPrecision(e,r))),h.orderType=t.toUpperCase(),h.quantity=this.amountToPrecision(e,i),h.leverage=l,h.clientOrderId=u}else{"option"===n.type&&(p="optionPostOrder");const o=this.safeValue2(a,"clientOrderId","newClientOrderId");if(void 0!==o&&(h.newClientOrderId=o),h.type=d,"limit"===t)h.price=this.priceToPrecision(e,r),h.quantity=this.amountToPrecision(e,i);else if("market"===t)if("buy"===s){if(this.safeValue(this.options,"createMarketBuyOrderRequiresPrice",!0)){if(void 0===r)throw new u(this.id+" createOrder() requires the price argument with market buy orders to calculate total order cost (amount to spend), where cost = amount * price. Supply a price argument to createOrder() call if you want the cost to be calculated for you from price and amount, or, alternatively, add .options['createMarketBuyOrderRequiresPrice'] = false and supply the total cost value in the 'amount' argument (the exchange-specific behaviour)");i*=r}const e=n.precision.price;h.quantity=this.decimalToPrecision(i,k,e,this.precisionMode)}else h.quantity=this.amountToPrecision(e,i)}l=this.omit(l,["clientOrderId","newClientOrderId"]);const m=await this[p](this.extend(h,l));return this.parseOrder(m,n)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i=this.safeValue2(s,"origClientOrderId","clientOrderId"),r={},a=this.safeString(this.options,"type","spot"),n=this.safeValue(this.options,"cancelOrder",{}),c=this.safeString(n,"type",a);let d=this.safeString(s,"type",c),h=this.omit(s,"type");void 0!==i?(r.origClientOrderId=i,h=this.omit(h,["origClientOrderId","clientOrderId"])):r.orderId=e;let u="privateDeleteOrder";const l=this.safeString(h,"orderType");if(void 0!==l&&(d="future"),"future"===d){if(u="contractDeleteOrderCancel",void 0===l)throw new o(this.id+" cancelOrder() requires an orderType parameter, pass the { 'orderType': 'LIMIT' } or { 'orderType': 'STOP' } in params argument");r.orderType=l}else"option"===d&&(u="optionDeleteOrderCancel");const f=await this[u](this.extend(r,h));return this.parseOrder(f)}async fetchOpenOrders(e,t,s,i={}){let r;await this.loadMarkets();const a={},n=this.safeString(this.options,"type","spot"),o=this.safeValue(this.options,"fetchOpenOrders",{}),c=this.safeString(o,"type",n);let d=this.safeString(i,"type",c);void 0!==e&&(r=this.market(e),a.symbol=r.id,d=r.type);const h=this.omit(i,"type");void 0!==s&&(a.limit=s);let u="privateGetOpenOrders";"future"===d?u="contractGetOpenOrders":"option"===d&&(u="optionGetOpenOrders");const l=await this[u](this.extend(a,h));return this.parseOrders(l,r,t,s)}async fetchClosedOrders(e,t,s,i={}){let r;await this.loadMarkets();const a={},n=this.safeString(this.options,"type","spot"),o=this.safeValue(this.options,"fetchClosedOrders",{}),c=this.safeString(o,"type",n);let d=this.safeString(i,"type",c);void 0!==e&&(r=this.market(e),a.symbol=r.id,d=r.type);const h=this.omit(i,"type");void 0!==s&&(a.limit=s),void 0!==t&&(a.startTime=t);let u="privateGetHistoryOrders";"future"===d?u="contractGetHistoryOrders":"option"===d&&(u="optionGetHistoryOrders");const l=await this[u](this.extend(a,h));return this.parseOrders(l,r,t,s)}async fetchOrder(e,t,s={}){await this.loadMarkets();const i=this.safeValue2(s,"origClientOrderId","clientOrderId"),r={},a=this.safeString(this.options,"type","spot"),n=this.safeValue(this.options,"fetchOrder",{}),o=this.safeString(n,"type",a),c=this.safeString(s,"type",o);let d=this.omit(s,"type");void 0!==i?(r.origClientOrderId=i,d=this.omit(d,["origClientOrderId","clientOrderId"])):r.orderId=e;let h="privateGetOrder";"future"===c?h="contractGetGetOrder":"option"===c&&(h="optionGetGetOrder");const u=await this[h](this.extend(r,d));return this.parseOrder(u)}async fetchDeposits(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.currency(e)),void 0!==t&&(a.startTime=t),void 0!==s&&(a.limit=s);const n=await this.privateGetDepositOrders(this.extend(a,i));return this.parseTransactions(n,r,t,s)}async fetchWithdrawals(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.currency(e),a.token=r.id),void 0!==t&&(a.startTime=t),void 0!==s&&(a.limit=s);const n=await this.privateGetWithdrawalOrders(this.extend(a,i));return this.parseTransactions(n,r,t,s)}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a=this.currency(e),n={clientOrderId:this.safeString(r,"clientOrderId",this.uuid()),tokenId:a.id,address:s,withdrawQuantity:t};void 0!==i&&(n.addressExt=i);const o=await this.privatePostWithdraw(this.extend(n,r));return{info:o,id:this.safeString(o,"orderId")}}async fetchAccounts(e={}){const t=await this.privatePostSubAccountQuery(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"accountId"),a=this.safeString(i,"accountType");let n=a;"1"===a?n="spot":"2"===a?n="option":"3"===a&&(n="future"),s.push({id:r,type:n,currency:void 0,info:i})}return s}async fetchLedger(e,t,s,i={}){await this.loadMarkets();const r={accountType:1,accountIndex:0,fromFlowId:"",endFlowId:"",endTime:1588450533040};let a;void 0!==e&&(a=this.currency(e),r.tokenId=a.id),void 0!==t&&(r.startTime=t),void 0!==s&&(r.limit=s);const n=await this.privateGetBalanceFlow(this.extend(r,i));return this.parseLedger(n,a,t,s)}parseLedgerEntry(e,t){const s=this.safeString(e,"tokenId"),i=this.safeCurrencyCode(s,t),r=this.safeNumber(e,"change"),a=this.safeNumber(e,"total"),n=r<0?"out":"in";let o;if(void 0!==a&&void 0!==r){const e="out"===n?r:-r;o=this.sum(a,e)}const c=this.safeInteger(e,"created"),d=this.parseLedgerEntryType(this.safeString(e,"flowType"));return{id:this.safeString(e,"id"),currency:i,account:this.safeString(e,"accountId"),referenceAccount:void 0,referenceId:void 0,status:void 0,amount:r,before:o,after:a,fee:void 0,direction:n,timestamp:c,datetime:this.iso8601(c),type:d,info:e}}parseLedgerEntryType(e){return this.safeString({TRADE:"trade",FEE:"fee",TRANSFER:"transfer",DEPOSIT:"transaction",MAKER_REWARD:"rebate",PNL:"pnl",SETTLEMENT:"settlement",LIQUIDATION:"liquidation",FUNDING_SETTLEMENT:"settlement",USER_ACCOUNT_TRANSFER:"transfer",OTC_BUY_COIN:"trade",OTC_SELL_COIN:"trade",OTC_FEE:"fee",OTC_TRADE:"trade",ACTIVITY_AWARD:"referral",INVITATION_REFERRAL_BONUS:"referral",REGISTER_BONUS:"referral",AIRDROP:"airdrop",MINE_REWARD:"reward"},e,e)}parseTransactionStatus(e){return this.safeString({BROKER_AUDITING_STATUS:"pending",BROKER_REJECT_STATUS:"failed",AUDITING_STATUS:"pending",AUDIT_REJECT_STATUS:"failed",PROCESSING_STATUS:"pending",WITHDRAWAL_SUCCESS_STATUS:"ok",WITHDRAWAL_FAILURE_STATUS:"failed",BLOCK_MINING_STATUS:"ok"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"orderId"),i=this.safeString(e,"address");let r=this.safeString2(e,"addressExt","addressTag");void 0!==r&&r.length<1&&(r=void 0);const a=this.safeString(e,"fromAddress");let n=this.safeString(e,"fromAddressTag");void 0!==n&&n.length<1&&(n=void 0);const o=this.safeString(e,"tokenId"),c=this.safeCurrencyCode(o,t),d=this.safeInteger(e,"time");let h,u=this.safeString(e,"txid");""===u&&(u=void 0);let l=this.parseTransactionStatus(this.safeString(e,"statusCode"));void 0===l?(h="deposit",l="ok"):h="withdrawal";const f=this.safeNumber(e,"quantity"),p=this.safeNumber(e,"fee");let m;if(void 0!==p){const t=this.safeString(e,"feeTokenId");m={currency:this.safeCurrencyCode(t),cost:p}}return{info:e,id:s,txid:u,timestamp:d,datetime:this.iso8601(d),addressFrom:a,address:i,addressTo:i,tagFrom:n,tag:r,tagTo:r,type:h,amount:f,currency:c,status:l,updated:void 0,fee:m}}parseTicker(e,t){const s=this.safeString(e,"symbol"),i=this.safeSymbol(s,t),r=this.safeInteger(e,"time"),a=this.safeNumber(e,"openPrice"),n=this.safeNumber(e,"lastPrice");let o,c,d;void 0!==a&&void 0!==n&&(o=n-a,d=this.sum(a,n)/2,void 0!==n&&n>0&&(c=o/a*100));const h=this.safeNumber(e,"quoteVolume"),u=this.safeNumber(e,"volume"),l=this.vwap(u,h);return{symbol:i,timestamp:r,datetime:this.iso8601(r),high:this.safeNumber(e,"highPrice"),low:this.safeNumber(e,"lowPrice"),bid:this.safeNumber2(e,"bestBidPrice","bidPrice"),bidVolume:this.safeNumber(e,"bidQty"),ask:this.safeNumber2(e,"bestAskPrice","askPrice"),askVolume:this.safeNumber(e,"askQty"),vwap:l,open:a,close:n,last:n,previousClose:void 0,change:o,percentage:c,average:d,baseVolume:u,quoteVolume:h,info:e}}parseTrade(e,t){const s=this.safeString(e,"id"),i=this.safeNumber(e,"time"),r=this.safeString(e,"orderId"),a=this.safeString(e,"price"),n=this.safeString(e,"qty"),o=this.parseNumber(a),c=this.parseNumber(n),d=this.parseNumber(S.stringMul(a,n));let h,u,l;if("isBuyerMaker"in e)h=e.isBuyerMaker?"sell":"buy";else{const t=this.safeValue(e,"isMaker");void 0!==t&&(u=t?"maker":"taker");h=this.safeValue(e,"isBuyer")?"buy":"sell"}const f=this.safeNumber(e,"commission");if(void 0!==f){const t=this.safeString(e,"commissionAsset");l={cost:f,currency:this.safeCurrencyCode(t)}}let p;return void 0===p&&void 0!==t&&(p=t.symbol),{id:s,info:e,timestamp:i,datetime:this.iso8601(i),symbol:p,type:undefined,order:r,side:h,takerOrMaker:u,price:o,amount:c,cost:d,fee:l}}parseOrder(e,t){const s=this.safeString(e,"orderId"),i=this.safeString(e,"clientOrderId");let r=this.safeInteger(e,"time");void 0===r&&(r=this.safeInteger(e,"transactTime"));const a=this.safeString(e,"symbol"),n=this.safeSymbol(a,t);let o=this.safeStringLower(e,"type");const c=this.safeStringLower(e,"side");let d,h,u,l=this.safeNumber(e,"price"),f=this.safeNumber(e,"avgPrice"),p=this.safeNumber(e,"cummulativeQuoteQty");void 0===o?(o=this.safeStringLower(e,"orderType"),void 0!==t&&t.inverse&&(p=this.safeNumber(e,"executedQty"),d=void 0),0===p&&(h=0)):(d=this.safeNumber(e,"origQty"),"market"===o&&(l=void 0,"buy"===c&&(d=void 0)),h=this.safeNumber(e,"executedQty"),void 0!==h&&void 0!==d&&(u=d-h)),0===f&&(f=void 0);const m=this.parseOrderStatus(this.safeString(e,"status")),b=this.safeString(e,"timeInForce"),g=this.safeNumber(e,"stopPrice"),y={info:e,id:s,clientOrderId:i,timestamp:r,datetime:this.iso8601(r),lastTradeTimestamp:void 0,symbol:n,type:o,timeInForce:b,side:c,price:l,stopPrice:g,average:f,cost:p,amount:d,filled:h,remaining:u,status:m,trades:void 0,fee:void 0,fees:void 0},v=this.safeValue(e,"fees",[]);if(v.length>0){y.fees=[];for(let e=0;e<v.length;e++){const t=this.safeNumber(v[e],"fee");if(void 0!==t){const s=this.safeString(v[e],"feeToken"),i=this.safeCurrencyCode(s);y.fees.push({cost:t,currency:i})}}}return y}parseOrderStatus(e){return this.safeString({NEW:"open",CANCELED:"canceled",FILLED:"closed",PARTIALLY_FILLED:"open",PENDING_CANCEL:"canceled"},e,e)}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t]+"/"+this.version+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if("public"===t||"quote"===t||"contract"===t&&("insurance"===e||"fundingRate"===e))Object.keys(i).length&&(n+="?"+this.urlencode(i));else{const e=this.milliseconds();this.checkRequiredCredentials();const t=this.extend({timestamp:e},o),i=this.urlencode(t),c=this.hmac(this.encode(i),this.encode(this.secret),"sha256");t.signature=c,r={"X-BH-APIKEY":this.apiKey},"POST"===s?(a=this.urlencode(t),r=this.extend({"Content-Type":"application/x-www-form-urlencoded"},r)):n+="?"+this.urlencode(t)}return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,n,o,c,d){if(void 0!==o&&"code"in o){const e=this.safeString(o,"code");if("0"!==e){const t=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,e,t),new a(t)}}}}},8267:(e,t,s)=>{"use strict";const i=s(8819),{BadSymbol:r,PermissionDenied:a,ExchangeError:n,ExchangeNotAvailable:o,OrderNotFound:c,InsufficientFunds:d,InvalidOrder:h,RequestTimeout:u,AuthenticationError:l}=s(3449),{TRUNCATE:f,DECIMAL_PLACES:p,TICK_SIZE:m}=s(2115),b=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"hitbtc",name:"HitBTC",countries:["HK"],rateLimit:1500,version:"2",pro:!0,has:{cancelOrder:!0,CORS:!1,createDepositAddress:!0,createOrder:!0,editOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!1,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrder:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!1,fetchOrderTrades:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTradingFee:!0,fetchTransactions:!0,fetchWithdrawals:!1,withdraw:!0,transfer:!0},timeframes:{"1m":"M1","3m":"M3","5m":"M5","15m":"M15","30m":"M30","1h":"H1","4h":"H4","1d":"D1","1w":"D7","1M":"1M"},urls:{logo:"https://user-images.githubusercontent.com/1294454/27766555-8eaec20e-5edc-11e7-9c5b-6dc69fc42f5e.jpg",test:{public:"https://api.demo.hitbtc.com",private:"https://api.demo.hitbtc.com"},api:{public:"https://api.hitbtc.com",private:"https://api.hitbtc.com"},www:"https://hitbtc.com",referral:"https://hitbtc.com/?ref_id=5a5d39a65d466",doc:["https://api.hitbtc.com","https://github.com/hitbtc-com/hitbtc-api/blob/master/APIv2.md"],fees:["https://hitbtc.com/fees-and-limits","https://support.hitbtc.com/hc/en-us/articles/115005148605-Fees-and-limits"]},api:{public:{get:["currency","currency/{currency}","symbol","symbol/{symbol}","ticker","ticker/{symbol}","trades","trades/{symbol}","orderbook","orderbook/{symbol}","candles","candles/{symbol}"]},private:{get:["trading/balance","order","order/{clientOrderId}","trading/fee/all","trading/fee/{symbol}","margin/account","margin/account/{symbol}","margin/position","margin/position/{symbol}","margin/order","margin/order/{clientOrderId}","history/order","history/trades","history/order/{orderId}/trades","account/balance","account/crypto/address/{currency}","account/crypto/addresses/{currency}","account/crypto/used-addresses/{currency}","account/crypto/estimate-withdraw","account/crypto/is-mine/{address}","account/transactions","account/transactions/{id}","sub-acc","sub-acc/acl","sub-acc/balance/{subAccountUserID}","sub-acc/deposit-address/{subAccountUserId}/{currency}"],post:["order","margin/order","account/crypto/address/{currency}","account/crypto/withdraw","account/crypto/transfer-convert","account/transfer","account/transfer/internal","sub-acc/freeze","sub-acc/activate","sub-acc/transfer"],put:["order/{clientOrderId}","margin/account/{symbol}","margin/order/{clientOrderId}","account/crypto/withdraw/{id}","sub-acc/acl/{subAccountUserId}"],delete:["order","order/{clientOrderId}","margin/account","margin/account/{symbol}","margin/position","margin/position/{symbol}","margin/order","margin/order/{clientOrderId}","account/crypto/withdraw/{id}"],patch:["order/{clientOrderId}"]}},precisionMode:m,fees:{trading:{tierBased:!1,percentage:!0,maker:.001,taker:.002}},options:{defaultTimeInForce:"FOK",accountsByType:{bank:"bank",exchange:"exchange",main:"bank",trading:"exchange"},fetchBalanceMethod:{account:"account",main:"account",trading:"trading"}},commonCurrencies:{AUTO:"Cube",BCC:"BCC",BET:"DAO.Casino",BOX:"BOX Token",CPT:"Cryptaur",GET:"Themis",HSR:"HC",IQ:"IQ.Cash",LNC:"LinkerCoin",PLA:"PlayChip",PNT:"Penta",SBTC:"Super Bitcoin",STX:"Stox",TV:"Tokenville",USD:"USDT",XPNT:"PNT"},exceptions:{504:u,1002:l,1003:a,2010:h,2001:r,2011:h,2020:h,20002:c,20001:d}})}feeToPrecision(e,t){return this.decimalToPrecision(t,f,8,p)}async fetchMarkets(e={}){const t=await this.publicGetSymbol(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"id"),a=this.safeString(i,"baseCurrency"),n=this.safeString(i,"quoteCurrency"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n);let d=o+"/"+c;r.indexOf("_")>=0&&(d=r);const h=this.safeString(i,"quantityIncrement"),u=this.safeString(i,"tickSize"),l=this.parseNumber(h),f=this.parseNumber(u),p={price:f,amount:l},m=this.safeNumber(i,"takeLiquidityRate"),g=this.safeNumber(i,"provideLiquidityRate"),y=this.safeString(i,"feeCurrency"),v=this.safeCurrencyCode(y);s.push(this.extend(this.fees.trading,{info:i,id:r,symbol:d,base:o,quote:c,baseId:a,quoteId:n,active:!0,taker:m,maker:g,precision:p,feeCurrency:v,limits:{amount:{min:l,max:void 0},price:{min:f,max:void 0},cost:{min:this.parseNumber(b.stringMul(h,u)),max:void 0}}}))}return s}async transfer(e,t,s,i,r={}){await this.loadMarkets();const a=this.currency(e),o=this.currencyToPrecision(e,t),c={currency:a.id,amount:o};let d=this.safeString(r,"type");if(void 0===d){const e=this.safeValue(this.options,"accountsByType",{}),t=this.safeString(e,s),r=this.safeString(e,i),a=Object.keys(e);if(void 0===t)throw new n(this.id+" fromAccount must be one of "+a.join(", ")+" instead of "+t);if(void 0===r)throw new n(this.id+" toAccount must be one of "+a.join(", ")+" instead of "+r);if(t===r)throw new n(this.id+" from and to cannot be the same account");d=t+"To"+this.capitalize(r)}c.type=d;const h=await this.privatePostAccountTransfer(this.extend(c,r));return{info:h,id:this.safeString(h,"id"),timestamp:void 0,datetime:void 0,amount:o,currency:e,fromAccount:s,toAccount:i,status:void 0}}async fetchCurrencies(e={}){const t=await this.publicGetCurrency(e),s={};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"id"),a=this.safeInteger(i,"precisionTransfer",8),n=1/Math.pow(10,a),o=this.safeCurrencyCode(r),c=this.safeValue(i,"payinEnabled"),d=this.safeValue(i,"payoutEnabled"),h=this.safeValue(i,"transferEnabled");let u=c&&d&&h;"disabled"in i&&i.disabled&&(u=!1);let l="fiat";"crypto"in i&&i.crypto&&(l="crypto");const f=this.safeString(i,"fullName");s[o]={id:r,code:o,type:l,payin:c,payout:d,transfer:h,info:i,name:f,active:u,fee:this.safeNumber(i,"payoutFee"),precision:n,limits:{amount:{min:1/Math.pow(10,a),max:Math.pow(10,a)},withdraw:{min:void 0,max:Math.pow(10,n)}}}}return s}async fetchTradingFee(e,t={}){await this.loadMarkets();const s=this.market(e),i=this.extend({symbol:s.id},this.omit(t,"symbol")),r=await this.privateGetTradingFeeSymbol(i);return{info:r,maker:this.safeNumber(r,"provideLiquidityRate"),taker:this.safeNumber(r,"takeLiquidityRate")}}async fetchBalance(e={}){await this.loadMarkets();const t=this.safeString(e,"type","trading"),s=this.safeValue(this.options,"fetchBalanceMethod",{}),i=this.safeString(s,t);if(void 0===i)throw new n(this.id+" fetchBalance account type must be either main or trading");const r="privateGet"+this.capitalize(i)+"Balance",a=this.omit(e,"type"),o=await this[r](a),c={info:o,timestamp:void 0,datetime:void 0};for(let e=0;e<o.length;e++){const t=o[e],s=this.safeString(t,"currency"),i=this.safeCurrencyCode(s),r=this.account();r.free=this.safeString(t,"available"),r.used=this.safeString(t,"reserved"),c[i]=r}return this.parseBalance(c,!1)}parseOHLCV(e,t){return[this.parse8601(this.safeString(e,"timestamp")),this.safeNumber(e,"open"),this.safeNumber(e,"max"),this.safeNumber(e,"min"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={symbol:a.id,period:this.timeframes[t]};void 0!==s&&(n.from=this.iso8601(s)),void 0!==i&&(n.limit=i);const o=await this.publicGetCandlesSymbol(this.extend(n,r));return this.parseOHLCVs(o,a,t,s,i)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.marketId(e)};void 0!==t&&(i.limit=t);const r=await this.publicGetOrderbookSymbol(this.extend(i,s));return this.parseOrderBook(r,e,void 0,"bid","ask","price","size")}parseTicker(e,t){const s=this.parse8601(e.timestamp);let i;void 0!==t&&(i=t.symbol);const r=this.safeNumber(e,"volume"),a=this.safeNumber(e,"volumeQuote"),n=this.safeNumber(e,"open"),o=this.safeNumber(e,"last");let c,d,h;void 0!==o&&void 0!==n&&(c=o-n,h=this.sum(o,n)/2,n>0&&(d=c/n*100));const u=this.vwap(r,a);return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"bid"),bidVolume:void 0,ask:this.safeNumber(e,"ask"),askVolume:void 0,vwap:u,open:n,close:o,last:o,previousClose:void 0,change:c,percentage:d,average:h,baseVolume:r,quoteVolume:a,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTicker(t),i={};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"symbol"),a=this.safeMarket(r);i[a.symbol]=this.parseTicker(t,a)}return this.filterByArray(i,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.publicGetTickerSymbol(this.extend(i,t));if("message"in r)throw new n(this.id+" "+r.message);return this.parseTicker(r,s)}parseTrade(e,t){const s=this.parse8601(e.timestamp),i=this.safeString(e,"symbol"),r=(t=this.safeMarket(i,t)).symbol;let a;const n=this.safeNumber(e,"fee");if(void 0!==n){a={cost:n,currency:t?t.feeCurrency:void 0}}const o=this.safeString(e,"clientOrderId"),c=this.safeString(e,"price"),d=this.safeString(e,"quantity"),h=this.parseNumber(c),u=this.parseNumber(d),l=this.parseNumber(b.stringMul(c,d)),f=this.safeString(e,"side");return{info:e,id:this.safeString(e,"id"),order:o,timestamp:s,datetime:this.iso8601(s),symbol:r,type:void 0,side:f,takerOrMaker:void 0,price:h,amount:u,cost:l,fee:a}}async fetchTransactions(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.currency(e),a.asset=r.id),void 0!==t&&(a.startTime=t);const n=await this.privateGetAccountTransactions(this.extend(a,i));return this.parseTransactions(n,r,t,s)}parseTransaction(e,t){const s=this.safeString(e,"id"),i=this.parse8601(this.safeString(e,"createdAt")),r=this.parse8601(this.safeString(e,"updatedAt")),a=this.safeString(e,"currency"),n=this.safeCurrencyCode(a,t),o=this.parseTransactionStatus(this.safeString(e,"status")),c=this.safeNumber(e,"amount"),d=this.safeString(e,"address"),h=this.safeString(e,"hash");let u;const l=this.safeNumber(e,"fee");void 0!==l&&(u={cost:l,currency:n});const f=this.parseTransactionType(this.safeString(e,"type"));return{info:e,id:s,txid:h,timestamp:i,datetime:this.iso8601(i),address:d,tag:void 0,type:f,amount:c,currency:n,status:o,updated:r,fee:u}}parseTransactionStatus(e){return this.safeString({pending:"pending",failed:"failed",success:"ok"},e,e)}parseTransactionType(e){return this.safeString({payin:"deposit",payout:"withdrawal",withdraw:"withdrawal"},e,e)}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id};void 0!==s&&(a.limit=s),void 0!==t&&(a.sort="ASC",a.from=this.iso8601(t));const n=await this.publicGetTradesSymbol(this.extend(a,i));return this.parseTrades(n,r,t,s)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e);let o=this.uuid().split("-").join("");o=o.slice(0,32),i=parseFloat(i);const c={clientOrderId:o,symbol:n.id,side:s,quantity:this.amountToPrecision(e,i),type:t};"limit"===t?c.price=this.priceToPrecision(e,r):c.timeInForce=this.options.defaultTimeInForce;const d=await this.privatePostOrder(this.extend(c,a)),u=this.parseOrder(d);if("rejected"===u.status)throw new h(this.id+" order was rejected by the exchange "+this.json(u));return u}async editOrder(e,t,s,i,r,a,n={}){await this.loadMarkets();let o=this.uuid().split("-").join("");o=o.slice(0,32);const c={clientOrderId:e,requestClientId:o};void 0!==r&&(c.quantity=this.amountToPrecision(t,r)),void 0!==a&&(c.price=this.priceToPrecision(t,a));const d=await this.privatePatchOrderClientOrderId(this.extend(c,n));return this.parseOrder(d)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={clientOrderId:e},r=await this.privateDeleteOrderClientOrderId(this.extend(i,s));return this.parseOrder(r)}parseOrderStatus(e){return this.safeString({new:"open",suspended:"open",partiallyFilled:"open",filled:"closed",canceled:"canceled",expired:"failed"},e,e)}parseOrder(e,t){const s=this.parse8601(this.safeString(e,"createdAt")),i=this.parse8601(this.safeString(e,"updatedAt")),r=this.safeString(e,"symbol"),a=(t=this.safeMarket(r,t)).symbol,n=this.safeNumber(e,"quantity"),o=this.safeNumber(e,"cumQuantity"),c=this.parseOrderStatus(this.safeString(e,"status")),d=this.safeString(e,"clientOrderId"),h=d,u=this.safeNumber(e,"price"),l=this.safeString(e,"type"),f=this.safeString(e,"side");let p=this.safeValue(e,"tradesReport");const m=this.safeNumber(e,"avgPrice");void 0!==p&&(p=this.parseTrades(p,t));const b=this.safeString(e,"timeInForce");return this.safeOrder({id:d,clientOrderId:h,timestamp:s,datetime:this.iso8601(s),lastTradeTimestamp:i,status:c,symbol:a,type:l,timeInForce:b,side:f,price:u,stopPrice:void 0,average:m,amount:n,cost:void 0,filled:o,remaining:void 0,fee:undefined,trades:p,info:e})}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={clientOrderId:e},r=await this.privateGetHistoryOrder(this.extend(i,s));if(r.length>0)return this.parseOrder(r[0]);throw new c(this.id+" order "+e+" not found")}async fetchOpenOrder(e,t,s={}){await this.loadMarkets();const i={clientOrderId:e},r=await this.privateGetOrderClientOrderId(this.extend(i,s));return this.parseOrder(r)}async fetchOpenOrders(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.market(e),a.symbol=r.id);const n=await this.privateGetOrder(this.extend(a,i));return this.parseOrders(n,r,t,s)}async fetchClosedOrders(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.market(e),a.symbol=r.id),void 0!==s&&(a.limit=s),void 0!==t&&(a.from=this.iso8601(t));const n=await this.privateGetHistoryOrder(this.extend(a,i)),o=this.parseOrders(n,r),c=[];for(let e=0;e<o.length;e++){const t=o[e],s=t.status;"closed"!==s&&"canceled"!==s||c.push(t)}return this.filterBySinceLimit(c,t,s)}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.market(e),r.symbol=a.id),void 0!==t&&(r.from=this.iso8601(t)),void 0!==s&&(r.limit=s);const n=await this.privateGetHistoryTrades(this.extend(r,i));return this.parseTrades(n,a,t,s)}async fetchOrderTrades(e,t,s,i,r={}){let a;await this.loadMarkets(),void 0!==t&&(a=this.market(t));const n={orderId:e},o=await this.privateGetHistoryOrderOrderIdTrades(this.extend(n,r));if(o.length>0)return this.parseTrades(o,a,s,i);throw new c(this.id+" order "+e+" not found, "+this.id+'.fetchOrderTrades() requires an exchange-specific order id, you need to grab it from order["info"]["id"]')}async createDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e),i={currency:s.id},r=await this.privatePostAccountCryptoAddressCurrency(this.extend(i,t)),a=this.safeString(r,"address");this.checkAddress(a);return{currency:s,address:a,tag:this.safeString(r,"paymentId"),info:r}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e),i={currency:s.id},r=await this.privateGetAccountCryptoAddressCurrency(this.extend(i,t)),a=this.safeString(r,"address");this.checkAddress(a);const n=this.safeString(r,"paymentId");return{currency:s.code,address:a,tag:n,info:r}}async withdraw(e,t,s,i,r={}){await this.loadMarkets(),this.checkAddress(s);const a={currency:this.currency(e).id,amount:parseFloat(t),address:s};i&&(a.paymentId=i);const n=await this.privatePostAccountCryptoWithdraw(this.extend(a,r));return{info:n,id:n.id}}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n="/api/"+this.version+"/";const o=this.omit(i,this.extractParams(e));if("public"===t)n+=t+"/"+this.implodeParams(e,i),Object.keys(o).length&&(n+="?"+this.urlencode(o));else{this.checkRequiredCredentials(),n+=this.implodeParams(e,i),"GET"===s?Object.keys(o).length&&(n+="?"+this.urlencode(o)):Object.keys(o).length&&(a=this.json(o));const t=this.encode(this.apiKey+":"+this.secret),c=this.stringToBase64(t);r={Authorization:"Basic "+this.decode(c),"Content-Type":"application/json"}}return n=this.urls.api[t]+n,{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,a,c,d,u){if(void 0!==c&&e>=400){const t=this.id+" "+a;if(503===e||504===e)throw new o(t);if(429===e)return;if("{"===a[0]&&"error"in c){const e=this.safeString(c.error,"code");this.throwExactlyMatchedException(this.exceptions,e,t);if("Duplicate clientOrderId"===this.safeString(c.error,"message"))throw new h(t)}throw new n(t)}}}},4693:(e,t,s)=>{"use strict";const i=s(8819),{BadRequest:r,AuthenticationError:a,NetworkError:n,ArgumentsRequired:o,OrderNotFound:c,InsufficientFunds:d}=s(3449),{TICK_SIZE:h}=s(2115),u=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"hollaex",name:"HollaEx",countries:["KR"],rateLimit:333,version:"v2",has:{CORS:!1,cancelAllOrders:!0,cancelOrder:!0,createLimitBuyOrder:!0,createLimitSellOrder:!0,createMarketBuyOrder:!0,createMarketSellOrder:!0,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchDepositAddress:"emulated",fetchDeposits:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrder:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrderBooks:!0,fetchOrders:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTransactions:!1,fetchWithdrawals:!0,withdraw:!0,fetchDepositAddresses:!0},timeframes:{"1h":"1h","1d":"1d"},urls:{logo:"https://user-images.githubusercontent.com/1294454/75841031-ca375180-5ddd-11ea-8417-b975674c23cb.jpg",api:"https://api.hollaex.com",www:"https://hollaex.com",doc:"https://apidocs.hollaex.com",referral:"https://pro.hollaex.com/signup?affiliation_code=QSWA6G"},precisionMode:h,requiredCredentials:{apiKey:!0,secret:!0},api:{public:{get:["health","constants","kit","tiers","ticker","tickers","orderbook","orderbooks","trades","chart","charts","udf/config","udf/history","udf/symbols"]},private:{get:["user","user/balance","user/deposits","user/withdrawals","user/withdrawal/fee","user/trades","orders","orders/{order_id}"],post:["user/request-withdrawal","order"],delete:["order/all","order"]}},fees:{trading:{tierBased:!0,percentage:!0,taker:.001,maker:.001}},exceptions:{broad:{"Invalid token":a,"Order not found":c,"Insufficient balance":d},exact:{400:r,403:a,404:r,405:r,410:r,429:r,500:n,503:n}},options:{"api-expires":parseInt(this.timeout/1e3)}})}async fetchMarkets(e={}){const t=await this.publicGetConstants(e),s=this.safeValue(t,"pairs",{}),i=Object.keys(s),r=[];for(let e=0;e<i.length;e++){const t=s[i[e]],a=this.safeString(t,"name"),n=this.safeString(t,"pair_base"),o=this.safeString(t,"pair_2"),c=this.commonCurrencyCode(n.toUpperCase()),d=this.commonCurrencyCode(o.toUpperCase()),h=c+"/"+d,u=this.safeValue(t,"active"),l=this.fees.trading.maker,f=this.fees.trading.taker;r.push({id:a,symbol:h,base:c,quote:d,baseId:n,quoteId:o,active:u,precision:{price:this.safeNumber(t,"increment_price"),amount:this.safeNumber(t,"increment_size")},limits:{amount:{min:this.safeNumber(t,"min_size"),max:this.safeNumber(t,"max_size")},price:{min:this.safeNumber(t,"min_price"),max:this.safeNumber(t,"max_price")},cost:{min:void 0,max:void 0}},taker:f,maker:l,info:t})}return r}async fetchCurrencies(e={}){const t=await this.publicGetConstants(e),s=this.safeValue(t,"coins",{}),i=Object.keys(s),r={};for(let e=0;e<i.length;e++){const t=s[i[e]],a=this.safeString(t,"symbol"),n=this.safeInteger(t,"id"),o=this.safeCurrencyCode(a),c=this.safeString(t,"fullname"),d=this.safeValue(t,"active"),h=this.safeNumber(t,"withdrawal_fee"),u=this.safeNumber(t,"increment_unit"),l=this.safeValue(t,"withdrawal_limits",[]);r[o]={id:a,numericId:n,code:o,info:t,name:c,active:d,fee:h,precision:u,limits:{amount:{min:this.safeNumber(t,"min"),max:this.safeNumber(t,"max")},withdraw:{min:void 0,max:this.safeValue(l,0)}}}}return r}async fetchOrderBooks(e,t,s={}){await this.loadMarkets();const i=await this.publicGetOrderbooks(s),r={},a=Object.keys(i);for(let e=0;e<a.length;e++){const t=a[e],s=i[t],n=this.safeSymbol(t,void 0,"-"),o=this.parse8601(this.safeString(s,"timestamp"));r[n]=this.parseOrderBook(i[t],o)}return r}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.marketId(e),r={symbol:i},a=await this.publicGetOrderbooks(this.extend(r,s)),n=this.safeValue(a,i),o=this.parse8601(this.safeString(n,"timestamp"));return this.parseOrderBook(n,e,o)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.publicGetTicker(this.extend(i,t));return this.parseTicker(r,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTickers(this.extend(t));return this.parseTickers(s,e)}parseTickers(e,t,s={}){const i={},r=Object.keys(e);for(let t=0;t<r.length;t++){const a=r[t],n=e[a],o=this.safeString(n,"symbol",a),c=this.safeMarket(o,void 0,"-");i[c.symbol]=this.extend(this.parseTicker(n,c),s)}return this.filterByArray(i,"symbol",t)}parseTicker(e,t){const s=this.safeString(e,"symbol"),i=this.safeSymbol(s,t,"-"),r=this.parse8601(this.safeString2(e,"time","timestamp")),a=this.safeNumber(e,"close");return{symbol:i,info:e,timestamp:r,datetime:this.iso8601(r),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:void 0,bidVolume:void 0,ask:void 0,askVolume:void 0,vwap:void 0,open:this.safeNumber(e,"open"),close:a,last:this.safeNumber(e,"last",a),previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(e,"volume"),quoteVolume:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id},n=await this.publicGetTrades(this.extend(a,i)),o=this.safeValue(n,r.id,[]);return this.parseTrades(o,r,t,s)}parseTrade(e,t){const s=this.safeString(e,"symbol"),i=(t=this.safeMarket(s,t,"-")).symbol,r=this.safeString(e,"timestamp"),a=this.parse8601(r),n=this.safeString(e,"side"),o=this.safeString(e,"price"),c=this.safeString(e,"size"),d=this.parseNumber(o),h=this.parseNumber(c),l=this.parseNumber(u.stringMul(o,c)),f=this.safeNumber(e,"fee");let p;if(void 0!==f){const e=t.quote;p={cost:f,currency:void 0!==t?t.quote:e}}return{info:e,id:void 0,timestamp:a,datetime:r,symbol:i,order:void 0,type:void 0,side:n,takerOrMaker:void 0,price:d,amount:h,cost:l,fee:p}}async fetchOHLCV(e,t="1h",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={symbol:a.id,resolution:this.timeframes[t]},c=this.parseTimeframe(t);if(void 0===s){if(void 0===i)throw new o(this.id+" fetchOHLCV() requires a 'since' or a 'limit' argument");{const e=this.seconds(),t=e-c*i;n.to=e,n.from=t}}else if(void 0===i)n.from=parseInt(s/1e3),n.to=this.seconds();else{const e=parseInt(s/1e3);n.from=e,n.to=this.sum(e,c*i)}const d=await this.publicGetChart(this.extend(n,r));return this.parseOHLCVs(d,a,t,s,i)}parseOHLCV(e,t,s="1h",i,r){return[this.parse8601(this.safeString(e,"time")),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetUserBalance(e),s=this.parse8601(this.safeString(t,"updated_at")),i={info:t,timestamp:s,datetime:this.iso8601(s)},r=Object.keys(this.currencies_by_id);for(let e=0;e<r.length;e++){const s=r[e],a=this.safeCurrencyCode(s),n=this.account();n.free=this.safeString(t,s+"_available"),n.total=this.safeString(t,s+"_balance"),i[a]=n}return this.parseBalance(i,!1)}async fetchOpenOrder(e,t,s={}){await this.loadMarkets();const i={order_id:e},r=await this.privateGetOrdersOrderId(this.extend(i,s));return this.parseOrder(r)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({open:!0},i))}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({status:"filled"},i))}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={order_id:e},r=await this.privateGetOrders(this.extend(i,s)),a=this.safeValue(r,"data",[]),n=this.safeValue(a,0);if(void 0===n)throw new c(this.id+" fetchOrder() could not find order id "+e);return this.parseOrder(n)}async fetchOrders(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.market(e),a.symbol=r.id),void 0!==t&&(a.start_date=this.iso8601(t)),void 0!==s&&(a.limit=s);const n=await this.privateGetOrders(this.extend(a,i)),o=this.safeValue(n,"data",[]);return this.parseOrders(o,r,t,s)}parseOrderStatus(e){return this.safeString({new:"open",pfilled:"open",filled:"closed",canceled:"canceled"},e,e)}parseOrder(e,t){const s=this.safeString(e,"symbol"),i=this.safeSymbol(s,t,"-"),r=this.safeString(e,"id"),a=this.parse8601(this.safeString(e,"created_at")),n=this.safeString(e,"type"),o=this.safeString(e,"side"),c=this.safeNumber(e,"price"),d=this.safeNumber(e,"size"),h=this.safeNumber(e,"filled"),u=this.parseOrderStatus(this.safeString(e,"status"));return this.safeOrder({id:r,clientOrderId:void 0,timestamp:a,datetime:this.iso8601(a),lastTradeTimestamp:void 0,status:u,symbol:i,type:n,timeInForce:void 0,postOnly:void 0,side:o,price:c,stopPrice:void 0,amount:d,filled:h,remaining:void 0,cost:void 0,trades:void 0,fee:void 0,info:e,average:void 0})}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o={symbol:n.id,side:s,size:i,type:t};"market"!==t&&(o.price=r);const c=this.safeFloat2(a,"stopPrice","stop");void 0!==c&&(o.stop=parseFloat(this.priceToPrecision(e,c)),a=this.omit(a,["stopPrice","stop"]));const d=await this.privatePostOrder(this.extend(o,a));return this.parseOrder(d,n)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={order_id:e},r=await this.privateDeleteOrder(this.extend(i,s));return this.parseOrder(r)}async cancelAllOrders(e,t={}){await this.loadMarkets();const s={};let i;void 0!==e&&(i=this.market(e),s.symbol=i.id);const r=await this.privateDeleteOrderAll(this.extend(s,t));return this.parseOrders(r,i)}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.market(e),r.symbol=a.id),void 0!==s&&(r.limit=s),void 0!==t&&(r.start_date=this.iso8601(t));const n=await this.privateGetUserTrades(this.extend(r,i)),o=this.safeValue(n,"data",[]);return this.parseTrades(o,a,t,s)}parseDepositAddress(e,t){let s,i=this.safeString(e,"address");if(void 0!==i){const e=i.split(":");i=this.safeString(e,0),s=this.safeString(e,1)}this.checkAddress(i);const r=this.safeString(e,"currency");t=this.safeCurrency(r,t);const a=this.safeString(e,"network");return{currency:t.code,address:i,tag:s,network:a,info:e}}async fetchDepositAddresses(e,t={}){await this.loadMarkets();const s=this.safeString(t,"network");t=this.omit(t,"network");const i=await this.privateGetUser(t),r=this.safeValue(i,"wallet",[]),a=void 0===s?r:this.filterBy(r,"network",s);return this.parseDepositAddresses(a,e)}async fetchDeposits(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.currency=a.id),void 0!==s&&(r.limit=s),void 0!==t&&(r.start_date=this.iso8601(t));const n=await this.privateGetUserDeposits(this.extend(r,i)),o=this.safeValue(n,"data",[]);return this.parseTransactions(o,a,t,s)}async fetchWithdrawals(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.currency=a.id),void 0!==s&&(r.limit=s),void 0!==t&&(r.start_date=this.iso8601(t));const n=await this.privateGetUserWithdrawals(this.extend(r,i)),o=this.safeValue(n,"data",[]);return this.parseTransactions(o,a,t,s)}parseTransaction(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"transaction_id"),r=this.parse8601(this.safeString(e,"created_at")),a=this.parse8601(this.safeString(e,"updated_at")),n=this.safeString(e,"type"),o=this.safeNumber(e,"amount");let c,d=this.safeString(e,"address");let h,u;if(void 0!==d){const e=d.split(":");d=this.safeString(e,0),h=this.safeString(e,1),c=d,u=h}const l=this.safeString(e,"currency"),f=this.safeCurrencyCode(l);let p=this.safeValue(e,"status");const m=this.safeValue(e,"dismissed"),b=this.safeValue(e,"rejected");p=p?"ok":m?"canceled":b?"failed":"pending";const g={currency:f,cost:this.safeNumber(e,"fee")};return{info:e,id:s,txid:i,timestamp:r,datetime:this.iso8601(r),addressFrom:undefined,address:d,addressTo:c,tagFrom:undefined,tag:h,tagTo:u,type:n,amount:o,currency:f,status:p,updated:a,fee:g}}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();void 0!==i&&(s+=":"+i);const a={currency:this.currency(e).id,amount:t,address:s};let n=this.safeString(r,"otp_code");void 0===n&&void 0===this.twofa||(void 0===n&&(n=this.oath()),a.otp_code=n);return{info:await this.privatePostUserRequestWithdrawal(this.extend(a,r)),id:void 0}}sign(e,t="public",s="GET",i={},r,a){const n=this.omit(i,this.extractParams(e));e="/"+this.version+"/"+this.implodeParams(e,i),"GET"!==s&&"DELETE"!==s||Object.keys(n).length&&(e+="?"+this.urlencode(n));const o=this.urls.api+e;if("private"===t){this.checkRequiredCredentials();const t=this.safeInteger2(this.options,"api-expires","expires",parseInt(this.timeout/1e3)),i=this.sum(this.seconds(),t).toString();let o=s+e+i;r={"api-key":this.encode(this.apiKey),"api-expires":i},"POST"===s&&(r["Content-type"]="application/json",Object.keys(n).length&&(o+=a=this.json(n)));const c=this.hmac(this.encode(o),this.encode(this.secret));r["api-signature"]=c}return{url:o,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,a,n,o,c){if(void 0!==n&&e>=400&&e<=503){const t=this.id+" "+a,s=this.safeString(n,"message");this.throwBroadlyMatchedException(this.exceptions.broad,s,t);const i=e.toString();this.throwExactlyMatchedException(this.exceptions.exact,i,t)}}}},4072:(e,t,s)=>{"use strict";const i=s(3775),{NotSupported:r}=s(3449);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"huobijp",name:"Huobi Japan",countries:["JP"],hostname:"api-cloud.huobi.co.jp",pro:!0,has:{fetchDepositAddress:!1},urls:{logo:"https://user-images.githubusercontent.com/1294454/85734211-85755480-b705-11ea-8b35-0b7f1db33a2f.jpg",api:{market:"https://{hostname}",public:"https://{hostname}",private:"https://{hostname}"},www:"https://www.huobi.co.jp",referral:"https://www.huobi.co.jp/register/?invite_code=znnq3",doc:"https://api-doc.huobi.co.jp",fees:"https://www.huobi.co.jp/support/fee"}})}async fetchDepositAddress(e,t={}){throw new r(this.id+" fetchDepositAddress not supported yet")}}},3775:(e,t,s)=>{"use strict";const i=s(8819),{AuthenticationError:r,ExchangeError:a,PermissionDenied:n,ExchangeNotAvailable:o,OnMaintenance:c,InvalidOrder:d,OrderNotFound:h,InsufficientFunds:u,ArgumentsRequired:l,BadSymbol:f,BadRequest:p,RequestTimeout:m,NetworkError:b}=s(3449),{TRUNCATE:g}=s(2115),y=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"huobipro",name:"Huobi Pro",countries:["CN"],rateLimit:2e3,userAgent:this.userAgents.chrome39,version:"v1",accounts:void 0,accountsById:void 0,hostname:"api.huobi.pro",pro:!0,has:{cancelAllOrders:!0,cancelOrder:!0,cancelOrders:!0,CORS:!1,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchOrderTrades:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTradingLimits:!0,fetchWithdrawals:!0,withdraw:!0},timeframes:{"1m":"1min","5m":"5min","15m":"15min","30m":"30min","1h":"60min","4h":"4hour","1d":"1day","1w":"1week","1M":"1mon","1y":"1year"},urls:{test:{market:"https://api.testnet.huobi.pro",public:"https://api.testnet.huobi.pro",private:"https://api.testnet.huobi.pro"},logo:"https://user-images.githubusercontent.com/1294454/76137448-22748a80-604e-11ea-8069-6e389271911d.jpg",api:{market:"https://{hostname}",public:"https://{hostname}",private:"https://{hostname}",v2Public:"https://{hostname}",v2Private:"https://{hostname}"},www:"https://www.huobi.com",referral:"https://www.huobi.com/en-us/topic/invited/?invite_code=rwrd3",doc:["https://huobiapi.github.io/docs/spot/v1/cn/","https://huobiapi.github.io/docs/dm/v1/cn/","https://huobiapi.github.io/docs/coin_margined_swap/v1/cn/","https://huobiapi.github.io/docs/usdt_swap/v1/cn/","https://huobiapi.github.io/docs/option/v1/cn/"],fees:"https://www.huobi.com/about/fee/"},api:{v2Public:{get:["reference/currencies","market-status"]},v2Private:{get:["account/ledger","account/withdraw/quota","account/withdraw/address","account/deposit/address","account/repayment","reference/transact-fee-rate","account/asset-valuation","point/account","sub-user/user-list","sub-user/user-state","sub-user/account-list","sub-user/deposit-address","sub-user/query-deposit","user/api-key","user/uid","algo-orders/opening","algo-orders/history","algo-orders/specific","c2c/offers","c2c/offer","c2c/transactions","c2c/repayment","c2c/account","etp/reference","etp/transactions","etp/transaction","etp/rebalance","etp/limit"],post:["account/transfer","account/repayment","point/transfer","sub-user/management","sub-user/creation","sub-user/tradable-market","sub-user/transferability","sub-user/api-key-generation","sub-user/api-key-modification","sub-user/api-key-deletion","sub-user/deduct-mode","algo-orders","algo-orders/cancel-all-after","algo-orders/cancellation","c2c/offer","c2c/cancellation","c2c/cancel-all","c2c/repayment","c2c/transfer","etp/creation","etp/redemption","etp/{transactId}/cancel","etp/batch-cancel"]},market:{get:["history/kline","detail/merged","depth","trade","history/trade","detail","tickers","etp"]},public:{get:["common/symbols","common/currencys","common/timestamp","common/exchange","settings/currencys"]},private:{get:["account/accounts","account/accounts/{id}/balance","account/accounts/{sub-uid}","account/history","cross-margin/loan-info","margin/loan-info","fee/fee-rate/get","order/openOrders","order/orders","order/orders/{id}","order/orders/{id}/matchresults","order/orders/getClientOrder","order/history","order/matchresults","dw/withdraw-virtual/addresses","query/deposit-withdraw","margin/loan-info","margin/loan-orders","margin/accounts/balance","cross-margin/loan-orders","cross-margin/accounts/balance","points/actions","points/orders","subuser/aggregate-balance","stable-coin/exchange_rate","stable-coin/quote"],post:["account/transfer","futures/transfer","order/batch-orders","order/orders/place","order/orders/submitCancelClientOrder","order/orders/batchCancelOpenOrders","order/orders","order/orders/{id}/place","order/orders/{id}/submitcancel","order/orders/batchcancel","dw/balance/transfer","dw/withdraw/api/create","dw/withdraw-virtual/create","dw/withdraw-virtual/{id}/place","dw/withdraw-virtual/{id}/cancel","dw/transfer-in/margin","dw/transfer-out/margin","margin/orders","margin/orders/{id}/repay","cross-margin/transfer-in","cross-margin/transfer-out","cross-margin/orders","cross-margin/orders/{id}/repay","stable-coin/exchange","subuser/transfer"]}},fees:{trading:{feeSide:"get",tierBased:!1,percentage:!0,maker:.002,taker:.002}},exceptions:{broad:{"contract is restricted of closing positions on API.  Please contact customer service":c,maintain:c},exact:{"bad-request":p,"base-date-limit-error":p,"api-not-support-temp-addr":n,timeout:m,"gateway-internal-error":o,"account-frozen-balance-insufficient-error":u,"invalid-amount":d,"order-limitorder-amount-min-error":d,"order-limitorder-amount-max-error":d,"order-marketorder-amount-min-error":d,"order-limitorder-price-min-error":d,"order-limitorder-price-max-error":d,"order-holding-limit-failed":d,"order-orderprice-precision-error":d,"order-etp-nav-price-max-error":d,"order-orderstate-error":h,"order-queryorder-invalid":h,"order-update-error":o,"api-signature-check-failed":r,"api-signature-not-valid":r,"base-record-invalid":h,"base-symbol-trade-disabled":f,"base-symbol-error":f,"system-maintenance":c,"invalid symbol":f,"symbol trade not open now":f}},options:{fetchOrdersByStatesMethod:"private_get_order_orders",fetchOpenOrdersMethod:"fetch_open_orders_v1",createMarketBuyOrderRequiresPrice:!0,fetchMarketsMethod:"publicGetCommonSymbols",fetchBalanceMethod:"privateGetAccountAccountsIdBalance",createOrderMethod:"privatePostOrderOrdersPlace",language:"en-US"},commonCurrencies:{GET:"Themis",GTC:"Game.com",HIT:"HitChain",HOT:"Hydro Protocol",PNT:"Penta",SBTC:"Super Bitcoin",BIFI:"Bitcoin File"}})}async fetchTradingLimits(e,t={}){await this.loadMarkets(),void 0===e&&(e=this.symbols);const s={};for(let i=0;i<e.length;i++){const r=e[i];s[r]=await this.fetchTradingLimitsById(this.marketId(r),t)}return s}async fetchTradingLimitsById(e,t={}){const s={symbol:e},i=await this.publicGetCommonExchange(this.extend(s,t));return this.parseTradingLimits(this.safeValue(i,"data",{}))}parseTradingLimits(e,t,s={}){return{info:e,limits:{amount:{min:this.safeNumber(e,"limit-order-must-greater-than"),max:this.safeNumber(e,"limit-order-must-less-than")}}}}costToPrecision(e,t){return this.decimalToPrecision(t,g,this.markets[e].precision.cost,this.precisionMode)}async fetchMarkets(e={}){const t=this.options.fetchMarketsMethod,s=await this[t](e),i=this.safeValue(s,"data");if(i.length<1)throw new b(this.id+" publicGetCommonSymbols returned empty response: "+this.json(i));const r=[];for(let e=0;e<i.length;e++){const t=i[e],s=this.safeString(t,"base-currency"),a=this.safeString(t,"quote-currency"),n=s+a,o=this.safeCurrencyCode(s),c=this.safeCurrencyCode(a),d=o+"/"+c,h={amount:this.safeInteger(t,"amount-precision"),price:this.safeInteger(t,"price-precision"),cost:this.safeInteger(t,"value-precision")},u="OMG"===o?0:.002,l="OMG"===o?0:.002,f=this.safeNumber(t,"min-order-amt",Math.pow(10,-h.amount)),p=this.safeNumber(t,"max-order-amt"),m=this.safeNumber(t,"min-order-value",0),b="online"===this.safeString(t,"state");r.push({id:n,symbol:d,base:o,quote:c,baseId:s,quoteId:a,active:b,precision:h,taker:l,maker:u,limits:{amount:{min:f,max:p},price:{min:Math.pow(10,-h.price),max:void 0},cost:{min:m,max:void 0}},info:t})}return r}parseTicker(e,t){let s;void 0!==t&&(s=t.symbol);const i=this.safeInteger(e,"ts");let r,a,n,o;"bid"in e&&(Array.isArray(e.bid)?(r=this.safeNumber(e.bid,0),a=this.safeNumber(e.bid,1)):(r=this.safeNumber(e,"bid"),a=this.safeValue(e,"bidSize"))),"ask"in e&&(Array.isArray(e.ask)?(n=this.safeNumber(e.ask,0),o=this.safeNumber(e.ask,1)):(n=this.safeNumber(e,"ask"),o=this.safeValue(e,"askSize")));const c=this.safeNumber(e,"open"),d=this.safeNumber(e,"close");let h,u,l;void 0!==c&&void 0!==d&&(h=d-c,l=this.sum(c,d)/2,void 0!==d&&d>0&&(u=h/c*100));const f=this.safeNumber(e,"amount"),p=this.safeNumber(e,"vol"),m=this.vwap(f,p);return{symbol:s,timestamp:i,datetime:this.iso8601(i),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:r,bidVolume:a,ask:n,askVolume:o,vwap:m,open:c,close:d,last:d,previousClose:void 0,change:h,percentage:u,average:l,baseVolume:f,quoteVolume:p,info:e}}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.market(e).id,type:"step0"},r=await this.marketGetDepth(this.extend(i,s));if("tick"in r){if(!r.tick)throw new f(this.id+" fetchOrderBook() returned empty response: "+this.json(r));const t=this.safeValue(r,"tick"),s=this.safeInteger(t,"ts",this.safeInteger(r,"ts")),i=this.parseOrderBook(t,e,s);return i.nonce=this.safeInteger(t,"version"),i}throw new a(this.id+" fetchOrderBook() returned unrecognized response: "+this.json(r))}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.marketGetDetailMerged(this.extend(i,t)),a=this.parseTicker(r.tick,s),n=this.safeInteger(r,"ts");return a.timestamp=n,a.datetime=this.iso8601(n),a}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.marketGetTickers(t),i=this.safeValue(s,"data"),r=this.safeInteger(s,"ts"),a={};for(let e=0;e<i.length;e++){const t=this.safeString(i[e],"symbol"),s=this.safeMarket(t),n=s.symbol,o=this.parseTicker(i[e],s);o.timestamp=r,o.datetime=this.iso8601(r),a[n]=o}return this.filterByArray(a,"symbol",e)}parseTrade(e,t){const s=this.safeString(e,"symbol"),i=this.safeSymbol(s,t),r=this.safeInteger2(e,"ts","created-at"),a=this.safeString(e,"order-id");let n=this.safeString(e,"direction"),o=this.safeString(e,"type");if(void 0!==o){const e=o.split("-");n=e[0],o=e[1]}const c=this.safeString(e,"role"),d=this.safeString(e,"price"),h=this.safeString2(e,"filled-amount","amount"),u=this.parseNumber(d),l=this.parseNumber(h),f=this.parseNumber(y.stringMul(d,h));let p,m=this.safeNumber(e,"filled-fees"),b=this.safeCurrencyCode(this.safeString(e,"fee-currency"));const g=this.safeNumber(e,"filled-points");void 0!==g&&(void 0!==m&&0!==m||(m=g,b=this.safeCurrencyCode(this.safeString(e,"fee-deduct-currency")))),void 0!==m&&(p={cost:m,currency:b});const v=this.safeString2(e,"trade-id","tradeId");return{id:this.safeString(e,"id",v),info:e,order:a,timestamp:r,datetime:this.iso8601(r),symbol:i,type:o,side:n,takerOrMaker:c,price:u,amount:l,cost:f,fee:p}}async fetchOrderTrades(e,t,s,i,r={}){await this.loadMarkets();const a={id:e},n=await this.privateGetOrderOrdersIdMatchresults(this.extend(a,r));return this.parseTrades(n.data,void 0,s,i)}async fetchMyTrades(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.market(e),a.symbol=r.id),void 0!==s&&(a.size=s),void 0!==t&&(a["start-date"]=this.ymd(t),a["end-date"]=this.ymd(this.sum(t,864e5)));const n=await this.privateGetOrderMatchresults(this.extend(a,i));return this.parseTrades(n.data,r,t,s)}async fetchTrades(e,t,s=1e3,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id};void 0!==s&&(a.size=s);const n=await this.marketGetHistoryTrade(this.extend(a,i)),o=this.safeValue(n,"data");let c=[];for(let e=0;e<o.length;e++){const t=this.safeValue(o[e],"data",[]);for(let e=0;e<t.length;e++){const s=this.parseTrade(t[e],r);c.push(s)}}return c=this.sortBy(c,"timestamp"),this.filterBySymbolSinceLimit(c,e,t,s)}parseOHLCV(e,t){return[this.safeTimestamp(e,"id"),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"amount")]}async fetchOHLCV(e,t="1m",s,i=1e3,r={}){await this.loadMarkets();const a=this.market(e),n={symbol:a.id,period:this.timeframes[t]};void 0!==i&&(n.size=i);const o=await this.marketGetHistoryKline(this.extend(n,r)),c=this.safeValue(o,"data",[]);return this.parseOHLCVs(c,a,t,s,i)}async fetchAccounts(e={}){await this.loadMarkets();return(await this.privateGetAccountAccounts(e)).data}async fetchCurrencies(e={}){const t={language:this.options.language},s=await this.publicGetSettingsCurrencys(this.extend(t,e)),i=this.safeValue(s,"data"),r={};for(let e=0;e<i.length;e++){const t=i[e],s=this.safeValue(t,"name"),a=this.safeInteger(t,"withdraw-precision"),n=this.safeCurrencyCode(s),o=t.visible&&t["deposit-enabled"]&&t["withdraw-enabled"],c=this.safeString(t,"display-name");r[n]={id:s,code:n,type:"crypto",name:c,active:o,fee:void 0,precision:a,limits:{amount:{min:Math.pow(10,-a),max:Math.pow(10,a)},deposit:{min:this.safeNumber(t,"deposit-min-amount"),max:Math.pow(10,a)},withdraw:{min:this.safeNumber(t,"withdraw-min-amount"),max:Math.pow(10,a)}},info:t}}return r}async fetchBalance(e={}){await this.loadMarkets(),await this.loadAccounts();const t=this.options.fetchBalanceMethod,s={id:this.accounts[0].id},i=await this[t](this.extend(s,e)),r=this.safeValue(i.data,"list",[]),a={info:i};for(let e=0;e<r.length;e++){const t=r[e],s=this.safeString(t,"currency"),i=this.safeCurrencyCode(s);let n;n=i in a?a[i]:this.account(),"trade"===t.type&&(n.free=this.safeString(t,"balance")),"frozen"===t.type&&(n.used=this.safeString(t,"balance")),a[i]=n}return this.parseBalance(a,!1)}async fetchOrdersByStates(e,t,s,i,r={}){await this.loadMarkets();const a={states:e};let n;void 0!==t&&(n=this.market(t),a.symbol=n.id);const o=this.safeString(this.options,"fetchOrdersByStatesMethod","private_get_order_orders"),c=await this[o](this.extend(a,r));return this.parseOrders(c.data,n,s,i)}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={id:e},r=await this.privateGetOrderOrdersId(this.extend(i,s)),a=this.safeValue(r,"data");return this.parseOrder(a)}async fetchOrders(e,t,s,i={}){return await this.fetchOrdersByStates("pre-submitted,submitted,partial-filled,filled,partial-canceled,canceled",e,t,s,i)}async fetchOpenOrders(e,t,s,i={}){const r=this.safeString(this.options,"fetchOpenOrdersMethod","fetch_open_orders_v1");return await this[r](e,t,s,i)}async fetchOpenOrdersV1(e,t,s,i={}){if(void 0===e)throw new l(this.id+" fetchOpenOrdersV1() requires a symbol argument");return await this.fetchOrdersByStates("pre-submitted,submitted,partial-filled",e,t,s,i)}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrdersByStates("filled,partial-canceled,canceled",e,t,s,i)}async fetchOpenOrdersV2(e,t,s,i={}){if(await this.loadMarkets(),void 0===e)throw new l(this.id+" fetchOpenOrders() requires a symbol argument");const r=this.market(e);let a=this.safeString(i,"account-id");if(void 0===a){await this.loadAccounts();for(let e=0;e<this.accounts.length;e++){const t=this.accounts[e];if("spot"===t.type&&(a=this.safeString(t,"id"),void 0!==a))break}}const n={symbol:r.id,"account-id":a};void 0!==s&&(n.size=s);const o=this.omit(i,"account-id"),c=await this.privateGetOrderOpenOrders(this.extend(n,o)),d=this.safeValue(c,"data",[]);return this.parseOrders(d,r,t,s)}parseOrderStatus(e){return this.safeString({"partial-filled":"open","partial-canceled":"canceled",filled:"closed",canceled:"canceled",submitted:"open"},e,e)}parseOrder(e,t){const s=this.safeString(e,"id");let i,r,a;if("type"in e){const t=e.type.split("-");i=t[0],r=t[1],a=this.parseOrderStatus(this.safeString(e,"state"))}const n=this.safeString(e,"symbol"),o=this.safeSymbol(n,t),c=this.safeInteger(e,"created-at"),d=this.safeNumber(e,"amount"),h=this.safeNumber2(e,"filled-amount","field-amount");let u=this.safeNumber(e,"price");0===u&&(u=void 0);const l=this.safeNumber2(e,"filled-cash-amount","field-cash-amount"),f=this.safeNumber2(e,"filled-fees","field-fees");let p;if(void 0!==f){let e;void 0!==t&&(e="sell"===i?t.quote:t.base),p={cost:f,currency:e}}return this.safeOrder({info:e,id:s,clientOrderId:void 0,timestamp:c,datetime:this.iso8601(c),lastTradeTimestamp:void 0,symbol:o,type:r,timeInForce:void 0,postOnly:void 0,side:i,price:u,stopPrice:void 0,average:void 0,cost:l,amount:d,filled:h,remaining:void 0,status:a,fee:p,trades:void 0})}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets(),await this.loadAccounts();const n=this.market(e),o={"account-id":this.accounts[0].id,symbol:n.id,type:s+"-"+t},c=this.safeString2(a,"clientOrderId","client-order-id");if(void 0!==c&&(o["client-order-id"]=c),a=this.omit(a,["clientOrderId","client-order-id"]),"market"===t&&"buy"===s)if(this.options.createMarketBuyOrderRequiresPrice){if(void 0===r)throw new d(this.id+" market buy order requires price argument to calculate cost (total amount of quote currency to spend for buying, amount * price). To switch off this warning exception and specify cost in the amount argument, set .options['createMarketBuyOrderRequiresPrice'] = false. Make sure you know what you're doing.");o.amount=this.costToPrecision(e,parseFloat(i)*parseFloat(r))}else o.amount=this.costToPrecision(e,i);else o.amount=this.amountToPrecision(e,i);"limit"!==t&&"ioc"!==t&&"limit-maker"!==t||(o.price=this.priceToPrecision(e,r));const h=this.options.createOrderMethod,u=await this[h](this.extend(o,a)),l=this.milliseconds();return{info:u,id:this.safeString(u,"data"),timestamp:l,datetime:this.iso8601(l),lastTradeTimestamp:void 0,status:void 0,symbol:e,type:t,side:s,price:r,amount:i,filled:void 0,remaining:void 0,cost:void 0,trades:void 0,fee:void 0,clientOrderId:void 0,average:void 0}}async cancelOrder(e,t,s={}){const i=await this.privatePostOrderOrdersIdSubmitcancel({id:e});return this.extend(this.parseOrder(i),{id:e,status:"canceled"})}async cancelOrders(e,t,s={}){await this.loadMarkets();const i=this.safeValue2(s,"clientOrderIds","client-order-ids");s=this.omit(s,["clientOrderIds","client-order-ids"]);const r={};void 0===i?r["order-ids"]=e:r["client-order-ids"]=i;return await this.privatePostOrderOrdersBatchcancel(this.extend(r,s))}async cancelAllOrders(e,t={}){await this.loadMarkets();const s={};let i;void 0!==e&&(i=this.market(e),s.symbol=i.id);return await this.privatePostOrderOrdersBatchCancelOpenOrders(this.extend(s,t))}currencyToPrecision(e,t){return this.decimalToPrecision(t,0,this.currencies[e].precision)}parseDepositAddress(e,t){const s=this.safeString(e,"address"),i=this.safeString(e,"addressTag"),r=this.safeString(e,"currency"),a=this.safeCurrencyCode(r);return this.checkAddress(s),{currency:a,address:s,tag:i,info:e}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e),i={currency:s.id},r=await this.v2PrivateGetAccountDepositAddress(this.extend(i,t)),a=this.safeValue(r,"data",[]);return this.parseDepositAddress(this.safeValue(a,0,{}),s)}async fetchDeposits(e,t,s,i={}){let r;(void 0===s||s>100)&&(s=100),await this.loadMarkets(),void 0!==e&&(r=this.currency(e));const a={type:"deposit",from:0};void 0!==r&&(a.currency=r.id),void 0!==s&&(a.size=s);const n=await this.privateGetQueryDepositWithdraw(this.extend(a,i));return this.parseTransactions(n.data,r,t,s)}async fetchWithdrawals(e,t,s,i={}){let r;(void 0===s||s>100)&&(s=100),await this.loadMarkets(),void 0!==e&&(r=this.currency(e));const a={type:"withdraw",from:0};void 0!==r&&(a.currency=r.id),void 0!==s&&(a.size=s);const n=await this.privateGetQueryDepositWithdraw(this.extend(a,i));return this.parseTransactions(n.data,r,t,s)}parseTransaction(e,t){const s=this.safeInteger(e,"created-at"),i=this.safeInteger(e,"updated-at"),r=this.safeCurrencyCode(this.safeString(e,"currency"));let a=this.safeString(e,"type");"withdraw"===a&&(a="withdrawal");const n=this.parseTransactionStatus(this.safeString(e,"state")),o=this.safeString(e,"address-tag");let c=this.safeNumber(e,"fee");return void 0!==c&&(c=Math.abs(c)),{info:e,id:this.safeString(e,"id"),txid:this.safeString(e,"tx-hash"),timestamp:s,datetime:this.iso8601(s),address:this.safeString(e,"address"),tag:o,type:a,amount:this.safeNumber(e,"amount"),currency:r,status:n,updated:i,fee:{currency:r,cost:c,rate:void 0}}}parseTransactionStatus(e){return this.safeString({unknown:"failed",confirming:"pending",confirmed:"ok",safe:"ok",orphan:"failed",submitted:"pending",canceled:"canceled",reexamine:"pending",reject:"failed",pass:"pending","wallet-reject":"failed","confirm-error":"failed",repealed:"failed","wallet-transfer":"pending","pre-transfer":"pending"},e,e)}async withdraw(e,t,s,i,r={}){await this.loadMarkets(),this.checkAddress(s);const a={address:s,amount:t,currency:this.currency(e).id.toLowerCase()};void 0!==i&&(a["addr-tag"]=i);const n=await this.privatePostDwWithdrawApiCreate(this.extend(a,r));return{info:n,id:this.safeString(n,"data")}}sign(e,t="public",s="GET",i={},r,a){let n="/";"market"===t?n+=t:"public"===t||"private"===t?n+=this.version:"v2Public"!==t&&"v2Private"!==t||(n+="v2"),n+="/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if("private"===t||"v2Private"===t){this.checkRequiredCredentials();const e=this.ymdhms(this.milliseconds(),"T");let t={SignatureMethod:"HmacSHA256",SignatureVersion:"2",AccessKeyId:this.apiKey,Timestamp:e};"POST"!==s&&(t=this.extend(t,o)),t=this.keysort(t);let i=this.urlencode(t);const c=[s,this.hostname,n,i].join("\n"),d=this.hmac(this.encode(c),this.encode(this.secret),"sha256","base64");i+="&"+this.urlencode({Signature:d}),n+="?"+i,"POST"===s?(a=this.json(o),r={"Content-Type":"application/json"}):r={"Content-Type":"application/x-www-form-urlencoded"}}else Object.keys(i).length&&(n+="?"+this.urlencode(i));return n=this.implodeParams(this.urls.api[t],{hostname:this.hostname})+n,{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,n,o,c,d){if(void 0!==o&&"status"in o){if("error"===this.safeString(o,"status")){const e=this.safeString(o,"err-code"),t=this.id+" "+n;this.throwBroadlyMatchedException(this.exceptions.broad,n,t),this.throwExactlyMatchedException(this.exceptions.exact,e,t);const s=this.safeString(o,"err-msg");throw this.throwExactlyMatchedException(this.exceptions.exact,s,t),new a(t)}}}}},2574:(e,t,s)=>{"use strict";const i=s(8819),{PAD_WITH_ZERO:r}=s(2115),{InvalidOrder:a,InsufficientFunds:n,ExchangeError:o,ExchangeNotAvailable:c,DDoSProtection:d,BadRequest:h,NotSupported:u,InvalidAddress:l,AuthenticationError:f}=s(3449),p=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"idex",name:"IDEX",countries:["US"],rateLimit:1500,version:"v2",certified:!0,pro:!0,requiresWeb3:!0,has:{cancelOrder:!0,createOrder:!0,fetchBalance:!0,fetchMarkets:!0,fetchCurrencies:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchClosedOrders:!0,fetchOrders:!1,fetchOrder:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTransactions:!1,fetchDeposits:!0,fetchWithdrawals:!0,withdraw:!0},timeframes:{"1m":"1m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","6h":"6h","1d":"1d"},urls:{test:{public:"https://api-sandbox.idex.io",private:"https://api-sandbox.idex.io"},logo:"https://user-images.githubusercontent.com/51840849/94481303-2f222100-01e0-11eb-97dd-bc14c5943a86.jpg",api:{ETH:"https://api-eth.idex.io",BSC:"https://api-bsc.idex.io"},www:"https://idex.io",doc:["https://docs.idex.io/"]},api:{public:{get:["ping","time","exchange","assets","markets","tickers","candles","trades","orderbook","wsToken"]},private:{get:["user","wallets","balances","orders","fills","deposits","withdrawals"],post:["wallets","orders","orders/test","withdrawals"],delete:["orders"]}},options:{defaultTimeInForce:"gtc",defaultSelfTradePrevention:"cn",network:"ETH"},exceptions:{INVALID_ORDER_QUANTITY:a,INSUFFICIENT_FUNDS:n,SERVICE_UNAVAILABLE:c,EXCEEDED_RATE_LIMIT:d,INVALID_PARAMETER:h,WALLET_NOT_ASSOCIATED:l,INVALID_WALLET_SIGNATURE:f},requiredCredentials:{walletAddress:!0,privateKey:!0,apiKey:!0,secret:!0},paddingMode:r,commonCurrencies:{},requireCredentials:{privateKey:!0,apiKey:!0,secret:!0}})}async fetchMarkets(e={}){const t=await this.publicGetMarkets(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"market"),a=this.safeString(i,"baseAsset"),n=this.safeString(i,"quoteAsset"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d=o+"/"+c,h=this.safeString(i,"baseAssetPrecision"),u=this.safeString(i,"quoteAssetPrecision"),l=this.parsePrecision(h),f=this.parsePrecision(u),p="active"===this.safeString(i,"status"),m={amount:parseInt(h),price:parseInt(u)};s.push({symbol:d,id:r,base:o,quote:c,baseId:a,quoteId:n,active:p,info:i,precision:m,limits:{amount:{min:this.parseNumber(l),max:void 0},price:{min:this.parseNumber(f),max:void 0},cost:{min:void 0,max:void 0}}})}return s}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={market:s.id},r=await this.publicGetTickers(this.extend(i,t)),a=this.safeValue(r,0);return this.parseTicker(a,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTickers(t);return this.parseTickers(s,e)}parseTicker(e,t){const s=this.safeString(e,"market"),i=this.safeSymbol(s,t,"-"),r=this.safeNumber(e,"baseVolume"),a=this.safeNumber(e,"quoteVolume"),n=this.safeInteger(e,"time"),o=this.safeNumber(e,"open"),c=this.safeNumber(e,"high"),d=this.safeNumber(e,"low"),h=this.safeNumber(e,"close"),u=this.safeNumber(e,"ask"),l=this.safeNumber(e,"bid");let f,p=this.safeNumber(e,"percentChange");return void 0!==p&&(p=1+p/100),void 0!==h&&void 0!==o&&(f=h-o),{symbol:i,timestamp:n,datetime:this.iso8601(n),high:c,low:d,bid:l,bidVolume:void 0,ask:u,askVolume:void 0,vwap:void 0,open:o,close:h,last:h,previousClose:void 0,change:f,percentage:p,average:void 0,baseVolume:r,quoteVolume:a,info:e}}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={market:a.id,interval:t};void 0!==s&&(n.start=s),void 0!==i&&(n.limit=i);const o=await this.publicGetCandles(this.extend(n,r));return Array.isArray(o)?this.parseOHLCVs(o,a,t,s,i):[]}parseOHLCV(e,t){return[this.safeInteger(e,"start"),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={market:r.id};void 0!==t&&(a.start=t),void 0!==s&&(a.limit=s);const n=await this.publicGetTrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}parseTrade(e,t){const s=this.safeString(e,"fillId"),i=this.safeString(e,"price"),r=this.safeString(e,"quantity"),a=this.parseNumber(i),n=this.parseNumber(r);let o=this.safeNumber(e,"quoteQuantity");void 0===o&&(o=this.parseNumber(p.stringMul(i,r)));const c=this.safeInteger(e,"time"),d=this.safeString(e,"market"),h=this.safeSymbol(d,t,"-"),u="buy"===this.safeString(e,"makerSide")?"sell":"buy",l=this.safeString(e,"side",u),f=this.safeString(e,"liquidity","taker"),m=this.safeNumber(e,"fee");let b;if(void 0!==m){const t=this.safeString(e,"feeAsset");b={cost:m,currency:this.safeCurrencyCode(t)}}const g=this.safeString(e,"orderId");return{info:e,timestamp:c,datetime:this.iso8601(c),symbol:h,id:s,order:g,type:"limit",side:l,takerOrMaker:f,price:a,amount:n,cost:o,fee:b}}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={market:this.market(e).id,level:2};void 0!==t&&(i.limit=t);const r=await this.publicGetOrderbook(this.extend(i,s));return{symbol:e,timestamp:void 0,datetime:void 0,nonce:this.safeInteger(r,"sequence"),bids:this.parseSide(r,"bids"),asks:this.parseSide(r,"asks")}}parseSide(e,t){const s=this.safeValue(e,t,[]),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeNumber(t,0),a=this.safeNumber(t,1),n=this.safeInteger(t,2);i.push([r,a,n])}const r="bids"===t;return this.sortBy(i,0,r)}async fetchCurrencies(e={}){const t=await this.publicGetAssets(e),s={};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"name"),a=this.safeString(i,"symbol"),n=this.safeString(i,"exchangeDecimals"),o=this.safeCurrencyCode(a),c=this.parsePrecision(n),d=this.parseNumber(c);s[o]={id:a,code:o,info:i,type:void 0,name:r,active:void 0,fee:void 0,precision:parseInt(n),limits:{amount:{min:d,max:void 0},withdraw:{min:d,max:void 0}}}}return s}async fetchBalance(e={}){this.checkRequiredCredentials(),await this.loadMarkets();const t={nonce:this.uuidv1(),wallet:this.walletAddress},s=this.extend(t,e);if(void 0===s.wallet)throw new h(this.id+' wallet is undefined, set this.walletAddress or "address" in params');let i;try{i=await this.privateGetBalances(s)}catch(e){if(!(e instanceof l))throw e;{const e=s.wallet;await this.associateWallet(e),i=await this.privateGetBalances(s)}}const r={info:i,timestamp:void 0,datetime:void 0};for(let e=0;e<i.length;e++){const t=i[e],s=this.safeString(t,"asset"),a=this.safeCurrencyCode(s),n=this.account();n.total=this.safeString(t,"quantity"),n.free=this.safeString(t,"availableForTrade"),n.used=this.safeString(t,"locked"),r[a]=n}return this.parseBalance(r,!1)}async fetchMyTrades(e,t,s,i={}){let r;this.checkRequiredCredentials(),await this.loadMarkets();const a={nonce:this.uuidv1(),wallet:this.walletAddress};void 0!==e&&(r=this.market(e),a.market=r.id),void 0!==t&&(a.start=t),void 0!==s&&(a.limit=s);const n=this.extend(a,i);if(void 0===n.wallet)throw new h(this.id+' walletAddress is undefined, set this.walletAddress or "address" in params');let o;try{o=await this.privateGetFills(n)}catch(e){if(!(e instanceof l))throw e;{const e=n.wallet;await this.associateWallet(e),o=await this.privateGetFills(n)}}return this.parseTrades(o,r,t,s)}async fetchOrder(e,t,s={}){const i={orderId:e};return await this.fetchOrdersHelper(t,void 0,void 0,this.extend(i,s))}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrdersHelper(e,t,s,this.extend({closed:!1},i))}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrdersHelper(e,t,s,this.extend({closed:!0},i))}async fetchOrdersHelper(e,t,s,i={}){await this.loadMarkets();const r={nonce:this.uuidv1(),wallet:this.walletAddress};let a;void 0!==e&&(a=this.market(e),r.market=a.id),void 0!==t&&(r.start=t),void 0!==s&&(r.limit=s);const n=await this.privateGetOrders(this.extend(r,i));return Array.isArray(n)?this.parseOrders(n,a,t,s):this.parseOrder(n,a)}parseOrderStatus(e){return this.safeString({active:"open",partiallyFilled:"open",rejected:"canceled",filled:"closed"},e,e)}parseOrder(e,t){const s=this.safeInteger(e,"time"),i=this.safeValue(e,"fills",[]),r=this.safeString(e,"orderId"),a=this.safeString(e,"clientOrderId"),n=this.safeString(e,"market"),o=this.safeString(e,"side"),c=this.safeSymbol(n,t,"-"),d=this.parseTrades(i,t),h=this.safeString(e,"type"),u=this.safeNumber(e,"originalQuantity"),l=this.safeNumber(e,"executedQuantity"),f=this.safeNumber(e,"avgExecutionPrice"),p=this.safeNumber(e,"price"),m=this.safeString(e,"status"),b=this.parseOrderStatus(m);return this.safeOrder({info:e,id:r,clientOrderId:a,timestamp:s,datetime:this.iso8601(s),lastTradeTimestamp:void 0,symbol:c,type:h,timeInForce:void 0,postOnly:void 0,side:o,price:p,stopPrice:void 0,amount:u,cost:void 0,average:f,filled:l,remaining:void 0,status:b,fee:void 0,trades:d})}async associateWallet(e,t={}){const s=this.uuidv1(),i=this.remove0xPrefix(e),r=[this.base16ToBinary(s),this.base16ToBinary(i)],a=this.binaryConcatArray(r),n=this.hash(a,"keccak","hex"),o={parameters:{nonce:s,wallet:e},signature:this.signMessageString(n,this.privateKey)};return await this.privatePostWallets(o)}async createOrder(e,t,s,i,r,a={}){this.checkRequiredCredentials(),await this.loadMarkets();const n=this.market(e),o=this.uuidv1();let c;const d={stopLoss:3,stopLossLimit:4,takeProfit:5,takeProfitLimit:6};let l;if("stopLossLimit"===t||"takeProfitLimit"===t||"stopPrice"in a){if(!("stopPrice"in a))throw new h(this.id+" stopPrice is a required parameter for "+t+"orders");l=this.priceToPrecision(e,a.stopPrice)}const f={limit:1,limitMaker:2};let p;const m=t.toLowerCase().indexOf("limit")>-1;if(t in f)c=f[t],p=this.priceToPrecision(e,r);else if(t in d)c=d[t],p=this.priceToPrecision(e,r);else{if("market"!==t)throw new h(this.id+" "+t+" is not a valid order type");c=0}let b=0;if("quoteOrderQuantity"in a){if("market"!==t)throw new u(this.id+" quoteOrderQuantity is not supported for "+t+" orders, only supported for market orders");b=1,i=this.safeNumber(a,"quoteOrderQuantity")}const g="buy"===s?0:1,y=this.remove0xPrefix(this.walletAddress),v="ETH"===this.safeString(this.options,"network","ETH")?1:2,w=this.amountToPrecision(e,i),k={gtc:0,ioc:2,fok:3},S=this.safeString(this.options,"defaultTimeInForce","gtc"),_=this.safeString(a,"timeInForce",S);let O;if(!(_ in k)){const e=Object.keys(k).join(", ");throw new h(this.id+" "+_+" is not a valid timeInForce, please choose one of "+e)}O=k[_];const T={dc:0,co:1,cn:2,cb:3},x=this.safeString(this.options,"defaultSelfTradePrevention","cn"),C=this.safeString(a,"selfTradePrevention",x);let I;if(!(C in T)){const e=Object.keys(T).join(", ");throw new h(this.id+" "+C+" is not a valid selfTradePrevention, please choose one of "+e)}I=T[C];const M=[this.numberToBE(v,1),this.base16ToBinary(o),this.base16ToBinary(y),this.stringToBinary(this.encode(n.id)),this.numberToBE(c,1),this.numberToBE(g,1),this.stringToBinary(this.encode(w)),this.numberToBE(b,1)];if(m){const e=this.stringToBinary(this.encode(p));M.push(e)}if(t in d){const e=this.stringToBinary(this.encode(l||p));M.push(e)}const N=this.safeString(a,"clientOrderId");void 0!==N&&M.push(this.stringToBinary(this.encode(N)));const A=[this.numberToBE(O,1),this.numberToBE(I,1),this.numberToBE(0,8)],E=this.arrayConcat(M,A),P=this.binaryConcatArray(E),B=this.hash(P,"keccak","hex"),V=this.signMessageString(B,this.privateKey),L={parameters:{nonce:o,market:n.id,side:s,type:t,wallet:this.walletAddress,timeInForce:_,selfTradePrevention:C},signature:V};m&&(L.parameters.price=p),t in d&&(L.parameters.stopPrice=l||p),0===b?L.parameters.quantity=w:L.parameters.quoteOrderQuantity=w,void 0!==N&&(L.parameters.clientOrderId=N);const q=await this.privatePostOrders(L);return this.parseOrder(q,n)}async withdraw(e,t,s,i,r={}){this.checkRequiredCredentials(),await this.loadMarkets();const a=this.uuidv1(),n=this.currencyToPrecision(e,t),o=this.currency(e),c=this.remove0xPrefix(this.walletAddress),d=[this.base16ToBinary(a),this.base16ToBinary(c),this.stringToBinary(this.encode(o.id)),this.stringToBinary(this.encode(n)),this.numberToBE(1,1)],h=this.binaryConcatArray(d),u=this.hash(h,"keccak","hex"),l=this.signMessageString(u,this.privateKey),f={parameters:{nonce:a,wallet:s,asset:o.id,quantity:n},signature:l},p=await this.privatePostWithdrawals(f);return{info:p,id:this.safeString(p,"withdrawalId")}}async cancelOrder(e,t,s={}){let i;this.checkRequiredCredentials(),await this.loadMarkets(),void 0!==t&&(i=this.market(t));const r=this.uuidv1(),a=this.remove0xPrefix(this.walletAddress),n=[this.base16ToBinary(r),this.base16ToBinary(a),this.stringToBinary(this.encode(e))],o=this.binaryConcatArray(n),c=this.hash(o,"keccak","hex"),d=this.signMessageString(c,this.privateKey),h={parameters:{nonce:r,wallet:this.walletAddress,orderId:e},signature:d},u=await this.privateDeleteOrders(this.extend(h,s)),l=this.safeValue(u,0);return this.parseOrder(l,i)}handleErrors(e,t,s,i,r,a,n,c,d){const h=this.safeString(n,"code"),u=this.safeString(n,"message");if(h in this.exceptions){throw new(0,this.exceptions[h])(this.id+" "+u)}if(void 0!==h)throw new o(this.id+" "+u)}async fetchDeposits(e,t,s,i={}){return i=this.extend({method:"privateGetDeposits"},i),this.fetchTransactionsHelper(e,t,s,i)}async fetchWithdrawals(e,t,s,i={}){return i=this.extend({method:"privateGetWithdrawals"},i),this.fetchTransactionsHelper(e,t,s,i)}async fetchTransactionsHelper(e,t,s,i={}){await this.loadMarkets();const r={nonce:this.uuidv1(),wallet:this.walletAddress};let a;void 0!==e&&(a=this.currency(e),r.asset=a.id),void 0!==t&&(r.start=t),void 0!==s&&(r.limit=s);const n=i.method;i=this.omit(i,"method");const o=await this[n](this.extend(r,i));return this.parseTransactions(o,a,t,s)}parseTransactionStatus(e){return this.safeString({mined:"ok"},e,e)}parseTransaction(e,t){let s;"depositId"in e?s="deposit":"withdrawalId"in e&&(s="withdrawal");const i=this.safeString2(e,"depositId","withdrawId"),r=this.safeCurrencyCode(this.safeString(e,"asset"),t),a=this.safeNumber(e,"quantity"),n=this.safeString(e,"txId"),o=this.safeInteger(e,"txTime");let c;"fee"in e&&(c={cost:this.safeNumber(e,"fee"),currency:"ETH"});const d=this.safeString(e,"txStatus"),h=this.parseTransactionStatus(d),u=this.safeInteger(e,"confirmationTime");return{info:e,id:i,txid:n,timestamp:o,datetime:this.iso8601(o),address:void 0,tag:void 0,type:s,amount:a,currency:r,status:h,updated:u,fee:c}}sign(e,t="public",s="GET",i={},r,a){const n=this.safeString(this.options,"network","ETH"),o=this.safeString(this.options,"version","v1");let c=this.urls.api[n]+"/"+o+"/"+e;let d;if(Object.keys(i).length>0&&("GET"===s?(d=this.urlencode(i),c=c+"?"+d):a=this.json(i)),r={"Content-Type":"application/json"},void 0!==this.apiKey&&(r["IDEX-API-Key"]=this.apiKey),"private"===t){let e;e="GET"===s?d:a,r["IDEX-HMAC-Signature"]=this.hmac(this.encode(e),this.encode(this.secret),"sha256","hex")}return{url:c,method:s,body:a,headers:r}}}},3585:(e,t,s)=>{"use strict";const i=s(8819),r=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"independentreserve",name:"Independent Reserve",countries:["AU","NZ"],rateLimit:1e3,has:{cancelOrder:!0,CORS:!1,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTrades:!0},urls:{logo:"https://user-images.githubusercontent.com/51840849/87182090-1e9e9080-c2ec-11ea-8e49-563db9a38f37.jpg",api:{public:"https://api.independentreserve.com/Public",private:"https://api.independentreserve.com/Private"},www:"https://www.independentreserve.com",doc:"https://www.independentreserve.com/API"},api:{public:{get:["GetValidPrimaryCurrencyCodes","GetValidSecondaryCurrencyCodes","GetValidLimitOrderTypes","GetValidMarketOrderTypes","GetValidOrderTypes","GetValidTransactionTypes","GetMarketSummary","GetOrderBook","GetAllOrders","GetTradeHistorySummary","GetRecentTrades","GetFxRates","GetOrderMinimumVolumes","GetCryptoWithdrawalFees"]},private:{post:["GetOpenOrders","GetClosedOrders","GetClosedFilledOrders","GetOrderDetails","GetAccounts","GetTransactions","GetFiatBankAccounts","GetDigitalCurrencyDepositAddress","GetDigitalCurrencyDepositAddresses","GetTrades","GetBrokerageFees","GetDigitalCurrencyWithdrawal","PlaceLimitOrder","PlaceMarketOrder","CancelOrder","SynchDigitalCurrencyDepositAddressWithBlockchain","RequestFiatWithdrawal","WithdrawFiatCurrency","WithdrawDigitalCurrency"]}},fees:{trading:{taker:.005,maker:.005,percentage:!0,tierBased:!1}},commonCurrencies:{PLA:"PlayChip"}})}async fetchMarkets(e={}){const t=await this.publicGetGetValidPrimaryCurrencyCodes(e),s=await this.publicGetGetValidSecondaryCurrencyCodes(e),i=await this.publicGetGetOrderMinimumVolumes(e),r=[];for(let e=0;e<t.length;e++){const a=t[e],n=this.safeCurrencyCode(a),o=this.safeNumber(i,a);for(let e=0;e<s.length;e++){const t=s[e],i=this.safeCurrencyCode(t),c=a+"/"+t,d=n+"/"+i;r.push({id:c,symbol:d,base:n,quote:i,baseId:a,quoteId:t,info:c,active:void 0,precision:this.precision,limits:{amount:{min:o,max:void 0}}})}}return r}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostGetAccounts(e),s={info:t};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"CurrencyCode"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(i,"AvailableBalance"),n.total=this.safeString(i,"TotalBalance"),s[a]=n}return this.parseBalance(s,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),r={primaryCurrencyCode:i.baseId,secondaryCurrencyCode:i.quoteId},a=await this.publicGetGetOrderBook(this.extend(r,s)),n=this.parse8601(this.safeString(a,"CreatedTimestampUtc"));return this.parseOrderBook(a,e,n,"BuyOrders","SellOrders","Price","Volume")}parseTicker(e,t){const s=this.parse8601(this.safeString(e,"CreatedTimestampUtc"));let i;t&&(i=t.symbol);const r=this.safeNumber(e,"LastPrice");return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"DayHighestPrice"),low:this.safeNumber(e,"DayLowestPrice"),bid:this.safeNumber(e,"CurrentHighestBidPrice"),bidVolume:void 0,ask:this.safeNumber(e,"CurrentLowestOfferPrice"),askVolume:void 0,vwap:void 0,open:void 0,close:r,last:r,previousClose:void 0,change:void 0,percentage:void 0,average:this.safeNumber(e,"DayAvgPrice"),baseVolume:this.safeNumber(e,"DayVolumeXbtInSecondaryCurrrency"),quoteVolume:void 0,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={primaryCurrencyCode:s.baseId,secondaryCurrencyCode:s.quoteId},r=await this.publicGetGetMarketSummary(this.extend(i,t));return this.parseTicker(r,s)}parseOrder(e,t){let s;const i=this.safeString(e,"PrimaryCurrencyCode"),r=this.safeString(e,"SecondaryCurrencyCode");let a,n;void 0!==i&&void 0!==r?(a=this.safeCurrencyCode(i),n=this.safeCurrencyCode(r),s=a+"/"+n):void 0!==t&&(s=t.symbol,a=t.base,n=t.quote);let o,c=this.safeString2(e,"Type","OrderType");c.indexOf("Bid")>=0?o="buy":c.indexOf("Offer")>=0&&(o="sell"),c.indexOf("Market")>=0?c="market":c.indexOf("Limit")>=0&&(c="limit");const d=this.parse8601(this.safeString(e,"CreatedTimestampUtc")),h=this.safeNumber2(e,"VolumeOrdered","Volume"),u=this.safeNumber(e,"VolumeFilled"),l=this.safeNumber(e,"Outstanding"),f=this.safeNumber(e,"FeePercent");let p;void 0!==f&&(p=f*u);const m={rate:f,cost:p,currency:a},b=this.safeString(e,"OrderGuid"),g=this.parseOrderStatus(this.safeString(e,"Status")),y=this.safeNumber(e,"Value"),v=this.safeNumber(e,"AvgPrice"),w=this.safeNumber(e,"Price");return this.safeOrder({info:e,id:b,clientOrderId:void 0,timestamp:d,datetime:this.iso8601(d),lastTradeTimestamp:void 0,symbol:s,type:c,timeInForce:void 0,postOnly:void 0,side:o,price:w,stopPrice:void 0,cost:y,average:v,amount:h,filled:u,remaining:l,status:g,fee:m,trades:void 0})}parseOrderStatus(e){return this.safeString({Open:"open",PartiallyFilled:"open",Filled:"closed",PartiallyFilledAndCancelled:"canceled",Cancelled:"canceled",PartiallyFilledAndExpired:"canceled",Expired:"canceled"},e,e)}async fetchOrder(e,t,s={}){await this.loadMarkets();const i=await this.privatePostGetOrderDetails(this.extend({orderGuid:e},s));let r;return void 0!==t&&(r=this.market(t)),this.parseOrder(i,r)}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r=this.ordered({});let a;void 0!==e&&(a=this.market(e),r.primaryCurrencyCode=a.baseId,r.secondaryCurrencyCode=a.quoteId),void 0===s&&(s=50),r.pageIndex=1,r.pageSize=s;const n=await this.privatePostGetOpenOrders(this.extend(r,i)),o=this.safeValue(n,"Data",[]);return this.parseOrders(o,a,t,s)}async fetchClosedOrders(e,t,s,i={}){await this.loadMarkets();const r=this.ordered({});let a;void 0!==e&&(a=this.market(e),r.primaryCurrencyCode=a.baseId,r.secondaryCurrencyCode=a.quoteId),void 0===s&&(s=50),r.pageIndex=1,r.pageSize=s;const n=await this.privatePostGetClosedOrders(this.extend(r,i)),o=this.safeValue(n,"Data",[]);return this.parseOrders(o,a,t,s)}async fetchMyTrades(e,t,s=50,i={}){await this.loadMarkets();const r=this.safeInteger(i,"pageIndex",1);void 0===s&&(s=50);const a=this.ordered({pageIndex:r,pageSize:s}),n=await this.privatePostGetTrades(this.extend(a,i));let o;return void 0!==e&&(o=this.market(e)),this.parseTrades(n.Data,o,t,s)}parseTrade(e,t){const s=this.parse8601(e.TradeTimestampUtc),i=this.safeString(e,"TradeGuid"),a=this.safeString(e,"OrderGuid"),n=this.safeString2(e,"Price","SecondaryCurrencyTradePrice"),o=this.safeString2(e,"VolumeTraded","PrimaryCurrencyAmount"),c=this.parseNumber(n),d=this.parseNumber(o),h=this.parseNumber(r.stringMul(n,o)),u=this.safeString(e,"PrimaryCurrencyCode"),l=this.safeString(e,"SecondaryCurrencyCode");let f;void 0!==u&&void 0!==l&&(f=u+"/"+l);const p=this.safeSymbol(f,t,"/");let m=this.safeString(e,"OrderType");return void 0!==m&&(m.indexOf("Bid")>=0?m="buy":m.indexOf("Offer")>=0&&(m="sell")),{id:i,info:e,timestamp:s,datetime:this.iso8601(s),symbol:p,order:a,type:void 0,side:m,takerOrMaker:void 0,price:c,amount:d,cost:h,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={primaryCurrencyCode:r.baseId,secondaryCurrencyCode:r.quoteId,numberOfRecentTradesToRetrieve:50},n=await this.publicGetGetRecentTrades(this.extend(a,i));return this.parseTrades(n.Trades,r,t,s)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o=this.capitalize(t),c="privatePostPlace"+o+"Order";let d=o;d+="sell"===s?"Offer":"Bid";const h=this.ordered({primaryCurrencyCode:n.baseId,secondaryCurrencyCode:n.quoteId,orderType:d});"limit"===t&&(h.price=r),h.volume=i;const u=await this[c](this.extend(h,a));return{info:u,id:u.OrderGuid}}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={orderGuid:e};return await this.privatePostCancelOrder(this.extend(i,s))}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t]+"/"+e;if("public"===t)Object.keys(i).length&&(n+="?"+this.urlencode(i));else{this.checkRequiredCredentials();const e=this.nonce(),t=[n,"apiKey="+this.apiKey,"nonce="+e.toString()],s=Object.keys(i);for(let e=0;e<s.length;e++){const r=s[e],a=i[r].toString();t.push(r+"="+a)}const o=t.join(","),c=this.hmac(this.encode(o),this.encode(this.secret)),d=this.ordered({});d.apiKey=this.apiKey,d.nonce=e,d.signature=c.toUpperCase();for(let e=0;e<s.length;e++){const t=s[e];d[t]=i[t]}a=this.json(d),r={"Content-Type":"application/json"}}return{url:n,method:s,body:a,headers:r}}}},4535:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,InsufficientFunds:n,InvalidOrder:o,OrderNotFound:c,AuthenticationError:d,BadSymbol:h}=s(3449),u=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"indodax",name:"INDODAX",countries:["ID"],has:{cancelOrder:!0,CORS:!1,createMarketOrder:!1,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchCurrencies:!1,fetchMarkets:!0,fetchMyTrades:!1,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!1,fetchTicker:!0,fetchTickers:!1,fetchTime:!0,fetchTrades:!0,withdraw:!0},version:"2.0",urls:{logo:"https://user-images.githubusercontent.com/51840849/87070508-9358c880-c221-11ea-8dc5-5391afbbb422.jpg",api:{public:"https://indodax.com/api",private:"https://indodax.com/tapi"},www:"https://www.indodax.com",doc:"https://github.com/btcid/indodax-official-api-docs",referral:"https://indodax.com/ref/testbitcoincoid/1"},api:{public:{get:["server_time","pairs","{pair}/ticker","{pair}/trades","{pair}/depth"]},private:{post:["getInfo","transHistory","trade","tradeHistory","getOrder","openOrders","cancelOrder","orderHistory","withdrawCoin"]}},fees:{trading:{tierBased:!1,percentage:!0,maker:0,taker:.003}},exceptions:{exact:{invalid_pair:h,"Insufficient balance.":n,"invalid order.":c,"Invalid credentials. API not found or session has expired.":d,"Invalid credentials. Bad sign.":d},broad:{"Minimum price":o,"Minimum order":o}},options:{recvWindow:5e3,timeDifference:0,adjustForTimeDifference:!1},commonCurrencies:{STR:"XLM",BCHABC:"BCH",BCHSV:"BSV",DRK:"DASH",NEM:"XEM"}})}nonce(){return this.milliseconds()-this.options.timeDifference}async fetchTime(e={}){const t=await this.publicGetServerTime(e);return this.safeInteger(t,"server_time")}async loadTimeDifference(e={}){const t=await this.fetchTime(e),s=this.milliseconds();return this.options.timeDifference=s-t,this.options.timeDifference}async fetchMarkets(e={}){const t=await this.publicGetPairs(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"ticker_id"),a=this.safeString(i,"traded_currency"),n=this.safeString(i,"base_currency"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d=o+"/"+c,h=this.safeNumber(i,"trade_fee_percent"),u=!this.safeInteger(i,"is_maintenance"),l={amount:8,price:this.safeInteger(i,"price_round")},f={amount:{min:this.safeNumber(i,"trade_min_traded_currency"),max:void 0},price:{min:this.safeNumber(i,"trade_min_base_currency"),max:void 0},cost:{min:void 0,max:void 0}};s.push({id:r,symbol:d,base:o,quote:c,baseId:a,quoteId:n,taker:h,percentage:!0,precision:l,limits:f,info:i,active:u})}return s}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostGetInfo(e),s=this.safeValue(t,"return",{}),i=this.safeValue(s,"balance",{}),r=this.safeValue(s,"balance_hold",{}),a=this.safeTimestamp(s,"server_time"),n={info:t,timestamp:a,datetime:this.iso8601(a)},o=Object.keys(i);for(let e=0;e<o.length;e++){const t=o[e],s=this.safeCurrencyCode(t),a=this.account();a.free=this.safeString(i,t),a.used=this.safeString(r,t),n[s]=a}return this.parseBalance(n,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={pair:this.marketId(e)},r=await this.publicGetPairDepth(this.extend(i,s));return this.parseOrderBook(r,e,void 0,"buy","sell")}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={pair:s.id},r=(await this.publicGetPairTicker(this.extend(i,t))).ticker,a=this.safeTimestamp(r,"server_time"),n="vol_"+s.baseId.toLowerCase(),o="vol_"+s.quoteId.toLowerCase(),c=this.safeNumber(r,"last");return{symbol:e,timestamp:a,datetime:this.iso8601(a),high:this.safeNumber(r,"high"),low:this.safeNumber(r,"low"),bid:this.safeNumber(r,"buy"),bidVolume:void 0,ask:this.safeNumber(r,"sell"),askVolume:void 0,vwap:void 0,open:void 0,close:c,last:c,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(r,n),quoteVolume:this.safeNumber(r,o),info:r}}parseTrade(e,t){const s=this.safeTimestamp(e,"date"),i=this.safeString(e,"tid");let r;void 0!==t&&(r=t.symbol);const a=this.safeString(e,"type"),n=this.safeString(e,"price"),o=this.safeString(e,"amount"),c=this.parseNumber(n),d=this.parseNumber(o),h=this.parseNumber(u.stringMul(n,o));return{id:i,info:e,timestamp:s,datetime:this.iso8601(s),symbol:r,type:undefined,side:a,order:void 0,takerOrMaker:void 0,price:c,amount:d,cost:h,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={pair:r.id},n=await this.publicGetPairTrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}parseOrderStatus(e){return this.safeString({open:"open",filled:"closed",cancelled:"canceled"},e,e)}parseOrder(e,t){let s;"type"in e&&(s=e.type);const i=this.parseOrderStatus(this.safeString(e,"status","open"));let r,a;const n=this.safeNumber(e,"price");let o,c;if(void 0!==t){r=t.symbol;let s=t.quoteId,i=t.baseId;"idr"===t.quoteId&&"order_rp"in e&&(s="rp"),"idr"===t.baseId&&"remain_rp"in e&&(i="rp"),a=this.safeNumber(e,"order_"+s),a||(o=this.safeNumber(e,"order_"+i),c=this.safeNumber(e,"remain_"+i))}const d=this.safeInteger(e,"submit_time"),h=this.safeString(e,"order_id");return this.safeOrder({info:e,id:h,clientOrderId:void 0,timestamp:d,datetime:this.iso8601(d),lastTradeTimestamp:void 0,symbol:r,type:"limit",timeInForce:void 0,postOnly:void 0,side:s,price:n,stopPrice:void 0,cost:a,average:void 0,amount:o,filled:void 0,remaining:c,status:i,fee:undefined,trades:void 0})}async fetchOrder(e,t,s={}){if(void 0===t)throw new a(this.id+" fetchOrder() requires a symbol");await this.loadMarkets();const i=this.market(t),r={pair:i.id,order_id:e},n=await this.privatePostGetOrder(this.extend(r,s)),o=n.return,c=this.parseOrder(this.extend({id:e},o.order),i);return this.extend({info:n},c)}async fetchOpenOrders(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.market(e),a.pair=r.id);const n=(await this.privatePostOpenOrders(this.extend(a,i))).return.orders;if(!n)return[];if(void 0!==e)return this.parseOrders(n,r,t,s);const o=Object.keys(n);let c=[];for(let e=0;e<o.length;e++){const i=o[e],a=n[i];r=this.markets_by_id[i];const d=this.parseOrders(a,r,t,s);c=this.arrayConcat(c,d)}return c}async fetchClosedOrders(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchOrders() requires a symbol argument");await this.loadMarkets();const r={};let n;void 0!==e&&(n=this.market(e),r.pair=n.id);const o=await this.privatePostOrderHistory(this.extend(r,i));let c=this.parseOrders(o.return.orders,n);return c=this.filterBy(c,"status","closed"),this.filterBySymbolSinceLimit(c,e,t,s)}async createOrder(e,t,s,i,a,n={}){if("limit"!==t)throw new r(this.id+" allows limit orders only");await this.loadMarkets();const o=this.market(e),c={pair:o.id,type:s,price:a},d=o.baseId;"buy"===s?c[o.quoteId]=i*a:c[o.baseId]=i,c[d]=i;const h=await this.privatePostTrade(this.extend(c,n)),u=this.safeValue(h,"return",{});return{info:h,id:this.safeString(u,"order_id")}}async cancelOrder(e,t,s={}){if(void 0===t)throw new a(this.id+" cancelOrder() requires a symbol argument");const i=this.safeValue(s,"side");if(void 0===i)throw new a(this.id+' cancelOrder() requires an extra "side" param');await this.loadMarkets();const r={order_id:e,pair:this.market(t).id,type:i};return await this.privatePostCancelOrder(this.extend(r,s))}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a=this.currency(e),n=this.milliseconds(),o={currency:a.id,withdraw_amount:t,withdraw_address:s,request_id:n.toString()};i&&(o.withdraw_memo=i);const c=await this.privatePostWithdrawCoin(this.extend(o,r));let d;return"txid"in c&&c.txid.length>0&&(d=c.txid),{info:c,id:d}}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t];return"public"===t?n+="/"+this.implodeParams(e,i):(this.checkRequiredCredentials(),a=this.urlencode(this.extend({method:e,timestamp:this.nonce(),recvWindow:this.options.recvWindow},i)),r={"Content-Type":"application/x-www-form-urlencoded",Key:this.apiKey,Sign:this.hmac(this.encode(a),this.encode(this.secret),"sha512")}),{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0===o)return;if(Array.isArray(o))return;const h=this.safeValue(o,"error","");if(!("success"in o)&&""===h)return;if(1===this.safeInteger(o,"success",0)){if("return"in o)return;throw new r(this.id+": malformed response: "+this.json(o))}const u=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,h,u),this.throwBroadlyMatchedException(this.exceptions.broad,h,u),new r(u)}}},1431:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,AuthenticationError:a,ArgumentsRequired:n}=s(3449),o=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"itbit",name:"itBit",countries:["US"],rateLimit:2e3,version:"v1",has:{cancelOrder:!0,CORS:!0,createMarketOrder:!1,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchMyTrades:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTrades:!0,fetchTransactions:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/27822159-66153620-60ad-11e7-89e7-005f6d7f3de0.jpg",api:"https://api.itbit.com",www:"https://www.itbit.com",doc:["https://api.itbit.com/docs","https://www.itbit.com/api"]},api:{public:{get:["markets/{symbol}/ticker","markets/{symbol}/order_book","markets/{symbol}/trades"]},private:{get:["wallets","wallets/{walletId}","wallets/{walletId}/balances/{currencyCode}","wallets/{walletId}/funding_history","wallets/{walletId}/trades","wallets/{walletId}/orders","wallets/{walletId}/orders/{id}"],post:["wallet_transfers","wallets","wallets/{walletId}/cryptocurrency_deposits","wallets/{walletId}/cryptocurrency_withdrawals","wallets/{walletId}/orders","wire_withdrawal"],delete:["wallets/{walletId}/orders/{id}"]}},markets:{"BTC/USD":{id:"XBTUSD",symbol:"BTC/USD",base:"BTC",quote:"USD",baseId:"XBT",quoteId:"USD"},"BTC/SGD":{id:"XBTSGD",symbol:"BTC/SGD",base:"BTC",quote:"SGD",baseId:"XBT",quoteId:"SGD"},"BTC/EUR":{id:"XBTEUR",symbol:"BTC/EUR",base:"BTC",quote:"EUR",baseId:"XBT",quoteId:"EUR"},"ETH/USD":{id:"ETHUSD",symbol:"ETH/USD",base:"ETH",quote:"USD",baseId:"ETH",quoteId:"USD"},"ETH/EUR":{id:"ETHEUR",symbol:"ETH/EUR",base:"ETH",quote:"EUR",baseId:"ETH",quoteId:"EUR"},"ETH/SGD":{id:"ETHSGD",symbol:"ETH/SGD",base:"ETH",quote:"SGD",baseId:"ETH",quoteId:"SGD"},PAXGUSD:{id:"PAXGUSD",symbol:"PAXG/USD",base:"PAXG",quote:"USD",baseId:"PAXG",quoteId:"USD"},BCHUSD:{id:"BCHUSD",symbol:"BCH/USD",base:"BCH",quote:"USD",baseId:"BCH",quoteId:"USD"},LTCUSD:{id:"LTCUSD",symbol:"LTC/USD",base:"LTC",quote:"USD",baseId:"LTC",quoteId:"USD"}},fees:{trading:{maker:-3e-4,taker:.35/100}},commonCurrencies:{XBT:"BTC"}})}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.marketId(e)},r=await this.publicGetMarketsSymbolOrderBook(this.extend(i,s));return this.parseOrderBook(r,e)}async fetchTicker(e,t={}){await this.loadMarkets();const s={symbol:this.marketId(e)},i=await this.publicGetMarketsSymbolTicker(this.extend(s,t)),a=this.safeString(i,"serverTimeUTC");if(!a)throw new r(this.id+" fetchTicker returned a bad response: "+this.json(i));const n=this.parse8601(a),o=this.safeNumber(i,"vwap24h"),c=this.safeNumber(i,"volume24h");let d;void 0!==c&&void 0!==o&&(d=c*o);const h=this.safeNumber(i,"lastPrice");return{symbol:e,timestamp:n,datetime:this.iso8601(n),high:this.safeNumber(i,"high24h"),low:this.safeNumber(i,"low24h"),bid:this.safeNumber(i,"bid"),bidVolume:void 0,ask:this.safeNumber(i,"ask"),askVolume:void 0,vwap:o,open:this.safeNumber(i,"openToday"),close:h,last:h,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:c,quoteVolume:d,info:i}}parseTrade(e,t){const s=this.safeString2(e,"executionId","matchNumber"),i=this.parse8601(this.safeString(e,"timestamp")),r=this.safeString(e,"direction"),a=this.safeString(e,"orderId");let n=this.safeNumber(e,"commissionPaid");const c=this.safeString(e,"commissionCurrency"),d=this.safeCurrencyCode(c);let h=this.safeNumber(e,"rebatesApplied");void 0!==h&&(h=-h);const u=this.safeString(e,"rebateCurrency"),l=this.safeCurrencyCode(u),f=this.safeString2(e,"price","rate"),p=this.safeString2(e,"currency1Amount","amount"),m=this.parseNumber(f),b=this.parseNumber(p),g=this.parseNumber(o.stringMul(f,p));let y;const v=this.safeString(e,"instrument");if(void 0!==v)if(v in this.markets_by_id)t=this.markets_by_id[v];else{const t=this.safeString(e,"currency1"),s=this.safeString(e,"currency2");y=this.safeCurrencyCode(t)+"/"+this.safeCurrencyCode(s)}void 0===y&&void 0!==t&&(y=t.symbol);const w={info:e,id:s,timestamp:i,datetime:this.iso8601(i),symbol:y,order:a,type:void 0,side:r,takerOrMaker:void 0,price:m,amount:b,cost:g,fee:void 0};return void 0!==n&&(void 0!==h?d===l?(n=this.sum(n,h),w.fee={cost:n,currency:d}):w.fees=[{cost:n,currency:d},{cost:h,currency:l}]:w.fee={cost:n,currency:d}),"fee"in w||"fees"in w||(w.fee=void 0),w}async fetchTransactions(e,t,s,i={}){await this.loadMarkets();const r=this.safeString(i,"walletId");if(void 0===r)throw new n(this.id+" fetchMyTrades() requires a walletId parameter");const a={walletId:r};void 0!==s&&(a.perPage=s);const o=(await this.privateGetWalletsWalletIdFundingHistory(this.extend(a,i))).fundingHistory,c=[];for(let e=0;e<o.length;e++){const t=o[e],s=this.safeString(t,"time"),i=this.parse8601(s),r=this.safeString(t,"currency"),a=this.safeString(t,"destinationAddress"),n=this.safeString(t,"txnHash"),d=this.safeStringLower(t,"transactionType"),h=this.safeString(t,"status"),u=this.parseTransferStatus(h);c.push({id:this.safeString(t,"withdrawalId"),timestamp:i,datetime:this.iso8601(i),currency:this.safeCurrencyCode(r),address:a,tag:void 0,txid:n,type:d,status:u,amount:this.safeNumber(t,"amount"),fee:void 0,info:t})}return c}parseTransferStatus(e){return this.safeString({cancelled:"canceled",completed:"ok"},e,"pending")}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const a=this.safeString(i,"walletId");if(void 0===a)throw new r(this.id+" fetchMyTrades() requires a walletId parameter");const n={walletId:a};void 0!==t&&(n.rangeStart=this.ymdhms(t,"T")),void 0!==s&&(n.perPage=s);const o=await this.privateGetWalletsWalletIdTrades(this.extend(n,i)),c=this.safeValue(o,"tradingHistory",[]);let d;return void 0!==e&&(d=this.market(e)),this.parseTrades(c,d,t,s)}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id},n=await this.publicGetMarketsSymbolTrades(this.extend(a,i)),o=this.safeValue(n,"recentTrades",[]);return this.parseTrades(o,r,t,s)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.fetchWallets(e),s=t[0].balances,i={info:t};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"currency"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(t,"availableBalance"),n.total=this.safeString(t,"totalBalance"),i[a]=n}return this.parseBalance(i,!1)}async fetchWallets(e={}){if(await this.loadMarkets(),!this.uid)throw new a(this.id+" fetchWallets() requires uid API credential");const t={userId:this.uid};return await this.privateGetWallets(this.extend(t,e))}async fetchWallet(e,t={}){await this.loadMarkets();const s={walletId:e};return await this.privateGetWalletsWalletId(this.extend(s,t))}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({status:"open"},i))}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({status:"filled"},i))}async fetchOrders(e,t,s,i={}){let a;await this.loadMarkets(),void 0!==e&&(a=this.market(e));if(!("walletId"in i))throw new r(this.id+" fetchOrders() requires a walletId parameter");const n={walletId:i.walletId},o=await this.privateGetWalletsWalletIdOrders(this.extend(n,i));return this.parseOrders(o,a,t,s)}parseOrderStatus(e){return this.safeString({submitted:"open",open:"open",filled:"closed",cancelled:"canceled",rejected:"canceled"},e,e)}parseOrder(e,t){const s=this.safeString(e,"side"),i=this.safeString(e,"type"),r=this.markets_by_id[e.instrument].symbol,a=this.parse8601(e.createdTime),n=this.safeNumber(e,"amount"),o=this.safeNumber(e,"amountFilled"),c=this.safeNumber(e,"price"),d=this.safeNumber(e,"volumeWeightedAveragePrice"),h=this.safeString(e,"clientOrderIdentifier"),u=this.safeString(e,"id"),l="True"===this.safeString(e,"postOnly");return this.safeOrder({id:u,clientOrderId:h,info:e,timestamp:a,datetime:this.iso8601(a),lastTradeTimestamp:void 0,status:this.parseOrderStatus(this.safeString(e,"status")),symbol:r,type:i,timeInForce:void 0,postOnly:l,side:s,price:c,stopPrice:void 0,cost:void 0,average:d,amount:n,filled:o,remaining:void 0,fee:undefined,trades:void 0})}nonce(){return this.milliseconds()}async createOrder(e,t,s,i,a,n={}){if(await this.loadMarkets(),"market"===t)throw new r(this.id+" allows limit orders only");if(!("walletId"in n))throw new r(this.id+" createOrder() requires a walletId parameter");i=i.toString(),a=a.toString();const o=this.market(e),c={side:s,type:t,currency:o.id.replace(o.quote,""),amount:i,display:i,price:a,instrument:o.id},d=await this.privatePostWalletsWalletIdOrders(this.extend(c,n));return{info:d,id:d.id}}async fetchOrder(e,t,s={}){await this.loadMarkets();if(!("walletId"in s))throw new r(this.id+" fetchOrder() requires a walletId parameter");const i={id:e},a=await this.privateGetWalletsWalletIdOrdersId(this.extend(i,s));return this.parseOrder(a)}async cancelOrder(e,t,s={}){if(!("walletId"in s))throw new r(this.id+" cancelOrder() requires a walletId parameter");const i={id:e};return await this.privateDeleteWalletsWalletIdOrdersId(this.extend(i,s))}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api+"/"+this.version+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if("GET"===s&&Object.keys(o).length&&(n+="?"+this.urlencode(o)),"POST"===s&&Object.keys(o).length&&(a=this.json(o)),"private"===t){this.checkRequiredCredentials();const e=this.nonce().toString(),t=e,i=[s,n,"POST"===s?a:"",e,t],o=e+this.json(i).replace("\\/","/"),c=this.hash(this.encode(o),"sha256","binary"),d=this.stringToBinary(this.encode(n)),h=this.binaryConcat(d,c),u=this.hmac(h,this.encode(this.secret),"sha512","base64");r={Authorization:this.apiKey+":"+u,"Content-Type":"application/json","X-Auth-Timestamp":t,"X-Auth-Nonce":e}}return{url:n,method:s,body:a,headers:r}}async request(e,t="public",s="GET",i={},a,n){const o=await this.fetch2(e,t,s,i,a,n);if("code"in o)throw new r(this.id+" "+this.json(o));return o}}},6594:(e,t,s)=>{"use strict";const i=s(8819),{BadSymbol:r,ExchangeNotAvailable:a,ArgumentsRequired:n,PermissionDenied:o,AuthenticationError:c,ExchangeError:d,OrderNotFound:h,DDoSProtection:u,InvalidNonce:l,InsufficientFunds:f,CancelPending:p,InvalidOrder:m,InvalidAddress:b,RateLimitExceeded:g}=s(3449),{TRUNCATE:y,DECIMAL_PLACES:v}=s(2115),w=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"kraken",name:"Kraken",countries:["US"],version:"0",rateLimit:3e3,certified:!0,pro:!0,has:{cancelAllOrders:!0,cancelOrder:!0,CORS:!1,createDepositAddress:!0,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchLedger:!0,fetchLedgerEntry:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrderTrades:"emulated",fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTradingFee:!0,fetchTradingFees:!0,fetchWithdrawals:!0,withdraw:!0},marketsByAltname:{},timeframes:{"1m":1,"5m":5,"15m":15,"30m":30,"1h":60,"4h":240,"1d":1440,"1w":10080,"2w":21600},urls:{logo:"https://user-images.githubusercontent.com/51840849/76173629-fc67fb00-61b1-11ea-84fe-f2de582f58a3.jpg",api:{public:"https://api.kraken.com",private:"https://api.kraken.com",zendesk:"https://kraken.zendesk.com/api/v2/help_center/en-us/articles"},www:"https://www.kraken.com",doc:"https://www.kraken.com/features/api",fees:"https://www.kraken.com/en-us/features/fee-schedule"},fees:{trading:{tierBased:!0,percentage:!0,taker:.0026,maker:.0016,tiers:{taker:[[0,.0026],[5e4,.0024],[1e5,.0022],[25e4,.002],[5e5,.0018],[1e6,.0016],[25e5,.0014],[5e6,.0012],[1e7,1e-4]],maker:[[0,.0016],[5e4,.0014],[1e5,.0012],[25e4,.001],[5e5,8e-4],[1e6,6e-4],[25e5,4e-4],[5e6,2e-4],[1e7,0]]}},funding:{tierBased:!1,percentage:!1,withdraw:{BTC:.001,ETH:.005,XRP:.02,XLM:2e-5,LTC:.02,DOGE:2,ZEC:1e-4,ICN:.02,REP:.01,ETC:.005,MLN:.003,XMR:.05,DASH:.005,GNO:.01,EOS:.5,BCH:.001,XTZ:.05,USD:5,EUR:5,CAD:10,JPY:300},deposit:{BTC:0,ETH:0,XRP:0,XLM:0,LTC:0,DOGE:0,ZEC:0,ICN:0,REP:0,ETC:0,MLN:0,XMR:0,DASH:0,GNO:0,EOS:0,BCH:0,XTZ:.05,USD:5,EUR:0,CAD:5,JPY:0}}},api:{zendesk:{get:["360000292886","201893608"]},public:{get:["Assets","AssetPairs","Depth","OHLC","Spread","Ticker","Time","Trades"]},private:{post:["AddOrder","AddExport","Balance","CancelAll","CancelOrder","ClosedOrders","DepositAddresses","DepositMethods","DepositStatus","ExportStatus","GetWebSocketsToken","Ledgers","OpenOrders","OpenPositions","QueryLedgers","QueryOrders","QueryTrades","RetrieveExport","RemoveExport","TradeBalance","TradesHistory","TradeVolume","Withdraw","WithdrawCancel","WithdrawInfo","WithdrawStatus"]}},commonCurrencies:{XBT:"BTC","XBT.M":"BTC.M",XDG:"DOGE",REPV2:"REP",REP:"REPV1"},options:{cacheDepositMethodsOnFetchDepositAddress:!0,depositMethods:{},delistedMarketsById:{},inactiveCurrencies:["CAD","USD","JPY","GBP"]},exceptions:{"EQuery:Invalid asset pair":r,"EAPI:Invalid key":c,"EFunding:Unknown withdraw key":d,"EFunding:Invalid amount":f,"EService:Unavailable":a,"EDatabase:Internal error":a,"EService:Busy":a,"EQuery:Unknown asset":d,"EAPI:Rate limit exceeded":u,"EOrder:Rate limit exceeded":u,"EGeneral:Internal error":a,"EGeneral:Temporary lockout":u,"EGeneral:Permission denied":o,"EOrder:Unknown order":m,"EOrder:Order minimum not met":m}})}costToPrecision(e,t){return this.decimalToPrecision(t,y,this.markets[e].precision.price,v)}feeToPrecision(e,t){return this.decimalToPrecision(t,y,this.markets[e].precision.amount,v)}async fetchMarkets(e={}){const t=await this.publicGetAssetPairs(e),s=this.safeValue(t,"result",{}),i=Object.keys(s);let r=[];for(let e=0;e<i.length;e++){const t=i[e],a=s[t],n=this.safeString(a,"base"),o=this.safeString(a,"quote"),c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o),h=t.indexOf(".d")>=0,u=this.safeString(a,"altname"),l=h?u:c+"/"+d,f=this.safeValue(a,"fees_maker",[]),p=this.safeValue(f,0,[]),m=this.safeNumber(p,1);let b;void 0!==m&&(b=parseFloat(m)/100);const g=this.safeValue(a,"fees",[]),y=this.safeValue(g,0,[]),v=this.safeNumber(y,1);let w;void 0!==v&&(w=parseFloat(v)/100);const k={amount:this.safeInteger(a,"lot_decimals"),price:this.safeInteger(a,"pair_decimals")},S=this.safeNumber(a,"ordermin");r.push({id:t,symbol:l,base:c,quote:d,baseId:n,quoteId:o,darkpool:h,info:a,altname:a.altname,maker:b,taker:w,active:!0,precision:k,limits:{amount:{min:S,max:Math.pow(10,k.amount)},price:{min:Math.pow(10,-k.price),max:void 0},cost:{min:0,max:void 0}}})}return r=this.appendInactiveMarkets(r),this.marketsByAltname=this.indexBy(r,"altname"),r}safeCurrency(e,t){if(e.length>3&&(0===e.indexOf("X")||0===e.indexOf("Z"))){if(e.indexOf(".")>0)return super.safeCurrency(e,t);e=e.slice(1)}return super.safeCurrency(e,t)}appendInactiveMarkets(e){const t={amount:8,price:8},s={min:0,max:void 0},i={min:Math.pow(10,-t.price),max:void 0},r={darkpool:!1,info:void 0,maker:void 0,taker:void 0,active:!1,precision:t,limits:{amount:{min:Math.pow(10,-t.amount),max:Math.pow(10,t.amount)},price:i,cost:s}},a=[];for(let t=0;t<a.length;t++)e.push(this.extend(r,a[t]));return e}async fetchCurrencies(e={}){const t=await this.publicGetAssets(e),s=this.safeValue(t,"result"),i=Object.keys(s),r={};for(let e=0;e<i.length;e++){const t=i[e],a=s[t],n=this.safeCurrencyCode(this.safeString(a,"altname")),o=this.safeInteger(a,"decimals"),c=!this.inArray(n,this.options.inactiveCurrencies);r[n]={id:t,code:n,info:a,name:n,active:c,fee:void 0,precision:o,limits:{amount:{min:Math.pow(10,-o),max:Math.pow(10,o)},withdraw:{min:void 0,max:Math.pow(10,o)}}}}return r}async fetchTradingFees(e={}){await this.loadMarkets(),this.checkRequiredCredentials();const t=await this.privatePostTradeVolume(e),s=this.safeNumber(t.result,"volume"),i=this.fees.trading.tiers;let r=i.taker[1],a=i.maker[1];for(let e=0;e<i.taker.length;e++)s>=i.taker[e][0]&&(r=i.taker[e][1]);for(let e=0;e<i.maker.length;e++)s>=i.maker[e][0]&&(a=i.maker[e][1]);return{info:t,maker:a,taker:r}}parseBidAsk(e,t=0,s=1){return[this.safeNumber(e,t),this.safeNumber(e,s),this.safeInteger(e,2)]}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e);if(i.darkpool)throw new d(this.id+" does not provide an order book for darkpool symbol "+e);const r={pair:i.id};void 0!==t&&(r.count=t);const a=await this.publicGetDepth(this.extend(r,s)),n=this.safeValue(a,"result",{});let o=this.safeValue(n,i.id);const c=this.safeValue(i,"info",{}),h=this.safeValue(c,"wsname");return void 0!==h&&(o=this.safeValue(n,h,o)),this.parseOrderBook(o,e)}parseTicker(e,t){const s=this.milliseconds();let i;t&&(i=t.symbol);const r=parseFloat(e.v[1]),a=parseFloat(e.p[1]);let n;void 0!==r&&void 0!==a&&(n=r*a);const o=parseFloat(e.c[0]);return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:parseFloat(e.h[1]),low:parseFloat(e.l[1]),bid:parseFloat(e.b[0]),bidVolume:void 0,ask:parseFloat(e.a[0]),askVolume:void 0,vwap:a,open:this.safeNumber(e,"o"),close:o,last:o,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:r,quoteVolume:n,info:e}}async fetchTickers(e,t={}){await this.loadMarkets(),e=void 0===e?this.symbols:e;const s=[];for(let t=0;t<e.length;t++){const i=e[t],r=this.markets[i];r.active&&!r.darkpool&&s.push(r.id)}const i={pair:s.join(",")},r=(await this.publicGetTicker(this.extend(i,t))).result,a=Object.keys(r),n={};for(let e=0;e<a.length;e++){const t=a[e],s=this.markets_by_id[t],i=s.symbol,o=r[t];n[i]=this.parseTicker(o,s)}return this.filterByArray(n,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();if(e.indexOf(".d")>=0)throw new d(this.id+" does not provide a ticker for darkpool symbol "+e);const s=this.market(e),i={pair:s.id},r=(await this.publicGetTicker(this.extend(i,t))).result[s.id];return this.parseTicker(r,s)}parseOHLCV(e,t){return[this.safeTimestamp(e,0),this.safeNumber(e,1),this.safeNumber(e,2),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,6)]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={pair:a.id,interval:this.timeframes[t]};void 0!==s&&(n.since=parseInt((s-1)/1e3));const o=await this.publicGetOHLC(this.extend(n,r)),c=this.safeValue(o,"result",{}),d=this.safeValue(c,a.id,[]);return this.parseOHLCVs(d,a,t,s,i)}parseLedgerEntryType(e){return this.safeString({trade:"trade",withdrawal:"transaction",deposit:"transaction",transfer:"transfer",margin:"margin"},e,e)}parseLedgerEntry(e,t){const s=this.safeString(e,"id");let i;const r=this.safeString(e,"refid"),a=this.parseLedgerEntryType(this.safeString(e,"type")),n=this.safeCurrencyCode(this.safeString(e,"asset"),t);let o=this.safeNumber(e,"amount");o<0?(i="out",o=Math.abs(o)):i="in";const c=this.safeNumber(e,"time");let d;void 0!==c&&(d=parseInt(1e3*c));const h={cost:this.safeNumber(e,"fee"),currency:n};return{info:e,id:s,direction:i,account:undefined,referenceId:r,referenceAccount:undefined,type:a,currency:n,amount:o,before:undefined,after:this.safeNumber(e,"balance"),status:"ok",timestamp:d,datetime:this.iso8601(d),fee:h}}async fetchLedger(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.asset=a.id),void 0!==t&&(r.start=parseInt(t/1e3));const n=await this.privatePostLedgers(this.extend(r,i)),o=this.safeValue(n,"result",{}),c=this.safeValue(o,"ledger",{}),d=Object.keys(c),h=[];for(let e=0;e<d.length;e++){const t=d[e],s=c[t];s.id=t,h.push(s)}return this.parseLedger(h,a,t,s)}async fetchLedgerEntriesByIds(e,t,s={}){await this.loadMarkets(),e=e.join(",");const i=this.extend({id:e},s),r=(await this.privatePostQueryLedgers(i)).result,a=Object.keys(r),n=[];for(let e=0;e<a.length;e++){const t=a[e],s=r[t];s.id=t,n.push(s)}return this.parseLedger(n)}async fetchLedgerEntry(e,t,s={}){return(await this.fetchLedgerEntriesByIds([e],t,s))[0]}parseTrade(e,t){let s,i,r,a,n,o,c,d,h;if(Array.isArray(e)){s=this.safeTimestamp(e,2),i="s"===e[3]?"sell":"buy",r="l"===e[4]?"limit":"market",a=this.safeString(e,0),n=this.safeString(e,1);e.length>6&&(o=this.safeString(e,6))}else if("string"==typeof e)o=e;else if("ordertxid"in e){const h=this.safeString(e,"pair"),u=this.findMarketByAltnameOrId(h);if(void 0!==u?t=u:void 0!==h&&(t=this.getDelistedMarketById(h)),c=this.safeString(e,"ordertxid"),o=this.safeString2(e,"id","postxid"),s=this.safeTimestamp(e,"time"),i=this.safeString(e,"type"),r=this.safeString(e,"ordertype"),a=this.safeString(e,"price"),n=this.safeString(e,"vol"),"fee"in e){let s;void 0!==t&&(s=t.quote),d={cost:this.safeNumber(e,"fee"),currency:s}}}void 0!==t&&(h=t.symbol);const u=this.parseNumber(a),l=this.parseNumber(n),f=this.parseNumber(w.stringMul(a,n));return{id:o,order:c,info:e,timestamp:s,datetime:this.iso8601(s),symbol:h,type:r,side:i,takerOrMaker:void 0,price:u,amount:l,cost:f,fee:d}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a=r.id,n={pair:a};if(void 0!==t&&(n.since=1e6*t,n.since=t.toString()+"000000"),void 0!==s&&1e3!==s){if(this.safeValue(this.options,"fetchTradesWarning",!0))throw new d(this.id+" fetchTrades() cannot serve "+s.toString()+" trades without breaking the pagination, see https://github.com/ccxt/ccxt/issues/5698 for more details. Set exchange.options['fetchTradesWarning'] to acknowledge this warning and silence it.")}const o=(await this.publicGetTrades(this.extend(n,i))).result,c=o[a],h=c.length;if(h<=0)return[];const u=c[h-1],l=this.safeString(o,"last");return u.push(l),this.parseTrades(c,r,t,s)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostBalance(e),s=this.safeValue(t,"result",{}),i={info:t,timestamp:void 0,datetime:void 0},r=Object.keys(s);for(let e=0;e<r.length;e++){const t=r[e],a=this.safeCurrencyCode(t),n=this.account();n.total=this.safeString(s,t),i[a]=n}return this.parseBalance(i,!1)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const o={pair:this.market(e).id,type:s,ordertype:t,volume:this.amountToPrecision(e,i)},c=this.safeString2(a,"userref","clientOrderId");if(a=this.omit(a,["userref","clientOrderId"]),void 0!==c&&(o.userref=c),"limit"===t)o.price=this.priceToPrecision(e,r);else if("stop-loss"===t||"take-profit"===t){const s=this.safeNumber2(a,"price","stopPrice",r);if(void 0===s)throw new n(this.id+" createOrder() requires a price argument or a price/stopPrice parameter for a "+t+" order");o.price=this.priceToPrecision(e,s)}else if("stop-loss-limit"===t||"take-profit-limit"===t){const s=this.safeNumber2(a,"price","stopPrice"),i=this.safeNumber(a,"price2"),c=void 0!==s,d=void 0!==i;if(c&&d)o.price=this.priceToPrecision(e,s),o.price2=this.priceToPrecision(e,i);else{if(void 0===r||!c&&!d)throw new n(this.id+" createOrder() requires a price argument and/or price/stopPrice/price2 parameters for a "+t+" order");c?(o.price=this.priceToPrecision(e,s),o.price2=this.priceToPrecision(e,r)):d&&(o.price=this.priceToPrecision(e,r),o.price2=this.priceToPrecision(e,i))}}a=this.omit(a,["price","stopPrice","price2"]);const d=await this.privatePostAddOrder(this.extend(o,a)),h=this.safeValue(d,"result");return this.parseOrder(h)}findMarketByAltnameOrId(e){return e in this.marketsByAltname?this.marketsByAltname[e]:e in this.markets_by_id?this.markets_by_id[e]:void 0}getDelistedMarketById(e){if(void 0===e)return e;let t=this.safeValue(this.options.delistedMarketsById,e);if(void 0!==t)return t;let s=3,i=3,r=6;8===e.length?(s=4,i=4,r=8):7===e.length&&(s=4,i=4,r=7);const a=e.slice(0,s),n=e.slice(i,r),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n);return t={symbol:o+"/"+c,base:o,quote:c,baseId:a,quoteId:n},this.options.delistedMarketsById[e]=t,t}parseOrderStatus(e){return this.safeString({pending:"open",open:"open",closed:"closed",canceled:"canceled",expired:"expired"},e,e)}parseOrder(e,t){const s=this.safeValue(e,"descr",{}),i=this.safeString(s,"order");let r,a,n,o,c;if(void 0!==i){const e=i.split(" ");r=this.safeString(e,0),c=this.safeNumber(e,1),n=this.safeString(e,2),a=this.safeString(e,4),o=this.safeNumber(e,5)}r=this.safeString(s,"type",r),a=this.safeString(s,"ordertype",a),n=this.safeString(s,"pair",n);const d=this.findMarketByAltnameOrId(n);let h;void 0!==d?t=d:void 0!==n&&(t=this.getDelistedMarketById(n));const u=this.safeTimestamp(e,"opentm");c=this.safeNumber(e,"vol",c);const l=this.safeNumber(e,"vol_exec");let f;const p=this.safeNumber(e,"cost");o=this.safeNumber(s,"price",o),void 0!==o&&0!==o||(o=this.safeNumber(s,"price2")),void 0!==o&&0!==o||(o=this.safeNumber(e,"price",o));const m=this.safeNumber(e,"price");if(void 0!==t&&(h=t.symbol,"fee"in e)){const s=e.oflags;f={cost:this.safeNumber(e,"fee"),rate:void 0},s.indexOf("fciq")>=0?f.currency=t.quote:s.indexOf("fcib")>=0&&(f.currency=t.base)}const b=this.parseOrderStatus(this.safeString(e,"status"));let g=this.safeString(e,"id");if(void 0===g){const t=this.safeValue(e,"txid");g=this.safeString(t,0)}const y=this.safeString(e,"userref"),v=this.safeValue(e,"trades");let w;void 0!==v&&(w=this.parseTrades(v,t,void 0,void 0,{order:g}));const k=this.safeNumber(e,"stopprice");return this.safeOrder({id:g,clientOrderId:y,info:e,timestamp:u,datetime:this.iso8601(u),lastTradeTimestamp:void 0,status:b,symbol:h,type:a,timeInForce:void 0,postOnly:void 0,side:r,price:o,stopPrice:k,cost:p,amount:c,filled:l,average:m,remaining:void 0,fee:f,trades:w})}async fetchOrder(e,t,s={}){await this.loadMarkets();const i=this.safeValue2(s,"userref","clientOrderId"),r={trades:!0};let a=s;void 0!==i?(r.userref=i,a=this.omit(s,["userref","clientOrderId"])):r.txid=e;const n=await this.privatePostQueryOrders(this.extend(r,a)),o=this.safeValue(n,"result",[]);if(!(e in o))throw new h(this.id+" fetchOrder() could not find order id "+e);const c=this.parseOrder(this.extend({id:e},o[e]));return this.extend({info:n},c)}async fetchOrderTrades(e,t,s,i,r={}){const a=this.safeValue(r,"trades"),o=[];if(void 0===a)throw new n(this.id+" fetchOrderTrades() requires a unified order structure in the params argument or a 'trades' param (an array of trade id strings)");for(let e=0;e<a.length;e++){const t=a[e];"string"==typeof t?o.push(t):o.push(t.id)}await this.loadMarkets();const c=this.safeValue(this.options,"fetchOrderTrades",{}),d=this.safeInteger(c,"batchSize",20);let h=parseInt(o/d);h=this.sum(h,1);const u=o.length;let l=[];for(let e=0;e<h;e++){const r=[];for(let t=0;t<d;t++){const s=this.sum(e*d,t);s<u&&r.push(o[s])}const a={txid:r.join(",")},n=await this.privatePostQueryTrades(a),c=this.safeValue(n,"result"),h=Object.keys(c);for(let e=0;e<h.length;e++)c[h[e]].id=h[e];const f=this.parseTrades(c,void 0,s,i),p=this.filterBySymbol(f,t);l=this.arrayConcat(l,p)}return l}async fetchOrdersByIds(e,t,s={}){await this.loadMarkets();const i=await this.privatePostQueryOrders(this.extend({trades:!0,txid:e.join(",")},s)),r=this.safeValue(i,"result",{}),a=[],n=Object.keys(r);for(let e=0;e<n.length;e++){const t=n[e],s=r[t],i=this.parseOrder(this.extend({id:t},s));a.push(i)}return a}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={};void 0!==t&&(r.start=parseInt(t/1e3));const a=(await this.privatePostTradesHistory(this.extend(r,i))).result.trades,n=Object.keys(a);for(let e=0;e<n.length;e++)a[n[e]].id=n[e];let o;return void 0!==e&&(o=this.market(e)),this.parseTrades(a,o,t,s)}async cancelOrder(e,t,s={}){let i;await this.loadMarkets();try{i=await this.privatePostCancelOrder(this.extend({txid:e},s))}catch(e){if(this.last_http_response&&this.last_http_response.indexOf("EOrder:Unknown order")>=0)throw new h(this.id+" cancelOrder() error "+this.last_http_response);throw e}return i}async cancelAllOrders(e,t={}){return await this.loadMarkets(),await this.privatePostCancelAll(t)}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r={};void 0!==t&&(r.start=parseInt(t/1e3));const a=await this.privatePostOpenOrders(this.extend(r,i));let n;void 0!==e&&(n=this.market(e));const o=this.safeValue(a,"result",{}),c=this.safeValue(o,"open",[]);return this.parseOrders(c,n,t,s)}async fetchClosedOrders(e,t,s,i={}){await this.loadMarkets();const r={};void 0!==t&&(r.start=parseInt(t/1e3));const a=await this.privatePostClosedOrders(this.extend(r,i));let n;void 0!==e&&(n=this.market(e));const o=this.safeValue(a,"result",{}),c=this.safeValue(o,"closed",[]);return this.parseOrders(c,n,t,s)}async fetchDepositMethods(e,t={}){await this.loadMarkets();const s={asset:this.currency(e).id},i=await this.privatePostDepositMethods(this.extend(s,t));return this.safeValue(i,"result")}parseTransactionStatus(e){return this.safeString({Initial:"pending",Pending:"pending",Success:"ok",Settled:"pending",Failure:"failed",Partial:"ok"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"refid"),i=this.safeString(e,"txid"),r=this.safeTimestamp(e,"time"),a=this.safeString(e,"asset"),n=this.safeCurrencyCode(a,t),o=this.safeString(e,"info"),c=this.safeNumber(e,"amount"),d=this.parseTransactionStatus(this.safeString(e,"status")),h=this.safeString(e,"type");let u=this.safeNumber(e,"fee");return void 0===u&&"deposit"===h&&(u=0),{info:e,id:s,currency:n,amount:c,address:o,tag:void 0,status:d,type:h,updated:void 0,txid:i,timestamp:r,datetime:this.iso8601(r),fee:{currency:n,cost:u}}}parseTransactionsByType(e,t,s,i,r){const a=[];for(let s=0;s<t.length;s++){const i=this.parseTransaction(this.extend({type:e},t[s]));a.push(i)}return this.filterByCurrencySinceLimit(a,s,i,r)}async fetchDeposits(e,t,s,i={}){if(void 0===e)throw new n(this.id+" fetchDeposits() requires a currency code argument");await this.loadMarkets();const r={asset:this.currency(e).id},a=await this.privatePostDepositStatus(this.extend(r,i));return this.parseTransactionsByType("deposit",a.result,e,t,s)}async fetchTime(e={}){const t=await this.publicGetTime(e),s=this.safeValue(t,"result",{});return this.safeTimestamp(s,"unixtime")}async fetchWithdrawals(e,t,s,i={}){if(void 0===e)throw new n(this.id+" fetchWithdrawals() requires a currency code argument");await this.loadMarkets();const r={asset:this.currency(e).id},a=await this.privatePostWithdrawStatus(this.extend(r,i));return this.parseTransactionsByType("withdrawal",a.result,e,t,s)}async createDepositAddress(e,t={}){const s=await this.fetchDepositAddress(e,this.extend({new:"true"},t)),i=this.safeString(s,"address");return this.checkAddress(i),{currency:e,address:i,info:s}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e);let i=this.safeString(t,"method");if(void 0===i){if(!this.options.cacheDepositMethodsOnFetchDepositAddress)throw new n(this.id+' fetchDepositAddress() requires an extra `method` parameter. Use fetchDepositMethods ("'+e+'") to get a list of available deposit methods or enable the exchange property .options["cacheDepositMethodsOnFetchDepositAddress"] = true');e in this.options.depositMethods||(this.options.depositMethods[e]=await this.fetchDepositMethods(e)),i=this.options.depositMethods[e][0].method}const r={asset:s.id,method:i},a=await this.privatePostDepositAddresses(this.extend(r,t)),o=a.result;if(o.length<1)throw new b(this.id+" privatePostDepositAddresses() returned no addresses");const c=this.safeString(o[0],"address"),d=this.safeString2(o[0],"tag","memo");return this.checkAddress(c),{currency:e,address:c,tag:d,info:a}}async withdraw(e,t,s,i,r={}){if(this.checkAddress(s),"key"in r){await this.loadMarkets();const s={asset:this.currency(e).id,amount:t},i=await this.privatePostWithdraw(this.extend(s,r));return{info:i,id:i.result}}throw new d(this.id+" withdraw() requires a 'key' parameter (withdrawal key name, as set up on your account)")}async fetchPositions(e,t={}){await this.loadMarkets();const s=await this.privatePostOpenPositions(this.extend({},t));return this.safeValue(s,"result")}sign(e,t="public",s="GET",i={},r,a){let n="/"+this.version+"/"+t+"/"+e;if("public"===t)Object.keys(i).length&&(n+="?"+this.urlencode(i));else if("private"===t){this.checkRequiredCredentials();const e=this.nonce().toString();a=this.urlencode(this.extend({nonce:e},i));const t=this.encode(e+a),s=this.hash(t,"sha256","binary"),o=this.stringToBinary(this.encode(n)),c=this.binaryConcat(o,s),d=this.base64ToBinary(this.secret),h=this.hmac(c,d,"sha512","base64");r={"API-Key":this.apiKey,"API-Sign":h,"Content-Type":"application/x-www-form-urlencoded"}}else n="/"+e;return n=this.urls.api[t]+n,{url:n,method:s,body:a,headers:r}}nonce(){return this.milliseconds()}handleErrors(e,t,s,i,r,n,o,c,h){if(520===e)throw new a(this.id+" "+e.toString()+" "+t);if(n.indexOf("Invalid order")>=0)throw new m(this.id+" "+n);if(n.indexOf("Invalid nonce")>=0)throw new l(this.id+" "+n);if(n.indexOf("Insufficient funds")>=0)throw new f(this.id+" "+n);if(n.indexOf("Cancel pending")>=0)throw new p(this.id+" "+n);if(n.indexOf("Invalid arguments:volume")>=0)throw new m(this.id+" "+n);if(n.indexOf("Rate limit exceeded")>=0)throw new g(this.id+" "+n);if(void 0!==o&&"{"===n[0]&&"string"!=typeof o&&"error"in o){if(o.error.length){const e=this.id+" "+n;for(let t=0;t<o.error.length;t++){const s=o.error[t];this.throwExactlyMatchedException(this.exceptions,s,e)}throw new d(e)}}}}},6987:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,ExchangeNotAvailable:n,InsufficientFunds:o,OrderNotFound:c,InvalidOrder:d,AccountSuspended:h,InvalidNonce:u,NotSupported:l,BadRequest:f,AuthenticationError:p,BadSymbol:m,RateLimitExceeded:b,PermissionDenied:g}=s(3449),y=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"kucoin",name:"KuCoin",countries:["SC"],rateLimit:334,version:"v2",certified:!1,pro:!0,comment:"Platform 2.0",has:{CORS:!1,cancelAllOrders:!0,cancelOrder:!0,createDepositAddress:!0,createOrder:!0,fetchAccounts:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchFundingFee:!0,fetchLedger:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchStatus:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchWithdrawals:!0,withdraw:!0,transfer:!0},urls:{logo:"https://user-images.githubusercontent.com/51840849/87295558-132aaf80-c50e-11ea-9801-a2fb0c57c799.jpg",referral:"https://www.kucoin.com/?rcode=E5wkqe",api:{public:"https://openapi-v2.kucoin.com",private:"https://openapi-v2.kucoin.com",futuresPrivate:"https://api-futures.kucoin.com",futuresPublic:"https://api-futures.kucoin.com"},test:{public:"https://openapi-sandbox.kucoin.com",private:"https://openapi-sandbox.kucoin.com",futuresPrivate:"https://api-sandbox-futures.kucoin.com",futuresPublic:"https://api-sandbox-futures.kucoin.com"},www:"https://www.kucoin.com",doc:["https://docs.kucoin.com"]},requiredCredentials:{apiKey:!0,secret:!0,password:!0},api:{public:{get:["timestamp","status","symbols","markets","market/allTickers","market/orderbook/level{level}_{limit}","market/orderbook/level2_20","market/orderbook/level2_100","market/histories","market/candles","market/stats","currencies","currencies/{currency}","prices","mark-price/{symbol}/current","margin/config"],post:["bullet-public"]},private:{get:["market/orderbook/level{level}","market/orderbook/level2","market/orderbook/level3","accounts","accounts/{accountId}","accounts/{accountId}/ledgers","accounts/{accountId}/holds","accounts/transferable","sub/user","sub-accounts","sub-accounts/{subUserId}","deposit-addresses","deposits","hist-deposits","hist-orders","hist-withdrawals","withdrawals","withdrawals/quotas","orders","order/client-order/{clientOid}","orders/{orderId}","limit/orders","fills","limit/fills","margin/account","margin/borrow","margin/borrow/outstanding","margin/borrow/borrow/repaid","margin/lend/active","margin/lend/done","margin/lend/trade/unsettled","margin/lend/trade/settled","margin/lend/assets","margin/market","margin/trade/last","stop-order/{orderId}","stop-order","stop-order/queryOrderByClientOid"],post:["accounts","accounts/inner-transfer","accounts/sub-transfer","deposit-addresses","withdrawals","orders","orders/multi","margin/borrow","margin/order","margin/repay/all","margin/repay/single","margin/lend","margin/toggle-auto-lend","bullet-private","stop-order"],delete:["withdrawals/{withdrawalId}","orders","orders/client-order/{clientOid}","orders/{orderId}","margin/lend/{orderId}","stop-order/cancelOrderByClientOid","stop-order/{orderId}","stop-order/cancel"]},futuresPublic:{get:["contracts/active","contracts/{symbol}","ticker","level2/snapshot","level2/depth20","level2/depth100","level2/message/query","level3/message/query","level3/snapshot","trade/history","interest/query","index/query","mark-price/{symbol}/current","premium/query","funding-rate/{symbol}/current","timestamp","status","kline/query"],post:["bullet-public"]},futuresPrivate:{get:["account-overview","transaction-history","deposit-address","deposit-list","withdrawals/quotas","withdrawal-list","transfer-list","orders","stopOrders","recentDoneOrders","orders/{order-id}","orders/byClientOid","fills","recentFills","openOrderStatistics","position","positions","funding-history"],post:["withdrawals","transfer-out","orders","position/margin/auto-deposit-status","position/margin/deposit-margin","bullet-private"],delete:["withdrawals/{withdrawalId}","cancel/transfer-out","orders/{order-id}","orders","stopOrders"]}},timeframes:{"1m":"1min","3m":"3min","5m":"5min","15m":"15min","30m":"30min","1h":"1hour","2h":"2hour","4h":"4hour","6h":"6hour","8h":"8hour","12h":"12hour","1d":"1day","1w":"1week"},exceptions:{exact:{"order not exist":c,"order not exist.":c,order_not_exist:c,order_not_exist_or_not_allow_to_cancel:d,"Order size below the minimum requirement.":d,"The withdrawal amount is below the minimum requirement.":r,"Unsuccessful! Exceeded the max. funds out-transfer limit":o,400:f,401:p,403:l,404:l,405:l,429:b,500:n,503:n,101030:g,200004:o,230003:o,260100:o,3e5:d,4e5:m,400001:p,400002:u,400003:p,400004:p,400005:p,400006:p,400007:p,400008:l,400100:f,411100:h,415e3:f,5e5:r},broad:{"Exceeded the access frequency":b,"require more permission":g}},fees:{trading:{tierBased:!1,percentage:!0,taker:.001,maker:.001},funding:{tierBased:!1,percentage:!1,withdraw:{},deposit:{}}},commonCurrencies:{HOT:"HOTNOW",EDGE:"DADI",WAX:"WAXP",TRY:"Trias",VAI:"VAIOT"},options:{version:"v1",symbolSeparator:"-",fetchMyTradesMethod:"private_get_fills",fetchBalance:"trade",versions:{public:{GET:{status:"v1","market/orderbook/level2_20":"v1","market/orderbook/level2_100":"v1","market/orderbook/level{level}_{limit}":"v1"}},private:{GET:{"market/orderbook/level2":"v3","market/orderbook/level3":"v3","market/orderbook/level{level}":"v3"},POST:{"accounts/inner-transfer":"v2","accounts/sub-transfer":"v2"}},futuresPrivate:{GET:{"account-overview":"v1",positions:"v1"},POST:{"transfer-out":"v2"}},futuresPublic:{GET:{"level3/snapshot":"v2"}}},accountsByType:{trade:"trade",trading:"trade",margin:"margin",main:"main",futures:"contract",contract:"contract",pool:"pool","pool-x":"pool"}}})}nonce(){return this.milliseconds()}async loadTimeDifference(e={}){const t=await this.publicGetTimestamp(e),s=this.milliseconds(),i=this.safeInteger(t,"data");return this.options.timeDifference=parseInt(s-i),this.options.timeDifference}async fetchTime(e={}){const t=await this.publicGetTimestamp(e);return this.safeInteger(t,"data")}async fetchStatus(e={}){const t=await this.publicGetStatus(e),s=this.safeValue(t,"data",{});let i=this.safeValue(s,"status");return void 0!==i&&(i="open"===i?"ok":"maintenance",this.status=this.extend(this.status,{status:i,updated:this.milliseconds()})),this.status}async fetchMarkets(e={}){const t=(await this.publicGetSymbols(e)).data,s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"symbol"),[a,n]=r.split("-"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d=o+"/"+c,h=this.safeValue(i,"enableTrading"),u=this.safeNumber(i,"baseMaxSize"),l=this.safeString(i,"baseMinSize"),f=this.safeString(i,"quoteMaxSize"),p=this.parseNumber(l),m=this.parseNumber(f),b=this.safeNumber(i,"quoteMinSize"),g={amount:this.precisionFromString(this.safeString(i,"baseIncrement")),price:this.precisionFromString(this.safeString(i,"priceIncrement"))},v={amount:{min:p,max:u},price:{min:this.safeNumber(i,"priceIncrement"),max:this.parseNumber(y.stringDiv(f,l))},cost:{min:b,max:m}};s.push({id:r,symbol:d,baseId:a,quoteId:n,base:o,quote:c,active:h,precision:g,limits:v,info:i})}return s}async fetchCurrencies(e={}){const t=await this.publicGetCurrencies(e),s=this.safeValue(t,"data",[]),i={};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"currency"),a=this.safeString(t,"fullName"),n=this.safeCurrencyCode(r),o=this.safeInteger(t,"precision"),c=this.safeValue(t,"isWithdrawEnabled",!1),d=this.safeValue(t,"isDepositEnabled",!1),h=this.safeNumber(t,"withdrawalMinFee"),u=c&&d;i[n]={id:r,name:a,code:n,precision:o,info:t,active:u,fee:h,limits:this.limits}}return i}async fetchAccounts(e={}){const t=await this.privateGetAccounts(e),s=this.safeValue(t,"data"),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"id"),a=this.safeString(t,"currency"),n=this.safeCurrencyCode(a),o=this.safeString(t,"type");i.push({id:r,type:o,currency:n,info:t})}return i}async fetchFundingFee(e,t={}){const s={currency:this.currencyId(e)},i=await this.privateGetWithdrawalsQuotas(this.extend(s,t)),r=i.data,a={};return a[e]=this.safeNumber(r,"withdrawMinFee"),{info:i,withdraw:a,deposit:{}}}parseTicker(e,t){let s=this.safeNumber(e,"changeRate");void 0!==s&&(s*=100);const i=this.safeNumber2(e,"last","lastTradedPrice"),r=this.safeString(e,"symbol"),a=this.safeSymbol(r,t,"-"),n=this.safeNumber(e,"vol"),o=this.safeNumber(e,"volValue"),c=this.vwap(n,o),d=this.safeInteger2(e,"time","datetime");return{symbol:a,timestamp:d,datetime:this.iso8601(d),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"buy"),bidVolume:void 0,ask:this.safeNumber(e,"sell"),askVolume:void 0,vwap:c,open:this.safeNumber(e,"open"),close:i,last:i,previousClose:void 0,change:this.safeNumber(e,"changePrice"),percentage:s,average:this.safeNumber(e,"averagePrice"),baseVolume:n,quoteVolume:o,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetMarketAllTickers(t),i=this.safeValue(s,"data",{}),r=this.safeValue(i,"ticker",[]),a={};for(let e=0;e<r.length;e++){const t=this.parseTicker(r[e]),s=this.safeString(t,"symbol");void 0!==s&&(a[s]=t)}return this.filterByArray(a,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.publicGetMarketStats(this.extend(i,t));return this.parseTicker(r.data,s)}parseOHLCV(e,t){return[this.safeTimestamp(e,0),this.safeNumber(e,1),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,2),this.safeNumber(e,5)]}async fetchOHLCV(e,t="15m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={symbol:a.id,type:this.timeframes[t]},o=1e3*this.parseTimeframe(t);let c=this.milliseconds();void 0!==s?(n.startAt=parseInt(Math.floor(s/1e3)),void 0===i&&(i=this.safeInteger(this.options,"fetchOHLCVLimit",1500)),c=this.sum(s,i*o)):void 0!==i&&(s=c-i*o,n.startAt=parseInt(Math.floor(s/1e3))),n.endAt=parseInt(Math.floor(c/1e3));const d=await this.publicGetMarketCandles(this.extend(n,r)),h=this.safeValue(d,"data",[]);return this.parseOHLCVs(h,a,t,s,i)}async createDepositAddress(e,t={}){await this.loadMarkets();const s={currency:this.currencyId(e)},i=await this.privatePostDepositAddresses(this.extend(s,t)),r=this.safeValue(i,"data",{});let a=this.safeString(r,"address");void 0!==a&&(a=a.replace("bitcoincash:",""));const n=this.safeString(r,"memo");return"NIM"!==e&&this.checkAddress(a),{info:i,currency:e,address:a,tag:n}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={currency:this.currencyId(e)},i=await this.privateGetDepositAddresses(this.extend(s,t)),r=this.safeValue(i,"data",{}),a=this.safeString(r,"address"),n=this.safeString(r,"memo");return"NIM"!==e&&this.checkAddress(a),{info:i,currency:e,address:a,tag:n}}async fetchL3OrderBook(e,t,s={}){return await this.fetchOrderBook(e,t,{level:3})}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.marketId(e),a=this.safeInteger(s,"level",2),n={symbol:i,level:a};let o="privateGetMarketOrderbookLevelLevel";if(2===a&&void 0!==t){if(20!==t&&100!==t)throw new r(this.id+" fetchOrderBook limit argument must be undefined, 20 or 100");n.limit=t,o="publicGetMarketOrderbookLevelLevelLimit"}const c=await this[o](this.extend(n,s)),d=this.safeValue(c,"data",{}),h=this.safeInteger(d,"time"),u=this.parseOrderBook(d,e,h,"bids","asks",a-2,a-1);return u.nonce=this.safeInteger(d,"sequence"),u}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.marketId(e),o=this.safeString2(a,"clientOid","clientOrderId",this.uuid());a=this.omit(a,["clientOid","clientOrderId"]);const c={clientOid:o,side:s,symbol:n,type:t},d=this.safeNumber2(a,"cost","funds");"market"===t?void 0!==d?(a=this.omit(a,["cost","funds"]),c.funds=this.amountToPrecision(e,d)):c.size=this.amountToPrecision(e,i):(c.price=this.priceToPrecision(e,r),c.size=this.amountToPrecision(e,i));const h=await this.privatePostOrders(this.extend(c,a)),u=this.safeValue(h,"data",{}),l=this.milliseconds(),f={id:this.safeString(u,"orderId"),clientOrderId:o,info:u,timestamp:l,datetime:this.iso8601(l),lastTradeTimestamp:void 0,symbol:e,type:t,side:s,price:r,amount:void 0,cost:void 0,average:void 0,filled:void 0,remaining:void 0,status:void 0,fee:void 0,trades:void 0};return void 0===d?f.amount=i:f.cost=d,f}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={},r=this.safeString2(s,"clientOid","clientOrderId");let a="privateDeleteOrdersOrderId";return void 0!==r?(i.clientOid=r,a="privateDeleteOrdersClientOrderClientOid"):i.orderId=e,s=this.omit(s,["clientOid","clientOrderId"]),await this[a](this.extend(i,s))}async cancelAllOrders(e,t={}){await this.loadMarkets();const s={};let i;return void 0!==e&&(i=this.market(e),s.symbol=i.id),await this.privateDeleteOrders(this.extend(s,t))}async fetchOrdersByStatus(e,t,s,i,r={}){await this.loadMarkets();const a={status:e};let n;void 0!==t&&(n=this.market(t),a.symbol=n.id),void 0!==s&&(a.startAt=s),void 0!==i&&(a.pageSize=i);const o=await this.privateGetOrders(this.extend(a,r)),c=this.safeValue(o,"data",{}),d=this.safeValue(c,"items",[]);return this.parseOrders(d,n,s,i)}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrdersByStatus("done",e,t,s,i)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrdersByStatus("active",e,t,s,i)}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={},r=this.safeString2(s,"clientOid","clientOrderId");let a="privateGetOrdersOrderId";if(void 0!==r)i.clientOid=r,a="privateGetOrdersClientOrderClientOid";else{if(void 0===e)throw new d(this.id+" fetchOrder() requires an order id");i.orderId=e}s=this.omit(s,["clientOid","clientOrderId"]);const n=await this[a](this.extend(i,s));let o;void 0!==t&&(o=this.market(t));const c=this.safeValue(n,"data");return this.parseOrder(c,o)}parseOrder(e,t){const s=this.safeString(e,"symbol"),i=this.safeSymbol(s,t,"-"),r=this.safeString(e,"id"),a=this.safeString(e,"type"),n=this.safeInteger(e,"createdAt"),o=this.iso8601(n);let c=this.safeNumber(e,"price");0===c&&(c=void 0);const d=this.safeString(e,"side"),h=this.safeString(e,"feeCurrency"),u=this.safeCurrencyCode(h),l=this.safeNumber(e,"fee"),f=this.safeNumber(e,"size"),p=this.safeNumber(e,"dealSize"),m=this.safeNumber(e,"dealFunds");let b=this.safeValue(e,"isActive",!1)?"open":"closed";b=this.safeValue(e,"cancelExist",!1)?"canceled":b;const g={currency:u,cost:l},y=this.safeString(e,"clientOid"),v=this.safeString(e,"timeInForce"),w=this.safeNumber(e,"stopPrice"),k=this.safeValue(e,"postOnly");return this.safeOrder({id:r,clientOrderId:y,symbol:i,type:a,timeInForce:v,postOnly:k,side:d,amount:f,price:c,stopPrice:w,cost:m,filled:p,remaining:void 0,timestamp:n,datetime:o,fee:g,status:b,info:e,lastTradeTimestamp:void 0,average:void 0,trades:void 0})}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const a={};let n;void 0!==e&&(n=this.market(e),a.symbol=n.id),void 0!==s&&(a.pageSize=s);const o=this.options.fetchMyTradesMethod;let c=!1;if("private_get_fills"===o)void 0!==t&&(a.startAt=t);else if("private_get_limit_fills"===o)c=!0;else{if("private_get_hist_orders"!==o)throw new r(this.id+" invalid fetchClosedOrder method");void 0!==t&&(a.startAt=parseInt(t/1e3))}const d=await this[o](this.extend(a,i)),h=this.safeValue(d,"data",{});let u;return u=c?h:this.safeValue(h,"items",[]),this.parseTrades(u,n,t,s)}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id};void 0!==t&&(a.startAt=Math.floor(t/1e3)),void 0!==s&&(a.pageSize=s);const n=await this.publicGetMarketHistories(this.extend(a,i)),o=this.safeValue(n,"data",[]);return this.parseTrades(o,r,t,s)}parseTrade(e,t){const s=this.safeString(e,"symbol"),i=this.safeSymbol(s,t,"-"),r=this.safeString2(e,"tradeId","id"),a=this.safeString(e,"orderId"),n=this.safeString(e,"liquidity");let o=this.safeInteger(e,"time");void 0!==o?o=parseInt(o/1e6):(o=this.safeInteger(e,"createdAt"),"dealValue"in e&&void 0!==o&&(o*=1e3));const c=this.safeString2(e,"price","dealPrice"),d=this.safeString2(e,"size","amount"),h=this.parseNumber(c),u=this.parseNumber(d),l=this.safeString(e,"side");let f;const p=this.safeNumber(e,"fee");if(void 0!==p){const s=this.safeString(e,"feeCurrency");let i=this.safeCurrencyCode(s);void 0===i&&void 0!==t&&(i="sell"===l?t.quote:t.base),f={cost:p,currency:i,rate:this.safeNumber(e,"feeRate")}}let m=this.safeString(e,"type");"match"===m&&(m=void 0);let b=this.safeNumber2(e,"funds","dealValue");return void 0===b&&(b=this.parseNumber(y.stringMul(c,d))),{info:e,id:r,order:a,timestamp:o,datetime:this.iso8601(o),symbol:i,type:m,takerOrMaker:n,side:l,price:h,amount:u,cost:b,fee:f}}async withdraw(e,t,s,i,r={}){await this.loadMarkets(),this.checkAddress(s);const a={currency:this.currencyId(e),address:s,amount:t};void 0!==i&&(a.memo=i);const n=await this.privatePostWithdrawals(this.extend(a,r)),o=this.safeValue(n,"data",{});return{id:this.safeString(o,"withdrawalId"),info:n}}parseTransactionStatus(e){return this.safeString({SUCCESS:"ok",PROCESSING:"ok",FAILURE:"failed"},e)}parseTransaction(e,t){const s=this.safeString(e,"currency"),i=this.safeCurrencyCode(s,t);let r=this.safeString(e,"address");const a=this.safeNumber(e,"amount");let n=this.safeString(e,"walletTxId");if(void 0!==n){const e=n.split("@");e.length>1&&void 0===r&&e[1].length>1&&(r=e[1]),n=e[0]}let o=void 0===n?"withdrawal":"deposit";const c=this.safeString(e,"status"),d=this.parseTransactionStatus(c);let h;const u=this.safeNumber(e,"fee");if(void 0!==u){let e;void 0!==a&&(e=u/a),h={cost:u,rate:e,currency:i}}const l=this.safeString(e,"memo");let f=this.safeInteger2(e,"createdAt","createAt");const p=this.safeString(e,"id");let m=this.safeInteger(e,"updatedAt");!("createdAt"in e)&&(o="address"in e?"withdrawal":"deposit",void 0!==f&&(f*=1e3),void 0!==m&&(m*=1e3));const b=this.safeString(e,"remark");return{id:p,info:e,timestamp:f,datetime:this.iso8601(f),address:r,addressTo:r,addressFrom:void 0,tag:l,tagTo:l,tagFrom:void 0,currency:i,amount:a,txid:n,type:o,status:d,comment:b,fee:h,updated:m}}async fetchDeposits(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.currency=a.id),void 0!==s&&(r.pageSize=s);let n="privateGetDeposits";void 0!==t&&(t<1550448e6?(r.startAt=parseInt(t/1e3),n="privateGetHistDeposits"):r.startAt=t);const o=(await this[n](this.extend(r,i))).data.items;return this.parseTransactions(o,a,t,s,{type:"deposit"})}async fetchWithdrawals(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.currency=a.id),void 0!==s&&(r.pageSize=s);let n="privateGetWithdrawals";void 0!==t&&(t<1550448e6?(r.startAt=parseInt(t/1e3),n="privateGetHistWithdrawals"):r.startAt=t);const o=(await this[n](this.extend(r,i))).data.items;return this.parseTransactions(o,a,t,s,{type:"withdrawal"})}async fetchBalance(e={}){await this.loadMarkets();const t=this.safeString2(this.options,"fetchBalance","defaultType","trade"),s=this.safeString(e,"type",t),i=this.safeValue(this.options,"accountsByType"),a=this.safeString(i,s);if(void 0===a){const e=Object.keys(i);throw new r(this.id+" type must be one of "+e.join(", "))}if(e=this.omit(e,"type"),"contract"===a){const t=await this.futuresPrivateGetAccountOverview(e),s={info:t,timestamp:void 0,datetime:void 0},i=this.safeValue(t,"data"),r=this.safeString(i,"currency"),a=this.safeCurrencyCode(r),n=this.account();return n.free=this.safeString(i,"availableBalance"),n.total=this.safeString(i,"accountEquity"),s[a]=n,this.parseBalance(s,!1)}{const t={type:a},s=await this.privateGetAccounts(this.extend(t,e)),i=this.safeValue(s,"data",[]),r={info:s,timestamp:void 0,datetime:void 0};for(let e=0;e<i.length;e++){const t=i[e];if(this.safeString(t,"type")===a){const e=this.safeString(t,"currency"),s=this.safeCurrencyCode(e),i=this.account();i.total=this.safeString(t,"balance"),i.free=this.safeString(t,"available"),i.used=this.safeString(t,"holds"),r[s]=i}}return this.parseBalance(r,!1)}}async transfer(e,t,s,i,a={}){await this.loadMarkets();const n=this.currency(e),o=this.currencyToPrecision(e,t),c=this.safeValue(this.options,"accountsByType",{}),d=this.safeString(c,s);if(void 0===d){const e=Object.keys(c);throw new r(this.id+" fromAccount must be one of "+e.join(", "))}const h=this.safeString(c,i);if(void 0===h){const e=Object.keys(c);throw new r(this.id+" toAccount must be one of "+e.join(", "))}if("contract"===d){if("main"!==h)throw new r(this.id+" only supports transferring from futures account to main account");const e={currency:n.id,amount:o};"bizNo"in a||(e.bizNo=this.uuid22());const t=await this.futuresPrivatePostTransferOut(this.extend(e,a)),s=this.safeValue(t,"data"),i=this.safeInteger(s,"createdAt"),c=this.safeString(s,"applyId"),u=this.safeString(s,"currency"),l=this.safeCurrencyCode(u),f=this.safeNumber(s,"amount");let p;return"PROCESSING"===this.safeString(s,"status")&&(p="pending"),{info:t,currency:l,timestamp:i,datetime:this.iso8601(i),amount:f,fromAccount:d,toAccount:h,id:c,status:p}}{const t={currency:n.id,from:d,to:h,amount:o};"clientOid"in a||(t.clientOid=this.uuid());const s=await this.privatePostAccountsInnerTransfer(this.extend(t,a)),i=this.safeValue(s,"data");return{info:s,id:this.safeString(i,"orderId"),timestamp:void 0,datetime:void 0,currency:e,amount:o,fromAccount:d,toAccount:h,status:void 0}}}async fetchLedger(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchLedger() requires a code param");await this.loadMarkets(),await this.loadAccounts();const n=this.currency(e);let o=this.safeString(i,"accountId");if(void 0===o)for(let t=0;t<this.accounts.length;t++){const s=this.accounts[t];if(s.currency===e&&"main"===s.type){o=s.id;break}}if(void 0===o)throw new r(this.id+" "+e+"main account is not loaded in loadAccounts");const c={accountId:o};void 0!==t&&(c.startAt=Math.floor(t/1e3));const d=(await this.privateGetAccountsAccountIdLedgers(this.extend(c,i))).data.items;return this.parseLedger(d,n,t,s)}parseLedgerEntry(e,t){const s=this.safeString(e,"currency"),i=this.safeCurrencyCode(s,t),r={cost:this.safeNumber(e,"fee"),code:i},a=this.safeNumber(e,"amount"),n=this.safeNumber(e,"balance"),o=this.safeString(e,"direction");let c;if(void 0!==n&&void 0!==a){const e="out"===o?a:-a;c=this.sum(n,e)}const d=this.safeInteger(e,"createdAt"),h=this.parseLedgerEntryType(this.safeString(e,"bizType")),u=this.safeString(e,"context");let l,f;if(this.isJsonEncodedObject(u)){const e=this.parseJson(u);l=this.safeString(e,"orderId"),"trade"===h?f=this.safeString(e,"tradeId"):"transaction"===h&&(f=this.safeString(e,"txId"))}return{id:l,currency:i,account:void 0,referenceAccount:void 0,referenceId:f,status:void 0,amount:a,before:c,after:n,fee:r,direction:o,timestamp:d,datetime:this.iso8601(d),type:h,info:e}}parseLedgerEntryType(e){return this.safeString({Exchange:"trade",Withdrawal:"transaction",Deposit:"transaction",Transfer:"transfer"},e,e)}async fetchPositions(e,t={}){const s=await this.futuresPrivateGetPositions(t);return this.safeValue(s,"data",s)}sign(e,t="public",s="GET",i={},r,a){const n=this.safeValue(this.options,"versions",{}),o=this.safeValue(n,t,{}),c=this.safeValue(o,s,{}),d=this.safeString(c,e,this.options.version),h=this.safeString(i,"version",d);i=this.omit(i,"version");let u="/api/"+h+"/"+this.implodeParams(e,i);const l=this.omit(i,this.extractParams(e));let f="";r=void 0!==r?r:{},Object.keys(l).length&&("GET"===s||"DELETE"===s?u+="?"+this.urlencode(l):(f=a=this.json(l),r["Content-Type"]="application/json"));const p=this.urls.api[t]+u;if("private"===t||"futuresPrivate"===t){this.checkRequiredCredentials();const e=this.nonce().toString();r=this.extend({"KC-API-KEY-VERSION":"2","KC-API-KEY":this.apiKey,"KC-API-TIMESTAMP":e},r);if("2"===this.safeString(r,"KC-API-KEY-VERSION")){const e=this.hmac(this.encode(this.password),this.encode(this.secret),"sha256","base64");r["KC-API-PASSPHRASE"]=e}else r["KC-API-PASSPHRASE"]=this.password;const t=e+s+u+f,i=this.hmac(this.encode(t),this.encode(this.secret),"sha256","base64");r["KC-API-SIGN"]=i;const a=this.safeValue(this.options,"partner",{}),n=this.safeString(a,"id"),o=this.safeString(a,"secret");if(void 0!==n&&void 0!==o){const t=e+n+this.apiKey,s=this.hmac(this.encode(t),this.encode(o),"sha256","base64");r["KC-API-PARTNER-SIGN"]=s,r["KC-API-PARTNER"]=n}}return{url:p,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,a,n,o,c){if(!n)return void this.throwBroadlyMatchedException(this.exceptions.broad,a,a);const d=this.safeString(n,"code"),h=this.safeString(n,"msg","");this.throwExactlyMatchedException(this.exceptions.exact,h,this.id+" "+h),this.throwExactlyMatchedException(this.exceptions.exact,d,this.id+" "+h)}}},3112:(e,t,s)=>{"use strict";const i=s(8819),{ArgumentsRequired:r,InsufficientFunds:a,OrderNotFound:n}=s(3449),o=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"kuna",name:"Kuna",countries:["UA"],rateLimit:1e3,version:"v2",has:{CORS:!1,cancelOrder:!0,createOrder:!0,fetchBalance:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:"emulated",fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,withdraw:!1},timeframes:void 0,urls:{extension:".json",referral:"https://kuna.io?r=kunaid-gvfihe8az7o4",logo:"https://user-images.githubusercontent.com/51840849/87153927-f0578b80-c2c0-11ea-84b6-74612568e9e1.jpg",api:"https://kuna.io",www:"https://kuna.io",doc:"https://kuna.io/documents/api",fees:"https://kuna.io/documents/api"},api:{public:{get:["depth","k_with_pending_trades","k","markets","order_book","order_book/{market}","tickers","tickers/{market}","timestamp","trades","trades/{market}"]},private:{get:["members/me","deposits","deposit","deposit_address","orders","order","trades/my","withdraws","withdraw"],post:["orders","orders/multi","orders/clear","order/delete","withdraw"]}},fees:{trading:{tierBased:!1,percentage:!0,taker:.0025,maker:.0025},funding:{withdraw:{UAH:"1%",BTC:.001,BCH:.001,ETH:.01,WAVES:.01,GOL:0,GBG:0},deposit:{}}},commonCurrencies:{PLA:"Plair"},exceptions:{2002:a,2003:n}})}async fetchTime(e={}){return 1e3*await this.publicGetTimestamp(e)}async fetchMarkets(e={}){const t=["btc","rub","uah","usd","usdt","usdc"],s={UAH:0},i=[],r=await this.publicGetTickers(e),a=Object.keys(r);for(let e=0;e<a.length;e++){const r=a[e];for(let e=0;e<t.length;e++){const a=t[e],n=r.indexOf(a),o=r.slice(n);if(n>0&&o===a){const e=r.replace(a,""),t=this.safeCurrencyCode(e),n=this.safeCurrencyCode(a),o=t+"/"+n,c={amount:6,price:this.safeInteger(s,n,6)};i.push({id:r,symbol:o,base:t,quote:n,baseId:e,quoteId:a,precision:c,limits:{amount:{min:Math.pow(10,-c.amount),max:Math.pow(10,c.amount)},price:{min:Math.pow(10,-c.price),max:Math.pow(10,c.price)},cost:{min:void 0,max:void 0}},active:void 0,info:void 0});break}}}return i}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={market:this.market(e).id};void 0!==t&&(i.limit=t);const r=await this.publicGetDepth(this.extend(i,s)),a=this.safeTimestamp(r,"timestamp");return this.parseOrderBook(r,e,a)}parseTicker(e,t){const s=this.safeTimestamp(e,"at");let i;e=e.ticker,t&&(i=t.symbol);const r=this.safeNumber(e,"last");return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"buy"),bidVolume:void 0,ask:this.safeNumber(e,"sell"),askVolume:void 0,vwap:void 0,open:this.safeNumber(e,"open"),close:r,last:r,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(e,"vol"),quoteVolume:void 0,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTickers(t),i=Object.keys(s),r={};for(let e=0;e<i.length;e++){const t=i[e];let a,n=t;if(t in this.markets_by_id)a=this.markets_by_id[t],n=a.symbol;else{let e=t.slice(0,3),s=t.slice(3,6);e=e.toUpperCase(),s=s.toUpperCase(),e=this.safeCurrencyCode(e),s=this.safeCurrencyCode(s),n=e+"/"+s}r[n]=this.parseTicker(s[t],a)}return this.filterByArray(r,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={market:s.id},r=await this.publicGetTickersMarket(this.extend(i,t));return this.parseTicker(r,s)}async fetchL3OrderBook(e,t,s={}){return await this.fetchOrderBook(e,t,s)}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={market:r.id},n=await this.publicGetTrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}parseTrade(e,t){const s=this.parse8601(this.safeString(e,"created_at"));let i;t&&(i=t.symbol);let r=this.safeString2(e,"side","trend");if(void 0!==r){const e={ask:"sell",bid:"buy"};r=this.safeString(e,r,r)}const a=this.safeString(e,"price"),n=this.safeString(e,"volume"),c=this.parseNumber(a),d=this.parseNumber(n);let h=this.safeNumber(e,"funds");void 0===h&&(h=this.parseNumber(o.stringMul(a,n)));const u=this.safeString(e,"order_id");return{id:this.safeString(e,"id"),info:e,timestamp:s,datetime:this.iso8601(s),symbol:i,type:void 0,side:r,order:u,takerOrMaker:void 0,price:c,amount:d,cost:h,fee:void 0}}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=await this.fetchTrades(e,s,i,r),n=this.buildOHLCVC(a,t,s,i),o=[];for(let e=0;e<n.length;e++){const t=n[e];o.push([t[0],t[1],t[2],t[3],t[4],t[5]])}return o}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetMembersMe(e),s=this.safeValue(t,"accounts"),i={info:s};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"currency"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(t,"balance"),n.used=this.safeString(t,"locked"),i[a]=n}return this.parseBalance(i,!1)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n={market:this.marketId(e),side:s,volume:i.toString(),ord_type:t};"limit"===t&&(n.price=r.toString());const o=await this.privatePostOrders(this.extend(n,a)),c=this.safeValue(o,"market"),d=this.safeValue(this.markets_by_id,c);return this.parseOrder(o,d)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={id:e},r=await this.privatePostOrderDelete(this.extend(i,s)),a=this.parseOrder(r),o=a.status;if("closed"===o||"canceled"===o)throw new n(this.id+" "+this.json(a));return a}parseOrderStatus(e){return this.safeString({done:"closed",wait:"open",cancel:"canceled"},e,e)}parseOrder(e,t){const s=this.safeString(e,"market"),i=this.safeSymbol(s,t),r=this.parse8601(this.safeString(e,"created_at")),a=this.parseOrderStatus(this.safeString(e,"state")),n=this.safeString(e,"type"),o=this.safeString(e,"side"),c=this.safeString(e,"id");return this.safeOrder({id:c,clientOrderId:void 0,timestamp:r,datetime:this.iso8601(r),lastTradeTimestamp:void 0,status:a,symbol:i,type:n,timeInForce:void 0,postOnly:void 0,side:o,price:this.safeNumber(e,"price"),stopPrice:void 0,amount:this.safeNumber(e,"volume"),filled:this.safeNumber(e,"executed_volume"),remaining:this.safeNumber(e,"remaining_volume"),trades:void 0,fee:void 0,info:e,cost:void 0,average:void 0})}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={id:parseInt(e)},r=await this.privateGetOrder(this.extend(i,s));return this.parseOrder(r)}async fetchOpenOrders(e,t,s,i={}){if(void 0===e)throw new r(this.id+" fetchOpenOrders() requires a symbol argument");await this.loadMarkets();const a=this.market(e),n={market:a.id},o=await this.privateGetOrders(this.extend(n,i));return this.parseOrders(o,a,t,s)}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new r(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const a=this.market(e),n={market:a.id},o=await this.privateGetTradesMy(this.extend(n,i));return this.parseTrades(o,a,t,s)}nonce(){return this.milliseconds()}encodeParams(e){if("orders"in e){const t=e.orders;let s=this.urlencode(this.keysort(this.omit(e,"orders")));for(let e=0;e<t.length;e++){const i=t[e],r=Object.keys(i);for(let e=0;e<r.length;e++){const t=r[e];s+="&orders%5B%5D%5B"+t+"%5D="+i[t].toString()}}return s}return this.urlencode(this.keysort(e))}sign(e,t="public",s="GET",i={},r,a){let n="/api/"+this.version+"/"+this.implodeParams(e,i);"extension"in this.urls&&(n+=this.urls.extension);const o=this.omit(i,this.extractParams(e));let c=this.urls.api+n;if("public"===t)Object.keys(o).length&&(c+="?"+this.urlencode(o));else{this.checkRequiredCredentials();const e=this.nonce().toString(),t=this.encodeParams(this.extend({access_key:this.apiKey,tonce:e},i)),o=s+"|"+n+"|"+t,d=t+"&signature="+this.hmac(this.encode(o),this.encode(this.secret));"GET"===s?c+="?"+d:(a=d,r={"Content-Type":"application/x-www-form-urlencoded"})}return{url:c,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,a,n,o,c){if(void 0!==n&&400===e){const e=this.safeValue(n,"error"),t=this.safeString(e,"code"),s=this.id+" "+this.json(n);this.throwExactlyMatchedException(this.exceptions,t,s)}}}},2444:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,InvalidNonce:n,OrderNotFound:o,InvalidOrder:c,DDoSProtection:d,BadRequest:h,AuthenticationError:u}=s(3449),l=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"latoken",name:"Latoken",countries:["KY"],version:"v1",rateLimit:2e3,certified:!1,userAgent:this.userAgents.chrome,has:{CORS:!1,publicAPI:!0,privateAPI:!0,cancelOrder:!0,cancelAllOrders:!0,createMarketOrder:!1,createOrder:!0,fetchBalance:!0,fetchCanceledOrders:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchMyTrades:!0,fetchOpenOrders:!0,fetchOrder:!1,fetchOrdersByStatus:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/61511972-24c39f00-aa01-11e9-9f7c-471f1d6e5214.jpg",api:"https://api.latoken.com",www:"https://latoken.com",doc:["https://api.latoken.com"]},api:{public:{get:["ExchangeInfo/time","ExchangeInfo/limits","ExchangeInfo/pairs","ExchangeInfo/pairs/{currency}","ExchangeInfo/pair","ExchangeInfo/currencies","ExchangeInfo/currencies/{symbol}","MarketData/tickers","MarketData/ticker/{symbol}","MarketData/orderBook/{symbol}","MarketData/orderBook/{symbol}/{limit}","MarketData/trades/{symbol}","MarketData/trades/{symbol}/{limit}"]},private:{get:["Account/balances","Account/balances/{currency}","Order/status","Order/active","Order/get_order","Order/trades"],post:["Order/new","Order/test-order","Order/cancel","Order/cancel_all"]}},fees:{trading:{feeSide:"get",tierBased:!1,percentage:!0,maker:.001,taker:.001}},commonCurrencies:{MT:"Monarch",TSL:"Treasure SL"},options:{createOrderMethod:"private_post_order_new"},exceptions:{exact:{"Signature or ApiKey is not valid":u,"Request is out of time":n,"Symbol must be specified":h},broad:{"Request limit reached":d,Pair:h,"Price needs to be greater than":c,"Amount needs to be greater than":c,"The Symbol field is required":c,"OrderType is not valid":c,"Side is not valid":c,"Cancelable order whit":o,Order:o}}})}nonce(){return this.milliseconds()}async fetchTime(e={}){const t=await this.publicGetExchangeInfoTime(e);return this.safeInteger(t,"unixTimeMiliseconds")}async fetchMarkets(e={}){const t=await this.publicGetExchangeInfoPairs(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"symbol"),a=this.safeString(i,"baseCurrency"),n=this.safeString(i,"quotedCurrency"),o=this.safeInteger(i,"pairId"),c=this.safeCurrencyCode(a),d=this.safeCurrencyCode(n),h=c+"/"+d,u=this.safeString(i,"pricePrecision"),l=this.parsePrecision(u),f={price:parseInt(u),amount:this.safeInteger(i,"amountPrecision")},p={amount:{min:this.safeNumber(i,"minQty"),max:void 0},price:{min:this.parseNumber(l),max:void 0},cost:{min:void 0,max:void 0}};s.push({id:r,numericId:o,info:i,symbol:h,base:c,quote:d,baseId:a,quoteId:n,active:void 0,precision:f,limits:p})}return s}async fetchCurrencies(e={}){const t=await this.publicGetExchangeInfoCurrencies(e),s={};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"symbol"),a=this.safeInteger(i,"currencyId"),n=this.safeCurrencyCode(r),o=this.safeInteger(i,"precission"),c=this.safeNumber(i,"fee"),d=void 0;s[n]={id:r,numericId:a,code:n,info:i,name:n,active:d,fee:c,precision:o,limits:{amount:{min:void 0,max:void 0},withdraw:{min:void 0,max:void 0}}}}return s}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetAccountBalances(e),s={info:t,timestamp:void 0,datetime:void 0};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"symbol"),a=this.safeCurrencyCode(r),n=this.safeString(i,"frozen"),o=this.safeString(i,"pending"),c=this.account();c.used=l.stringAdd(n,o),c.free=this.safeString(i,"available"),c.total=this.safeString(i,"amount"),s[a]=c}return this.parseBalance(s,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.market(e).id,limit:10};void 0!==t&&(i.limit=t);const r=await this.publicGetMarketDataOrderBookSymbolLimit(this.extend(i,s));return this.parseOrderBook(r,e,void 0,"bids","asks","price","quantity")}parseTicker(e,t){const s=this.safeString(e,"symbol"),i=this.safeSymbol(s,t),r=this.safeNumber(e,"open"),a=this.safeNumber(e,"close");let n;void 0!==r&&void 0!==a&&(n=a-r);const o=this.safeNumber(e,"priceChange"),c=this.nonce();return{symbol:i,timestamp:c,datetime:this.iso8601(c),low:this.safeNumber(e,"low"),high:this.safeNumber(e,"high"),bid:void 0,bidVolume:void 0,ask:void 0,askVolume:void 0,vwap:void 0,open:r,close:a,last:a,previousClose:void 0,change:n,percentage:o,average:void 0,baseVolume:void 0,quoteVolume:this.safeNumber(e,"volume"),info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.publicGetMarketDataTickerSymbol(this.extend(i,t));return this.parseTicker(r,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetMarketDataTickers(t),i={};for(let e=0;e<s.length;e++){const t=this.parseTicker(s[e]);i[t.symbol]=t}return this.filterByArray(i,"symbol",e)}parseTrade(e,t){let s=this.safeInteger2(e,"timestamp","time");void 0!==s&&s<12309408e5&&(s*=1e3);const i=this.safeString(e,"price"),r=this.safeString(e,"amount"),a=this.parseNumber(i),n=this.parseNumber(r),o=this.parseNumber(l.stringMul(i,r)),c=this.safeString(e,"side");let d;void 0!==t&&(d=t.symbol);const h=this.safeString(e,"id"),u=this.safeString(e,"orderId"),f=this.safeNumber(e,"commission");let p;return void 0!==f&&(p={cost:f,currency:void 0}),{info:e,timestamp:s,datetime:this.iso8601(s),symbol:d,id:h,order:u,type:undefined,takerOrMaker:void 0,side:c,price:a,amount:n,cost:o,fee:p}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id};void 0!==s&&(a.limit=s);const n=await this.publicGetMarketDataTradesSymbol(this.extend(a,i)),o=this.safeValue(n,"trades",[]);return this.parseTrades(o,r,t,s)}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const r=this.market(e),n={symbol:r.id},o=await this.privateGetOrderTrades(this.extend(n,i)),c=this.safeValue(o,"trades",[]);return this.parseTrades(c,r,t,s)}parseOrderStatus(e){return this.safeString({active:"open",partiallyFilled:"open",filled:"closed",cancelled:"canceled"},e,e)}parseOrder(e,t){const s=this.safeString(e,"orderId"),i=this.safeTimestamp(e,"timeCreated"),r=this.safeString(e,"symbol"),a=this.safeSymbol(r,t),n=this.safeString(e,"side"),o=this.safeString(e,"orderType"),c=this.safeNumber(e,"price"),d=this.safeNumber(e,"amount"),h=this.safeNumber(e,"executedAmount"),u=this.parseOrderStatus(this.safeString(e,"orderStatus")),l=this.safeTimestamp(e,"timeFilled");let f;void 0!==l&&l>0&&(f=l);const p=this.safeString(e,"cliOrdId");return this.safeOrder({id:s,clientOrderId:p,info:e,timestamp:i,datetime:this.iso8601(i),lastTradeTimestamp:f,status:u,symbol:a,type:o,timeInForce:void 0,postOnly:void 0,side:n,price:c,stopPrice:void 0,cost:void 0,amount:d,filled:h,average:void 0,remaining:void 0,fee:void 0,trades:void 0})}async fetchOpenOrders(e,t,s,i={}){return this.fetchOrdersWithMethod("private_get_order_active",e,t,s,i)}async fetchClosedOrders(e,t,s,i={}){return this.fetchOrdersByStatus("filled",e,t,s,i)}async fetchCanceledOrders(e,t,s,i={}){return this.fetchOrdersByStatus("cancelled",e,t,s,i)}async fetchOrdersByStatus(e,t,s,i,r={}){const a={status:e};return this.fetchOrdersWithMethod("private_get_order_status",t,s,i,this.extend(a,r))}async fetchOrdersWithMethod(e,t,s,i,r={}){if(void 0===t)throw new a(this.id+" fetchOrdersWithMethod() requires a symbol argument");await this.loadMarkets();const n=this.market(t),o={symbol:n.id};void 0!==i&&(o.limit=i);const c=await this[e](this.extend(o,r));return this.parseOrders(c,n,s,i)}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={orderId:e},r=await this.privateGetOrderGetOrder(this.extend(i,s));return this.parseOrder(r)}async createOrder(e,t,s,i,a,n={}){if(await this.loadMarkets(),"limit"!==t)throw new r(this.id+" allows limit orders only");const o={symbol:this.marketId(e),side:s,price:this.priceToPrecision(e,a),amount:this.amountToPrecision(e,i),orderType:t},c=this.safeString(this.options,"createOrderMethod","private_post_order_new"),d=await this[c](this.extend(o,n));return this.parseOrder(d)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={orderId:e},r=await this.privatePostOrderCancel(this.extend(i,s));return this.parseOrder(r)}async cancelAllOrders(e,t={}){if(void 0===e)throw new a(this.id+" cancelAllOrders() requires a symbol argument");await this.loadMarkets();const s=this.marketId(e),i={symbol:s},r=await this.privatePostOrderCancelAll(this.extend(i,t)),n=[],o=this.safeValue(r,"cancelledOrders",[]);for(let e=0;e<o.length;e++){const t=this.parseOrder({symbol:s,orderId:o[e],orderStatus:"canceled"});n.push(t)}return n}sign(e,t="public",s="GET",i,r,a){let n="/api/"+this.version+"/"+this.implodeParams(e,i),o=this.omit(i,this.extractParams(e));if("private"===t){const e=this.nonce();o=this.extend({timestamp:e},o)}const c=this.urlencode(o);if(Object.keys(o).length&&(n+="?"+c),"private"===t){this.checkRequiredCredentials();const e=this.hmac(this.encode(n),this.encode(this.secret));r={"X-LA-KEY":this.apiKey,"X-LA-SIGNATURE":e},"POST"===s&&(r["Content-Type"]="application/x-www-form-urlencoded",a=c)}return{url:this.urls.api+n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(!o)return;const h=this.safeString(o,"message"),u=this.id+" "+n;void 0!==h&&(this.throwExactlyMatchedException(this.exceptions.exact,h,u),this.throwBroadlyMatchedException(this.exceptions.broad,h,u));const l=this.safeValue(o,"error",{}),f=this.safeString(l,"message");if(void 0!==f)throw this.throwExactlyMatchedException(this.exceptions.exact,f,u),this.throwBroadlyMatchedException(this.exceptions.broad,f,u),new r(u)}}},1524:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,DDoSProtection:a,AuthenticationError:n,InvalidOrder:o,ArgumentsRequired:c}=s(3449),d=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"lbank",name:"LBank",countries:["CN"],version:"v1",has:{cancelOrder:!0,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchMarkets:!0,fetchOHLCV:!0,fetchOpenOrders:!1,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,withdraw:!0},timeframes:{"1m":"minute1","5m":"minute5","15m":"minute15","30m":"minute30","1h":"hour1","2h":"hour2","4h":"hour4","6h":"hour6","8h":"hour8","12h":"hour12","1d":"day1","1w":"week1"},urls:{logo:"https://user-images.githubusercontent.com/1294454/38063602-9605e28a-3302-11e8-81be-64b1e53c4cfb.jpg",api:"https://api.lbank.info",www:"https://www.lbank.info",doc:"https://github.com/LBank-exchange/lbank-official-api-docs",fees:"https://lbankinfo.zendesk.com/hc/en-gb/articles/360012072873-Trading-Fees",referral:"https://www.lbex.io/invite?icode=7QCY"},api:{public:{get:["currencyPairs","ticker","depth","trades","kline","accuracy"]},private:{post:["user_info","create_order","cancel_order","orders_info","orders_info_history","withdraw","withdrawCancel","withdraws","withdrawConfigs"]}},fees:{trading:{maker:.001,taker:.001},funding:{withdraw:{BTC:void 0,ZEC:.01,ETH:.01,ETC:.01,VEN:10,BCH:2e-4,SC:50,BTM:20,NAS:1,EOS:1,XWC:5,BTS:1,INK:10,BOT:3,YOYOW:15,TGC:10,NEO:0,CMT:20,SEER:2e3,FIL:void 0,BTG:void 0}}},commonCurrencies:{VET_ERC20:"VEN",PNT:"Penta"},options:{cacheSecretAsPem:!0}})}async fetchMarkets(e={}){const t=await this.publicGetAccuracy(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=i.symbol,a=r.split("_");let n,o;a.length>2?(n=a[0]+"_"+a[1],o=a[2]):(n=a[0],o=a[1]);const c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o),h=c+"/"+d,u={amount:this.safeInteger(i,"quantityAccuracy"),price:this.safeInteger(i,"priceAccuracy")};s.push({id:r,symbol:h,base:c,quote:d,baseId:n,quoteId:o,active:!0,precision:u,limits:{amount:{min:Math.pow(10,-u.amount),max:void 0},price:{min:Math.pow(10,-u.price),max:Math.pow(10,u.price)},cost:{min:void 0,max:void 0}},info:r})}return s}parseTicker(e,t){let s;if(void 0===t){const t=this.safeString(e,"symbol");if(t in this.markets_by_id){s=this.markets_by_id[t].symbol}else{const e=t.split("_");let i,r;e.length>2?(i=e[0]+"_"+e[1],r=e[2]):(i=e[0],r=e[1]);s=this.safeCurrencyCode(i)+"/"+this.safeCurrencyCode(r)}}const i=this.safeInteger(e,"timestamp"),r=e;e=r.ticker;const a=this.safeNumber(e,"latest"),n=this.safeNumber(e,"change");let o,c,d;if(void 0!==n){const e=this.sum(1,n/100);e>0&&(o=a/this.sum(1,e))}return void 0!==a&&void 0!==o&&(c=a-o,d=this.sum(a,o)/2),void 0!==t&&(s=t.symbol),{symbol:s,timestamp:i,datetime:this.iso8601(i),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:void 0,bidVolume:void 0,ask:void 0,askVolume:void 0,vwap:void 0,open:void 0,close:a,last:a,previousClose:void 0,change:c,percentage:n,average:d,baseVolume:this.safeNumber(e,"vol"),quoteVolume:this.safeNumber(e,"turnover"),info:r}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.publicGetTicker(this.extend(i,t));return this.parseTicker(r,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTicker(this.extend({symbol:"all"},t)),i={};for(let e=0;e<s.length;e++){const t=this.parseTicker(s[e]);i[t.symbol]=t}return this.filterByArray(i,"symbol",e)}async fetchOrderBook(e,t=60,s={}){await this.loadMarkets();let i=60;void 0!==t&&(i=Math.min(t,i));const r={symbol:this.marketId(e),size:i},a=await this.publicGetDepth(this.extend(r,s));return this.parseOrderBook(a,e)}parseTrade(e,t){let s;void 0!==t&&(s=t.symbol);const i=this.safeInteger(e,"date_ms"),r=this.safeString(e,"price"),a=this.safeString(e,"amount"),n=this.parseNumber(r),o=this.parseNumber(a),c=this.parseNumber(d.stringMul(r,a)),h=this.safeString(e,"tid");let u=this.safeString(e,"type");return u=u.replace("_market",""),{id:h,info:this.safeValue(e,"info",e),timestamp:i,datetime:this.iso8601(i),symbol:s,order:void 0,type:undefined,side:u,takerOrMaker:void 0,price:n,amount:o,cost:c,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id,size:100};void 0!==t&&(a.time=parseInt(t)),void 0!==s&&(a.size=s);const n=await this.publicGetTrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}parseOHLCV(e,t){return[this.safeTimestamp(e,0),this.safeNumber(e,1),this.safeNumber(e,2),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,5)]}async fetchOHLCV(e,t="5m",s,i=1e3,r={}){await this.loadMarkets();const a=this.market(e);if(void 0===s)throw new c(this.id+" fetchOHLCV() requires a `since` argument");if(void 0===i)throw new c(this.id+" fetchOHLCV() requires a `limit` argument");const n={symbol:a.id,type:this.timeframes[t],size:i,time:parseInt(s/1e3)},o=await this.publicGetKline(this.extend(n,r));return this.parseOHLCVs(o,a,t,s,i)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostUserInfo(e),s={info:t,timestamp:void 0,datetime:void 0},i=this.safeValue(t,"info",{}),r=this.safeValue(i,"free",{}),a=this.safeValue(i,"freeze",{}),n=this.safeValue(i,"asset",{}),o=Object.keys(r);for(let e=0;e<o.length;e++){const t=o[e],i=this.safeCurrencyCode(t),c=this.account();c.free=this.safeString(r,t),c.used=this.safeString(a,t),c.total=this.safeString(n,t),s[i]=c}return this.parseBalance(s,!1)}parseOrderStatus(e){return this.safeString({"-1":"cancelled",0:"open",1:"open",2:"closed",4:"closed"},e)}parseOrder(e,t){const s=this.safeString(e,"symbol"),i=this.safeSymbol(s,t,"_"),r=this.safeInteger(e,"create_time"),a=this.safeNumber(e,"price"),n=this.safeNumber(e,"amount",0),o=this.safeNumber(e,"deal_amount",0),c=this.safeNumber(e,"avg_price"),d=this.parseOrderStatus(this.safeString(e,"status")),h=this.safeString(e,"order_id"),u=this.safeString(e,"order_type"),l=this.safeString(e,"type");return this.safeOrder({id:h,clientOrderId:void 0,datetime:this.iso8601(r),timestamp:r,lastTradeTimestamp:void 0,status:d,symbol:i,type:u,timeInForce:void 0,postOnly:void 0,side:l,price:a,stopPrice:void 0,cost:void 0,amount:n,filled:o,remaining:void 0,trades:void 0,fee:void 0,info:this.safeValue(e,"info",e),average:c})}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e);let o={symbol:n.id,type:s,amount:i};"market"===t?o.type+="_market":o.price=r;const c=await this.privatePostCreateOrder(this.extend(o,a));return o=this.omit(o,"type"),o.order_id=c.order_id,o.type=s,o.order_type=t,o.create_time=this.milliseconds(),o.info=c,this.parseOrder(o,n)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={symbol:this.market(t).id,order_id:e};return await this.privatePostCancelOrder(this.extend(i,s))}async fetchOrder(e,t,s={}){await this.loadMarkets();const i=this.market(t),r={symbol:i.id,order_id:e},a=await this.privatePostOrdersInfo(this.extend(r,s)),n=this.safeValue(a,"orders",[]),o=this.parseOrders(n,i);return 1===o.length?o[0]:o}async fetchOrders(e,t,s,i={}){await this.loadMarkets(),void 0===s&&(s=100);const r={symbol:this.market(e).id,current_page:1,page_length:s},a=await this.privatePostOrdersInfoHistory(this.extend(r,i)),n=this.safeValue(a,"orders",[]);return this.parseOrders(n,void 0,t,s)}async fetchClosedOrders(e,t,s,i={}){const r=await this.fetchOrders(e,t,s,i),a=this.filterBy(r,"status","closed"),n=this.filterBy(r,"status","cancelled"),o=this.arrayConcat(a,n);return this.filterBySymbolSinceLimit(o,e,t,s)}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a={assetCode:this.currency(e).id,amount:t,account:s};void 0!==i&&(a.memo=i);const n=this.privatePostWithdraw(this.extend(a,r));return{id:this.safeString(n,"id"),info:n}}convertSecretToPem(e){const t=e.length-0;let s=parseInt(t/64);s=this.sum(s,1);let i="-----BEGIN PRIVATE KEY-----\n";for(let e=0;e<s;e++){const t=64*e,s=this.sum(t,64);i+=this.secret.slice(t,s)+"\n"}return i+"-----END PRIVATE KEY-----"}sign(e,t="public",s="GET",i={},r,a){const n=this.omit(i,this.extractParams(e));let o=this.urls.api+"/"+this.version+"/"+this.implodeParams(e,i);if(o+=".do","public"===t)Object.keys(n).length&&(o+="?"+this.urlencode(n));else{this.checkRequiredCredentials();const e=this.keysort(this.extend({api_key:this.apiKey},i)),t=this.rawencode(e),s=this.hash(this.encode(t)).toUpperCase();let n;this.safeValue(this.options,"cacheSecretAsPem",!0)?(n=this.safeValue(this.options,"pem"),void 0===n&&(n=this.convertSecretToPem(this.secret),this.options.pem=n)):n=this.convertSecretToPem(this.secret);const o=this.binaryToBase64(this.rsa(s,this.encode(n),"RS256"));e.sign=o,a=this.urlencode(e),r={"Content-Type":"application/x-www-form-urlencoded"}}return{url:o,method:s,body:a,headers:r}}async request(e,t="public",s="GET",i={},c,d){const h=await this.fetch2(e,t,s,i,c,d);if("false"===this.safeString(h,"result")){const e=this.safeString(h,"error_code"),t=this.safeString({1e4:"Internal error",10001:"The required parameters can not be empty",10002:"verification failed",10003:"Illegal parameters",10004:"User requests are too frequent",10005:"Key does not exist",10006:"user does not exist",10007:"Invalid signature",10008:"This currency pair is not supported",10009:"Limit orders can not be missing orders and the number of orders",10010:"Order price or order quantity must be greater than 0",10011:"Market orders can not be missing the amount of the order",10012:"market sell orders can not be missing orders",10013:"is less than the minimum trading position 0.001",10014:"Account number is not enough",10015:"The order type is wrong",10016:"Account balance is not enough",10017:"Abnormal server",10018:"order inquiry can not be more than 50 less than one",10019:"withdrawal orders can not be more than 3 less than one",10020:"less than the minimum amount of the transaction limit of 0.001",10022:"Insufficient key authority"},e,this.json(h));throw new(this.safeValue({10002:n,10004:a,10005:n,10006:n,10007:n,10009:o,10010:o,10011:o,10012:o,10013:o,10014:o,10015:o,10016:o,10022:n},e,r))(t)}return h}}},4352:(e,t,s)=>{"use strict";const i=s(8819),{TICK_SIZE:r}=s(2115),{ExchangeError:a,ArgumentsRequired:n,InvalidNonce:o,OrderNotFound:c,InvalidOrder:d,InsufficientFunds:h,AuthenticationError:u,DDoSProtection:l,NotSupported:f,BadSymbol:p}=s(3449),m=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"liquid",name:"Liquid",countries:["JP","CN","TW"],version:"2",rateLimit:1e3,has:{cancelOrder:!0,CORS:!1,createOrder:!0,editOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,withdraw:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/45798859-1a872600-bcb4-11e8-8746-69291ce87b04.jpg",api:"https://api.liquid.com",www:"https://www.liquid.com",doc:["https://developers.liquid.com"],fees:"https://help.liquid.com/getting-started-with-liquid/the-platform/fee-structure",referral:"https://www.liquid.com/sign-up/?affiliate=SbzC62lt30976"},api:{public:{get:["currencies","products","products/{id}","products/{id}/price_levels","executions","ir_ladders/{currency}","fees"]},private:{get:["accounts","accounts/balance","accounts/main_asset","accounts/{id}","accounts/{currency}/reserved_balance_details","crypto_accounts","crypto_withdrawals","executions/me","fiat_accounts","fund_infos","loan_bids","loans","orders","orders/{id}","orders/{id}/trades","trades","trades/{id}/loans","trading_accounts","trading_accounts/{id}","transactions","withdrawals"],post:["crypto_withdrawals","fund_infos","fiat_accounts","loan_bids","orders","withdrawals"],put:["crypto_withdrawal/{id}/cancel","loan_bids/{id}/close","loans/{id}","orders/{id}","orders/{id}/cancel","trades/{id}","trades/{id}/adjust_margin","trades/{id}/close","trades/close_all","trading_accounts/{id}","withdrawals/{id}/cancel"]}},fees:{trading:{tierBased:!0,percentage:!0,taker:.003,maker:0,tiers:{perpetual:{maker:[[0,0],[25e3,0],[5e4,-25e-5],[1e5,-25e-5],[1e6,-25e-5],[1e7,-25e-5],[25e6,-25e-5],[5e7,-25e-5],[75e6,-25e-5],[1e8,-25e-5],[2e8,-25e-5],[3e8,-25e-5]],taker:[[0,.0012],[25e3,.00115],[5e4,.0011],[1e5,.00105],[1e6,.001],[1e7,95e-5],[25e6,9e-4],[5e7,85e-5],[75e6,8e-4],[1e8,75e-5],[2e8,7e-4],[3e8,65e-5]]},spot:{taker:[[0,.003],[1e4,.0029],[2e4,.0028],[5e4,.0026],[1e5,.002],[1e6,.0016],[5e6,.0012],[1e7,.001],[25e6,9e-4],[5e7,8e-4],[1e8,7e-4],[2e8,6e-4],[5e8,4e-4],[1e9,3e-4]],maker:[[0,0],[1e4,.002],[2e4,.0019],[5e4,.0018],[1e5,.0016],[1e6,8e-4],[5e6,7e-4],[1e7,5e-4],[25e6,0],[5e7,0],[1e8,0],[2e8,0],[5e8,0],[1e9,0]]}}}},precisionMode:r,exceptions:{"API rate limit exceeded. Please retry after 300s":l,"API Authentication failed":u,"Nonce is too small":o,"Order not found":c,"Can not update partially filled order":d,"Can not update non-live order":c,not_enough_free_balance:h,must_be_positive:d,less_than_order_size:d,price_too_high:d,price_too_small:d,product_disabled:p},commonCurrencies:{WIN:"WCOIN",HOT:"HOT Token",MIOTA:"IOTA"},options:{cancelOrderException:!0}})}async fetchCurrencies(e={}){const t=await this.publicGetCurrencies(e),s={};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"currency"),a=this.safeCurrencyCode(r),n=i.depositable&&i.withdrawable,o=this.safeInteger(i,"assets_precision");s[a]={id:r,code:a,info:i,name:a,active:n,fee:this.safeNumber(i,"withdrawal_fee"),precision:o,limits:{amount:{min:Math.pow(10,-o),max:Math.pow(10,o)},withdraw:{min:this.safeNumber(i,"minimum_withdrawal"),max:void 0}}}}return s}async fetchMarkets(e={}){const t=await this.publicGetProducts(e),s=await this.publicGetProducts({perpetual:"1"}),i=await this.fetchCurrencies(),r=this.indexBy(i,"code"),a=[],n=this.arrayConcat(t,s);for(let e=0;e<n.length;e++){const t=n[e],s=this.safeString(t,"id"),i=this.safeString(t,"base_currency"),o=this.safeString(t,"quoted_currency");let c="spot",d=!0,h=!1;"Perpetual"===this.safeString(t,"product_type")&&(d=!1,h=!0,c="swap");const u=this.safeCurrencyCode(i),l=this.safeCurrencyCode(o);let f;f=h?this.safeString(t,"currency_pair_code"):u+"/"+l;let p=this.fees.trading.maker,m=this.fees.trading.taker;"swap"===c&&(p=this.safeNumber(t,"maker_fee",this.fees.trading.maker),m=this.safeNumber(t,"taker_fee",this.fees.trading.taker));const b=!this.safeValue(t,"disabled",!1),g=this.safeValue(r,u),y={amount:1e-8,price:this.safeNumber(t,"tick_size")};let v;void 0!==g&&(v=this.safeNumber(g.info,"minimum_order_quantity"));const w=this.safeNumber(t,"last_traded_price");let k,S;if(w){const e=this.safeNumber(t,"multiplier_down"),s=this.safeNumber(t,"multiplier_up");void 0!==e&&(k=w*e),void 0!==s&&(S=w*s)}const _={amount:{min:v,max:void 0},price:{min:k,max:S},cost:{min:void 0,max:void 0}};a.push({id:s,symbol:f,base:u,quote:l,baseId:i,quoteId:o,type:c,spot:d,swap:h,maker:p,taker:m,limits:_,precision:y,active:b,info:t})}return a}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetAccounts(e),s={info:t,timestamp:void 0,datetime:void 0},i=this.safeValue(t,"crypto_accounts",[]),r=this.safeValue(t,"fiat_accounts",[]);for(let e=0;e<i.length;e++){const t=i[e],r=this.safeString(t,"currency"),a=this.safeCurrencyCode(r),n=this.account();n.total=this.safeString(t,"balance"),n.used=this.safeString(t,"reserved_balance"),s[a]=n}for(let e=0;e<r.length;e++){const t=r[e],i=this.safeString(t,"currency"),a=this.safeCurrencyCode(i),n=this.account();n.total=this.safeString(t,"balance"),n.used=this.safeString(t,"reserved_balance"),s[a]=n}return this.parseBalance(s,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={id:this.marketId(e)},r=await this.publicGetProductsIdPriceLevels(this.extend(i,s));return this.parseOrderBook(r,e,void 0,"buy_price_levels","sell_price_levels")}parseTicker(e,t){const s=this.milliseconds();let i,r,a,n,o;if("last_traded_price"in e&&e.last_traded_price){e.last_traded_price.length>0&&(i=this.safeNumber(e,"last_traded_price"))}if(void 0===t){const s=this.safeString(e,"id");if(s in this.markets_by_id)t=this.markets_by_id[s];else{const s=this.safeString(e,"base_currency"),i=this.safeString(e,"quoted_currency");r in this.markets?t=this.markets[r]:r=this.safeCurrencyCode(s)+"/"+this.safeCurrencyCode(i)}}void 0!==t&&(r=t.symbol);const c=this.safeNumber(e,"last_price_24h");return void 0!==c&&void 0!==i&&(a=i-c,o=this.sum(i,c)/2,c>0&&(n=a/c*100)),{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high_market_ask"),low:this.safeNumber(e,"low_market_bid"),bid:this.safeNumber(e,"market_bid"),bidVolume:void 0,ask:this.safeNumber(e,"market_ask"),askVolume:void 0,vwap:void 0,open:c,close:i,last:i,previousClose:void 0,change:a,percentage:n,average:o,baseVolume:this.safeNumber(e,"volume_24h"),quoteVolume:void 0,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetProducts(t),i={};for(let e=0;e<s.length;e++){const t=this.parseTicker(s[e]);i[t.symbol]=t}return this.filterByArray(i,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={id:s.id},r=await this.publicGetProductsId(this.extend(i,t));return this.parseTicker(r,s)}parseTrade(e,t){const s=this.safeTimestamp(e,"created_at"),i=this.safeString(e,"order_id"),r=this.safeString(e,"taker_side"),a=this.safeString(e,"my_side"),n=void 0!==a?a:r;let o;void 0!==a&&(o=r===a?"taker":"maker");const c=this.safeString(e,"price"),d=this.safeString(e,"quantity"),h=this.parseNumber(c),u=this.parseNumber(d),l=this.parseNumber(m.stringMul(c,d)),f=this.safeString(e,"id");let p;return void 0!==t&&(p=t.symbol),{info:e,id:f,order:i,timestamp:s,datetime:this.iso8601(s),symbol:p,type:void 0,side:n,takerOrMaker:o,price:h,amount:u,cost:l,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={product_id:r.id};void 0!==s&&(a.limit=s),void 0!==t&&(a.timestamp=parseInt(t/1e3));const n=await this.publicGetExecutions(this.extend(a,i)),o=void 0!==t?n:n.models;return this.parseTrades(o,r,t,s)}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={product_id:r.id,with_details:!0};void 0!==s&&(a.limit=s);const n=await this.privateGetExecutionsMe(this.extend(a,i));return this.parseTrades(n.models,r,t,s)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.safeString2(a,"clientOrderId","client_order_id");a=this.omit(a,["clientOrderId","client_order_id"]);const o={order_type:t,product_id:this.marketId(e),side:s,quantity:this.amountToPrecision(e,i)};void 0!==n&&(o.client_order_id=n),"limit"!==t&&"limit_post_only"!==t&&"market_with_range"!==t&&"stop"!==t||(o.price=this.priceToPrecision(e,r));const c=await this.privatePostOrders(this.extend(o,a));return this.parseOrder(c)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={id:e},r=await this.privatePutOrdersIdCancel(this.extend(i,s)),a=this.parseOrder(r);if("closed"===a.status&&this.options.cancelOrderException)throw new c(this.id+" order closed already: "+this.json(r));return a}async editOrder(e,t,s,i,r,a,o={}){if(await this.loadMarkets(),void 0===a)throw new n(this.id+" editOrder() requires the price argument");const c={order:{quantity:this.amountToPrecision(t,r),price:this.priceToPrecision(t,a)},id:e},d=await this.privatePutOrdersId(this.extend(c,o));return this.parseOrder(d)}parseOrderStatus(e){return this.safeString({live:"open",filled:"closed",cancelled:"canceled"},e,e)}parseOrder(e,t){const s=this.safeString(e,"id"),i=this.safeTimestamp(e,"created_at"),r=this.safeString(e,"product_id");t=this.safeValue(this.markets_by_id,r);const a=this.parseOrderStatus(this.safeString(e,"status")),n=this.safeNumber(e,"quantity");let o=this.safeNumber(e,"filled_quantity");const c=this.safeNumber(e,"price");let d,h;void 0!==t&&(d=t.symbol,h=t.quote);const u=this.safeString(e,"order_type");let l=0,f=0,p=this.safeNumber(e,"average_price");const m=this.parseTrades(this.safeValue(e,"executions",[]),t,void 0,void 0,{order:s,type:u}),b=m.length;for(let e=0;e<b;e++){const t=m[e];t.order=s,t.type=u,f=this.sum(f,t.amount),l=this.sum(l,t.cost)}let g,y,v;b>0&&(y=m[b-1].timestamp,!p&&f>0&&(p=l/f),void 0===g&&(g=l),void 0===o&&(o=f)),void 0!==n&&void 0!==o&&(v=n-o);const w=this.safeString(e,"side");return{id:s,clientOrderId:this.safeString(e,"client_order_id"),timestamp:i,datetime:this.iso8601(i),lastTradeTimestamp:y,type:u,timeInForce:void 0,postOnly:void 0,status:a,symbol:d,side:w,price:c,stopPrice:void 0,amount:n,filled:o,cost:g,remaining:v,average:p,trades:m,fee:{currency:h,cost:this.safeNumber(e,"order_fee")},info:e}}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={id:e},r=await this.privateGetOrdersId(this.extend(i,s));return this.parseOrder(r)}async fetchOrders(e,t,s,i={}){let r;await this.loadMarkets();const a={with_details:1};void 0!==e&&(r=this.market(e),a.product_id=r.id),void 0!==s&&(a.limit=s);const n=await this.privateGetOrders(this.extend(a,i)),o=this.safeValue(n,"models",[]);return this.parseOrders(o,r,t,s)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({status:"live"},i))}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({status:"filled"},i))}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a=this.currency(e),n={currency:a.id,address:s,amount:this.currencyToPrecision(e,t)};if(void 0!==i)if("XRP"===e)n.payment_id=i;else{if("XLM"!==e)throw new f(this.id+" withdraw() only supports a tag along the address for XRP or XLM");n.memo_type="text",n.memo_value=i}const o=await this.privatePostCryptoWithdrawals(this.extend(n,r));return this.parseTransaction(o,a)}parseTransactionStatus(e){return this.safeString({pending:"pending",cancelled:"canceled",approved:"ok"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"address"),r=this.safeString2(e,"payment_id","memo_value"),a=this.safeString(e,"asset"),n=this.safeCurrencyCode(a,t),o=this.safeTimestamp(e,"created_at"),c=this.safeTimestamp(e,"updated_at"),d=this.parseTransactionStatus(this.safeString(e,"state")),h=this.safeNumber(e,"amount");return{info:e,id:s,txid:undefined,timestamp:o,datetime:this.iso8601(o),address:i,tag:r,type:"withdrawal",amount:h,currency:n,status:d,updated:c,fee:void 0}}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n="/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if(r={"X-Quoine-API-Version":this.version,"Content-Type":"application/json"},"private"===t){this.checkRequiredCredentials(),"GET"===s?Object.keys(o).length&&(n+="?"+this.urlencode(o)):Object.keys(o).length&&(a=this.json(o));const e=this.nonce(),t={path:n,token_id:this.apiKey,iat:Math.floor(e/1e3)};"client_order_id"in o||(t.nonce=e),r["X-Quoine-Auth"]=this.jwt(t,this.encode(this.secret))}else Object.keys(o).length&&(n+="?"+this.urlencode(o));return n=this.urls.api+n,{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,n,o,c,d){if(e>=200&&e<300)return;if(401===e)return void this.throwExactlyMatchedException(this.exceptions,n,n);if(429===e)throw new l(this.id+" "+n);if(void 0===o)return;const h=this.id+" "+n,u=this.safeString(o,"message"),f=this.safeValue(o,"errors");if(void 0!==u)this.throwExactlyMatchedException(this.exceptions,u,h);else{if(void 0===f)throw new a(h);{const e=Object.keys(f);for(let t=0;t<e.length;t++){const s=f[e[t]];for(let e=0;e<s.length;e++){const t=s[e];this.throwExactlyMatchedException(this.exceptions,t,h)}}}}}}},5439:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a}=s(3449),n=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"luno",name:"luno",countries:["GB","SG","ZA"],rateLimit:1e3,version:"1",has:{cancelOrder:!0,CORS:!1,createOrder:!0,fetchAccounts:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchLedger:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTradingFee:!0,fetchTradingFees:!0},urls:{referral:"https://www.luno.com/invite/44893A",logo:"https://user-images.githubusercontent.com/1294454/27766607-8c1a69d8-5ede-11e7-930c-540b5eb9be24.jpg",api:{public:"https://api.luno.com/api",private:"https://api.luno.com/api",exchange:"https://api.luno.com/api/exchange"},www:"https://www.luno.com",doc:["https://www.luno.com/en/api","https://npmjs.org/package/bitx","https://github.com/bausmeier/node-bitx"]},api:{exchange:{get:["markets"]},public:{get:["orderbook","orderbook_top","ticker","tickers","trades"]},private:{get:["accounts/{id}/pending","accounts/{id}/transactions","balance","beneficiaries","fee_info","funding_address","listorders","listtrades","orders/{id}","quotes/{id}","withdrawals","withdrawals/{id}","transfers"],post:["accounts","accounts/{id}/name","postorder","marketorder","stoporder","funding_address","withdrawals","send","quotes","oauth2/grant"],put:["accounts/{id}/name","quotes/{id}"],delete:["quotes/{id}","withdrawals/{id}"]}}})}async fetchMarkets(e={}){const t=await this.exchangeGetMarkets(e),s=[],i=this.safeValue(t,"markets",[]);for(let e=0;e<i.length;e++){const t=i[e],r=this.safeString(t,"market_id"),a=this.safeString(t,"base_currency"),n=this.safeString(t,"counter_currency"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d=o+"/"+c,h="ACTIVE"===this.safeString(t,"trading_status"),u={amount:this.safeInteger(t,"volume_scale"),price:this.safeInteger(t,"price_scale")};s.push({id:r,symbol:d,base:o,quote:c,baseId:a,quoteId:n,active:h,precision:u,limits:{amount:{min:this.safeNumber(t,"min_volume"),max:this.safeNumber(t,"max_volume")},price:{min:this.safeNumber(t,"min_price"),max:this.safeNumber(t,"max_price")},cost:{min:void 0,max:void 0}},info:t})}return s}async fetchAccounts(e={}){const t=await this.privateGetBalance(e),s=this.safeValue(t,"balance",[]),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"account_id"),a=this.safeString(t,"asset"),n=this.safeCurrencyCode(a);i.push({id:r,type:void 0,currency:n,info:t})}return i}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetBalance(e),s=this.safeValue(t,"balance",[]),i={info:t,timestamp:void 0,datetime:void 0};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"asset"),a=this.safeCurrencyCode(r),o=this.safeString(t,"reserved"),c=this.safeString(t,"unconfirmed"),d=this.safeString(t,"balance"),h=n.stringAdd(o,c),u=n.stringAdd(d,c);if(a in i)i[a].used=n.stringAdd(i[a].used,h),i[a].total=n.stringAdd(i[a].total,u);else{const e=this.account();e.used=h,e.total=u,i[a]=e}}return this.parseBalance(i,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();let i="publicGetOrderbook";void 0!==t&&t<=100&&(i+="Top");const r={pair:this.marketId(e)},a=await this[i](this.extend(r,s)),n=this.safeInteger(a,"timestamp");return this.parseOrderBook(a,e,n,"bids","asks","price","volume")}parseOrderStatus(e){return this.safeString({PENDING:"open"},e,e)}parseOrder(e,t){const s=this.safeInteger(e,"creation_timestamp");let i,r=this.parseOrderStatus(this.safeString(e,"state"));r=r;const a=this.safeString(e,"type");"ASK"===a||"SELL"===a?i="sell":"BID"!==a&&"BUY"!==a||(i="buy");const n=this.safeString(e,"pair"),o=this.safeSymbol(n,t),c=this.safeNumber(e,"limit_price"),d=this.safeNumber(e,"limit_volume"),h=this.safeNumber(e,"fee_counter"),u=this.safeNumber(e,"fee_base"),l=this.safeNumber(e,"base"),f=this.safeNumber(e,"counter"),p={currency:void 0};h?(p.cost=h,void 0!==t&&(p.currency=t.quote)):(p.cost=u,void 0!==t&&(p.currency=t.base));const m=this.safeString(e,"order_id");return this.safeOrder({id:m,clientOrderId:void 0,datetime:this.iso8601(s),timestamp:s,lastTradeTimestamp:void 0,status:r,symbol:o,type:void 0,timeInForce:void 0,postOnly:void 0,side:i,price:c,stopPrice:void 0,amount:d,filled:l,cost:f,remaining:void 0,trades:void 0,fee:p,info:e,average:void 0})}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={id:e},r=await this.privateGetOrdersId(this.extend(i,s));return this.parseOrder(r)}async fetchOrdersByState(e,t,s,i,r={}){await this.loadMarkets();const a={};let n;void 0!==e&&(a.state=e),void 0!==t&&(n=this.market(t),a.pair=n.id);const o=await this.privateGetListorders(this.extend(a,r)),c=this.safeValue(o,"orders",[]);return this.parseOrders(c,n,s,i)}async fetchOrders(e,t,s,i={}){return await this.fetchOrdersByState(void 0,e,t,s,i)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrdersByState("PENDING",e,t,s,i)}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrdersByState("COMPLETE",e,t,s,i)}parseTicker(e,t){const s=this.safeInteger(e,"timestamp");let i;t&&(i=t.symbol);const r=this.safeNumber(e,"last_trade");return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:void 0,low:void 0,bid:this.safeNumber(e,"bid"),bidVolume:void 0,ask:this.safeNumber(e,"ask"),askVolume:void 0,vwap:void 0,open:void 0,close:r,last:r,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(e,"rolling_24_hour_volume"),quoteVolume:void 0,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTickers(t),i=this.indexBy(s.tickers,"pair"),r=Object.keys(i),a={};for(let e=0;e<r.length;e++){const t=r[e],s=this.safeMarket(t),n=s.symbol,o=i[t];a[n]=this.parseTicker(o,s)}return this.filterByArray(a,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={pair:s.id},r=await this.publicGetTicker(this.extend(i,t));return this.parseTicker(r,s)}parseTrade(e,t){const s=this.safeString(e,"order_id");let i,r;if(void 0!==s){const t=this.safeString(e,"type");"ASK"===t||"SELL"===t?r="sell":"BID"!==t&&"BUY"!==t||(r="buy"),i="sell"===r&&e.is_buy?"maker":"buy"!==r||e.is_buy?"taker":"maker"}else r=e.is_buy?"buy":"sell";const a=this.safeNumber(e,"fee_base"),n=this.safeNumber(e,"fee_counter");let o,c;void 0!==a?0!==a&&(o=t.base,c=a):void 0!==n&&0!==n&&(o=t.quote,c=n);const d=this.safeInteger(e,"timestamp");return{info:e,id:void 0,timestamp:d,datetime:this.iso8601(d),symbol:t.symbol,order:s,type:void 0,side:r,takerOrMaker:i,price:this.safeNumber(e,"price"),amount:this.safeNumber(e,"volume"),cost:this.safeNumber(e,"counter"),fee:{cost:c,currency:o}}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={pair:r.id};void 0!==t&&(a.since=t);const n=await this.publicGetTrades(this.extend(a,i)),o=this.safeValue(n,"trades",[]);return this.parseTrades(o,r,t,s)}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const r=this.market(e),n={pair:r.id};void 0!==t&&(n.since=t),void 0!==s&&(n.limit=s);const o=await this.privateGetListtrades(this.extend(n,i)),c=this.safeValue(o,"trades",[]);return this.parseTrades(c,r,t,s)}async fetchTradingFees(e={}){await this.loadMarkets();const t=await this.privateGetFeeInfo(e);return{info:t,maker:this.safeNumber(t,"maker_fee"),taker:this.safeNumber(t,"taker_fee")}}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();let n="privatePost";const o={pair:this.marketId(e)};"market"===t?(n+="Marketorder",o.type=s.toUpperCase(),"buy"===s?o.counter_volume=parseFloat(this.amountToPrecision(e,i)):o.base_volume=parseFloat(this.amountToPrecision(e,i))):(n+="Postorder",o.volume=parseFloat(this.amountToPrecision(e,i)),o.price=parseFloat(this.priceToPrecision(e,r)),o.type="buy"===s?"BID":"ASK");const c=await this[n](this.extend(o,a));return{info:c,id:c.order_id}}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={order_id:e};return await this.privatePostStoporder(this.extend(i,s))}async fetchLedgerByEntries(e,t=-1,s=1,i={}){const r={min_row:t,max_row:this.sum(t,s)};return await this.fetchLedger(e,undefined,s,this.extend(r,i))}async fetchLedger(e,t,s,i={}){let n;await this.loadMarkets(),await this.loadAccounts();let o=this.safeString(i,"id"),c=this.safeValue(i,"min_row"),d=this.safeValue(i,"max_row");if(void 0===o){if(void 0===e)throw new a(this.id+" fetchLedger() requires a currency code argument if no account id specified in params");n=this.currency(e);const t=this.indexBy(this.accounts,"currency"),s=this.safeValue(t,e);if(void 0===s)throw new r(this.id+" fetchLedger() could not find account id for "+e);o=s.id}if(void 0===c&&void 0===d)d=0,c=-1e3;else if(void 0===c||void 0===d)throw new r(this.id+" fetchLedger() require both params 'max_row' and 'min_row' or neither to be defined");if(void 0!==s&&d-c>s&&(d<=0?c=d-s:c>0&&(d=c+s)),d-c>1e3)throw new r(this.id+" fetchLedger() requires the params 'max_row' - 'min_row' <= 1000");const h={id:o,min_row:c,max_row:d},u=await this.privateGetAccountsIdTransactions(this.extend(i,h)),l=this.safeValue(u,"transactions",[]);return this.parseLedger(l,n,t,s)}parseLedgerComment(e){const t=e.split(" ");let s;const i=this.safeString(t,0),r=this.safeString(t,2),a=this.safeString(t,3);let n=this.safeString({Withdrawal:"fee",Trading:"fee",Payment:"transaction",Sent:"transaction",Deposit:"transaction",Received:"transaction",Released:"released",Reserved:"reserved",Sold:"trade",Bought:"trade",Failure:"failed"},i,void 0);return void 0===n&&"fee"===r&&(n="fee"),"reserved"===n&&"order"===a&&(s=this.safeString(t,4)),{type:n,referenceId:s}}parseLedgerEntry(e,t){const s=this.safeString(e,"row_index"),i=this.safeString(e,"account_id"),r=this.safeValue(e,"timestamp"),a=this.safeString(e,"currency"),n=this.safeCurrencyCode(a,t),o=this.safeNumber(e,"available_delta"),c=this.safeNumber(e,"balance_delta"),d=this.safeNumber(e,"balance"),h=this.safeString(e,"description");let u=d,l=0;const f=this.parseLedgerComment(h),p=f.type,m=f.referenceId;let b,g;return 0!==c?(u=d-c,g="ok",l=Math.abs(c)):o<0?(g="pending",l=Math.abs(o)):o>0&&(g="canceled",l=Math.abs(o)),c>0||o>0?b="in":(c<0||o<0)&&(b="out"),{id:s,direction:b,account:i,referenceId:m,referenceAccount:void 0,type:p,currency:n,amount:l,timestamp:r,datetime:this.iso8601(r),before:u,after:d,status:g,fee:void 0,info:e}}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t]+"/"+this.version+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if(Object.keys(o).length&&(n+="?"+this.urlencode(o)),"private"===t){this.checkRequiredCredentials();const e=this.stringToBase64(this.apiKey+":"+this.secret);r={Authorization:"Basic "+this.decode(e)}}return{url:n,method:s,body:a,headers:r}}async request(e,t="public",s="GET",i={},a,n){const o=await this.fetch2(e,t,s,i,a,n);if("error"in o)throw new r(this.id+" "+this.json(o));return o}}},5591:(e,t,s)=>{"use strict";const i=s(8819),r=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"lykke",name:"Lykke",countries:["CH"],version:"v1",rateLimit:200,has:{CORS:!1,fetchOHLCV:!1,fetchOpenOrders:!0,fetchClosedOrders:!0,fetchOrder:!0,fetchOrders:!0,fetchTrades:!0,fetchMyTrades:!0,createOrder:!0,cancelOrder:!0,cancelAllOrders:!0,fetchBalance:!0,fetchMarkets:!0,fetchOrderBook:!0,fetchTicker:!0},timeframes:{"1m":"Minute","5m":"Min5","15m":"Min15","30m":"Min30","1h":"Hour","4h":"Hour4","6h":"Hour6","12h":"Hour12","1d":"Day","1w":"Week","1M":"Month"},requiredCredentials:{apiKey:!0,secret:!1},urls:{logo:"https://user-images.githubusercontent.com/1294454/34487620-3139a7b0-efe6-11e7-90f5-e520cef74451.jpg",api:{mobile:"https://public-api.lykke.com/api",public:"https://hft-api.lykke.com/api",private:"https://hft-api.lykke.com/api"},test:{mobile:"https://public-api.lykke.com/api",public:"https://hft-service-dev.lykkex.net/api",private:"https://hft-service-dev.lykkex.net/api"},www:"https://www.lykke.com",doc:["https://hft-api.lykke.com/swagger/ui/","https://www.lykke.com/lykke_api"],fees:"https://www.lykke.com/trading-conditions"},api:{mobile:{get:["AssetPairs/rate","AssetPairs/rate/{assetPairId}","AssetPairs/dictionary/{market}","Assets/dictionary","Candles/history/{market}/available","Candles/history/{market}/{assetPair}/{period}/{type}/{from}/{to}","Company/ownershipStructure","Company/registrationsCount","IsAlive","Market","Market/{market}","Market/capitalization/{market}","OrderBook","OrderBook/{assetPairId}","Trades/{AssetPairId}","Trades/Last/{assetPair}/{n}"],post:["AssetPairs/rate/history","AssetPairs/rate/history/{assetPairId}"]},public:{get:["AssetPairs","AssetPairs/{id}","IsAlive","OrderBooks","OrderBooks/{AssetPairId}"]},private:{get:["Orders","Orders/{id}","Wallets","History/trades"],post:["Orders/limit","Orders/market","Orders/{id}/Cancel","Orders/v2/market","Orders/v2/limit","Orders/stoplimit","Orders/bulk"],delete:["Orders","Orders/{id}"]}},fees:{trading:{tierBased:!1,percentage:!0,maker:0,taker:0},funding:{tierBased:!1,percentage:!1,withdraw:{BTC:.001},deposit:{BTC:0}}},commonCurrencies:{CAN:"CanYaCoin",XPD:"Lykke XPD"}})}parseTrade(e,t){const s=this.safeString(e,"AssetPairId"),i=this.safeSymbol(s,t),a=this.safeString2(e,"id","Id"),n=this.safeString(e,"OrderId"),o=this.parse8601(this.safeString2(e,"dateTime","DateTime")),c=this.safeString2(e,"price","Price");let d=this.safeString2(e,"volume","Amount"),h=this.safeStringLower(e,"action");void 0===h&&(h="-"===d[0]?"sell":"buy"),d=r.stringAbs(d);const u=this.parseNumber(c),l=this.parseNumber(d),f=this.parseNumber(r.stringMul(c,d)),p={cost:0,currency:t.quote};return{id:a,info:e,timestamp:o,datetime:this.iso8601(o),symbol:i,type:void 0,order:n,side:h,takerOrMaker:void 0,price:u,amount:l,cost:f,fee:p}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e);void 0===s&&(s=100);const a={AssetPairId:r.id,skip:0,take:s},n=await this.mobileGetTradesAssetPairId(this.extend(a,i));return this.parseTrades(n,r,t,s)}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==s&&(r.take=s),void 0!==e&&(a=this.market(e),r.assetPairId=a.id);const n=await this.privateGetHistoryTrades(this.extend(r,i));return this.parseTrades(n,a,t,s)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetWallets(e),s={info:t};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"AssetId"),a=this.safeCurrencyCode(r),n=this.account();n.total=this.safeString(i,"Balance"),n.used=this.safeString(i,"Reserved"),s[a]=n}return this.parseBalance(s,!1)}async cancelOrder(e,t,s={}){const i={id:e};return await this.privateDeleteOrdersId(this.extend(i,s))}async cancelAllOrders(e,t={}){await this.loadMarkets();const s={};let i;return void 0!==e&&(i=this.market(e),s.assetPairId=i.id),await this.privateDeleteOrders(this.extend(s,t))}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o={AssetPairId:n.id,OrderAction:this.capitalize(s),Volume:i,Asset:n.baseId};"limit"===t&&(o.Price=r);const c="privatePostOrdersV2"+this.capitalize(t),d=await this[c](this.extend(o,a));return{id:this.safeString(d,"Id"),info:d,clientOrderId:void 0,timestamp:void 0,datetime:void 0,lastTradeTimestamp:void 0,symbol:e,type:t,side:s,price:r=this.safeNumber(d,"Price"),amount:i,cost:void 0,average:void 0,filled:void 0,remaining:void 0,status:void 0,fee:void 0,trades:void 0}}async fetchMarkets(e={}){const t=await this.publicGetAssetPairs(),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"Id"),a=this.safeString(i,"Name"),[n,o]=a.split("/"),c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o),h=c+"/"+d,u=this.safeString(i,"Accuracy"),l=this.parsePrecision(u),f={price:parseInt(u),amount:this.safeInteger(i,"InvertedAccuracy")};s.push({id:r,symbol:h,base:c,quote:d,active:!0,info:i,precision:f,limits:{amount:{min:this.safeNumber(i,"MinVolume"),max:void 0},price:{min:this.parseNumber(l),max:void 0},cost:{min:this.safeNumber(i,"MinInvertedVolume"),max:void 0}},baseId:void 0,quoteId:void 0})}return s}parseTicker(e,t){const s=this.milliseconds();let i;t&&(i=t.symbol);const r=this.safeNumber(e,"lastPrice");return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:void 0,low:void 0,bid:this.safeNumber(e,"bid"),bidVolume:void 0,ask:this.safeNumber(e,"ask"),askVolume:void 0,vwap:void 0,open:void 0,close:r,last:r,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:void 0,quoteVolume:this.safeNumber(e,"volume24H"),info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={market:s.id},r=await this.mobileGetMarketMarket(this.extend(i,t));return this.parseTicker(r,s)}parseOrderStatus(e){return this.safeString({Open:"open",Pending:"open",InOrderBook:"open",Processing:"open",Matched:"closed",Cancelled:"canceled",Rejected:"rejected",Replaced:"canceled",Placed:"open"},e,e)}parseOrder(e,t){const s=this.parseOrderStatus(this.safeString(e,"Status")),i=this.safeString(e,"AssetPairId"),r=this.safeSymbol(i,t),a=this.parse8601(this.safeString(e,"LastMatchTime"));let n;"Registered"in e&&e.Registered?n=this.parse8601(e.Registered):"CreatedAt"in e&&e.CreatedAt&&(n=this.parse8601(e.CreatedAt));const o=this.safeNumber(e,"Price");let c,d=this.safeNumber(e,"Volume");d<0?(c="sell",d=Math.abs(d)):c="buy";const h=Math.abs(this.safeNumber(e,"RemainingVolume")),u=this.safeString(e,"Id");return this.safeOrder({info:e,id:u,clientOrderId:void 0,timestamp:n,datetime:this.iso8601(n),lastTradeTimestamp:a,symbol:r,type:void 0,timeInForce:void 0,postOnly:void 0,side:c,price:o,stopPrice:void 0,cost:void 0,average:void 0,amount:d,filled:void 0,remaining:h,status:s,fee:void 0,trades:void 0})}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={id:e},r=await this.privateGetOrdersId(this.extend(i,s));return this.parseOrder(r)}async fetchOrders(e,t,s,i={}){await this.loadMarkets();const r=await this.privateGetOrders(i);let a;return void 0!==e&&(a=this.market(e)),this.parseOrders(r,a,t,s)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({status:"InOrderBook"},i))}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({status:"Matched"},i))}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=await this.publicGetOrderBooksAssetPairId(this.extend({AssetPairId:this.marketId(e)},s)),r={timestamp:void 0,bids:[],asks:[]};let a;for(let e=0;e<i.length;e++){const t=i[e];t.IsBuy?r.bids=this.arrayConcat(r.bids,t.Prices):r.asks=this.arrayConcat(r.asks,t.Prices);const s=this.parse8601(t.Timestamp);a=void 0===a?s:Math.max(a,s)}return this.parseOrderBook(r,e,a,"bids","asks","Price","Volume")}parseBidAsk(e,t=0,s=1){const i=this.safeNumber(e,t);let r=this.safeNumber(e,s);return r<0&&(r=-r),[i,r]}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t]+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));return"mobile"===t||"public"===t?Object.keys(o).length&&(n+="?"+this.urlencode(o)):"private"===t&&("GET"!==s&&"DELETE"!==s||Object.keys(o).length&&(n+="?"+this.urlencode(o)),this.checkRequiredCredentials(),r={"api-key":this.apiKey,Accept:"application/json","Content-Type":"application/json"},"POST"===s&&Object.keys(i).length&&(a=this.json(i))),{url:n,method:s,body:a,headers:r}}}},7551:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,InvalidOrder:n}=s(3449),o=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"mercado",name:"Mercado Bitcoin",countries:["BR"],rateLimit:1e3,version:"v3",has:{cancelOrder:!0,CORS:!0,createMarketOrder:!0,createOrder:!0,fetchBalance:!0,fetchMarkets:!0,fetchMyTrades:"emulated",fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTickers:!1,fetchTrades:!0,withdraw:!0},timeframes:{"1m":"1m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","6h":"6h","12h":"12h","1d":"1d","3d":"3d","1w":"1w","2w":"2w"},urls:{logo:"https://user-images.githubusercontent.com/1294454/27837060-e7c58714-60ea-11e7-9192-f05e86adb83f.jpg",api:{public:"https://www.mercadobitcoin.net/api",private:"https://www.mercadobitcoin.net/tapi",v4Public:"https://www.mercadobitcoin.com.br/v4"},www:"https://www.mercadobitcoin.com.br",doc:["https://www.mercadobitcoin.com.br/api-doc","https://www.mercadobitcoin.com.br/trade-api"]},api:{public:{get:["coins","{coin}/orderbook/","{coin}/ticker/","{coin}/trades/","{coin}/trades/{from}/","{coin}/trades/{from}/{to}","{coin}/day-summary/{year}/{month}/{day}/"]},private:{post:["cancel_order","get_account_info","get_order","get_withdrawal","list_system_messages","list_orders","list_orderbook","place_buy_order","place_sell_order","place_market_buy_order","place_market_sell_order","withdraw_coin"]},v4Public:{get:["{coin}/candle/"]}},fees:{trading:{maker:.003,taker:.007}},options:{limits:{BTC:.001,BCH:.001,ETH:.01,LTC:.01,XRP:.1}}})}async fetchMarkets(e={}){const t=await this.publicGetCoins(e),s=[],i=this.safeValue(this.options,"limits",{});for(let e=0;e<t.length;e++){const r=t[e],a=r,n="BRL",o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d=o+"/"+c,h=c+o,u={amount:8,price:5},l="1e-5";s.push({id:h,symbol:d,base:o,quote:c,baseId:a,quoteId:n,active:void 0,info:r,precision:u,limits:{amount:{min:this.safeNumber(i,a),max:void 0},price:{min:this.parseNumber(l),max:void 0},cost:{min:void 0,max:void 0}}})}return s}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={coin:this.market(e).base},r=await this.publicGetCoinOrderbook(this.extend(i,s));return this.parseOrderBook(r,e)}async fetchTicker(e,t={}){await this.loadMarkets();const s={coin:this.market(e).base},i=await this.publicGetCoinTicker(this.extend(s,t)),r=this.safeValue(i,"ticker",{}),a=this.safeTimestamp(r,"date"),n=this.safeNumber(r,"last");return{symbol:e,timestamp:a,datetime:this.iso8601(a),high:this.safeNumber(r,"high"),low:this.safeNumber(r,"low"),bid:this.safeNumber(r,"buy"),bidVolume:void 0,ask:this.safeNumber(r,"sell"),askVolume:void 0,vwap:void 0,open:void 0,close:n,last:n,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(r,"vol"),quoteVolume:void 0,info:r}}parseTrade(e,t){const s=this.safeTimestamp2(e,"date","executed_timestamp");let i;void 0!==t&&(i=t.symbol);const r=this.safeString2(e,"tid","operation_id"),a=this.safeString(e,"type"),n=this.safeString(e,"price"),c=this.safeString2(e,"amount","quantity"),d=this.parseNumber(n),h=this.parseNumber(c),u=this.parseNumber(o.stringMul(n,c)),l=this.safeNumber(e,"fee_rate");let f;return void 0!==l&&(f={cost:l,currency:void 0}),{id:r,info:e,timestamp:s,datetime:this.iso8601(s),symbol:i,order:void 0,type:undefined,side:a,takerOrMaker:void 0,price:d,amount:h,cost:u,fee:f}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e);let a="publicGetCoinTrades";const n={coin:r.base};void 0!==t&&(a+="From",n.from=parseInt(t/1e3));void 0!==this.safeInteger(i,"to")&&(a+="To");const o=await this[a](this.extend(n,i));return this.parseTrades(o,r,t,s)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostGetAccountInfo(e),s=this.safeValue(t,"response_data",{}),i=this.safeValue(s,"balance",{}),r={info:t},a=Object.keys(i);for(let e=0;e<a.length;e++){const t=a[e],s=this.safeCurrencyCode(t);if(t in i){const e=this.safeValue(i,t,{}),a=this.account();a.free=this.safeString(e,"available"),a.total=this.safeString(e,"total"),r[s]=a}}return this.parseBalance(r,!1)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const o={coin_pair:this.marketId(e)};let c=this.capitalize(s)+"Order";if("limit"===t)c="privatePostPlace"+c,o.limit_price=this.priceToPrecision(e,r),o.quantity=this.amountToPrecision(e,i);else if(c="privatePostPlaceMarket"+c,"buy"===s){if(void 0===r)throw new n(this.id+" createOrder() requires the price argument with market buy orders to calculate total order cost (amount to spend), where cost = amount * price. Supply a price argument to createOrder() call if you want the cost to be calculated for you from price and amount");o.cost=this.priceToPrecision(e,i*r)}else o.quantity=this.amountToPrecision(e,i);const d=await this[c](this.extend(o,a));return{info:d,id:d.response_data.order.order_id.toString()}}async cancelOrder(e,t,s={}){if(void 0===t)throw new a(this.id+" cancelOrder () requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={coin_pair:i.id,order_id:e},n=await this.privatePostCancelOrder(this.extend(r,s)),o=this.safeValue(n,"response_data",{}),c=this.safeValue(o,"order",{});return this.parseOrder(c,i)}parseOrderStatus(e){return this.safeString({2:"open",3:"canceled",4:"closed"},e,e)}parseOrder(e,t){const s=this.safeString(e,"order_id"),i=this.safeString(e,"order_type");let r;"order_type"in e&&(r="1"===i?"buy":"sell");const a=this.parseOrderStatus(this.safeString(e,"status")),n=this.safeString(e,"coin_pair");t=this.safeMarket(n,t);const o=this.safeTimestamp(e,"created_timestamp"),c={cost:this.safeNumber(e,"fee"),currency:t.quote},d=this.safeNumber(e,"limit_price"),h=this.safeNumber(e,"executed_price_avg"),u=this.safeNumber(e,"quantity"),l=this.safeNumber(e,"executed_quantity"),f=this.safeTimestamp(e,"updated_timestamp"),p=this.safeValue(e,"operations",[]),m=this.parseTrades(p,t,void 0,void 0,{side:r,order:s});return this.safeOrder({info:e,id:s,clientOrderId:void 0,timestamp:o,datetime:this.iso8601(o),lastTradeTimestamp:f,symbol:t.symbol,type:"limit",timeInForce:void 0,postOnly:void 0,side:r,price:d,stopPrice:void 0,cost:void 0,average:h,amount:u,filled:l,remaining:void 0,status:a,fee:c,trades:m})}async fetchOrder(e,t,s={}){if(void 0===t)throw new a(this.id+" fetchOrder () requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={coin_pair:i.id,order_id:parseInt(e)},n=await this.privatePostGetOrder(this.extend(r,s)),o=this.safeValue(n,"response_data",{}),c=this.safeValue(o,"order");return this.parseOrder(c,i)}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const n={coin:this.currency(e).id,quantity:t.toFixed(10),address:s};if("BRL"===e){if(!("account_ref"in r))throw new a(this.id+" withdraw() requires account_ref parameter to withdraw "+e)}else if("LTC"!==e){if(!("tx_fee"in r))throw new a(this.id+" withdraw() requires tx_fee parameter to withdraw "+e);if("XRP"===e)if(void 0===i){if(!("destination_tag"in r))throw new a(this.id+" withdraw() requires a tag argument or destination_tag parameter to withdraw "+e)}else n.destination_tag=i}const o=await this.privatePostWithdrawCoin(this.extend(n,r));return{info:o,id:o.response_data.withdrawal.id}}parseOHLCV(e,t){return[this.safeTimestamp(e,"timestamp"),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}async fetchOHLCV(e,t="5m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={precision:this.timeframes[t],coin:a.id.toLowerCase()};void 0!==i&&void 0!==s?(n.from=parseInt(s/1e3),n.to=this.sum(n.from,i*this.parseTimeframe(t))):void 0!==s?(n.from=parseInt(s/1e3),n.to=this.sum(this.seconds(),1)):void 0!==i&&(n.to=this.seconds(),n.from=n.to-i*this.parseTimeframe(t));const o=await this.v4PublicGetCoinCandle(this.extend(n,r)),c=this.safeValue(o,"candles",[]);return this.parseOHLCVs(c,a,t,s,i)}async fetchOrders(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchOrders () requires a symbol argument");await this.loadMarkets();const r=this.market(e),n={coin_pair:r.id},o=await this.privatePostListOrders(this.extend(n,i)),c=this.safeValue(o,"response_data",{}),d=this.safeValue(c,"orders",[]);return this.parseOrders(d,r,t,s)}async fetchOpenOrders(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchOpenOrders () requires a symbol argument");await this.loadMarkets();const r=this.market(e),n={coin_pair:r.id,status_list:"[2]"},o=await this.privatePostListOrders(this.extend(n,i)),c=this.safeValue(o,"response_data",{}),d=this.safeValue(c,"orders",[]);return this.parseOrders(d,r,t,s)}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchMyTrades () requires a symbol argument");await this.loadMarkets();const r=this.market(e),n={coin_pair:r.id,has_fills:!0},o=await this.privatePostListOrders(this.extend(n,i)),c=this.safeValue(o,"response_data",{}),d=this.safeValue(c,"orders",[]),h=this.parseOrders(d,r,t,s),u=this.ordersToTrades(h);return this.filterBySymbolSinceLimit(u,e,t,s)}ordersToTrades(e){const t=[];for(let s=0;s<e.length;s++){const i=this.safeValue(e[s],"trades",[]);for(let e=0;e<i.length;e++)t.push(i[e])}return t}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t]+"/";const o=this.omit(i,this.extractParams(e));if("public"===t||"v4Public"===t)n+=this.implodeParams(e,i),Object.keys(o).length&&(n+="?"+this.urlencode(o));else{this.checkRequiredCredentials(),n+=this.version+"/";const t=this.nonce();a=this.urlencode(this.extend({tapi_method:e,tapi_nonce:t},i));const s="/tapi/"+this.version+"/?"+a;r={"Content-Type":"application/x-www-form-urlencoded","TAPI-ID":this.apiKey,"TAPI-MAC":this.hmac(this.encode(s),this.encode(this.secret),"sha512")}}return{url:n,method:s,body:a,headers:r}}async request(e,t="public",s="GET",i={},a,n){const o=await this.fetch2(e,t,s,i,a,n);if("error_message"in o)throw new r(this.id+" "+this.json(o));return o}}},4554:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r}=s(3449),a=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"mixcoins",name:"MixCoins",countries:["GB","HK"],rateLimit:1500,version:"v1",userAgent:this.userAgents.chrome,has:{cancelOrder:!0,CORS:!1,createOrder:!0,fetchBalance:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTrades:!0},urls:{logo:"https://user-images.githubusercontent.com/51840849/87460810-1dd06c00-c616-11ea-9276-956f400d6ffa.jpg",api:"https://mixcoins.com/api",www:"https://mixcoins.com",doc:"https://mixcoins.com/help/api/"},api:{public:{get:["ticker/","trades/","depth/"]},private:{post:["cancel","info","orders","order","transactions","trade"]}},markets:{"BTC/USDT":{id:"btc_usdt",symbol:"BTC/USDT",base:"BTC",quote:"USDT",baseId:"btc",quoteId:"usdt",maker:.0015,taker:.0025},"ETH/BTC":{id:"eth_btc",symbol:"ETH/BTC",base:"ETH",quote:"BTC",baseId:"eth",quoteId:"btc",maker:.001,taker:.0015},"BCH/BTC":{id:"bch_btc",symbol:"BCH/BTC",base:"BCH",quote:"BTC",baseId:"bch",quoteId:"btc",maker:.001,taker:.0015},"LSK/BTC":{id:"lsk_btc",symbol:"LSK/BTC",base:"LSK",quote:"BTC",baseId:"lsk",quoteId:"btc",maker:.0015,taker:.0025},"BCH/USDT":{id:"bch_usdt",symbol:"BCH/USDT",base:"BCH",quote:"USDT",baseId:"bch",quoteId:"usdt",maker:.001,taker:.0015},"ETH/USDT":{id:"eth_usdt",symbol:"ETH/USDT",base:"ETH",quote:"USDT",baseId:"eth",quoteId:"usdt",maker:.001,taker:.0015}}})}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostInfo(e),s=this.safeValue(t.result,"wallet"),i={info:t},r=Object.keys(s);for(let e=0;e<r.length;e++){const t=r[e],a=this.safeCurrencyCode(t),n=this.safeValue(s,t,{}),o=this.account();o.free=this.safeString(n,"avail"),o.used=this.safeString(n,"lock"),i[a]=o}return this.parseBalance(i,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={market:this.marketId(e)},r=await this.publicGetDepth(this.extend(i,s));return this.parseOrderBook(r.result,e)}async fetchTicker(e,t={}){await this.loadMarkets();const s={market:this.marketId(e)},i=await this.publicGetTicker(this.extend(s,t)),r=this.safeValue(i,"result"),a=this.milliseconds(),n=this.safeNumber(r,"last");return{symbol:e,timestamp:a,datetime:this.iso8601(a),high:this.safeNumber(r,"high"),low:this.safeNumber(r,"low"),bid:this.safeNumber(r,"buy"),bidVolume:void 0,ask:this.safeNumber(r,"sell"),askVolume:void 0,vwap:void 0,open:void 0,close:n,last:n,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(r,"vol"),quoteVolume:void 0,info:r}}parseTrade(e,t){const s=this.safeTimestamp(e,"date");let i;void 0!==t&&(i=t.symbol);const r=this.safeString(e,"id"),n=this.safeString(e,"price"),o=this.safeString(e,"amount"),c=this.parseNumber(n),d=this.parseNumber(o),h=this.parseNumber(a.stringMul(n,o));return{id:r,info:e,timestamp:s,datetime:this.iso8601(s),symbol:i,type:void 0,side:void 0,order:void 0,takerOrMaker:void 0,price:c,amount:d,cost:h,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={market:r.id},n=await this.publicGetTrades(this.extend(a,i));return this.parseTrades(n.result,r,t,s)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n={market:this.marketId(e),op:s,amount:i};"market"===t?(n.order_type=1,n.price=r):n.order_type=0;const o=await this.privatePostTrade(this.extend(n,a));return{info:o,id:o.result.id.toString()}}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={id:e};return await this.privatePostCancel(this.extend(i,s))}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api+"/"+this.version+"/"+e;if("public"===t)Object.keys(i).length&&(n+="?"+this.urlencode(i));else{this.checkRequiredCredentials();const e=this.nonce();a=this.urlencode(this.extend({nonce:e},i)),r={"Content-Type":"application/x-www-form-urlencoded",Key:this.apiKey,Sign:this.hmac(this.encode(a),this.secret,"sha512")}}return{url:n,method:s,body:a,headers:r}}async request(e,t="public",s="GET",i={},a,n){const o=await this.fetch2(e,t,s,i,a,n);if("status"in o&&200===o.status)return o;throw new r(this.id+" "+this.json(o))}}},1985:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,AuthenticationError:a,InsufficientFunds:n,BadSymbol:o,OrderNotFound:c}=s(3449),{TICK_SIZE:d}=s(2115),h=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"ndax",name:"NDAX",countries:["US"],rateLimit:1e3,pro:!0,has:{cancelAllOrders:!0,cancelOrder:!0,createDepositAddress:!0,createOrder:!0,editOrder:!0,fetchAccounts:!0,fetchBalance:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchLedger:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrderTrades:!0,fetchTicker:!0,fetchTrades:!0,fetchWithdrawals:!0},timeframes:{"1m":"60","5m":"300","15m":"900","30m":"1800","1h":"3600","2h":"7200","4h":"14400","6h":"21600","12h":"43200","1d":"86400","1w":"604800","1M":"2419200","4M":"9676800"},urls:{logo:"https://user-images.githubusercontent.com/1294454/108623144-67a3ef00-744e-11eb-8140-75c6b851e945.jpg",test:{public:"https://ndaxmarginstaging.cdnhop.net:8443/AP",private:"https://ndaxmarginstaging.cdnhop.net:8443/AP"},api:{public:"https://api.ndax.io:8443/AP",private:"https://api.ndax.io:8443/AP"},www:"https://ndax.io",doc:["https://apidoc.ndax.io/"],fees:"https://ndax.io/fees",referral:"https://one.ndax.io/bfQiSL"},api:{public:{get:["Activate2FA","Authenticate2FA","AuthenticateUser","GetL2Snapshot","GetLevel1","GetValidate2FARequiredEndpoints","LogOut","GetTickerHistory","GetProduct","GetProducts","GetInstrument","GetInstruments","Ping","trades","GetLastTrades","SubscribeLevel1","SubscribeLevel2","SubscribeTicker","SubscribeTrades","SubscribeBlockTrades","UnsubscribeBlockTrades","UnsubscribeLevel1","UnsubscribeLevel2","UnsubscribeTicker","UnsubscribeTrades","Authenticate"]},private:{get:["GetUserAccountInfos","GetUserAccounts","GetUserAffiliateCount","GetUserAffiliateTag","GetUserConfig","GetAllUnredactedUserConfigsForUser","GetUnredactedUserConfigByKey","GetUserDevices","GetUserReportTickets","GetUserReportWriterResultRecords","GetAccountInfo","GetAccountPositions","GetAllAccountConfigs","GetTreasuryProductsForAccount","GetAccountTrades","GetAccountTransactions","GetOpenTradeReports","GetAllOpenTradeReports","GetTradesHistory","GetOpenOrders","GetOpenQuotes","GetOrderFee","GetOrderHistory","GetOrdersHistory","GetOrderStatus","GetOmsFeeTiers","GetAccountDepositTransactions","GetAccountWithdrawTransactions","GetAllDepositRequestInfoTemplates","GetDepositInfo","GetDepositRequestInfoTemplate","GetDeposits","GetDepositTicket","GetDepositTickets","GetOMSWithdrawFees","GetWithdrawFee","GetWithdraws","GetWithdrawTemplate","GetWithdrawTemplateTypes","GetWithdrawTicket","GetWithdrawTickets"],post:["AddUserAffiliateTag","CancelUserReport","RegisterNewDevice","SubscribeAccountEvents","UpdateUserAffiliateTag","GenerateTradeActivityReport","GenerateTransactionActivityReport","GenerateTreasuryActivityReport","ScheduleTradeActivityReport","ScheduleTransactionActivityReport","ScheduleTreasuryActivityReport","CancelAllOrders","CancelOrder","CancelQuote","CancelReplaceOrder","CreateQuote","ModifyOrder","SendOrder","SubmitBlockTrade","UpdateQuote","CancelWithdraw","CreateDepositTicket","CreateWithdrawTicket","SubmitDepositTicketComment","SubmitWithdrawTicketComment","GetOrderHistoryByOrderId"]}},fees:{trading:{tierBased:!1,percentage:!0,maker:.002,taker:.0025}},requiredCredentials:{apiKey:!0,secret:!0,uid:!0},precisionMode:d,exceptions:{exact:{Not_Enough_Funds:n,"Server Error":r,"Resource Not Found":c},broad:{"Invalid InstrumentId":o,"This endpoint requires 2FACode along with the payload":a}},options:{omsId:1,orderTypes:{Market:1,Limit:2,StopMarket:3,StopLimit:4,TrailingStopMarket:5,TrailingStopLimit:6,BlockTrade:7}}})}async fetchCurrencies(e={}){const t={omsId:this.safeInteger(this.options,"omsId",1)},s=await this.publicGetGetProducts(this.extend(t,e)),i={};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"ProductId"),a=this.safeString(t,"ProductFullName"),n=this.safeString(t,"ProductType"),o=this.safeCurrencyCode(this.safeString(t,"Product")),c=this.safeNumber(t,"TickSize"),d=!this.safeValue(t,"IsDisabled");i[o]={id:r,name:a,code:o,type:n,precision:c,info:t,active:d,fee:void 0,limits:this.limits}}return i}async fetchMarkets(e={}){const t={omsId:this.safeInteger(this.options,"omsId",1)},s=await this.publicGetGetInstruments(this.extend(t,e)),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"InstrumentId"),a=this.safeString(t,"Product1"),n=this.safeString(t,"Product2"),o=this.safeCurrencyCode(this.safeString(t,"Product1Symbol")),c=this.safeCurrencyCode(this.safeString(t,"Product2Symbol")),d=o+"/"+c,h={amount:this.safeNumber(t,"QuantityIncrement"),price:this.safeNumber(t,"PriceIncrement")},u=this.safeString(t,"SessionStatus"),l=this.safeValue(t,"IsDisable"),f=!(!("Running"===u)||l);i.push({id:r,symbol:d,base:o,quote:c,baseId:a,quoteId:n,info:t,active:f,precision:h,limits:{amount:{min:this.safeNumber(t,"MinimumQuantity"),max:void 0},price:{min:this.safeNumber(t,"MinimumPrice"),max:void 0},cost:{min:void 0,max:void 0}}})}return i}parseOrderBook(e,t,s,i="bids",r="asks",a=6,n=8){let o;const c={symbol:t,bids:[],asks:[],timestamp:void 0,datetime:void 0,nonce:void 0};for(let t=0;t<e.length;t++){const d=e[t];if(void 0===s)s=this.safeInteger(d,2);else{const e=this.safeInteger(d,2);s=Math.max(s,e)}if(void 0===o)o=this.safeInteger(d,0);else{const e=this.safeInteger(d,0);o=Math.max(o,e)}const h=this.parseBidAsk(d,a,n);c[this.safeInteger(d,9)?r:i].push(h)}return c.bids=this.sortBy(c.bids,0,!0),c.asks=this.sortBy(c.asks,0),c.timestamp=s,c.datetime=this.iso8601(s),c.nonce=o,c}async fetchOrderBook(e,t,s={}){const i=this.safeInteger(this.options,"omsId",1);await this.loadMarkets();t=void 0===t?100:t;const r={omsId:i,InstrumentId:this.market(e).id,Depth:t},a=await this.publicGetGetL2Snapshot(this.extend(r,s));return this.parseOrderBook(a,e)}parseTicker(e,t){const s=this.safeInteger(e,"TimeStamp"),i=this.safeString(e,"InstrumentId"),r=this.safeSymbol(i,t),a=this.safeNumber(e,"LastTradedPx"),n=this.safeNumber(e,"Rolling24HrPxChangePercent"),o=this.safeNumber(e,"Rolling24HrPxChange"),c=this.safeNumber(e,"SessionOpen");let d;void 0!==a&&void 0!==o&&(d=this.sum(a,c)/2);const h=this.safeNumber(e,"Rolling24HrVolume"),u=this.safeNumber(e,"Rolling24HrNotional"),l=this.vwap(h,u);return{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"SessionHigh"),low:this.safeNumber(e,"SessionLow"),bid:this.safeNumber(e,"BestBid"),bidVolume:void 0,ask:this.safeNumber(e,"BestOffer"),askVolume:void 0,vwap:l,open:c,close:a,last:a,previousClose:void 0,change:o,percentage:n,average:d,baseVolume:h,quoteVolume:u,info:e}}async fetchTicker(e,t={}){const s=this.safeInteger(this.options,"omsId",1);await this.loadMarkets();const i=this.market(e),r={omsId:s,InstrumentId:i.id},a=await this.publicGetGetLevel1(this.extend(r,t));return this.parseTicker(a,i)}parseOHLCV(e,t){return[this.safeInteger(e,0),this.safeNumber(e,3),this.safeNumber(e,1),this.safeNumber(e,2),this.safeNumber(e,4),this.safeNumber(e,5)]}async fetchOHLCV(e,t="1m",s,i,r={}){const a=this.safeInteger(this.options,"omsId",1);await this.loadMarkets();const n=this.market(e),o={omsId:a,InstrumentId:n.id,Interval:this.timeframes[t]},c=this.parseTimeframe(t),d=this.milliseconds();void 0===s?void 0!==i&&(o.FromDate=this.ymdhms(d-c*i*1e3),o.ToDate=this.ymdhms(d)):(o.FromDate=this.ymdhms(s),o.ToDate=void 0===i?this.ymdhms(d):this.ymdhms(this.sum(s,c*i*1e3)));const h=await this.publicGetGetTickerHistory(this.extend(o,r));return this.parseOHLCVs(h,n,t,s,i)}parseTrade(e,t){let s,i,r,a,n,o,c,d,u,l,f;if(Array.isArray(e)){s=this.safeString(e,3),i=this.safeString(e,2),a=this.safeInteger(e,6),n=this.safeString(e,0),o=this.safeString(e,1);c=this.safeValue(e,8)?"sell":"buy",d=this.safeString(e,4)}else{a=this.safeInteger2(e,"TradeTimeMS","ReceiveTime"),n=this.safeString(e,"TradeId"),d=this.safeString2(e,"OrderId","OrigOrderId"),o=this.safeString2(e,"InstrumentId","Instrument"),s=this.safeString(e,"Price"),i=this.safeString(e,"Quantity"),r=this.safeNumber2(e,"Value","GrossValueExecuted"),u=this.safeStringLower(e,"MakerTaker"),c=this.safeStringLower(e,"Side"),f=this.safeStringLower(e,"OrderType");const t=this.safeNumber(e,"Fee");if(void 0!==t){const s=this.safeString(e,"FeeProductId");l={cost:t,currency:this.safeCurrencyCode(s)}}}const p=this.parseNumber(s),m=this.parseNumber(i);void 0===r&&(r=this.parseNumber(h.stringMul(s,i)));return{info:e,id:n,symbol:this.safeSymbol(o,t),timestamp:a,datetime:this.iso8601(a),order:d,type:f,side:c,takerOrMaker:u,price:p,amount:m,cost:r,fee:l}}async fetchTrades(e,t,s,i={}){const r=this.safeInteger(this.options,"omsId",1);await this.loadMarkets();const a=this.market(e),n={omsId:r,InstrumentId:a.id};void 0!==s&&(n.Count=s);const o=await this.publicGetGetLastTrades(this.extend(n,i));return this.parseTrades(o,a,t,s)}async fetchAccounts(e={}){const t=this.safeInteger(this.options,"omsId",1);this.checkRequiredCredentials();const s={omsId:t,UserId:this.uid,UserName:"igor@ccxt.trade"},i=await this.privateGetGetUserAccounts(this.extend(s,e)),r=[];for(let e=0;e<i.length;e++){const t=this.safeString(i,e);r.push({id:t,type:void 0,currency:void 0,info:t})}return r}async fetchBalance(e={}){const t=this.safeInteger(this.options,"omsId",1);await this.loadMarkets(),await this.loadAccounts();const s=this.safeInteger2(this.options,"accountId","AccountId",parseInt(this.accounts[0].id)),i=this.safeInteger2(e,"accountId","AccountId",s);e=this.omit(e,["accountId","AccountId"]);const r={omsId:t,AccountId:i},a=await this.privateGetGetAccountPositions(this.extend(r,e)),n={info:a,timestamp:void 0,datetime:void 0};for(let e=0;e<a.length;e++){const t=a[e],s=this.safeString(t,"ProductId"),i=this.safeCurrencyCode(s),r=this.account();r.total=this.safeString(t,"Amount"),r.used=this.safeString(t,"Hold"),n[i]=r}return this.parseBalance(n,!1)}parseLedgerEntryType(e){return this.safeString({Trade:"trade",Deposit:"transaction",Withdraw:"transaction",Transfer:"transfer",OrderHold:"trade",WithdrawHold:"transaction",DepositHold:"transaction",MarginHold:"trade",ManualHold:"trade",ManualEntry:"trade",MarginAcquisition:"trade",MarginRelinquish:"trade",MarginQuoteHold:"trade"},e,e)}parseLedgerEntry(e,t){const s=this.safeString(e,"TransactionId"),i=this.safeString(e,"AccountId"),r=this.safeString(e,"ReferenceId"),a=this.safeString(e,"Counterparty"),n=this.parseLedgerEntryType(this.safeString(e,"ReferenceType")),o=this.safeString(e,"ProductId"),c=this.safeCurrencyCode(o,t),d=this.safeNumber(e,"CR"),h=this.safeNumber(e,"DR");let u,l;d>0?(u=d,l="in"):h>0&&(u=h,l="out");const f=this.safeInteger(e,"TimeStamp");let p;const m=this.safeNumber(e,"Balance");"out"===l?p=this.sum(m,u):"in"===l&&(p=Math.max(0,m-u));return{info:e,id:s,direction:l,account:i,referenceId:r,referenceAccount:a,type:n,currency:c,amount:u,before:p,after:m,status:"ok",timestamp:f,datetime:this.iso8601(f),fee:void 0}}async fetchLedger(e,t,s,i={}){const r=this.safeInteger(this.options,"omsId",1);await this.loadMarkets(),await this.loadAccounts();const a=this.safeInteger2(this.options,"accountId","AccountId",parseInt(this.accounts[0].id)),n=this.safeInteger2(i,"accountId","AccountId",a);i=this.omit(i,["accountId","AccountId"]);const o={omsId:r,AccountId:n};void 0!==s&&(o.Depth=s);const c=await this.privateGetGetAccountTransactions(this.extend(o,i));let d;return void 0!==e&&(d=this.currency(e)),this.parseLedger(c,d,t,s)}parseOrderStatus(e){return this.safeString({Accepted:"open",Rejected:"rejected",Working:"open",Canceled:"canceled",Expired:"expired",FullyExecuted:"closed"},e,e)}parseOrder(e,t){const s=this.safeString2(e,"ReplacementOrderId","OrderId"),i=this.safeInteger(e,"ReceiveTime"),r=this.safeInteger(e,"LastUpdatedTime"),a=this.safeString(e,"Instrument"),n=this.safeSymbol(a,t),o=this.safeStringLower(e,"Side"),c=this.safeStringLower(e,"OrderType"),d=this.safeString2(e,"ReplacementClOrdId","ClientOrderId");let h=this.safeNumber(e,"Price",0);h=h>0?h:void 0;const u=this.safeNumber(e,"OrigQuantity"),l=this.safeNumber(e,"QuantityExecuted"),f=this.safeNumber(e,"GrossValueExecuted");let p=this.safeNumber(e,"AvgPrice",0);p=p>0?p:void 0;let m=this.safeNumber(e,"StopPrice",0);m=m>0?m:void 0;const b=this.parseOrderStatus(this.safeString(e,"OrderState"));return this.safeOrder({id:s,clientOrderId:d,info:e,timestamp:i,datetime:this.iso8601(i),lastTradeTimestamp:r,status:b,symbol:n,type:c,timeInForce:undefined,postOnly:void 0,side:o,price:h,stopPrice:m,cost:f,amount:u,filled:l,average:p,remaining:void 0,fee:undefined,trades:undefined})}async createOrder(e,t,s,i,r,a={}){const n=this.safeInteger(this.options,"omsId",1);await this.loadMarkets(),await this.loadAccounts();const o=this.safeInteger2(this.options,"accountId","AccountId",parseInt(this.accounts[0].id)),c=this.safeInteger2(a,"accountId","AccountId",o),d=this.safeInteger2(a,"ClientOrderId","clientOrderId");a=this.omit(a,["accountId","AccountId","clientOrderId","ClientOrderId"]);const h=this.market(e),u="buy"===s?0:1,l={InstrumentId:parseInt(h.id),omsId:n,AccountId:c,TimeInForce:1,Side:u,Quantity:parseFloat(this.amountToPrecision(e,i)),OrderType:this.safeInteger(this.options.orderTypes,this.capitalize(t))};void 0!==r&&(l.LimitPrice=parseFloat(this.priceToPrecision(e,r))),void 0!==d&&(l.ClientOrderId=d);const f=await this.privatePostSendOrder(this.extend(l,a));return this.parseOrder(f,h)}async editOrder(e,t,s,i,r,a,n={}){const o=this.safeInteger(this.options,"omsId",1);await this.loadMarkets(),await this.loadAccounts();const c=this.safeInteger2(this.options,"accountId","AccountId",parseInt(this.accounts[0].id)),d=this.safeInteger2(n,"accountId","AccountId",c),h=this.safeInteger2(n,"ClientOrderId","clientOrderId");n=this.omit(n,["accountId","AccountId","clientOrderId","ClientOrderId"]);const u=this.market(t),l="buy"===i?0:1,f={OrderIdToReplace:parseInt(e),InstrumentId:parseInt(u.id),omsId:o,AccountId:d,TimeInForce:1,Side:l,Quantity:parseFloat(this.amountToPrecision(t,r)),OrderType:this.safeInteger(this.options.orderTypes,this.capitalize(s))};void 0!==a&&(f.LimitPrice=parseFloat(this.priceToPrecision(t,a))),void 0!==h&&(f.ClientOrderId=h);const p=await this.privatePostCancelReplaceOrder(this.extend(f,n));return this.parseOrder(p,u)}async fetchMyTrades(e,t,s,i={}){const r=this.safeInteger(this.options,"omsId",1);await this.loadMarkets(),await this.loadAccounts();const a=this.safeInteger2(this.options,"accountId","AccountId",parseInt(this.accounts[0].id)),n=this.safeInteger2(i,"accountId","AccountId",a);i=this.omit(i,["accountId","AccountId"]);const o={omsId:r,AccountId:n};let c;void 0!==e&&(c=this.market(e),o.InstrumentId=c.id),void 0!==t&&(o.StartTimeStamp=parseInt(t/1e3)),void 0!==s&&(o.Depth=s);const d=await this.privateGetGetTradesHistory(this.extend(o,i));return this.parseTrades(d,c,t,s)}async cancelAllOrders(e,t={}){const s=this.safeInteger(this.options,"omsId",1);await this.loadMarkets(),await this.loadAccounts();const i=this.safeInteger2(this.options,"accountId","AccountId",parseInt(this.accounts[0].id)),r=this.safeInteger2(t,"accountId","AccountId",i);t=this.omit(t,["accountId","AccountId"]);const a={omsId:s,AccountId:r};if(void 0!==e){const t=this.market(e);a.IntrumentId=t.id}return await this.privatePostCancelAllOrders(this.extend(a,t))}async cancelOrder(e,t,s={}){const i=this.safeInteger(this.options,"omsId",1);let r;await this.loadMarkets(),await this.loadAccounts(),void 0!==t&&(r=this.market(t));const a={omsId:i},n=this.safeInteger2(s,"clientOrderId","ClOrderId");void 0!==n?a.ClOrderId=n:a.OrderId=parseInt(e),s=this.omit(s,["clientOrderId","ClOrderId"]);const o=await this.privatePostCancelOrder(this.extend(a,s)),c=this.parseOrder(o,r);return this.extend(c,{id:e,clientOrderId:n})}async fetchOpenOrders(e,t,s,i={}){const r=this.safeInteger(this.options,"omsId",1);await this.loadMarkets(),await this.loadAccounts();const a=this.safeInteger2(this.options,"accountId","AccountId",parseInt(this.accounts[0].id)),n=this.safeInteger2(i,"accountId","AccountId",a);let o;i=this.omit(i,["accountId","AccountId"]),void 0!==e&&(o=this.market(e));const c={omsId:r,AccountId:n},d=await this.privateGetGetOpenOrders(this.extend(c,i));return this.parseOrders(d,o,t,s)}async fetchOrders(e,t,s,i={}){const r=this.safeInteger(this.options,"omsId",1);await this.loadMarkets(),await this.loadAccounts();const a=this.safeInteger2(this.options,"accountId","AccountId",parseInt(this.accounts[0].id)),n=this.safeInteger2(i,"accountId","AccountId",a);i=this.omit(i,["accountId","AccountId"]);const o={omsId:r,AccountId:n};let c;void 0!==e&&(c=this.market(e),o.InstrumentId=c.id),void 0!==t&&(o.StartTimeStamp=parseInt(t/1e3)),void 0!==s&&(o.Depth=s);const d=await this.privateGetGetOrdersHistory(this.extend(o,i));return this.parseOrders(d,c,t,s)}async fetchOrder(e,t,s={}){const i=this.safeInteger(this.options,"omsId",1);await this.loadMarkets(),await this.loadAccounts();const r=this.safeInteger2(this.options,"accountId","AccountId",parseInt(this.accounts[0].id)),a=this.safeInteger2(s,"accountId","AccountId",r);let n;s=this.omit(s,["accountId","AccountId"]),void 0!==t&&(n=this.market(t));const o={omsId:i,AccountId:a,OrderId:parseInt(e)},c=await this.privateGetGetOrderStatus(this.extend(o,s));return this.parseOrder(c,n)}async fetchOrderTrades(e,t,s,i,r={}){const a=this.safeInteger(this.options,"omsId",1);let n;await this.loadMarkets(),await this.loadAccounts(),void 0!==t&&(n=this.market(t));const o={OMSId:parseInt(a),OrderId:parseInt(e)},c=await this.privatePostGetOrderHistoryByOrderId(this.extend(o,r)),d=this.groupBy(c,"ChangeReason"),h=this.safeValue(d,"Trade",[]);return this.parseTrades(h,n,s,i)}async fetchDepositAddress(e,t={}){const s=this.safeInteger(this.options,"omsId",1);await this.loadMarkets(),await this.loadAccounts();const i=this.safeInteger2(this.options,"accountId","AccountId",parseInt(this.accounts[0].id)),r=this.safeInteger2(t,"accountId","AccountId",i);t=this.omit(t,["accountId","AccountId"]);const a=this.currency(e),n={omsId:s,AccountId:r,ProductId:a.id,GenerateNewKey:!1},o=await this.privateGetGetDepositInfo(this.extend(n,t));return this.parseDepositAddress(o,a)}parseDepositAddress(e,t){const s=this.safeString(e,"DepositInfo"),i=JSON.parse(s),r=i.length,a=this.safeString(i,r-1).split("?memo="),n=this.safeString(a,0),o=this.safeString(a,1);let c;return void 0!==t&&(c=t.code),this.checkAddress(n),{currency:c,address:n,tag:o,info:e}}async createDepositAddress(e,t={}){return await this.fetchDepositAddress(e,this.extend({GenerateNewKey:!0},t))}async fetchDeposits(e,t,s,i={}){const r=this.safeInteger(this.options,"omsId",1);await this.loadMarkets(),await this.loadAccounts();const a=this.safeInteger2(this.options,"accountId","AccountId",parseInt(this.accounts[0].id)),n=this.safeInteger2(i,"accountId","AccountId",a);let o;i=this.omit(i,["accountId","AccountId"]),void 0!==e&&(o=this.currency(e));const c={omsId:r,AccountId:n},d=await this.privateGetGetDeposits(this.extend(c,i));return this.parseTransactions(d,o,t,s)}async fetchWithdrawals(e,t,s,i={}){const r=this.safeInteger(this.options,"omsId",1);await this.loadMarkets(),await this.loadAccounts();const a=this.safeInteger2(this.options,"accountId","AccountId",parseInt(this.accounts[0].id)),n=this.safeInteger2(i,"accountId","AccountId",a);let o;i=this.omit(i,["accountId","AccountId"]),void 0!==e&&(o=this.currency(e));const c={omsId:r,AccountId:n},d=await this.privateGetGetWithdraws(this.extend(c,i));return this.parseTransactions(d,o,t,s)}parseTransactionStatusByType(e,t){const s=this.safeValue({deposit:{New:"pending",AdminProcessing:"pending",Accepted:"pending",Rejected:"rejected",SystemProcessing:"pending",FullyProcessed:"ok",Failed:"failed",Pending:"pending",Confirmed:"pending",AmlProcessing:"pending",AmlAccepted:"pending",AmlRejected:"rejected",AmlFailed:"failed",LimitsAccepted:"pending",LimitsRejected:"rejected"},withdrawal:{New:"pending",AdminProcessing:"pending",Accepted:"pending",Rejected:"rejected",SystemProcessing:"pending",FullyProcessed:"ok",Failed:"failed",Pending:"pending",Pending2Fa:"pending",AutoAccepted:"pending",Delayed:"pending",UserCanceled:"canceled",AdminCanceled:"canceled",AmlProcessing:"pending",AmlAccepted:"pending",AmlRejected:"rejected",AmlFailed:"failed",LimitsAccepted:"pending",LimitsRejected:"rejected",Submitted:"pending",Confirmed:"pending",ManuallyConfirmed:"pending",Confirmed2Fa:"pending"}},t,{});return this.safeString(s,e,e)}parseTransaction(e,t){const s=this.safeString(e,"DepositId");let i;const r=this.safeString(e,"ProductId"),a=this.safeCurrencyCode(r,t);let n,o;"DepositId"in e?o="deposit":"WithdrawId"in e&&(o="withdrawal");const c=this.safeString(e,"TemplateForm");let d,h=this.safeInteger(e,"LastUpdateTimeStamp");if(void 0!==c){const e=JSON.parse(c);d=this.safeString(e,"ExternalAddress"),i=this.safeString(e,"TxId"),n=this.safeInteger(e,"TimeSubmitted"),h=this.safeInteger(e,"LastUpdated",h)}const u=d,l=this.parseTransactionStatusByType(this.safeString(e,"TicketStatus"),o),f=this.safeNumber(e,"Amount"),p=this.safeNumber(e,"FeeAmount");let m;return void 0!==p&&(m={currency:a,cost:p}),{info:e,id:s,txid:i,timestamp:n,datetime:this.iso8601(n),address:d,addressTo:u,addressFrom:void 0,tag:void 0,tagTo:void 0,tagFrom:void 0,type:o,amount:f,currency:a,status:l,updated:h,fee:m}}async withdraw(e,t,s,i,a={}){if(void 0===this.twofa)throw new r(this.id+" withdraw() requires exchange.twofa credential for OATH codes");this.checkAddress(s);const n=this.safeInteger(this.options,"omsId",1);await this.loadMarkets(),await this.loadAccounts();const o=this.safeInteger2(this.options,"accountId","AccountId",parseInt(this.accounts[0].id)),c=this.safeInteger2(a,"accountId","AccountId",o);a=this.omit(a,["accountId","AccountId"]);const d=this.currency(e),h={omsId:n,AccountId:c,ProductId:d.id},u=await this.privateGetGetWithdrawTemplateTypes(h),l=this.safeValue(u,"TemplateTypes",[]),f=this.safeValue(l,0);if(void 0===f)throw new r(this.id+" withdraw() could not find a withdraw template type for "+d.code);const p=this.safeString(f,"TemplateName"),m={omsId:n,AccountId:c,ProductId:d.id,TemplateType:p,AccountProviderId:f.AccountProviderId},b=await this.privateGetGetWithdrawTemplate(m),g=this.safeString(b,"Template");if(void 0===g)throw new r(this.id+" withdraw() could not find a withdraw template for "+d.code);const y=JSON.parse(g);y.ExternalAddress=s,void 0!==i&&"Memo"in y&&(y.Memo=i);const v={omsId:n,AccountId:c,ProductId:d.id,TemplateForm:this.json(y),TemplateType:p},w={TfaType:"Google",TFaCode:this.oath(),Payload:this.json(v)},k=await this.privatePostCreateWithdrawTicket(this.deepExtend(w,a));return{info:k,id:this.safeString(k,"Id")}}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t]+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if("public"===t)Object.keys(o).length&&(n+="?"+this.urlencode(o));else if("private"===t){this.checkRequiredCredentials();const e=this.nonce().toString(),t=e+this.uid+this.apiKey,i=this.hmac(this.encode(t),this.encode(this.secret));r={Nonce:e,APIKey:this.apiKey,Signature:i,UserId:this.uid},"POST"===s?(r["Content-Type"]="application/json",a=this.json(o)):Object.keys(o).length&&(n+="?"+this.urlencode(o))}return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,n,o,c,d,h){if(404===e)throw new a(this.id+" "+o);if(void 0===c)return;const u=this.safeString(c,"errormsg");if(void 0!==u&&""!==u){const e=this.id+" "+o;throw this.throwExactlyMatchedException(this.exceptions.exact,u,e),this.throwBroadlyMatchedException(this.exceptions.broad,o,e),new r(e)}}}},1541:(e,t,s)=>{"use strict";const i=s(8819),{AuthenticationError:r,ExchangeError:a,PermissionDenied:n,BadRequest:o,CancelPending:c,OrderNotFound:d,InsufficientFunds:h,RateLimitExceeded:u,InvalidOrder:l,AccountSuspended:f,BadSymbol:p,OnMaintenance:m}=s(3449),{TRUNCATE:b}=s(2115),g=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"novadax",name:"NovaDAX",countries:["BR"],rateLimit:50,version:"v1",has:{CORS:!1,cancelOrder:!0,createOrder:!0,fetchAccounts:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchDeposits:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrders:!0,fetchOrderTrades:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTransactions:!0,fetchWithdrawals:!0,withdraw:!0},timeframes:{"1m":"ONE_MIN","5m":"FIVE_MIN","15m":"FIFTEEN_MIN","30m":"HALF_HOU","1h":"ONE_HOU","1d":"ONE_DAY","1w":"ONE_WEE","1M":"ONE_MON"},urls:{logo:"https://user-images.githubusercontent.com/1294454/92337550-2b085500-f0b3-11ea-98e7-5794fb07dd3b.jpg",api:{public:"https://api.novadax.com",private:"https://api.novadax.com"},www:"https://www.novadax.com.br",doc:["https://doc.novadax.com/pt-BR/"],fees:"https://www.novadax.com.br/fees-and-limits",referral:"https://www.novadax.com.br/?s=ccxt"},api:{public:{get:["common/symbol","common/symbols","common/timestamp","market/tickers","market/ticker","market/depth","market/trades","market/kline/history"]},private:{get:["orders/get","orders/list","orders/fill","orders/fills","account/getBalance","account/subs","account/subs/balance","account/subs/transfer/record","wallet/query/deposit-withdraw"],post:["orders/create","orders/cancel","account/withdraw/coin","account/subs/transfer"]}},fees:{trading:{tierBased:!1,percentage:!0,taker:.005,maker:.003}},requiredCredentials:{apiKey:!0,secret:!0},exceptions:{exact:{A99999:a,A10001:o,A10002:a,A10003:r,A10004:u,A10005:n,A10006:f,A10007:o,A10011:p,A10012:p,A10013:m,A30001:d,A30002:l,A30003:l,A30004:l,A30005:l,A30006:l,A30007:h,A30008:l,A30009:l,A30010:c,A30011:l,A30012:l},broad:{}},options:{fetchOHLCV:{volume:"amount"}}})}async fetchTime(e={}){const t=await this.publicGetCommonTimestamp(e);return this.safeInteger(t,"data")}async fetchMarkets(e={}){const t=await this.publicGetCommonSymbols(e),s=[],i=this.safeValue(t,"data",[]);for(let e=0;e<i.length;e++){const t=i[e],r=this.safeString(t,"baseCurrency"),a=this.safeString(t,"quoteCurrency"),n=this.safeString(t,"symbol"),o=this.safeCurrencyCode(r),c=this.safeCurrencyCode(a),d=o+"/"+c,h={amount:this.safeInteger(t,"amountPrecision"),price:this.safeInteger(t,"pricePrecision"),cost:this.safeInteger(t,"valuePrecision")},u={amount:{min:this.safeNumber(t,"minOrderAmount"),max:void 0},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(t,"minOrderValue"),max:void 0}},l="ONLINE"===this.safeString(t,"status");s.push({id:n,symbol:d,base:o,quote:c,baseId:r,quoteId:a,precision:h,limits:u,info:t,active:l})}return s}parseTicker(e,t){const s=this.safeInteger(e,"timestamp"),i=this.safeString(e,"symbol"),r=this.safeSymbol(i,t,"_"),a=this.safeNumber(e,"open24h"),n=this.safeNumber(e,"lastPrice");let o,c,d;void 0!==n&&void 0!==a&&(c=n-a,o=c/a*100,d=this.sum(n,a)/2);const h=this.safeNumber(e,"baseVolume24h"),u=this.safeNumber(e,"quoteVolume24h"),l=this.vwap(h,u);return{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high24h"),low:this.safeNumber(e,"low24h"),bid:this.safeNumber(e,"bid"),bidVolume:void 0,ask:this.safeNumber(e,"ask"),askVolume:void 0,vwap:l,open:a,close:n,last:n,previousClose:void 0,change:c,percentage:o,average:d,baseVolume:h,quoteVolume:u,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.publicGetMarketTicker(this.extend(i,t)),a=this.safeValue(r,"data",{});return this.parseTicker(a,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetMarketTickers(t),i=this.safeValue(s,"data",[]),r={};for(let e=0;e<i.length;e++){const t=this.parseTicker(i[e]);r[t.symbol]=t}return this.filterByArray(r,"symbol",e)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.marketId(e)};void 0!==t&&(i.limit=t);const r=await this.publicGetMarketDepth(this.extend(i,s)),a=this.safeValue(r,"data",{}),n=this.safeInteger(a,"timestamp");return this.parseOrderBook(a,e,n,"bids","asks")}parseTrade(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"orderId"),r=this.safeInteger(e,"timestamp"),a=this.safeStringLower(e,"side"),n=this.safeString(e,"price"),o=this.safeString(e,"amount"),c=this.parseNumber(n),d=this.parseNumber(o);let h=this.safeNumber(e,"volume");void 0===h&&(h=this.parseNumber(g.stringMul(n,o)));const u=this.safeString(e,"symbol"),l=this.safeSymbol(u,t,"_"),f=this.safeStringLower(e,"role"),p=this.safeString(e,"fee");let m;if(void 0!==p){const e=p.split(" "),t=this.safeString(e,1),s=this.safeCurrencyCode(t);m={cost:this.safeNumber(e,0),currency:s}}return{id:s,order:i,timestamp:r,datetime:this.iso8601(r),symbol:l,type:void 0,side:a,price:c,amount:d,cost:h,takerOrMaker:f,fee:m,info:e}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id};void 0!==s&&(a.limit=s);const n=await this.publicGetMarketTrades(this.extend(a,i)),o=this.safeValue(n,"data",[]);return this.parseTrades(o,r,t,s)}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={symbol:a.id,unit:this.timeframes[t]},o=this.parseTimeframe(t),c=this.seconds();if(void 0===i&&(i=3e3),void 0===s)n.from=c-i*o,n.to=c;else{const e=parseInt(s/1e3);n.from=e,n.to=this.sum(e,i*o)}const d=await this.publicGetMarketKlineHistory(this.extend(n,r)),h=this.safeValue(d,"data",[]);return this.parseOHLCVs(h,a,t,s,i)}parseOHLCV(e,t){const s=this.safeValue(this.options,"fetchOHLCV",{}),i=this.safeString(s,"volume","amount");return[this.safeTimestamp(e,"score"),this.safeNumber(e,"openPrice"),this.safeNumber(e,"highPrice"),this.safeNumber(e,"lowPrice"),this.safeNumber(e,"closePrice"),this.safeNumber(e,i)]}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetAccountGetBalance(e),s=this.safeValue(t,"data",[]),i={info:t,timestamp:void 0,datetime:void 0};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"currency"),a=this.safeCurrencyCode(r),n=this.account();n.total=this.safeString(t,"available"),n.free=this.safeString(t,"balance"),n.used=this.safeString(t,"hold"),i[a]=n}return this.parseBalance(i,!1)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o=t.toUpperCase(),c=s.toUpperCase(),d={symbol:n.id,type:o,side:c};if("LIMIT"===o)d.price=this.priceToPrecision(e,r),d.amount=this.amountToPrecision(e,i);else if("MARKET"===o)if("SELL"===c)d.amount=this.amountToPrecision(e,i);else if("BUY"===c){let e=this.safeNumber(a,"value");if(this.safeValue(this.options,"createMarketBuyOrderRequiresPrice",!0)){if(void 0!==r)void 0===e&&(e=i*r);else if(void 0===e)throw new l(this.id+" createOrder() requires the price argument with market buy orders to calculate total order cost (amount to spend), where cost = amount * price. Supply a price argument to createOrder() call if you want the cost to be calculated for you from price and amount, or, alternatively, add .options['createMarketBuyOrderRequiresPrice'] = false and supply the total cost value in the 'amount' argument or in the 'value' extra parameter (the exchange-specific behaviour)")}else e=void 0===e?i:e;const t=n.precision.price;d.value=this.decimalToPrecision(e,b,t,this.precisionMode)}const h=await this.privatePostOrdersCreate(this.extend(d,a)),u=this.safeValue(h,"data",{});return this.parseOrder(u,n)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={id:e},r=await this.privatePostOrdersCancel(this.extend(i,s)),a=this.safeValue(r,"data",{});return this.parseOrder(a)}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={id:e},r=await this.privateGetOrdersGet(this.extend(i,s)),a=this.safeValue(r,"data",{});return this.parseOrder(a)}async fetchOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.market(e),r.symbol=a.id),void 0!==s&&(r.limit=s),void 0!==t&&(r.fromTimestamp=t);const n=await this.privateGetOrdersList(this.extend(r,i)),o=this.safeValue(n,"data",[]);return this.parseOrders(o,a,t,s)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({status:"SUBMITTED,PROCESSING,PARTIAL_FILLED,CANCELING"},i))}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({status:"FILLED,CANCELED,REJECTED"},i))}async fetchOrderTrades(e,t,s,i,r={}){await this.loadMarkets();const a={id:e},n=await this.privateGetOrdersFill(this.extend(a,r));let o;void 0!==t&&(o=this.market(t));const c=this.safeValue(n,"data",[]);return this.parseTrades(c,o,s,i)}parseOrderStatus(e){return this.safeString({SUBMITTED:"open",PROCESSING:"open",PARTIAL_FILLED:"open",CANCELING:"open",FILLED:"closed",CANCELED:"canceled",REJECTED:"rejected"},e,e)}parseOrder(e,t){const s=this.safeString(e,"id"),i=this.safeNumber(e,"amount"),r=this.safeNumber(e,"price"),a=this.safeNumber(e,"filledValue"),n=this.safeStringLower(e,"type"),o=this.safeStringLower(e,"side"),c=this.parseOrderStatus(this.safeString(e,"status")),d=this.safeInteger(e,"timestamp"),h=this.safeNumber(e,"averagePrice"),u=this.safeNumber(e,"filledAmount");let l;const f=this.safeNumber(e,"filledFee");void 0!==f&&(l={cost:f,currency:void 0});const p=this.safeString(e,"symbol"),m=this.safeSymbol(p,t,"_");return this.safeOrder({id:s,clientOrderId:void 0,info:e,timestamp:d,datetime:this.iso8601(d),lastTradeTimestamp:void 0,symbol:m,type:n,timeInForce:void 0,postOnly:void 0,side:o,price:r,stopPrice:void 0,amount:i,cost:a,average:h,filled:u,remaining:void 0,status:c,fee:l,trades:void 0})}async withdraw(e,t,s,i,r={}){await this.loadMarkets();const a=this.currency(e),n={code:a.id,amount:this.currencyToPrecision(e,t),wallet:s};void 0!==i&&(n.tag=i);const o=await this.privatePostAccountWithdrawCoin(this.extend(n,r));return this.parseTransaction(o,a)}async fetchAccounts(e={}){const t=await this.privateGetAccountSubs(e),s=this.safeValue(t,"data",[]),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"subId"),a=this.safeString(t,"subAccount");i.push({id:r,type:a,currency:void 0,info:t})}return i}async fetchDeposits(e,t,s,i={}){return await this.fetchTransactions(e,t,s,this.extend({type:"coin_in"},i))}async fetchWithdrawals(e,t,s,i={}){return await this.fetchTransactions(e,t,s,this.extend({type:"coin_out"},i))}async fetchTransactions(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.currency=a.id),void 0!==s&&(r.size=s);const n=await this.privateGetWalletQueryDepositWithdraw(this.extend(r,i)),o=this.safeValue(n,"data",[]);return this.parseTransactions(o,a,t,s)}parseTransactionStatus(e){const t=e.split(" ");e=this.safeString(t,1,e);return this.safeString({Pending:"pending",confirming:"pending",SUCCESS:"ok",FAIL:"failed"},e,e)}parseTransaction(e,t){const s=this.safeString2(e,"id","data");let i=this.safeString(e,"type");"COIN_IN"===i?i="deposit":"COIN_OUT"===i&&(i="withdraw");const r=this.safeNumber(e,"amount"),a=this.safeString(e,"address"),n=this.safeString(e,"addressTag"),o=this.safeString(e,"txHash"),c=this.safeInteger(e,"createdAt"),d=this.safeInteger(e,"updatedAt"),h=this.safeString(e,"currency");return{info:e,id:s,currency:this.safeCurrencyCode(h,t),amount:r,address:a,addressTo:a,addressFrom:void 0,tag:n,tagTo:n,tagFrom:void 0,status:this.parseTransactionStatus(this.safeString(e,"state")),type:i,updated:d,txid:o,timestamp:c,datetime:this.iso8601(c),fee:void 0}}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.market(e),r.symbol=a.id),void 0!==s&&(r.limit=s),void 0!==t&&(r.fromTimestamp=t);const n=await this.privateGetOrdersFills(this.extend(r,i)),o=this.safeValue(n,"data",[]);return this.parseTrades(o,a,t,s)}sign(e,t="public",s="GET",i={},r,a){const n="/"+this.version+"/"+this.implodeParams(e,i);let o=this.urls.api[t]+n;const c=this.omit(i,this.extractParams(e));if("public"===t)Object.keys(c).length&&(o+="?"+this.urlencode(c));else if("private"===t){this.checkRequiredCredentials();const e=this.milliseconds().toString();let t;r={"X-Nova-Access-Key":this.apiKey,"X-Nova-Timestamp":e},"POST"===s?(a=this.json(c),t=this.hash(a,"md5"),r["Content-Type"]="application/json"):(Object.keys(c).length&&(o+="?"+this.urlencode(c)),t=this.urlencode(this.keysort(c)));const i=s+"\n"+n+"\n"+t+"\n"+e;r["X-Nova-Signature"]=this.hmac(this.encode(i),this.encode(this.secret))}return{url:o,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,n,o,c,d){if(void 0===o)return;const h=this.safeString(o,"code");if("A10000"!==h){const e=this.safeString(o,"message"),t=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,h,t),this.throwBroadlyMatchedException(this.exceptions.broad,e,t),new a(t)}}}},7426:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,AuthenticationError:a,ArgumentsRequired:n,BadRequest:o,InvalidOrder:c,InsufficientFunds:d,OrderNotFound:h,PermissionDenied:u}=s(3449);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"oceanex",name:"OceanEx",countries:["LU","CN","SG"],version:"v1",rateLimit:3e3,urls:{logo:"https://user-images.githubusercontent.com/1294454/58385970-794e2d80-8001-11e9-889c-0567cd79b78e.jpg",api:"https://api.oceanex.pro",www:"https://www.oceanex.pro.com",doc:"https://api.oceanex.pro/doc/v1",referral:"https://oceanex.pro/signup?referral=VE24QX"},has:{fetchMarkets:!0,fetchCurrencies:!1,fetchTicker:!0,fetchTickers:!0,fetchOrderBook:!0,fetchOrderBooks:!0,fetchTrades:!0,fetchTradingLimits:!1,fetchTradingFees:!1,fetchAllTradingFees:!0,fetchFundingFees:!1,fetchTime:!0,fetchOrder:!0,fetchOrders:!0,fetchOpenOrders:!0,fetchClosedOrders:!0,fetchBalance:!0,createMarketOrder:!0,createOrder:!0,cancelOrder:!0,cancelOrders:!0,cancelAllOrders:!0},timeframes:{"1m":"1m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","4h":"4h","12h":"12h","1d":"1d","1w":"1w"},api:{public:{get:["markets","tickers/{pair}","tickers_multi","order_book","order_book/multi","fees/trading","trades","timestamp"]},private:{get:["key","members/me","orders","orders/filter"],post:["orders","orders/multi","order/delete","order/delete/multi","orders/clear"]}},fees:{trading:{tierBased:!1,percentage:!0,maker:.001,taker:.001}},commonCurrencies:{PLA:"Plair"},exceptions:{codes:{"-1":o,"-2":o,1001:o,1004:n,1006:a,1008:a,1010:a,1011:u,2001:a,2002:c,2004:h,9003:u},exact:{"market does not have a valid value":o,"side does not have a valid value":o,"Account::AccountError: Cannot lock funds":d,"The account does not exist":a}}})}async fetchMarkets(e={}){const t=await this.publicGetMarkets(this.extend({show_details:!0},e)),s=[],i=this.safeValue(t,"data");for(let e=0;e<i.length;e++){const t=i[e],r=this.safeValue(t,"id"),a=this.safeValue(t,"name");let[n,o]=a.split("/");const c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o);n=n.toLowerCase(),o=o.toLowerCase();const h=c+"/"+d;s.push({id:r,symbol:h,base:c,quote:d,baseId:n,quoteId:o,active:!0,info:t,precision:{amount:this.safeInteger(t,"amount_precision"),price:this.safeInteger(t,"price_precision"),base:this.safeInteger(t,"ask_precision"),quote:this.safeInteger(t,"bid_precision")},limits:{amount:{min:void 0,max:void 0},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(t,"minimum_trading_amount"),max:void 0}}})}return s}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={pair:s.id},r=await this.publicGetTickersPair(this.extend(i,t)),a=this.safeValue(r,"data",{});return this.parseTicker(a,s)}async fetchTickers(e,t={}){await this.loadMarkets(),void 0===e&&(e=this.symbols);const s={markets:this.marketIds(e)},i=await this.publicGetTickersMulti(this.extend(s,t)),r=this.safeValue(i,"data"),a={};for(let e=0;e<r.length;e++){const t=r[e],s=this.safeString(t,"market"),i=this.safeMarket(s);a[i.symbol]=this.parseTicker(t,i)}return this.filterByArray(a,"symbol",e)}parseTicker(e,t){const s=this.safeValue(e,"ticker",{}),i=this.safeTimestamp(e,"at");return{symbol:t.symbol,timestamp:i,datetime:this.iso8601(i),high:this.safeNumber(s,"high"),low:this.safeNumber(s,"low"),bid:this.safeNumber(s,"buy"),bidVolume:void 0,ask:this.safeNumber(s,"sell"),askVolume:void 0,vwap:void 0,open:void 0,close:this.safeNumber(s,"last"),last:this.safeNumber(s,"last"),previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(s,"volume"),quoteVolume:void 0,info:s}}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={market:this.market(e).id};void 0!==t&&(i.limit=t);const r=await this.publicGetOrderBook(this.extend(i,s)),a=this.safeValue(r,"data",{}),n=this.safeTimestamp(a,"timestamp");return this.parseOrderBook(a,e,n)}async fetchOrderBooks(e,t,s={}){await this.loadMarkets(),void 0===e&&(e=this.symbols);const i={markets:this.marketIds(e)};void 0!==t&&(i.limit=t);const r=await this.publicGetOrderBookMulti(this.extend(i,s)),a=this.safeValue(r,"data",[]),n={};for(let e=0;e<a.length;e++){const t=a[e],s=this.safeString(t,"market"),i=this.safeSymbol(s),r=this.safeTimestamp(t,"timestamp");n[i]=this.parseOrderBook(t,i,r)}return n}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={market:r.id};void 0!==s&&(a.limit=s);const n=await this.publicGetTrades(this.extend(a,i)),o=this.safeValue(n,"data");return this.parseTrades(o,r,t,s)}parseTrade(e,t){let s=this.safeValue(e,"side");"bid"===s?s="buy":"ask"===s&&(s="sell");const i=this.safeValue(e,"market"),r=this.safeSymbol(i,t);let a=this.safeTimestamp(e,"created_on");return void 0===a&&(a=this.parse8601(this.safeString(e,"created_at"))),{info:e,timestamp:a,datetime:this.iso8601(a),symbol:r,id:this.safeString(e,"id"),order:void 0,type:"limit",takerOrMaker:void 0,side:s,price:this.safeNumber(e,"price"),amount:this.safeNumber(e,"volume"),cost:void 0,fee:void 0}}async fetchTime(e={}){const t=await this.publicGetTimestamp(e);return this.safeTimestamp(t,"data")}async fetchAllTradingFees(e={}){const t=await this.publicGetFeesTrading(e),s=this.safeValue(t,"data"),i={};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeValue(t,"ask_fee",{}),a=this.safeValue(t,"bid_fee",{}),n=this.safeString(t,"market"),o=this.safeSymbol(n);i[o]={info:t,symbol:o,maker:this.safeNumber(r,"value"),taker:this.safeNumber(a,"value")}}return i}async fetchKey(e={}){const t=await this.privateGetKey(e);return this.safeValue(t,"data")}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetMembersMe(e),s=this.safeValue(t,"data"),i=this.safeValue(s,"accounts"),r={info:t};for(let e=0;e<i.length;e++){const t=i[e],s=this.safeValue(t,"currency"),a=this.safeCurrencyCode(s),n=this.account();n.free=this.safeString(t,"balance"),n.used=this.safeString(t,"locked"),r[a]=n}return this.parseBalance(r,!1)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o={market:n.id,side:s,ord_type:t,volume:this.amountToPrecision(e,i)};"limit"===t&&(o.price=this.priceToPrecision(e,r));const c=await this.privatePostOrders(this.extend(o,a)),d=this.safeValue(c,"data");return this.parseOrder(d,n)}async fetchOrder(e,t,s={}){let i,r=e;Array.isArray(e)||(r=[e]),await this.loadMarkets(),void 0!==t&&(i=this.market(t));const a={ids:r},n=await this.privateGetOrders(this.extend(a,s)),o=this.safeValue(n,"data"),c=o.length;if(void 0===o)throw new h(this.id+" could not found matching order");if(Array.isArray(e))return this.parseOrders(o,i);if(0===c)throw new h(this.id+" could not found matching order");return this.parseOrder(o[0],i)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({states:["wait"]},i))}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({states:["done","cancel"]},i))}async fetchOrders(e,t,s,i={}){if(void 0===e)throw new n(this.id+" fetchOrders() requires a `symbol` argument");await this.loadMarkets();const r=this.market(e),a=this.safeValue(i,"states",["wait","done","cancel"]),o=this.omit(i,"states"),c={market:r.id,states:a,need_price:"True"};void 0!==s&&(c.limit=s);const d=await this.privateGetOrdersFilter(this.extend(c,o)),h=this.safeValue(d,"data",[]);let u=[];for(let e=0;e<h.length;e++){const i=this.safeValue(h[e],"orders",[]),a=this.parseOrderStatus(this.safeValue(h[e],"state")),n=this.parseOrders(i,r,t,s,{status:a});u=this.arrayConcat(u,n)}return u}parseOrder(e,t){const s=this.parseOrderStatus(this.safeValue(e,"state")),i=this.safeString2(e,"market","market_id"),r=this.safeSymbol(i,t);let a=this.safeTimestamp(e,"created_on");return void 0===a&&(a=this.parse8601(this.safeString(e,"created_at"))),this.safeOrder({info:e,id:this.safeString(e,"id"),clientOrderId:void 0,timestamp:a,datetime:this.iso8601(a),lastTradeTimestamp:void 0,symbol:r,type:this.safeValue(e,"ord_type"),timeInForce:void 0,postOnly:void 0,side:this.safeValue(e,"side"),price:this.safeNumber(e,"price"),stopPrice:void 0,average:this.safeNumber(e,"avg_price"),amount:this.safeNumber(e,"volume"),remaining:this.safeNumber(e,"remaining_volume"),filled:this.safeNumber(e,"executed_volume"),status:s,cost:void 0,trades:void 0,fee:void 0})}parseOrderStatus(e){return this.safeString({wait:"open",done:"closed",cancel:"canceled"},e,e)}async createOrders(e,t,s={}){await this.loadMarkets();const i={market:this.market(e).id,orders:t},r=(await this.privatePostOrdersMulti(this.extend(i,s))).data;return this.parseOrders(r)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i=await this.privatePostOrderDelete(this.extend({id:e},s)),r=this.safeValue(i,"data");return this.parseOrder(r)}async cancelOrders(e,t,s={}){await this.loadMarkets();const i=await this.privatePostOrderDeleteMulti(this.extend({ids:e},s)),r=this.safeValue(i,"data");return this.parseOrders(r)}async cancelAllOrders(e,t={}){await this.loadMarkets();const s=await this.privatePostOrdersClear(t),i=this.safeValue(s,"data");return this.parseOrders(i)}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api+"/"+this.version+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if("public"===t)if("tickers_multi"===e||"order_book/multi"===e){let e="?";const t=this.safeValue(i,"markets");for(let s=0;s<t.length;s++)e+="markets[]="+t[s]+"&";const s=this.safeValue(i,"limit");void 0!==s&&(e+="limit="+s),n+=e}else Object.keys(o).length&&(n+="?"+this.urlencode(o));else if("private"===t){this.checkRequiredCredentials();const e={uid:this.apiKey,data:o};n+="?user_jwt="+this.jwt(e,this.encode(this.secret),"RS256")}return{url:n,method:s,body:a,headers:{"Content-Type":"application/json"}}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0===o)return;const h=this.safeString(o,"code"),u=this.safeString(o,"message");if(void 0!==h&&"0"!==h){const e=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.codes,h,e),this.throwExactlyMatchedException(this.exceptions.exact,u,e),new r(e)}}}},1384:(e,t,s)=>{"use strict";const i=s(8579);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"okcoin",name:"OKCoin",countries:["CN","US"],hostname:"okcoin.com",pro:!0,urls:{logo:"https://user-images.githubusercontent.com/51840849/87295551-102fbf00-c50e-11ea-90a9-462eebba5829.jpg",www:"https://www.okcoin.com",doc:"https://www.okcoin.com/docs/en/",fees:"https://www.okcoin.com/coin-fees",referral:"https://www.okcoin.com/account/register?flag=activity&channelId=600001513"},fees:{trading:{taker:.002,maker:.001}},options:{fetchMarkets:["spot"]}})}}},8579:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ExchangeNotAvailable:a,OnMaintenance:n,ArgumentsRequired:o,BadRequest:c,AccountSuspended:d,InvalidAddress:h,PermissionDenied:u,DDoSProtection:l,InsufficientFunds:f,InvalidNonce:p,CancelPending:m,InvalidOrder:b,OrderNotFound:g,AuthenticationError:y,RequestTimeout:v,NotSupported:w,BadSymbol:k,RateLimitExceeded:S}=s(3449),{TICK_SIZE:_,TRUNCATE:O}=s(2115),T=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"okex",name:"OKEX",countries:["CN"],version:"v3",rateLimit:1e3,pro:!0,has:{cancelOrder:!0,CORS:!1,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchCurrencies:!1,fetchDepositAddress:!0,fetchDeposits:!0,fetchLedger:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!1,fetchOrderTrades:!0,fetchTime:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTransactions:!1,fetchWithdrawals:!0,futures:!0,withdraw:!0},timeframes:{"1m":"60","3m":"180","5m":"300","15m":"900","30m":"1800","1h":"3600","2h":"7200","4h":"14400","6h":"21600","12h":"43200","1d":"86400","1w":"604800","1M":"2678400","3M":"8035200","6M":"16070400","1y":"31536000"},hostname:"okex.com",urls:{logo:"https://user-images.githubusercontent.com/1294454/32552768-0d6dd3c6-c4a6-11e7-90f8-c043b64756a7.jpg",api:{rest:"https://www.{hostname}"},www:"https://www.okex.com",doc:"https://www.okex.com/docs/en/",fees:"https://www.okex.com/pages/products/fees.html",referral:"https://www.okex.com/join/1888677",test:{rest:"https://testnet.okex.com"}},api:{general:{get:["time"]},account:{get:["wallet","sub-account","asset-valuation","wallet/{currency}","withdrawal/history","withdrawal/history/{currency}","ledger","deposit/address","deposit/history","deposit/history/{currency}","currencies","withdrawal/fee"],post:["transfer","withdrawal"]},spot:{get:["accounts","accounts/{currency}","accounts/{currency}/ledger","orders","amend_order/{instrument_id}","orders_pending","orders/{order_id}","orders/{client_oid}","trade_fee","fills","algo","instruments","instruments/{instrument_id}/book","instruments/ticker","instruments/{instrument_id}/ticker","instruments/{instrument_id}/trades","instruments/{instrument_id}/candles","instruments/{instrument_id}/history/candles"],post:["order_algo","orders","batch_orders","cancel_orders/{order_id}","cancel_orders/{client_oid}","cancel_batch_algos","cancel_batch_orders"]},margin:{get:["accounts","accounts/{instrument_id}","accounts/{instrument_id}/ledger","accounts/availability","accounts/{instrument_id}/availability","accounts/borrowed","accounts/{instrument_id}/borrowed","orders","accounts/{instrument_id}/leverage","orders/{order_id}","orders/{client_oid}","orders_pending","fills","instruments/{instrument_id}/mark_price"],post:["accounts/borrow","accounts/repayment","orders","batch_orders","cancel_orders","cancel_orders/{order_id}","cancel_orders/{client_oid}","cancel_batch_orders","accounts/{instrument_id}/leverage"]},futures:{get:["position","{instrument_id}/position","accounts","accounts/{underlying}","accounts/{underlying}/leverage","accounts/{underlying}/ledger","order_algo/{instrument_id}","orders/{instrument_id}","orders/{instrument_id}/{order_id}","orders/{instrument_id}/{client_oid}","fills","trade_fee","accounts/{instrument_id}/holds","order_algo/{instrument_id}","instruments","instruments/{instrument_id}/book","instruments/ticker","instruments/{instrument_id}/ticker","instruments/{instrument_id}/trades","instruments/{instrument_id}/candles","instruments/{instrument_id}/history/candles","instruments/{instrument_id}/index","rate","instruments/{instrument_id}/estimated_price","instruments/{instrument_id}/open_interest","instruments/{instrument_id}/price_limit","instruments/{instrument_id}/mark_price","instruments/{instrument_id}/liquidation"],post:["accounts/{underlying}/leverage","order","amend_order/{instrument_id}","orders","cancel_order/{instrument_id}/{order_id}","cancel_order/{instrument_id}/{client_oid}","cancel_batch_orders/{instrument_id}","accounts/margin_mode","close_position","cancel_all","order_algo","cancel_algos"]},swap:{get:["position","{instrument_id}/position","accounts","{instrument_id}/accounts","accounts/{instrument_id}/settings","accounts/{instrument_id}/ledger","orders/{instrument_id}","orders/{instrument_id}/{order_id}","orders/{instrument_id}/{client_oid}","fills","accounts/{instrument_id}/holds","trade_fee","order_algo/{instrument_id}","instruments","instruments/{instrument_id}/depth","instruments/ticker","instruments/{instrument_id}/ticker","instruments/{instrument_id}/trades","instruments/{instrument_id}/candles","instruments/{instrument_id}/history/candles","instruments/{instrument_id}/index","rate","instruments/{instrument_id}/open_interest","instruments/{instrument_id}/price_limit","instruments/{instrument_id}/liquidation","instruments/{instrument_id}/funding_time","instruments/{instrument_id}/mark_price","instruments/{instrument_id}/historical_funding_rate"],post:["accounts/{instrument_id}/leverage","order","amend_order/{instrument_id}","orders","cancel_order/{instrument_id}/{order_id}","cancel_order/{instrument_id}/{client_oid}","cancel_batch_orders/{instrument_id}","order_algo","cancel_algos","close_position","cancel_all","order_algo","cancel_algos"]},option:{get:["accounts","position","{underlying}/position","accounts/{underlying}","orders/{underlying}","fills/{underlying}","accounts/{underlying}/ledger","trade_fee","orders/{underlying}/{order_id}","orders/{underlying}/{client_oid}","underlying","instruments/{underlying}","instruments/{underlying}/summary","instruments/{underlying}/summary/{instrument_id}","instruments/{instrument_id}/book","instruments/{instrument_id}/trades","instruments/{instrument_id}/ticker","instruments/{instrument_id}/candles"],post:["order","orders","cancel_order/{underlying}/{order_id}","cancel_order/{underlying}/{client_oid}","cancel_batch_orders/{underlying}","amend_order/{underlying}","amend_batch_orders/{underlying}"]},index:{get:["{instrument_id}/constituents"]}},fees:{trading:{taker:.0015,maker:.001},spot:{taker:.0015,maker:.001},futures:{taker:5e-4,maker:2e-4},swap:{taker:75e-5,maker:2e-4}},requiredCredentials:{apiKey:!0,secret:!0,password:!0},exceptions:{exact:{1:r,"failure to get a peer from the ring-balancer":a,"Server is busy, please try again.":a,"An unexpected error occurred":r,"System error":r,4010:u,4001:r,4002:r,30001:y,30002:y,30003:y,30004:y,30005:p,30006:y,30007:c,30008:v,30009:r,30010:y,30011:u,30012:y,30013:y,30014:l,30015:y,30016:r,30017:r,30018:r,30019:a,30020:c,30021:c,30022:u,30023:c,30024:k,30025:c,30026:l,30027:y,30028:u,30029:d,30030:a,30031:c,30032:k,30033:c,30034:r,30035:r,30036:r,30037:a,30038:n,30044:v,32001:d,32002:u,32003:m,32004:r,32005:b,32006:b,32007:b,32008:b,32009:b,32010:r,32011:r,32012:r,32013:r,32014:r,32015:r,32016:r,32017:r,32018:r,32019:r,32020:r,32021:r,32022:r,32023:r,32024:r,32025:r,32026:r,32027:r,32028:r,32029:r,32030:b,32031:o,32038:y,32040:r,32044:r,32045:r,32046:r,32047:r,32048:b,32049:r,32050:b,32051:b,32052:r,32053:r,32057:r,32054:r,32055:b,32056:r,32058:r,32059:b,32060:b,32061:b,32062:b,32063:b,32064:r,32065:r,32066:r,32067:r,32068:r,32069:r,32070:r,32071:r,32072:r,32073:r,32074:r,32075:r,32076:r,32077:r,32078:r,32079:r,32080:r,32083:r,33001:u,33002:d,33003:f,33004:r,33005:r,33006:r,33007:r,33008:f,33009:r,33010:r,33011:r,33012:r,33013:b,33014:g,33015:b,33016:r,33017:f,33018:r,33020:r,33021:c,33022:b,33023:r,33024:b,33025:b,33026:r,33027:b,33028:b,33029:b,33034:r,33035:r,33036:r,33037:r,33038:r,33039:r,33040:r,33041:r,33042:r,33043:r,33044:r,33045:r,33046:r,33047:r,33048:r,33049:r,33050:r,33051:r,33059:c,33060:c,33061:r,33062:r,33063:r,33064:r,33065:r,33085:b,21009:r,34001:u,34002:h,34003:r,34004:r,34005:r,34006:r,34007:r,34008:f,34009:r,34010:r,34011:r,34012:r,34013:r,34014:r,34015:r,34016:u,34017:d,34018:y,34019:u,34020:u,34021:h,34022:r,34023:u,34026:S,34036:r,34037:r,34038:r,34039:r,35001:r,35002:r,35003:r,35004:r,35005:y,35008:b,35010:b,35012:b,35014:b,35015:b,35017:r,35019:b,35020:b,35021:b,35022:c,35024:c,35025:f,35026:c,35029:g,35030:b,35031:b,35032:r,35037:r,35039:f,35040:b,35044:r,35046:f,35047:f,35048:r,35049:b,35050:b,35052:f,35053:r,35055:f,35057:r,35058:r,35059:c,35060:c,35061:c,35062:b,35063:b,35064:b,35066:b,35067:b,35068:b,35069:b,35070:b,35071:b,35072:b,35073:b,35074:b,35075:b,35076:b,35077:b,35078:b,35079:b,35080:b,35081:b,35082:b,35083:b,35084:b,35085:b,35086:b,35087:b,35088:b,35089:b,35090:r,35091:r,35092:r,35093:r,35094:r,35095:c,35096:r,35097:r,35098:r,35099:r,35102:S,36001:c,36002:c,36005:r,36101:y,36102:u,36103:u,36104:u,36105:u,36106:u,36107:u,36108:f,36109:u,36201:u,36202:u,36203:b,36204:r,36205:c,36206:c,36207:b,36208:b,36209:b,36210:b,36211:b,36212:b,36213:b,36214:r,36216:g,36217:b,36218:b,36219:b,36220:b,36221:b,36222:b,36223:b,36224:b,36225:b,36226:b,36227:b,36228:b,36229:b,36230:b},broad:{}},precisionMode:_,options:{fetchOHLCV:{type:"Candles"},createMarketBuyOrderRequiresPrice:!0,fetchMarkets:["spot","futures","swap","option"],defaultType:"spot",auth:{time:"public",currencies:"private",instruments:"public",rate:"public","{instrument_id}/constituents":"public"}},commonCurrencies:{AE:"AET",BOX:"DefiBox",HOT:"Hydro Protocol",HSR:"HC",MAG:"Maggie",SBTC:"Super Bitcoin",YOYO:"YOYOW",WIN:"WinToken"}})}async fetchTime(e={}){const t=await this.generalGetTime(e);return this.parse8601(this.safeString(t,"iso"))}async fetchMarkets(e={}){const t=this.safeValue(this.options,"fetchMarkets");let s=[];for(let i=0;i<t.length;i++){const r=await this.fetchMarketsByType(t[i],e);s=this.arrayConcat(s,r)}return s}parseMarkets(e){const t=[];for(let s=0;s<e.length;s++)t.push(this.parseMarket(e[s]));return t}parseMarket(e){const t=this.safeString(e,"instrument_id");let s="spot",i=!0,r=!1,a=!1,n=!1,o=this.safeString(e,"base_currency"),c=this.safeString(e,"quote_currency");if(void 0!==this.safeNumber(e,"contract_val"))if("option_type"in e){s="option",i=!1,n=!0;const t=this.safeString(e,"underlying").split("-");o=this.safeString(t,0),c=this.safeString(t,1)}else{s="swap",i=!1,a=!0;void 0!==this.safeString(e,"alias")&&(a=!1,r=!0,s="futures",o=this.safeString(e,"underlying_index"))}const d=this.safeCurrencyCode(o),h=this.safeCurrencyCode(c),u=i?d+"/"+h:t,l=this.safeNumber2(e,"lot_size","trade_increment"),f=this.safeString(e,"tick_size"),p={amount:this.safeNumber(e,"size_increment",l),price:this.parseNumber(f)},m=this.safeString2(e,"min_size","base_min_size"),b=this.parseNumber(m);let g;void 0!==b&&void 0!==f&&(g=this.parseNumber(T.stringMul(f,m)));const y=this.safeValue2(this.fees,s,"trading",{});return this.extend(y,{id:t,symbol:u,base:d,quote:h,baseId:o,quoteId:c,info:e,type:s,spot:i,futures:r,swap:a,option:n,active:!0,precision:p,limits:{amount:{min:b,max:void 0},price:{min:p.price,max:void 0},cost:{min:g,max:void 0}}})}async fetchMarketsByType(e,t={}){if("option"===e){const e=await this.optionGetUnderlying(t);let s=[];for(let t=0;t<e.length;t++){const i=await this.optionGetInstrumentsUnderlying({underlying:e[t]});s=this.arrayConcat(s,i)}return this.parseMarkets(s)}if("spot"===e||"futures"===e||"swap"===e){const s=e+"GetInstruments",i=await this[s](t);return this.parseMarkets(i)}throw new w(this.id+" fetchMarketsByType does not support market type "+e)}async fetchCurrencies(e={}){const t=await this.accountGetCurrencies(e),s={};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"currency"),a=this.safeCurrencyCode(r),n=1e-8,o=this.safeString(i,"name"),c=this.safeInteger(i,"can_deposit"),d=this.safeInteger(i,"can_withdraw"),h=!(!c||!d);s[a]={id:r,code:a,info:i,type:void 0,name:o,active:h,fee:void 0,precision:n,limits:{amount:{min:void 0,max:void 0},withdraw:{min:this.safeNumber(i,"min_withdrawal"),max:void 0}}}}return s}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e);let r=i.type+"GetInstrumentsInstrumentId";r+="swap"===i.type?"Depth":"Book";const a={instrument_id:i.id};void 0!==t&&(a.size=t);const n=await this[r](this.extend(a,s)),o=this.parse8601(this.safeString2(n,"timestamp","time"));return this.parseOrderBook(n,e,o)}parseTicker(e,t){const s=this.parse8601(this.safeString(e,"timestamp"));let i;const r=this.safeString(e,"instrument_id");if(r in this.markets_by_id)i=(t=this.markets_by_id[r]).symbol;else if(void 0!==r){const e=r.split("-");if(2===e.length){const[t,s]=e;i=this.safeCurrencyCode(t)+"/"+this.safeCurrencyCode(s)}else i=r}void 0===i&&void 0!==t&&(i=t.symbol);const a=this.safeNumber(e,"last"),n=this.safeNumber(e,"open_24h");return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high_24h"),low:this.safeNumber(e,"low_24h"),bid:this.safeNumber(e,"best_bid"),bidVolume:this.safeNumber(e,"best_bid_size"),ask:this.safeNumber(e,"best_ask"),askVolume:this.safeNumber(e,"best_ask_size"),vwap:void 0,open:n,close:a,last:a,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(e,"base_volume_24h"),quoteVolume:this.safeNumber(e,"quote_volume_24h"),info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i=s.type+"GetInstrumentsInstrumentIdTicker",r={instrument_id:s.id},a=await this[i](this.extend(r,t));return this.parseTicker(a)}async fetchTickersByType(e,t,s={}){await this.loadMarkets();const i=e+"GetInstrumentsTicker",r=await this[i](s),a={};for(let e=0;e<r.length;e++){const t=this.parseTicker(r[e]);a[t.symbol]=t}return this.filterByArray(a,"symbol",t)}async fetchTickers(e,t={}){const s=this.safeString2(this.options,"fetchTickers","defaultType"),i=this.safeString(t,"type",s);return await this.fetchTickersByType(i,e,this.omit(t,"type"))}parseTrade(e,t){let s;const i=this.safeString(e,"instrument_id");let r,a;if(i in this.markets_by_id)s=(t=this.markets_by_id[i]).symbol,r=t.base,a=t.quote;else if(void 0!==i){const e=i.split("-");if(2===e.length){const[t,i]=e;r=this.safeCurrencyCode(t),a=this.safeCurrencyCode(i),s=r+"/"+a}else s=i}void 0===s&&void 0!==t&&(s=t.symbol,r=t.base,a=t.quote);const n=this.parse8601(this.safeString2(e,"timestamp","created_at")),o=this.safeString(e,"price");let c=this.safeString2(e,"size","qty");c=this.safeString(e,"order_qty",c);const d=this.parseNumber(o),h=this.parseNumber(c),u=this.parseNumber(T.stringMul(o,c));let l=this.safeString2(e,"exec_type","liquidity");"M"===l?l="maker":"T"===l&&(l="taker");const f=this.safeString(e,"side"),p=this.safeNumber(e,"fee");let m;if(void 0!==p){m={cost:-p,currency:"buy"===f?r:a}}const b=this.safeString(e,"order_id");return{info:e,timestamp:n,datetime:this.iso8601(n),symbol:s,id:this.safeString2(e,"trade_id","ledger_id"),order:b,type:void 0,takerOrMaker:l,side:f,price:d,amount:h,cost:u,fee:m}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a=r.type+"GetInstrumentsInstrumentIdTrades";(void 0===s||s>100)&&(s=100);const n={instrument_id:r.id,limit:s},o=await this[a](this.extend(n,i));return this.parseTrades(o,r,t,s)}parseOHLCV(e,t){if(Array.isArray(e)){const t=e.length>6?6:5;let s=this.safeValue(e,0);return"string"==typeof s&&(s=this.parse8601(s)),[s,this.safeNumber(e,1),this.safeNumber(e,2),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,t)]}return[this.parse8601(this.safeString(e,"time")),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n=this.parseTimeframe(t),o={instrument_id:a.id,granularity:this.timeframes[t]},c=this.safeValue(this.options,"fetchOHLCV",{}),d=this.safeString(c,"type","Candles"),h=this.safeString(r,"type",d);r=this.omit(r,"type");const u=a.type+"GetInstrumentsInstrumentId"+h;if("Candles"===h){if(void 0!==s)void 0!==i&&(o.end=this.iso8601(this.sum(s,i*n*1e3))),o.start=this.iso8601(s);else if(void 0!==i){const e=this.milliseconds();o.start=this.iso8601(e-i*n*1e3),o.end=this.iso8601(e)}}else if("HistoryCandles"===h){if(a.option)throw new w(this.id+" fetchOHLCV does not have "+h+" for "+a.type+" markets");if(void 0!==s)void 0===i&&(i=300),o.start=this.iso8601(this.sum(s,i*n*1e3)),o.end=this.iso8601(s);else if(void 0!==i){const e=this.milliseconds();o.end=this.iso8601(e-i*n*1e3),o.start=this.iso8601(e)}}const l=await this[u](this.extend(o,r));return this.parseOHLCVs(l,a,t,s,i)}parseAccountBalance(e){const t={info:e,timestamp:void 0,datetime:void 0};for(let s=0;s<e.length;s++){const i=e[s],r=this.safeString(i,"currency"),a=this.safeCurrencyCode(r),n=this.account();n.total=this.safeNumber(i,"balance"),n.used=this.safeNumber(i,"hold"),n.free=this.safeNumber(i,"available"),t[a]=n}return this.parseBalance(t)}parseMarginBalance(e){const t={info:e,timestamp:void 0,datetime:void 0};for(let s=0;s<e.length;s++){const i=e[s],r=this.safeString(i,"instrument_id"),a=this.safeValue(this.markets_by_id,r);let n;if(void 0===a){const[e,t]=r.split("-");n=this.safeCurrencyCode(e)+"/"+this.safeCurrencyCode(t)}else n=a.symbol;const o=this.omit(i,["instrument_id","liquidation_price","product_id","risk_rate","margin_ratio","maint_margin_ratio","tiers"]),c=Object.keys(o),d={};for(let e=0;e<c.length;e++){const t=c[e],s=i[t];if(!(t.indexOf(":")>=0))throw new w(this.id+" margin balance response format has changed!");{const e=t.split(":")[1],i=this.safeCurrencyCode(e),r=this.account();r.total=this.safeNumber(s,"balance"),r.used=this.safeNumber(s,"hold"),r.free=this.safeNumber(s,"available"),d[i]=r}}t[n]=this.parseBalance(d)}return t}parseFuturesBalance(e){const t={info:e,timestamp:void 0,datetime:void 0},s=this.safeValue(e,"info",{}),i=Object.keys(s);for(let e=0;e<i.length;e++){const r=i[e],a=this.safeCurrencyCode(r),n=this.safeValue(s,r,{}),o=this.account(),c=this.safeNumber(n,"total_avail_balance");if("fixed"===this.safeString(n,"margin_mode")){const e=this.safeValue(n,"contracts",[]);let t=c;for(let s=0;s<e.length;s++){const i=e[s],r=this.safeNumber(i,"fixed_balance"),a=this.safeNumber(i,"realized_pnl"),n=this.safeNumber(i,"margin_frozen"),o=this.safeNumber(i,"margin_for_unfilled"),c=this.sum(r,a)-n-o;t=this.sum(t,c)}o.free=t}else{const e=this.safeNumber(n,"realized_pnl"),t=this.safeNumber(n,"unrealized_pnl"),s=this.safeNumber(n,"margin_frozen"),i=this.safeNumber(n,"margin_for_unfilled");o.free=this.sum(c,e,t)-s-i}o.total=this.safeNumber(n,"equity"),t[a]=o}return this.parseBalance(t)}parseSwapBalance(e){const t={info:e};let s;const i=this.safeValue(e,"info",[]);for(let e=0;e<i.length;e++){const r=i[e],a=this.safeString(r,"instrument_id");let n=a;a in this.markets_by_id&&(n=this.markets_by_id[a].symbol);const o=this.parse8601(this.safeString(r,"timestamp"));s=void 0===s?o:Math.max(s,o);const c=this.account();c.total=this.safeNumber(r,"equity"),c.free=this.safeNumber(r,"total_avail_balance"),t[n]=c}return t.timestamp=s,t.datetime=this.iso8601(s),this.parseBalance(t)}async fetchBalance(e={}){const t=this.safeString2(this.options,"fetchBalance","defaultType"),s=this.safeString(e,"type",t);if(void 0===s)throw new o(this.id+" fetchBalance() requires a type parameter (one of 'account', 'spot', 'margin', 'futures', 'swap')");await this.loadMarkets();const i=s+"Get"+("account"===s?"Wallet":"Accounts"),r=this.omit(e,"type"),a=await this[i](r);return this.parseBalanceByType(s,a)}parseBalanceByType(e,t){if("account"===e||"spot"===e)return this.parseAccountBalance(t);if("margin"===e)return this.parseMarginBalance(t);if("futures"===e)return this.parseFuturesBalance(t);if("swap"===e)return this.parseSwapBalance(t);throw new w(this.id+" fetchBalance does not support the '"+e+"' type (the type must be one of 'account', 'spot', 'margin', 'futures', 'swap')")}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e);let o={instrument_id:n.id};const c=this.safeString2(a,"client_oid","clientOrderId");let d;if(void 0!==c&&(o.client_oid=c,a=this.omit(a,["client_oid","clientOrderId"])),n.futures||n.swap){const s=n.futures?this.numberToString(i):this.amountToPrecision(e,i);o=this.extend(o,{type:t,size:s});const c=this.safeString(a,"order_type");"market"===t||"4"===c?o.order_type="4":o.price=this.priceToPrecision(e,r),n.futures&&(o.leverage="10"),d=n.type+"PostOrder"}else{const c=this.safeString(a,"margin_trading","1");if(o=this.extend(o,{side:s,type:t,margin_trading:c}),"limit"===t)o.price=this.priceToPrecision(e,r),o.size=this.amountToPrecision(e,i);else if("market"===t)if("buy"===s){let e=this.safeNumber(a,"notional");if(this.safeValue(this.options,"createMarketBuyOrderRequiresPrice",!0)){if(void 0!==r)void 0===e&&(e=i*r);else if(void 0===e)throw new b(this.id+" createOrder() requires the price argument with market buy orders to calculate total order cost (amount to spend), where cost = amount * price. Supply a price argument to createOrder() call if you want the cost to be calculated for you from price and amount, or, alternatively, add .options['createMarketBuyOrderRequiresPrice'] = false and supply the total cost value in the 'amount' argument or in the 'notional' extra parameter (the exchange-specific behaviour)")}else e=void 0===e?i:e;const t=n.precision.price;o.notional=this.decimalToPrecision(e,O,t,this.precisionMode)}else o.size=this.amountToPrecision(e,i);d="2"===c?"marginPostOrders":"spotPostOrders"}const h=await this[d](this.extend(o,a)),u=this.parseOrder(h,n);return this.extend(u,{type:t,side:s})}async cancelOrder(e,t,s={}){if(void 0===t)throw new o(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t);let r;if(i.futures||i.swap)r=i.type;else{const e=this.safeString2(this.options,"cancelOrder","defaultType",i.type);r=this.safeString(s,"type",e)}if(void 0===r)throw new o(this.id+" cancelOrder() requires a type parameter (one of 'spot', 'margin', 'futures', 'swap').");let a=r+"PostCancelOrder";const n={instrument_id:i.id};i.futures||i.swap?a+="InstrumentId":a+="s";const c=this.safeString2(s,"client_oid","clientOrderId");void 0!==c?(a+="ClientOid",n.client_oid=c):(a+="OrderId",n.order_id=e);const d=this.omit(s,["type","client_oid","clientOrderId"]),h=await this[a](this.extend(n,d)),u="result"in h?h:this.safeValue(h,i.id,{});return this.parseOrder(u,i)}parseOrderStatus(e){return this.safeString({"-2":"failed","-1":"canceled",0:"open",1:"open",2:"closed",3:"open",4:"canceled"},e,e)}parseOrderSide(e){return this.safeString({1:"buy",2:"sell",3:"sell",4:"buy"},e,e)}parseOrder(e,t){const s=this.safeString(e,"order_id"),i=this.parse8601(this.safeString(e,"timestamp"));let r=this.safeString(e,"side");const a=this.safeString(e,"type");let n;"buy"!==r&&"sell"!==r&&(r=this.parseOrderSide(a));const o=this.safeString(e,"instrument_id");n=o in this.markets_by_id?(t=this.markets_by_id[o]).symbol:o,void 0!==t&&void 0===n&&(n=t.symbol);let c=this.safeNumber(e,"size");const d=this.safeNumber2(e,"filled_size","filled_qty");let h;void 0!==c&&void 0!==d&&(c=Math.max(c,d),h=Math.max(0,c-d)),"market"===a&&(h=0);let u=this.safeNumber2(e,"filled_notional","funds");const l=this.safeNumber(e,"price");let f=this.safeNumber(e,"price_avg");void 0===u?void 0!==d&&void 0!==f&&(u=f*d):void 0===f&&void 0!==d&&d>0&&(f=u/d);const p=this.parseOrderStatus(this.safeString(e,"state")),m=this.safeNumber(e,"fee");let b;if(void 0!==m){b={cost:m,currency:void 0}}let g=this.safeString(e,"client_oid");void 0!==g&&g.length<1&&(g=void 0);const y=this.safeNumber(e,"trigger_price");return{info:e,id:s,clientOrderId:g,timestamp:i,datetime:this.iso8601(i),lastTradeTimestamp:void 0,symbol:n,type:a,timeInForce:void 0,postOnly:void 0,side:r,price:l,stopPrice:y,average:f,cost:u,amount:c,filled:d,remaining:h,status:p,fee:b,trades:void 0}}async fetchOrder(e,t,s={}){if(void 0===t)throw new o(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r=this.safeString2(this.options,"fetchOrder","defaultType",i.type),a=this.safeString(s,"type",r);if(void 0===a)throw new o(this.id+" fetchOrder() requires a type parameter (one of 'spot', 'margin', 'futures', 'swap').");let n=a+"GetOrders"+(i.futures||i.swap?"InstrumentId":"");const c={instrument_id:i.id},d=this.safeString(s,"client_oid");void 0!==d?(n+="ClientOid",c.client_oid=d):(n+="OrderId",c.order_id=e);const h=this.omit(s,"type"),u=await this[n](this.extend(c,h));return this.parseOrder(u)}async fetchOrdersByState(e,t,s,i,r={}){if(void 0===t)throw new o(this.id+" fetchOrdersByState() requires a symbol argument");await this.loadMarkets();const a=this.market(t);let n;if(a.futures||a.swap)n=a.type;else{const e=this.safeString2(this.options,"fetchOrder","defaultType",a.type);n=this.safeString(r,"type",e)}if(void 0===n)throw new o(this.id+" fetchOrdersByState() requires a type parameter (one of 'spot', 'margin', 'futures', 'swap').");const c={instrument_id:a.id,state:e};let d=n+"GetOrders";(a.futures||a.swap)&&(d+="InstrumentId");const h=this.omit(r,"type"),u=await this[d](this.extend(c,h));let l;if(a.swap||a.futures)l=this.safeValue(u,"order_info",[]);else{l=u;const e=u.length;if(e<1)return[];if(e>1){void 0!==this.safeValue(u[1],"before")&&(l=u[0])}}return this.parseOrders(l,a,s,i)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrdersByState("6",e,t,s,i)}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrdersByState("7",e,t,s,i)}parseDepositAddress(e,t){const s=this.safeString(e,"address");let i=this.safeString2(e,"tag","payment_id");i=this.safeString2(e,"memo","Memo",i);const r=this.safeString(e,"currency"),a=this.safeCurrencyCode(r);return this.checkAddress(s),{currency:a,address:s,tag:i,info:e}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=e.split("-"),i={currency:this.currency(s[0]).id},r=await this.accountGetDepositAddress(this.extend(i,t)),a=this.parseDepositAddresses(r),n=this.safeValue(a,e);if(void 0===n)throw new h(this.id+" fetchDepositAddress cannot return nonexistent addresses, you should create withdrawal addresses with the exchange website first");return n}async withdraw(e,t,s,i,a={}){this.checkAddress(s),await this.loadMarkets();const n=this.currency(e);i&&(s=s+":"+i);const c=this.safeString(a,"fee");if(void 0===c)throw new o(this.id+" withdraw() requires a `fee` string parameter, network transaction fee must be ≥ 0. Withdrawals to OKCoin or OKEx are fee-free, please set '0'. Withdrawing to external digital asset address requires network transaction fee.");const d={currency:n.id,to_address:s,destination:"4",amount:this.numberToString(t),fee:c};"password"in a?d.trade_pwd=a.password:"trade_pwd"in a?d.trade_pwd=a.trade_pwd:this.password&&(d.trade_pwd=this.password);const h=this.omit(a,["fee","password","trade_pwd"]);if(!("trade_pwd"in d))throw new r(this.id+" withdraw() requires this.password set on the exchange instance or a password / trade_pwd parameter");const u=await this.accountPostWithdrawal(this.extend(d,h));return{info:u,id:this.safeString(u,"withdrawal_id")}}async fetchDeposits(e,t,s,i={}){await this.loadMarkets();const r={};let a,n="accountGetDepositHistory";void 0!==e&&(a=this.currency(e),r.currency=a.id,n+="Currency");const o=await this[n](this.extend(r,i));return this.parseTransactions(o,a,t,s,i)}async fetchWithdrawals(e,t,s,i={}){await this.loadMarkets();const r={};let a,n="accountGetWithdrawalHistory";void 0!==e&&(a=this.currency(e),r.currency=a.id,n+="Currency");const o=await this[n](this.extend(r,i));return this.parseTransactions(o,a,t,s,i)}parseTransactionStatus(e){return this.safeString({"-3":"pending","-2":"canceled","-1":"failed",0:"pending",1:"pending",2:"ok",3:"pending",4:"pending",5:"pending"},e,e)}parseTransaction(e,t){let s,i,r;const a=this.safeString(e,"withdrawal_id"),n=this.safeString(e,"from"),o=this.safeString(e,"to"),c=this.safeString(e,"tag");void 0!==a?(s="withdrawal",i=a,r=o):(i=this.safeString2(e,"payment_id","deposit_id"),s="deposit",r=o);const d=this.safeString(e,"currency"),h=this.safeCurrencyCode(d),u=this.safeNumber(e,"amount"),l=this.parseTransactionStatus(this.safeString(e,"status")),f=this.safeString(e,"txid"),p=this.parse8601(this.safeString(e,"timestamp"));let m;if("deposit"===s)m=0;else if(void 0!==d){const t=this.safeString(e,"fee");if(void 0!==t){const e=d.toLowerCase(),s=t.replace(e,"");m=parseFloat(s)}}return{info:e,id:i,currency:h,amount:u,addressFrom:n,addressTo:o,address:r,tagFrom:void 0,tagTo:c,tag:c,status:l,type:s,updated:void 0,txid:f,timestamp:p,datetime:this.iso8601(p),fee:{currency:h,cost:m}}}parseMyTrade(e,t){const s=this.safeValue(e,1),i=this.safeValue(e,0),r=this.safeString(i,"instrument_id");if(r!==this.safeString(s,"instrument_id"))throw new w(this.id+" parseMyTrade() received unrecognized response format, differing instrument_ids in one fill, the exchange API might have changed, paste your verbose output: https://github.com/ccxt/ccxt/wiki/FAQ#what-is-required-to-get-help");const a=r,n=(t=this.safeMarket(a,t)).symbol,o=t.quoteId;let c,d,h;let u;this.safeString(s,"currency")===o?(c=this.safeString(i,"side"),d=this.safeNumber(i,"size"),h=this.safeNumber(s,"size"),u=this.safeString(i,"currency")):(c=this.safeString(s,"side"),d=this.safeNumber(s,"size"),h=this.safeNumber(i,"size"),u=this.safeString(s,"currency"));const l=this.safeString(s,"trade_id"),f=this.safeNumber(s,"price"),p=this.safeNumber(i,"fee"),m=this.safeNumber(s,"fee"),b=this.safeCurrencyCode(this.safeString(i,"currency")),g=this.safeCurrencyCode(this.safeString(s,"currency"));let y,v;void 0!==p&&0!==p?void 0!==m&&0!==m?v=[{cost:-p,currency:b},{cost:-m,currency:g}]:y={cost:-p,currency:b}:y=void 0!==m&&0!==m?{cost:-m,currency:g}:{cost:0,currency:this.safeCurrencyCode(u)};const k=this.parse8601(this.safeString2(s,"timestamp","created_at"));let S=this.safeString2(s,"exec_type","liquidity");"M"===S?S="maker":"T"===S&&(S="taker");const _=this.safeString(s,"order_id"),O={info:e,timestamp:k,datetime:this.iso8601(k),symbol:n,id:l,order:_,type:void 0,takerOrMaker:S,side:c,price:f,amount:d,cost:h,fee:y};return void 0!==v&&(O.fees=v),O}parseMyTrades(e,t,s,i,r={}){const a=this.groupBy(e,"trade_id"),n=Object.keys(a),o=[];for(let e=0;e<n.length;e++){const t=a[n[e]];if(2===t.length){const e=this.parseMyTrade(t);o.push(e)}}let c;return void 0!==t&&(c=t.symbol),this.filterBySymbolSinceLimit(o,c,s,i)}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new o(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const r=this.market(e);void 0!==s&&s>100&&(s=100);const a={instrument_id:r.id},n=this.safeString2(this.options,"fetchMyTrades","defaultType"),c=this.safeString(i,"type",n),d=this.omit(i,"type"),h=c+"GetFills",u=await this[h](this.extend(a,d));return this.parseMyTrades(u,r,t,s,i)}async fetchOrderTrades(e,t,s,i,r={}){const a={order_id:e};return await this.fetchMyTrades(t,s,i,this.extend(a,r))}async fetchPosition(e,t={}){await this.loadMarkets();const s=this.market(e);let i;const r={instrument_id:s.id},a=s.type;if("futures"===a||"swap"===a)i=a+"GetInstrumentIdPosition";else{if("option"!==a)throw new w(this.id+" fetchPosition() does not support "+a+" market "+e+", supported market types are futures, swap or option");if(void 0===this.safeString(t,"underlying"))throw new o(this.id+" fetchPosition() requires an underlying parameter for "+a+" market "+e);i=a+"GetUnderlyingPosition"}return await this[i](this.extend(r,t))}async fetchPositions(e,t={}){let s;await this.loadMarkets();const i=this.safeString2(this.options,"fetchPositions","defaultType"),r=this.safeString(t,"type",i);if("futures"===r||"swap"===r)s=r+"GetPosition";else{if("option"!==r)throw new w(this.id+" fetchPositions() does not support "+r+" markets, supported market types are futures, swap or option");if(void 0===this.safeString(t,"underlying"))throw new o(this.id+" fetchPositions() requires an underlying parameter for "+r+" markets");s=r+"GetUnderlyingPosition"}t=this.omit(t,"type");return await this[s](t)}async fetchLedger(e,t,s,i={}){await this.loadMarkets();const r=this.safeString2(this.options,"fetchLedger","defaultType"),a=this.safeString(i,"type",r),n=this.omit(i,"type"),c="account"===a?"":"Accounts";let d="";const h={};let u;if(void 0!==s&&(h.limit=s),"spot"===a){if(void 0===e)throw new o(this.id+" fetchLedger() requires a currency code argument for '"+a+"' markets");d="Currency",u=this.currency(e),h.currency=u.id}else if("futures"===a){if(void 0===e)throw new o(this.id+" fetchLedger() requires an underlying symbol for '"+a+"' markets");d="Underlying";const t=this.market(e),s=this.safeValue(t,"info",{}),i=this.safeString(s,"settlement_currency"),r=this.safeCurrencyCode(i);u=this.currency(r);const n=this.safeString(s,"underlying");h.underlying=n}else if("margin"===a||"swap"===a){if(void 0===e)throw new o(this.id+" fetchLedger() requires a code argument (a market symbol) for '"+a+"' markets");d="InstrumentId";const t=this.market(e);u=this.currency(t.base),h.instrument_id=t.id}else{if("account"!==a)throw new w(this.id+" fetchLedger does not support the '"+a+"' type (the type must be one of 'account', 'spot', 'margin', 'futures', 'swap')");void 0!==e&&(u=this.currency(e),h.currency=u.id)}const l=a+"Get"+c+d+"Ledger",f=await this[l](this.extend(h,n));if(f.length<1)return[];const p=Array.isArray(f[0]),m="margin"===a&&p?f[0]:f;if("swap"===a){const i=this.parseLedger(m);return this.filterBySymbolSinceLimit(i,e,t,s)}return this.parseLedger(m,u,t,s)}parseLedgerEntryType(e){return this.safeString({transfer:"transfer",trade:"trade",rebate:"rebate",match:"trade",fee:"fee",settlement:"trade",liquidation:"trade",funding:"fee",margin:"margin"},e,e)}parseLedgerEntry(e,t){const s=this.safeString(e,"ledger_id"),i=this.safeValue(e,"details",{}),r=this.safeString(i,"order_id"),a=this.parseLedgerEntryType(this.safeString(e,"type")),n=this.safeCurrencyCode(this.safeString(e,"currency"),t),o=this.safeNumber(e,"amount"),c=this.parse8601(this.safeString(e,"timestamp")),d={cost:this.safeNumber(e,"fee"),currency:n},h=this.safeNumber(e,"balance"),u=this.safeString(e,"instrument_id");let l;if(u in this.markets_by_id){l=this.markets_by_id[u].symbol}return{info:e,id:s,account:undefined,referenceId:r,referenceAccount:undefined,type:a,currency:n,symbol:l,amount:o,before:undefined,after:h,status:"ok",timestamp:c,datetime:this.iso8601(c),fee:d}}sign(e,t="public",s="GET",i={},r,a){const n=Array.isArray(i);let o="/api/"+t+"/"+this.version+"/";o+=n?e:this.implodeParams(e,i);const c=n?i:this.omit(i,this.extractParams(e));let d=this.implodeParams(this.urls.api.rest,{hostname:this.hostname})+o;const h=this.getPathAuthenticationType(e);if("public"===h)Object.keys(c).length&&(d+="?"+this.urlencode(c));else if("private"===h){this.checkRequiredCredentials();const e=this.iso8601(this.milliseconds());r={"OK-ACCESS-KEY":this.apiKey,"OK-ACCESS-PASSPHRASE":this.password,"OK-ACCESS-TIMESTAMP":e};let t=e+s+o;if("GET"===s){if(Object.keys(c).length){const e="?"+this.urlencode(c);d+=e,t+=e}}else(n||Object.keys(c).length)&&(t+=a=this.json(c)),r["Content-Type"]="application/json";const i=this.hmac(this.encode(t),this.encode(this.secret),"sha256","base64");r["OK-ACCESS-SIGN"]=i}return{url:d,method:s,body:a,headers:r}}getPathAuthenticationType(e){if("underlying"===e)return"public";const t=this.safeValue(this.options,"auth",{}),s=this.findBroadlyMatchedKey(t,e);return this.safeString(t,s,"private")}handleErrors(e,t,s,i,n,o,c,d,h){if(!c)return;const u=this.id+" "+o;if(503===e)throw new a(u);const l=this.safeString(c,"message"),f=this.safeString2(c,"code","error_code"),p=void 0!==l&&""!==l,m=void 0!==f&&"0"!==f;if(p&&(this.throwExactlyMatchedException(this.exceptions.exact,l,u),this.throwBroadlyMatchedException(this.exceptions.broad,l,u)),m&&this.throwExactlyMatchedException(this.exceptions.exact,f,u),m||p)throw new r(u)}}},2597:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ExchangeNotAvailable:a,OnMaintenance:n,ArgumentsRequired:o,BadRequest:c,AccountSuspended:d,InvalidAddress:h,PermissionDenied:u,InsufficientFunds:l,InvalidNonce:f,InvalidOrder:p,OrderNotFound:m,AuthenticationError:b,RequestTimeout:g,BadSymbol:y,RateLimitExceeded:v,NetworkError:w}=s(3449),{TICK_SIZE:k,TRUNCATE:S}=s(2115),_=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"okex5",name:"OKEX",countries:["CN","US"],version:"v5",rateLimit:1e3,has:{CORS:!1,cancelOrder:!0,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchCurrencies:!1,fetchDepositAddress:!0,fetchDeposits:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchPosition:!0,fetchPositions:!0,fetchStatus:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchWithdrawals:!0,withdraw:!0},timeframes:{"1m":"1m","3m":"3m","5m":"5m","15m":"15m","30m":"30m","1h":"1H","2h":"2H","4h":"4H","6h":"6H","12h":"12H","1d":"1D","1w":"1W","1M":"1M","3M":"3M","6M":"6M","1y":"1Y"},hostname:"www.okex.com",urls:{logo:"https://user-images.githubusercontent.com/1294454/32552768-0d6dd3c6-c4a6-11e7-90f8-c043b64756a7.jpg",api:{rest:"https://{hostname}"},www:"https://www.okex.com",doc:"https://www.okex.com/docs/en/",fees:"https://www.okex.com/pages/products/fees.html",referral:"https://www.okex.com/join/1888677",test:{rest:"https://testnet.okex.com"}},api:{public:{get:["market/tickers","market/ticker","market/index-tickers","market/books","market/candles","market/history-candles","market/index-candles","market/mark-price-candles","market/trades","market/platform-24-volume","market/oracle","public/instruments","public/delivery-exercise-history","public/open-interest","public/funding-rate","public/funding-rate-history","public/price-limit","public/opt-summary","public/estimated-price","public/discount-rate-interest-free-quota","public/time","public/liquidation-orders","public/mark-price","public/tier","system/status"]},private:{get:["account/account-position-risk","account/balance","account/positions","account/bills","account/bills-archive","account/config","account/max-size","account/max-avail-size","account/leverage-info","account/max-loan","account/trade-fee","account/interest-accrued","account/interest-rate","account/max-withdrawal","asset/deposit-address","asset/balances","asset/deposit-history","asset/withdrawal-history","asset/currencies","asset/bills","trade/order","trade/orders-pending","trade/orders-history","trade/orders-history-archive","trade/fills","trade/orders-algo-pending","trade/orders-algo-history","account/subaccount/balances","asset/subaccount/bills","users/subaccount/list"],post:["account/set-position-mode","account/set-leverage","account/position/margin-balance","account/set-greeks","asset/transfer","asset/withdrawal","asset/purchase_redempt","trade/order","trade/batch-orders","trade/cancel-order","trade/cancel-batch-orders","trade/amend-order","trade/amend-batch-orders","trade/close-position","trade/order-algo","trade/cancel-algos","users/subaccount/delete-apikey","users/subaccount/modify-apikey","users/subaccount/apikey","asset/subaccount/transfer"]}},fees:{trading:{taker:.0015,maker:.001},spot:{taker:.0015,maker:.001},futures:{taker:5e-4,maker:2e-4},swap:{taker:5e-4,maker:2e-4}},requiredCredentials:{apiKey:!0,secret:!0,password:!0},exceptions:{exact:{1:r,2:r,5e4:c,50001:n,50002:c,50004:g,50005:a,50006:c,50007:d,50008:b,50009:d,50010:r,50011:v,50012:r,50013:a,50014:r,50015:r,50016:r,50017:r,50018:r,50019:r,50020:r,50021:r,50022:r,50023:r,50024:r,50025:r,50026:r,50027:r,50028:r,50100:r,50101:r,50102:f,50103:b,50104:b,50105:b,50106:b,50107:b,50108:r,50109:r,50110:u,50111:b,50112:b,50113:b,50114:b,50115:c,51e3:c,51001:y,51002:y,51003:c,51004:p,51005:p,51006:p,51007:p,51008:l,51009:d,51010:l,51011:p,51012:r,51014:r,51015:y,51016:p,51017:r,51018:r,51019:r,51020:p,51021:y,51022:y,51023:r,51024:d,51025:r,51026:y,51027:y,51028:y,51029:y,51030:y,51031:p,51100:p,51101:p,51102:p,51103:p,51104:p,51105:p,51106:p,51107:p,51108:p,51109:p,51110:p,51111:c,51112:p,51113:v,51115:p,51116:p,51117:p,51118:p,51119:l,51120:p,51121:p,51122:p,51124:p,51125:p,51126:p,51127:l,51128:p,51129:p,51130:y,51131:l,51132:p,51133:p,51134:p,51135:p,51136:p,51137:p,51138:p,51139:p,51201:p,51202:p,51203:p,51204:p,51205:p,51250:p,51251:p,51252:p,51253:p,51254:p,51255:p,51256:p,51257:p,51258:p,51259:p,51260:p,51261:p,51262:p,51263:p,51264:p,51265:p,51267:p,51268:p,51269:p,51270:p,51271:p,51272:p,51273:p,51274:p,51275:p,51276:p,51277:p,51278:p,51279:p,51280:p,51400:m,51401:m,51402:m,51403:p,51404:p,51405:r,51406:r,51407:c,51408:r,51409:r,51410:r,51500:r,51501:r,51502:l,51503:r,51506:r,51508:r,51509:r,51510:r,51511:r,51600:r,51601:r,51602:r,51603:m,52e3:r,54e3:r,54001:r,58e3:r,58001:b,58002:u,58003:r,58004:d,58005:r,58006:r,58007:r,58100:r,58101:d,58102:v,58103:r,58104:r,58105:r,58106:r,58107:r,58108:r,58109:r,58110:r,58111:r,58112:r,58114:r,58115:r,58116:r,58117:r,58200:r,58201:r,58202:r,58203:h,58204:d,58205:r,58206:r,58207:h,58208:r,58209:r,58210:r,58211:r,58212:r,58213:b,58300:r,58350:l,59e3:r,59001:r,59100:r,59101:r,59102:r,59103:l,59104:r,59105:r,59106:r,59107:r,59108:l,59109:r,59200:l,59201:l,59300:r,59301:r,59401:r,59500:r,59501:r,59502:r,59503:r,59504:r,59505:r,59506:r,59507:r,59508:d,60001:b,60002:b,60003:b,60004:b,60005:b,60006:f,60007:b,60008:b,60009:b,60010:b,60011:b,60012:c,60013:c,60014:v,60015:w,60016:a,60017:c,60018:c,60019:c,63999:r},broad:{}},precisionMode:k,options:{fetchOHLCV:{type:"Candles"},createMarketBuyOrderRequiresPrice:!0,fetchMarkets:["spot","futures","swap","option"],defaultType:"spot",auth:{time:"public",currencies:"private",instruments:"public",rate:"public","{instrument_id}/constituents":"public"}},commonCurrencies:{AE:"AET",BOX:"DefiBox",HOT:"Hydro Protocol",HSR:"HC",MAG:"Maggie",SBTC:"Super Bitcoin",YOYO:"YOYOW",WIN:"WinToken"}})}async fetchStatus(e={}){const t=await this.publicGetSystemStatus(e),s=this.safeValue(t,"data",[]),i={info:t,updated:this.milliseconds(),status:"ok",eta:void 0};for(let e=0;e<s.length;e++){const t=s[e];"ongoing"===this.safeString(t,"state")&&(i.eta=this.safeInteger(t,"end"),i.status="maintenance")}return this.status=this.extend(this.status,i),this.status}async fetchTime(e={}){const t=await this.publicGetPublicTime(e),s=this.safeValue(t,"data",[]),i=this.safeValue(s,0,{});return this.safeInteger(i,"ts")}async fetchMarkets(e={}){const t=this.safeValue(this.options,"fetchMarkets");let s=[];for(let i=0;i<t.length;i++){const r=await this.fetchMarketsByType(t[i],e);s=this.arrayConcat(s,r)}return s}parseMarkets(e){const t=[];for(let s=0;s<e.length;s++)t.push(this.parseMarket(e[s]));return t}parseMarket(e){const t=this.safeString(e,"instId"),s=this.safeStringLower(e,"instType"),i="spot"===s,r="futures"===s,a="swap"===s,n="option"===s;let o=this.safeString(e,"baseCcy"),c=this.safeString(e,"quoteCcy");const d=this.safeString(e,"uly");if(void 0!==d&&!i){const e=d.split("-");o=this.safeString(e,0),c=this.safeString(e,1)}const h=this.safeCurrencyCode(o),u=this.safeCurrencyCode(c),l=i?h+"/"+u:t,f=this.safeString(e,"tickSz"),p={amount:this.safeNumber(e,"lotSz"),price:this.parseNumber(f)},m=this.safeString(e,"minSz"),b=this.parseNumber(m);let g;void 0!==b&&void 0!==f&&(g=this.parseNumber(_.stringMul(f,m)));const y=this.safeValue2(this.fees,s,"trading",{});return this.extend(y,{id:t,symbol:l,base:h,quote:u,baseId:o,quoteId:c,info:e,type:s,spot:i,futures:r,swap:a,option:n,active:!0,precision:p,limits:{amount:{min:b,max:void 0},price:{min:p.price,max:void 0},cost:{min:g,max:void 0}}})}async fetchMarketsByType(e,t={}){const s=e.toUpperCase(),i={instType:s};if("OPTION"===s){const e=this.safeValue(this.options,"defaultUnderlying","BTC-USD"),s=this.safeString2(t,"uly","marketId",e);if(void 0===s)throw new o(this.id+" fetchMarketsByType requires an underlying uly or marketId parameter for options markets");i.uly=s}const r=await this.publicGetPublicInstruments(this.extend(i,t)),a=this.safeValue(r,"data",[]);return this.parseMarkets(a)}async fetchCurrencies(e={}){const t=await this.privateGetAssetCurrencies(e),s=this.safeValue(t,"data",[]),i={},r=this.groupBy(s,"ccy"),a=Object.keys(r);for(let e=0;e<a.length;e++){const t=r[a[e]],s=this.safeValue(t,0),n=this.safeString(s,"ccy"),o=this.safeCurrencyCode(n),c=1e-8;let d=this.safeString(s,"name");void 0!==d&&d.length<1&&(d=void 0);const h=this.safeValue(s,"canDep"),u=this.safeValue(s,"canWd"),l=this.safeValue(s,"canInternal"),f=!!(h&&u&&l);i[o]={id:n,code:o,info:t,type:void 0,name:d,active:f,fee:this.safeNumber(s,"minFee"),precision:c,limits:{amount:{min:void 0,max:void 0},withdraw:{min:this.safeNumber(s,"ccy"),max:void 0}}}}return i}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={instId:this.market(e).id};void 0!==(t=void 0===t?20:t)&&(i.sz=t);const r=await this.publicGetMarketBooks(this.extend(i,s)),a=this.safeValue(r,"data",[]),n=this.safeValue(a,0,{}),o=this.safeInteger(n,"ts");return this.parseOrderBook(n,e,o)}parseTicker(e,t){const s=this.safeInteger(e,"ts"),i=this.safeString(e,"instId"),r=(t=this.safeMarket(i,t,"-")).symbol,a=this.safeNumber(e,"last"),n=this.safeNumber(e,"open24h"),o=this.safeNumber(e,"volCcy24h"),c=this.safeNumber(e,"vol24h"),d=this.vwap(c,o);return{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high24h"),low:this.safeNumber(e,"low24h"),bid:this.safeNumber(e,"bidPx"),bidVolume:this.safeNumber(e,"bidSz"),ask:this.safeNumber(e,"askPx"),askVolume:this.safeNumber(e,"askSz"),vwap:d,open:n,close:a,last:a,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:c,quoteVolume:o,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={instId:s.id},r=await this.publicGetMarketTicker(this.extend(i,t)),a=this.safeValue(r,"data",[]),n=this.safeValue(a,0,{});return this.parseTicker(n,s)}async fetchTickersByType(e,t,s={}){await this.loadMarkets();const i=e.toUpperCase(),r={instType:e.toUpperCase()};if("OPTION"===i){const e=this.safeValue(this.options,"defaultUnderlying","BTC-USD"),t=this.safeString2(s,"uly","marketId",e);if(void 0===t)throw new o(this.id+" fetchTickersByType requires an underlying uly or marketId parameter for options markets");r.uly=t}const a=await this.publicGetMarketTickers(this.extend(r,s)),n=this.safeValue(a,"data",[]);return this.parseTickers(n,t)}async fetchTickers(e,t={}){const s=this.safeString2(this.options,"fetchTickers","defaultType"),i=this.safeString(t,"type",s);return await this.fetchTickersByType(i,e,this.omit(t,"type"))}parseTrade(e,t){const s=this.safeString(e,"tradeId"),i=this.safeString(e,"instId"),r=(t=this.safeMarket(i,t,"-")).symbol,a=this.safeInteger(e,"ts"),n=this.safeString2(e,"fillPx","px"),o=this.safeString2(e,"fillSz","sz"),c=this.parseNumber(n),d=this.parseNumber(o),h=this.parseNumber(_.stringMul(n,o)),u=this.safeString(e,"side"),l=this.safeString(e,"ordId"),f=this.safeNumber(e,"fee");let p;if(void 0!==f){const t=this.safeString(e,"feeCcy");p={cost:f,currency:this.safeCurrencyCode(t)}}let m=this.safeString(e,"execType");return"T"===m?m="taker":"M"===m&&(m="maker"),{info:e,timestamp:a,datetime:this.iso8601(a),symbol:r,id:s,order:l,type:void 0,takerOrMaker:m,side:u,price:c,amount:d,cost:h,fee:p}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={instId:r.id};void 0!==s&&(a.limit=s);const n=await this.publicGetMarketTrades(this.extend(a,i)),o=this.safeValue(n,"data",[]);return this.parseTrades(o,r,t,s)}parseOHLCV(e,t){return[this.safeInteger(e,0),this.safeNumber(e,1),this.safeNumber(e,2),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,5)]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={instId:a.id,bar:this.timeframes[t]};void 0!==i&&(n.limit=i);const o=this.safeValue(this.options,"fetchOHLCV",{}),c=this.safeString(o,"type","Candles"),d=this.safeString(r,"type",c);r=this.omit(r,"type");const h="publicGetMarket"+d;void 0!==s&&(n.before=s);const u=await this[h](this.extend(n,r)),l=this.safeValue(u,"data",[]);return this.parseOHLCVs(l,a,t,s,i)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetAccountBalance(this.extend({},e)),s={info:t},i=this.safeValue(t,"data",[]),r=this.safeValue(i,0,{}),a=this.safeInteger(r,"uTime"),n=this.safeValue(r,"details",[]);for(let e=0;e<n.length;e++){const t=n[e],i=this.safeString(t,"ccy"),r=this.safeCurrencyCode(i),a=this.account(),o=this.safeString(t,"eq"),c=this.safeString(t,"availEq");o.length<1||c.length<1?(a.free=this.safeString(t,"availBal"),a.used=this.safeString(t,"frozenBal")):(a.total=o,a.free=c),s[r]=a}return s.timestamp=a,s.datetime=this.iso8601(a),this.parseBalance(s,!1)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o={instId:n.id,tdMode:"cash",side:s,ordType:t},c=this.safeString2(a,"clOrdId","clientOrderId");if(void 0!==c&&(o.clOrdId=c,a=this.omit(a,["clOrdId","clientOrderId"])),"market"===t)if("buy"===s){let e=this.safeNumber(a,"sz");if(this.safeValue(this.options,"createMarketBuyOrderRequiresPrice",!0)){if(void 0!==r)void 0===e&&(e=i*r);else if(void 0===e)throw new p(this.id+" createOrder() requires the price argument with market buy orders to calculate total order cost (amount to spend), where cost = amount * price. Supply a price argument to createOrder() call if you want the cost to be calculated for you from price and amount, or, alternatively, add .options['createMarketBuyOrderRequiresPrice'] = false and supply the total cost value in the 'amount' argument or in the 'sz' extra parameter (the exchange-specific behaviour)")}else e=void 0===e?i:e;const t=n.precision.price;o.sz=this.decimalToPrecision(e,S,t,this.precisionMode)}else o.sz=this.amountToPrecision(e,i);else o.px=this.priceToPrecision(e,r),o.sz=this.amountToPrecision(e,i);const d=await this.privatePostTradeOrder(this.extend(o,a)),h=this.safeValue(d,"data",[]),u=this.safeValue(h,0),l=this.parseOrder(u,n);return this.extend(l,{type:t,side:s})}async cancelOrder(e,t,s={}){if(void 0===t)throw new o(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={instId:i.id},a=this.safeString2(s,"clOrdId","clientOrderId");void 0!==a?r.clOrdId=a:r.ordId=e;const n=this.omit(s,["clOrdId","clientOrderId"]),c=await this.privatePostTradeCancelOrder(this.extend(r,n)),d=this.safeValue(c,"data",[]),h=this.safeValue(d,0);return this.parseOrder(h,i)}parseOrderStatus(e){return this.safeString({canceled:"canceled",live:"open",partially_filled:"open",filled:"closed"},e,e)}parseOrder(e,t){const s=this.safeString(e,"ordId"),i=this.safeInteger(e,"cTime"),r=this.safeInteger(e,"fillTime"),a=this.safeString(e,"side");let n,o,c=this.safeString(e,"ordType");"post_only"===c?(n=!0,c="limit"):"fok"===c?(o="FOK",c="limit"):"ioc"===c&&(o="IOC",c="limit");const d=this.safeString(e,"instId"),h=this.safeSymbol(d,t,"-"),u=this.safeNumber(e,"sz"),l=this.safeNumber(e,"accFillSz"),f=this.safeNumber2(e,"px","slOrdPx"),p=this.safeNumber(e,"avgPx"),m=this.parseOrderStatus(this.safeString(e,"state")),b=this.safeNumber(e,"fee");let g;if(void 0!==b){const t=this.safeString(e,"feeCcy");g={cost:b,currency:this.safeCurrencyCode(t)}}let y=this.safeString(e,"clOrdId");void 0!==y&&y.length<1&&(y=void 0);const v=this.safeNumber(e,"slTriggerPx");return this.safeOrder({info:e,id:s,clientOrderId:y,timestamp:i,datetime:this.iso8601(i),lastTradeTimestamp:this.iso8601(r),symbol:h,type:c,timeInForce:o,postOnly:n,side:a,price:f,stopPrice:v,average:p,cost:void 0,amount:u,filled:l,remaining:void 0,status:m,fee:g,trades:void 0})}async fetchOrder(e,t,s={}){if(void 0===t)throw new o(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={instId:i.id},a=this.safeString2(s,"clOrdId","clientOrderId");void 0!==a?r.clOrdId=a:r.ordId=e;const n=this.omit(s,["clOrdId","clientOrderId"]),c=await this.privateGetTradeOrder(this.extend(r,n)),d=this.safeValue(c,"data",[]),h=this.safeValue(d,0);return this.parseOrder(h,i)}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.market(e),r.instId=a.id),void 0!==s&&(r.limit=s);const n=await this.privateGetTradeOrdersPending(this.extend(r,i)),o=this.safeValue(n,"data",[]);return this.parseOrders(o,a,t,s)}async fetchClosedOrders(e,t,s,i={}){await this.loadMarkets();const r=this.safeString(this.options,"defaultType"),a=this.safeString(this.options,"fetchClosedOrders",{});let n=this.safeString(a,"type",r);n=this.safeString(i,"type",n),i=this.omit(i,"type");const o={};let c;void 0!==e&&(c=this.market(e),(c.futures||c.swap)&&(n=c.type),o.instId=c.id),o.instType=n.toUpperCase(),void 0!==s&&(o.limit=s);const d=this.safeString(a,"method","privateGetTradeOrdersHistory"),h=await this[d](this.extend(o,i)),u=this.safeValue(h,"data",[]);return this.parseOrders(u,c,t,s)}async fetchMyTrades(e,t,s,i={}){const r={};let a;await this.loadMarkets(),void 0!==e&&(a=this.market(e),r.instId=a.id),void 0!==s&&(r.limit=s);const n=await this.privateGetTradeFills(this.extend(r,i)),o=this.safeValue(n,"data",[]);return this.parseTrades(o,a,t,s,i)}async fetchOrderTrades(e,t,s,i,r={}){const a={ordId:e};return await this.fetchMyTrades(t,s,i,this.extend(a,r))}parseDepositAddress(e,t){const s=this.safeString(e,"addr");let i=this.safeString2(e,"tag","pmtId");i=this.safeString(e,"memo",i);const r=this.safeString(e,"ccy"),a=this.safeCurrencyCode(r);return this.checkAddress(s),{currency:a,address:s,tag:i,info:e}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=e.split("-"),i={ccy:this.currency(s[0]).id},r=await this.privateGetAssetDepositAddress(this.extend(i,t)),a=this.safeValue(r,"data",[]),n=this.parseDepositAddresses(a),o=this.safeValue(n,e);if(void 0===o)throw new h(this.id+" fetchDepositAddress cannot return nonexistent addresses, you should create withdrawal addresses with the exchange website first");return o}async withdraw(e,t,s,i,a={}){this.checkAddress(s),await this.loadMarkets();const n=this.currency(e);void 0!==i&&(s=s+":"+i);const c=this.safeString(a,"fee");if(void 0===c)throw new o(this.id+" withdraw() requires a `fee` string parameter, network transaction fee must be ≥ 0. Withdrawals to OKCoin or OKEx are fee-free, please set '0'. Withdrawing to external digital asset address requires network transaction fee.");const d={ccy:n.id,toAddr:s,dest:"4",amt:this.numberToString(t),fee:this.numberToString(c)};"password"in a?d.pwd=a.password:"pwd"in a?d.pwd=a.pwd:this.password&&(d.pwd=this.password);const h=this.omit(a,["fee","password","pwd"]);if(!("pwd"in d))throw new r(this.id+" withdraw() requires this.password set on the exchange instance or a password / pwd parameter");const u=await this.privatePostAssetWithdrawal(this.extend(d,h)),l=this.safeValue(u,"data",[]),f=this.safeValue(l,0);return this.parseTransaction(f,n)}async fetchDeposits(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.ccy=a.id),void 0!==t&&(r.after=t),void 0!==s&&(r.limit=s);const n=await this.privateGetAssetDepositHistory(this.extend(r,i)),o=this.safeValue(n,"data",[]);return this.parseTransactions(o,a,t,s,i)}async fetchWithdrawals(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.ccy=a.id),void 0!==t&&(r.after=t),void 0!==s&&(r.limit=s);const n=await this.privateGetAssetWithdrawalHistory(this.extend(r,i)),o=this.safeValue(n,"data",[]);return this.parseTransactions(o,a,t,s,i)}parseTransactionStatus(e){return this.safeString({"-3":"pending","-2":"canceled","-1":"failed",0:"pending",1:"pending",2:"ok",3:"pending",4:"pending",5:"pending"},e,e)}parseTransaction(e,t){let s,i;const r=this.safeString(e,"wdId"),a=this.safeString(e,"from"),n=this.safeString(e,"to"),o=n;let c=this.safeString2(e,"tag","memo");c=this.safeString2(e,"pmtId",c),void 0!==r?(s="withdrawal",i=r):(i=this.safeString(e,"depId"),s="deposit");const d=this.safeString(e,"ccy"),h=this.safeCurrencyCode(d),u=this.safeNumber(e,"amt"),l=this.parseTransactionStatus(this.safeString(e,"state")),f=this.safeString(e,"txId"),p=this.safeInteger(e,"ts");let m;return m="deposit"===s?0:this.safeNumber(e,"fee"),{info:e,id:i,currency:h,amount:u,addressFrom:a,addressTo:n,address:o,tagFrom:void 0,tagTo:c,tag:c,status:l,type:s,updated:void 0,txid:f,timestamp:p,datetime:this.iso8601(p),fee:{currency:h,cost:m}}}async fetchPosition(e,t={}){await this.loadMarkets();const s=this.market(e),i=this.safeString(t,"type");t=this.omit(t,"type");const r={instId:s.id};void 0!==i&&(r.instType=i.toUpperCase()),t=this.omit(t,"type");const a=await this.privateGetAccountPositions(t),n=this.safeValue(a,"data",[]);return this.safeValue(n,0)}async fetchPositions(e,t={}){await this.loadMarkets();const s=this.safeString(t,"type");t=this.omit(t,"type");void 0!==s&&s.toUpperCase(),t=this.omit(t,"type");const i=await this.privateGetAccountPositions(t);return this.safeValue(i,"data",[])}sign(e,t="public",s="GET",i={},r,a){const n=Array.isArray(i),o="/api/"+this.version+"/"+this.implodeParams(e,i),c=this.omit(i,this.extractParams(e));let d=this.implodeParams(this.urls.api.rest,{hostname:this.hostname})+o;if("public"===t)Object.keys(c).length&&(d+="?"+this.urlencode(c));else if("private"===t){this.checkRequiredCredentials();const e=this.iso8601(this.milliseconds());r={"OK-ACCESS-KEY":this.apiKey,"OK-ACCESS-PASSPHRASE":this.password,"OK-ACCESS-TIMESTAMP":e};let t=e+s+o;if("GET"===s){if(Object.keys(c).length){const e="?"+this.urlencode(c);d+=e,t+=e}}else(n||Object.keys(c).length)&&(t+=a=this.json(c)),r["Content-Type"]="application/json";const i=this.hmac(this.encode(t),this.encode(this.secret),"sha256","base64");r["OK-ACCESS-SIGN"]=i}return{url:d,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(!o)return;const h=this.safeString(o,"code");if("0"!==h){const e=this.id+" "+n,t=this.safeValue(o,"data",[]);for(let s=0;s<t.length;s++){const i=t[s],r=this.safeString(i,"sCode"),a=this.safeString(i,"sMsg");this.throwExactlyMatchedException(this.exceptions.exact,r,e),this.throwBroadlyMatchedException(this.exceptions.broad,a,e)}throw this.throwExactlyMatchedException(this.exceptions.exact,h,e),new r(e)}}}},757:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r}=s(3449),a=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"paymium",name:"Paymium",countries:["FR","EU"],rateLimit:2e3,version:"v1",has:{CORS:!0,fetchBalance:!0,fetchTicker:!0,fetchTrades:!0,fetchOrderBook:!0,createOrder:!0,cancelOrder:!0},urls:{logo:"https://user-images.githubusercontent.com/51840849/87153930-f0f02200-c2c0-11ea-9c0a-40337375ae89.jpg",api:"https://paymium.com/api",www:"https://www.paymium.com",fees:"https://www.paymium.com/page/help/fees",doc:["https://github.com/Paymium/api-documentation","https://www.paymium.com/page/developers"],referral:"https://www.paymium.com/page/sign-up?referral=eDAzPoRQFMvaAB8sf-qj"},api:{public:{get:["countries","data/{currency}/ticker","data/{currency}/trades","data/{currency}/depth","bitcoin_charts/{id}/trades","bitcoin_charts/{id}/depth"]},private:{get:["user","user/addresses","user/addresses/{address}","user/orders","user/orders/{uuid}","user/price_alerts","merchant/get_payment/{uuid}"],post:["user/addresses","user/orders","user/withdrawals","user/email_transfers","user/payment_requests","user/price_alerts","merchant/create_payment"],delete:["user/orders/{uuid}","user/orders/{uuid}/cancel","user/price_alerts/{id}"]}},markets:{"BTC/EUR":{id:"eur",symbol:"BTC/EUR",base:"BTC",quote:"EUR",baseId:"btc",quoteId:"eur"}},fees:{trading:{maker:.002,taker:.002}}})}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetUser(e),s={info:t},i=Object.keys(this.currencies);for(let e=0;e<i.length;e++){const r=i[e],a=this.currencyId(r),n="balance_"+a;if(n in t){const e=this.account(),i="locked_"+a;e.free=this.safeString(t,n),e.used=this.safeString(t,i),s[r]=e}}return this.parseBalance(s,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={currency:this.marketId(e)},r=await this.publicGetDataCurrencyDepth(this.extend(i,s));return this.parseOrderBook(r,e,void 0,"bids","asks","price","amount")}async fetchTicker(e,t={}){await this.loadMarkets();const s={currency:this.marketId(e)},i=await this.publicGetDataCurrencyTicker(this.extend(s,t)),r=this.safeTimestamp(i,"at"),a=this.safeNumber(i,"vwap"),n=this.safeNumber(i,"volume");let o;void 0!==n&&void 0!==a&&(o=n*a);const c=this.safeNumber(i,"price");return{symbol:e,timestamp:r,datetime:this.iso8601(r),high:this.safeNumber(i,"high"),low:this.safeNumber(i,"low"),bid:this.safeNumber(i,"bid"),bidVolume:void 0,ask:this.safeNumber(i,"ask"),askVolume:void 0,vwap:a,open:this.safeNumber(i,"open"),close:c,last:c,previousClose:void 0,change:void 0,percentage:this.safeNumber(i,"variation"),average:void 0,baseVolume:n,quoteVolume:o,info:i}}parseTrade(e,t){const s=this.safeTimestamp(e,"created_at_int"),i=this.safeString(e,"uuid");let r;void 0!==t&&(r=t.symbol);const n=this.safeString(e,"side"),o=this.safeString(e,"price"),c="traded_"+t.base.toLowerCase(),d=this.safeString(e,c),h=this.parseNumber(o),u=this.parseNumber(d),l=this.parseNumber(a.stringMul(o,d));return{info:e,id:i,order:void 0,timestamp:s,datetime:this.iso8601(s),symbol:r,type:void 0,side:n,takerOrMaker:void 0,price:h,amount:u,cost:l,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={currency:r.id},n=await this.publicGetDataCurrencyTrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n={type:this.capitalize(t)+"Order",currency:this.marketId(e),direction:s,amount:i};"market"!==t&&(n.price=r);const o=await this.privatePostUserOrders(this.extend(n,a));return{info:o,id:o.uuid}}async cancelOrder(e,t,s={}){const i={uuid:e};return await this.privateDeleteUserOrdersUuidCancel(this.extend(i,s))}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api+"/"+this.version+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if("public"===t)Object.keys(o).length&&(n+="?"+this.urlencode(o));else{this.checkRequiredCredentials();const e=this.nonce().toString();let t=e+n;if(r={"Api-Key":this.apiKey,"Api-Nonce":e},"POST"===s)Object.keys(o).length&&(t+=a=this.json(o),r["Content-Type"]="application/json");else if(Object.keys(o).length){const e=this.urlencode(o);t+=e,n+="?"+e}r["Api-Signature"]=this.hmac(this.encode(t),this.encode(this.secret))}return{url:n,method:s,body:a,headers:r}}async request(e,t="public",s="GET",i={},a,n){const o=await this.fetch2(e,t,s,i,a,n);if("errors"in o)throw new r(this.id+" "+this.json(o));return o}}},788:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,BadSymbol:a,AuthenticationError:n,InsufficientFunds:o,InvalidOrder:c,ArgumentsRequired:d,OrderNotFound:h,BadRequest:u,PermissionDenied:l,AccountSuspended:f,CancelPending:p,DDoSProtection:m,DuplicateOrderId:b,NotSupported:g}=s(3449),{TICK_SIZE:y}=s(2115),v=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"phemex",name:"Phemex",countries:["CN"],rateLimit:100,version:"v1",certified:!1,pro:!0,hostname:"api.phemex.com",has:{cancelAllOrders:!0,cancelOrder:!0,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTrades:!0,fetchWithdrawals:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/85225056-221eb600-b3d7-11ea-930d-564d2690e3f6.jpg",test:{v1:"https://testnet-api.phemex.com/v1",public:"https://testnet-api.phemex.com/exchange/public",private:"https://testnet-api.phemex.com"},api:{v1:"https://{hostname}/v1",public:"https://{hostname}/exchange/public",private:"https://{hostname}"},www:"https://phemex.com",doc:"https://github.com/phemex/phemex-api-docs",fees:"https://phemex.com/fees-conditions",referral:"https://phemex.com/register?referralCode=EDNVJ"},timeframes:{"1m":"60","3m":"180","5m":"300","15m":"900","30m":"1800","1h":"3600","2h":"7200","3h":"10800","4h":"14400","6h":"21600","12h":"43200","1d":"86400","1w":"604800","1M":"2592000"},api:{public:{get:["cfg/v2/products","products","nomics/trades","md/kline"]},v1:{get:["md/orderbook","md/trade","md/ticker/24hr","md/ticker/24hr/all","md/spot/ticker/24hr","md/spot/ticker/24hr/all","exchange/public/products"]},private:{get:["spot/orders/active","spot/orders","spot/wallets","exchange/spot/order","exchange/spot/order/trades","accounts/accountPositions","accounts/positions","orders/activeList","exchange/order/list","exchange/order","exchange/order/trade","phemex-user/users/children","phemex-user/wallets/v2/depositAddress","exchange/margins/transfer","exchange/wallets/confirm/withdraw","exchange/wallets/withdrawList","exchange/wallets/depositList","exchange/wallets/v2/depositAddress"],post:["spot/orders","orders","positions/assign","exchange/wallets/transferOut","exchange/wallets/transferIn","exchange/margins","exchange/wallets/createWithdraw","exchange/wallets/cancelWithdraw","exchange/wallets/createWithdrawAddress"],put:["spot/orders","orders/replace","positions/leverage","positions/riskLimit"],delete:["spot/orders","orders/cancel","orders","orders/all"]}},precisionMode:y,fees:{trading:{tierBased:!1,percentage:!0,taker:.001,maker:.001}},requiredCredentials:{apiKey:!0,secret:!0},exceptions:{exact:{412:u,6001:u,19999:u,10001:b,10002:h,10003:p,10004:p,10005:p,11001:o,11002:c,11003:o,11004:c,11005:o,11006:r,11007:r,11008:r,11009:r,11010:o,11011:c,11012:c,11013:c,11014:c,11015:c,11016:u,11017:r,11018:r,11019:r,11020:r,11021:r,11022:f,11023:r,11024:r,11025:u,11026:r,11027:a,11028:a,11029:r,11030:r,11031:m,11032:m,11033:b,11034:c,11035:c,11036:c,11037:c,11038:c,11039:c,11040:c,11041:c,11042:c,11043:c,11044:c,11045:c,11046:c,11047:c,11048:c,11049:c,11050:c,11051:c,11052:c,11053:c,11054:c,11055:c,11056:c,11057:c,11058:c,11059:c,11060:c,11061:p,11062:c,11063:c,11064:c,11065:c,11066:c,11067:c,11068:c,11069:r,11070:a,11071:c,11072:c,11073:c,11074:c,11075:c,11076:c,11077:c,11078:c,11079:c,11080:c,11081:c,11082:o,11083:c,11084:c,11085:b,11086:c,11087:c,11088:c,11089:c,11090:c,11091:c,11092:c,11093:c,11094:c,11095:c,11096:c,11097:u,11098:u,11099:r,11100:o,11101:o,11102:u,11103:u,11104:u,11105:o,11106:o,11107:r,11108:c,11109:c,11110:c,11111:c,11112:c,11113:u,11114:c,11115:c,30018:u,39996:l},broad:{"Failed to find api-key":n,"Missing required parameter":u,"API Signature verification failed":n}},options:{"x-phemex-request-expiry":60,createOrderByQuoteRequiresPrice:!0}})}parseSafeNumber(e){if(void 0===e)return e;const t=(e=e.replace(",","")).split(" ");return this.safeNumber(t,0)}parseSwapMarket(e){const t=this.safeString(e,"symbol"),s=this.safeString2(e,"baseCurrency","contractUnderlyingAssets"),i=this.safeString(e,"quoteCurrency"),r=this.safeCurrencyCode(s),a=this.safeCurrencyCode(i),n=r+"/"+a,o=this.safeStringLower(e,"type");let c=!1;this.safeString(e,"settlementCurrency")!==i&&(c=!0);const d=!c,h={amount:this.safeNumber(e,"lotSize"),price:this.safeNumber(e,"tickSize")},u=this.safeInteger(e,"priceScale"),l=this.safeInteger(e,"ratioScale"),f=this.safeInteger(e,"valueScale"),p=this.safeString(e,"minPriceEp"),m=this.safeString(e,"maxPriceEp"),b=this.safeString(e,"makerFeeRateEr"),g=this.safeString(e,"takerFeeRateEr"),y=this.parseNumber(this.fromEn(b,l)),v=this.parseNumber(this.fromEn(g,l)),w={amount:{min:h.amount,max:void 0},price:{min:this.parseNumber(this.fromEn(p,u)),max:this.parseNumber(this.fromEn(m,u))},cost:{min:void 0,max:this.parseNumber(this.safeString(e,"maxOrderQty"))}};return{id:t,symbol:n,base:r,quote:a,baseId:s,quoteId:i,info:e,type:o,spot:!1,swap:!0,linear:d,inverse:c,active:"Listed"===this.safeString(e,"status"),taker:v,maker:y,priceScale:u,valueScale:f,ratioScale:l,precision:h,limits:w}}parseSpotMarket(e){const t=this.safeStringLower(e,"type"),s=this.safeString(e,"symbol"),i=this.safeString(e,"quoteCurrency"),r=this.safeString(e,"baseCurrency"),a=this.safeNumber(e,"defaultTakerFee"),n=this.safeNumber(e,"defaultMakerFee"),o={amount:this.parseSafeNumber(this.safeString(e,"baseTickSize")),price:this.parseSafeNumber(this.safeString(e,"quoteTickSize"))},c={amount:{min:o.amount,max:this.parseSafeNumber(this.safeString(e,"maxBaseOrderSize"))},price:{min:o.price,max:void 0},cost:{min:this.parseSafeNumber(this.safeString(e,"minOrderValue")),max:this.parseSafeNumber(this.safeString(e,"maxOrderValue"))}},d=this.safeCurrencyCode(r),h=this.safeCurrencyCode(i);return{id:s,symbol:d+"/"+h,base:d,quote:h,baseId:r,quoteId:i,info:e,type:t,spot:!0,swap:!1,linear:undefined,inverse:undefined,active:"Listed"===this.safeString(e,"status"),taker:a,maker:n,precision:o,priceScale:8,valueScale:8,ratioScale:8,limits:c}}async fetchMarkets(e={}){const t=await this.publicGetCfgV2Products(e),s=await this.v1GetExchangePublicProducts(e),i=this.safeValue(s,"data",[]),r=this.safeValue(t,"data",{}),a=this.safeValue(r,"products",[]),n=this.safeValue(r,"riskLimits",[]),o=this.indexBy(n,"symbol"),c=this.indexBy(i,"symbol"),d=[];for(let e=0;e<a.length;e++){let t=a[e];if("perpetual"===this.safeStringLower(t,"type")){const e=this.safeString(t,"symbol"),s=this.safeValue(o,e,{});t=this.extend(t,s);const i=this.safeValue(c,e,{});t=this.extend(t,i),t=this.parseSwapMarket(t)}else t=this.parseSpotMarket(t);d.push(t)}return d}async fetchCurrencies(e={}){const t=await this.publicGetCfgV2Products(e),s=this.safeValue(t,"data",{}),i=this.safeValue(s,"currencies",[]),r={};for(let e=0;e<i.length;e++){const t=i[e],s=this.safeString(t,"currency"),a=this.safeString(t,"name"),n=this.safeCurrencyCode(s),o=this.safeString(t,"valueScale"),c=parseInt(o),d=this.safeString(t,"minValueEv"),h=this.safeString(t,"maxValueEv");let u,l,f;if(void 0!==c){const e=this.parsePrecision(o);f=this.parseNumber(e),u=this.parseNumber(v.stringMul(d,e)),l=this.parseNumber(v.stringMul(h,e))}r[n]={id:s,info:t,code:n,name:a,active:void 0,fee:void 0,precision:f,limits:{amount:{min:u,max:l},withdraw:{min:void 0,max:void 0}},valueScale:c}}return r}parseBidAsk(e,t=0,s=1,i){if(void 0===i)throw new d(this.id+" parseBidAsk() requires a market argument");let r=this.safeString(e,s);return i.spot&&(r=this.fromEv(r,i)),[this.parseNumber(this.fromEp(this.safeString(e,t),i)),this.parseNumber(r)]}parseOrderBook(e,t,s,i="bids",r="asks",a=0,n=1,o){const c={symbol:t,timestamp:s,datetime:this.iso8601(s),nonce:void 0},d=[i,r];for(let t=0;t<d.length;t++){const s=d[t],i=[],r=this.safeValue(e,s);for(let e=0;e<r.length;e++)i.push(this.parseBidAsk(r[e],a,n,o));c[s]=i}return c[i]=this.sortBy(c[i],0,!0),c[r]=this.sortBy(c[r],0),c}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),r={symbol:i.id},a=await this.v1GetMdOrderbook(this.extend(r,s)),n=this.safeValue(a,"result",{}),o=this.safeValue(n,"book",{}),c=this.safeIntegerProduct(n,"timestamp",1e-6),d=this.parseOrderBook(o,e,c,"bids","asks",0,1,i);return d.nonce=this.safeInteger(n,"sequence"),d}toEn(e,t){const s=e.toString(),i=new v(s);i.decimals=i.decimals-t,i.reduce();const r=i.toString();return parseInt(r)}toEv(e,t){return void 0===e||void 0===t?e:this.toEn(e,t.valueScale)}toEp(e,t){return void 0===e||void 0===t?e:this.toEn(e,t.priceScale)}fromEn(e,t){if(void 0===e)return;const s=new v(e);return s.decimals=this.sum(s.decimals,t),s.reduce(),s.toString()}fromEp(e,t){return void 0===e||void 0===t?e:this.fromEn(e,this.safeInteger(t,"priceScale"))}fromEv(e,t){return void 0===e||void 0===t?e:this.fromEn(e,this.safeInteger(t,"valueScale"))}fromEr(e,t){return void 0===e||void 0===t?e:this.fromEn(e,this.safeInteger(t,"ratioScale"))}parseOHLCV(e,t){let s;return s=void 0!==t&&t.spot?this.parseNumber(this.fromEv(this.safeString(e,7),t)):this.safeNumber(e,7),[this.safeTimestamp(e,0),this.parseNumber(this.fromEp(this.safeString(e,3),t)),this.parseNumber(this.fromEp(this.safeString(e,4),t)),this.parseNumber(this.fromEp(this.safeString(e,5),t)),this.parseNumber(this.fromEp(this.safeString(e,6),t)),s]}async fetchOHLCV(e,t="1m",s,i,r={}){const a={resolution:this.timeframes[t]},n=this.parseTimeframe(t),o=this.seconds();if(void 0!==s)void 0===i&&(i=2e3),s=parseInt(s/1e3),a.from=s,a.to=Math.min(o,this.sum(s,n*i));else{if(void 0===i)throw new d(this.id+" fetchOHLCV() requires a since argument, or a limit argument, or both");i=Math.min(i,2e3),a.from=o-n*this.sum(i,1),a.to=o}await this.loadMarkets();const c=this.market(e);a.symbol=c.id;const h=await this.publicGetMdKline(this.extend(a,r)),u=this.safeValue(h,"data",{}),l=this.safeValue(u,"rows",[]);return this.parseOHLCVs(l,c,t,s,i)}parseTicker(e,t){const s=this.safeString(e,"symbol"),i=(t=this.safeMarket(s,t)).symbol,r=this.safeIntegerProduct(e,"timestamp",1e-6),a=this.fromEp(this.safeString(e,"lastEp"),t),n=this.parseNumber(a),o=this.parseNumber(this.fromEv(this.safeString(e,"turnoverEv"),t));let c,d,h,u,l=this.safeNumber(e,"volume");void 0===l&&(l=this.parseNumber(this.fromEv(this.safeString(e,"volumeEv"),t))),void 0!==t&&t.spot&&(c=this.vwap(l,o));const f=this.fromEp(this.safeString(e,"openEp"),t),p=this.parseNumber(f);void 0!==f&&void 0!==a&&(d=this.parseNumber(v.stringSub(a,f)),u=this.parseNumber(v.stringDiv(v.stringAdd(a,f),"2")),h=this.parseNumber(v.stringMul(v.stringSub(v.stringDiv(a,f),"1"),"100")));return{symbol:i,timestamp:r,datetime:this.iso8601(r),high:this.parseNumber(this.fromEp(this.safeString(e,"highEp"),t)),low:this.parseNumber(this.fromEp(this.safeString(e,"lowEp"),t)),bid:this.parseNumber(this.fromEp(this.safeString(e,"bidEp"),t)),bidVolume:void 0,ask:this.parseNumber(this.fromEp(this.safeString(e,"askEp"),t)),askVolume:void 0,vwap:c,open:p,close:n,last:n,previousClose:void 0,change:d,percentage:h,average:u,baseVolume:l,quoteVolume:o,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=s.spot?"v1GetMdSpotTicker24hr":"v1GetMdTicker24hr",a=await this[r](this.extend(i,t)),n=this.safeValue(a,"result",{});return this.parseTicker(n,s)}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id},n=await this.v1GetMdTrade(this.extend(a,i)),o=this.safeValue(n,"result",{}),c=this.safeValue(o,"trades",[]);return this.parseTrades(c,r,t,s)}parseTrade(e,t){let s,i,r,a,n,o,c,d;const h=this.safeString(e,"symbol"),u=(t=this.safeMarket(h,t)).symbol;let l,f;if(Array.isArray(e)){const o=e.length;r=this.safeIntegerProduct(e,0,1e-6),o>4&&(a=this.safeString(e,o-4)),n=this.safeStringLower(e,o-3),s=this.fromEp(this.safeString(e,o-2),t),i=this.fromEv(this.safeString(e,o-1),t)}else{r=this.safeIntegerProduct(e,"transactTimeNs",1e-6),a=this.safeString2(e,"execId","execID"),l=this.safeString(e,"orderID"),n=this.safeStringLower(e,"side"),c=this.parseOrderType(this.safeString(e,"ordType"));"MakerFill"===this.safeString(e,"execStatus")&&(f="maker"),s=this.fromEp(this.safeString(e,"execPriceEp"),t),i=this.fromEv(this.safeString(e,"execBaseQtyEv"),t),i=this.safeString(e,"execQty",i),o=this.fromEv(this.safeString2(e,"execQuoteQtyEv","execValueEv"),t);const h=this.fromEv(this.safeString(e,"execFeeEv"),t);if(void 0!==h){const s=this.fromEr(this.safeString(e,"feeRateEr"),t);let i;if(t.spot)i="buy"===n?t.base:t.quote;else{const e=this.safeValue(t,"info");if(void 0!==e){const t=this.safeString(e,"settlementCurrency");i=this.safeCurrencyCode(t)}}d={cost:this.parseNumber(h),rate:this.parseNumber(s),currency:i}}}const p=this.parseNumber(s),m=this.parseNumber(i);void 0===o&&(o=v.stringMul(s,i));const b=this.parseNumber(o);return{info:e,id:a,symbol:u,timestamp:r,datetime:this.iso8601(r),order:l,type:c,side:n,takerOrMaker:f,price:p,amount:m,cost:b,fee:d}}parseSpotBalance(e){let t;const s={info:e},i=this.safeValue(e,"data",[]);for(let e=0;e<i.length;e++){const r=i[e],a=this.safeString(r,"currency"),n=this.safeCurrencyCode(a),o=this.safeValue(this.currencies,n,{}),c=this.safeInteger(o,"valueScale",8),d=this.account(),h=this.safeString(r,"balanceEv"),u=this.safeString(r,"lockedTradingBalanceEv"),l=this.safeString(r,"lockedWithdrawEv"),f=this.fromEn(h,c),p=this.fromEn(u,c),m=this.fromEn(l,c),b=v.stringAdd(p,m),g=this.safeIntegerProduct(r,"lastUpdateTimeNs",1e-6);t=void 0===t?g:Math.max(t,g),d.total=f,d.used=b,s[n]=d}return s.timestamp=t,s.datetime=this.iso8601(t),this.parseBalance(s,!1)}parseSwapBalance(e){const t={info:e},s=this.safeValue(e,"data",{}),i=this.safeValue(s,"account",{}),r=this.safeString(i,"currency"),a=this.safeCurrencyCode(r),n=this.currency(a),o=this.account(),c=this.safeString(i,"accountBalanceEv"),d=this.safeString(i,"totalUsedBalanceEv"),h=this.safeInteger(n,"valueScale",8);return o.total=this.fromEn(c,h),o.used=this.fromEn(d,h),t[a]=o,this.parseBalance(t,!1)}async fetchBalance(e={}){await this.loadMarkets();const t=this.safeString2(this.options,"defaultType","fetchBalance","spot"),s=this.safeString(e,"type",t);let i="privateGetSpotWallets";const r={};if("swap"===s){const t=this.safeString(e,"code");if(void 0!==t){const s=this.currency(t);r.currency=s.id,e=this.omit(e,"code")}else{if(void 0===this.safeString(e,"currency"))throw new d(this.id+" fetchBalance() requires a code parameter or a currency parameter for "+s+" type")}i="privateGetAccountsAccountPositions"}e=this.omit(e,"type");const a=await this[i](this.extend(r,e));return"swap"===s?this.parseSwapBalance(a):this.parseSpotBalance(a)}parseOrderStatus(e){return this.safeString({Created:"open",Untriggered:"open",Deactivated:"closed",Triggered:"open",Rejected:"rejected",New:"open",PartiallyFilled:"open",Filled:"closed",Canceled:"canceled"},e,e)}parseOrderType(e){return this.safeString({Limit:"limit",Market:"market"},e,e)}parseTimeInForce(e){return this.safeString({GoodTillCancel:"GTC",PostOnly:"PO",ImmediateOrCancel:"IOC",FillOrKill:"FOK"},e,e)}parseSpotOrder(e,t){const s=this.safeString(e,"orderID");let i=this.safeString(e,"clOrdID");void 0!==i&&i.length<1&&(i=void 0);const r=this.safeString(e,"symbol"),a=this.safeSymbol(r,t),n=this.parseNumber(this.omitZero(this.fromEp(this.safeString(e,"priceEp"),t))),o=this.parseNumber(this.omitZero(this.fromEv(this.safeString(e,"baseQtyEv"),t))),c=this.parseNumber(this.omitZero(this.fromEv(this.safeString(e,"leavesBaseQtyEv"),t))),d=this.parseNumber(this.omitZero(this.fromEv(this.safeString(e,"cumBaseQtyEv"),t))),h=this.parseNumber(this.omitZero(this.fromEv(this.safeString(e,"quoteQtyEv"),t))),u=this.parseNumber(this.omitZero(this.fromEp(this.safeString(e,"avgPriceEp"),t))),l=this.parseOrderStatus(this.safeString(e,"ordStatus")),f=this.safeStringLower(e,"side"),p=this.parseOrderType(this.safeString(e,"ordType")),m=this.safeIntegerProduct2(e,"actionTimeNs","createTimeNs",1e-6);let b;const g=this.parseNumber(this.fromEv(this.safeString(e,"cumFeeEv"),t));void 0!==g&&(b={cost:g,currency:void 0});const y=this.parseTimeInForce(this.safeString(e,"timeInForce")),v=this.parseNumber(this.omitZero(this.fromEp(this.safeString(e,"stopPxEp",t)))),w="PO"===y;return this.safeOrder({info:e,id:s,clientOrderId:i,timestamp:m,datetime:this.iso8601(m),lastTradeTimestamp:void 0,symbol:a,type:p,timeInForce:y,postOnly:w,side:f,price:n,stopPrice:v,amount:o,cost:h,average:u,filled:d,remaining:c,status:l,fee:b,trades:void 0})}parseSwapOrder(e,t){const s=this.safeString(e,"orderID");let i=this.safeString(e,"clOrdID");void 0!==i&&i.length<1&&(i=void 0);const r=this.safeString(e,"symbol"),a=this.safeSymbol(r,t),n=this.parseOrderStatus(this.safeString(e,"ordStatus")),o=this.safeStringLower(e,"side"),c=this.parseOrderType(this.safeString(e,"orderType")),d=this.parseNumber(this.fromEp(this.safeString(e,"priceEp"),t)),h=this.safeNumber(e,"orderQty"),u=this.safeNumber(e,"cumQty"),l=this.safeNumber(e,"leavesQty"),f=this.safeIntegerProduct(e,"actionTimeNs",1e-6),p=this.safeNumber(e,"cumValue");let m=this.safeIntegerProduct(e,"transactTimeNs",1e-6);0===m&&(m=void 0);const b=this.parseTimeInForce(this.safeString(e,"timeInForce")),g=this.safeNumber(e,"stopPx"),y="PO"===b;return{info:e,id:s,clientOrderId:i,datetime:this.iso8601(f),timestamp:f,lastTradeTimestamp:m,symbol:a,type:c,timeInForce:b,postOnly:y,side:o,price:d,stopPrice:g,amount:h,filled:u,remaining:l,cost:p,average:void 0,status:n,fee:void 0,trades:void 0}}parseOrder(e,t){return"closedPnl"in e?this.parseSwapOrder(e,t):this.parseSpotOrder(e,t)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e);s=this.capitalize(s),t=this.capitalize(t);const o={symbol:n.id,side:s,ordType:t};if(n.spot){let e=this.safeValue(a,"qtyType","ByBase");if("Market"!==t&&"Stop"!==t&&"MarketIfTouched"!==t||void 0!==r&&(e="ByQuote"),o.qtyType=e,"ByQuote"===e){let t=this.safeNumber(a,"cost");if(a=this.omit(a,"cost"),this.options.createOrderByQuoteRequiresPrice)if(void 0!==r)t=i*r;else if(void 0===t)throw new d(this.id+" createOrder() "+e+" requires a price argument or a cost parameter");t=void 0===t?i:t;const s=t.toString();o.quoteQtyEv=this.toEv(s,n)}else{const e=i.toString();o.baseQtyEv=this.toEv(e,n)}}else n.swap&&(o.orderQty=parseInt(i));if("Limit"===t){const e=r.toString();o.priceEp=this.toEp(e,n)}const c=this.safeString2(a,"stopPx","stopPrice");void 0!==c&&(o.stopPxEp=this.toEp(c,n)),a=this.omit(a,["stopPx","stopPrice"]);const h=n.spot?"privatePostSpotOrders":"privatePostOrders",u=await this[h](this.extend(o,a)),l=this.safeValue(u,"data",{});return this.parseOrder(l,n)}async cancelOrder(e,t,s={}){if(void 0===t)throw new d(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={symbol:i.id},a=this.safeString2(s,"clientOrderId","clOrdID");s=this.omit(s,["clientOrderId","clOrdID"]),void 0!==a?r.clOrdID=a:r.orderID=e;const n=i.spot?"privateDeleteSpotOrders":"privateDeleteOrdersCancel",o=await this[n](this.extend(r,s)),c=this.safeValue(o,"data",{});return this.parseOrder(c,i)}async cancelAllOrders(e,t={}){await this.loadMarkets();const s={};let i;if(void 0!==e){if(i=this.market(e),!i.swap)throw new g(this.id+" cancelAllOrders() supports swap market type orders only");s.symbol=i.id}return await this.privateDeleteOrdersAll(this.extend(s,t))}async fetchOrder(e,t,s={}){if(void 0===t)throw new d(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r=i.spot?"privateGetSpotOrdersActive":"privateGetExchangeOrder",a={symbol:i.id},n=this.safeString2(s,"clientOrderId","clOrdID");s=this.omit(s,["clientOrderId","clOrdID"]),void 0!==n?a.clOrdID=n:a.orderID=e;const o=await this[r](this.extend(a,s)),c=this.safeValue(o,"data",{});let u=c;if(Array.isArray(c)){if(c.length<1)throw new h(void 0!==n?this.id+" fetchOrder "+t+" order with clientOrderId "+n+" not found":this.id+" fetchOrder "+t+" order with id "+e+" not found");u=this.safeValue(c,0,{})}return this.parseOrder(u,i)}async fetchOrders(e,t,s,i={}){if(void 0===e)throw new d(this.id+" fetchOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a=r.spot?"privateGetSpotOrders":"privateGetExchangeOrderList",n={symbol:r.id};void 0!==t&&(n.start=t),void 0!==s&&(n.limit=s);const o=await this[a](this.extend(n,i)),c=this.safeValue(o,"data",{}),h=this.safeValue(c,"rows",[]);return this.parseOrders(h,r,t,s)}async fetchOpenOrders(e,t,s,i={}){if(void 0===e)throw new d(this.id+" fetchOpenOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a=r.spot?"privateGetSpotOrders":"privateGetOrdersActiveList",n={symbol:r.id},o=await this[a](this.extend(n,i)),c=this.safeValue(o,"data",{});if(Array.isArray(c))return this.parseOrders(c,r,t,s);{const e=this.safeValue(c,"rows",[]);return this.parseOrders(e,r,t,s)}}async fetchClosedOrders(e,t,s,i={}){if(void 0===e)throw new d(this.id+" fetchClosedOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a=r.spot?"privateGetExchangeSpotOrder":"privateGetExchangeOrderList",n={symbol:r.id};void 0!==t&&(n.start=t),void 0!==s&&(n.limit=s);const o=await this[a](this.extend(n,i)),c=this.safeValue(o,"data",{});if(Array.isArray(c))return this.parseOrders(c,r,t,s);{const e=this.safeValue(c,"rows",[]);return this.parseOrders(e,r,t,s)}}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new d(this.id+" fetchClosedOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a=r.spot?"privateGetExchangeSpotOrderTrades":"privateGetExchangeOrderTrade",n={symbol:r.id};void 0!==t&&(n.start=t),r.swap&&void 0!==s&&(n.limit=s);const o=await this[a](this.extend(n,i)),c=this.safeValue(o,"data",{}),h=this.safeValue(c,"rows",[]);return this.parseTrades(h,r,t,s)}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={currency:this.currency(e).id},i=await this.privateGetPhemexUserWalletsV2DepositAddress(this.extend(s,t)),r=this.safeValue(i,"data",{}),a=this.safeString(r,"address"),n=this.safeString(r,"tag");return this.checkAddress(a),{currency:e,address:a,tag:n,info:i}}async fetchDeposits(e,t,s,i={}){let r;await this.loadMarkets(),void 0!==e&&(r=this.currency(e));const a=await this.privateGetExchangeWalletsDepositList(i),n=this.safeValue(a,"data",{});return this.parseTransactions(n,r,t,s)}async fetchWithdrawals(e,t,s,i={}){let r;await this.loadMarkets(),void 0!==e&&(r=this.currency(e));const a=await this.privateGetExchangeWalletsWithdrawList(i),n=this.safeValue(a,"data",{});return this.parseTransactions(n,r,t,s)}parseTransactionStatus(e){return this.safeString({Success:"ok",Succeed:"ok"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"address"),r=void 0,a=this.safeString(e,"txHash"),n=this.safeString(e,"currency"),o=(t=this.safeCurrency(n,t)).code,c=this.safeInteger2(e,"createdAt","submitedAt");let d=this.safeStringLower(e,"type");const h=this.parseNumber(this.fromEn(this.safeString(e,"feeEv"),t.valueScale));let u;void 0!==h&&(d="withdrawal",u={cost:h,currency:o});const l=this.parseTransactionStatus(this.safeString(e,"status")),f=this.parseNumber(this.fromEn(this.safeString(e,"amountEv"),t.valueScale));return{info:e,id:s,txid:a,timestamp:c,datetime:this.iso8601(c),address:i,addressTo:i,addressFrom:void 0,tag:r,tagTo:r,tagFrom:void 0,type:d,amount:f,currency:o,status:l,updated:void 0,fee:u}}async fetchPositions(e,t={}){await this.loadMarkets();const s=this.safeString(t,"code"),i={};if(void 0===s){if(void 0===this.safeString(t,"currency"))throw new d(this.id+" fetchPositions() requires a currency parameter or a code parameter")}else{const e=this.currency(s);t=this.omit(t,"code"),i.currency=e.id}const r=await this.privateGetAccountsAccountPositions(this.extend(i,t)),a=this.safeValue(r,"data",{});return this.safeValue(a,"positions",[])}sign(e,t="public",s="GET",i={},r,a){const n=this.omit(i,this.extractParams(e)),o="/"+this.implodeParams(e,i);let c=o,d="";if("GET"!==s&&"DELETE"!==s&&"PUT"!==s||Object.keys(n).length&&(d=this.urlencodeWithArrayRepeat(n),c+="?"+d),"private"===t){this.checkRequiredCredentials();const e=this.seconds(),t=this.safeInteger(this.options,"x-phemex-request-expiry",60),n=this.sum(e,t).toString();r={"x-phemex-access-token":this.apiKey,"x-phemex-request-expiry":n};let c="";"POST"===s&&(c=this.json(i),a=c,r["Content-Type"]="application/json");const h=o+d+n+c;r["x-phemex-request-signature"]=this.hmac(this.encode(h),this.encode(this.secret))}return c=this.implodeParams(this.urls.api[t],{hostname:this.hostname})+c,{url:c,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0===o)return;const h=this.safeValue(o,"error",o),u=this.safeString(h,"code"),l=this.safeString(h,"msg");if(void 0!==u&&"0"!==u){const e=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,u,e),this.throwBroadlyMatchedException(this.exceptions.broad,l,e),new r(e)}}}},7497:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ExchangeNotAvailable:a,RequestTimeout:n,AuthenticationError:o,PermissionDenied:c,DDoSProtection:d,InsufficientFunds:h,OrderNotFound:u,InvalidOrder:l,AccountSuspended:f,CancelPending:p,InvalidNonce:m,OnMaintenance:b,BadSymbol:g}=s(3449),y=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"poloniex",name:"Poloniex",countries:["US"],rateLimit:1e3,certified:!1,pro:!0,has:{cancelOrder:!0,CORS:!1,createDepositAddress:!0,createMarketOrder:!1,createOrder:!0,editOrder:!0,fetchBalance:!0,fetchClosedOrder:"emulated",fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrder:!0,fetchOpenOrders:!0,fetchOrderBook:!0,fetchOrderBooks:!0,fetchOrderTrades:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTradingFee:!0,fetchTradingFees:!0,fetchTransactions:!0,fetchWithdrawals:!0,cancelAllOrders:!0,withdraw:!0},timeframes:{"5m":300,"15m":900,"30m":1800,"2h":7200,"4h":14400,"1d":86400},urls:{logo:"https://user-images.githubusercontent.com/1294454/27766817-e9456312-5ee6-11e7-9b3c-b628ca5626a5.jpg",api:{public:"https://poloniex.com/public",private:"https://poloniex.com/tradingApi"},www:"https://www.poloniex.com",doc:"https://docs.poloniex.com",fees:"https://poloniex.com/fees",referral:"https://poloniex.com/signup?c=UBFZJRPJ"},api:{public:{get:["return24hVolume","returnChartData","returnCurrencies","returnLoanOrders","returnOrderBook","returnTicker","returnTradeHistory"]},private:{post:["buy","cancelLoanOffer","cancelOrder","cancelAllOrders","closeMarginPosition","createLoanOffer","generateNewAddress","getMarginPosition","marginBuy","marginSell","moveOrder","returnActiveLoans","returnAvailableAccountBalances","returnBalances","returnCompleteBalances","returnDepositAddresses","returnDepositsWithdrawals","returnFeeInfo","returnLendingHistory","returnMarginAccountSummary","returnOpenLoanOffers","returnOpenOrders","returnOrderTrades","returnOrderStatus","returnTradableBalances","returnTradeHistory","sell","toggleAutoRenew","transferBalance","withdraw"]}},fees:{trading:{feeSide:"get",maker:9e-4,taker:9e-4},funding:{}},limits:{amount:{min:1e-6,max:1e9},price:{min:1e-8,max:1e9},cost:{min:0,max:1e9}},precision:{amount:8,price:8},commonCurrencies:{AIR:"AirCoin",APH:"AphroditeCoin",BCC:"BTCtalkcoin",BDG:"Badgercoin",BTM:"Bitmark",CON:"Coino",GOLD:"GoldEagles",GPUC:"GPU",HOT:"Hotcoin",ITC:"Information Coin",KEY:"KEYCoin",PLX:"ParallaxCoin",REPV2:"REP",STR:"XLM",SOC:"SOCC",XAP:"API Coin",USDTTRON:"USDT",USDTETH:"USDT"},options:{limits:{cost:{min:{BTC:1e-4,ETH:1e-4,USDT:1,TRX:100,BNB:.06,USDC:1,USDJ:1,TUSD:1e-4,DAI:1,PAX:1,BUSD:1}}}},exceptions:{exact:{"You may only place orders that reduce your position.":l,"Invalid order number, or you are not the person who placed the order.":u,"Permission denied":c,"Connection timed out. Please try again.":n,"Internal error. Please try again.":a,"Currently in maintenance mode.":b,"Order not found, or you are not the person who placed it.":u,"Invalid API key/secret pair.":o,"Please do not make more than 8 API calls per second.":d,"Rate must be greater than zero.":l,"Invalid currency pair.":g,"Invalid currencyPair parameter.":g,"Trading is disabled in this market.":g,"Invalid orderNumber parameter.":u},broad:{"Total must be at least":l,"This account is frozen.":f,"Not enough":h,"Nonce must be greater":m,"You have already called cancelOrder or moveOrder on this order.":p,"Amount must be at least":l,"is either completed or does not exist":u,"Error pulling ":r}}})}parseOHLCV(e,t){return[this.safeTimestamp(e,"date"),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"quoteVolume")]}async fetchOHLCV(e,t="5m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={currencyPair:a.id,period:this.timeframes[t]};if(void 0===s)n.end=this.seconds(),n.start=void 0===i?n.end-this.parseTimeframe("1w"):n.end-i*this.parseTimeframe(t);else if(n.start=parseInt(s/1e3),void 0!==i){const e=this.sum(n.start,i*this.parseTimeframe(t));n.end=e}const o=await this.publicGetReturnChartData(this.extend(n,r));return this.parseOHLCVs(o,a,t,s,i)}async loadMarkets(e=!1,t={}){const s=await super.loadMarkets(e,t);return(void 0===this.safeValue(this.options,"currenciesByNumericId")||e)&&(this.options.currenciesByNumericId=this.indexBy(this.currencies,"numericId")),s}async fetchMarkets(e={}){const t=await this.publicGetReturnTicker(e),s=Object.keys(t),i=[];for(let e=0;e<s.length;e++){const r=s[e],a=t[r],[n,o]=r.split("_"),c=this.safeCurrencyCode(o),d=this.safeCurrencyCode(n),h=c+"/"+d,u=this.extend(this.limits,{cost:{min:this.safeValue(this.options.limits.cost.min,d)}}),l="1"!==this.safeString(a,"isFrozen"),f=this.safeInteger(a,"id");i.push({id:r,numericId:f,symbol:h,baseId:o,quoteId:n,base:c,quote:d,active:l,limits:u,info:a})}return i}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostReturnCompleteBalances(this.extend({account:"all"},e)),s={info:t,timestamp:void 0,datetime:void 0},i=Object.keys(t);for(let e=0;e<i.length;e++){const r=i[e],a=this.safeValue(t,r,{}),n=this.safeCurrencyCode(r),o=this.account();o.free=this.safeString(a,"available"),o.used=this.safeString(a,"onOrders"),s[n]=o}return this.parseBalance(s,!1)}async fetchTradingFees(e={}){await this.loadMarkets();const t=await this.privatePostReturnFeeInfo(e);return{info:t,maker:this.safeNumber(t,"makerFee"),taker:this.safeNumber(t,"takerFee"),withdraw:{},deposit:{}}}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={currencyPair:this.marketId(e)};void 0!==t&&(i.depth=t);const r=await this.publicGetReturnOrderBook(this.extend(i,s)),a=this.parseOrderBook(r,e);return a.nonce=this.safeInteger(r,"seq"),a}async fetchOrderBooks(e,t,s={}){await this.loadMarkets();const i={currencyPair:"all"};void 0!==t&&(i.depth=t);const r=await this.publicGetReturnOrderBook(this.extend(i,s)),a=Object.keys(r),n={};for(let e=0;e<a.length;e++){const t=a[e];let s;if(t in this.markets_by_id)s=this.markets_by_id[t].symbol;else{const[e,i]=t.split("_");s=this.safeCurrencyCode(i)+"/"+this.safeCurrencyCode(e)}const i=this.parseOrderBook(r[t],s);i.nonce=this.safeInteger(r[t],"seq"),n[s]=i}return n}parseTicker(e,t){const s=this.milliseconds();let i,r,a,n;t&&(i=t.symbol);const o=this.safeNumber(e,"last"),c=this.safeNumber(e,"percentChange");return-1!==c&&(r=o/this.sum(1,c),a=o-r,n=this.sum(o,r)/2),{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high24hr"),low:this.safeNumber(e,"low24hr"),bid:this.safeNumber(e,"highestBid"),bidVolume:void 0,ask:this.safeNumber(e,"lowestAsk"),askVolume:void 0,vwap:void 0,open:r,close:o,last:o,previousClose:void 0,change:a,percentage:100*c,average:n,baseVolume:this.safeNumber(e,"quoteVolume"),quoteVolume:this.safeNumber(e,"baseVolume"),info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetReturnTicker(t),i=Object.keys(s),r={};for(let e=0;e<i.length;e++){const t=i[e];let a,n;if(t in this.markets_by_id)n=this.markets_by_id[t],a=n.symbol;else{const[e,s]=t.split("_");a=this.safeCurrencyCode(s)+"/"+this.safeCurrencyCode(e),n={symbol:a}}const o=s[t];r[a]=this.parseTicker(o,n)}return this.filterByArray(r,"symbol",e)}async fetchCurrencies(e={}){const t=await this.publicGetReturnCurrencies(e),s=Object.keys(t),i={};for(let e=0;e<s.length;e++){const r=s[e],a=t[r],n=8,o="1e-8",c=this.safeCurrencyCode(r),d=0===a.delisted&&!a.disabled,h=this.safeInteger(a,"id"),u=this.safeNumber(a,"txFee");i[c]={id:r,numericId:h,code:c,info:a,name:a.name,active:d,fee:u,precision:n,limits:{amount:{min:this.parseNumber(o),max:void 0},withdraw:{min:u,max:void 0}}}}return i}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i=(await this.publicGetReturnTicker(t))[s.id];return this.parseTicker(i,s)}parseTrade(e,t){const s=this.safeString2(e,"globalTradeID","tradeID"),i=this.safeString(e,"orderNumber"),r=this.parse8601(this.safeString(e,"date"));let a;if(!t&&"currencyPair"in e){const s=this.safeString(e,"currencyPair");if(s in this.markets_by_id)t=this.markets_by_id[s];else{const[e,t]=s.split("_");a=this.safeCurrencyCode(t)+"/"+this.safeCurrencyCode(e)}}void 0===a&&void 0!==t&&(a=t.symbol);const n=this.safeString(e,"type");let o;const c=this.safeString(e,"rate"),d=this.safeString(e,"amount"),h=this.parseNumber(c),u=this.parseNumber(d);let l=this.safeNumber(e,"total");void 0===l&&(l=this.parseNumber(y.stringMul(c,d)));const f=this.safeString(e,"feeDisplay");if(void 0!==f){const e=f.split(" "),t=this.safeNumber(e,0);if(void 0!==t){const s=this.safeString(e,1),i=this.safeCurrencyCode(s);let r=this.safeString(e,2);if(void 0!==r){r=r.replace("(","");const e=r.split("%");r=this.safeString(e,0),r=parseFloat(r)/100}o={cost:t,currency:i,rate:r}}}else{const s=this.safeNumber(e,"fee");if(void 0!==s&&void 0!==t){const e="buy"===n?u:l;o={cost:s,currency:"buy"===n?t.base:t.quote,rate:y.stringDiv(s,e)}}}let p;return void 0!==this.safeNumber(e,"takerAdjustment")&&(p="taker"),{id:s,info:e,timestamp:r,datetime:this.iso8601(r),symbol:a,order:i,type:"limit",side:n,takerOrMaker:p,price:h,amount:u,cost:l,fee:o}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={currencyPair:r.id};void 0!==t&&(a.start=parseInt(t/1e3),a.end=this.seconds());const n=await this.publicGetReturnTradeHistory(this.extend(a,i));return this.parseTrades(n,r,t,s)}async fetchMyTrades(e,t,s,i={}){let r;await this.loadMarkets(),void 0!==e&&(r=this.market(e));const a={currencyPair:r?r.id:"all"};void 0!==t&&(a.start=parseInt(t/1e3),a.end=this.sum(this.seconds(),1)),void 0!==s&&(a.limit=parseInt(s));const n=await this.privatePostReturnTradeHistory(this.extend(a,i));let o=[];if(void 0!==r)o=this.parseTrades(n,r);else if(n){const e=Object.keys(n);for(let t=0;t<e.length;t++){const s=e[t];let i;if(s in this.markets_by_id){i=this.markets_by_id[s];const e=this.parseTrades(n[s],i);for(let t=0;t<e.length;t++)o.push(e[t])}else{const[e,t]=s.split("_"),i=this.safeCurrencyCode(t),r=this.safeCurrencyCode(e),a=i+"/"+r,c=n[s];for(let e=0;e<c.length;e++){const t={symbol:a,base:i,quote:r};o.push(this.parseTrade(c[e],t))}}}}return this.filterBySinceLimit(o,t,s)}parseOrderStatus(e){return this.safeString({Open:"open","Partially filled":"open"},e,e)}parseOrder(e,t){let s,i=this.safeInteger(e,"timestamp");void 0===i&&(i=this.parse8601(this.safeString(e,"date")));const r=this.safeString(e,"currencyPair");if(void 0!==r)if(r in this.markets_by_id)t=this.markets_by_id[r];else{const[e,t]=r.split("_");s=this.safeCurrencyCode(t)+"/"+this.safeCurrencyCode(e)}let a;void 0===s&&void 0!==t&&(s=t.symbol);let n=this.safeValue(e,"resultingTrades");Array.isArray(n)||(n=this.safeValue(n,this.safeString(t,"id",r))),void 0!==n&&(a=this.parseTrades(n,t));const o=this.safeNumber2(e,"price","rate");let c,d=this.safeNumber(e,"amount"),h=this.safeNumber(e,"startingAmount"),u=0;void 0!==h?void 0!==d&&(c=h-d,void 0!==o&&(u=c*o)):h=d;let l,f,p=this.parseOrderStatus(this.safeString(e,"status"));if(void 0===c&&void 0!==a){c=0,u=0;const e=a.length;if(e>0){f=a[0].timestamp;for(let t=0;t<e;t++){const e=a[t],s=e.amount,i=e.price;c=this.sum(c,s),u=this.sum(u,i*s),f=Math.max(f,e.timestamp)}}void 0!==h&&(d=Math.max(h-c,0),c>=h&&(p="closed"))}void 0!==c&&void 0!==u&&c>0&&(l=u/c);let m=this.safeString(e,"type");const b=this.safeString(e,"side",m);m===b&&(m=void 0);const g=this.safeString(e,"orderNumber");let y;const v=this.safeNumber(e,"fee");if(void 0!==v){let e;void 0!==t&&(e="buy"===b?t.base:t.quote),y={cost:v,currency:e}}return{info:e,id:g,clientOrderId:this.safeString(e,"clientOrderId"),timestamp:i,datetime:this.iso8601(i),lastTradeTimestamp:f,status:p,symbol:s,type:m,timeInForce:void 0,postOnly:void 0,side:b,price:o,stopPrice:void 0,cost:u,average:l,amount:h,filled:c,remaining:d,trades:a,fee:y}}parseOpenOrders(e,t,s){for(let i=0;i<e.length;i++){const r=e[i],a=this.extend(r,{status:"open",type:"limit",side:r.type,price:r.rate});s.push(this.parseOrder(a,t))}return s}async fetchOpenOrders(e,t,s,i={}){let r;await this.loadMarkets(),void 0!==e&&(r=this.market(e));const a={currencyPair:r?r.id:"all"},n=await this.privatePostReturnOpenOrders(this.extend(a,i)),o={status:"open"};if(void 0===r){const e=Object.keys(n);let i=[];for(let t=0;t<e.length;t++){const s=e[t],r=n[s],a=this.markets_by_id[s];i=this.arrayConcat(i,this.parseOrders(r,a,void 0,void 0,o))}return this.filterBySinceLimit(i,t,s)}return this.parseOrders(n,r,t,s,o)}async createOrder(e,t,s,i,a,n={}){if("market"===t)throw new r(this.id+" createOrder() does not accept market orders");await this.loadMarkets();const o="privatePost"+this.capitalize(s),c=this.market(e);i=this.amountToPrecision(e,i);const d={currencyPair:c.id,rate:this.priceToPrecision(e,a),amount:i},h=this.safeString(n,"clientOrderId");void 0!==h&&(d.clientOrderId=h,n=this.omit(n,"clientOrderId"));const u=this.milliseconds(),l=await this[o](this.extend(d,n));return this.parseOrder(this.extend({timestamp:u,status:"open",type:t,side:s,price:a,amount:i},l),c)}async editOrder(e,t,s,i,r,a,n={}){await this.loadMarkets(),a=parseFloat(a);const o={orderNumber:e,rate:this.priceToPrecision(t,a)};void 0!==r&&(o.amount=this.amountToPrecision(t,r));const c=await this.privatePostMoveOrder(this.extend(o,n));return this.parseOrder(c)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={},r=this.safeValue(s,"clientOrderId");return void 0===r?i.orderNumber=e:i.clientOrderId=r,s=this.omit(s,"clientOrderId"),await this.privatePostCancelOrder(this.extend(i,s))}async cancelAllOrders(e,t={}){const s={};let i;void 0!==e&&(i=this.market(e),s.currencyPair=i.id);return await this.privatePostCancelAllOrders(this.extend(s,t))}async fetchOpenOrder(e,t,s={}){await this.loadMarkets();const i={orderNumber:e=e.toString()},r=await this.privatePostReturnOrderStatus(this.extend(i,s)),a=this.safeValue(r.result,e);if(void 0===a)throw new u(this.id+" order id "+e+" not found");return this.parseOrder(a)}async fetchClosedOrder(e,t,s={}){await this.loadMarkets();const i={orderNumber:e},r=await this.privatePostReturnOrderTrades(this.extend(i,s)),a=this.parseTrades(r),n=this.safeValue(a,0);if(void 0===n)throw new u(this.id+" order id "+e+" not found");t=this.safeString(n,"symbol",t);const o=this.safeString(n,"side"),c=this.safeNumber(n,"timestamp");return e=this.safeValue(n.info,"globalTradeID",e),this.safeOrder({info:r,id:e,clientOrderId:this.safeValue(n,"clientOrderId"),timestamp:c,datetime:this.iso8601(c),lastTradeTimestamp:void 0,status:"closed",symbol:t,type:this.safeString(n,"type"),timeInForce:void 0,postOnly:void 0,side:o,price:void 0,stopPrice:void 0,cost:void 0,average:void 0,amount:void 0,filled:void 0,remaining:void 0,trades:a,fee:void 0})}async fetchOrderStatus(e,t,s={}){await this.loadMarkets();const i=await this.fetchOpenOrders(t,void 0,void 0,s);return e in this.indexBy(i,"id")?"open":"closed"}async fetchOrderTrades(e,t,s,i,r={}){await this.loadMarkets();const a={orderNumber:e},n=await this.privatePostReturnOrderTrades(this.extend(a,r));return this.parseTrades(n)}async createDepositAddress(e,t={}){let s,i;await this.loadMarkets(),e in this.currencies?(i=this.currency(e),s=i.id):s=e;const r={currency:s},a=await this.privatePostGenerateNewAddress(this.extend(r,t));let n,o;if(1===a.success&&(n=this.safeString(a,"response")),this.checkAddress(n),void 0!==i){const e=this.safeString(i.info,"depositAddress");void 0!==e&&(o=n,n=e)}return{currency:e,address:n,tag:o,info:a}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=await this.privatePostReturnDepositAddresses(t);let i,r;e in this.currencies?(r=this.currency(e),i=r.id):i=e;let a,n=this.safeString(s,i);if(this.checkAddress(n),void 0!==r){const e=this.safeString(r.info,"depositAddress");void 0!==e&&(a=n,n=e)}return{currency:e,address:n,tag:a,info:s}}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a={currency:this.currency(e).id,amount:t,address:s};void 0!==i&&(a.paymentId=i);const n=await this.privatePostWithdraw(this.extend(a,r));return{info:n,id:this.safeString(n,"withdrawalNumber")}}async fetchTransactionsHelper(e,t,s,i={}){await this.loadMarkets();const r=this.seconds(),a={start:void 0!==t?parseInt(t/1e3):r-31104e4,end:r};void 0!==s&&(a.limit=s);return await this.privatePostReturnDepositsWithdrawals(this.extend(a,i))}async fetchTransactions(e,t,s,i={}){await this.loadMarkets();const r=await this.fetchTransactionsHelper(e,t,s,i);let a;void 0!==e&&(a=this.currency(e));const n=this.safeValue(r,"withdrawals",[]),o=this.safeValue(r,"deposits",[]),c=this.parseTransactions(n,a,t,s),d=this.parseTransactions(o,a,t,s),h=this.arrayConcat(d,c);return this.filterByCurrencySinceLimit(this.sortBy(h,"timestamp"),e,t,s)}async fetchWithdrawals(e,t,s,i={}){const r=await this.fetchTransactionsHelper(e,t,s,i);let a;void 0!==e&&(a=this.currency(e));const n=this.safeValue(r,"withdrawals",[]),o=this.parseTransactions(n,a,t,s);return this.filterByCurrencySinceLimit(o,e,t,s)}async fetchDeposits(e,t,s,i={}){const r=await this.fetchTransactionsHelper(e,t,s,i);let a;void 0!==e&&(a=this.currency(e));const n=this.safeValue(r,"deposits",[]),o=this.parseTransactions(n,a,t,s);return this.filterByCurrencySinceLimit(o,e,t,s)}parseTransactionStatus(e){return this.safeString({COMPLETE:"ok"},e,e)}parseTransaction(e,t){const s=this.safeTimestamp(e,"timestamp"),i=this.safeString(e,"currency"),r=this.safeCurrencyCode(i);let a=this.safeString(e,"status","pending"),n=this.safeString(e,"txid");if(void 0!==a){const e=a.split(": "),t=e.length;a=e[0],t>1&&void 0===n&&(n=e[1]),a=this.parseTransactionStatus(a)}const o="withdrawalNumber"in e?"withdrawal":"deposit",c=this.safeString(e,"type",o),d=this.safeString2(e,"withdrawalNumber","depositNumber");let h=this.safeNumber(e,"amount");const u=this.safeString(e,"address"),l=this.safeString(e,"paymentID"),f=this.safeNumber(e,"fee",0);return"withdrawal"===c&&(h-=f),{info:e,id:d,currency:r,amount:h,address:u,tag:l,status:a,type:c,updated:void 0,txid:n,timestamp:s,datetime:this.iso8601(s),fee:{currency:r,cost:f}}}async fetchPosition(e,t={}){await this.loadMarkets();const s={currencyPair:this.market(e).id};return await this.privatePostGetMarginPosition(this.extend(s,t))}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t];const o=this.extend({command:e},i);return"public"===t?n+="?"+this.urlencode(o):(this.checkRequiredCredentials(),o.nonce=this.nonce(),a=this.urlencode(o),r={"Content-Type":"application/x-www-form-urlencoded",Key:this.apiKey,Sign:this.hmac(this.encode(a),this.encode(this.secret),"sha512")}),{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0!==o&&"error"in o){const e=o.error,t=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,e,t),this.throwBroadlyMatchedException(this.exceptions.broad,e,t),new r(t)}}}},6818:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ExchangeNotAvailable:a,BadResponse:n,BadRequest:o,InvalidOrder:c,InsufficientFunds:d,AuthenticationError:h,ArgumentsRequired:u,InvalidAddress:l,RateLimitExceeded:f,DDoSProtection:p,BadSymbol:m}=s(3449),{TRUNCATE:b,TICK_SIZE:g}=s(2115),y=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"probit",name:"ProBit",countries:["SC","KR"],rateLimit:250,has:{CORS:!0,fetchTime:!0,fetchMarkets:!0,fetchCurrencies:!0,fetchTickers:!0,fetchTicker:!0,fetchOHLCV:!0,fetchOrderBook:!0,fetchTrades:!0,fetchBalance:!0,createOrder:!0,createMarketOrder:!0,cancelOrder:!0,fetchOrder:!0,fetchOpenOrders:!0,fetchClosedOrders:!0,fetchMyTrades:!0,fetchDepositAddress:!0,withdraw:!0,signIn:!0},timeframes:{"1m":"1m","3m":"3m","5m":"5m","10m":"10m","15m":"15m","30m":"30m","1h":"1h","4h":"4h","6h":"6h","12h":"12h","1d":"1D","1w":"1W","1M":"1M"},version:"v1",urls:{logo:"https://user-images.githubusercontent.com/51840849/79268032-c4379480-7ea2-11ea-80b3-dd96bb29fd0d.jpg",api:{accounts:"https://accounts.probit.com",public:"https://api.probit.com/api/exchange",private:"https://api.probit.com/api/exchange"},www:"https://www.probit.com",doc:["https://docs-en.probit.com","https://docs-ko.probit.com"],fees:"https://support.probit.com/hc/en-us/articles/360020968611-Trading-Fees",referral:"https://www.probit.com/r/34608773"},api:{public:{get:["market","currency","currency_with_platform","time","ticker","order_book","trade","candle"]},private:{post:["new_order","cancel_order","withdrawal"],get:["balance","order","open_order","order_history","trade_history","deposit_address"]},accounts:{post:["token"]}},fees:{trading:{tierBased:!1,percentage:!0,maker:.002,taker:.002}},exceptions:{exact:{UNAUTHORIZED:h,INVALID_ARGUMENT:o,TRADING_UNAVAILABLE:a,NOT_ENOUGH_BALANCE:d,NOT_ALLOWED_COMBINATION:o,INVALID_ORDER:c,RATE_LIMIT_EXCEEDED:f,MARKET_UNAVAILABLE:a,INVALID_MARKET:m,MARKET_CLOSED:m,MARKET_NOT_FOUND:m,INVALID_CURRENCY:o,TOO_MANY_OPEN_ORDERS:p,DUPLICATE_ADDRESS:l}},requiredCredentials:{apiKey:!0,secret:!0},precisionMode:g,options:{createMarketBuyOrderRequiresPrice:!0,timeInForce:{limit:"gtc",market:"ioc"}},commonCurrencies:{AUTO:"Cube",BCC:"BCC",BTCBEAR:"BEAR",BTCBULL:"BULL",CBC:"CryptoBharatCoin",EPS:"Epanus",HBC:"Hybrid Bank Cash",ORC:"Oracle System",SOC:"Soda Coin",UNI:"UNICORN Token"}})}async fetchMarkets(e={}){const t=await this.publicGetMarket(e),s=this.safeValue(t,"data",[]),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"id"),a=this.safeString(t,"base_currency_id"),n=this.safeString(t,"quote_currency_id"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d=o+"/"+c,h=!this.safeValue(t,"closed",!1),u=this.safeString(t,"quantity_precision"),l=this.safeString(t,"cost_precision"),f=this.parsePrecision(u),p=this.parsePrecision(l),m={amount:this.parseNumber(f),price:this.safeNumber(t,"price_increment"),cost:this.parseNumber(p)},b=this.safeString(t,"taker_fee_rate"),g=y.stringDiv(b,"100"),v=this.safeString(t,"maker_fee_rate"),w=y.stringDiv(v,"100");i.push({id:r,info:t,symbol:d,base:o,quote:c,baseId:a,quoteId:n,active:h,precision:m,taker:this.parseNumber(g),maker:this.parseNumber(w),limits:{amount:{min:this.safeNumber(t,"min_quantity"),max:this.safeNumber(t,"max_quantity")},price:{min:this.safeNumber(t,"min_price"),max:this.safeNumber(t,"max_price")},cost:{min:this.safeNumber(t,"min_cost"),max:this.safeNumber(t,"max_cost")}}})}return i}async fetchCurrencies(e={}){const t=await this.publicGetCurrencyWithPlatform(e),s=this.safeValue(t,"data"),i={};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"id"),a=this.safeCurrencyCode(r),n=this.safeValue(t,"display_name"),o=this.safeString(n,"en-us"),c=this.safeValue(t,"platform",[]),d=this.sortBy(c,"priority"),h=this.safeValue(d,0,{}),u=this.safeInteger(h,"precision"),l=this.safeValue(h,"deposit_suspended"),f=this.safeValue(h,"withdrawal_suspended"),p=!(l&&f),m=this.safeValue(h,"withdrawal_fee",{}),b=[];for(let e=0;e<m.length;e++){const t=m[e],s=this.safeNumber(t,"amount"),i=this.safeInteger(t,"priority");void 0!==s&&void 0!==i&&b.push(t)}const g=this.sortBy(b,"priority"),y=this.safeValue(g,0,{}),v=this.safeNumber(y,"amount");i[a]={id:r,code:a,info:t,name:o,active:p,fee:v,precision:u,limits:{amount:{min:Math.pow(10,-u),max:Math.pow(10,u)},deposit:{min:this.safeNumber(h,"min_deposit_amount"),max:void 0},withdraw:{min:this.safeNumber(h,"min_withdrawal_amount"),max:void 0}}}}return i}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetBalance(e),s={info:t,timestamp:void 0,datetime:void 0},i=this.safeValue(t,"data");for(let e=0;e<i.length;e++){const t=i[e],r=this.safeString(t,"currency_id"),a=this.safeCurrencyCode(r),n=this.account();n.total=this.safeString(t,"total"),n.free=this.safeString(t,"available"),s[a]=n}return this.parseBalance(s,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={market_id:this.market(e).id},r=await this.publicGetOrderBook(this.extend(i,s)),a=this.safeValue(r,"data",[]),n=this.groupBy(a,"side");return this.parseOrderBook(n,e,void 0,"buy","sell","price","quantity")}async fetchTickers(e,t={}){await this.loadMarkets();const s={};if(void 0!==e){const t=this.marketIds(e);s.market_ids=t.join(",")}const i=await this.publicGetTicker(this.extend(s,t)),r=this.safeValue(i,"data",[]);return this.parseTickers(r,e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={market_ids:s.id},r=await this.publicGetTicker(this.extend(i,t)),a=this.safeValue(r,"data",[]),o=this.safeValue(a,0);if(void 0===o)throw new n(this.id+" fetchTicker() returned an empty response");return this.parseTicker(o,s)}parseTicker(e,t){const s=this.parse8601(this.safeString(e,"time")),i=this.safeString(e,"market_id"),r=this.safeSymbol(i,t,"-"),a=this.safeNumber(e,"last"),n=this.safeNumber(e,"change");let o,c;void 0!==n&&void 0!==a&&(c=a-n,o=n/c*100);const d=this.safeNumber(e,"base_volume"),h=this.safeNumber(e,"quote_volume"),u=this.vwap(d,h);return{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:void 0,bidVolume:void 0,ask:void 0,askVolume:void 0,vwap:u,open:c,close:a,last:a,previousClose:void 0,change:n,percentage:o,average:void 0,baseVolume:d,quoteVolume:h,info:e}}async fetchMyTrades(e,t,s,i={}){let r;await this.loadMarkets();const a={limit:100,start_time:this.iso8601(0),end_time:this.iso8601(this.milliseconds())};void 0!==e&&(r=this.market(e),a.market_id=r.id),void 0!==t&&(a.start_time=this.iso8601(t)),void 0!==s&&(a.limit=s);const n=await this.privateGetTradeHistory(this.extend(a,i)),o=this.safeValue(n,"data",[]);return this.parseTrades(o,r,t,s)}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={market_id:r.id,limit:100,start_time:"1970-01-01T00:00:00.000Z",end_time:this.iso8601(this.milliseconds())};void 0!==t&&(a.start_time=this.iso8601(t)),void 0!==s&&(a.limit=s);const n=await this.publicGetTrade(this.extend(a,i)),o=this.safeValue(n,"data",[]);return this.parseTrades(o,r,t,s)}parseTrade(e,t){const s=this.parse8601(this.safeString(e,"time")),i=this.safeString(e,"id");let r;if(void 0!==i){const e=i.split(":");r=this.safeString(e,0)}r=this.safeString(e,"market_id",r);const a=this.safeSymbol(r,t,"-"),n=this.safeString(e,"side"),o=this.safeString(e,"price"),c=this.safeString(e,"quantity"),d=this.parseNumber(o),h=this.parseNumber(c),u=this.parseNumber(y.stringMul(o,c)),l=this.safeString(e,"order_id"),f=this.safeNumber(e,"fee_amount");let p;if(void 0!==f){const t=this.safeString(e,"fee_currency_id");p={cost:f,currency:this.safeCurrencyCode(t)}}return{id:i,info:e,timestamp:s,datetime:this.iso8601(s),symbol:a,order:l,type:void 0,side:n,takerOrMaker:void 0,price:d,amount:h,cost:u,fee:p}}async fetchTime(e={}){const t=await this.publicGetTime(e);return this.parse8601(this.safeString(t,"data"))}normalizeOHLCVTimestamp(e,t,s=!1){const i=this.parseTimeframe(t);if("1M"===t){const t=this.iso8601(e).split("-"),i=this.safeString(t,0);let r=this.safeInteger(t,1);return s&&(r=this.sum(r,1)),r=r<10?"0"+r.toString():r.toString(),i+"-"+r+"-01T00:00:00.000Z"}if("1w"===t){const t=259200,r=(e=parseInt(e/1e3))-t,a=Math.floor(r/i);let n=this.sum(t,a*i);return s&&(n=this.sum(n,i)),this.iso8601(1e3*n)}return e=parseInt(e/1e3),e=i*parseInt(e/i),s&&(e=this.sum(e,i)),this.iso8601(1e3*e)}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n=this.timeframes[t];i=void 0===i?100:i;let o=this.sum(i,1);o=Math.min(1e3,o);const c={market_ids:a.id,interval:n,sort:"asc",limit:o},d=this.milliseconds(),h=this.parseTimeframe(t);let l=s,f=d;if(void 0===s){if(void 0===i)throw new u(this.id+" fetchOHLCV() requires either a since argument or a limit argument");l=d-i*h*1e3}else f=void 0===i?d:this.sum(s,this.sum(i,1)*h*1e3);const p=this.normalizeOHLCVTimestamp(l,t),m=this.normalizeOHLCVTimestamp(f,t,!0);c.start_time=p,c.end_time=m;const b=await this.publicGetCandle(this.extend(c,r)),g=this.safeValue(b,"data",[]);return this.parseOHLCVs(g,a,t,s,i)}parseOHLCV(e,t){return[this.parse8601(this.safeString(e,"start_time")),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"base_volume")]}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets(),t=this.parse8601(t);const r={};let a;void 0!==e&&(a=this.market(e),r.market_id=a.id);const n=await this.privateGetOpenOrder(this.extend(r,i)),o=this.safeValue(n,"data");return this.parseOrders(o,a,t,s)}async fetchClosedOrders(e,t,s,i={}){await this.loadMarkets();const r={start_time:this.iso8601(0),end_time:this.iso8601(this.milliseconds()),limit:100};let a;void 0!==e&&(a=this.market(e),r.market_id=a.id),t&&(r.start_time=this.iso8601(t)),s&&(r.limit=s);const n=await this.privateGetOrderHistory(this.extend(r,i)),o=this.safeValue(n,"data");return this.parseOrders(o,a,t,s)}async fetchOrder(e,t,s={}){if(void 0===t)throw new u(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={market_id:i.id},a=this.safeString2(s,"clientOrderId","client_order_id");void 0!==a?r.client_order_id=a:r.order_id=e;const n=this.omit(s,["clientOrderId","client_order_id"]),o=await this.privateGetOrder(this.extend(r,n)),c=this.safeValue(o,"data",[]),d=this.safeValue(c,0);return this.parseOrder(d,i)}parseOrderStatus(e){return this.safeString({open:"open",cancelled:"canceled",filled:"closed"},e,e)}parseOrder(e,t){const s=this.parseOrderStatus(this.safeString(e,"status")),i=this.safeString(e,"id"),r=this.safeString(e,"type"),a=this.safeString(e,"side"),n=this.safeString(e,"market_id"),o=this.safeSymbol(n,t,"-"),c=this.parse8601(this.safeString(e,"time"));let d=this.safeNumber(e,"limit_price");const h=this.safeNumber(e,"filled_quantity");let u=this.safeNumber(e,"open_quantity");const l=this.safeNumber(e,"cancelled_quantity");void 0!==l&&(u=this.sum(u,l));const f=this.safeNumber(e,"quantity",this.sum(h,u)),p=this.safeNumber2(e,"filled_cost","cost");"market"===r&&(d=void 0);let m=this.safeString(e,"client_order_id");""===m&&(m=void 0);const b=this.safeStringUpper(e,"time_in_force");return this.safeOrder({id:i,info:e,clientOrderId:m,timestamp:c,datetime:this.iso8601(c),lastTradeTimestamp:void 0,symbol:o,type:r,timeInForce:b,side:a,status:s,price:d,stopPrice:void 0,amount:f,filled:h,remaining:u,average:void 0,cost:p,fee:void 0,trades:void 0})}costToPrecision(e,t){return this.decimalToPrecision(t,b,this.markets[e].precision.cost,this.precisionMode)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o=this.safeValue(this.options,"timeInForce"),d=this.safeValue(o,t),h=this.safeString2(a,"timeInForce","time_in_force",d),u={market_id:n.id,type:t,side:s,time_in_force:h},l=this.safeString2(a,"clientOrderId","client_order_id");let f;if(void 0!==l&&(u.client_order_id=l),"limit"===t)u.limit_price=this.priceToPrecision(e,r),u.quantity=this.amountToPrecision(e,i);else if("market"===t)if("buy"===s){let t=this.safeNumber(a,"cost");if(this.safeValue(this.options,"createMarketBuyOrderRequiresPrice",!0)){if(void 0!==r)void 0===t&&(t=i*r);else if(void 0===t)throw new c(this.id+" createOrder() requires the price argument for market buy orders to calculate total order cost (amount to spend), where cost = amount * price. Supply a price argument to createOrder() call if you want the cost to be calculated for you from price and amount, or, alternatively, add .options['createMarketBuyOrderRequiresPrice'] = false and supply the total cost value in the 'amount' argument or in the 'cost' extra parameter (the exchange-specific behaviour)")}else t=void 0===t?i:t;f=this.costToPrecision(e,t),u.cost=f}else u.quantity=this.amountToPrecision(e,i);const p=this.omit(a,["timeInForce","time_in_force","clientOrderId","client_order_id"]),m=await this.privatePostNewOrder(this.extend(u,p)),b=this.safeValue(m,"data"),g=this.parseOrder(b,n);return"market"===t&&"buy"===s&&(g.amount=void 0,g.cost=parseFloat(f),g.remaining=void 0),g}async cancelOrder(e,t,s={}){if(void 0===t)throw new u(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const i={market_id:this.market(t).id,order_id:e},r=await this.privatePostCancelOrder(this.extend(i,s)),a=this.safeValue(r,"data");return this.parseOrder(a)}parseDepositAddress(e,t){const s=this.safeString(e,"address"),i=this.safeString(e,"destination_tag"),r=this.safeString(e,"currency_id"),a=this.safeCurrencyCode(r);return this.checkAddress(s),{currency:a,address:s,tag:i,info:e}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e),i={currency_id:s.id},r=await this.privateGetDepositAddress(this.extend(i,t)),a=this.safeValue(r,"data",[]),n=this.safeValue(a,0);if(void 0===n)throw new l(this.id+" fetchDepositAddress returned an empty response");return this.parseDepositAddress(n,s)}async fetchDepositAddresses(e,t={}){await this.loadMarkets();const s={};if(e){const t=[];for(let s=0;s<e.length;s++){const i=this.currency(e[s]);t.push(i.id)}s.currency_id=e.join(",")}const i=await this.privateGetDepositAddress(this.extend(s,t)),r=this.safeValue(i,"data",[]);return this.parseDepositAddresses(r)}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a=this.currency(e);void 0===i&&(i="");const n={currency_id:a.id,address:s,destination_tag:i,amount:this.currencyToPrecision(e,t)},o=await this.privatePostWithdrawal(this.extend(n,r)),c=this.safeValue(o,"data");return this.parseTransaction(c,a)}parseTransaction(e,t){const s=this.safeString(e,"id"),i=this.safeNumber(e,"amount"),r=this.safeString(e,"address"),a=this.safeString(e,"destination_tag"),n=this.safeString(e,"hash"),o=this.parse8601(this.safeString(e,"time")),c=this.safeString(e,"type"),d=this.safeString(e,"currency_id"),h=this.safeCurrencyCode(d),u=this.parseTransactionStatus(this.safeString(e,"status")),l=this.safeNumber(e,"fee");let f;return void 0!==l&&0!==l&&(f={currency:h,cost:l}),{id:s,currency:h,amount:i,addressFrom:void 0,address:r,addressTo:r,tagFrom:void 0,tag:a,tagTo:a,status:u,type:c,txid:n,timestamp:o,datetime:this.iso8601(o),fee:f,info:e}}parseTransactionStatus(e){return this.safeString({requested:"pending",pending:"pending",confirming:"pending",confirmed:"pending",applying:"pending",done:"ok",cancelled:"canceled",cancelling:"canceled"},e,e)}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t]+"/";const o=this.omit(i,this.extractParams(e));if("accounts"===t){this.checkRequiredCredentials(),n+=this.implodeParams(e,i);const t=this.apiKey+":"+this.secret,s=this.stringToBase64(t);r={Authorization:"Basic "+this.decode(s),"Content-Type":"application/json"},Object.keys(o).length&&(a=this.json(o))}else if(n+=this.version+"/","public"===t)n+=this.implodeParams(e,i),Object.keys(o).length&&(n+="?"+this.urlencode(o));else if("private"===t){const t=this.milliseconds();this.checkRequiredCredentials();const c=this.safeInteger(this.options,"expires");if(void 0===c||c<t)throw new h(this.id+" access token expired, call signIn() method");r={Authorization:"Bearer "+this.safeString(this.options,"accessToken")},n+=this.implodeParams(e,i),"GET"===s?Object.keys(o).length&&(n+="?"+this.urlencode(o)):Object.keys(o).length&&(a=this.json(o),r["Content-Type"]="application/json")}return{url:n,method:s,body:a,headers:r}}async signIn(e={}){this.checkRequiredCredentials();const t=await this.accountsPostToken(this.extend({grant_type:"client_credentials"},e)),s=this.safeInteger(t,"expires_in"),i=this.safeString(t,"access_token");return this.options.accessToken=i,this.options.expires=this.sum(this.milliseconds(),1e3*s),t}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0!==o&&"errorCode"in o){const e=this.safeString(o,"errorCode"),t=this.safeString(o,"message");if(void 0!==e){const s=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,t,s),this.throwBroadlyMatchedException(this.exceptions.exact,e,s),new r(s)}}}}},2715:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,InvalidOrder:a,InsufficientFunds:n,AuthenticationError:o,RateLimitExceeded:c,BadSymbol:d}=s(3449),h=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"qtrade",name:"qTrade",countries:["US"],rateLimit:1e3,version:"v1",urls:{logo:"https://user-images.githubusercontent.com/51840849/80491487-74a99c00-896b-11ea-821e-d307e832f13e.jpg",api:"https://api.qtrade.io",www:"https://qtrade.io",doc:"https://qtrade-exchange.github.io/qtrade-docs",referral:"https://qtrade.io/?ref=BKOQWVFGRH2C"},has:{CORS:!1,fetchTrades:!0,fetchTicker:!0,fetchTickers:!0,fetchMarkets:!0,fetchCurrencies:!0,fetchBalance:!0,fetchOrderBook:!0,fetchOrder:!0,fetchOrders:!0,fetchMyTrades:!0,fetchClosedOrders:!0,fetchOpenOrders:!0,fetchOHLCV:!0,createOrder:!0,cancelOrder:!0,createMarketOrder:!1,withdraw:!0,fetchDepositAddress:!0,fetchTransactions:!1,fetchDeposits:!0,fetchWithdrawals:!0,fetchDeposit:!0,fetchWithdrawal:!0},timeframes:{"5m":"fivemin","15m":"fifteenmin","30m":"thirtymin","1h":"onehour","2h":"twohour","4h":"fourhour","1d":"oneday"},api:{public:{get:["ticker/{market_string}","tickers","currency/{code}","currencies","common","market/{market_string}","markets","market/{market_string}/trades","orderbook/{market_string}","market/{market_string}/ohlcv/{interval}"]},private:{get:["me","balances","balances_all","market/{market_string}","orders","order/{order_id}","trades","withdraw/{withdraw_id}","withdraws","deposit/{deposit_id}","deposits","transfers"],post:["cancel_order","withdraw","deposit_address/{currency}","sell_limit","buy_limit"]}},fees:{trading:{tierBased:!0,percentage:!0,taker:.0025,maker:0},funding:{withdraw:{}}},exceptions:{exact:{invalid_auth:o,insuff_funds:n,market_not_found:d,too_small:a,limit_exceeded:c}}})}async fetchMarkets(e={}){const t=await this.publicGetMarkets(e),s=this.safeValue(t,"data",{}),i=this.safeValue(s,"markets",[]),r=[];for(let e=0;e<i.length;e++){const t=i[e],s=this.safeString(t,"market_string"),a=this.safeInteger(t,"id"),n=this.safeString(t,"market_currency"),o=this.safeString(t,"base_currency"),c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o),h=c+"/"+d,u={amount:this.safeInteger(t,"market_precision"),price:this.safeInteger(t,"base_precision")},l=this.safeValue(t,"can_view",!1),f=this.safeValue(t,"can_trade",!1)&&l;r.push({symbol:h,id:s,numericId:a,baseId:n,quoteId:o,base:c,quote:d,active:f,precision:u,taker:this.safeNumber(t,"taker_fee"),maker:this.safeNumber(t,"maker_fee"),limits:{amount:{min:this.safeNumber(t,"minimum_sell_value"),max:void 0},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(t,"minimum_buy_value"),max:void 0}},info:t})}return r}async fetchCurrencies(e={}){const t=await this.publicGetCurrencies(e),s=this.safeValue(t,"data",{}),i=this.safeValue(s,"currencies",[]),r={};for(let e=0;e<i.length;e++){const t=i[e],s=this.safeString(t,"code"),a=this.safeCurrencyCode(s),n=this.safeString(t,"long_name"),o=this.safeString(t,"type"),c=this.safeValue(t,"can_withdraw",!0),d=this.safeValue(t,"deposit_disabled",!1),h=this.safeValue(t,"config",{}),u=this.safeString(t,"status"),l=c&&"ok"===u&&!d;r[a]={id:s,code:a,info:t,type:o,name:n,fee:this.safeNumber(h,"withdraw_fee"),precision:this.safeInteger(t,"precision"),active:l,limits:{amount:{min:this.safeNumber(t,"minimum_order"),max:void 0},withdraw:{min:void 0,max:void 0}}}}return r}parseOHLCV(e,t){return[this.parse8601(this.safeString(e,"time")),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"market_volume")]}async fetchOHLCV(e,t="5m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={market_string:a.id,interval:this.timeframes[t]},o=await this.publicGetMarketMarketStringOhlcvInterval(this.extend(n,r)),c=this.safeValue(o,"data",{}),d=this.safeValue(c,"slices",[]);return this.parseOHLCVs(d,a,t,s,i)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={market_string:this.marketId(e)},r=await this.publicGetOrderbookMarketString(this.extend(i,s)),a=this.safeValue(r,"data",{}),n={},o={buy:"bids",sell:"asks"},c=Object.keys(o);for(let e=0;e<c.length;e++){const t=c[e],s=o[t],i=this.safeValue(a,t,{}),r=Object.keys(i),d=[];for(let e=0;e<r.length;e++){const t=r[e],s=this.safeNumber(r,e),a=this.safeNumber(i,t);d.push([s,a])}n[s]=d}const d=this.safeIntegerProduct(a,"last_change",.001);return this.parseOrderBook(n,e,d)}parseTicker(e,t){const s=this.safeString(e,"id_hr"),i=this.safeSymbol(s,t,"_"),r=this.safeIntegerProduct(e,"last_change",.001),a=this.safeNumber(e,"day_open"),n=this.safeNumber(e,"last"),o=this.safeNumber(e,"day_change");let c,d,h=this.safeNumber(e,"day_avg_price");void 0!==o&&(c=100*o,void 0!==a&&(d=o*a)),void 0===h&&void 0!==n&&void 0!==a&&(h=this.sum(n,a)/2);const u=this.safeNumber(e,"day_volume_market"),l=this.safeNumber(e,"day_volume_base"),f=this.vwap(u,l);return{symbol:i,timestamp:r,datetime:this.iso8601(r),high:this.safeNumber(e,"day_high"),low:this.safeNumber(e,"day_low"),bid:this.safeNumber(e,"bid"),bidVolume:void 0,ask:this.safeNumber(e,"ask"),askVolume:void 0,vwap:f,open:a,close:n,last:n,previousClose:void 0,change:d,percentage:c,average:h,baseVolume:u,quoteVolume:l,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTickers(t),i=this.safeValue(s,"data",{}),r=this.safeValue(i,"markets",[]),a={};for(let e=0;e<r.length;e++){const t=this.parseTicker(r[e]);a[t.symbol]=t}return this.filterByArray(a,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={market_string:s.id},r=await this.publicGetTickerMarketString(this.extend(i,t)),a=this.safeValue(r,"data",{});return this.parseTicker(a,s)}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={market_string:r.id},n=await this.publicGetMarketMarketStringTrades(this.extend(a,i)),o=this.safeValue(n,"data",{}),c=this.safeValue(o,"trades",[]);return this.parseTrades(c,r,t,s)}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={desc:!0};let a;const n=this.safeValue(i,"market_id");void 0!==n?r.market_id=n:void 0!==e&&(a=this.market(e),r.market_string=a.id);const o=await this.privateGetTrades(this.extend(r,i)),c=this.safeValue(o,"data",{}),d=this.safeValue(c,"trades",[]);return this.parseTrades(d,a,t,s)}parseTrade(e,t){const s=this.safeString(e,"id");let i=this.safeIntegerProduct(e,"created_at_ts",.001);void 0===i&&(i=this.parse8601(this.safeString(e,"created_at")));const r=this.safeString(e,"side"),a=this.safeString(e,"market_string"),n=this.safeSymbol(a,t,"_");let o=this.safeNumber2(e,"base_volume","base_amount");const c=this.safeString(e,"price"),d=this.safeString2(e,"market_amount","amount"),u=this.parseNumber(c),l=this.parseNumber(d);let f;void 0===o&&(o=this.parseNumber(h.stringMul(c,d)));const p=this.safeNumber(e,"base_fee");if(void 0!==p){f={currency:void 0===t?void 0:t.quote,cost:p}}const m=this.safeValue(e,"taker",!0)?"taker":"maker",b=this.safeString(e,"order_id");return{id:s,info:e,timestamp:i,datetime:this.iso8601(i),symbol:n,order:b,type:void 0,side:r,takerOrMaker:m,price:u,amount:l,cost:o,fee:f}}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetBalancesAll(e),s=this.safeValue(t,"data",{});let i=this.safeValue(s,"balances",[]);const r={info:t,timestamp:void 0,datetime:void 0};for(let e=0;e<i.length;e++){const t=i[e],s=this.safeString(t,"currency"),a=this.safeCurrencyCode(s),n=a in r?r[a]:this.account();n.free=this.safeString(t,"balance"),n.used="0",r[a]=n}i=this.safeValue(s,"order_balances",[]);for(let e=0;e<i.length;e++){const t=i[e],s=this.safeString(t,"currency"),a=this.safeCurrencyCode(s),n=a in r?r[a]:this.account();n.used=this.safeString(t,"balance"),r[a]=n}return this.parseBalance(r,!1)}async createOrder(e,t,s,i,r,n={}){if("limit"!==t)throw new a(this.id+" createOrder() allows limit orders only");await this.loadMarkets();const o=this.market(e),c={amount:this.amountToPrecision(e,i),market_id:o.numericId,price:this.priceToPrecision(e,r)},d="sell"===s?"privatePostSellLimit":"privatePostBuyLimit",h=await this[d](this.extend(c,n)),u=this.safeValue(h,"data",{}),l=this.safeValue(u,"order",{});return this.parseOrder(l,o)}parseOrder(e,t){const s=this.safeString(e,"id"),i=this.parse8601(this.safeString(e,"created_at")),r=this.safeString(e,"order_type");let a,n;if(void 0!==r){const e=r.split("_");n=this.safeString(e,0),a=this.safeString(e,1)}const o=this.safeNumber(e,"price"),c=this.safeNumber(e,"market_amount"),d=this.safeNumber(e,"market_amount_remaining"),h=this.safeValue(e,"open",!1),u=this.safeString(e,"close_reason");let l;l=h?"open":"canceled"===u?"canceled":"closed";const f=this.safeString(e,"market_string"),p=(t=this.safeMarket(f,t,"_")).symbol,m=this.safeValue(e,"trades",[]),b=this.parseTrades(m,t,void 0,void 0,{order:s,side:n,type:a});return this.safeOrder({info:e,id:s,clientOrderId:void 0,timestamp:i,datetime:this.iso8601(i),lastTradeTimestamp:void 0,symbol:p,type:a,timeInForce:void 0,postOnly:void 0,side:n,price:o,stopPrice:void 0,average:void 0,amount:c,remaining:d,filled:void 0,status:l,fee:void 0,fees:void 0,cost:void 0,trades:b})}async cancelOrder(e,t,s={}){const i={id:parseInt(e)};return await this.privatePostCancelOrder(this.extend(i,s))}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={order_id:e},r=await this.privateGetOrderOrderId(this.extend(i,s)),a=this.safeValue(r,"data",{}),n=this.safeValue(a,"order",{});return this.parseOrder(n)}async fetchOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a;const n=this.safeValue(i,"market_id");void 0!==n?r.market_id=n:void 0!==e&&(a=this.market(e),r.market_string=a.id);const o=await this.privateGetOrders(this.extend(r,i)),c=this.safeValue(o,"data",{}),d=this.safeValue(c,"orders",[]);return this.parseOrders(d,a,t,s)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({open:!0},i))}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({open:!1},i))}parseDepositAddress(e,t){const s=void 0===t?void 0:t.code;let i,r=this.safeString(e,"address");if(void 0!==r){const e=r.split(":");r=this.safeString(e,0),i=this.safeString(e,1)}return this.checkAddress(r),{currency:s,address:r,tag:i,info:e}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e),i={currency:s.id},r=await this.privatePostDepositAddressCurrency(this.extend(i,t)),a=this.safeValue(r,"data",{});return this.parseDepositAddress(a,s)}async fetchDeposit(e,t,s={}){await this.loadMarkets();const i={deposit_id:e},r=await this.privateGetDepositDepositId(this.extend(i,s)),a=this.safeValue(r,"data",{}),n=this.safeValue(a,"deposit",{});return this.parseTransaction(n)}async fetchDeposits(e,t,s,i={}){let r;await this.loadMarkets(),void 0!==e&&(r=this.currency(e));const a=await this.privateGetDeposits(i),n=this.safeValue(a,"data",{}),o=this.safeValue(n,"deposits",[]);return this.parseTransactions(o,r,t,s)}async fetchWithdrawal(e,t,s={}){await this.loadMarkets();const i={withdraw_id:e},r=await this.privateGetWithdrawWithdrawId(this.extend(i,s)),a=this.safeValue(r,"data",{}),n=this.safeValue(a,"withdraw",{});return this.parseTransaction(n)}async fetchWithdrawals(e,t,s,i={}){let r;await this.loadMarkets(),void 0!==e&&(r=this.currency(e));const a=await this.privateGetWithdraws(i),n=this.safeValue(a,"data",{}),o=this.safeValue(n,"withdraws",[]);return this.parseTransactions(o,r,t,s)}parseTransaction(e,t){const s=this.parse8601(this.safeString(e,"created_at")),i=this.safeString(e,"id"),r=this.safeValue(e,"network_data",{}),a=this.safeValue(r,"unsigned_tx",{}),n=this.safeString(a,"from"),o=this.safeString(r,"txid");let c,d=this.safeString(e,"address");if(void 0!==d){const e=d.split(":");e.length>1&&(d=this.safeString(e,0),c=this.safeString(e,1))}const h=d,u=c,l=this.safeValue(e,"cancel_requested"),f=void 0===l?"deposit":"withdrawal",p=this.safeNumber(e,"amount"),m=this.safeString(e,"currency"),b=this.safeCurrencyCode(m);let g=this.parseTransactionStatus(this.safeString(e,"status"));const y=this.safeString(e,"code");l?g="canceled":void 0===g&&(g=this.parseTransactionStatus(y));return{info:e,id:i,txid:o,timestamp:s,datetime:this.iso8601(s),addressFrom:n,addressTo:h,address:d,tagFrom:undefined,tagTo:u,tag:c,type:f,amount:p,currency:b,status:g,updated:void 0,fee:undefined}}parseTransactionStatus(e){return this.safeString({initiated:"pending",needs_create:"pending",credited:"ok",confirmed:"ok"},e,e)}async withdraw(e,t,s,i,r={}){await this.loadMarkets();const a={address:s,amount:t,currency:this.currency(e).id};void 0!==i&&(a.address+=":"+i);const n=await this.privatePostWithdraw(this.extend(a,r)),o=this.safeValue(n,"data",{}),c=this.parseTransaction(o);return this.extend(c,{currency:e,address:s,addressTo:s,tag:i,tagTo:i,amount:t})}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n="/"+this.version+"/";"private"===t&&(n+="user/"),n+=this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if("POST"===s?a=this.json(o):Object.keys(o).length&&(n+="?"+this.urlencode(o)),"private"===t){const e=this.milliseconds().toString(),t=[s,n,e,"POST"===s?a:"",this.secret].join("\n"),i=this.hash(this.encode(t),"sha256","base64");let o=this.apiKey;"string"!=typeof o&&(o=o.toString());r={Authorization:"HMAC-SHA256 "+o+":"+i,"HMAC-Timestamp":e},"POST"===s&&(r["Content-Type"]="application/json")}return n=this.urls.api+n,{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0===o)return;const h=this.safeValue(o,"errors",[]);if(h.length<1)return;const u=this.id+" "+n;for(let e=0;e<h.length;e++){const t=h[e],s=this.safeString(t,"code");this.throwExactlyMatchedException(this.exceptions.exact,s,u)}throw new r(u)}}},2041:(e,t,s)=>{"use strict";const i=s(8819),{AuthenticationError:r,ExchangeError:a,BadSymbol:n,BadRequest:o,InvalidOrder:c,ArgumentsRequired:d,OrderNotFound:h,InsufficientFunds:u,DDoSProtection:l}=s(3449),{TICK_SIZE:f}=s(2115),p=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"ripio",name:"Ripio",countries:["AR","BR"],rateLimit:50,version:"v1",pro:!0,has:{CORS:!1,cancelOrder:!0,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchMyTrades:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/94507548-a83d6a80-0218-11eb-9998-28b9cec54165.jpg",api:{public:"https://api.exchange.ripio.com/api",private:"https://api.exchange.ripio.com/api"},www:"https://exchange.ripio.com",doc:["https://exchange.ripio.com/en/api/"],fees:"https://exchange.ripio.com/en/fee"},api:{public:{get:["rate/all/","rate/{pair}/","orderbook/{pair}/","tradehistory/{pair}/","pair/","currency/","orderbook/{pair}/depth/"]},private:{get:["balances/exchange_balances/","order/{pair}/{order_id}/","order/{pair}/","trade/{pair}/"],post:["order/{pair}/","order/{pair}/{order_id}/cancel/"]}},fees:{trading:{tierBased:!0,percentage:!0,taker:0,maker:0}},precisionMode:f,requiredCredentials:{apiKey:!0,secret:!1},exceptions:{exact:{},broad:{"Authentication credentials were not provided":r,"Disabled pair":n,"Invalid order type":c,"Your balance is not enough":u,"Order couldn't be created":a,"not found":h,"Invalid pair":n,"amount must be a number":o,"Total must be at least":c,"Account not found":o,"Wrong password provided":r,"User tokens limit":l,"Something unexpected ocurred":a,account_balance:o}}})}async fetchMarkets(e={}){const t=await this.publicGetPair(e),s=[],i=this.safeValue(t,"results",[]);for(let e=0;e<i.length;e++){const t=i[e],r=this.safeString(t,"base"),a=this.safeString(t,"quote"),n=this.safeString(t,"symbol"),o=this.safeCurrencyCode(r),c=this.safeCurrencyCode(a),d=o+"/"+c,h={amount:this.safeNumber(t,"min_amount"),price:this.safeNumber(t,"price_tick")},u={amount:{min:this.safeNumber(t,"min_amount"),max:void 0},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(t,"min_value"),max:void 0}},l=this.safeValue(t,"enabled",!0),f=this.safeValue(t,"fees",[]),p=this.safeValue(f,0,{}),m=this.safeNumber(p,"maker_fee",0),b=this.safeNumber(p,"taker_fee",0);s.push({id:n,symbol:d,base:o,quote:c,baseId:r,quoteId:a,precision:h,maker:m,taker:b,limits:u,info:t,active:l})}return s}async fetchCurrencies(e={}){const t=await this.publicGetCurrency(e),s=this.safeValue(t,"results",[]),i={};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"currency"),a=this.safeCurrencyCode(r),n=this.safeString(t,"name"),o=this.safeValue(t,"enabled",!0),c=this.safeInteger(t,"decimal_places");i[a]={id:r,code:a,name:n,info:t,active:o,fee:void 0,precision:c,limits:{amount:{min:void 0,max:void 0},withdraw:{min:void 0,max:void 0}}}}return i}parseTicker(e,t){const s=this.parse8601(this.safeString(e,"created_at")),i=this.safeString(e,"pair"),r=this.safeSymbol(i,t),a=this.safeNumber(e,"last_price"),n=this.safeNumber(e,"avg");return{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"bid"),bidVolume:this.safeNumber(e,"bid_volume"),ask:this.safeNumber(e,"ask"),askVolume:this.safeNumber(e,"ask_volume"),vwap:void 0,open:void 0,close:a,last:a,previousClose:void 0,change:void 0,percentage:void 0,average:n,baseVolume:void 0,quoteVolume:void 0,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={pair:s.id},r=await this.publicGetRatePair(this.extend(i,t));return this.parseTicker(r,s)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetRateAll(t),i={};for(let e=0;e<s.length;e++){const t=this.parseTicker(s[e]);i[t.symbol]=t}return this.filterByArray(i,"symbol",e)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={pair:this.marketId(e)},r=await this.publicGetOrderbookPair(this.extend(i,s)),a=this.parseOrderBook(r,e,void 0,"buy","sell","price","amount");return a.nonce=this.safeInteger(r,"updated_id"),a}parseTrade(e,t){const s=this.safeString(e,"id");let i=this.safeInteger(e,"timestamp");i=this.safeTimestamp(e,"created_at",i);let r=this.safeString(e,"side");const a=this.safeString(e,"taker_side")===r?"taker":"maker";void 0!==r&&(r=r.toLowerCase());const n=this.safeString2(e,"price","match_price"),o=this.safeString2(e,"amount","exchanged"),c=this.parseNumber(n),d=this.parseNumber(o),h=this.parseNumber(p.stringMul(n,o)),u=this.safeString(e,"pair");t=this.safeMarket(u,t);const l=this.safeNumber(e,a+"_fee"),f=this.safeString(e,a);let m;return void 0!==l&&(m={cost:l,currency:"buy"===r?t.base:t.quote}),{id:s,order:f,timestamp:i,datetime:this.iso8601(i),symbol:t.symbol,type:void 0,side:r,price:c,amount:d,cost:h,takerOrMaker:a,fee:m,info:e}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={pair:r.id},n=await this.publicGetTradehistoryPair(this.extend(a,i));return this.parseTrades(n,r,t,s)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetBalancesExchangeBalances(e),s={info:t};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"symbol"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(i,"available"),n.used=this.safeString(i,"locked"),s[a]=n}return this.parseBalance(s,!1)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o=t.toUpperCase(),c=s.toUpperCase(),d={pair:n.id,order_type:o,side:c,amount:this.amountToPrecision(e,i)};"LIMIT"===o&&(d.limit_price=this.priceToPrecision(e,r));const h=await this.privatePostOrderPair(this.extend(d,a));return this.parseOrder(h,n)}async cancelOrder(e,t,s={}){if(void 0===t)throw new d(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={pair:i.id,order_id:e},a=await this.privatePostOrderPairOrderIdCancel(this.extend(r,s));return this.parseOrder(a,i)}async fetchOrder(e,t,s={}){if(void 0===t)throw new d(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const i=this.market(t),r={pair:i.id,order_id:e},a=await this.privateGetOrderPairOrderId(this.extend(r,s));return this.parseOrder(a,i)}async fetchOrders(e,t,s,i={}){if(void 0===e)throw new d(this.id+" fetchOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a={pair:r.id};void 0!==s&&(a.offset=s);const n=await this.privateGetOrderPair(this.extend(a,i)),o=this.safeValue(n,"results",{}),c=this.safeValue(o,"data",[]);return this.parseOrders(c,r,t,s)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({status:"OPEN,PART"},i))}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({status:"CLOS,CANC,COMP"},i))}parseOrderStatus(e){return this.safeString({OPEN:"open",PART:"open",CLOS:"canceled",CANC:"canceled",COMP:"closed"},e,e)}parseOrder(e,t){const s=this.safeString(e,"order_id"),i=this.safeNumber(e,"amount");let r=this.safeNumber(e,"notional");const a=this.safeStringLower(e,"order_type"),n="market"===a?"fill_price":"limit_price",o=this.safeNumber(e,n),c=this.safeStringLower(e,"side"),d=this.parseOrderStatus(this.safeString(e,"status")),h=this.safeTimestamp(e,"created_at");let u,l=this.safeValue(e,"fill_price"),f=this.safeNumber(e,"filled");const p=this.safeValue(e,"fills");let m,b;if(void 0!==p){if(p.length>0){f=0,r=0,m=this.parseTrades(p,t,void 0,void 0,{order:s,side:c});for(let e=0;e<m.length;e++){const t=m[e];f=this.sum(t.amount,f),r=this.sum(t.cost,r),b=t.timestamp}void 0===l&&f>0&&(l=r/f)}}void 0!==f&&(void 0===r&&void 0!==o&&(r=o*f),void 0!==i&&(u=Math.max(0,i-f)));const g=this.safeString(e,"pair"),y=this.safeSymbol(g,t,"_"),v=this.safeNumber(e,"stop_price");return{id:s,clientOrderId:void 0,info:e,timestamp:h,datetime:this.iso8601(h),lastTradeTimestamp:b,symbol:y,type:a,timeInForce:void 0,postOnly:void 0,side:c,price:o,stopPrice:v,amount:i,cost:r,average:l,filled:f,remaining:u,status:d,fee:void 0,trades:m}}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new d(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a={pair:r.id};void 0!==s&&(a.limit=s);const n=await this.privateGetTradePair(this.extend(a,i)),o=this.safeValue(n,"results",{}),c=this.safeValue(o,"data",[]);return this.parseTrades(c,r,t,s)}sign(e,t="public",s="GET",i={},r,a){const n="/"+this.version+"/"+this.implodeParams(e,i);let o=this.urls.api[t]+n;const c=this.omit(i,this.extractParams(e));return"public"===t?Object.keys(c).length&&(o+="?"+this.urlencode(c)):"private"===t&&(this.checkRequiredCredentials(),"POST"===s?a=this.json(c):Object.keys(c).length&&(o+="?"+this.urlencode(c)),r={"Content-Type":"application/json",Authorization:"Bearer "+this.apiKey}),{url:o,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,n,o,c,d){if(void 0===o)return;const h=this.safeString(o,"detail");if(void 0!==h){const e=this.id+" "+n;this.throwBroadlyMatchedException(this.exceptions.broad,h,e)}const u=this.safeValue(o,"errors");if(void 0!==u){const e=this.id+" "+n,t=Object.keys(u);for(let s=0;s<t.length;s++){const i=t[s],r=this.safeValue(u,i,[]),a=this.safeString(r,0);this.throwBroadlyMatchedException(this.exceptions.broad,a,e)}throw new a(e)}}}},8405:(e,t,s)=>{"use strict";const i=s(8819),{ArgumentsRequired:r}=s(3449),a=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"southxchange",name:"SouthXchange",countries:["AR"],rateLimit:1e3,has:{cancelOrder:!0,CORS:!0,createDepositAddress:!0,createOrder:!0,fetchBalance:!0,fetchDeposits:!0,fetchLedger:!0,fetchMarkets:!0,fetchOpenOrders:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTransactions:!0,fetchWithdrawals:!0,withdraw:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/27838912-4f94ec8a-60f6-11e7-9e5d-bbf9bd50a559.jpg",api:"https://www.southxchange.com/api",www:"https://www.southxchange.com",doc:"https://www.southxchange.com/Home/Api"},api:{public:{get:["markets","price/{symbol}","prices","book/{symbol}","trades/{symbol}"]},private:{post:["cancelMarketOrders","cancelOrder","getOrder","generatenewaddress","listOrders","listBalances","listTransactions","placeOrder","withdraw"]}},fees:{trading:{tierBased:!1,percentage:!0,maker:.001,taker:.003}},commonCurrencies:{BHD:"Bithold",GHOST:"GHOSTPRISM",MTC:"Marinecoin",SMT:"SmartNode"}})}async fetchMarkets(e={}){const t=await this.publicGetMarkets(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=i[0],a=i[1],n=this.safeCurrencyCode(r),o=this.safeCurrencyCode(a),c=n+"/"+o,d=r+"/"+a;s.push({id:d,symbol:c,base:n,quote:o,baseId:r,quoteId:a,active:void 0,info:i,precision:this.precision,limits:this.limits})}return s}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostListBalances(e),s={info:t};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"Currency"),n=this.safeCurrencyCode(r),o=this.safeString(i,"Deposited"),c=this.safeString(i,"Unconfirmed"),d=this.account();d.free=this.safeString(i,"Available"),d.total=a.stringAdd(o,c),s[n]=d}return this.parseBalance(s,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.marketId(e)},r=await this.publicGetBookSymbol(this.extend(i,s));return this.parseOrderBook(r,e,void 0,"BuyOrders","SellOrders","Price","Amount")}parseTicker(e,t){const s=this.milliseconds();let i;t&&(i=t.symbol);const r=this.safeNumber(e,"Last");return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:void 0,low:void 0,bid:this.safeNumber(e,"Bid"),bidVolume:void 0,ask:this.safeNumber(e,"Ask"),askVolume:void 0,vwap:void 0,open:void 0,close:r,last:r,previousClose:void 0,change:void 0,percentage:this.safeNumber(e,"Variation24Hr"),average:void 0,baseVolume:this.safeNumber(e,"Volume24Hr"),quoteVolume:void 0,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetPrices(t),i=this.indexBy(s,"Market"),r=Object.keys(i),a={};for(let e=0;e<r.length;e++){const t=r[e],s=this.safeMarket(t),n=s.symbol,o=i[t];a[n]=this.parseTicker(o,s)}return this.filterByArray(a,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={symbol:s.id},r=await this.publicGetPriceSymbol(this.extend(i,t));return this.parseTicker(r,s)}parseTrade(e,t){const s=this.safeTimestamp(e,"At"),i=this.safeString(e,"Price"),r=this.safeString(e,"Amount"),n=this.parseNumber(i),o=this.parseNumber(r),c=this.parseNumber(a.stringMul(i,r)),d=this.safeString(e,"Type");let h;return void 0!==t&&(h=t.symbol),{info:e,timestamp:s,datetime:this.iso8601(s),symbol:h,id:void 0,order:void 0,type:void 0,side:d,price:n,takerOrMaker:void 0,amount:o,cost:c,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id},n=await this.publicGetTradesSymbol(this.extend(a,i));return this.parseTrades(n,r,t,s)}parseOrder(e,t){const s=this.safeString(e,"ListingCurrency"),i=this.safeString(e,"ReferenceCurrency"),r=this.safeCurrencyCode(s)+"/"+this.safeCurrencyCode(i),a=void 0,n=this.safeNumber(e,"LimitPrice"),o=this.safeNumber(e,"OriginalAmount"),c=this.safeNumber(e,"Amount"),d=this.safeStringLower(e,"Type"),h=this.safeString(e,"Code");return this.safeOrder({info:e,id:h,clientOrderId:void 0,timestamp:a,datetime:this.iso8601(a),lastTradeTimestamp:void 0,symbol:r,type:"limit",timeInForce:void 0,postOnly:void 0,side:d,price:n,stopPrice:void 0,amount:o,cost:void 0,filled:void 0,remaining:c,status:"open",fee:void 0,average:void 0,trades:void 0})}async fetchOpenOrders(e,t,s,i={}){let r;await this.loadMarkets(),void 0!==e&&(r=this.market(e));const a=await this.privatePostListOrders(i);return this.parseOrders(a,r,t,s)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o={listingCurrency:n.base,referenceCurrency:n.quote,type:s,amount:i};"limit"===t&&(o.limitPrice=r);const c=await this.privatePostPlaceOrder(this.extend(o,a));return{info:c,id:JSON.parse(c)}}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={orderCode:e};return await this.privatePostCancelOrder(this.extend(i,s))}async createDepositAddress(e,t={}){await this.loadMarkets();const s={currency:this.currency(e).id},i=await this.privatePostGeneratenewaddress(this.extend(s,t));let r=i;'"'===r[0]&&(r=JSON.parse(r),'"'===r[0]&&(r=JSON.parse(r)));const a=r.split("|"),n=a.length;let o;return r=a[0],this.checkAddress(r),n>1&&(o=a[1]),{currency:e,address:r,tag:o,info:i}}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a={currency:this.currency(e).id,address:s,amount:t};void 0!==i&&(a.address=s+"|"+i);return{info:await this.privatePostWithdraw(this.extend(a,r)),id:void 0}}parseLedgerEntryType(e){return this.safeString({trade:"trade",tradefee:"fee",withdraw:"transaction",deposit:"transaction"},e,e)}parseLedgerEntry(e,t){const s=this.safeString(e,"MovementId");let i;let r=this.safeString2(e,"TradeId","OrderCode");r=this.safeString(e,"Hash",r);const a=this.safeString(e,"Address"),n=this.safeString(e,"Type"),o=this.parseLedgerEntryType(n),c=this.safeCurrencyCode(this.safeString(e,"CurrencyCode"),t);let d=this.safeNumber(e,"Amount");const h=this.safeNumber(e,"TotalBalance");let u;void 0!==d&&(void 0!==h&&(u=h-d),"withdrawal"===n?i="out":"deposit"===n?i="in":"trade"!==n&&"tradefee"!==n||(i=d<0?"out":"in",d=Math.abs(d)));const l=this.parse8601(this.safeString(e,"Date"));return{info:e,id:s,direction:i,account:undefined,referenceId:r,referenceAccount:a,type:o,currency:c,amount:d,before:u,after:h,status:this.safeString(e,"Status"),timestamp:l,datetime:this.iso8601(l),fee:undefined}}async fetchLedger(e,t,s,i={}){if(void 0===e)throw new r(this.id+" fetchLedger() requires a code argument");await this.loadMarkets();const a=this.currency(e);s=void 0===s?50:s;const n={Currency:a.id,PageSize:s,SortField:"Date"};void 0===this.safeInteger(i,"PageIndex")&&(n.Descending=!0);const o=await this.privatePostListTransactions(this.extend(n,i)),c=this.safeValue(o,"Result",[]);return this.parseLedger(c,a,t,s)}parseTransactionStatus(e){return this.safeString({pending:"pending",processed:"pending",confirmed:"ok"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"MovementId"),i=this.safeNumber(e,"Amount"),r=this.safeString(e,"Address"),a=r,n=void 0,o=this.safeString(e,"Hash"),c=this.safeString(e,"Type"),d=this.parse8601(this.safeString(e,"Date")),h=this.parseTransactionStatus(this.safeString(e,"Status")),u=this.safeString(e,"CurrencyCode");return{info:e,id:s,currency:this.safeCurrencyCode(u,t),amount:i,address:r,addressTo:a,addressFrom:undefined,tag:n,tagTo:undefined,tagFrom:undefined,status:h,type:c,updated:void 0,txid:o,timestamp:d,datetime:this.iso8601(d),fee:void 0}}async fetchTransactions(e,t,s,i={}){if(void 0===e)throw new r(this.id+" fetchTransactions() requires a code argument");await this.loadMarkets();const a=this.currency(e);s=void 0===s?50:s;const n={Currency:a.id,TransactionType:"depositswithdrawals",PageSize:s,SortField:"Date"};void 0===this.safeInteger(i,"PageIndex")&&(n.Descending=!0);const o=await this.privatePostListTransactions(this.extend(n,i)),c=this.safeValue(o,"Result",[]);return this.parseTransactions(c,a,t,s)}async fetchDeposits(e,t,s,i={}){return await this.fetchTransactions(e,t,s,this.extend({TransactionType:"deposits"},i))}async fetchWithdrawals(e,t,s,i={}){return await this.fetchTransactions(e,t,s,this.extend({TransactionType:"withdrawals"},i))}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){const n=this.urls.api+"/"+this.implodeParams(e,i);let o=this.omit(i,this.extractParams(e));if("private"===t){this.checkRequiredCredentials();const e=this.nonce();o=this.extend({key:this.apiKey,nonce:e},o),a=this.json(o),r={"Content-Type":"application/json",Hash:this.hmac(this.encode(a),this.encode(this.secret),"sha512")}}return{url:n,method:s,body:a,headers:r}}}},5060:function(e,t,s){!function(e,t){"use strict";function i(e,t){if(!e)throw new Error(t||"Assertion failed")}function r(e,t){e.super_=t;var s=function(){};s.prototype=t.prototype,e.prototype=new s,e.prototype.constructor=e}function a(e,t,s){if(a.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(s=t,t=10),this._init(e||0,t||10,s||"be"))}var n;"object"==typeof e?e.exports=a:t.BN=a,a.BN=a,a.wordSize=26;try{n=s(8764).Buffer}catch(e){}function o(e,t,s){for(var r=0,a=Math.min(e.length,s),n=0,o=t;o<a;o++){var c,d=e.charCodeAt(o)-48;r<<=4,r|=c=d>=49&&d<=54?d-49+10:d>=17&&d<=22?d-17+10:d,n|=c}return i(!(240&n),"Invalid character in "+e),r}function c(e,t,s,r){for(var a=0,n=0,o=Math.min(e.length,s),c=t;c<o;c++){var d=e.charCodeAt(c)-48;a*=r,n=d>=49?d-49+10:d>=17?d-17+10:d,i(d>=0&&n<r,"Invalid character"),a+=n}return a}function d(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}a.isBN=function(e){return e instanceof a||null!==e&&"object"==typeof e&&e.constructor.wordSize===a.wordSize&&Array.isArray(e.words)},a.max=function(e,t){return e.cmp(t)>0?e:t},a.min=function(e,t){return e.cmp(t)<0?e:t},a.prototype._init=function(e,t,s){if("number"==typeof e)return this._initNumber(e,t,s);if("object"==typeof e)return this._initArray(e,t,s);"hex"===t&&(t=16),i(t===(0|t)&&t>=2&&t<=36);var r=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&r++,16===t?this._parseHex(e,r):this._parseBase(e,t,r),"-"===e[0]&&(this.negative=1),this._strip(),"le"===s&&this._initArray(this.toArray(),t,s)},a.prototype._initNumber=function(e,t,s){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(i(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===s&&this._initArray(this.toArray(),t,s)},a.prototype._initArray=function(e,t,s){if(i("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var a,n,o=0;if("be"===s)for(r=e.length-1,a=0;r>=0;r-=3)n=e[r]|e[r-1]<<8|e[r-2]<<16,this.words[a]|=n<<o&67108863,this.words[a+1]=n>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);else if("le"===s)for(r=0,a=0;r<e.length;r+=3)n=e[r]|e[r+1]<<8|e[r+2]<<16,this.words[a]|=n<<o&67108863,this.words[a+1]=n>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);return this._strip()},a.prototype._parseHex=function(e,t){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var s=0;s<this.length;s++)this.words[s]=0;var i,r,a=0;for(s=e.length-6,i=0;s>=t;s-=6)r=o(e,s,s+6),this.words[i]|=r<<a&67108863,this.words[i+1]|=r>>>26-a&4194303,(a+=24)>=26&&(a-=26,i++);s+6!==t&&(r=o(e,t,s+6),this.words[i]|=r<<a&67108863,this.words[i+1]|=r>>>26-a&4194303),this._strip()},a.prototype._parseBase=function(e,t,s){this.words=[0],this.length=1;for(var i=0,r=1;r<=67108863;r*=t)i++;i--,r=r/t|0;for(var a=e.length-s,n=a%i,o=Math.min(a,a-n)+s,d=0,h=s;h<o;h+=i)d=c(e,h,h+i,t),this.imuln(r),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d);if(0!==n){var u=1;for(d=c(e,h,e.length,t),h=0;h<n;h++)u*=t;this.imuln(u),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d)}},a.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},a.prototype._move=function(e){e.words=this.words,e.length=this.length,e.negative=this.negative,e.red=this.red},a.prototype.clone=function(){var e=new a(null);return this.copy(e),e},a.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},a.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},a.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for?a.prototype[Symbol.for("nodejs.util.inspect.custom")]=d:a.prototype.inspect=d;var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],u=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],l=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function(e,t){var s;if(t=0|t||1,16===(e=e||10)||"hex"===e){s="";for(var r=0,a=0,n=0;n<this.length;n++){var o=this.words[n],c=(16777215&(o<<r|a)).toString(16);s=0!==(a=o>>>24-r&16777215)||n!==this.length-1?h[6-c.length]+c+s:c+s,(r+=2)>=26&&(r-=26,n--)}for(0!==a&&(s=a.toString(16)+s);s.length%t!=0;)s="0"+s;return 0!==this.negative&&(s="-"+s),s}if(e===(0|e)&&e>=2&&e<=36){var d=u[e],f=l[e];s="";var p=this.clone();for(p.negative=0;!p.isZero();){var m=p.modrn(f).toString(e);s=(p=p.idivn(f)).isZero()?m+s:h[d-m.length]+m+s}for(this.isZero()&&(s="0"+s);s.length%t!=0;)s="0"+s;return 0!==this.negative&&(s="-"+s),s}i(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},a.prototype.toJSON=function(){return this.toString(16,2)},n&&(a.prototype.toBuffer=function(e,t){return this.toArrayLike(n,e,t)}),a.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)};function f(e,t,s){s.negative=t.negative^e.negative;var i=e.length+t.length|0;s.length=i,i=i-1|0;var r=0|e.words[0],a=0|t.words[0],n=r*a,o=67108863&n,c=n/67108864|0;s.words[0]=o;for(var d=1;d<i;d++){for(var h=c>>>26,u=67108863&c,l=Math.min(d,t.length-1),f=Math.max(0,d-e.length+1);f<=l;f++){var p=d-f|0;h+=(n=(r=0|e.words[p])*(a=0|t.words[f])+u)/67108864|0,u=67108863&n}s.words[d]=0|u,c=0|h}return 0!==c?s.words[d]=0|c:s.length--,s._strip()}a.prototype.toArrayLike=function(e,t,s){this._strip();var r=this.byteLength(),a=s||Math.max(1,r);i(r<=a,"byte array longer than desired length"),i(a>0,"Requested array length <= 0");var n=function(e,t){return e.allocUnsafe?e.allocUnsafe(t):new e(t)}(e,a);return this["_toArrayLike"+("le"===t?"LE":"BE")](n,r),n},a.prototype._toArrayLikeLE=function(e,t){for(var s=0,i=0,r=0,a=0;r<this.length;r++){var n=this.words[r]<<a|i;e[s++]=255&n,s<e.length&&(e[s++]=n>>8&255),s<e.length&&(e[s++]=n>>16&255),6===a?(s<e.length&&(e[s++]=n>>24&255),i=0,a=0):(i=n>>>24,a+=2)}if(s<e.length)for(e[s++]=i;s<e.length;)e[s++]=0},a.prototype._toArrayLikeBE=function(e,t){for(var s=e.length-1,i=0,r=0,a=0;r<this.length;r++){var n=this.words[r]<<a|i;e[s--]=255&n,s>=0&&(e[s--]=n>>8&255),s>=0&&(e[s--]=n>>16&255),6===a?(s>=0&&(e[s--]=n>>24&255),i=0,a=0):(i=n>>>24,a+=2)}if(s>=0)for(e[s--]=i;s>=0;)e[s--]=0},Math.clz32?a.prototype._countBits=function(e){return 32-Math.clz32(e)}:a.prototype._countBits=function(e){var t=e,s=0;return t>=4096&&(s+=13,t>>>=13),t>=64&&(s+=7,t>>>=7),t>=8&&(s+=4,t>>>=4),t>=2&&(s+=2,t>>>=2),s+t},a.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,s=0;return 0==(8191&t)&&(s+=13,t>>>=13),0==(127&t)&&(s+=7,t>>>=7),0==(15&t)&&(s+=4,t>>>=4),0==(3&t)&&(s+=2,t>>>=2),0==(1&t)&&s++,s},a.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var s=this._zeroBits(this.words[t]);if(e+=s,26!==s)break}return e},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},a.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return 0!==this.negative},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},a.prototype.ior=function(e){return i(0==(this.negative|e.negative)),this.iuor(e)},a.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},a.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},a.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var s=0;s<t.length;s++)this.words[s]=this.words[s]&e.words[s];return this.length=t.length,this._strip()},a.prototype.iand=function(e){return i(0==(this.negative|e.negative)),this.iuand(e)},a.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},a.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},a.prototype.iuxor=function(e){var t,s;this.length>e.length?(t=this,s=e):(t=e,s=this);for(var i=0;i<s.length;i++)this.words[i]=t.words[i]^s.words[i];if(this!==t)for(;i<t.length;i++)this.words[i]=t.words[i];return this.length=t.length,this._strip()},a.prototype.ixor=function(e){return i(0==(this.negative|e.negative)),this.iuxor(e)},a.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},a.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},a.prototype.inotn=function(e){i("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),s=e%26;this._expand(t),s>0&&t--;for(var r=0;r<t;r++)this.words[r]=67108863&~this.words[r];return s>0&&(this.words[r]=~this.words[r]&67108863>>26-s),this._strip()},a.prototype.notn=function(e){return this.clone().inotn(e)},a.prototype.setn=function(e,t){i("number"==typeof e&&e>=0);var s=e/26|0,r=e%26;return this._expand(s+1),this.words[s]=t?this.words[s]|1<<r:this.words[s]&~(1<<r),this._strip()},a.prototype.iadd=function(e){var t,s,i;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(s=this,i=e):(s=e,i=this);for(var r=0,a=0;a<i.length;a++)t=(0|s.words[a])+(0|i.words[a])+r,this.words[a]=67108863&t,r=t>>>26;for(;0!==r&&a<s.length;a++)t=(0|s.words[a])+r,this.words[a]=67108863&t,r=t>>>26;if(this.length=s.length,0!==r)this.words[this.length]=r,this.length++;else if(s!==this)for(;a<s.length;a++)this.words[a]=s.words[a];return this},a.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},a.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var s,i,r=this.cmp(e);if(0===r)return this.negative=0,this.length=1,this.words[0]=0,this;r>0?(s=this,i=e):(s=e,i=this);for(var a=0,n=0;n<i.length;n++)a=(t=(0|s.words[n])-(0|i.words[n])+a)>>26,this.words[n]=67108863&t;for(;0!==a&&n<s.length;n++)a=(t=(0|s.words[n])+a)>>26,this.words[n]=67108863&t;if(0===a&&n<s.length&&s!==this)for(;n<s.length;n++)this.words[n]=s.words[n];return this.length=Math.max(this.length,n),s!==this&&(this.negative=1),this._strip()},a.prototype.sub=function(e){return this.clone().isub(e)};var p=function(e,t,s){var i,r,a,n=e.words,o=t.words,c=s.words,d=0,h=0|n[0],u=8191&h,l=h>>>13,f=0|n[1],p=8191&f,m=f>>>13,b=0|n[2],g=8191&b,y=b>>>13,v=0|n[3],w=8191&v,k=v>>>13,S=0|n[4],_=8191&S,O=S>>>13,T=0|n[5],x=8191&T,C=T>>>13,I=0|n[6],M=8191&I,N=I>>>13,A=0|n[7],E=8191&A,P=A>>>13,B=0|n[8],V=8191&B,L=B>>>13,q=0|n[9],D=8191&q,R=q>>>13,G=0|o[0],F=8191&G,U=G>>>13,j=0|o[1],H=8191&j,z=j>>>13,W=0|o[2],K=8191&W,X=W>>>13,Y=0|o[3],Z=8191&Y,Q=Y>>>13,J=0|o[4],$=8191&J,ee=J>>>13,te=0|o[5],se=8191&te,ie=te>>>13,re=0|o[6],ae=8191&re,ne=re>>>13,oe=0|o[7],ce=8191&oe,de=oe>>>13,he=0|o[8],ue=8191&he,le=he>>>13,fe=0|o[9],pe=8191&fe,me=fe>>>13;s.negative=e.negative^t.negative,s.length=19;var be=(d+(i=Math.imul(u,F))|0)+((8191&(r=(r=Math.imul(u,U))+Math.imul(l,F)|0))<<13)|0;d=((a=Math.imul(l,U))+(r>>>13)|0)+(be>>>26)|0,be&=67108863,i=Math.imul(p,F),r=(r=Math.imul(p,U))+Math.imul(m,F)|0,a=Math.imul(m,U);var ge=(d+(i=i+Math.imul(u,H)|0)|0)+((8191&(r=(r=r+Math.imul(u,z)|0)+Math.imul(l,H)|0))<<13)|0;d=((a=a+Math.imul(l,z)|0)+(r>>>13)|0)+(ge>>>26)|0,ge&=67108863,i=Math.imul(g,F),r=(r=Math.imul(g,U))+Math.imul(y,F)|0,a=Math.imul(y,U),i=i+Math.imul(p,H)|0,r=(r=r+Math.imul(p,z)|0)+Math.imul(m,H)|0,a=a+Math.imul(m,z)|0;var ye=(d+(i=i+Math.imul(u,K)|0)|0)+((8191&(r=(r=r+Math.imul(u,X)|0)+Math.imul(l,K)|0))<<13)|0;d=((a=a+Math.imul(l,X)|0)+(r>>>13)|0)+(ye>>>26)|0,ye&=67108863,i=Math.imul(w,F),r=(r=Math.imul(w,U))+Math.imul(k,F)|0,a=Math.imul(k,U),i=i+Math.imul(g,H)|0,r=(r=r+Math.imul(g,z)|0)+Math.imul(y,H)|0,a=a+Math.imul(y,z)|0,i=i+Math.imul(p,K)|0,r=(r=r+Math.imul(p,X)|0)+Math.imul(m,K)|0,a=a+Math.imul(m,X)|0;var ve=(d+(i=i+Math.imul(u,Z)|0)|0)+((8191&(r=(r=r+Math.imul(u,Q)|0)+Math.imul(l,Z)|0))<<13)|0;d=((a=a+Math.imul(l,Q)|0)+(r>>>13)|0)+(ve>>>26)|0,ve&=67108863,i=Math.imul(_,F),r=(r=Math.imul(_,U))+Math.imul(O,F)|0,a=Math.imul(O,U),i=i+Math.imul(w,H)|0,r=(r=r+Math.imul(w,z)|0)+Math.imul(k,H)|0,a=a+Math.imul(k,z)|0,i=i+Math.imul(g,K)|0,r=(r=r+Math.imul(g,X)|0)+Math.imul(y,K)|0,a=a+Math.imul(y,X)|0,i=i+Math.imul(p,Z)|0,r=(r=r+Math.imul(p,Q)|0)+Math.imul(m,Z)|0,a=a+Math.imul(m,Q)|0;var we=(d+(i=i+Math.imul(u,$)|0)|0)+((8191&(r=(r=r+Math.imul(u,ee)|0)+Math.imul(l,$)|0))<<13)|0;d=((a=a+Math.imul(l,ee)|0)+(r>>>13)|0)+(we>>>26)|0,we&=67108863,i=Math.imul(x,F),r=(r=Math.imul(x,U))+Math.imul(C,F)|0,a=Math.imul(C,U),i=i+Math.imul(_,H)|0,r=(r=r+Math.imul(_,z)|0)+Math.imul(O,H)|0,a=a+Math.imul(O,z)|0,i=i+Math.imul(w,K)|0,r=(r=r+Math.imul(w,X)|0)+Math.imul(k,K)|0,a=a+Math.imul(k,X)|0,i=i+Math.imul(g,Z)|0,r=(r=r+Math.imul(g,Q)|0)+Math.imul(y,Z)|0,a=a+Math.imul(y,Q)|0,i=i+Math.imul(p,$)|0,r=(r=r+Math.imul(p,ee)|0)+Math.imul(m,$)|0,a=a+Math.imul(m,ee)|0;var ke=(d+(i=i+Math.imul(u,se)|0)|0)+((8191&(r=(r=r+Math.imul(u,ie)|0)+Math.imul(l,se)|0))<<13)|0;d=((a=a+Math.imul(l,ie)|0)+(r>>>13)|0)+(ke>>>26)|0,ke&=67108863,i=Math.imul(M,F),r=(r=Math.imul(M,U))+Math.imul(N,F)|0,a=Math.imul(N,U),i=i+Math.imul(x,H)|0,r=(r=r+Math.imul(x,z)|0)+Math.imul(C,H)|0,a=a+Math.imul(C,z)|0,i=i+Math.imul(_,K)|0,r=(r=r+Math.imul(_,X)|0)+Math.imul(O,K)|0,a=a+Math.imul(O,X)|0,i=i+Math.imul(w,Z)|0,r=(r=r+Math.imul(w,Q)|0)+Math.imul(k,Z)|0,a=a+Math.imul(k,Q)|0,i=i+Math.imul(g,$)|0,r=(r=r+Math.imul(g,ee)|0)+Math.imul(y,$)|0,a=a+Math.imul(y,ee)|0,i=i+Math.imul(p,se)|0,r=(r=r+Math.imul(p,ie)|0)+Math.imul(m,se)|0,a=a+Math.imul(m,ie)|0;var Se=(d+(i=i+Math.imul(u,ae)|0)|0)+((8191&(r=(r=r+Math.imul(u,ne)|0)+Math.imul(l,ae)|0))<<13)|0;d=((a=a+Math.imul(l,ne)|0)+(r>>>13)|0)+(Se>>>26)|0,Se&=67108863,i=Math.imul(E,F),r=(r=Math.imul(E,U))+Math.imul(P,F)|0,a=Math.imul(P,U),i=i+Math.imul(M,H)|0,r=(r=r+Math.imul(M,z)|0)+Math.imul(N,H)|0,a=a+Math.imul(N,z)|0,i=i+Math.imul(x,K)|0,r=(r=r+Math.imul(x,X)|0)+Math.imul(C,K)|0,a=a+Math.imul(C,X)|0,i=i+Math.imul(_,Z)|0,r=(r=r+Math.imul(_,Q)|0)+Math.imul(O,Z)|0,a=a+Math.imul(O,Q)|0,i=i+Math.imul(w,$)|0,r=(r=r+Math.imul(w,ee)|0)+Math.imul(k,$)|0,a=a+Math.imul(k,ee)|0,i=i+Math.imul(g,se)|0,r=(r=r+Math.imul(g,ie)|0)+Math.imul(y,se)|0,a=a+Math.imul(y,ie)|0,i=i+Math.imul(p,ae)|0,r=(r=r+Math.imul(p,ne)|0)+Math.imul(m,ae)|0,a=a+Math.imul(m,ne)|0;var _e=(d+(i=i+Math.imul(u,ce)|0)|0)+((8191&(r=(r=r+Math.imul(u,de)|0)+Math.imul(l,ce)|0))<<13)|0;d=((a=a+Math.imul(l,de)|0)+(r>>>13)|0)+(_e>>>26)|0,_e&=67108863,i=Math.imul(V,F),r=(r=Math.imul(V,U))+Math.imul(L,F)|0,a=Math.imul(L,U),i=i+Math.imul(E,H)|0,r=(r=r+Math.imul(E,z)|0)+Math.imul(P,H)|0,a=a+Math.imul(P,z)|0,i=i+Math.imul(M,K)|0,r=(r=r+Math.imul(M,X)|0)+Math.imul(N,K)|0,a=a+Math.imul(N,X)|0,i=i+Math.imul(x,Z)|0,r=(r=r+Math.imul(x,Q)|0)+Math.imul(C,Z)|0,a=a+Math.imul(C,Q)|0,i=i+Math.imul(_,$)|0,r=(r=r+Math.imul(_,ee)|0)+Math.imul(O,$)|0,a=a+Math.imul(O,ee)|0,i=i+Math.imul(w,se)|0,r=(r=r+Math.imul(w,ie)|0)+Math.imul(k,se)|0,a=a+Math.imul(k,ie)|0,i=i+Math.imul(g,ae)|0,r=(r=r+Math.imul(g,ne)|0)+Math.imul(y,ae)|0,a=a+Math.imul(y,ne)|0,i=i+Math.imul(p,ce)|0,r=(r=r+Math.imul(p,de)|0)+Math.imul(m,ce)|0,a=a+Math.imul(m,de)|0;var Oe=(d+(i=i+Math.imul(u,ue)|0)|0)+((8191&(r=(r=r+Math.imul(u,le)|0)+Math.imul(l,ue)|0))<<13)|0;d=((a=a+Math.imul(l,le)|0)+(r>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,i=Math.imul(D,F),r=(r=Math.imul(D,U))+Math.imul(R,F)|0,a=Math.imul(R,U),i=i+Math.imul(V,H)|0,r=(r=r+Math.imul(V,z)|0)+Math.imul(L,H)|0,a=a+Math.imul(L,z)|0,i=i+Math.imul(E,K)|0,r=(r=r+Math.imul(E,X)|0)+Math.imul(P,K)|0,a=a+Math.imul(P,X)|0,i=i+Math.imul(M,Z)|0,r=(r=r+Math.imul(M,Q)|0)+Math.imul(N,Z)|0,a=a+Math.imul(N,Q)|0,i=i+Math.imul(x,$)|0,r=(r=r+Math.imul(x,ee)|0)+Math.imul(C,$)|0,a=a+Math.imul(C,ee)|0,i=i+Math.imul(_,se)|0,r=(r=r+Math.imul(_,ie)|0)+Math.imul(O,se)|0,a=a+Math.imul(O,ie)|0,i=i+Math.imul(w,ae)|0,r=(r=r+Math.imul(w,ne)|0)+Math.imul(k,ae)|0,a=a+Math.imul(k,ne)|0,i=i+Math.imul(g,ce)|0,r=(r=r+Math.imul(g,de)|0)+Math.imul(y,ce)|0,a=a+Math.imul(y,de)|0,i=i+Math.imul(p,ue)|0,r=(r=r+Math.imul(p,le)|0)+Math.imul(m,ue)|0,a=a+Math.imul(m,le)|0;var Te=(d+(i=i+Math.imul(u,pe)|0)|0)+((8191&(r=(r=r+Math.imul(u,me)|0)+Math.imul(l,pe)|0))<<13)|0;d=((a=a+Math.imul(l,me)|0)+(r>>>13)|0)+(Te>>>26)|0,Te&=67108863,i=Math.imul(D,H),r=(r=Math.imul(D,z))+Math.imul(R,H)|0,a=Math.imul(R,z),i=i+Math.imul(V,K)|0,r=(r=r+Math.imul(V,X)|0)+Math.imul(L,K)|0,a=a+Math.imul(L,X)|0,i=i+Math.imul(E,Z)|0,r=(r=r+Math.imul(E,Q)|0)+Math.imul(P,Z)|0,a=a+Math.imul(P,Q)|0,i=i+Math.imul(M,$)|0,r=(r=r+Math.imul(M,ee)|0)+Math.imul(N,$)|0,a=a+Math.imul(N,ee)|0,i=i+Math.imul(x,se)|0,r=(r=r+Math.imul(x,ie)|0)+Math.imul(C,se)|0,a=a+Math.imul(C,ie)|0,i=i+Math.imul(_,ae)|0,r=(r=r+Math.imul(_,ne)|0)+Math.imul(O,ae)|0,a=a+Math.imul(O,ne)|0,i=i+Math.imul(w,ce)|0,r=(r=r+Math.imul(w,de)|0)+Math.imul(k,ce)|0,a=a+Math.imul(k,de)|0,i=i+Math.imul(g,ue)|0,r=(r=r+Math.imul(g,le)|0)+Math.imul(y,ue)|0,a=a+Math.imul(y,le)|0;var xe=(d+(i=i+Math.imul(p,pe)|0)|0)+((8191&(r=(r=r+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;d=((a=a+Math.imul(m,me)|0)+(r>>>13)|0)+(xe>>>26)|0,xe&=67108863,i=Math.imul(D,K),r=(r=Math.imul(D,X))+Math.imul(R,K)|0,a=Math.imul(R,X),i=i+Math.imul(V,Z)|0,r=(r=r+Math.imul(V,Q)|0)+Math.imul(L,Z)|0,a=a+Math.imul(L,Q)|0,i=i+Math.imul(E,$)|0,r=(r=r+Math.imul(E,ee)|0)+Math.imul(P,$)|0,a=a+Math.imul(P,ee)|0,i=i+Math.imul(M,se)|0,r=(r=r+Math.imul(M,ie)|0)+Math.imul(N,se)|0,a=a+Math.imul(N,ie)|0,i=i+Math.imul(x,ae)|0,r=(r=r+Math.imul(x,ne)|0)+Math.imul(C,ae)|0,a=a+Math.imul(C,ne)|0,i=i+Math.imul(_,ce)|0,r=(r=r+Math.imul(_,de)|0)+Math.imul(O,ce)|0,a=a+Math.imul(O,de)|0,i=i+Math.imul(w,ue)|0,r=(r=r+Math.imul(w,le)|0)+Math.imul(k,ue)|0,a=a+Math.imul(k,le)|0;var Ce=(d+(i=i+Math.imul(g,pe)|0)|0)+((8191&(r=(r=r+Math.imul(g,me)|0)+Math.imul(y,pe)|0))<<13)|0;d=((a=a+Math.imul(y,me)|0)+(r>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,i=Math.imul(D,Z),r=(r=Math.imul(D,Q))+Math.imul(R,Z)|0,a=Math.imul(R,Q),i=i+Math.imul(V,$)|0,r=(r=r+Math.imul(V,ee)|0)+Math.imul(L,$)|0,a=a+Math.imul(L,ee)|0,i=i+Math.imul(E,se)|0,r=(r=r+Math.imul(E,ie)|0)+Math.imul(P,se)|0,a=a+Math.imul(P,ie)|0,i=i+Math.imul(M,ae)|0,r=(r=r+Math.imul(M,ne)|0)+Math.imul(N,ae)|0,a=a+Math.imul(N,ne)|0,i=i+Math.imul(x,ce)|0,r=(r=r+Math.imul(x,de)|0)+Math.imul(C,ce)|0,a=a+Math.imul(C,de)|0,i=i+Math.imul(_,ue)|0,r=(r=r+Math.imul(_,le)|0)+Math.imul(O,ue)|0,a=a+Math.imul(O,le)|0;var Ie=(d+(i=i+Math.imul(w,pe)|0)|0)+((8191&(r=(r=r+Math.imul(w,me)|0)+Math.imul(k,pe)|0))<<13)|0;d=((a=a+Math.imul(k,me)|0)+(r>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,i=Math.imul(D,$),r=(r=Math.imul(D,ee))+Math.imul(R,$)|0,a=Math.imul(R,ee),i=i+Math.imul(V,se)|0,r=(r=r+Math.imul(V,ie)|0)+Math.imul(L,se)|0,a=a+Math.imul(L,ie)|0,i=i+Math.imul(E,ae)|0,r=(r=r+Math.imul(E,ne)|0)+Math.imul(P,ae)|0,a=a+Math.imul(P,ne)|0,i=i+Math.imul(M,ce)|0,r=(r=r+Math.imul(M,de)|0)+Math.imul(N,ce)|0,a=a+Math.imul(N,de)|0,i=i+Math.imul(x,ue)|0,r=(r=r+Math.imul(x,le)|0)+Math.imul(C,ue)|0,a=a+Math.imul(C,le)|0;var Me=(d+(i=i+Math.imul(_,pe)|0)|0)+((8191&(r=(r=r+Math.imul(_,me)|0)+Math.imul(O,pe)|0))<<13)|0;d=((a=a+Math.imul(O,me)|0)+(r>>>13)|0)+(Me>>>26)|0,Me&=67108863,i=Math.imul(D,se),r=(r=Math.imul(D,ie))+Math.imul(R,se)|0,a=Math.imul(R,ie),i=i+Math.imul(V,ae)|0,r=(r=r+Math.imul(V,ne)|0)+Math.imul(L,ae)|0,a=a+Math.imul(L,ne)|0,i=i+Math.imul(E,ce)|0,r=(r=r+Math.imul(E,de)|0)+Math.imul(P,ce)|0,a=a+Math.imul(P,de)|0,i=i+Math.imul(M,ue)|0,r=(r=r+Math.imul(M,le)|0)+Math.imul(N,ue)|0,a=a+Math.imul(N,le)|0;var Ne=(d+(i=i+Math.imul(x,pe)|0)|0)+((8191&(r=(r=r+Math.imul(x,me)|0)+Math.imul(C,pe)|0))<<13)|0;d=((a=a+Math.imul(C,me)|0)+(r>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,i=Math.imul(D,ae),r=(r=Math.imul(D,ne))+Math.imul(R,ae)|0,a=Math.imul(R,ne),i=i+Math.imul(V,ce)|0,r=(r=r+Math.imul(V,de)|0)+Math.imul(L,ce)|0,a=a+Math.imul(L,de)|0,i=i+Math.imul(E,ue)|0,r=(r=r+Math.imul(E,le)|0)+Math.imul(P,ue)|0,a=a+Math.imul(P,le)|0;var Ae=(d+(i=i+Math.imul(M,pe)|0)|0)+((8191&(r=(r=r+Math.imul(M,me)|0)+Math.imul(N,pe)|0))<<13)|0;d=((a=a+Math.imul(N,me)|0)+(r>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,i=Math.imul(D,ce),r=(r=Math.imul(D,de))+Math.imul(R,ce)|0,a=Math.imul(R,de),i=i+Math.imul(V,ue)|0,r=(r=r+Math.imul(V,le)|0)+Math.imul(L,ue)|0,a=a+Math.imul(L,le)|0;var Ee=(d+(i=i+Math.imul(E,pe)|0)|0)+((8191&(r=(r=r+Math.imul(E,me)|0)+Math.imul(P,pe)|0))<<13)|0;d=((a=a+Math.imul(P,me)|0)+(r>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,i=Math.imul(D,ue),r=(r=Math.imul(D,le))+Math.imul(R,ue)|0,a=Math.imul(R,le);var Pe=(d+(i=i+Math.imul(V,pe)|0)|0)+((8191&(r=(r=r+Math.imul(V,me)|0)+Math.imul(L,pe)|0))<<13)|0;d=((a=a+Math.imul(L,me)|0)+(r>>>13)|0)+(Pe>>>26)|0,Pe&=67108863;var Be=(d+(i=Math.imul(D,pe))|0)+((8191&(r=(r=Math.imul(D,me))+Math.imul(R,pe)|0))<<13)|0;return d=((a=Math.imul(R,me))+(r>>>13)|0)+(Be>>>26)|0,Be&=67108863,c[0]=be,c[1]=ge,c[2]=ye,c[3]=ve,c[4]=we,c[5]=ke,c[6]=Se,c[7]=_e,c[8]=Oe,c[9]=Te,c[10]=xe,c[11]=Ce,c[12]=Ie,c[13]=Me,c[14]=Ne,c[15]=Ae,c[16]=Ee,c[17]=Pe,c[18]=Be,0!==d&&(c[19]=d,s.length++),s};function m(e,t,s){s.negative=t.negative^e.negative,s.length=e.length+t.length;for(var i=0,r=0,a=0;a<s.length-1;a++){var n=r;r=0;for(var o=67108863&i,c=Math.min(a,t.length-1),d=Math.max(0,a-e.length+1);d<=c;d++){var h=a-d,u=(0|e.words[h])*(0|t.words[d]),l=67108863&u;o=67108863&(l=l+o|0),r+=(n=(n=n+(u/67108864|0)|0)+(l>>>26)|0)>>>26,n&=67108863}s.words[a]=o,i=n,n=r}return 0!==i?s.words[a]=i:s.length--,s._strip()}function b(e,t,s){return m(e,t,s)}function g(e,t){this.x=e,this.y=t}Math.imul||(p=f),a.prototype.mulTo=function(e,t){var s=this.length+e.length;return 10===this.length&&10===e.length?p(this,e,t):s<63?f(this,e,t):s<1024?m(this,e,t):b(this,e,t)},g.prototype.makeRBT=function(e){for(var t=new Array(e),s=a.prototype._countBits(e)-1,i=0;i<e;i++)t[i]=this.revBin(i,s,e);return t},g.prototype.revBin=function(e,t,s){if(0===e||e===s-1)return e;for(var i=0,r=0;r<t;r++)i|=(1&e)<<t-r-1,e>>=1;return i},g.prototype.permute=function(e,t,s,i,r,a){for(var n=0;n<a;n++)i[n]=t[e[n]],r[n]=s[e[n]]},g.prototype.transform=function(e,t,s,i,r,a){this.permute(a,e,t,s,i,r);for(var n=1;n<r;n<<=1)for(var o=n<<1,c=Math.cos(2*Math.PI/o),d=Math.sin(2*Math.PI/o),h=0;h<r;h+=o)for(var u=c,l=d,f=0;f<n;f++){var p=s[h+f],m=i[h+f],b=s[h+f+n],g=i[h+f+n],y=u*b-l*g;g=u*g+l*b,b=y,s[h+f]=p+b,i[h+f]=m+g,s[h+f+n]=p-b,i[h+f+n]=m-g,f!==o&&(y=c*u-d*l,l=c*l+d*u,u=y)}},g.prototype.guessLen13b=function(e,t){var s=1|Math.max(t,e),i=1&s,r=0;for(s=s/2|0;s;s>>>=1)r++;return 1<<r+1+i},g.prototype.conjugate=function(e,t,s){if(!(s<=1))for(var i=0;i<s/2;i++){var r=e[i];e[i]=e[s-i-1],e[s-i-1]=r,r=t[i],t[i]=-t[s-i-1],t[s-i-1]=-r}},g.prototype.normalize13b=function(e,t){for(var s=0,i=0;i<t/2;i++){var r=8192*Math.round(e[2*i+1]/t)+Math.round(e[2*i]/t)+s;e[i]=67108863&r,s=r<67108864?0:r/67108864|0}return e},g.prototype.convert13b=function(e,t,s,r){for(var a=0,n=0;n<t;n++)a+=0|e[n],s[2*n]=8191&a,a>>>=13,s[2*n+1]=8191&a,a>>>=13;for(n=2*t;n<r;++n)s[n]=0;i(0===a),i(0==(-8192&a))},g.prototype.stub=function(e){for(var t=new Array(e),s=0;s<e;s++)t[s]=0;return t},g.prototype.mulp=function(e,t,s){var i=2*this.guessLen13b(e.length,t.length),r=this.makeRBT(i),a=this.stub(i),n=new Array(i),o=new Array(i),c=new Array(i),d=new Array(i),h=new Array(i),u=new Array(i),l=s.words;l.length=i,this.convert13b(e.words,e.length,n,i),this.convert13b(t.words,t.length,d,i),this.transform(n,a,o,c,i,r),this.transform(d,a,h,u,i,r);for(var f=0;f<i;f++){var p=o[f]*h[f]-c[f]*u[f];c[f]=o[f]*u[f]+c[f]*h[f],o[f]=p}return this.conjugate(o,c,i),this.transform(o,c,l,a,i,r),this.conjugate(l,a,i),this.normalize13b(l,i),s.negative=e.negative^t.negative,s.length=e.length+t.length,s._strip()},a.prototype.mul=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},a.prototype.mulf=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),b(this,e,t)},a.prototype.imul=function(e){return this.clone().mulTo(e,this)},a.prototype.imuln=function(e){var t=e<0;t&&(e=-e),i("number"==typeof e),i(e<67108864);for(var s=0,r=0;r<this.length;r++){var a=(0|this.words[r])*e,n=(67108863&a)+(67108863&s);s>>=26,s+=a/67108864|0,s+=n>>>26,this.words[r]=67108863&n}return 0!==s&&(this.words[r]=s,this.length++),t?this.ineg():this},a.prototype.muln=function(e){return this.clone().imuln(e)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),s=0;s<t.length;s++){var i=s/26|0,r=s%26;t[s]=e.words[i]>>>r&1}return t}(e);if(0===t.length)return new a(1);for(var s=this,i=0;i<t.length&&0===t[i];i++,s=s.sqr());if(++i<t.length)for(var r=s.sqr();i<t.length;i++,r=r.sqr())0!==t[i]&&(s=s.mul(r));return s},a.prototype.iushln=function(e){i("number"==typeof e&&e>=0);var t,s=e%26,r=(e-s)/26,a=67108863>>>26-s<<26-s;if(0!==s){var n=0;for(t=0;t<this.length;t++){var o=this.words[t]&a,c=(0|this.words[t])-o<<s;this.words[t]=c|n,n=o>>>26-s}n&&(this.words[t]=n,this.length++)}if(0!==r){for(t=this.length-1;t>=0;t--)this.words[t+r]=this.words[t];for(t=0;t<r;t++)this.words[t]=0;this.length+=r}return this._strip()},a.prototype.ishln=function(e){return i(0===this.negative),this.iushln(e)},a.prototype.iushrn=function(e,t,s){var r;i("number"==typeof e&&e>=0),r=t?(t-t%26)/26:0;var a=e%26,n=Math.min((e-a)/26,this.length),o=67108863^67108863>>>a<<a,c=s;if(r-=n,r=Math.max(0,r),c){for(var d=0;d<n;d++)c.words[d]=this.words[d];c.length=n}if(0===n);else if(this.length>n)for(this.length-=n,d=0;d<this.length;d++)this.words[d]=this.words[d+n];else this.words[0]=0,this.length=1;var h=0;for(d=this.length-1;d>=0&&(0!==h||d>=r);d--){var u=0|this.words[d];this.words[d]=h<<26-a|u>>>a,h=u&o}return c&&0!==h&&(c.words[c.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},a.prototype.ishrn=function(e,t,s){return i(0===this.negative),this.iushrn(e,t,s)},a.prototype.shln=function(e){return this.clone().ishln(e)},a.prototype.ushln=function(e){return this.clone().iushln(e)},a.prototype.shrn=function(e){return this.clone().ishrn(e)},a.prototype.ushrn=function(e){return this.clone().iushrn(e)},a.prototype.testn=function(e){i("number"==typeof e&&e>=0);var t=e%26,s=(e-t)/26,r=1<<t;return!(this.length<=s)&&!!(this.words[s]&r)},a.prototype.imaskn=function(e){i("number"==typeof e&&e>=0);var t=e%26,s=(e-t)/26;if(i(0===this.negative,"imaskn works only with positive numbers"),this.length<=s)return this;if(0!==t&&s++,this.length=Math.min(s,this.length),0!==t){var r=67108863^67108863>>>t<<t;this.words[this.length-1]&=r}return this._strip()},a.prototype.maskn=function(e){return this.clone().imaskn(e)},a.prototype.iaddn=function(e){return i("number"==typeof e),i(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},a.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},a.prototype.isubn=function(e){if(i("number"==typeof e),i(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this._strip()},a.prototype.addn=function(e){return this.clone().iaddn(e)},a.prototype.subn=function(e){return this.clone().isubn(e)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(e,t,s){var r,a,n=e.length+s;this._expand(n);var o=0;for(r=0;r<e.length;r++){a=(0|this.words[r+s])+o;var c=(0|e.words[r])*t;o=((a-=67108863&c)>>26)-(c/67108864|0),this.words[r+s]=67108863&a}for(;r<this.length-s;r++)o=(a=(0|this.words[r+s])+o)>>26,this.words[r+s]=67108863&a;if(0===o)return this._strip();for(i(-1===o),o=0,r=0;r<this.length;r++)o=(a=-(0|this.words[r])+o)>>26,this.words[r]=67108863&a;return this.negative=1,this._strip()},a.prototype._wordDiv=function(e,t){var s=(this.length,e.length),i=this.clone(),r=e,n=0|r.words[r.length-1];0!==(s=26-this._countBits(n))&&(r=r.ushln(s),i.iushln(s),n=0|r.words[r.length-1]);var o,c=i.length-r.length;if("mod"!==t){(o=new a(null)).length=c+1,o.words=new Array(o.length);for(var d=0;d<o.length;d++)o.words[d]=0}var h=i.clone()._ishlnsubmul(r,1,c);0===h.negative&&(i=h,o&&(o.words[c]=1));for(var u=c-1;u>=0;u--){var l=67108864*(0|i.words[r.length+u])+(0|i.words[r.length+u-1]);for(l=Math.min(l/n|0,67108863),i._ishlnsubmul(r,l,u);0!==i.negative;)l--,i.negative=0,i._ishlnsubmul(r,1,u),i.isZero()||(i.negative^=1);o&&(o.words[u]=l)}return o&&o._strip(),i._strip(),"div"!==t&&0!==s&&i.iushrn(s),{div:o||null,mod:i}},a.prototype.divmod=function(e,t,s){return i(!e.isZero()),this.isZero()?{div:new a(0),mod:new a(0)}:0!==this.negative&&0===e.negative?(o=this.neg().divmod(e,t),"mod"!==t&&(r=o.div.neg()),"div"!==t&&(n=o.mod.neg(),s&&0!==n.negative&&n.iadd(e)),{div:r,mod:n}):0===this.negative&&0!==e.negative?(o=this.divmod(e.neg(),t),"mod"!==t&&(r=o.div.neg()),{div:r,mod:o.mod}):0!=(this.negative&e.negative)?(o=this.neg().divmod(e.neg(),t),"div"!==t&&(n=o.mod.neg(),s&&0!==n.negative&&n.isub(e)),{div:o.div,mod:n}):e.length>this.length||this.cmp(e)<0?{div:new a(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new a(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new a(this.modrn(e.words[0]))}:this._wordDiv(e,t);var r,n,o},a.prototype.div=function(e){return this.divmod(e,"div",!1).div},a.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},a.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},a.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var s=0!==t.div.negative?t.mod.isub(e):t.mod,i=e.ushrn(1),r=e.andln(1),a=s.cmp(i);return a<0||1===r&&0===a?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},a.prototype.modrn=function(e){var t=e<0;t&&(e=-e),i(e<=67108863);for(var s=(1<<26)%e,r=0,a=this.length-1;a>=0;a--)r=(s*r+(0|this.words[a]))%e;return t?-r:r},a.prototype.modn=function(e){return this.modrn(e)},a.prototype.idivn=function(e){var t=e<0;t&&(e=-e),i(e<=67108863);for(var s=0,r=this.length-1;r>=0;r--){var a=(0|this.words[r])+67108864*s;this.words[r]=a/e|0,s=a%e}return this._strip(),t?this.ineg():this},a.prototype.divn=function(e){return this.clone().idivn(e)},a.prototype.egcd=function(e){i(0===e.negative),i(!e.isZero());var t=this,s=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var r=new a(1),n=new a(0),o=new a(0),c=new a(1),d=0;t.isEven()&&s.isEven();)t.iushrn(1),s.iushrn(1),++d;for(var h=s.clone(),u=t.clone();!t.isZero();){for(var l=0,f=1;0==(t.words[0]&f)&&l<26;++l,f<<=1);if(l>0)for(t.iushrn(l);l-- >0;)(r.isOdd()||n.isOdd())&&(r.iadd(h),n.isub(u)),r.iushrn(1),n.iushrn(1);for(var p=0,m=1;0==(s.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(s.iushrn(p);p-- >0;)(o.isOdd()||c.isOdd())&&(o.iadd(h),c.isub(u)),o.iushrn(1),c.iushrn(1);t.cmp(s)>=0?(t.isub(s),r.isub(o),n.isub(c)):(s.isub(t),o.isub(r),c.isub(n))}return{a:o,b:c,gcd:s.iushln(d)}},a.prototype._invmp=function(e){i(0===e.negative),i(!e.isZero());var t=this,s=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var r,n=new a(1),o=new a(0),c=s.clone();t.cmpn(1)>0&&s.cmpn(1)>0;){for(var d=0,h=1;0==(t.words[0]&h)&&d<26;++d,h<<=1);if(d>0)for(t.iushrn(d);d-- >0;)n.isOdd()&&n.iadd(c),n.iushrn(1);for(var u=0,l=1;0==(s.words[0]&l)&&u<26;++u,l<<=1);if(u>0)for(s.iushrn(u);u-- >0;)o.isOdd()&&o.iadd(c),o.iushrn(1);t.cmp(s)>=0?(t.isub(s),n.isub(o)):(s.isub(t),o.isub(n))}return(r=0===t.cmpn(1)?n:o).cmpn(0)<0&&r.iadd(e),r},a.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),s=e.clone();t.negative=0,s.negative=0;for(var i=0;t.isEven()&&s.isEven();i++)t.iushrn(1),s.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;s.isEven();)s.iushrn(1);var r=t.cmp(s);if(r<0){var a=t;t=s,s=a}else if(0===r||0===s.cmpn(1))break;t.isub(s)}return s.iushln(i)},a.prototype.invm=function(e){return this.egcd(e).a.umod(e)},a.prototype.isEven=function(){return 0==(1&this.words[0])},a.prototype.isOdd=function(){return 1==(1&this.words[0])},a.prototype.andln=function(e){return this.words[0]&e},a.prototype.bincn=function(e){i("number"==typeof e);var t=e%26,s=(e-t)/26,r=1<<t;if(this.length<=s)return this._expand(s+1),this.words[s]|=r,this;for(var a=r,n=s;0!==a&&n<this.length;n++){var o=0|this.words[n];a=(o+=a)>>>26,o&=67108863,this.words[n]=o}return 0!==a&&(this.words[n]=a,this.length++),this},a.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},a.prototype.cmpn=function(e){var t,s=e<0;if(0!==this.negative&&!s)return-1;if(0===this.negative&&s)return 1;if(this._strip(),this.length>1)t=1;else{s&&(e=-e),i(e<=67108863,"Number is too big");var r=0|this.words[0];t=r===e?0:r<e?-1:1}return 0!==this.negative?0|-t:t},a.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},a.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,s=this.length-1;s>=0;s--){var i=0|this.words[s],r=0|e.words[s];if(i!==r){i<r?t=-1:i>r&&(t=1);break}}return t},a.prototype.gtn=function(e){return 1===this.cmpn(e)},a.prototype.gt=function(e){return 1===this.cmp(e)},a.prototype.gten=function(e){return this.cmpn(e)>=0},a.prototype.gte=function(e){return this.cmp(e)>=0},a.prototype.ltn=function(e){return-1===this.cmpn(e)},a.prototype.lt=function(e){return-1===this.cmp(e)},a.prototype.lten=function(e){return this.cmpn(e)<=0},a.prototype.lte=function(e){return this.cmp(e)<=0},a.prototype.eqn=function(e){return 0===this.cmpn(e)},a.prototype.eq=function(e){return 0===this.cmp(e)},a.red=function(e){return new O(e)},a.prototype.toRed=function(e){return i(!this.red,"Already a number in reduction context"),i(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},a.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(e){return this.red=e,this},a.prototype.forceRed=function(e){return i(!this.red,"Already a number in reduction context"),this._forceRed(e)},a.prototype.redAdd=function(e){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},a.prototype.redIAdd=function(e){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},a.prototype.redSub=function(e){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},a.prototype.redISub=function(e){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},a.prototype.redShl=function(e){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},a.prototype.redMul=function(e){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},a.prototype.redIMul=function(e){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},a.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(e){return i(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var y={k256:null,p224:null,p192:null,p25519:null};function v(e,t){this.name=e,this.p=new a(t,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function w(){v.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function k(){v.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function S(){v.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function _(){v.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function O(e){if("string"==typeof e){var t=a._prime(e);this.m=t.p,this.prime=t}else i(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function T(e){O.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}v.prototype._tmp=function(){var e=new a(null);return e.words=new Array(Math.ceil(this.n/13)),e},v.prototype.ireduce=function(e){var t,s=e;do{this.split(s,this.tmp),t=(s=(s=this.imulK(s)).iadd(this.tmp)).bitLength()}while(t>this.n);var i=t<this.n?-1:s.ucmp(this.p);return 0===i?(s.words[0]=0,s.length=1):i>0?s.isub(this.p):s._strip(),s},v.prototype.split=function(e,t){e.iushrn(this.n,0,t)},v.prototype.imulK=function(e){return e.imul(this.k)},r(w,v),w.prototype.split=function(e,t){for(var s=4194303,i=Math.min(e.length,9),r=0;r<i;r++)t.words[r]=e.words[r];if(t.length=i,e.length<=9)return e.words[0]=0,void(e.length=1);var a=e.words[9];for(t.words[t.length++]=a&s,r=10;r<e.length;r++){var n=0|e.words[r];e.words[r-10]=(n&s)<<4|a>>>22,a=n}a>>>=22,e.words[r-10]=a,0===a&&e.length>10?e.length-=10:e.length-=9},w.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,s=0;s<e.length;s++){var i=0|e.words[s];t+=977*i,e.words[s]=67108863&t,t=64*i+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},r(k,v),r(S,v),r(_,v),_.prototype.imulK=function(e){for(var t=0,s=0;s<e.length;s++){var i=19*(0|e.words[s])+t,r=67108863&i;i>>>=26,e.words[s]=r,t=i}return 0!==t&&(e.words[e.length++]=t),e},a._prime=function(e){if(y[e])return y[e];var t;if("k256"===e)t=new w;else if("p224"===e)t=new k;else if("p192"===e)t=new S;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new _}return y[e]=t,t},O.prototype._verify1=function(e){i(0===e.negative,"red works only with positives"),i(e.red,"red works only with red numbers")},O.prototype._verify2=function(e,t){i(0==(e.negative|t.negative),"red works only with positives"),i(e.red&&e.red===t.red,"red works only with red numbers")},O.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(e.umod(this.m)._forceRed(this)._move(e),e)},O.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},O.prototype.add=function(e,t){this._verify2(e,t);var s=e.add(t);return s.cmp(this.m)>=0&&s.isub(this.m),s._forceRed(this)},O.prototype.iadd=function(e,t){this._verify2(e,t);var s=e.iadd(t);return s.cmp(this.m)>=0&&s.isub(this.m),s},O.prototype.sub=function(e,t){this._verify2(e,t);var s=e.sub(t);return s.cmpn(0)<0&&s.iadd(this.m),s._forceRed(this)},O.prototype.isub=function(e,t){this._verify2(e,t);var s=e.isub(t);return s.cmpn(0)<0&&s.iadd(this.m),s},O.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},O.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},O.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},O.prototype.isqr=function(e){return this.imul(e,e.clone())},O.prototype.sqr=function(e){return this.mul(e,e)},O.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(i(t%2==1),3===t){var s=this.m.add(new a(1)).iushrn(2);return this.pow(e,s)}for(var r=this.m.subn(1),n=0;!r.isZero()&&0===r.andln(1);)n++,r.iushrn(1);i(!r.isZero());var o=new a(1).toRed(this),c=o.redNeg(),d=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new a(2*h*h).toRed(this);0!==this.pow(h,d).cmp(c);)h.redIAdd(c);for(var u=this.pow(h,r),l=this.pow(e,r.addn(1).iushrn(1)),f=this.pow(e,r),p=n;0!==f.cmp(o);){for(var m=f,b=0;0!==m.cmp(o);b++)m=m.redSqr();i(b<p);var g=this.pow(u,new a(1).iushln(p-b-1));l=l.redMul(g),u=g.redSqr(),f=f.redMul(u),p=b}return l},O.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},O.prototype.pow=function(e,t){if(t.isZero())return new a(1).toRed(this);if(0===t.cmpn(1))return e.clone();var s=new Array(16);s[0]=new a(1).toRed(this),s[1]=e;for(var i=2;i<s.length;i++)s[i]=this.mul(s[i-1],e);var r=s[0],n=0,o=0,c=t.bitLength()%26;for(0===c&&(c=26),i=t.length-1;i>=0;i--){for(var d=t.words[i],h=c-1;h>=0;h--){var u=d>>h&1;r!==s[0]&&(r=this.sqr(r)),0!==u||0!==n?(n<<=1,n|=u,(4===++o||0===i&&0===h)&&(r=this.mul(r,s[n]),o=0,n=0)):o=0}c=26}return r},O.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},O.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},a.mont=function(e){return new T(e)},r(T,O),T.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},T.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},T.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var s=e.imul(t),i=s.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=s.isub(i).iushrn(this.shift),a=r;return r.cmp(this.m)>=0?a=r.isub(this.m):r.cmpn(0)<0&&(a=r.iadd(this.m)),a._forceRed(this)},T.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new a(0)._forceRed(this);var s=e.mul(t),i=s.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=s.isub(i).iushrn(this.shift),n=r;return r.cmp(this.m)>=0?n=r.isub(this.m):r.cmpn(0)<0&&(n=r.iadd(this.m)),n._forceRed(this)},T.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e=s.nmd(e),this)},7295:function(e,t){var s,i,r,a,n,o,c,d,h,u,l;e.exports=(l=l||function(e,t){var s=Object.create||function(){function e(){}return function(t){var s;return e.prototype=t,s=new e,e.prototype=null,s}}(),i={},r=i.lib={},a=r.Base={extend:function(e){var t=s(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},n=r.WordArray=a.extend({init:function(e,s){e=this.words=e||[],this.sigBytes=s!=t?s:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,s=e.words,i=this.sigBytes,r=e.sigBytes;if(this.clamp(),i%4)for(var a=0;a<r;a++){var n=s[a>>>2]>>>24-a%4*8&255;t[i+a>>>2]|=n<<24-(i+a)%4*8}else for(a=0;a<r;a+=4)t[i+a>>>2]=s[a>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,s=this.sigBytes;t[s>>>2]&=4294967295<<32-s%4*8,t.length=e.ceil(s/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var s,i=[],r=function(t){t=t;var s=987654321,i=4294967295;return function(){var r=((s=36969*(65535&s)+(s>>16)&i)<<16)+(t=18e3*(65535&t)+(t>>16)&i)&i;return r/=4294967296,(r+=.5)*(e.random()>.5?1:-1)}},a=0;a<t;a+=4){var o=r(4294967296*(s||e.random()));s=987654071*o(),i.push(4294967296*o()|0)}return new n.init(i,t)}}),o=i.enc={},c=o.Hex={stringify:function(e){for(var t=e.words,s=e.sigBytes,i=[],r=0;r<s;r++){var a=t[r>>>2]>>>24-r%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,s=[],i=0;i<t;i+=2)s[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new n.init(s,t/2)}},d=o.Latin1={stringify:function(e){for(var t=e.words,s=e.sigBytes,i=[],r=0;r<s;r++){var a=t[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(a))}return i.join("")},parse:function(e){for(var t=e.length,s=[],i=0;i<t;i++)s[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new n.init(s,t)}},h=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},u=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new n.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=h.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var s=this._data,i=s.words,r=s.sigBytes,a=this.blockSize,o=r/(4*a),c=(o=t?e.ceil(o):e.max((0|o)-this._minBufferSize,0))*a,d=e.min(4*c,r);if(c){for(var h=0;h<c;h+=a)this._doProcessBlock(i,h);var u=i.splice(0,c);s.sigBytes-=d}return new n.init(u,d)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),l=(r.Hasher=u.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,s){return new e.init(s).finalize(t)}},_createHmacHelper:function(e){return function(t,s){return new l.HMAC.init(e,s).finalize(t)}}}),i.algo={});return i}(Math),function(){var e=l,t=e.lib.WordArray;function s(e,s,i){for(var r=[],a=0,n=0;n<s;n++)if(n%4){var o=i[e.charCodeAt(n-1)]<<n%4*2,c=i[e.charCodeAt(n)]>>>6-n%4*2;r[a>>>2]|=(o|c)<<24-a%4*8,a++}return t.create(r,a)}e.enc.Base64={stringify:function(e){var t=e.words,s=e.sigBytes,i=this._map;e.clamp();for(var r=[],a=0;a<s;a+=3)for(var n=(t[a>>>2]>>>24-a%4*8&255)<<16|(t[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|t[a+2>>>2]>>>24-(a+2)%4*8&255,o=0;o<4&&a+.75*o<s;o++)r.push(i.charAt(n>>>6*(3-o)&63));var c=i.charAt(64);if(c)for(;r.length%4;)r.push(c);return r.join("")},parse:function(e){var t=e.length,i=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var a=0;a<i.length;a++)r[i.charCodeAt(a)]=a}var n=i.charAt(64);if(n){var o=e.indexOf(n);-1!==o&&(t=o)}return s(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){var t=l,s=t.lib,i=s.WordArray,r=s.Hasher,a=t.algo,n=[];!function(){for(var t=0;t<64;t++)n[t]=4294967296*e.abs(e.sin(t+1))|0}();var o=a.MD5=r.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var s=0;s<16;s++){var i=t+s,r=e[i];e[i]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var a=this._hash.words,o=e[t+0],l=e[t+1],f=e[t+2],p=e[t+3],m=e[t+4],b=e[t+5],g=e[t+6],y=e[t+7],v=e[t+8],w=e[t+9],k=e[t+10],S=e[t+11],_=e[t+12],O=e[t+13],T=e[t+14],x=e[t+15],C=a[0],I=a[1],M=a[2],N=a[3];C=c(C,I,M,N,o,7,n[0]),N=c(N,C,I,M,l,12,n[1]),M=c(M,N,C,I,f,17,n[2]),I=c(I,M,N,C,p,22,n[3]),C=c(C,I,M,N,m,7,n[4]),N=c(N,C,I,M,b,12,n[5]),M=c(M,N,C,I,g,17,n[6]),I=c(I,M,N,C,y,22,n[7]),C=c(C,I,M,N,v,7,n[8]),N=c(N,C,I,M,w,12,n[9]),M=c(M,N,C,I,k,17,n[10]),I=c(I,M,N,C,S,22,n[11]),C=c(C,I,M,N,_,7,n[12]),N=c(N,C,I,M,O,12,n[13]),M=c(M,N,C,I,T,17,n[14]),C=d(C,I=c(I,M,N,C,x,22,n[15]),M,N,l,5,n[16]),N=d(N,C,I,M,g,9,n[17]),M=d(M,N,C,I,S,14,n[18]),I=d(I,M,N,C,o,20,n[19]),C=d(C,I,M,N,b,5,n[20]),N=d(N,C,I,M,k,9,n[21]),M=d(M,N,C,I,x,14,n[22]),I=d(I,M,N,C,m,20,n[23]),C=d(C,I,M,N,w,5,n[24]),N=d(N,C,I,M,T,9,n[25]),M=d(M,N,C,I,p,14,n[26]),I=d(I,M,N,C,v,20,n[27]),C=d(C,I,M,N,O,5,n[28]),N=d(N,C,I,M,f,9,n[29]),M=d(M,N,C,I,y,14,n[30]),C=h(C,I=d(I,M,N,C,_,20,n[31]),M,N,b,4,n[32]),N=h(N,C,I,M,v,11,n[33]),M=h(M,N,C,I,S,16,n[34]),I=h(I,M,N,C,T,23,n[35]),C=h(C,I,M,N,l,4,n[36]),N=h(N,C,I,M,m,11,n[37]),M=h(M,N,C,I,y,16,n[38]),I=h(I,M,N,C,k,23,n[39]),C=h(C,I,M,N,O,4,n[40]),N=h(N,C,I,M,o,11,n[41]),M=h(M,N,C,I,p,16,n[42]),I=h(I,M,N,C,g,23,n[43]),C=h(C,I,M,N,w,4,n[44]),N=h(N,C,I,M,_,11,n[45]),M=h(M,N,C,I,x,16,n[46]),C=u(C,I=h(I,M,N,C,f,23,n[47]),M,N,o,6,n[48]),N=u(N,C,I,M,y,10,n[49]),M=u(M,N,C,I,T,15,n[50]),I=u(I,M,N,C,b,21,n[51]),C=u(C,I,M,N,_,6,n[52]),N=u(N,C,I,M,p,10,n[53]),M=u(M,N,C,I,k,15,n[54]),I=u(I,M,N,C,l,21,n[55]),C=u(C,I,M,N,v,6,n[56]),N=u(N,C,I,M,x,10,n[57]),M=u(M,N,C,I,g,15,n[58]),I=u(I,M,N,C,O,21,n[59]),C=u(C,I,M,N,m,6,n[60]),N=u(N,C,I,M,S,10,n[61]),M=u(M,N,C,I,f,15,n[62]),I=u(I,M,N,C,w,21,n[63]),a[0]=a[0]+C|0,a[1]=a[1]+I|0,a[2]=a[2]+M|0,a[3]=a[3]+N|0},_doFinalize:function(){var t=this._data,s=t.words,i=8*this._nDataBytes,r=8*t.sigBytes;s[r>>>5]|=128<<24-r%32;var a=e.floor(i/4294967296),n=i;s[15+(r+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),s[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),t.sigBytes=4*(s.length+1),this._process();for(var o=this._hash,c=o.words,d=0;d<4;d++){var h=c[d];c[d]=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8)}return o},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,s,i,r,a,n){var o=e+(t&s|~t&i)+r+n;return(o<<a|o>>>32-a)+t}function d(e,t,s,i,r,a,n){var o=e+(t&i|s&~i)+r+n;return(o<<a|o>>>32-a)+t}function h(e,t,s,i,r,a,n){var o=e+(t^s^i)+r+n;return(o<<a|o>>>32-a)+t}function u(e,t,s,i,r,a,n){var o=e+(s^(t|~i))+r+n;return(o<<a|o>>>32-a)+t}t.MD5=r._createHelper(o),t.HmacMD5=r._createHmacHelper(o)}(Math),n=(a=l).lib,o=n.WordArray,c=n.Hasher,d=a.algo,h=[],u=d.SHA1=c.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var s=this._hash.words,i=s[0],r=s[1],a=s[2],n=s[3],o=s[4],c=0;c<80;c++){if(c<16)h[c]=0|e[t+c];else{var d=h[c-3]^h[c-8]^h[c-14]^h[c-16];h[c]=d<<1|d>>>31}var u=(i<<5|i>>>27)+o+h[c];u+=c<20?1518500249+(r&a|~r&n):c<40?1859775393+(r^a^n):c<60?(r&a|r&n|a&n)-1894007588:(r^a^n)-899497514,o=n,n=a,a=r<<30|r>>>2,r=i,i=u}s[0]=s[0]+i|0,s[1]=s[1]+r|0,s[2]=s[2]+a|0,s[3]=s[3]+n|0,s[4]=s[4]+o|0},_doFinalize:function(){var e=this._data,t=e.words,s=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=Math.floor(s/4294967296),t[15+(i+64>>>9<<4)]=s,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=c.clone.call(this);return e._hash=this._hash.clone(),e}}),a.SHA1=c._createHelper(u),a.HmacSHA1=c._createHmacHelper(u),function(e){var t=l,s=t.lib,i=s.WordArray,r=s.Hasher,a=t.algo,n=[],o=[];!function(){function t(t){for(var s=e.sqrt(t),i=2;i<=s;i++)if(!(t%i))return!1;return!0}function s(e){return 4294967296*(e-(0|e))|0}for(var i=2,r=0;r<64;)t(i)&&(r<8&&(n[r]=s(e.pow(i,.5))),o[r]=s(e.pow(i,1/3)),r++),i++}();var c=[],d=a.SHA256=r.extend({_doReset:function(){this._hash=new i.init(n.slice(0))},_doProcessBlock:function(e,t){for(var s=this._hash.words,i=s[0],r=s[1],a=s[2],n=s[3],d=s[4],h=s[5],u=s[6],l=s[7],f=0;f<64;f++){if(f<16)c[f]=0|e[t+f];else{var p=c[f-15],m=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,b=c[f-2],g=(b<<15|b>>>17)^(b<<13|b>>>19)^b>>>10;c[f]=m+c[f-7]+g+c[f-16]}var y=i&r^i&a^r&a,v=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),w=l+((d<<26|d>>>6)^(d<<21|d>>>11)^(d<<7|d>>>25))+(d&h^~d&u)+o[f]+c[f];l=u,u=h,h=d,d=n+w|0,n=a,a=r,r=i,i=w+(v+y)|0}s[0]=s[0]+i|0,s[1]=s[1]+r|0,s[2]=s[2]+a|0,s[3]=s[3]+n|0,s[4]=s[4]+d|0,s[5]=s[5]+h|0,s[6]=s[6]+u|0,s[7]=s[7]+l|0},_doFinalize:function(){var t=this._data,s=t.words,i=8*this._nDataBytes,r=8*t.sigBytes;return s[r>>>5]|=128<<24-r%32,s[14+(r+64>>>9<<4)]=e.floor(i/4294967296),s[15+(r+64>>>9<<4)]=i,t.sigBytes=4*s.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=r._createHelper(d),t.HmacSHA256=r._createHmacHelper(d)}(Math),function(){var e=l,t=e.lib.WordArray,s=e.enc;function i(e){return e<<8&4278255360|e>>>8&16711935}s.Utf16=s.Utf16BE={stringify:function(e){for(var t=e.words,s=e.sigBytes,i=[],r=0;r<s;r+=2){var a=t[r>>>2]>>>16-r%4*8&65535;i.push(String.fromCharCode(a))}return i.join("")},parse:function(e){for(var s=e.length,i=[],r=0;r<s;r++)i[r>>>1]|=e.charCodeAt(r)<<16-r%2*16;return t.create(i,2*s)}},s.Utf16LE={stringify:function(e){for(var t=e.words,s=e.sigBytes,r=[],a=0;a<s;a+=2){var n=i(t[a>>>2]>>>16-a%4*8&65535);r.push(String.fromCharCode(n))}return r.join("")},parse:function(e){for(var s=e.length,r=[],a=0;a<s;a++)r[a>>>1]|=i(e.charCodeAt(a)<<16-a%2*16);return t.create(r,2*s)}}}(),function(){if("function"==typeof ArrayBuffer){var e=l.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var s=e.byteLength,i=[],r=0;r<s;r++)i[r>>>2]|=e[r]<<24-r%4*8;t.call(this,i,s)}else t.apply(this,arguments)}).prototype=e}}(),function(e){var t=l,s=t.lib,i=s.WordArray,r=s.Hasher,a=t.algo,n=i.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),o=i.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),c=i.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),d=i.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),h=i.create([0,1518500249,1859775393,2400959708,2840853838]),u=i.create([1352829926,1548603684,1836072691,2053994217,0]),f=a.RIPEMD160=r.extend({_doReset:function(){this._hash=i.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var s=0;s<16;s++){var i=t+s,r=e[i];e[i]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var a,l,f,w,k,S,_,O,T,x,C,I=this._hash.words,M=h.words,N=u.words,A=n.words,E=o.words,P=c.words,B=d.words;for(S=a=I[0],_=l=I[1],O=f=I[2],T=w=I[3],x=k=I[4],s=0;s<80;s+=1)C=a+e[t+A[s]]|0,C+=s<16?p(l,f,w)+M[0]:s<32?m(l,f,w)+M[1]:s<48?b(l,f,w)+M[2]:s<64?g(l,f,w)+M[3]:y(l,f,w)+M[4],C=(C=v(C|=0,P[s]))+k|0,a=k,k=w,w=v(f,10),f=l,l=C,C=S+e[t+E[s]]|0,C+=s<16?y(_,O,T)+N[0]:s<32?g(_,O,T)+N[1]:s<48?b(_,O,T)+N[2]:s<64?m(_,O,T)+N[3]:p(_,O,T)+N[4],C=(C=v(C|=0,B[s]))+x|0,S=x,x=T,T=v(O,10),O=_,_=C;C=I[1]+f+T|0,I[1]=I[2]+w+x|0,I[2]=I[3]+k+S|0,I[3]=I[4]+a+_|0,I[4]=I[0]+l+O|0,I[0]=C},_doFinalize:function(){var e=this._data,t=e.words,s=8*this._nDataBytes,i=8*e.sigBytes;t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),e.sigBytes=4*(t.length+1),this._process();for(var r=this._hash,a=r.words,n=0;n<5;n++){var o=a[n];a[n]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}return r},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});function p(e,t,s){return e^t^s}function m(e,t,s){return e&t|~e&s}function b(e,t,s){return(e|~t)^s}function g(e,t,s){return e&s|t&~s}function y(e,t,s){return e^(t|~s)}function v(e,t){return e<<t|e>>>32-t}t.RIPEMD160=r._createHelper(f),t.HmacRIPEMD160=r._createHmacHelper(f)}(Math),function(){var e=l,t=e.lib.Base,s=e.enc.Utf8;e.algo.HMAC=t.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=s.parse(t));var i=e.blockSize,r=4*i;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var a=this._oKey=t.clone(),n=this._iKey=t.clone(),o=a.words,c=n.words,d=0;d<i;d++)o[d]^=1549556828,c[d]^=909522486;a.sigBytes=n.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,s=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(s))}})}(),function(){var e=l,t=e.lib,s=t.Base,i=t.WordArray,r=e.algo,a=r.SHA1,n=r.HMAC,o=r.PBKDF2=s.extend({cfg:s.extend({keySize:4,hasher:a,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var s=this.cfg,r=n.create(s.hasher,e),a=i.create(),o=i.create([1]),c=a.words,d=o.words,h=s.keySize,u=s.iterations;c.length<h;){var l=r.update(t).finalize(o);r.reset();for(var f=l.words,p=f.length,m=l,b=1;b<u;b++){m=r.finalize(m),r.reset();for(var g=m.words,y=0;y<p;y++)f[y]^=g[y]}a.concat(l),d[0]++}return a.sigBytes=4*h,a}});e.PBKDF2=function(e,t,s){return o.create(s).compute(e,t)}}(),function(){var e=l,t=e.lib,s=t.Base,i=t.WordArray,r=e.algo,a=r.MD5,n=r.EvpKDF=s.extend({cfg:s.extend({keySize:4,hasher:a,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var s=this.cfg,r=s.hasher.create(),a=i.create(),n=a.words,o=s.keySize,c=s.iterations;n.length<o;){d&&r.update(d);var d=r.update(e).finalize(t);r.reset();for(var h=1;h<c;h++)d=r.finalize(d),r.reset();a.concat(d)}return a.sigBytes=4*o,a}});e.EvpKDF=function(e,t,s){return n.create(s).compute(e,t)}}(),function(){var e=l,t=e.lib.WordArray,s=e.algo,i=s.SHA256,r=s.SHA224=i.extend({_doReset:function(){this._hash=new t.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=i._doFinalize.call(this);return e.sigBytes-=4,e}});e.SHA224=i._createHelper(r),e.HmacSHA224=i._createHmacHelper(r)}(),function(e){var t=l,s=t.lib,i=s.Base,r=s.WordArray,a=t.x64={};a.Word=i.extend({init:function(e,t){this.high=e,this.low=t}}),a.WordArray=i.extend({init:function(t,s){t=this.words=t||[],this.sigBytes=s!=e?s:8*t.length},toX32:function(){for(var e=this.words,t=e.length,s=[],i=0;i<t;i++){var a=e[i];s.push(a.high),s.push(a.low)}return r.create(s,this.sigBytes)},clone:function(){for(var e=i.clone.call(this),t=e.words=this.words.slice(0),s=t.length,r=0;r<s;r++)t[r]=t[r].clone();return e}})}(),function(e){var t=l,s=t.lib,i=s.WordArray,r=s.Hasher,a=t.x64.Word,n=t.algo,o=[],c=[],d=[];!function(){for(var e=1,t=0,s=0;s<24;s++){o[e+5*t]=(s+1)*(s+2)/2%64;var i=(2*e+3*t)%5;e=t%5,t=i}for(e=0;e<5;e++)for(t=0;t<5;t++)c[e+5*t]=t+(2*e+3*t)%5*5;for(var r=1,n=0;n<24;n++){for(var h=0,u=0,l=0;l<7;l++){if(1&r){var f=(1<<l)-1;f<32?u^=1<<f:h^=1<<f-32}128&r?r=r<<1^113:r<<=1}d[n]=a.create(h,u)}}();var h=[];!function(){for(var e=0;e<25;e++)h[e]=a.create()}();var u=n.SHA3=r.extend({cfg:r.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var s=this._state,i=this.blockSize/2,r=0;r<i;r++){var a=e[t+2*r],n=e[t+2*r+1];a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),n=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),(I=s[r]).high^=n,I.low^=a}for(var u=0;u<24;u++){for(var l=0;l<5;l++){for(var f=0,p=0,m=0;m<5;m++)f^=(I=s[l+5*m]).high,p^=I.low;var b=h[l];b.high=f,b.low=p}for(l=0;l<5;l++){var g=h[(l+4)%5],y=h[(l+1)%5],v=y.high,w=y.low;for(f=g.high^(v<<1|w>>>31),p=g.low^(w<<1|v>>>31),m=0;m<5;m++)(I=s[l+5*m]).high^=f,I.low^=p}for(var k=1;k<25;k++){var S=(I=s[k]).high,_=I.low,O=o[k];O<32?(f=S<<O|_>>>32-O,p=_<<O|S>>>32-O):(f=_<<O-32|S>>>64-O,p=S<<O-32|_>>>64-O);var T=h[c[k]];T.high=f,T.low=p}var x=h[0],C=s[0];for(x.high=C.high,x.low=C.low,l=0;l<5;l++)for(m=0;m<5;m++){var I=s[k=l+5*m],M=h[k],N=h[(l+1)%5+5*m],A=h[(l+2)%5+5*m];I.high=M.high^~N.high&A.high,I.low=M.low^~N.low&A.low}I=s[0];var E=d[u];I.high^=E.high,I.low^=E.low}},_doFinalize:function(){var t=this._data,s=t.words,r=(this._nDataBytes,8*t.sigBytes),a=32*this.blockSize;s[r>>>5]|=1<<24-r%32,s[(e.ceil((r+1)/a)*a>>>5)-1]|=128,t.sigBytes=4*s.length,this._process();for(var n=this._state,o=this.cfg.outputLength/8,c=o/8,d=[],h=0;h<c;h++){var u=n[h],l=u.high,f=u.low;l=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8),f=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),d.push(f),d.push(l)}return new i.init(d,o)},clone:function(){for(var e=r.clone.call(this),t=e._state=this._state.slice(0),s=0;s<25;s++)t[s]=t[s].clone();return e}});t.SHA3=r._createHelper(u),t.HmacSHA3=r._createHmacHelper(u)}(Math),function(){var e=l,t=e.lib.Hasher,s=e.x64,i=s.Word,r=s.WordArray,a=e.algo;function n(){return i.create.apply(i,arguments)}var o=[n(1116352408,3609767458),n(1899447441,602891725),n(3049323471,3964484399),n(3921009573,2173295548),n(961987163,4081628472),n(1508970993,3053834265),n(2453635748,2937671579),n(2870763221,3664609560),n(3624381080,2734883394),n(310598401,1164996542),n(607225278,1323610764),n(1426881987,3590304994),n(1925078388,4068182383),n(2162078206,991336113),n(2614888103,633803317),n(3248222580,3479774868),n(3835390401,2666613458),n(4022224774,944711139),n(264347078,2341262773),n(604807628,2007800933),n(770255983,1495990901),n(1249150122,1856431235),n(1555081692,3175218132),n(1996064986,2198950837),n(2554220882,3999719339),n(2821834349,766784016),n(2952996808,2566594879),n(3210313671,3203337956),n(3336571891,1034457026),n(3584528711,2466948901),n(113926993,3758326383),n(338241895,168717936),n(666307205,1188179964),n(773529912,1546045734),n(1294757372,1522805485),n(1396182291,2643833823),n(1695183700,2343527390),n(1986661051,1014477480),n(2177026350,1206759142),n(2456956037,344077627),n(2730485921,1290863460),n(2820302411,3158454273),n(3259730800,3505952657),n(3345764771,106217008),n(3516065817,3606008344),n(3600352804,1432725776),n(4094571909,1467031594),n(275423344,851169720),n(430227734,3100823752),n(506948616,1363258195),n(659060556,3750685593),n(883997877,3785050280),n(958139571,3318307427),n(1322822218,3812723403),n(1537002063,2003034995),n(1747873779,3602036899),n(1955562222,1575990012),n(2024104815,1125592928),n(2227730452,2716904306),n(2361852424,442776044),n(2428436474,593698344),n(2756734187,3733110249),n(3204031479,2999351573),n(3329325298,3815920427),n(3391569614,3928383900),n(3515267271,566280711),n(3940187606,3454069534),n(4118630271,4000239992),n(116418474,1914138554),n(174292421,2731055270),n(289380356,3203993006),n(460393269,320620315),n(685471733,587496836),n(852142971,1086792851),n(1017036298,365543100),n(1126000580,2618297676),n(1288033470,3409855158),n(1501505948,4234509866),n(1607167915,987167468),n(1816402316,1246189591)],c=[];!function(){for(var e=0;e<80;e++)c[e]=n()}();var d=a.SHA512=t.extend({_doReset:function(){this._hash=new r.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var s=this._hash.words,i=s[0],r=s[1],a=s[2],n=s[3],d=s[4],h=s[5],u=s[6],l=s[7],f=i.high,p=i.low,m=r.high,b=r.low,g=a.high,y=a.low,v=n.high,w=n.low,k=d.high,S=d.low,_=h.high,O=h.low,T=u.high,x=u.low,C=l.high,I=l.low,M=f,N=p,A=m,E=b,P=g,B=y,V=v,L=w,q=k,D=S,R=_,G=O,F=T,U=x,j=C,H=I,z=0;z<80;z++){var W=c[z];if(z<16)var K=W.high=0|e[t+2*z],X=W.low=0|e[t+2*z+1];else{var Y=c[z-15],Z=Y.high,Q=Y.low,J=(Z>>>1|Q<<31)^(Z>>>8|Q<<24)^Z>>>7,$=(Q>>>1|Z<<31)^(Q>>>8|Z<<24)^(Q>>>7|Z<<25),ee=c[z-2],te=ee.high,se=ee.low,ie=(te>>>19|se<<13)^(te<<3|se>>>29)^te>>>6,re=(se>>>19|te<<13)^(se<<3|te>>>29)^(se>>>6|te<<26),ae=c[z-7],ne=ae.high,oe=ae.low,ce=c[z-16],de=ce.high,he=ce.low;K=(K=(K=J+ne+((X=$+oe)>>>0<$>>>0?1:0))+ie+((X+=re)>>>0<re>>>0?1:0))+de+((X+=he)>>>0<he>>>0?1:0),W.high=K,W.low=X}var ue,le=q&R^~q&F,fe=D&G^~D&U,pe=M&A^M&P^A&P,me=N&E^N&B^E&B,be=(M>>>28|N<<4)^(M<<30|N>>>2)^(M<<25|N>>>7),ge=(N>>>28|M<<4)^(N<<30|M>>>2)^(N<<25|M>>>7),ye=(q>>>14|D<<18)^(q>>>18|D<<14)^(q<<23|D>>>9),ve=(D>>>14|q<<18)^(D>>>18|q<<14)^(D<<23|q>>>9),we=o[z],ke=we.high,Se=we.low,_e=j+ye+((ue=H+ve)>>>0<H>>>0?1:0),Oe=ge+me;j=F,H=U,F=R,U=G,R=q,G=D,q=V+(_e=(_e=(_e=_e+le+((ue+=fe)>>>0<fe>>>0?1:0))+ke+((ue+=Se)>>>0<Se>>>0?1:0))+K+((ue+=X)>>>0<X>>>0?1:0))+((D=L+ue|0)>>>0<L>>>0?1:0)|0,V=P,L=B,P=A,B=E,A=M,E=N,M=_e+(be+pe+(Oe>>>0<ge>>>0?1:0))+((N=ue+Oe|0)>>>0<ue>>>0?1:0)|0}p=i.low=p+N,i.high=f+M+(p>>>0<N>>>0?1:0),b=r.low=b+E,r.high=m+A+(b>>>0<E>>>0?1:0),y=a.low=y+B,a.high=g+P+(y>>>0<B>>>0?1:0),w=n.low=w+L,n.high=v+V+(w>>>0<L>>>0?1:0),S=d.low=S+D,d.high=k+q+(S>>>0<D>>>0?1:0),O=h.low=O+G,h.high=_+R+(O>>>0<G>>>0?1:0),x=u.low=x+U,u.high=T+F+(x>>>0<U>>>0?1:0),I=l.low=I+H,l.high=C+j+(I>>>0<H>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,s=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[30+(i+128>>>10<<5)]=Math.floor(s/4294967296),t[31+(i+128>>>10<<5)]=s,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(d),e.HmacSHA512=t._createHmacHelper(d)}(),function(){var e=l,t=e.x64,s=t.Word,i=t.WordArray,r=e.algo,a=r.SHA512,n=r.SHA384=a.extend({_doReset:function(){this._hash=new i.init([new s.init(3418070365,3238371032),new s.init(1654270250,914150663),new s.init(2438529370,812702999),new s.init(355462360,4144912697),new s.init(1731405415,4290775857),new s.init(2394180231,1750603025),new s.init(3675008525,1694076839),new s.init(1203062813,3204075428)])},_doFinalize:function(){var e=a._doFinalize.call(this);return e.sigBytes-=16,e}});e.SHA384=a._createHelper(n),e.HmacSHA384=a._createHmacHelper(n)}(),l.lib.Cipher||function(e){var t=l,s=t.lib,i=s.Base,r=s.WordArray,a=s.BufferedBlockAlgorithm,n=t.enc,o=(n.Utf8,n.Base64),c=t.algo.EvpKDF,d=s.Cipher=a.extend({cfg:i.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,s){this.cfg=this.cfg.extend(s),this._xformMode=e,this._key=t,this.reset()},reset:function(){a.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?v:g}return function(t){return{encrypt:function(s,i,r){return e(i).encrypt(t,s,i,r)},decrypt:function(s,i,r){return e(i).decrypt(t,s,i,r)}}}}()}),h=(s.StreamCipher=d.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),t.mode={}),u=s.BlockCipherMode=i.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),f=h.CBC=function(){var t=u.extend();function s(t,s,i){var r=this._iv;if(r){var a=r;this._iv=e}else a=this._prevBlock;for(var n=0;n<i;n++)t[s+n]^=a[n]}return t.Encryptor=t.extend({processBlock:function(e,t){var i=this._cipher,r=i.blockSize;s.call(this,e,t,r),i.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),t.Decryptor=t.extend({processBlock:function(e,t){var i=this._cipher,r=i.blockSize,a=e.slice(t,t+r);i.decryptBlock(e,t),s.call(this,e,t,r),this._prevBlock=a}}),t}(),p=(t.pad={}).Pkcs7={pad:function(e,t){for(var s=4*t,i=s-e.sigBytes%s,a=i<<24|i<<16|i<<8|i,n=[],o=0;o<i;o+=4)n.push(a);var c=r.create(n,i);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},m=(s.BlockCipher=d.extend({cfg:d.cfg.extend({mode:f,padding:p}),reset:function(){d.reset.call(this);var e=this.cfg,t=e.iv,s=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var i=s.createEncryptor;else i=s.createDecryptor,this._minBufferSize=1;this._mode&&this._mode.__creator==i?this._mode.init(this,t&&t.words):(this._mode=i.call(s,this,t&&t.words),this._mode.__creator=i)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4}),s.CipherParams=i.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),b=(t.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,s=e.salt;if(s)var i=r.create([1398893684,1701076831]).concat(s).concat(t);else i=t;return i.toString(o)},parse:function(e){var t=o.parse(e),s=t.words;if(1398893684==s[0]&&1701076831==s[1]){var i=r.create(s.slice(2,4));s.splice(0,4),t.sigBytes-=16}return m.create({ciphertext:t,salt:i})}},g=s.SerializableCipher=i.extend({cfg:i.extend({format:b}),encrypt:function(e,t,s,i){i=this.cfg.extend(i);var r=e.createEncryptor(s,i),a=r.finalize(t),n=r.cfg;return m.create({ciphertext:a,key:s,iv:n.iv,algorithm:e,mode:n.mode,padding:n.padding,blockSize:e.blockSize,formatter:i.format})},decrypt:function(e,t,s,i){return i=this.cfg.extend(i),t=this._parse(t,i.format),e.createDecryptor(s,i).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),y=(t.kdf={}).OpenSSL={execute:function(e,t,s,i){i||(i=r.random(8));var a=c.create({keySize:t+s}).compute(e,i),n=r.create(a.words.slice(t),4*s);return a.sigBytes=4*t,m.create({key:a,iv:n,salt:i})}},v=s.PasswordBasedCipher=g.extend({cfg:g.cfg.extend({kdf:y}),encrypt:function(e,t,s,i){var r=(i=this.cfg.extend(i)).kdf.execute(s,e.keySize,e.ivSize);i.iv=r.iv;var a=g.encrypt.call(this,e,t,r.key,i);return a.mixIn(r),a},decrypt:function(e,t,s,i){i=this.cfg.extend(i),t=this._parse(t,i.format);var r=i.kdf.execute(s,e.keySize,e.ivSize,t.salt);return i.iv=r.iv,g.decrypt.call(this,e,t,r.key,i)}})}(),l.mode.CFB=function(){var e=l.lib.BlockCipherMode.extend();function t(e,t,s,i){var r=this._iv;if(r){var a=r.slice(0);this._iv=void 0}else a=this._prevBlock;i.encryptBlock(a,0);for(var n=0;n<s;n++)e[t+n]^=a[n]}return e.Encryptor=e.extend({processBlock:function(e,s){var i=this._cipher,r=i.blockSize;t.call(this,e,s,r,i),this._prevBlock=e.slice(s,s+r)}}),e.Decryptor=e.extend({processBlock:function(e,s){var i=this._cipher,r=i.blockSize,a=e.slice(s,s+r);t.call(this,e,s,r,i),this._prevBlock=a}}),e}(),l.mode.ECB=((r=l.lib.BlockCipherMode.extend()).Encryptor=r.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),r.Decryptor=r.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),r),l.pad.AnsiX923={pad:function(e,t){var s=e.sigBytes,i=4*t,r=i-s%i,a=s+r-1;e.clamp(),e.words[a>>>2]|=r<<24-a%4*8,e.sigBytes+=r},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},l.pad.Iso10126={pad:function(e,t){var s=4*t,i=s-e.sigBytes%s;e.concat(l.lib.WordArray.random(i-1)).concat(l.lib.WordArray.create([i<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},l.pad.Iso97971={pad:function(e,t){e.concat(l.lib.WordArray.create([2147483648],1)),l.pad.ZeroPadding.pad(e,t)},unpad:function(e){l.pad.ZeroPadding.unpad(e),e.sigBytes--}},l.mode.OFB=(s=l.lib.BlockCipherMode.extend(),i=s.Encryptor=s.extend({processBlock:function(e,t){var s=this._cipher,i=s.blockSize,r=this._iv,a=this._keystream;r&&(a=this._keystream=r.slice(0),this._iv=void 0),s.encryptBlock(a,0);for(var n=0;n<i;n++)e[t+n]^=a[n]}}),s.Decryptor=i,s),l.pad.NoPadding={pad:function(){},unpad:function(){}},function(e){var t=l,s=t.lib.CipherParams,i=t.enc.Hex;t.format.Hex={stringify:function(e){return e.ciphertext.toString(i)},parse:function(e){var t=i.parse(e);return s.create({ciphertext:t})}}}(),function(){var e=l,t=e.lib.BlockCipher,s=e.algo,i=[],r=[],a=[],n=[],o=[],c=[],d=[],h=[],u=[],f=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var s=0,l=0;for(t=0;t<256;t++){var p=l^l<<1^l<<2^l<<3^l<<4;p=p>>>8^255&p^99,i[s]=p,r[p]=s;var m=e[s],b=e[m],g=e[b],y=257*e[p]^16843008*p;a[s]=y<<24|y>>>8,n[s]=y<<16|y>>>16,o[s]=y<<8|y>>>24,c[s]=y,y=16843009*g^65537*b^257*m^16843008*s,d[p]=y<<24|y>>>8,h[p]=y<<16|y>>>16,u[p]=y<<8|y>>>24,f[p]=y,s?(s=m^e[e[e[g^m]]],l^=e[e[l]]):s=l=1}}();var p=[0,1,2,4,8,16,32,64,128,27,54],m=s.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,s=e.sigBytes/4,r=4*((this._nRounds=s+6)+1),a=this._keySchedule=[],n=0;n<r;n++)if(n<s)a[n]=t[n];else{var o=a[n-1];n%s?s>6&&n%s==4&&(o=i[o>>>24]<<24|i[o>>>16&255]<<16|i[o>>>8&255]<<8|i[255&o]):(o=i[(o=o<<8|o>>>24)>>>24]<<24|i[o>>>16&255]<<16|i[o>>>8&255]<<8|i[255&o],o^=p[n/s|0]<<24),a[n]=a[n-s]^o}for(var c=this._invKeySchedule=[],l=0;l<r;l++)n=r-l,o=l%4?a[n]:a[n-4],c[l]=l<4||n<=4?o:d[i[o>>>24]]^h[i[o>>>16&255]]^u[i[o>>>8&255]]^f[i[255&o]]}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,a,n,o,c,i)},decryptBlock:function(e,t){var s=e[t+1];e[t+1]=e[t+3],e[t+3]=s,this._doCryptBlock(e,t,this._invKeySchedule,d,h,u,f,r),s=e[t+1],e[t+1]=e[t+3],e[t+3]=s},_doCryptBlock:function(e,t,s,i,r,a,n,o){for(var c=this._nRounds,d=e[t]^s[0],h=e[t+1]^s[1],u=e[t+2]^s[2],l=e[t+3]^s[3],f=4,p=1;p<c;p++){var m=i[d>>>24]^r[h>>>16&255]^a[u>>>8&255]^n[255&l]^s[f++],b=i[h>>>24]^r[u>>>16&255]^a[l>>>8&255]^n[255&d]^s[f++],g=i[u>>>24]^r[l>>>16&255]^a[d>>>8&255]^n[255&h]^s[f++],y=i[l>>>24]^r[d>>>16&255]^a[h>>>8&255]^n[255&u]^s[f++];d=m,h=b,u=g,l=y}m=(o[d>>>24]<<24|o[h>>>16&255]<<16|o[u>>>8&255]<<8|o[255&l])^s[f++],b=(o[h>>>24]<<24|o[u>>>16&255]<<16|o[l>>>8&255]<<8|o[255&d])^s[f++],g=(o[u>>>24]<<24|o[l>>>16&255]<<16|o[d>>>8&255]<<8|o[255&h])^s[f++],y=(o[l>>>24]<<24|o[d>>>16&255]<<16|o[h>>>8&255]<<8|o[255&u])^s[f++],e[t]=m,e[t+1]=b,e[t+2]=g,e[t+3]=y},keySize:8});e.AES=t._createHelper(m)}(),function(){var e=l,t=e.lib,s=t.WordArray,i=t.BlockCipher,r=e.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],n=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],o=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],d=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],h=r.DES=i.extend({_doReset:function(){for(var e=this._key.words,t=[],s=0;s<56;s++){var i=a[s]-1;t[s]=e[i>>>5]>>>31-i%32&1}for(var r=this._subKeys=[],c=0;c<16;c++){var d=r[c]=[],h=o[c];for(s=0;s<24;s++)d[s/6|0]|=t[(n[s]-1+h)%28]<<31-s%6,d[4+(s/6|0)]|=t[28+(n[s+24]-1+h)%28]<<31-s%6;for(d[0]=d[0]<<1|d[0]>>>31,s=1;s<7;s++)d[s]=d[s]>>>4*(s-1)+3;d[7]=d[7]<<5|d[7]>>>27}var u=this._invSubKeys=[];for(s=0;s<16;s++)u[s]=r[15-s]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,s){this._lBlock=e[t],this._rBlock=e[t+1],u.call(this,4,252645135),u.call(this,16,65535),f.call(this,2,858993459),f.call(this,8,16711935),u.call(this,1,1431655765);for(var i=0;i<16;i++){for(var r=s[i],a=this._lBlock,n=this._rBlock,o=0,h=0;h<8;h++)o|=c[h][((n^r[h])&d[h])>>>0];this._lBlock=n,this._rBlock=a^o}var l=this._lBlock;this._lBlock=this._rBlock,this._rBlock=l,u.call(this,1,1431655765),f.call(this,8,16711935),f.call(this,2,858993459),u.call(this,16,65535),u.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function u(e,t){var s=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=s,this._lBlock^=s<<e}function f(e,t){var s=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=s,this._rBlock^=s<<e}e.DES=i._createHelper(h);var p=r.TripleDES=i.extend({_doReset:function(){var e=this._key.words;this._des1=h.createEncryptor(s.create(e.slice(0,2))),this._des2=h.createEncryptor(s.create(e.slice(2,4))),this._des3=h.createEncryptor(s.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=i._createHelper(p)}(),function(){var e=l,t=e.lib.StreamCipher,s=e.algo,i=s.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,s=e.sigBytes,i=this._S=[],r=0;r<256;r++)i[r]=r;r=0;for(var a=0;r<256;r++){var n=r%s,o=t[n>>>2]>>>24-n%4*8&255;a=(a+i[r]+o)%256;var c=i[r];i[r]=i[a],i[a]=c}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=r.call(this)},keySize:8,ivSize:0});function r(){for(var e=this._S,t=this._i,s=this._j,i=0,r=0;r<4;r++){s=(s+e[t=(t+1)%256])%256;var a=e[t];e[t]=e[s],e[s]=a,i|=e[(e[t]+e[s])%256]<<24-8*r}return this._i=t,this._j=s,i}e.RC4=t._createHelper(i);var a=s.RC4Drop=i.extend({cfg:i.cfg.extend({drop:192}),_doReset:function(){i._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)r.call(this)}});e.RC4Drop=t._createHelper(a)}(),l.mode.CTRGladman=function(){var e=l.lib.BlockCipherMode.extend();function t(e){if(255==(e>>24&255)){var t=e>>16&255,s=e>>8&255,i=255&e;255===t?(t=0,255===s?(s=0,255===i?i=0:++i):++s):++t,e=0,e+=t<<16,e+=s<<8,e+=i}else e+=1<<24;return e}function s(e){return 0===(e[0]=t(e[0]))&&(e[1]=t(e[1])),e}var i=e.Encryptor=e.extend({processBlock:function(e,t){var i=this._cipher,r=i.blockSize,a=this._iv,n=this._counter;a&&(n=this._counter=a.slice(0),this._iv=void 0),s(n);var o=n.slice(0);i.encryptBlock(o,0);for(var c=0;c<r;c++)e[t+c]^=o[c]}});return e.Decryptor=i,e}(),function(){var e=l,t=e.lib.StreamCipher,s=e.algo,i=[],r=[],a=[],n=s.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,s=0;s<4;s++)e[s]=16711935&(e[s]<<8|e[s]>>>24)|4278255360&(e[s]<<24|e[s]>>>8);var i=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,s=0;s<4;s++)o.call(this);for(s=0;s<8;s++)r[s]^=i[s+4&7];if(t){var a=t.words,n=a[0],c=a[1],d=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),h=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8),u=d>>>16|4294901760&h,l=h<<16|65535&d;for(r[0]^=d,r[1]^=u,r[2]^=h,r[3]^=l,r[4]^=d,r[5]^=u,r[6]^=h,r[7]^=l,s=0;s<4;s++)o.call(this)}},_doProcessBlock:function(e,t){var s=this._X;o.call(this),i[0]=s[0]^s[5]>>>16^s[3]<<16,i[1]=s[2]^s[7]>>>16^s[5]<<16,i[2]=s[4]^s[1]>>>16^s[7]<<16,i[3]=s[6]^s[3]>>>16^s[1]<<16;for(var r=0;r<4;r++)i[r]=16711935&(i[r]<<8|i[r]>>>24)|4278255360&(i[r]<<24|i[r]>>>8),e[t+r]^=i[r]},blockSize:4,ivSize:2});function o(){for(var e=this._X,t=this._C,s=0;s<8;s++)r[s]=t[s];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<r[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<r[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<r[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<r[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<r[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<r[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<r[6]>>>0?1:0)|0,this._b=t[7]>>>0<r[7]>>>0?1:0,s=0;s<8;s++){var i=e[s]+t[s],n=65535&i,o=i>>>16,c=((n*n>>>17)+n*o>>>15)+o*o,d=((4294901760&i)*i|0)+((65535&i)*i|0);a[s]=c^d}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.Rabbit=t._createHelper(n)}(),l.mode.CTR=function(){var e=l.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(e,t){var s=this._cipher,i=s.blockSize,r=this._iv,a=this._counter;r&&(a=this._counter=r.slice(0),this._iv=void 0);var n=a.slice(0);s.encryptBlock(n,0),a[i-1]=a[i-1]+1|0;for(var o=0;o<i;o++)e[t+o]^=n[o]}});return e.Decryptor=t,e}(),function(){var e=l,t=e.lib.StreamCipher,s=e.algo,i=[],r=[],a=[],n=s.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,s=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var r=0;r<4;r++)o.call(this);for(r=0;r<8;r++)i[r]^=s[r+4&7];if(t){var a=t.words,n=a[0],c=a[1],d=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),h=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8),u=d>>>16|4294901760&h,l=h<<16|65535&d;for(i[0]^=d,i[1]^=u,i[2]^=h,i[3]^=l,i[4]^=d,i[5]^=u,i[6]^=h,i[7]^=l,r=0;r<4;r++)o.call(this)}},_doProcessBlock:function(e,t){var s=this._X;o.call(this),i[0]=s[0]^s[5]>>>16^s[3]<<16,i[1]=s[2]^s[7]>>>16^s[5]<<16,i[2]=s[4]^s[1]>>>16^s[7]<<16,i[3]=s[6]^s[3]>>>16^s[1]<<16;for(var r=0;r<4;r++)i[r]=16711935&(i[r]<<8|i[r]>>>24)|4278255360&(i[r]<<24|i[r]>>>8),e[t+r]^=i[r]},blockSize:4,ivSize:2});function o(){for(var e=this._X,t=this._C,s=0;s<8;s++)r[s]=t[s];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<r[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<r[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<r[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<r[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<r[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<r[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<r[6]>>>0?1:0)|0,this._b=t[7]>>>0<r[7]>>>0?1:0,s=0;s<8;s++){var i=e[s]+t[s],n=65535&i,o=i>>>16,c=((n*n>>>17)+n*o>>>15)+o*o,d=((4294901760&i)*i|0)+((65535&i)*i|0);a[s]=c^d}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.RabbitLegacy=t._createHelper(n)}(),l.pad.ZeroPadding={pad:function(e,t){var s=4*t;e.clamp(),e.sigBytes+=s-(e.sigBytes%s||s)},unpad:function(e){for(var t=e.words,s=e.sigBytes-1;!(t[s>>>2]>>>24-s%4*8&255);)s--;e.sigBytes=s+1}},l)},3150:(e,t,s)=>{"use strict";var i=t;i.inherits=function(e,t){e.super_=t;var s=function(){};s.prototype=t.prototype,e.prototype=new s,e.prototype.constructor=e},i.version="6.5.0",i.utils=s(7882),i.curve=s(5261),i.curves=s(1198),i.ec=s(1643),i.eddsa=s(9214)},3235:(e,t,s)=>{"use strict";var i=s(5060),r=s(3150).utils,a=r.getNAF,n=r.getJSF,o=r.assert;function c(e,t){this.type=e,this.p=new i(t.p,16),this.red=t.prime?i.red(t.prime):i.mont(this.p),this.zero=new i(0).toRed(this.red),this.one=new i(1).toRed(this.red),this.two=new i(2).toRed(this.red),this.n=t.n&&new i(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4);var s=this.n&&this.p.div(this.n);!s||s.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function d(e,t){this.curve=e,this.type=t,this.precomputed=null}e.exports=c,c.prototype.point=function(){throw new Error("Not implemented")},c.prototype.validate=function(){throw new Error("Not implemented")},c.prototype._fixedNafMul=function(e,t){o(e.precomputed);var s=e._getDoubles(),i=a(t,1),r=(1<<s.step+1)-(s.step%2==0?2:1);r/=3;for(var n=[],c=0;c<i.length;c+=s.step){var d=0;for(t=c+s.step-1;t>=c;t--)d=(d<<1)+i[t];n.push(d)}for(var h=this.jpoint(null,null,null),u=this.jpoint(null,null,null),l=r;l>0;l--){for(c=0;c<n.length;c++){(d=n[c])===l?u=u.mixedAdd(s.points[c]):d===-l&&(u=u.mixedAdd(s.points[c].neg()))}h=h.add(u)}return h.toP()},c.prototype._wnafMul=function(e,t){var s=4,i=e._getNAFPoints(s);s=i.wnd;for(var r=i.points,n=a(t,s),c=this.jpoint(null,null,null),d=n.length-1;d>=0;d--){for(t=0;d>=0&&0===n[d];d--)t++;if(d>=0&&t++,c=c.dblp(t),d<0)break;var h=n[d];o(0!==h),c="affine"===e.type?h>0?c.mixedAdd(r[h-1>>1]):c.mixedAdd(r[-h-1>>1].neg()):h>0?c.add(r[h-1>>1]):c.add(r[-h-1>>1].neg())}return"affine"===e.type?c.toP():c},c.prototype._wnafMulAdd=function(e,t,s,i,r){for(var o=this._wnafT1,c=this._wnafT2,d=this._wnafT3,h=0,u=0;u<i;u++){var l=(T=t[u])._getNAFPoints(e);o[u]=l.wnd,c[u]=l.points}for(u=i-1;u>=1;u-=2){var f=u-1,p=u;if(1===o[f]&&1===o[p]){var m=[t[f],null,null,t[p]];0===t[f].y.cmp(t[p].y)?(m[1]=t[f].add(t[p]),m[2]=t[f].toJ().mixedAdd(t[p].neg())):0===t[f].y.cmp(t[p].y.redNeg())?(m[1]=t[f].toJ().mixedAdd(t[p]),m[2]=t[f].add(t[p].neg())):(m[1]=t[f].toJ().mixedAdd(t[p]),m[2]=t[f].toJ().mixedAdd(t[p].neg()));var b=[-3,-1,-5,-7,0,7,5,1,3],g=n(s[f],s[p]);h=Math.max(g[0].length,h),d[f]=new Array(h),d[p]=new Array(h);for(var y=0;y<h;y++){var v=0|g[0][y],w=0|g[1][y];d[f][y]=b[3*(v+1)+(w+1)],d[p][y]=0,c[f]=m}}else d[f]=a(s[f],o[f]),d[p]=a(s[p],o[p]),h=Math.max(d[f].length,h),h=Math.max(d[p].length,h)}var k=this.jpoint(null,null,null),S=this._wnafT4;for(u=h;u>=0;u--){for(var _=0;u>=0;){var O=!0;for(y=0;y<i;y++)S[y]=0|d[y][u],0!==S[y]&&(O=!1);if(!O)break;_++,u--}if(u>=0&&_++,k=k.dblp(_),u<0)break;for(y=0;y<i;y++){var T,x=S[y];0!==x&&(x>0?T=c[y][x-1>>1]:x<0&&(T=c[y][-x-1>>1].neg()),k="affine"===T.type?k.mixedAdd(T):k.add(T))}}for(u=0;u<i;u++)c[u]=null;return r?k:k.toP()},c.BasePoint=d,d.prototype.eq=function(){throw new Error("Not implemented")},d.prototype.validate=function(){return this.curve.validate(this)},c.prototype.decodePoint=function(e,t){e=r.toArray(e,t);var s=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1==2*s)return 6===e[0]?o(e[e.length-1]%2==0):7===e[0]&&o(e[e.length-1]%2==1),this.point(e.slice(1,1+s),e.slice(1+s,1+2*s));if((2===e[0]||3===e[0])&&e.length-1===s)return this.pointFromX(e.slice(1,1+s),3===e[0]);throw new Error("Unknown point format")},d.prototype.encodeCompressed=function(e){return this.encode(e,!0)},d.prototype._encode=function(e){var t=this.curve.p.byteLength(),s=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(s):[4].concat(s,this.getY().toArray("be",t))},d.prototype.encode=function(e,t){return r.encode(this._encode(t),e)},d.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},d.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},d.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var s=[this],i=this,r=0;r<t;r+=e){for(var a=0;a<e;a++)i=i.dbl();s.push(i)}return{step:e,points:s}},d.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],s=(1<<e)-1,i=1===s?null:this.dbl(),r=1;r<s;r++)t[r]=t[r-1].add(i);return{wnd:e,points:t}},d.prototype._getBeta=function(){return null},d.prototype.dblp=function(e){for(var t=this,s=0;s<e;s++)t=t.dbl();return t}},5595:(e,t,s)=>{"use strict";var i=s(5261),r=s(3150),a=s(5060),n=r.inherits,o=i.base,c=r.utils.assert;function d(e){this.twisted=1!=(0|e.a),this.mOneA=this.twisted&&-1==(0|e.a),this.extended=this.mOneA,o.call(this,"edwards",e),this.a=new a(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new a(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new a(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),c(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|e.c)}function h(e,t,s,i,r){o.BasePoint.call(this,e,"projective"),null===t&&null===s&&null===i?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new a(t,16),this.y=new a(s,16),this.z=i?new a(i,16):this.curve.one,this.t=r&&new a(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}n(d,o),e.exports=d,d.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},d.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},d.prototype.jpoint=function(e,t,s,i){return this.point(e,t,s,i)},d.prototype.pointFromX=function(e,t){(e=new a(e,16)).red||(e=e.toRed(this.red));var s=e.redSqr(),i=this.c2.redSub(this.a.redMul(s)),r=this.one.redSub(this.c2.redMul(this.d).redMul(s)),n=i.redMul(r.redInvm()),o=n.redSqrt();if(0!==o.redSqr().redSub(n).cmp(this.zero))throw new Error("invalid point");var c=o.fromRed().isOdd();return(t&&!c||!t&&c)&&(o=o.redNeg()),this.point(e,o)},d.prototype.pointFromY=function(e,t){(e=new a(e,16)).red||(e=e.toRed(this.red));var s=e.redSqr(),i=s.redSub(this.one),r=s.redMul(this.d).redAdd(this.one),n=i.redMul(r.redInvm());if(0===n.cmp(this.zero)){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var o=n.redSqrt();if(0!==o.redSqr().redSub(n).cmp(this.zero))throw new Error("invalid point");return o.isOdd()!==t&&(o=o.redNeg()),this.point(o,e)},d.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),s=e.y.redSqr(),i=t.redMul(this.a).redAdd(s),r=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(s)));return 0===i.cmp(r)},n(h,o.BasePoint),d.prototype.pointFromJSON=function(e){return h.fromJSON(this,e)},d.prototype.point=function(e,t,s,i){return new h(this,e,t,s,i)},h.fromJSON=function(e,t){return new h(e,t[0],t[1],t[2])},h.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},h.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&0===this.y.cmp(this.z)},h.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),s=this.z.redSqr();s=s.redIAdd(s);var i=this.curve._mulA(e),r=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),a=i.redAdd(t),n=a.redSub(s),o=i.redSub(t),c=r.redMul(n),d=a.redMul(o),h=r.redMul(o),u=n.redMul(a);return this.curve.point(c,d,u,h)},h.prototype._projDbl=function(){var e,t,s,i=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),a=this.y.redSqr();if(this.curve.twisted){var n=(d=this.curve._mulA(r)).redAdd(a);if(this.zOne)e=i.redSub(r).redSub(a).redMul(n.redSub(this.curve.two)),t=n.redMul(d.redSub(a)),s=n.redSqr().redSub(n).redSub(n);else{var o=this.z.redSqr(),c=n.redSub(o).redISub(o);e=i.redSub(r).redISub(a).redMul(c),t=n.redMul(d.redSub(a)),s=n.redMul(c)}}else{var d=r.redAdd(a);o=this.curve._mulC(this.c.redMul(this.z)).redSqr(),c=d.redSub(o).redSub(o);e=this.curve._mulC(i.redISub(d)).redMul(c),t=this.curve._mulC(d).redMul(r.redISub(a)),s=d.redMul(c)}return this.curve.point(e,t,s)},h.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},h.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),s=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),i=this.t.redMul(this.curve.dd).redMul(e.t),r=this.z.redMul(e.z.redAdd(e.z)),a=s.redSub(t),n=r.redSub(i),o=r.redAdd(i),c=s.redAdd(t),d=a.redMul(n),h=o.redMul(c),u=a.redMul(c),l=n.redMul(o);return this.curve.point(d,h,l,u)},h.prototype._projAdd=function(e){var t,s,i=this.z.redMul(e.z),r=i.redSqr(),a=this.x.redMul(e.x),n=this.y.redMul(e.y),o=this.curve.d.redMul(a).redMul(n),c=r.redSub(o),d=r.redAdd(o),h=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(a).redISub(n),u=i.redMul(c).redMul(h);return this.curve.twisted?(t=i.redMul(d).redMul(n.redSub(this.curve._mulA(a))),s=c.redMul(d)):(t=i.redMul(d).redMul(n.redSub(a)),s=this.curve._mulC(c).redMul(d)),this.curve.point(u,t,s)},h.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},h.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},h.prototype.mulAdd=function(e,t,s){return this.curve._wnafMulAdd(1,[this,t],[e,s],2,!1)},h.prototype.jmulAdd=function(e,t,s){return this.curve._wnafMulAdd(1,[this,t],[e,s],2,!0)},h.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},h.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},h.prototype.getX=function(){return this.normalize(),this.x.fromRed()},h.prototype.getY=function(){return this.normalize(),this.y.fromRed()},h.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},h.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(t))return!0;for(var s=e.clone(),i=this.curve.redN.redMul(this.z);;){if(s.iadd(this.curve.n),s.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(i),0===this.x.cmp(t))return!0}return!1},h.prototype.toP=h.prototype.normalize,h.prototype.mixedAdd=h.prototype.add},5261:(e,t,s)=>{"use strict";var i=t;i.base=s(3235),i.short=s(2669),i.mont=s(4152),i.edwards=s(5595)},4152:(e,t,s)=>{"use strict";var i=s(5261),r=s(5060),a=s(3150).inherits,n=i.base,o=s(3150).utils;function c(e){n.call(this,"mont",e),this.a=new r(e.a,16).toRed(this.red),this.b=new r(e.b,16).toRed(this.red),this.i4=new r(4).toRed(this.red).redInvm(),this.two=new r(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function d(e,t,s){n.BasePoint.call(this,e,"projective"),null===t&&null===s?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new r(t,16),this.z=new r(s,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}a(c,n),e.exports=c,c.prototype.validate=function(e){var t=e.normalize().x,s=t.redSqr(),i=s.redMul(t).redAdd(s.redMul(this.a)).redAdd(t);return 0===i.redSqrt().redSqr().cmp(i)},a(d,n.BasePoint),c.prototype.decodePoint=function(e,t){return this.point(o.toArray(e,t),1)},c.prototype.point=function(e,t){return new d(this,e,t)},c.prototype.pointFromJSON=function(e){return d.fromJSON(this,e)},d.prototype.precompute=function(){},d.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},d.fromJSON=function(e,t){return new d(e,t[0],t[1]||e.one)},d.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},d.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},d.prototype.dbl=function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),s=e.redSub(t),i=e.redMul(t),r=s.redMul(t.redAdd(this.curve.a24.redMul(s)));return this.curve.point(i,r)},d.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},d.prototype.diffAdd=function(e,t){var s=this.x.redAdd(this.z),i=this.x.redSub(this.z),r=e.x.redAdd(e.z),a=e.x.redSub(e.z).redMul(s),n=r.redMul(i),o=t.z.redMul(a.redAdd(n).redSqr()),c=t.x.redMul(a.redISub(n).redSqr());return this.curve.point(o,c)},d.prototype.mul=function(e){for(var t=e.clone(),s=this,i=this.curve.point(null,null),r=[];0!==t.cmpn(0);t.iushrn(1))r.push(t.andln(1));for(var a=r.length-1;a>=0;a--)0===r[a]?(s=s.diffAdd(i,this),i=i.dbl()):(i=s.diffAdd(i,this),s=s.dbl());return i},d.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},d.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},d.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},d.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},d.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},2669:(e,t,s)=>{"use strict";var i=s(5261),r=s(3150),a=s(5060),n=r.inherits,o=i.base,c=r.utils.assert;function d(e){o.call(this,"short",e),this.a=new a(e.a,16).toRed(this.red),this.b=new a(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function h(e,t,s,i){o.BasePoint.call(this,e,"affine"),null===t&&null===s?(this.x=null,this.y=null,this.inf=!0):(this.x=new a(t,16),this.y=new a(s,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function u(e,t,s,i){o.BasePoint.call(this,e,"jacobian"),null===t&&null===s&&null===i?(this.x=this.curve.one,this.y=this.curve.one,this.z=new a(0)):(this.x=new a(t,16),this.y=new a(s,16),this.z=new a(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}n(d,o),e.exports=d,d.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var t,s;if(e.beta)t=new a(e.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);t=(t=i[0].cmp(i[1])<0?i[0]:i[1]).toRed(this.red)}if(e.lambda)s=new a(e.lambda,16);else{var r=this._getEndoRoots(this.n);0===this.g.mul(r[0]).x.cmp(this.g.x.redMul(t))?s=r[0]:(s=r[1],c(0===this.g.mul(s).x.cmp(this.g.x.redMul(t))))}return{beta:t,lambda:s,basis:e.basis?e.basis.map((function(e){return{a:new a(e.a,16),b:new a(e.b,16)}})):this._getEndoBasis(s)}}},d.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:a.mont(e),s=new a(2).toRed(t).redInvm(),i=s.redNeg(),r=new a(3).toRed(t).redNeg().redSqrt().redMul(s);return[i.redAdd(r).fromRed(),i.redSub(r).fromRed()]},d.prototype._getEndoBasis=function(e){for(var t,s,i,r,n,o,c,d,h,u=this.n.ushrn(Math.floor(this.n.bitLength()/2)),l=e,f=this.n.clone(),p=new a(1),m=new a(0),b=new a(0),g=new a(1),y=0;0!==l.cmpn(0);){var v=f.div(l);d=f.sub(v.mul(l)),h=b.sub(v.mul(p));var w=g.sub(v.mul(m));if(!i&&d.cmp(u)<0)t=c.neg(),s=p,i=d.neg(),r=h;else if(i&&2==++y)break;c=d,f=l,l=d,b=p,p=h,g=m,m=w}n=d.neg(),o=h;var k=i.sqr().add(r.sqr());return n.sqr().add(o.sqr()).cmp(k)>=0&&(n=t,o=s),i.negative&&(i=i.neg(),r=r.neg()),n.negative&&(n=n.neg(),o=o.neg()),[{a:i,b:r},{a:n,b:o}]},d.prototype._endoSplit=function(e){var t=this.endo.basis,s=t[0],i=t[1],r=i.b.mul(e).divRound(this.n),a=s.b.neg().mul(e).divRound(this.n),n=r.mul(s.a),o=a.mul(i.a),c=r.mul(s.b),d=a.mul(i.b);return{k1:e.sub(n).sub(o),k2:c.add(d).neg()}},d.prototype.pointFromX=function(e,t){(e=new a(e,16)).red||(e=e.toRed(this.red));var s=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),i=s.redSqrt();if(0!==i.redSqr().redSub(s).cmp(this.zero))throw new Error("invalid point");var r=i.fromRed().isOdd();return(t&&!r||!t&&r)&&(i=i.redNeg()),this.point(e,i)},d.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,s=e.y,i=this.a.redMul(t),r=t.redSqr().redMul(t).redIAdd(i).redIAdd(this.b);return 0===s.redSqr().redISub(r).cmpn(0)},d.prototype._endoWnafMulAdd=function(e,t,s){for(var i=this._endoWnafT1,r=this._endoWnafT2,a=0;a<e.length;a++){var n=this._endoSplit(t[a]),o=e[a],c=o._getBeta();n.k1.negative&&(n.k1.ineg(),o=o.neg(!0)),n.k2.negative&&(n.k2.ineg(),c=c.neg(!0)),i[2*a]=o,i[2*a+1]=c,r[2*a]=n.k1,r[2*a+1]=n.k2}for(var d=this._wnafMulAdd(1,i,r,2*a,s),h=0;h<2*a;h++)i[h]=null,r[h]=null;return d},n(h,o.BasePoint),d.prototype.point=function(e,t,s){return new h(this,e,t,s)},d.prototype.pointFromJSON=function(e,t){return h.fromJSON(this,e,t)},h.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var s=this.curve,i=function(e){return s.point(e.x.redMul(s.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(i)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(i)}}}return t}},h.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},h.fromJSON=function(e,t,s){"string"==typeof t&&(t=JSON.parse(t));var i=e.point(t[0],t[1],s);if(!t[2])return i;function r(t){return e.point(t[0],t[1],s)}var a=t[2];return i.precomputed={beta:null,doubles:a.doubles&&{step:a.doubles.step,points:[i].concat(a.doubles.points.map(r))},naf:a.naf&&{wnd:a.naf.wnd,points:[i].concat(a.naf.points.map(r))}},i},h.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},h.prototype.isInfinity=function(){return this.inf},h.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var s=t.redSqr().redISub(this.x).redISub(e.x),i=t.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,i)},h.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,s=this.x.redSqr(),i=e.redInvm(),r=s.redAdd(s).redIAdd(s).redIAdd(t).redMul(i),a=r.redSqr().redISub(this.x.redAdd(this.x)),n=r.redMul(this.x.redSub(a)).redISub(this.y);return this.curve.point(a,n)},h.prototype.getX=function(){return this.x.fromRed()},h.prototype.getY=function(){return this.y.fromRed()},h.prototype.mul=function(e){return e=new a(e,16),this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},h.prototype.mulAdd=function(e,t,s){var i=[this,t],r=[e,s];return this.curve.endo?this.curve._endoWnafMulAdd(i,r):this.curve._wnafMulAdd(1,i,r,2)},h.prototype.jmulAdd=function(e,t,s){var i=[this,t],r=[e,s];return this.curve.endo?this.curve._endoWnafMulAdd(i,r,!0):this.curve._wnafMulAdd(1,i,r,2,!0)},h.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},h.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var s=this.precomputed,i=function(e){return e.neg()};t.precomputed={naf:s.naf&&{wnd:s.naf.wnd,points:s.naf.points.map(i)},doubles:s.doubles&&{step:s.doubles.step,points:s.doubles.points.map(i)}}}return t},h.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},n(u,o.BasePoint),d.prototype.jpoint=function(e,t,s){return new u(this,e,t,s)},u.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),s=this.x.redMul(t),i=this.y.redMul(t).redMul(e);return this.curve.point(s,i)},u.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},u.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),s=this.z.redSqr(),i=this.x.redMul(t),r=e.x.redMul(s),a=this.y.redMul(t.redMul(e.z)),n=e.y.redMul(s.redMul(this.z)),o=i.redSub(r),c=a.redSub(n);if(0===o.cmpn(0))return 0!==c.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var d=o.redSqr(),h=d.redMul(o),u=i.redMul(d),l=c.redSqr().redIAdd(h).redISub(u).redISub(u),f=c.redMul(u.redISub(l)).redISub(a.redMul(h)),p=this.z.redMul(e.z).redMul(o);return this.curve.jpoint(l,f,p)},u.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),s=this.x,i=e.x.redMul(t),r=this.y,a=e.y.redMul(t).redMul(this.z),n=s.redSub(i),o=r.redSub(a);if(0===n.cmpn(0))return 0!==o.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=n.redSqr(),d=c.redMul(n),h=s.redMul(c),u=o.redSqr().redIAdd(d).redISub(h).redISub(h),l=o.redMul(h.redISub(u)).redISub(r.redMul(d)),f=this.z.redMul(n);return this.curve.jpoint(u,l,f)},u.prototype.dblp=function(e){if(0===e)return this;if(this.isInfinity())return this;if(!e)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var t=this,s=0;s<e;s++)t=t.dbl();return t}var i=this.curve.a,r=this.curve.tinv,a=this.x,n=this.y,o=this.z,c=o.redSqr().redSqr(),d=n.redAdd(n);for(s=0;s<e;s++){var h=a.redSqr(),u=d.redSqr(),l=u.redSqr(),f=h.redAdd(h).redIAdd(h).redIAdd(i.redMul(c)),p=a.redMul(u),m=f.redSqr().redISub(p.redAdd(p)),b=p.redISub(m),g=f.redMul(b);g=g.redIAdd(g).redISub(l);var y=d.redMul(o);s+1<e&&(c=c.redMul(l)),a=m,o=y,d=g}return this.curve.jpoint(a,d.redMul(r),o)},u.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},u.prototype._zeroDbl=function(){var e,t,s;if(this.zOne){var i=this.x.redSqr(),r=this.y.redSqr(),a=r.redSqr(),n=this.x.redAdd(r).redSqr().redISub(i).redISub(a);n=n.redIAdd(n);var o=i.redAdd(i).redIAdd(i),c=o.redSqr().redISub(n).redISub(n),d=a.redIAdd(a);d=(d=d.redIAdd(d)).redIAdd(d),e=c,t=o.redMul(n.redISub(c)).redISub(d),s=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),u=this.y.redSqr(),l=u.redSqr(),f=this.x.redAdd(u).redSqr().redISub(h).redISub(l);f=f.redIAdd(f);var p=h.redAdd(h).redIAdd(h),m=p.redSqr(),b=l.redIAdd(l);b=(b=b.redIAdd(b)).redIAdd(b),e=m.redISub(f).redISub(f),t=p.redMul(f.redISub(e)).redISub(b),s=(s=this.y.redMul(this.z)).redIAdd(s)}return this.curve.jpoint(e,t,s)},u.prototype._threeDbl=function(){var e,t,s;if(this.zOne){var i=this.x.redSqr(),r=this.y.redSqr(),a=r.redSqr(),n=this.x.redAdd(r).redSqr().redISub(i).redISub(a);n=n.redIAdd(n);var o=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),c=o.redSqr().redISub(n).redISub(n);e=c;var d=a.redIAdd(a);d=(d=d.redIAdd(d)).redIAdd(d),t=o.redMul(n.redISub(c)).redISub(d),s=this.y.redAdd(this.y)}else{var h=this.z.redSqr(),u=this.y.redSqr(),l=this.x.redMul(u),f=this.x.redSub(h).redMul(this.x.redAdd(h));f=f.redAdd(f).redIAdd(f);var p=l.redIAdd(l),m=(p=p.redIAdd(p)).redAdd(p);e=f.redSqr().redISub(m),s=this.y.redAdd(this.z).redSqr().redISub(u).redISub(h);var b=u.redSqr();b=(b=(b=b.redIAdd(b)).redIAdd(b)).redIAdd(b),t=f.redMul(p.redISub(e)).redISub(b)}return this.curve.jpoint(e,t,s)},u.prototype._dbl=function(){var e=this.curve.a,t=this.x,s=this.y,i=this.z,r=i.redSqr().redSqr(),a=t.redSqr(),n=s.redSqr(),o=a.redAdd(a).redIAdd(a).redIAdd(e.redMul(r)),c=t.redAdd(t),d=(c=c.redIAdd(c)).redMul(n),h=o.redSqr().redISub(d.redAdd(d)),u=d.redISub(h),l=n.redSqr();l=(l=(l=l.redIAdd(l)).redIAdd(l)).redIAdd(l);var f=o.redMul(u).redISub(l),p=s.redAdd(s).redMul(i);return this.curve.jpoint(h,f,p)},u.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),s=this.z.redSqr(),i=t.redSqr(),r=e.redAdd(e).redIAdd(e),a=r.redSqr(),n=this.x.redAdd(t).redSqr().redISub(e).redISub(i),o=(n=(n=(n=n.redIAdd(n)).redAdd(n).redIAdd(n)).redISub(a)).redSqr(),c=i.redIAdd(i);c=(c=(c=c.redIAdd(c)).redIAdd(c)).redIAdd(c);var d=r.redIAdd(n).redSqr().redISub(a).redISub(o).redISub(c),h=t.redMul(d);h=(h=h.redIAdd(h)).redIAdd(h);var u=this.x.redMul(o).redISub(h);u=(u=u.redIAdd(u)).redIAdd(u);var l=this.y.redMul(d.redMul(c.redISub(d)).redISub(n.redMul(o)));l=(l=(l=l.redIAdd(l)).redIAdd(l)).redIAdd(l);var f=this.z.redAdd(n).redSqr().redISub(s).redISub(o);return this.curve.jpoint(u,l,f)},u.prototype.mul=function(e,t){return e=new a(e,t),this.curve._wnafMul(this,e)},u.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),s=e.z.redSqr();if(0!==this.x.redMul(s).redISub(e.x.redMul(t)).cmpn(0))return!1;var i=t.redMul(this.z),r=s.redMul(e.z);return 0===this.y.redMul(r).redISub(e.y.redMul(i)).cmpn(0)},u.prototype.eqXToP=function(e){var t=this.z.redSqr(),s=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(s))return!0;for(var i=e.clone(),r=this.curve.redN.redMul(t);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(s.redIAdd(r),0===this.x.cmp(s))return!0}return!1},u.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},u.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},1198:(e,t,s)=>{"use strict";var i,r=t,a=s(3150),n=a.utils.assert;function o(e){"short"===e.type?this.curve=new a.curve.short(e):"edwards"===e.type?this.curve=new a.curve.edwards(e):this.curve=new a.curve.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,n(this.g.validate(),"Invalid curve"),n(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function c(e,t){Object.defineProperty(r,e,{configurable:!0,enumerable:!0,get:function(){var s=new o(t);return Object.defineProperty(r,e,{configurable:!0,enumerable:!0,value:s}),s}})}r.PresetCurve=o,c("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:"SHA256",gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),c("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:"SHA256",gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),c("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:"SHA256",gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),c("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:"SHA384",gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),c("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:"SHA512",gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),c("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:"SHA256",gRed:!1,g:["9"]}),c("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:"SHA256",gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{i=s(4935)}catch(e){i=void 0}c("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:"SHA256",beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",i]})},1643:(e,t,s)=>{"use strict";var i=s(5060),r=s(448),a=s(3150),n=a.utils.assert,o=s(331),c=s(562);function d(e){if(!(this instanceof d))return new d(e);"string"==typeof e&&(n(a.curves.hasOwnProperty(e),"Unknown curve "+e),e=a.curves[e]),e instanceof a.curves.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}e.exports=d,d.prototype.keyPair=function(e){return new o(this,e)},d.prototype.keyFromPrivate=function(e,t){return o.fromPrivate(this,e,t)},d.prototype.keyFromPublic=function(e,t){return o.fromPublic(this,e,t)},d.prototype.genKeyPair=function(e){e||(e={});for(var t=new r({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||null,entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),s=this.n.byteLength(),a=this.n.sub(new i(2));;){var n=new i(t.generate(s));if(!(n.cmp(a)>0))return n.iaddn(1),this.keyFromPrivate(n)}},d.prototype._truncateToN=function(e,t){var s=8*e.byteLength()-this.n.bitLength();return s>0&&(e=e.ushrn(s)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},d.prototype.sign=function(e,t,s,a){"object"==typeof s&&(a=s,s=null),a||(a={}),t=this.keyFromPrivate(t,s),e=this._truncateToN(new i(e,16));for(var n=this.n.byteLength(),o=t.getPrivate().toArray("be",n),d=e.toArray("be",n),h=new r({hash:this.hash,entropy:a.extraEntropy?o.concat(a.extraEntropy):o,nonce:d,pers:a.pers,persEnc:a.persEnc||"utf8"}),u=this.n.sub(new i(1)),l=0;;l++){var f=a.k?a.k(l):new i(h.generate(this.n.byteLength()));if(!((f=this._truncateToN(f,!0)).cmpn(1)<=0||f.cmp(u)>=0)){var p=this.g.mul(f);if(!p.isInfinity()){var m=p.getX(),b=m.umod(this.n);if(0!==b.cmpn(0)){var g=f.invm(this.n).mul(b.mul(t.getPrivate()).iadd(e));if(0!==(g=g.umod(this.n)).cmpn(0)){var y=(p.getY().isOdd()?1:0)|(0!==m.cmp(b)?2:0);return a.canonical&&g.cmp(this.nh)>0&&(g=this.n.sub(g),y^=1),new c({r:b,s:g,recoveryParam:y})}}}}}},d.prototype.verify=function(e,t,s,r){e=this._truncateToN(new i(e,16)),s=this.keyFromPublic(s,r);var a=(t=new c(t,"hex")).r,n=t.s;if(a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;if(n.cmpn(1)<0||n.cmp(this.n)>=0)return!1;var o,d=n.invm(this.n),h=d.mul(e).umod(this.n),u=d.mul(a).umod(this.n);return this.curve._maxwellTrick?!(o=this.g.jmulAdd(h,s.getPublic(),u)).isInfinity()&&o.eqXToP(a):!(o=this.g.mulAdd(h,s.getPublic(),u)).isInfinity()&&0===o.getX().umod(this.n).cmp(a)},d.prototype.recoverPubKey=function(e,t,s,r){n((3&s)===s,"The recovery param is more than two bits"),t=new c(t,r);var a=this.n,o=new i(e),d=t.r,h=t.s,u=1&s,l=s>>1;if(d.cmp(this.curve.p.umod(this.curve.n))>=0&&l)throw new Error("Unable to find sencond key candinate");d=l?this.curve.pointFromX(d.add(this.curve.n),u):this.curve.pointFromX(d,u);var f=t.r.invm(a),p=a.sub(o).mul(f).umod(a),m=h.mul(f).umod(a);return this.g.mulAdd(p,d,m)},d.prototype.getKeyRecoveryParam=function(e,t,s,i){if(null!==(t=new c(t,i)).recoveryParam)return t.recoveryParam;for(var r=0;r<4;r++){var a;try{a=this.recoverPubKey(e,t,r)}catch(e){continue}if(a.eq(s))return r}throw new Error("Unable to find valid recovery factor")}},331:(e,t,s)=>{"use strict";var i=s(5060),r=s(3150).utils.assert;function a(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}e.exports=a,a.fromPublic=function(e,t,s){return t instanceof a?t:new a(e,{pub:t,pubEnc:s})},a.fromPrivate=function(e,t,s){return t instanceof a?t:new a(e,{priv:t,privEnc:s})},a.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},a.prototype.getPublic=function(e,t){return"string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub},a.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},a.prototype._importPrivate=function(e,t){this.priv=new i(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},a.prototype._importPublic=function(e,t){if(e.x||e.y)return"mont"===this.ec.curve.type?r(e.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||r(e.x&&e.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(e.x,e.y));this.pub=this.ec.curve.decodePoint(e,t)},a.prototype.derive=function(e){return e.mul(this.priv).getX()},a.prototype.sign=function(e,t,s){return this.ec.sign(e,this,t,s)},a.prototype.verify=function(e,t){return this.ec.verify(e,t,this)},a.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},562:(e,t,s)=>{"use strict";var i=s(5060),r=s(3150).utils.assert;e.exports=function e(t,s){if(t instanceof e)return t;r(t.r&&t.s,"Signature without r or s"),this.r=new i(t.r,16),this.s=new i(t.s,16),void 0===t.recoveryParam?this.recoveryParam=null:this.recoveryParam=t.recoveryParam}},9214:(e,t,s)=>{"use strict";var i=s(1198),r=s(7882),a=r.assert,n=r.parseBytes,o=s(2429),c=s(7423);const d=s(5060),{byteArrayToWordArray:h}=s(651),u=s(7295);function l(e){if(a("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof l))return new l(e);var t=i[e].curve;this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8)}e.exports=l,l.prototype.sign=function(e,t){e=n(e);var s=this.keyFromSecret(t),i=this.hashInt(s.secret(),e),r=this.g.mul(i),a=this.encodePoint(r),o=this.hashInt(a,s.pubBytes(),e);o=o.mul(s.priv());var c=i.add(o).umod(this.curve.n);return this.makeSignature({R:r,S:c,Rencoded:a})},l.prototype.signModified=function(e,t){e=n(e);var s=this.keyFromSecret(t);const i=new d(s.secret(),16,"le"),r=this.encodePoint(this.g.mul(i)),a=128&r[31];var o=this.hashInt(s.secret(),e),c=this.g.mul(o),h=this.encodePoint(c);let u=this.hashInt(h,r,e);u=u.mul(i);var l=o.add(u).umod(this.curve.n),f=l.toArray("le");return f[31]|=a,this.makeSignature({R:c,S:l,Rencoded:h,Sencoded:f})},l.prototype.verify=function(e,t,s){e=n(e),t=this.makeSignature(t);var i=this.keyFromPublic(s),r=this.hashInt(t.Rencoded(),i.pubBytes(),e),a=this.g.mul(t.S());return t.R().add(i.pub().mul(r)).eq(a)},l.prototype.hashInt=function(){let e=Array.from(arguments).reduce(((e,t)=>e.concat(t)));e=h(e);const t=u.SHA512(e).toString(u.enc.Hex);return r.intFromLE(t).umod(this.curve.n)},l.prototype.keyFromPublic=function(e){return o.fromPublic(this,e)},l.prototype.keyFromSecret=function(e){return o.fromSecret(this,e)},l.prototype.makeSignature=function(e){return e instanceof c?e:new c(this,e)},l.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},l.prototype.decodePoint=function(e){var t=(e=r.parseBytes(e)).length-1,s=e.slice(0,t).concat(-129&e[t]),i=0!=(128&e[t]),a=r.intFromLE(s);return this.curve.pointFromY(a,i)},l.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},l.prototype.decodeInt=function(e){return r.intFromLE(e)},l.prototype.isPoint=function(e){return e instanceof this.pointClass}},2429:(e,t,s)=>{"use strict";var i=s(7882),r=i.assert,a=i.parseBytes,n=i.cachedProperty;function o(e,t){this.eddsa=e,this._secret=a(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=a(t.pub)}o.fromPublic=function(e,t){return t instanceof o?t:new o(e,{pub:t})},o.fromSecret=function(e,t){return t instanceof o?t:new o(e,{secret:t})},o.prototype.secret=function(){return this._secret},n(o,"pubBytes",(function(){return this.eddsa.encodePoint(this.pub())})),n(o,"pub",(function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())})),n(o,"privBytes",(function(){var e=this.eddsa,t=this.hash(),s=e.encodingLength-1,i=t.slice(0,e.encodingLength);return i[0]&=248,i[s]&=127,i[s]|=64,i})),n(o,"priv",(function(){return this.eddsa.decodeInt(this.privBytes())})),n(o,"hash",(function(){return this.eddsa.hash().update(this.secret()).digest()})),n(o,"messagePrefix",(function(){return this.hash().slice(this.eddsa.encodingLength)})),o.prototype.sign=function(e){return r(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},o.prototype.signModified=function(e){return r(this._secret,"KeyPair can only verify"),this.eddsa.signModified(e,this)},o.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},o.prototype.getSecret=function(e){return r(this._secret,"KeyPair is public only"),i.encode(this.secret(),e)},o.prototype.getPublic=function(e){return i.encode(this.pubBytes(),e)},e.exports=o},7423:(e,t,s)=>{"use strict";var i=s(5060),r=s(7882),a=r.assert,n=r.cachedProperty,o=r.parseBytes;function c(e,t){this.eddsa=e,"object"!=typeof t&&(t=o(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),a(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof i&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}n(c,"S",(function(){return this.eddsa.decodeInt(this.Sencoded())})),n(c,"R",(function(){return this.eddsa.decodePoint(this.Rencoded())})),n(c,"Rencoded",(function(){return this.eddsa.encodePoint(this.R())})),n(c,"Sencoded",(function(){return this.eddsa.encodeInt(this.S())})),c.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},c.prototype.toHex=function(){return r.encode(this.toBytes(),"hex").toUpperCase()},e.exports=c},4935:e=>{e.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},7882:(e,t,s)=>{"use strict";var i=t,r=s(5060);function a(e,t){var s=[];return t>0&&s.push(e>>>24),t>1&&s.push(e>>>16&255),t>2&&s.push(e>>>8&255),t>3&&s.push(255&e),s}function n(e){return 1===e.length?"0"+e:e}function o(e){for(var t="",s=0;s<e.length;s++)t+=n(e[s].toString(16));return t}i.assert=function(e,t){if(!e)throw new Error(t)},i.getNAF=function(e,t){for(var s=[],i=1<<t+1,r=e.clone();r.cmpn(1)>=0;){var a;if(r.isOdd()){var n=r.andln(i-1);a=n>(i>>1)-1?(i>>1)-n:n,r.isubn(a)}else a=0;s.push(a);for(var o=0!==r.cmpn(0)&&0===r.andln(i-1)?t+1:1,c=1;c<o;c++)s.push(0);r.iushrn(o)}return s},i.getJSF=function(e,t){var s=[[],[]];e=e.clone(),t=t.clone();for(var i=0,r=0;e.cmpn(-i)>0||t.cmpn(-r)>0;){var a,n,o,c=e.andln(3)+i&3,d=t.andln(3)+r&3;if(3===c&&(c=-1),3===d&&(d=-1),0==(1&c))a=0;else a=3!==(o=e.andln(7)+i&7)&&5!==o||2!==d?c:-c;if(s[0].push(a),0==(1&d))n=0;else n=3!==(o=t.andln(7)+r&7)&&5!==o||2!==c?d:-d;s[1].push(n),2*i===a+1&&(i=1-i),2*r===n+1&&(r=1-r),e.iushrn(1),t.iushrn(1)}return s},i.cachedProperty=function(e,t,s){var i="_"+t;e.prototype[t]=function(){return void 0!==this[i]?this[i]:this[i]=s.call(this)}},i.parseBytes=function(e){return"string"==typeof e?i.toArray(e,"hex"):e},i.intFromLE=function(e){return new r(e,"hex","le")},i.wordArrayToBuffer=function(e){let t;if(!e.hasOwnProperty("sigBytes")||!e.hasOwnProperty("words"))throw Error("Argument not a wordArray");t=e.sigBytes,e=e.words;const s=[];let i=[],r=0;for(;t>0;)i=a(e[r],Math.min(4,t)),t-=i.length,s.push(i),r++;return[].concat.apply([],s)},i.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var s=[];if("string"!=typeof e){for(var i=0;i<e.length;i++)s[i]=0|e[i];return s}if("hex"===t){(e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e);for(i=0;i<e.length;i+=2)s.push(parseInt(e[i]+e[i+1],16))}else for(i=0;i<e.length;i++){var r=e.charCodeAt(i),a=r>>8,n=255&r;a?s.push(a,n):s.push(n)}return s},i.zero2=n,i.toHex=o,i.encode=function(e,t){return"hex"===t?o(e):e}},448:(e,t,s)=>{"use strict";var i=s(7295),r=s(7882).assert,a=s(7882),{byteArrayToWordArray:n}=s(651);const o=i.enc.Utf8.parse(""),c=i.enc.Utf8.parse("\0");function d(e){if(!(this instanceof d))return new d(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.slice(3,6),this.minEntropy=e.minEntropy||192,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=e.entropy,s=e.nonce;r(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,s,[])}e.exports=d,d.prototype._init=function(e,t,s){var r=e.concat(t).concat(s);this.K=new i.lib.WordArray.init,this.V=new i.lib.WordArray.init;this.V.words=Array(this.outLen/32).fill(16843009),this.V.sigBytes=32,this._update(r),this._reseed=1,this.reseedInterval=281474976710656},d.prototype._hmac=function(){return new i.lib.WordArray.init},d.prototype._update=function(e){var t=this._hmac();t.concat(this.V),t.concat(c),e&&t.concat(n(e)),this.K=i["Hmac"+this.hash](t,this.K),this.V=i["Hmac"+this.hash](this.V,this.K),e&&((t=this._hmac()).concat(this.V),t.concat(o),t.concat(n(e)),this.K=i["Hmac"+this.hash](t,this.K),this.V=i["Hmac"+this.hash](this.V,this.K))},d.prototype.reseed=function(e,t,s,i){"string"!=typeof t&&(s,s=t,t=null),r(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(s||[])),this._reseed=1},d.prototype.generate=function(e,t,s,r){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof t&&(s,s=t,t=null),s&&(s=i.enc.Utf8.parse(s),this._update(s));for(var n=new i.lib.WordArray.init;n.sigBytes<e;)this.V=i["Hmac"+this.hash](this.V,this.K),n.concat(this.V);return this._update(s),this._reseed++,a.wordArrayToBuffer(n)}},9323:(e,t,s)=>{"use strict";var i=s(1214);function r(e){const t=function(t,s){return"string"==typeof t&&"//"===t.slice(0,2)?e("https:"+t,s):e(t,s)};return t.http=e.http,t.https=e.https,t}e.exports=function(e){return e&&e.Promise&&(i.Promise=e.Promise),{fetch:r(i),Headers:i.Headers,Request:i.Request,Response:i.Response}}},1214:(e,t,s)=>{"use strict";var i=s(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const r=Symbol("buffer"),a=Symbol("type");class n{constructor(){this[a]="";const e=arguments[0],t=arguments[1],s=[];if(e){const t=e,a=Number(t.length);for(let e=0;e<a;e++){const a=t[e];let o;o=a instanceof i?a:ArrayBuffer.isView(a)?i.from(a.buffer,a.byteOffset,a.byteLength):a instanceof ArrayBuffer?i.from(a):a instanceof n?a[r]:i.from("string"==typeof a?a:String(a)),s.push(o)}}this[r]=i.concat(s);let o=t&&void 0!==t.type&&String(t.type).toLowerCase();o&&!/[^\u0020-\u007E]/.test(o)&&(this[a]=o)}get size(){return this[r].length}get type(){return this[a]}slice(){const e=this.size,t=arguments[0],s=arguments[1];let i,a;i=void 0===t?0:t<0?Math.max(e+t,0):Math.min(t,e),a=void 0===s?e:s<0?Math.max(e+s,0):Math.min(s,e);const o=Math.max(a-i,0),c=this[r].slice(i,i+o),d=new n([],{type:arguments[2]});return d[r]=c,d}}function o(e,t,s){Error.call(this,e),this.message=e,this.type=t,s&&(this.code=this.errno=s.code),Error.captureStackTrace(this,this.constructor)}Object.defineProperties(n.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(n.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0}),o.prototype=Object.create(Error.prototype),o.prototype.constructor=o,o.prototype.name="FetchError";const c=s(2830);const d=s(2830).PassThrough,h=Symbol("Body internals");function u(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=s.size;let a=void 0===r?0:r;var d=s.timeout;let u=void 0===d?0:d;null==e?e=null:"string"==typeof e||f(e)||e instanceof n||i.isBuffer(e)||"[object ArrayBuffer]"===Object.prototype.toString.call(e)||e instanceof c||(e=String(e)),this[h]={body:e,disturbed:!1,error:null},this.size=a,this.timeout=u,e instanceof c&&e.on("error",(function(e){t[h].error=new o(`Invalid response body while trying to fetch ${t.url}: ${e.message}`,"system",e)}))}function l(){var e=this;if(this[h].disturbed)return u.Promise.reject(new TypeError(`body used already for: ${this.url}`));if(this[h].disturbed=!0,this[h].error)return u.Promise.reject(this[h].error);if(null===this.body)return u.Promise.resolve(i.alloc(0));if("string"==typeof this.body)return u.Promise.resolve(i.from(this.body));if(this.body instanceof n)return u.Promise.resolve(this.body[r]);if(i.isBuffer(this.body))return u.Promise.resolve(this.body);if("[object ArrayBuffer]"===Object.prototype.toString.call(this.body))return u.Promise.resolve(i.from(this.body));if(!(this.body instanceof c))return u.Promise.resolve(i.alloc(0));let t=[],s=0,a=!1;return new u.Promise((function(r,n){let c;e.timeout&&(c=setTimeout((function(){a=!0,n(new o(`Response timeout while trying to fetch ${e.url} (over ${e.timeout}ms)`,"body-timeout"))}),e.timeout)),e.body.on("error",(function(t){n(new o(`Invalid response body while trying to fetch ${e.url}: ${t.message}`,"system",t))})),e.body.on("data",(function(i){if(!a&&null!==i){if(e.size&&s+i.length>e.size)return a=!0,void n(new o(`content size at ${e.url} over limit: ${e.size}`,"max-size"));s+=i.length,t.push(i)}})),e.body.on("end",(function(){if(!a){clearTimeout(c);try{r(i.concat(t))}catch(t){n(new o(`Could not create Buffer from response body for ${e.url}: ${t.message}`,"system",t))}}}))}))}function f(e){return"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&("URLSearchParams"===e.constructor.name||"[object URLSearchParams]"===Object.prototype.toString.call(e)||"function"==typeof e.sort)}function p(e){let t,s,i=e.body;if(e.bodyUsed)throw new Error("cannot clone body after it is used");return i instanceof c&&"function"!=typeof i.getBoundary&&(t=new d,s=new d,i.pipe(t),i.pipe(s),e[h].body=t,i=s),i}function m(e){const t=e.body;return null===t?0:"string"==typeof t?i.byteLength(t):f(t)?i.byteLength(String(t)):t instanceof n?t.size:i.isBuffer(t)?t.length:"[object ArrayBuffer]"===Object.prototype.toString.call(t)?t.byteLength:t&&"function"==typeof t.getLengthSync&&(t._lengthRetrievers&&0==t._lengthRetrievers.length||t.hasKnownLength&&t.hasKnownLength())?t.getLengthSync():null}u.prototype={get body(){return this[h].body},get bodyUsed(){return this[h].disturbed},arrayBuffer(){return l.call(this).then((function(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}))},blob(){let e=this.headers&&this.headers.get("content-type")||"";return l.call(this).then((function(t){return Object.assign(new n([],{type:e.toLowerCase()}),{[r]:t})}))},json(){var e=this;return l.call(this).then((function(t){try{return JSON.parse(t.toString())}catch(t){return u.Promise.reject(new o(`invalid json response body at ${e.url} reason: ${t.message}`,"invalid-json"))}}))},text(){return l.call(this).then((function(e){return e.toString()}))},buffer(){return l.call(this)},textConverted(){var e=this;return l.call(this).then((function(t){return function(e,t){if("function"!=typeof convert)throw new Error("The package `encoding` must be installed to use the textConverted() function");const s=t.get("content-type");let i,r,a="utf-8";s&&(i=/charset=([^;]*)/i.exec(s));r=e.slice(0,1024).toString(),!i&&r&&(i=/<meta.+?charset=(['"])(.+?)\1/i.exec(r));!i&&r&&(i=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(r),i&&(i=/charset=(.*)/i.exec(i.pop())));!i&&r&&(i=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(r));i&&(a=i.pop(),"gb2312"!==a&&"gbk"!==a||(a="gb18030"));return convert(e,"UTF-8",a).toString()}(t,e.headers)}))}},Object.defineProperties(u.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),u.mixIn=function(e){for(const t of Object.getOwnPropertyNames(u.prototype))if(!(t in e)){const s=Object.getOwnPropertyDescriptor(u.prototype,t);Object.defineProperty(e,t,s)}},u.Promise=s.g.Promise;const b=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,g=/[^\t\x20-\x7e\x80-\xff]/;function y(e){if(e=`${e}`,b.test(e))throw new TypeError(`${e} is not a legal HTTP header name`)}function v(e){if(e=`${e}`,g.test(e))throw new TypeError(`${e} is not a legal HTTP header value`)}function w(e,t){t=t.toLowerCase();for(const s in e)if(s.toLowerCase()===t)return s}const k=Symbol("map");class S{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this[k]=Object.create(null),e instanceof S){const t=e.raw(),s=Object.keys(t);for(const e of s)for(const s of t[e])this.append(e,s)}else if(null==e);else{if("object"!=typeof e)throw new TypeError("Provided initializer must be an object");{const t=e[Symbol.iterator];if(null!=t){if("function"!=typeof t)throw new TypeError("Header pairs must be iterable");const s=[];for(const t of e){if("object"!=typeof t||"function"!=typeof t[Symbol.iterator])throw new TypeError("Each header pair must be iterable");s.push(Array.from(t))}for(const e of s){if(2!==e.length)throw new TypeError("Each header pair must be a name/value tuple");this.append(e[0],e[1])}}else for(const t of Object.keys(e)){const s=e[t];this.append(t,s)}}}}get(e){y(e=`${e}`);const t=w(this[k],e);return void 0===t?null:this[k][t].join(", ")}forEach(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,s=_(this),i=0;for(;i<s.length;){var r=s[i];const a=r[0],n=r[1];e.call(t,n,a,this),s=_(this),i++}}set(e,t){t=`${t}`,y(e=`${e}`),v(t);const s=w(this[k],e);this[k][void 0!==s?s:e]=[t]}append(e,t){t=`${t}`,y(e=`${e}`),v(t);const s=w(this[k],e);void 0!==s?this[k][s].push(t):this[k][e]=[t]}has(e){return y(e=`${e}`),void 0!==w(this[k],e)}delete(e){y(e=`${e}`);const t=w(this[k],e);void 0!==t&&delete this[k][t]}raw(){return this[k]}keys(){return T(this,"key")}values(){return T(this,"value")}[Symbol.iterator](){return T(this,"key+value")}}function _(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key+value";const s=Object.keys(e[k]).sort();return s.map("key"===t?function(e){return e.toLowerCase()}:"value"===t?function(t){return e[k][t].join(", ")}:function(t){return[t.toLowerCase(),e[k][t].join(", ")]})}S.prototype.entries=S.prototype[Symbol.iterator],Object.defineProperty(S.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(S.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});const O=Symbol("internal");function T(e,t){const s=Object.create(x);return s[O]={target:e,kind:t,index:0},s}const x=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==x)throw new TypeError("Value of `this` is not a HeadersIterator");var e=this[O];const t=e.target,s=e.kind,i=e.index,r=_(t,s);return i>=r.length?{value:void 0,done:!0}:(this[O].index=i+1,{value:r[i],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));function C(e){const t=Object.assign({__proto__:null},e[k]),s=w(e[k],"Host");return void 0!==s&&(t[s]=t[s][0]),t}Object.defineProperty(x,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});const I=s(8501).STATUS_CODES,M=Symbol("Response internals");class N{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};u.call(this,e,t);const s=t.status||200;this[M]={url:t.url,status:s,statusText:t.statusText||I[s],headers:new S(t.headers)}}get url(){return this[M].url}get status(){return this[M].status}get ok(){return this[M].status>=200&&this[M].status<300}get statusText(){return this[M].statusText}get headers(){return this[M].headers}clone(){return new N(p(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok})}}u.mixIn(N.prototype),Object.defineProperties(N.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(N.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});var A=s(8575);const E=A.format,P=A.parse,B=Symbol("Request internals");function V(e){return"object"==typeof e&&"object"==typeof e[B]}class L{constructor(e){let t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};V(e)?t=P(e.url):(t=e&&e.href?P(e.href):P(`${e}`),e={});let r=s.method||e.method||"GET";if(r=r.toUpperCase(),(null!=s.body||V(e)&&null!==e.body)&&("GET"===r||"HEAD"===r))throw new TypeError("Request with GET/HEAD method cannot have body");let a=null!=s.body?s.body:V(e)&&null!==e.body?p(e):null;u.call(this,a,{timeout:s.timeout||e.timeout||0,size:s.size||e.size||0});const o=new S(s.headers||e.headers||{});if(null!=s.body){const e=function(e){const t=e.body;return null===t?null:"string"==typeof t?"text/plain;charset=UTF-8":f(t)?"application/x-www-form-urlencoded;charset=UTF-8":t instanceof n?t.type||null:i.isBuffer(t)||"[object ArrayBuffer]"===Object.prototype.toString.call(t)?null:"function"==typeof t.getBoundary?`multipart/form-data;boundary=${t.getBoundary()}`:null}(this);null===e||o.has("Content-Type")||o.append("Content-Type",e)}this[B]={method:r,redirect:s.redirect||e.redirect||"follow",headers:o,parsedURL:t},this.follow=void 0!==s.follow?s.follow:void 0!==e.follow?e.follow:20,this.compress=void 0!==s.compress?s.compress:void 0===e.compress||e.compress,this.counter=s.counter||e.counter||0,this.agent=s.agent||e.agent}get method(){return this[B].method}get url(){return E(this[B].parsedURL)}get headers(){return this[B].headers}get redirect(){return this[B].redirect}clone(){return new L(this)}}u.mixIn(L.prototype),Object.defineProperty(L.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(L.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0}});const q=s(8501),D=s(9267);const R=s(2830).PassThrough;const G=s(8575).resolve,F=s(2635);function U(e,t){if(!U.Promise)throw new Error("native promise missing, set fetch.Promise to your favorite alternative");return u.Promise=U.Promise,new U.Promise((function(s,a){const c=new L(e,t),d=function(e){const t=e[B].parsedURL,s=new S(e[B].headers);if(s.has("Accept")||s.set("Accept","*/*"),!t.protocol||!t.hostname)throw new TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(t.protocol))throw new TypeError("Only HTTP(S) protocols are supported");let i=null;if(null==e.body&&/^(POST|PUT)$/i.test(e.method)&&(i="0"),null!=e.body){const t=m(e);"number"==typeof t&&(i=String(t))}return i&&s.set("Content-Length",i),s.has("User-Agent")||s.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),e.compress&&s.set("Accept-Encoding","gzip,deflate"),s.has("Connection")||e.agent||s.set("Connection","close"),Object.assign({},t,{method:e.method,headers:C(s),agent:e.agent})}(c),h=(0,("https:"===d.protocol?D:q).request)(d);let u;function l(){h.abort(),clearTimeout(u)}c.timeout&&h.once("socket",(function(e){u=setTimeout((function(){a(new o(`network timeout at: ${c.url}`,"request-timeout")),l()}),c.timeout)})),h.on("error",(function(e){a(new o(`request to ${c.url} failed, reason: ${e.message}`,"system",e)),l()})),h.on("response",(function(e){clearTimeout(u);const t=function(e){const t=new S;for(const s of Object.keys(e))if(!b.test(s))if(Array.isArray(e[s]))for(const i of e[s])g.test(i)||(void 0===t[k][s]?t[k][s]=[i]:t[k][s].push(i));else g.test(e[s])||(t[k][s]=[e[s]]);return t}(e.headers);if(U.isRedirect(e.statusCode)){const i=t.get("Location"),r=null===i?null:G(c.url,i);switch(c.redirect){case"error":return a(new o(`redirect mode is set to error: ${c.url}`,"no-redirect")),void l();case"manual":null!==r&&t.set("Location",r);break;case"follow":if(null===r)break;if(c.counter>=c.follow)return a(new o(`maximum redirect reached at: ${c.url}`,"max-redirect")),void l();const i={headers:new S(c.headers),follow:c.follow,counter:c.counter+1,agent:c.agent,compress:c.compress,method:c.method,body:c.body};return 303!==e.statusCode&&c.body&&null===m(c)?(a(new o("Cannot follow redirect with body being a readable stream","unsupported-redirect")),void l()):(303!==e.statusCode&&(301!==e.statusCode&&302!==e.statusCode||"POST"!==c.method)||(i.method="GET",i.body=void 0,i.headers.delete("content-length")),s(U(new L(r,i))),void l())}}let i=e.pipe(new R);const r={url:c.url,status:e.statusCode,statusText:e.statusMessage,headers:t,size:c.size,timeout:c.timeout},n=t.get("Content-Encoding");if(!c.compress||"HEAD"===c.method||null===n||204===e.statusCode||304===e.statusCode)return void s(new N(i,r));const d={flush:F.Z_SYNC_FLUSH,finishFlush:F.Z_SYNC_FLUSH};if("gzip"==n||"x-gzip"==n)return i=i.pipe(F.createGunzip(d)),void s(new N(i,r));if("deflate"!=n&&"x-deflate"!=n)s(new N(i,r));else{e.pipe(new R).once("data",(function(e){i=8==(15&e[0])?i.pipe(F.createInflate()):i.pipe(F.createInflateRaw()),s(new N(i,r))}))}})),function(e,t){const s=t.body;null===s?e.end():"string"==typeof s?(e.write(s),e.end()):f(s)?(e.write(i.from(String(s))),e.end()):s instanceof n?(e.write(s[r]),e.end()):i.isBuffer(s)?(e.write(s),e.end()):"[object ArrayBuffer]"===Object.prototype.toString.call(s)?(e.write(i.from(s)),e.end()):s.pipe(e)}(h,c)}))}U.isRedirect=function(e){return 301===e||302===e||303===e||307===e||308===e},U.default=U,U.Promise=s.g.Promise,U.http=q,U.https=D,e.exports=t=U,t.Headers=S,t.Request=L,t.Response=N,t.FetchError=o},1286:(e,t,s)=>{var i=s(8764).Buffer,r=s(939),a=s(1147)._,n=s(8173),o=s(1917);e.exports=function(){var e={browser:["md5","ripemd160","sha1","sha256","sha512"]},t="pkcs1",s="pkcs1",c={private:"pkcs1-private-pem","private-der":"pkcs1-private-der",public:"pkcs8-public-pem","public-der":"pkcs8-public-der"};function d(e,n,o){if(!(this instanceof d))return new d(e,n,o);a.isObject(n)&&(o=n,n=void 0),this.$options={signingScheme:s,signingSchemeOptions:{hash:"sha256",saltLength:null},encryptionScheme:t,encryptionSchemeOptions:{hash:"sha1",label:null},environment:"browser",rsaUtils:this},this.keyPair=new r.Key,this.$cache={},i.isBuffer(e)||a.isString(e)?this.importKey(e,n):a.isObject(e)&&this.generateKeyPair(e.b,e.e),this.setOptions(o)}return d.prototype.setOptions=function(i){if((i=i||{}).environment&&(this.$options.environment=i.environment),i.signingScheme){if(a.isString(i.signingScheme)){var r=i.signingScheme.toLowerCase().split("-");1==r.length?e.node.indexOf(r[0])>-1?(this.$options.signingSchemeOptions={hash:r[0]},this.$options.signingScheme=s):(this.$options.signingScheme=r[0],this.$options.signingSchemeOptions={hash:null}):(this.$options.signingSchemeOptions={hash:r[1]},this.$options.signingScheme=r[0])}else a.isObject(i.signingScheme)&&(this.$options.signingScheme=i.signingScheme.scheme||s,this.$options.signingSchemeOptions=a.omit(i.signingScheme,"scheme"));if(!n.isSignature(this.$options.signingScheme))throw Error("Unsupported signing scheme");if(this.$options.signingSchemeOptions.hash&&-1===e[this.$options.environment].indexOf(this.$options.signingSchemeOptions.hash))throw Error("Unsupported hashing algorithm for "+this.$options.environment+" environment")}if(i.encryptionScheme){if(a.isString(i.encryptionScheme)?(this.$options.encryptionScheme=i.encryptionScheme.toLowerCase(),this.$options.encryptionSchemeOptions={}):a.isObject(i.encryptionScheme)&&(this.$options.encryptionScheme=i.encryptionScheme.scheme||t,this.$options.encryptionSchemeOptions=a.omit(i.encryptionScheme,"scheme")),!n.isEncryption(this.$options.encryptionScheme))throw Error("Unsupported encryption scheme");if(this.$options.encryptionSchemeOptions.hash&&-1===e[this.$options.environment].indexOf(this.$options.encryptionSchemeOptions.hash))throw Error("Unsupported hashing algorithm for "+this.$options.environment+" environment")}this.keyPair.setOptions(this.$options)},d.prototype.importKey=function(e,t){if(!e)throw Error("Empty key given");if(t&&(t=c[t]||t),!o.detectAndImport(this.keyPair,e,t)&&void 0===t)throw Error("Key format must be specified");return this.$cache={},this},d.prototype.isPrivate=function(){return this.keyPair.isPrivate()},d.prototype.isPublic=function(e){return this.keyPair.isPublic(e)},d.prototype.isEmpty=function(e){return!(this.keyPair.n||this.keyPair.e||this.keyPair.d)},d.prototype.sign=function(e,t,s){if(!this.isPrivate())throw Error("This is not private key");var i=this.keyPair.sign(this.$getDataForEncrypt(e,s));return t&&"buffer"!=t&&(i=i.toString(t)),i},d.prototype.$getDataForEncrypt=function(e,t){if(a.isString(e)||a.isNumber(e))return i.from(""+e,t||"utf8");if(i.isBuffer(e))return e;if(a.isObject(e))return i.from(JSON.stringify(e));throw Error("Unexpected data type")},d}()},9470:e=>{e.exports={newInvalidAsn1Error:function(e){var t=new Error;return t.name="InvalidAsn1Error",t.message=e||"",t}}},2046:(e,t,s)=>{var i=s(9470),r=s(4275),a=s(2758);for(var n in e.exports={Reader:a},r)r.hasOwnProperty(n)&&(e.exports[n]=r[n]);for(var o in i)i.hasOwnProperty(o)&&(e.exports[o]=i[o])},2758:(e,t,s)=>{var i=s(8764).Buffer,r=s(8583),a=s(4275),n=s(9470).newInvalidAsn1Error;function o(e){if(!e||!i.isBuffer(e))throw new TypeError("data must be a node Buffer");this._buf=e,this._size=e.length,this._len=0,this._offset=0}Object.defineProperty(o.prototype,"length",{enumerable:!0,get:function(){return this._len}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){return this._offset}}),Object.defineProperty(o.prototype,"remain",{get:function(){return this._size-this._offset}}),Object.defineProperty(o.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}}),o.prototype.readByte=function(e){if(this._size-this._offset<1)return null;var t=255&this._buf[this._offset];return e||(this._offset+=1),t},o.prototype.peek=function(){return this.readByte(!0)},o.prototype.readLength=function(e){if(void 0===e&&(e=this._offset),e>=this._size)return null;var t=255&this._buf[e++];if(null===t)return null;if(128==(128&t)){if(0===(t&=127))throw n("Indefinite length not supported");if(t>4)throw n("encoding too long");if(this._size-e<t)return null;this._len=0;for(var s=0;s<t;s++)this._len=(this._len<<8)+(255&this._buf[e++])}else this._len=t;return e},o.prototype.readSequence=function(e){var t=this.peek();if(null===t)return null;if(void 0!==e&&e!==t)throw n("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var s=this.readLength(this._offset+1);return null===s?null:(this._offset=s,t)},o.prototype.readInt=function(){return this._readTag(a.Integer)},o.prototype.readBoolean=function(){return 0!==this._readTag(a.Boolean)},o.prototype.readEnumeration=function(){return this._readTag(a.Enumeration)},o.prototype.readString=function(e,t){e||(e=a.OctetString);var s=this.peek();if(null===s)return null;if(s!==e)throw n("Expected 0x"+e.toString(16)+": got 0x"+s.toString(16));var r=this.readLength(this._offset+1);if(null===r)return null;if(this.length>this._size-r)return null;if(this._offset=r,0===this.length)return t?i.alloc(0):"";var o=this._buf.slice(this._offset,this._offset+this.length);return this._offset+=this.length,t?o:o.toString("utf8")},o.prototype.readOID=function(e){e||(e=a.OID);var t=this.readString(e,!0);if(null===t)return null;for(var s=[],i=0,r=0;r<t.length;r++){var n=255&t[r];i<<=7,i+=127&n,0==(128&n)&&(s.push(i),i=0)}return i=s.shift(),s.unshift(i%40),s.unshift(i/40>>0),s.join(".")},o.prototype._readTag=function(e){r.ok(void 0!==e);var t=this.peek();if(null===t)return null;if(t!==e)throw n("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var s=this.readLength(this._offset+1);if(null===s)return null;if(this.length>4)throw n("Integer too long: "+this.length);if(this.length>this._size-s)return null;this._offset=s;for(var i=this._buf[this._offset],a=0,o=0;o<this.length;o++)a<<=8,a|=255&this._buf[this._offset++];return 128==(128&i)&&4!==o&&(a-=1<<8*o),a>>0},e.exports=o},4275:e=>{e.exports={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128}},4449:(e,t,s)=>{var i=s(2046);e.exports={Ber:i,BerReader:i.Reader}},3666:(e,t,s)=>{s(1147)._,s(1147);e.exports={privateExport:function(e,t){return{n:e.n.toBuffer(),e:e.e,d:e.d.toBuffer(),p:e.p.toBuffer(),q:e.q.toBuffer(),dmp1:e.dmp1.toBuffer(),dmq1:e.dmq1.toBuffer(),coeff:e.coeff.toBuffer()}},privateImport:function(e,t,s){if(!(t.n&&t.e&&t.d&&t.p&&t.q&&t.dmp1&&t.dmq1&&t.coeff))throw Error("Invalid key data");e.setPrivate(t.n,t.e,t.d,t.p,t.q,t.dmp1,t.dmq1,t.coeff)},publicExport:function(e,t){return{n:e.n.toBuffer(),e:e.e}},publicImport:function(e,t,s){if(!t.n||!t.e)throw Error("Invalid key data");e.setPublic(t.n,t.e)},autoImport:function(t,s){return!(!s.n||!s.e)&&(s.d&&s.p&&s.q&&s.dmp1&&s.dmq1&&s.coeff?(e.exports.privateImport(t,s),!0):(e.exports.publicImport(t,s),!0))}}},1917:(e,t,s)=>{s(1147)._;e.exports={pkcs1:s(7073),pkcs8:s(7158),components:s(3666),detectAndImport:function(t,s,i){if(void 0===i){for(var r in e.exports)if("function"==typeof e.exports[r].autoImport&&e.exports[r].autoImport(t,s))return!0}else if(i){var a=formatParse(i);if(!e.exports[a.scheme])throw Error("Unsupported key format");"private"===a.keyType?e.exports[a.scheme].privateImport(t,s,a.keyOpt):e.exports[a.scheme].publicImport(t,s,a.keyOpt)}return!1}}},7073:(e,t,s)=>{var i=s(8764).Buffer,r=s(4449).Ber,a=s(1147)._,n=s(1147);const o="-----BEGIN RSA PRIVATE KEY-----",c="-----END RSA PRIVATE KEY-----",d="-----BEGIN RSA PUBLIC KEY-----",h="-----END RSA PUBLIC KEY-----";e.exports={privateExport:function(e,t){t=t||{};var s=e.n.toBuffer(),i=e.d.toBuffer(),a=e.p.toBuffer(),d=e.q.toBuffer(),h=e.dmp1.toBuffer(),u=e.dmq1.toBuffer(),l=e.coeff.toBuffer(),f=s.length+i.length+a.length+d.length+h.length+u.length+l.length+512,p=new r.Writer({size:f});return p.startSequence(),p.writeInt(0),p.writeBuffer(s,2),p.writeInt(e.e),p.writeBuffer(i,2),p.writeBuffer(a,2),p.writeBuffer(d,2),p.writeBuffer(h,2),p.writeBuffer(u,2),p.writeBuffer(l,2),p.endSequence(),"der"===t.type?p.buffer:o+"\n"+n.linebrk(p.buffer.toString("base64"),64)+"\n"+c},privateImport:function(e,t,s){var d;if("der"!==(s=s||{}).type){if(i.isBuffer(t)&&(t=t.toString("utf8")),!a.isString(t))throw Error("Unsupported key format");var h=n.trimSurroundingText(t,o,c).replace(/\s+|\n\r|\n|\r$/gm,"");d=i.from(h,"base64")}else{if(!i.isBuffer(t))throw Error("Unsupported key format");d=t}var u=new r.Reader(d);u.readSequence(),u.readString(2,!0),e.setPrivate(u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0))},publicExport:function(e,t){t=t||{};var s=e.n.toBuffer(),i=s.length+512,a=new r.Writer({size:i});return a.startSequence(),a.writeBuffer(s,2),a.writeInt(e.e),a.endSequence(),"der"===t.type?a.buffer:d+"\n"+n.linebrk(a.buffer.toString("base64"),64)+"\n"+h},publicImport:function(e,t,s){var o;if("der"!==(s=s||{}).type){if(i.isBuffer(t)&&(t=t.toString("utf8")),a.isString(t)){var c=n.trimSurroundingText(t,d,h).replace(/\s+|\n\r|\n|\r$/gm,"");o=i.from(c,"base64")}}else{if(!i.isBuffer(t))throw Error("Unsupported key format");o=t}var u=new r.Reader(o);u.readSequence(),e.setPublic(u.readString(2,!0),u.readString(2,!0))},autoImport:function(t,s){return/^[\S\s]*-----BEGIN RSA PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END RSA PRIVATE KEY-----[\S\s]*$/g.test(s)?(e.exports.privateImport(t,s),!0):!!/^[\S\s]*-----BEGIN RSA PUBLIC KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END RSA PUBLIC KEY-----[\S\s]*$/g.test(s)&&(e.exports.publicImport(t,s),!0)}}},7158:(e,t,s)=>{var i=s(8764).Buffer,r=s(4449).Ber,a=s(1147)._,n="1.2.840.113549.1.1.1",o=s(1147);const c="-----BEGIN PRIVATE KEY-----",d="-----END PRIVATE KEY-----",h="-----BEGIN PUBLIC KEY-----",u="-----END PUBLIC KEY-----";e.exports={privateExport:function(e,t){t=t||{};var s=e.n.toBuffer(),i=e.d.toBuffer(),a=e.p.toBuffer(),h=e.q.toBuffer(),u=e.dmp1.toBuffer(),l=e.dmq1.toBuffer(),f=e.coeff.toBuffer(),p=s.length+i.length+a.length+h.length+u.length+l.length+f.length+512,m=new r.Writer({size:p});m.startSequence(),m.writeInt(0),m.writeBuffer(s,2),m.writeInt(e.e),m.writeBuffer(i,2),m.writeBuffer(a,2),m.writeBuffer(h,2),m.writeBuffer(u,2),m.writeBuffer(l,2),m.writeBuffer(f,2),m.endSequence();var b=new r.Writer({size:p});return b.startSequence(),b.writeInt(0),b.startSequence(),b.writeOID(n),b.writeNull(),b.endSequence(),b.writeBuffer(m.buffer,4),b.endSequence(),"der"===t.type?b.buffer:c+"\n"+o.linebrk(b.buffer.toString("base64"),64)+"\n"+d},privateImport:function(e,t,s){var h;if("der"!==(s=s||{}).type){if(i.isBuffer(t)&&(t=t.toString("utf8")),!a.isString(t))throw Error("Unsupported key format");var u=o.trimSurroundingText(t,c,d).replace("-----END PRIVATE KEY-----","").replace(/\s+|\n\r|\n|\r$/gm,"");h=i.from(u,"base64")}else{if(!i.isBuffer(t))throw Error("Unsupported key format");h=t}var l=new r.Reader(h);if(l.readSequence(),l.readInt(0),new r.Reader(l.readString(48,!0)).readOID(6,!0)!==n)throw Error("Invalid Public key format");var f=new r.Reader(l.readString(4,!0));f.readSequence(),f.readString(2,!0),e.setPrivate(f.readString(2,!0),f.readString(2,!0),f.readString(2,!0),f.readString(2,!0),f.readString(2,!0),f.readString(2,!0),f.readString(2,!0),f.readString(2,!0))},publicExport:function(e,t){t=t||{};var s=e.n.toBuffer(),i=s.length+512,a=new r.Writer({size:i});a.writeByte(0),a.startSequence(),a.writeBuffer(s,2),a.writeInt(e.e),a.endSequence();var c=new r.Writer({size:i});return c.startSequence(),c.startSequence(),c.writeOID(n),c.writeNull(),c.endSequence(),c.writeBuffer(a.buffer,3),c.endSequence(),"der"===t.type?c.buffer:h+"\n"+o.linebrk(c.buffer.toString("base64"),64)+"\n"+u},publicImport:function(e,t,s){var c;if("der"!==(s=s||{}).type){if(i.isBuffer(t)&&(t=t.toString("utf8")),a.isString(t)){var d=o.trimSurroundingText(t,h,u).replace(/\s+|\n\r|\n|\r$/gm,"");c=i.from(d,"base64")}}else{if(!i.isBuffer(t))throw Error("Unsupported key format");c=t}var l=new r.Reader(c);if(l.readSequence(),new r.Reader(l.readString(48,!0)).readOID(6,!0)!==n)throw Error("Invalid Public key format");var f=new r.Reader(l.readString(3,!0));f.readByte(),f.readSequence(),e.setPublic(f.readString(2,!0),f.readString(2,!0))},autoImport:function(t,s){return/^[\S\s]*-----BEGIN PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END PRIVATE KEY-----[\S\s]*$/g.test(s)?(e.exports.privateImport(t,s),!0):!!/^[\S\s]*-----BEGIN PUBLIC KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END PUBLIC KEY-----[\S\s]*$/g.test(s)&&(e.exports.publicImport(t,s),!0)}}},8446:(e,t,s)=>{var i=s(8764).Buffer,r=s(1147)._;function a(e,t){null!=e&&("number"==typeof e?this.fromNumber(e,t):i.isBuffer(e)?this.fromBuffer(e):null==t&&"string"!=typeof e?this.fromByteArray(e):this.fromString(e,t))}function n(){return new a(null)}a.prototype.am=function(e,t,s,i,r,a){for(var n=16383&t,o=t>>14;--a>=0;){var c=16383&this[e],d=this[e++]>>14,h=o*c+d*n;r=((c=n*c+((16383&h)<<14)+s[i]+r)>>28)+(h>>14)+o*d,s[i++]=268435455&c}return r},a.prototype.DB=28,a.prototype.DM=268435455,a.prototype.DV=1<<28;a.prototype.FV=Math.pow(2,52),a.prototype.F1=24,a.prototype.F2=4;var o,c,d=new Array;for(o="0".charCodeAt(0),c=0;c<=9;++c)d[o++]=c;for(o="a".charCodeAt(0),c=10;c<36;++c)d[o++]=c;for(o="A".charCodeAt(0),c=10;c<36;++c)d[o++]=c;function h(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function u(e,t){var s=d[e.charCodeAt(t)];return null==s?-1:s}function l(e){var t=n();return t.fromInt(e),t}function f(e){var t,s=1;return 0!=(t=e>>>16)&&(e=t,s+=16),0!=(t=e>>8)&&(e=t,s+=8),0!=(t=e>>4)&&(e=t,s+=4),0!=(t=e>>2)&&(e=t,s+=2),0!=(t=e>>1)&&(e=t,s+=1),s}function p(e){this.m=e}function m(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function b(e,t){return e&t}function g(e,t){return e|t}function y(e,t){return e^t}function v(e){if(0===e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function w(){}function k(e){return e}function S(e){this.r2=n(),this.q3=n(),a.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}p.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},p.prototype.revert=function(e){return e},p.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},p.prototype.mulTo=function(e,t,s){e.multiplyTo(t,s),this.reduce(s)},p.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},m.prototype.convert=function(e){var t=n();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(a.ZERO)>0&&this.m.subTo(t,t),t},m.prototype.revert=function(e){var t=n();return e.copyTo(t),this.reduce(t),t},m.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var s=32767&e[t],i=s*this.mpl+((s*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[s=t+this.m.t]+=this.m.am(0,i,e,t,0,this.m.t);e[s]>=e.DV;)e[s]-=e.DV,e[++s]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},m.prototype.mulTo=function(e,t,s){e.multiplyTo(t,s),this.reduce(s)},m.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},w.prototype.convert=k,w.prototype.revert=k,w.prototype.mulTo=function(e,t,s){e.multiplyTo(t,s)},w.prototype.sqrTo=function(e,t){e.squareTo(t)},S.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=n();return e.copyTo(t),this.reduce(t),t},S.prototype.revert=function(e){return e},S.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},S.prototype.mulTo=function(e,t,s){e.multiplyTo(t,s),this.reduce(s)},S.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},a.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},a.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+DV:this.t=0},a.prototype.fromString=function(e,t,s){var i;switch(t){case 2:i=1;break;case 4:i=2;break;case 8:i=3;break;case 16:i=4;break;case 32:i=5;break;case 256:i=8;break;default:return void this.fromRadix(e,t)}this.t=0,this.s=0;for(var r=e.length,n=!1,o=0;--r>=0;){var c=8==i?255&e[r]:u(e,r);c<0?"-"==e.charAt(r)&&(n=!0):(n=!1,0===o?this[this.t++]=c:o+i>this.DB?(this[this.t-1]|=(c&(1<<this.DB-o)-1)<<o,this[this.t++]=c>>this.DB-o):this[this.t-1]|=c<<o,(o+=i)>=this.DB&&(o-=this.DB))}s||8!=i||0==(128&e[0])||(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),n&&a.ZERO.subTo(this,this)},a.prototype.fromByteArray=function(e,t){this.fromString(e,256,t)},a.prototype.fromBuffer=function(e){this.fromString(e,256,!0)},a.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},a.prototype.dlShiftTo=function(e,t){var s;for(s=this.t-1;s>=0;--s)t[s+e]=this[s];for(s=e-1;s>=0;--s)t[s]=0;t.t=this.t+e,t.s=this.s},a.prototype.drShiftTo=function(e,t){for(var s=e;s<this.t;++s)t[s-e]=this[s];t.t=Math.max(this.t-e,0),t.s=this.s},a.prototype.lShiftTo=function(e,t){var s,i=e%this.DB,r=this.DB-i,a=(1<<r)-1,n=Math.floor(e/this.DB),o=this.s<<i&this.DM;for(s=this.t-1;s>=0;--s)t[s+n+1]=this[s]>>r|o,o=(this[s]&a)<<i;for(s=n-1;s>=0;--s)t[s]=0;t[n]=o,t.t=this.t+n+1,t.s=this.s,t.clamp()},a.prototype.rShiftTo=function(e,t){t.s=this.s;var s=Math.floor(e/this.DB);if(s>=this.t)t.t=0;else{var i=e%this.DB,r=this.DB-i,a=(1<<i)-1;t[0]=this[s]>>i;for(var n=s+1;n<this.t;++n)t[n-s-1]|=(this[n]&a)<<r,t[n-s]=this[n]>>i;i>0&&(t[this.t-s-1]|=(this.s&a)<<r),t.t=this.t-s,t.clamp()}},a.prototype.subTo=function(e,t){for(var s=0,i=0,r=Math.min(e.t,this.t);s<r;)i+=this[s]-e[s],t[s++]=i&this.DM,i>>=this.DB;if(e.t<this.t){for(i-=e.s;s<this.t;)i+=this[s],t[s++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;s<e.t;)i-=e[s],t[s++]=i&this.DM,i>>=this.DB;i-=e.s}t.s=i<0?-1:0,i<-1?t[s++]=this.DV+i:i>0&&(t[s++]=i),t.t=s,t.clamp()},a.prototype.multiplyTo=function(e,t){var s=this.abs(),i=e.abs(),r=s.t;for(t.t=r+i.t;--r>=0;)t[r]=0;for(r=0;r<i.t;++r)t[r+s.t]=s.am(0,i[r],t,r,0,s.t);t.s=0,t.clamp(),this.s!=e.s&&a.ZERO.subTo(t,t)},a.prototype.squareTo=function(e){for(var t=this.abs(),s=e.t=2*t.t;--s>=0;)e[s]=0;for(s=0;s<t.t-1;++s){var i=t.am(s,t[s],e,2*s,0,1);(e[s+t.t]+=t.am(s+1,2*t[s],e,2*s+1,i,t.t-s-1))>=t.DV&&(e[s+t.t]-=t.DV,e[s+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(s,t[s],e,2*s,0,1)),e.s=0,e.clamp()},a.prototype.divRemTo=function(e,t,s){var i=e.abs();if(!(i.t<=0)){var r=this.abs();if(r.t<i.t)return null!=t&&t.fromInt(0),void(null!=s&&this.copyTo(s));null==s&&(s=n());var o=n(),c=this.s,d=e.s,h=this.DB-f(i[i.t-1]);h>0?(i.lShiftTo(h,o),r.lShiftTo(h,s)):(i.copyTo(o),r.copyTo(s));var u=o.t,l=o[u-1];if(0!==l){var p=l*(1<<this.F1)+(u>1?o[u-2]>>this.F2:0),m=this.FV/p,b=(1<<this.F1)/p,g=1<<this.F2,y=s.t,v=y-u,w=null==t?n():t;for(o.dlShiftTo(v,w),s.compareTo(w)>=0&&(s[s.t++]=1,s.subTo(w,s)),a.ONE.dlShiftTo(u,w),w.subTo(o,o);o.t<u;)o[o.t++]=0;for(;--v>=0;){var k=s[--y]==l?this.DM:Math.floor(s[y]*m+(s[y-1]+g)*b);if((s[y]+=o.am(0,k,s,v,0,u))<k)for(o.dlShiftTo(v,w),s.subTo(w,s);s[y]<--k;)s.subTo(w,s)}null!=t&&(s.drShiftTo(u,t),c!=d&&a.ZERO.subTo(t,t)),s.t=u,s.clamp(),h>0&&s.rShiftTo(h,s),c<0&&a.ZERO.subTo(s,s)}}},a.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},a.prototype.isEven=function(){return 0===(this.t>0?1&this[0]:this.s)},a.prototype.exp=function(e,t){if(e>4294967295||e<1)return a.ONE;var s=n(),i=n(),r=t.convert(this),o=f(e)-1;for(r.copyTo(s);--o>=0;)if(t.sqrTo(s,i),(e&1<<o)>0)t.mulTo(i,r,s);else{var c=s;s=i,i=c}return t.revert(s)},a.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},a.prototype.toRadix=function(e){if(null==e&&(e=10),0===this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),s=Math.pow(e,t),i=l(s),r=n(),a=n(),o="";for(this.divRemTo(i,r,a);r.signum()>0;)o=(s+a.intValue()).toString(e).substr(1)+o,r.divRemTo(i,r,a);return a.intValue().toString(e)+o},a.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var s=this.chunkSize(t),i=Math.pow(t,s),r=!1,n=0,o=0,c=0;c<e.length;++c){var d=u(e,c);d<0?"-"==e.charAt(c)&&0===this.signum()&&(r=!0):(o=t*o+d,++n>=s&&(this.dMultiply(i),this.dAddOffset(o,0),n=0,o=0))}n>0&&(this.dMultiply(Math.pow(t,n)),this.dAddOffset(o,0)),r&&a.ZERO.subTo(this,this)},a.prototype.bitwiseTo=function(e,t,s){var i,r,a=Math.min(e.t,this.t);for(i=0;i<a;++i)s[i]=t(this[i],e[i]);if(e.t<this.t){for(r=e.s&this.DM,i=a;i<this.t;++i)s[i]=t(this[i],r);s.t=this.t}else{for(r=this.s&this.DM,i=a;i<e.t;++i)s[i]=t(r,e[i]);s.t=e.t}s.s=t(this.s,e.s),s.clamp()},a.prototype.addTo=function(e,t){for(var s=0,i=0,r=Math.min(e.t,this.t);s<r;)i+=this[s]+e[s],t[s++]=i&this.DM,i>>=this.DB;if(e.t<this.t){for(i+=e.s;s<this.t;)i+=this[s],t[s++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;s<e.t;)i+=e[s],t[s++]=i&this.DM,i>>=this.DB;i+=e.s}t.s=i<0?-1:0,i>0?t[s++]=i:i<-1&&(t[s++]=this.DV+i),t.t=s,t.clamp()},a.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},a.prototype.dAddOffset=function(e,t){if(0!==e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},a.prototype.multiplyLowerTo=function(e,t,s){var i,r=Math.min(this.t+e.t,t);for(s.s=0,s.t=r;r>0;)s[--r]=0;for(i=s.t-this.t;r<i;++r)s[r+this.t]=this.am(0,e[r],s,r,0,this.t);for(i=Math.min(e.t,t);r<i;++r)this.am(0,e[r],s,r,0,t-r);s.clamp()},a.prototype.multiplyUpperTo=function(e,t,s){--t;var i=s.t=this.t+e.t-t;for(s.s=0;--i>=0;)s[i]=0;for(i=Math.max(t-this.t,0);i<e.t;++i)s[this.t+i-t]=this.am(t-i,e[i],s,0,0,this.t+i-t);s.clamp(),s.drShiftTo(1,s)},a.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var s,i=(1<<t)-1,r=!1,a="",n=this.t,o=this.DB-n*this.DB%t;if(n-- >0)for(o<this.DB&&(s=this[n]>>o)>0&&(r=!0,a=h(s));n>=0;)o<t?(s=(this[n]&(1<<o)-1)<<t-o,s|=this[--n]>>(o+=this.DB-t)):(s=this[n]>>(o-=t)&i,o<=0&&(o+=this.DB,--n)),s>0&&(r=!0),r&&(a+=h(s));return r?a:"0"},a.prototype.negate=function(){var e=n();return a.ZERO.subTo(this,e),e},a.prototype.abs=function(){return this.s<0?this.negate():this},a.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var s=this.t;if(0!=(t=s-e.t))return this.s<0?-t:t;for(;--s>=0;)if(0!=(t=this[s]-e[s]))return t;return 0},a.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+f(this[this.t-1]^this.s&this.DM)},a.prototype.mod=function(e){var t=n();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(a.ZERO)>0&&e.subTo(t,t),t},a.prototype.clone=function(){var e=n();return this.copyTo(e),e},a.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0===this.t)return-1}else{if(1==this.t)return this[0];if(0===this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},a.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},a.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var s,i=this.DB-e*this.DB%8,r=0;if(e-- >0)for(i<this.DB&&(s=this[e]>>i)!=(this.s&this.DM)>>i&&(t[r++]=s|this.s<<this.DB-i);e>=0;)i<8?(s=(this[e]&(1<<i)-1)<<8-i,s|=this[--e]>>(i+=this.DB-8)):(s=this[e]>>(i-=8)&255,i<=0&&(i+=this.DB,--e)),0!=(128&s)&&(s|=-256),0===r&&(128&this.s)!=(128&s)&&++r,(r>0||s!=this.s)&&(t[r++]=s);return t},a.prototype.toBuffer=function(e){var t=i.from(this.toByteArray());if(!0===e&&0===t[0])t=t.slice(1);else if(r.isNumber(e)){if(t.length>e){for(var s=0;s<t.length-e;s++)if(0!==t[s])return null;return t.slice(t.length-e)}if(t.length<e){var a=i.alloc(e);return a.fill(0,0,e-t.length),t.copy(a,e-t.length),a}}return t},a.prototype.equals=function(e){return 0==this.compareTo(e)},a.prototype.min=function(e){return this.compareTo(e)<0?this:e},a.prototype.max=function(e){return this.compareTo(e)>0?this:e},a.prototype.and=function(e){var t=n();return this.bitwiseTo(e,b,t),t},a.prototype.or=function(e){var t=n();return this.bitwiseTo(e,g,t),t},a.prototype.xor=function(e){var t=n();return this.bitwiseTo(e,y,t),t},a.prototype.not=function(){for(var e=n(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},a.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+v(this[e]);return this.s<0?this.t*this.DB:-1},a.prototype.add=function(e){var t=n();return this.addTo(e,t),t},a.prototype.subtract=function(e){var t=n();return this.subTo(e,t),t},a.prototype.multiply=function(e){var t=n();return this.multiplyTo(e,t),t},a.prototype.divide=function(e){var t=n();return this.divRemTo(e,t,null),t},a.prototype.remainder=function(e){var t=n();return this.divRemTo(e,null,t),t},a.prototype.modPow=function(e,t){var s,i,r=e.bitLength(),a=l(1);if(r<=0)return a;s=r<18?1:r<48?3:r<144?4:r<768?5:6,i=r<8?new p(t):t.isEven()?new S(t):new m(t);var o=new Array,c=3,d=s-1,h=(1<<s)-1;if(o[1]=i.convert(this),s>1){var u=n();for(i.sqrTo(o[1],u);c<=h;)o[c]=n(),i.mulTo(u,o[c-2],o[c]),c+=2}var b,g,y=e.t-1,v=!0,w=n();for(r=f(e[y])-1;y>=0;){for(r>=d?b=e[y]>>r-d&h:(b=(e[y]&(1<<r+1)-1)<<d-r,y>0&&(b|=e[y-1]>>this.DB+r-d)),c=s;0==(1&b);)b>>=1,--c;if((r-=c)<0&&(r+=this.DB,--y),v)o[b].copyTo(a),v=!1;else{for(;c>1;)i.sqrTo(a,w),i.sqrTo(w,a),c-=2;c>0?i.sqrTo(a,w):(g=a,a=w,w=g),i.mulTo(w,o[b],a)}for(;y>=0&&0==(e[y]&1<<r);)i.sqrTo(a,w),g=a,a=w,w=g,--r<0&&(r=this.DB-1,--y)}return i.revert(a)},a.prototype.pow=function(e){return this.exp(e,new w)},a.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),s=e.s<0?e.negate():e.clone();if(t.compareTo(s)<0){var i=t;t=s,s=i}var r=t.getLowestSetBit(),a=s.getLowestSetBit();if(a<0)return t;for(r<a&&(a=r),a>0&&(t.rShiftTo(a,t),s.rShiftTo(a,s));t.signum()>0;)(r=t.getLowestSetBit())>0&&t.rShiftTo(r,t),(r=s.getLowestSetBit())>0&&s.rShiftTo(r,s),t.compareTo(s)>=0?(t.subTo(s,t),t.rShiftTo(1,t)):(s.subTo(t,s),s.rShiftTo(1,s));return a>0&&s.lShiftTo(a,s),s},a.int2char=h,a.ZERO=l(0),a.ONE=l(1),a.prototype.square=function(){var e=n();return this.squareTo(e),e},e.exports=a},939:(e,t,s)=>{var i=s(1147)._,r=s(8446),a=s(1147),n=s(8173);e.exports.Key=function(){function e(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return e.prototype.setOptions=function(e){var t=n[e.signingScheme],s=n[e.encryptionScheme];t===s?this.signingScheme=this.encryptionScheme=s.makeScheme(this,e):(this.encryptionScheme=s.makeScheme(this,e),this.signingScheme=t.makeScheme(this,e))},e.prototype.setPrivate=function(e,t,s,n,o,c,d,h){if(!(e&&t&&s&&e.length>0&&(i.isNumber(t)||t.length>0)&&s.length>0))throw Error("Invalid RSA private key");this.n=new r(e),this.e=i.isNumber(t)?t:a.get32IntFromBuffer(t,0),this.d=new r(s),n&&o&&c&&d&&h&&(this.p=new r(n),this.q=new r(o),this.dmp1=new r(c),this.dmq1=new r(d),this.coeff=new r(h)),this.$$recalculateCache()},e.prototype.$doPrivate=function(e){if(this.p||this.q)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),s=e.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(s)<0;)t=t.add(this.p);return t.subtract(s).multiply(this.coeff).mod(this.p).multiply(this.q).add(s)},e.prototype.sign=function(e){return this.signingScheme.sign.apply(this.signingScheme,arguments)},e.prototype.isPrivate=function(){return this.n&&this.e&&this.d||!1},Object.defineProperty(e.prototype,"keySize",{get:function(){return this.cache.keyBitLength}}),Object.defineProperty(e.prototype,"encryptedDataLength",{get:function(){return this.cache.keyByteLength}}),Object.defineProperty(e.prototype,"maxMessageLength",{get:function(){return this.encryptionScheme.maxMessageLength()}}),e.prototype.$$recalculateCache=function(){this.cache=this.cache||{},this.cache.keyBitLength=this.n.bitLength(),this.cache.keyByteLength=this.cache.keyBitLength+6>>3},e}()},3679:(e,t,s)=>{var i=s(8764).Buffer,r=s(8446),a=s(7295),n=3;s(7567);var o={md2:i.from("3020300c06082a864886f70d020205000410","hex"),md5:i.from("3020300c06082a864886f70d020505000410","hex"),sha1:i.from("3021300906052b0e03021a05000414","hex"),sha224:i.from("302d300d06096086480165030402040500041c","hex"),sha256:i.from("3031300d060960864801650304020105000420","hex"),sha384:i.from("3041300d060960864801650304020205000430","hex"),sha512:i.from("3051300d060960864801650304020305000440","hex"),ripemd160:i.from("3021300906052b2403020105000414","hex"),rmd160:i.from("3021300906052b2403020105000414","hex")},c={ripemd160:"rmd160"};function d(e,t){var s=[];return t>0&&s.push(e>>>24),t>1&&s.push(e>>>16&255),t>2&&s.push(e>>>8&255),t>3&&s.push(255&e),s}e.exports={isEncryption:!0,isSignature:!0},e.exports.makeScheme=function(e,t){function s(e,t){this.key=e,this.options=t}return s.prototype.maxMessageLength=function(){return this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==n?this.key.encryptedDataLength:this.key.encryptedDataLength-11},s.prototype.encUnPad=function(e,t){t=t||{};var s=0;if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==n)return"function"==typeof e.lastIndexOf?e.slice(e.lastIndexOf("\0")+1,e.length):e.slice(String.prototype.lastIndexOf.call(e,"\0")+1,e.length);if(e.length<4)return null;if(1===t.type){if(0!==e[0]&&1!==e[1])return null;for(s=3;0!==e[s];)if(255!=e[s]||++s>=e.length)return null}else{if(0!==e[0]&&2!==e[1])return null;for(s=3;0!==e[s];)if(++s>=e.length)return null}return e.slice(s+1,e.length)},s.prototype.sign=function(e){var t=this.options.signingSchemeOptions.hash||"sha256";if("browser"===this.options.environment){var s=function(e){let t;if(!e.hasOwnProperty("sigBytes")||!e.hasOwnProperty("words"))throw Error("Argument not a wordArray");t=e.sigBytes,e=e.words;const s=[];let r=[],a=0;for(;t>0;)r=d(e[a],Math.min(4,t)),t-=r.length,s.push(r),a++;return new i.from([].concat.apply([],s),"hex")}(a[(t=c[t]||t).toUpperCase()](e.toString())),n=this.pkcs1pad(s,t);return this.key.$doPrivate(new r(n)).toBuffer(this.key.encryptedDataLength)}throw new Error("CCXT only supports browser mode :P")},s.prototype.pkcs1pad=function(e,t){var s=o[t];if(!s)throw Error("Unsupported hash algorithm");var r=i.concat([s,e]);if(r.length+10>this.key.encryptedDataLength)throw Error("Key is too short for signing algorithm ("+t+")");var a=i.alloc(this.key.encryptedDataLength-r.length-1);return a.fill(255,0,a.length-1),a[0]=1,a[a.length-1]=0,i.concat([a,r])},new s(e,t)}},8173:(e,t,s)=>{e.exports={pkcs1:s(3679),isEncryption:function(t){return e.exports[t]&&e.exports[t].isEncryption},isSignature:function(t){return e.exports[t]&&e.exports[t].isSignature}}},1147:e=>{e.exports.linebrk=function(e,t){for(var s="",i=0;i+t<e.length;)s+=e.substring(i,i+t)+"\n",i+=t;return s+e.substring(i,e.length)},e.exports.get32IntFromBuffer=function(e,t){t=t||0;var s;if((s=e.length-t)>0){if(s>=4)return e.readUInt32BE(t);for(var i=0,r=t+s,a=0;r>t;r--,a+=2)i+=e[r-1]*Math.pow(16,a);return i}return NaN},e.exports._={isObject:function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)},isString:function(e){return"string"==typeof e||e instanceof String},isNumber:function(e){return"number"==typeof e||!isNaN(parseFloat(e))&&isFinite(e)},omit:function(e,t){var s={};for(var i in e)e.hasOwnProperty(i)&&i!==t&&(s[i]=e[i]);return s}},e.exports.trimSurroundingText=function(e,t,s){var i=0,r=e.length,a=e.indexOf(t);a>=0&&(i=a+t.length);var n=e.indexOf(s,a);return n>=0&&(r=n),e.substring(i,r)}},7539:e=>{"use strict";var t=String.prototype.replace,s=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(e){return t.call(e,s,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},4106:(e,t,s)=>{"use strict";var i=s(8633),r=s(8006),a=s(7539);e.exports={formats:a,parse:r,stringify:i}},8006:(e,t,s)=>{"use strict";var i=s(8578),r=Object.prototype.hasOwnProperty,a={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:i.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},n=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},o=function(e,t,s){if(e){var i=s.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/g,n=/(\[[^[\]]*])/.exec(i),o=n?i.slice(0,n.index):i,c=[];if(o){if(!s.plainObjects&&r.call(Object.prototype,o)&&!s.allowPrototypes)return;c.push(o)}for(var d=0;null!==(n=a.exec(i))&&d<s.depth;){if(d+=1,!s.plainObjects&&r.call(Object.prototype,n[1].slice(1,-1))&&!s.allowPrototypes)return;c.push(n[1])}return n&&c.push("["+i.slice(n.index)+"]"),function(e,t,s){for(var i=t,r=e.length-1;r>=0;--r){var a,n=e[r];if("[]"===n&&s.parseArrays)a=[].concat(i);else{a=s.plainObjects?Object.create(null):{};var o="["===n.charAt(0)&&"]"===n.charAt(n.length-1)?n.slice(1,-1):n,c=parseInt(o,10);s.parseArrays||""!==o?!isNaN(c)&&n!==o&&String(c)===o&&c>=0&&s.parseArrays&&c<=s.arrayLimit?(a=[])[c]=i:a[o]=i:a={0:i}}i=a}return i}(c,t,s)}};e.exports=function(e,t){var s=function(e){if(!e)return a;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new Error("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?a.charset:e.charset;return{allowDots:void 0===e.allowDots?a.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:a.allowPrototypes,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:a.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:a.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:a.comma,decoder:"function"==typeof e.decoder?e.decoder:a.decoder,delimiter:"string"==typeof e.delimiter||i.isRegExp(e.delimiter)?e.delimiter:a.delimiter,depth:"number"==typeof e.depth?e.depth:a.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:a.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:a.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:a.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:a.strictNullHandling}}(t);if(""===e||null==e)return s.plainObjects?Object.create(null):{};for(var c="string"==typeof e?function(e,t){var s,o={},c=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,d=t.parameterLimit===1/0?void 0:t.parameterLimit,h=c.split(t.delimiter,d),u=-1,l=t.charset;if(t.charsetSentinel)for(s=0;s<h.length;++s)0===h[s].indexOf("utf8=")&&("utf8=%E2%9C%93"===h[s]?l="utf-8":"utf8=%26%2310003%3B"===h[s]&&(l="iso-8859-1"),u=s,s=h.length);for(s=0;s<h.length;++s)if(s!==u){var f,p,m=h[s],b=m.indexOf("]="),g=-1===b?m.indexOf("="):b+1;-1===g?(f=t.decoder(m,a.decoder,l),p=t.strictNullHandling?null:""):(f=t.decoder(m.slice(0,g),a.decoder,l),p=t.decoder(m.slice(g+1),a.decoder,l)),p&&t.interpretNumericEntities&&"iso-8859-1"===l&&(p=n(p)),p&&t.comma&&p.indexOf(",")>-1&&(p=p.split(",")),r.call(o,f)?o[f]=i.combine(o[f],p):o[f]=p}return o}(e,s):e,d=s.plainObjects?Object.create(null):{},h=Object.keys(c),u=0;u<h.length;++u){var l=h[u],f=o(l,c[l],s);d=i.merge(d,f,s)}return i.compact(d)}},8633:(e,t,s)=>{"use strict";var i=s(8578),r=s(7539),a=Object.prototype.hasOwnProperty,n={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},o=Array.isArray,c=Array.prototype.push,d=function(e,t){c.apply(e,o(t)?t:[t])},h=Date.prototype.toISOString,u={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:i.encode,encodeValuesOnly:!1,formatter:r.formatters[r.default],indices:!1,serializeDate:function(e){return h.call(e)},skipNulls:!1,strictNullHandling:!1},l=function e(t,s,r,a,n,c,h,l,f,p,m,b,g){var y=t;if("function"==typeof h?y=h(s,y):y instanceof Date?y=p(y):"comma"===r&&o(y)&&(y=y.join(",")),null===y){if(a)return c&&!b?c(s,u.encoder,g):s;y=""}if("string"==typeof y||"number"==typeof y||"boolean"==typeof y||i.isBuffer(y))return c?[m(b?s:c(s,u.encoder,g))+"="+m(c(y,u.encoder,g))]:[m(s)+"="+m(String(y))];var v,w=[];if(void 0===y)return w;if(o(h))v=h;else{var k=Object.keys(y);v=l?k.sort(l):k}for(var S=0;S<v.length;++S){var _=v[S];n&&null===y[_]||(o(y)?d(w,e(y[_],"function"==typeof r?r(s,_):s,r,a,n,c,h,l,f,p,m,b,g)):d(w,e(y[_],s+(f?"."+_:"["+_+"]"),r,a,n,c,h,l,f,p,m,b,g)))}return w};e.exports=function(e,t){var s,i=e,c=function(e){if(!e)return u;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||u.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var s=r.default;if(void 0!==e.format){if(!a.call(r.formatters,e.format))throw new TypeError("Unknown format option provided.");s=e.format}var i=r.formatters[s],n=u.filter;return("function"==typeof e.filter||o(e.filter))&&(n=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:u.addQueryPrefix,allowDots:void 0===e.allowDots?u.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:u.charsetSentinel,delimiter:void 0===e.delimiter?u.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:u.encode,encoder:"function"==typeof e.encoder?e.encoder:u.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:u.encodeValuesOnly,filter:n,formatter:i,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:u.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:u.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:u.strictNullHandling}}(t);"function"==typeof c.filter?i=(0,c.filter)("",i):o(c.filter)&&(s=c.filter);var h,f=[];if("object"!=typeof i||null===i)return"";h=t&&t.arrayFormat in n?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var p=n[h];s||(s=Object.keys(i)),c.sort&&s.sort(c.sort);for(var m=0;m<s.length;++m){var b=s[m];c.skipNulls&&null===i[b]||d(f,l(i[b],b,p,c.strictNullHandling,c.skipNulls,c.encode?c.encoder:null,c.filter,c.sort,c.allowDots,c.serializeDate,c.formatter,c.encodeValuesOnly,c.charset))}var g=f.join(c.delimiter),y=!0===c.addQueryPrefix?"?":"";return c.charsetSentinel&&("iso-8859-1"===c.charset?y+="utf8=%26%2310003%3B&":y+="utf8=%E2%9C%93&"),g.length>0?y+g:""}},8578:e=>{"use strict";var t=Object.prototype.hasOwnProperty,s=Array.isArray,i=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),r=function(e,t){for(var s=t&&t.plainObjects?Object.create(null):{},i=0;i<e.length;++i)void 0!==e[i]&&(s[i]=e[i]);return s};e.exports={arrayToObject:r,assign:function(e,t){return Object.keys(t).reduce((function(e,s){return e[s]=t[s],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],i=[],r=0;r<t.length;++r)for(var a=t[r],n=a.obj[a.prop],o=Object.keys(n),c=0;c<o.length;++c){var d=o[c],h=n[d];"object"==typeof h&&null!==h&&-1===i.indexOf(h)&&(t.push({obj:n,prop:d}),i.push(h))}return function(e){for(;e.length>1;){var t=e.pop(),i=t.obj[t.prop];if(s(i)){for(var r=[],a=0;a<i.length;++a)void 0!==i[a]&&r.push(i[a]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,s){var i=e.replace(/\+/g," ");if("iso-8859-1"===s)return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch(e){return i}},encode:function(e,t,s){if(0===e.length)return e;var r="string"==typeof e?e:String(e);if("iso-8859-1"===s)return escape(r).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var a="",n=0;n<r.length;++n){var o=r.charCodeAt(n);45===o||46===o||95===o||126===o||o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122?a+=r.charAt(n):o<128?a+=i[o]:o<2048?a+=i[192|o>>6]+i[128|63&o]:o<55296||o>=57344?a+=i[224|o>>12]+i[128|o>>6&63]+i[128|63&o]:(n+=1,o=65536+((1023&o)<<10|1023&r.charCodeAt(n)),a+=i[240|o>>18]+i[128|o>>12&63]+i[128|o>>6&63]+i[128|63&o])}return a},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function e(i,a,n){if(!a)return i;if("object"!=typeof a){if(s(i))i.push(a);else{if(!i||"object"!=typeof i)return[i,a];(n&&(n.plainObjects||n.allowPrototypes)||!t.call(Object.prototype,a))&&(i[a]=!0)}return i}if(!i||"object"!=typeof i)return[i].concat(a);var o=i;return s(i)&&!s(a)&&(o=r(i,n)),s(i)&&s(a)?(a.forEach((function(s,r){if(t.call(i,r)){var a=i[r];a&&"object"==typeof a&&s&&"object"==typeof s?i[r]=e(a,s,n):i.push(s)}else i[r]=s})),i):Object.keys(a).reduce((function(s,i){var r=a[i];return t.call(s,i)?s[i]=e(s[i],r,n):s[i]=r,s}),o)}}},842:(e,t,s)=>{"use strict";const i=s(8819),{ArgumentsRequired:r,AuthenticationError:a,ExchangeError:n,InsufficientFunds:o,OrderNotFound:c,PermissionDenied:d,BadRequest:h,BadSymbol:u,DDoSProtection:l}=s(3449),f=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"stex",name:"STEX",countries:["EE"],rateLimit:500,certified:!1,has:{cancelAllOrders:!0,cancelOrder:!0,CORS:!1,createDepositAddress:!0,createMarketOrder:!1,createOrder:!0,fetchBalance:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchFundingFees:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrderTrades:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchWithdrawals:!0,withdraw:!0},version:"v3",urls:{logo:"https://user-images.githubusercontent.com/1294454/69680782-03fd0b80-10bd-11ea-909e-7f603500e9cc.jpg",api:"https://api3.stex.com",www:"https://www.stex.com",doc:["https://help.stex.com/en/collections/1593608-api-v3-documentation"],fees:"https://app.stex.com/en/pairs-specification",referral:"https://app.stex.com?ref=36416021"},requiredCredentials:{apiKey:!1,secret:!1,token:!0},timeframes:{"1m":"1","5m":"5","30m":"30","1h":"60","4h":"240","12h":"720","1d":"1D"},api:{public:{get:["currencies","currencies/{currencyId}","markets","pairs-groups","currency_pairs/list/{code}","currency_pairs/group/{currencyPairGroupId}","currency_pairs/{currencyPairId}","ticker","ticker/{currencyPairId}","trades/{currencyPairId}","orderbook/{currencyPairId}","chart/{currencyPairId}/{candlesType}","deposit-statuses","deposit-statuses/{statusId}","withdrawal-statuses","withdrawal-statuses/{statusId}","ping","mobile-versions"]},trading:{get:["fees/{currencyPairId}","orders","orders/{currencyPairId}","order/{orderId}"],post:["orders/{currencyPairId}"],delete:["orders","orders/{currencyPairId}","order/{orderId}"]},reports:{get:["orders","orders/{orderId}","trades/{currencyPairId}","background/{listMode}","background/{id}","background/download/{id}"],post:["background/create"],delete:["background/{id}"]},profile:{get:["info","wallets","wallets/{walletId}","wallets/address/{walletId}","deposits","deposits/{id}","withdrawals","withdrawals/{id}","notifications","favorite/currency_pairs","token-scopes"],post:["wallets/burn/{walletId}","wallets/{currencyId}","wallets/address/{walletId}","withdraw","referral/program","referral/insert/{code}","referral/bonus_transfer/{currencyId}"],put:["profile/favorite/currency_pairs/set"],delete:["profile/withdraw/{withdrawalId}"]},verification:{get:["verification/countries","verification/stex"],post:["verification/stex"]},settings:{get:["notifications/{event}","notifications"],put:["notifications","notifications/set"]}},fees:{trading:{tierBased:!1,percentage:!0,taker:.002,maker:.002}},commonCurrencies:{BC:"Bitcoin Confidential",BITS:"Bitcoinus",BITSW:"BITS",BHD:"Bithold",BTH:"Bithereum",MPH:"Chasyr Token",SBTC:"SBTCT"},options:{parseOrderToPrecision:!1},exceptions:{exact:{"Wrong parameters":h,"Unauthenticated.":a,"Server Error":n,"This feature is only enabled for users verifies by Cryptonomica":d,"Too Many Attempts.":l,"Selected Pair is disabled":u},broad:{"Not enough":o}}})}async fetchCurrencies(e={}){const t=await this.publicGetCurrencies(e),s={},i=this.safeValue(t,"data",[]);for(let e=0;e<i.length;e++){const t=i[e],r=this.safeString(t,"id"),a=this.safeInteger(t,"id"),n=this.safeCurrencyCode(this.safeString(t,"code")),o=this.safeString(t,"precision"),c=this.parsePrecision(o),d=this.safeNumber(t,"withdrawal_fee_const"),h=this.safeValue(t,"active",!0);s[n]={id:r,numericId:a,code:n,info:t,type:void 0,name:this.safeString(t,"name"),active:h,fee:d,precision:parseInt(o),limits:{amount:{min:this.parseNumber(c),max:void 0},deposit:{min:this.safeNumber(t,"minimum_deposit_amount"),max:void 0},withdraw:{min:this.safeNumber(t,"minimum_withdrawal_amount"),max:void 0}}}}return s}async fetchMarkets(e={}){const t=await this.publicGetCurrencyPairsListCode(this.extend({code:"ALL"},e)),s=[],i=this.safeValue(t,"data",[]);for(let e=0;e<i.length;e++){const t=i[e],r=this.safeString(t,"id"),a=this.safeInteger(t,"id"),n=this.safeString(t,"currency_id"),o=this.safeString(t,"market_currency_id"),c=this.safeInteger(t,"currency_id"),d=this.safeInteger(t,"market_currency_id"),h=this.safeCurrencyCode(this.safeString(t,"currency_code")),u=this.safeCurrencyCode(this.safeString(t,"market_code")),l=h+"/"+u,f={amount:this.safeInteger(t,"currency_precision"),price:this.safeInteger(t,"market_precision")},p=this.safeValue(t,"active"),m=this.safeNumber(t,"min_buy_price"),b=this.safeNumber(t,"min_sell_price"),g=Math.max(m,b),y=this.safeNumber(t,"buy_fee_percent")/100,v=this.safeNumber(t,"sell_fee_percent")/100,w=Math.max(y,v);s.push({id:r,numericId:a,symbol:l,base:h,quote:u,baseId:n,quoteId:o,baseNumericId:c,quoteNumericId:d,info:t,active:p,maker:w,taker:w,precision:f,limits:{amount:{min:this.safeNumber(t,"min_order_amount"),max:void 0},price:{min:g,max:void 0},cost:{min:void 0,max:void 0}}})}return s}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={currencyPairId:s.id},r=await this.publicGetTickerCurrencyPairId(this.extend(i,t)),a=this.safeValue(r,"data",{});return this.parseTicker(a,s)}async fetchTime(e={}){const t=await this.publicGetPing(e),s=this.safeValue(t,"data",{}),i=this.safeValue(s,"server_datetime",{});return this.parse8601(this.safeString(i,"date"))}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={currencyPairId:this.market(e).id};void 0!==t&&(i.limit_bids=t,i.limit_asks=t);const r=await this.publicGetOrderbookCurrencyPairId(this.extend(i,s)),a=this.safeValue(r,"data",{});return this.parseOrderBook(a,e,void 0,"bid","ask","price","amount")}parseTicker(e,t){const s=this.safeInteger(e,"timestamp"),i=this.safeString2(e,"id","symbol"),r=this.safeSymbol(i,t,"_"),a=this.safeNumber(e,"last"),n=this.safeNumber(e,"open");let o,c;return void 0!==a&&void 0!==n&&n>0&&(o=a-n,c=100/n*a-100),{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"bid"),bidVolume:void 0,ask:this.safeNumber(e,"ask"),askVolume:void 0,vwap:void 0,open:n,close:a,last:a,previousClose:void 0,change:o,percentage:c,average:void 0,baseVolume:this.safeNumber(e,"volumeQuote"),quoteVolume:this.safeNumber(e,"volume"),info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTicker(t),i=this.safeValue(s,"data",[]);return this.parseTickers(i,e)}parseOHLCV(e,t){return[this.safeInteger(e,"time"),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}async fetchOHLCV(e,t="1d",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={currencyPairId:a.id,candlesType:this.timeframes[t]};void 0===i?i=100:n.limit=i;const o=i*this.parseTimeframe(t);void 0===s?(n.timeEnd=this.seconds(),n.timeStart=n.timeEnd-o):(n.timeStart=parseInt(s/1e3),n.timeEnd=this.sum(n.timeStart,o));const c=await this.publicGetChartCurrencyPairIdCandlesType(this.extend(n,r)),d=this.safeValue(c,"data",[]);return this.parseOHLCVs(d,a,t,s,i)}parseTrade(e,t){const s=this.safeString(e,"id"),i=this.safeTimestamp(e,"timestamp"),r=this.safeString(e,"price"),a=this.safeString(e,"amount"),n=this.parseNumber(r),o=this.parseNumber(a),c=this.parseNumber(f.stringMul(r,a));let d;void 0===d&&void 0!==t&&(d=t.symbol);const h=this.safeStringLower2(e,"type","trade_type");return{info:e,timestamp:i,datetime:this.iso8601(i),symbol:d,id:s,order:void 0,type:void 0,takerOrMaker:void 0,side:h,price:n,amount:o,cost:c,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={currencyPairId:r.id};void 0!==s&&(a.limit=s),void 0!==t&&(a.sort="ASC",a.from=parseInt(t/1e3));const n=await this.publicGetTradesCurrencyPairId(this.extend(a,i)),o=this.safeValue(n,"data",[]);return this.parseTrades(o,r,t,s)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.profileGetWallets(e),s={info:t,timestamp:void 0,datetime:void 0},i=this.safeValue(t,"data",[]);for(let e=0;e<i.length;e++){const t=i[e],r=this.safeCurrencyCode(this.safeString(t,"currency_id")),a=this.account();a.free=this.safeString(t,"balance"),a.used=this.safeString(t,"frozen_balance"),s[r]=a}return this.parseBalance(s,!1)}parseOrderStatus(e){return this.safeString({PROCESSING:"open",PENDING:"open",PARTIAL:"open",FINISHED:"closed",CANCELLED:"canceled"},e,e)}parseOrder(e,t){const s=this.safeString(e,"id"),i=this.parseOrderStatus(this.safeString(e,"status")),r=this.safeString2(e,"currency_pair_id","currency_pair_name"),a=this.safeSymbol(r,t,"_"),n=this.safeTimestamp(e,"timestamp"),o=this.safeNumber(e,"price"),c=this.safeNumber(e,"initial_amount"),d=this.safeNumber(e,"processed_amount");let h,u;void 0!==d&&(void 0!==c&&(h=c-d,this.options.parseOrderToPrecision&&(h=parseFloat(this.amountToPrecision(a,h))),h=Math.max(h,0)),void 0!==o&&void 0===u&&(u=o*d));let l=this.safeString(e,"original_type");"BUY"!==l&&"SELL"!==l||(l=void 0);const f=this.safeStringLower(e,"type"),p=this.safeValue(e,"trades");let m;void 0!==p&&(m=this.parseTrades(p,t,void 0,void 0,{symbol:a,order:s}));const b=this.safeNumber(e,"trigger_price"),g={info:e,id:s,clientOrderId:void 0,timestamp:n,datetime:this.iso8601(n),lastTradeTimestamp:void 0,symbol:a,type:l,timeInForce:void 0,postOnly:void 0,side:f,price:o,stopPrice:b,amount:c,cost:u,average:void 0,filled:d,remaining:h,status:i,trades:m},y=this.safeValue(e,"fees");if(void 0===y)g.fee=void 0;else{if(y.length>0){g.fees=[];for(let e=0;e<y.length;e++){const t=this.safeNumber(y[e],"amount");if(void 0!==t){const s=this.safeString(y[e],"currency_id"),i=this.safeCurrencyCode(s);g.fees.push({cost:t,currency:i})}}}else g.fee=void 0}return g}async createOrder(e,t,s,i,r,a={}){if("market"===t)throw new n(this.id+" createOrder allows limit orders only");await this.loadMarkets();const o=this.market(e);"limit"===t&&(t=s);const c={currencyPairId:o.id,type:t.toUpperCase(),amount:parseFloat(this.amountToPrecision(e,i)),price:parseFloat(this.priceToPrecision(e,r))},d=await this.tradingPostOrdersCurrencyPairId(this.extend(c,a)),h=this.safeValue(d,"data",{});return this.parseOrder(h,o)}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={orderId:e},r=await this.tradingGetOrderOrderId(this.extend(i,s)),a=this.safeValue(r,"data",{});let n;return void 0!==t&&(n=this.market(t)),this.parseOrder(a,n)}async fetchClosedOrder(e,t,s={}){await this.loadMarkets();const i={orderId:e},r=await this.reportsGetOrdersOrderId(this.extend(i,s)),a=this.safeValue(r,"data",{});let n;return void 0!==t&&(n=this.market(t)),this.parseOrder(a,n)}async fetchOrderTrades(e,t,s,i,r={}){return(await this.fetchClosedOrder(e,t,r)).trades}async fetchOpenOrders(e,t,s,i={}){let r;await this.loadMarkets();let a="tradingGetOrders";const n={};void 0!==e&&(a="tradingGetOrdersCurrencyPairId",r=this.market(e),n.currencyPairId=r.id),void 0!==s&&(n.limit=s);const o=await this[a](this.extend(n,i)),c=this.safeValue(o,"data",[]);return this.parseOrders(c,r,t,s)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={orderId:e},r=await this.tradingDeleteOrderOrderId(this.extend(i,s)),a=this.safeValue(r,"data",{}),n=this.safeValue(a,"put_into_processing_queue",[]),o=this.safeValue(a,"not_put_into_processing_queue",[]),d=n.length,h=o.length;if(d<1){if(h<1)throw new c(this.id+" cancelOrder received an empty response: "+this.json(r));return this.parseOrder(o[0])}if(h<1)return this.parseOrder(n[0]);throw new c(this.id+" cancelOrder received an empty response: "+this.json(r))}async cancelAllOrders(e,t={}){await this.loadMarkets();const s={};let i="tradingDeleteOrders";if(void 0!==e){const t=this.market(e);s.currencyPairId=t.id,i="tradingDeleteOrdersCurrencyPairId"}return await this[i](this.extend(s,t))}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new r(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const a=this.market(e),n={currencyPairId:a.id};void 0!==t&&(n.timeStart=this.iso8601(t)),void 0!==s&&(n.limit=s);const o=await this.reportsGetTradesCurrencyPairId(this.extend(n,i)),c=this.safeValue(o,"data",[]);return this.parseTrades(c,a,t,s)}async createDepositAddress(e,t={}){await this.loadMarkets();const s={currencyId:this.currency(e).id},i=await this.profilePostWalletsCurrencyId(this.extend(s,t)),r=this.safeValue(i,"data",{}),a=this.safeValue(r,"deposit_address",{}),n=this.safeString(a,"address"),o=this.safeString(a,"additional_address_parameter");return this.checkAddress(n),{currency:e,address:n,tag:o,info:i}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=await this.fetchBalance(),i=this.safeValue(s.info,"data",[]),r=this.indexBy(i,"currency_id"),a=this.currency(e),o=this.safeValue(r,a.id);if(void 0===o)throw new n(this.id+" fetchDepositAddress() could not find the wallet id for currency code "+e+", try to call createDepositAddress() first");const c=this.safeInteger(o,"id");if(void 0===c)throw new n(this.id+" fetchDepositAddress() could not find the wallet id for currency code "+e+", try to call createDepositAddress() first");const d={walletId:c},h=await this.profileGetWalletsWalletId(this.extend(d,t)),u=this.safeValue(h,"data",[]),l=this.safeValue(u,"deposit_address",{}),f=this.safeString(l,"address"),p=this.safeString(l,"additional_address_parameter");return this.checkAddress(f),{currency:e,address:f,tag:p,info:h}}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api+"/"+t+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));return"public"===t?Object.keys(o).length&&(n+="?"+this.urlencode(o)):(this.checkRequiredCredentials(),r={Authorization:"Bearer "+this.token},"GET"===s||"DELETE"===s?Object.keys(o).length&&(n+="?"+this.urlencode(o)):(a=this.json(o),Object.keys(o).length&&(r["Content-Type"]="application/json"))),{url:n,method:s,body:a,headers:r}}parseTransactionStatus(e){return this.safeString({processing:"pending","checking by system":"pending",hodl:"pending","amount too low":"failed","not confirmed":"pending","cancelled by User":"canceled",approved:"pending",finished:"ok","withdrawal error":"failed","deposit error":"failed","cancelled by admin":"canceled",awaiting:"pending"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"id"),i=this.safeValue(e,"withdrawal_address",{}),r=this.safeString(i,"address"),a=this.safeString(i,"additional_address_parameter"),n=this.safeString(e,"currency_id");let o;n in this.currencies_by_id?t=this.currencies_by_id[n]:o=this.commonCurrencyCode(this.safeString(e,"currency_code")),void 0===o&&void 0!==t&&(o=t.code);const c="deposit_status_id"in e?"deposit":"withdrawal",d=this.safeNumber(e,"amount"),h=this.parseTransactionStatus(this.safeStringLower(e,"status")),u=this.safeTimestamp2(e,"timestamp","created_ts"),l=this.safeTimestamp(e,"updated_ts"),f=this.safeString(e,"txid");let p;const m=this.safeNumber(e,"fee");if(void 0!==m){const t=this.safeString(e,"fee_currency_id","deposit_fee_currency_id");p={cost:m,currency:this.safeCurrencyCode(t)}}return{info:e,id:s,txid:f,timestamp:u,datetime:this.iso8601(u),addressFrom:void 0,address:r,addressTo:r,tagFrom:void 0,tag:a,tagTo:a,type:c,amount:d,currency:o,status:h,updated:l,fee:p}}async fetchDeposits(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.currency(e),a.currencyId=r.id),void 0!==s&&(a.limit=s),void 0!==t&&(a.timeStart=t);const n=await this.profileGetDeposits(this.extend(a,i)),o=this.safeValue(n,"data",[]);return this.parseTransactions(o,e,t,s)}async fetchWithdrawals(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.currency(e),a.currencyId=r.id),void 0!==s&&(a.limit=s),void 0!==t&&(a.timeStart=t);const n=await this.profileGetWithdrawals(this.extend(a,i)),o=this.safeValue(n,"data",[]);return this.parseTransactions(o,e,t,s)}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a=this.currency(e),n={currency_id:a.id,amount:parseFloat(this.currencyToPrecision(e,t)),address:s};void 0!==i&&(n.additional_address_parameter=i);const o=await this.profilePostWithdraw(this.extend(n,r)),c=this.safeValue(o,"data",{});return this.parseTransaction(c,a)}async fetchFundingFees(e,t={}){const s=await this.publicGetCurrencies(t),i=this.safeValue(s,"data",[]),r={},a={};for(let e=0;e<i.length;e++){const t=this.safeString(i[e],"id"),s=this.safeCurrencyCode(t);r[s]=this.safeNumber(i[e],"withdrawal_fee_const"),a[s]=this.safeNumber(i[e],"deposit_fee_const")}return{withdraw:r,deposit:a,info:s}}handleErrors(e,t,s,i,r,a,o,c,d){if(void 0===o)return;if(!this.safeValue(o,"success",!1)){const e=this.safeString(o,"message"),t=this.id+" "+a;throw this.throwExactlyMatchedException(this.exceptions.exact,e,t),this.throwBroadlyMatchedException(this.exceptions.broad,e,t),new n(t)}}}},9269:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,BadRequest:n,OrderNotFound:o,InvalidAddress:c}=s(3449),d=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"therock",name:"TheRockTrading",countries:["MT"],rateLimit:1e3,version:"v1",has:{cancelOrder:!0,CORS:!1,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchDeposits:!0,fetchLedger:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTransactions:"emulated",fetchWithdrawals:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/27766869-75057fa2-5ee9-11e7-9a6f-13e641fa4707.jpg",api:"https://api.therocktrading.com",www:"https://therocktrading.com",doc:["https://api.therocktrading.com/doc/v1/index.html","https://api.therocktrading.com/doc/"]},api:{public:{get:["funds","funds/{id}/orderbook","funds/{id}/ticker","funds/{id}/trades","funds/tickers"]},private:{get:["balances","balances/{id}","discounts","discounts/{id}","funds","funds/{id}","funds/{id}/trades","funds/{fund_id}/orders","funds/{fund_id}/orders/{id}","funds/{fund_id}/position_balances","funds/{fund_id}/positions","funds/{fund_id}/positions/{id}","transactions","transactions/{id}","withdraw_limits/{id}","withdraw_limits"],post:["atms/withdraw","funds/{fund_id}/orders"],delete:["funds/{fund_id}/orders/{id}","funds/{fund_id}/orders/remove_all"]}},fees:{trading:{maker:.002,taker:.002},funding:{tierBased:!1,percentage:!1,withdraw:{BTC:5e-4,BCH:5e-4,PPC:.02,ETH:.001,ZEC:.001,LTC:.002,EUR:2.5},deposit:{BTC:0,BCH:0,PPC:0,ETH:0,ZEC:0,LTC:0,EUR:0}}},exceptions:{exact:{"Request already running":n,"cannot specify multiple address types":n,"Currency is not included in the list":n,"Record not found":o},broad:{"before must be greater than after param":n,"must be shorter than 60 days":n,"must be a multiple of (period param) in minutes":n,"Address allocation limit reached for currency":c,"is not a valid value for param currency":n," is invalid":c}}})}async fetchMarkets(e={}){const t=await this.publicGetFunds(e),s=this.safeValue(t,"funds"),i=[];if(void 0===s)throw new r(this.id+" fetchMarkets got an unexpected response");for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"id"),a=this.safeString(t,"trade_currency"),n=this.safeString(t,"base_currency"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d=o+"/"+c,h=this.safeNumber(t,"buy_fee"),u=this.safeNumber(t,"sell_fee");let l=Math.max(h,u);l/=100;const f=l;i.push({id:r,symbol:d,base:o,quote:c,baseId:a,quoteId:n,info:t,active:!0,maker:f,taker:l,precision:{amount:this.safeInteger(t,"trade_currency_decimals"),price:this.safeInteger(t,"base_currency_decimals")},limits:{amount:{min:this.safeNumber(t,"minimum_quantity_offer"),max:void 0},price:{min:this.safeNumber(t,"minimum_price_offer"),max:void 0},cost:{min:void 0,max:void 0}}})}return i}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetBalances(e),s=this.safeValue(t,"balances",[]),i={info:t};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"currency"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(t,"trading_balance"),n.total=this.safeString(t,"balance"),i[a]=n}return this.parseBalance(i,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={id:this.marketId(e)},r=await this.publicGetFundsIdOrderbook(this.extend(i,s)),a=this.parse8601(this.safeString(r,"date"));return this.parseOrderBook(r,e,a,"bids","asks","price","amount")}parseTicker(e,t){const s=this.parse8601(e.date);let i;void 0!==t&&(i=t.symbol);const r=this.safeNumber(e,"last");return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"bid"),bidVolume:void 0,ask:this.safeNumber(e,"ask"),askVolume:void 0,vwap:void 0,open:this.safeNumber(e,"open"),close:r,last:r,previousClose:this.safeNumber(e,"close"),change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(e,"volume_traded"),quoteVolume:this.safeNumber(e,"volume"),info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetFundsTickers(t),i=this.indexBy(s.tickers,"fund_id"),r=Object.keys(i),a={};for(let e=0;e<r.length;e++){const t=r[e],s=this.safeMarket(t),n=s.symbol,o=i[t];a[n]=this.parseTicker(o,s)}return this.filterByArray(a,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i=await this.publicGetFundsIdTicker(this.extend({id:s.id},t));return this.parseTicker(i,s)}parseTrade(e,t){const s=this.safeString(e,"fund_id"),i=this.safeSymbol(s,t),r=this.parse8601(this.safeString(e,"date")),a=this.safeString(e,"id"),n=this.safeString(e,"order_id"),o=this.safeString(e,"side"),c=this.safeString(e,"price"),h=this.safeString(e,"amount"),u=this.parseNumber(c),l=this.parseNumber(h),f=this.parseNumber(d.stringMul(c,h));let p,m;const b=this.safeValue(e,"transactions",[]),g=this.groupBy(b,"type"),y=this.safeValue(g,"paid_commission",[]);for(let e=0;e<y.length;e++)void 0===m&&(m=0),m=this.sum(m,this.safeNumber(y[e],"price"));return void 0!==m&&(p={cost:m,currency:t.quote}),{info:e,id:a,order:n,timestamp:r,datetime:this.iso8601(r),symbol:i,type:void 0,side:o,takerOrMaker:void 0,price:u,amount:l,cost:f,fee:p}}parseLedgerEntryDirection(e){return this.safeString({affiliate_earnings:"in",atm_payment:"in",bought_currency_from_fund:"out",bought_shares:"out",paid_commission:"out",paypal_payment:"in",pos_payment:"in",released_currency_to_fund:"out",rollover_commission:"out",sold_currency_to_fund:"in",sold_shares:"in",transfer_received:"in",transfer_sent:"out",withdraw:"out"},e,e)}parseLedgerEntryType(e){return this.safeString({affiliate_earnings:"referral",atm_payment:"transaction",bought_currency_from_fund:"trade",bought_shares:"trade",paid_commission:"fee",paypal_payment:"transaction",pos_payment:"transaction",released_currency_to_fund:"trade",rollover_commission:"fee",sold_currency_to_fund:"trade",sold_shares:"trade",transfer_received:"transfer",transfer_sent:"transfer",withdraw:"transaction"},e,e)}parseLedgerEntry(e,t){const s=this.safeString(e,"id");let i,r=this.safeString(e,"type");const a=this.parseLedgerEntryDirection(r);r=this.parseLedgerEntryType(r),"trade"!==r&&"fee"!==r||(i=this.safeString(e,"trade_id"));const n=this.safeString(e,"currency"),o=this.safeCurrencyCode(n),c=this.safeNumber(e,"price"),d=this.parse8601(this.safeString(e,"date"));return{info:e,id:s,direction:a,account:void 0,referenceId:i,referenceAccount:void 0,type:r,currency:o,amount:c,before:void 0,after:void 0,status:"ok",timestamp:d,datetime:this.iso8601(d),fee:void 0}}async fetchLedger(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.currency=a.id),void 0!==t&&(r.after=this.iso8601(t));const n=await this.privateGetTransactions(this.extend(r,i)),o=this.safeValue(n,"transactions",[]);return this.parseLedger(o,a,t,s)}parseTransactionType(e){return this.safeString({withdraw:"withdrawal",atm_payment:"deposit"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"id"),i=this.parseTransactionType(this.safeString(e,"type")),r=this.safeValue(e,"transfer_detail",{}),a=this.safeString(r,"method");let n,o;void 0!==a&&"wire_transfer"!==a&&(n=this.safeString(r,"id"),o=this.safeString(r,"recipient"));const c=this.safeString(e,"currency"),d=this.safeCurrencyCode(c),h=this.safeNumber(e,"price"),u=this.parse8601(this.safeString(e,"date"));return{info:e,id:s,currency:d,amount:h,addressFrom:void 0,addressTo:o,address:o,tagFrom:void 0,tagTo:void 0,tag:void 0,status:"ok",type:i,updated:void 0,txid:n,timestamp:u,datetime:this.iso8601(u),fee:void 0}}async fetchWithdrawals(e,t,s,i={}){return await this.fetchTransactions(e,t,s,this.extend({type:"withdraw"},i))}async fetchDeposits(e,t,s,i={}){return await this.fetchTransactions(e,t,s,this.extend({type:"atm_payment"},i))}async fetchTransactions(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.currency=a.id),void 0!==t&&(r.after=this.iso8601(t)),i=this.extend(r,i);const n=await this.privateGetTransactions(i),o=this.safeValue(n,"transactions",[]),c=this.filterByArray(o,"type",["withdraw","atm_payment"],!1);return this.parseTransactions(c,a,t,s)}parseOrderStatus(e){return this.safeString({active:"open",executed:"closed",deleted:"canceled"},e,e)}parseOrder(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"fund_id"),r=this.safeSymbol(i,t),a=this.parseOrderStatus(this.safeString(e,"status")),n=this.parse8601(this.safeString(e,"date")),o=this.safeString(e,"type"),c=this.safeString(e,"side"),d=this.safeNumber(e,"amount"),h=this.safeNumber(e,"amount_unfilled");let u;void 0!==d&&void 0!==h&&(u=d-h);const l=this.safeNumber(e,"price");let f,p,m,b=this.safeValue(e,"trades");if(void 0!==b){const e=b.length;if(e>0){b=this.parseTrades(b,t,void 0,void 0,{orderId:s}),f=0,u=0;for(let t=0;t<e;t++){const e=b[t];f=this.sum(f,e.cost),u=this.sum(u,e.amount)}u>0&&(p=f/u),m=b[e-1].timestamp}else f=0}const g=this.safeNumber(e,"conditional_price");return{id:s,clientOrderId:void 0,info:e,timestamp:n,datetime:this.iso8601(n),lastTradeTimestamp:m,status:a,symbol:r,type:o,timeInForce:void 0,postOnly:void 0,side:c,price:l,stopPrice:g,cost:f,amount:d,filled:u,average:p,remaining:h,fee:void 0,trades:b}}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({status:"active"},i))}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrders(e,t,s,this.extend({status:"executed"},i))}async fetchOrders(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),n={fund_id:r.id};void 0!==t&&(n.after=this.iso8601(t));const o=await this.privateGetFundsFundIdOrders(this.extend(n,i)),c=this.safeValue(o,"orders",[]);return this.parseOrders(c,r,t,s)}async fetchOrder(e,t,s={}){if(void 0===t)throw new a(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const i={id:e,fund_id:this.market(t).id},r=await this.privatePostFundsFundIdOrdersId(this.extend(i,s));return this.parseOrder(r)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets(),"market"===t&&(r=0);const n={fund_id:this.marketId(e),side:s,amount:i,price:r},o=await this.privatePostFundsFundIdOrders(this.extend(n,a));return this.parseOrder(o)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={id:e,fund_id:this.marketId(t)},r=await this.privateDeleteFundsFundIdOrdersId(this.extend(i,s));return this.parseOrder(r)}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const r=this.market(e),n={id:r.id};void 0!==s&&(n.per_page=s),void 0!==t&&(n.after=this.iso8601(t));const o=await this.privateGetFundsIdTrades(this.extend(n,i));return this.parseTrades(o.trades,r,t,s)}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={id:r.id};void 0!==s&&(a.per_page=s),void 0!==t&&(a.after=this.iso8601(t));const n=await this.publicGetFundsIdTrades(this.extend(a,i));return this.parseTrades(n.trades,r,t,s)}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api+"/"+this.version+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if(r=void 0===r?{}:r,"private"===t){if(this.checkRequiredCredentials(),Object.keys(o).length)if("POST"===s)a=this.json(o),r["Content-Type"]="application/json";else{const e=this.rawencode(o);e.length&&(n+="?"+e)}const e=this.nonce().toString(),t=e+n;r["X-TRT-KEY"]=this.apiKey,r["X-TRT-NONCE"]=e,r["X-TRT-SIGN"]=this.hmac(this.encode(t),this.encode(this.secret),"sha512")}else"public"===t&&Object.keys(o).length&&(n+="?"+this.rawencode(o));return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0===o)return;const h=this.safeValue(o,"errors",[]),u=h.length;if(u>0){const e=this.id+" "+n;for(let t=0;t<u;t++){const s=h[t],i=this.safeString(s,"message");this.throwExactlyMatchedException(this.exceptions.exact,i,e),this.throwBroadlyMatchedException(this.exceptions.broad,i,e)}throw new r(e)}}}},1783:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,InsufficientFunds:a,OrderNotFound:n,ArgumentsRequired:o}=s(3449),c=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"tidebit",name:"TideBit",countries:["HK"],rateLimit:1e3,version:"v2",has:{cancelOrder:!0,CORS:!1,createOrder:!0,fetchBalance:!0,fetchDepositAddress:!0,fetchMarkets:!0,fetchOHLCV:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,withdraw:!0},timeframes:{"1m":"1","5m":"5","15m":"15","30m":"30","1h":"60","2h":"120","4h":"240","12h":"720","1d":"1440","3d":"4320","1w":"10080"},urls:{logo:"https://user-images.githubusercontent.com/51840849/87460811-1e690280-c616-11ea-8652-69f187305add.jpg",api:"https://www.tidebit.com",www:"https://www.tidebit.com",doc:["https://www.tidebit.com/documents/api/guide","https://www.tidebit.com/swagger/#/default"],referral:"http://bit.ly/2IX0LrM"},api:{public:{get:["markets","tickers","tickers/{market}","timestamp","trades","trades/{market}","order_book","order","k_with_pending_trades","k","depth"],post:[]},private:{get:["addresses/{address}","deposits/history","deposits/get_deposit","deposits/deposit_address","historys/orders","historys/vouchers","historys/accounts","historys/snapshots","linkage/get_status","members/me","order","orders","partners/orders/{id}/trades","referral_commissions/get_undeposited","referral_commissions/get_graph_data","trades/my","withdraws/bind_account_list","withdraws/get_withdraw_account","withdraws/fetch_bind_info"],post:["deposits/deposit_cash","favorite_markets/update","order/delete","orders","orders/multi","orders/clear","referral_commissions/deposit","withdraws/apply","withdraws/bind_bank","withdraws/bind_address"]}},fees:{trading:{tierBased:!1,percentage:!0,maker:.003,taker:.003},funding:{tierBased:!1,percentage:!0,withdraw:{}}},exceptions:{2002:a,2003:n}})}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={currency:this.currency(e).id},i=await this.privateGetDepositAddress(this.extend(s,t));if("success"in i&&i.success){const t=this.safeString(i,"address"),s=this.safeString(i,"addressTag");return{currency:e,address:this.checkAddress(t),tag:s,info:i}}}async fetchMarkets(e={}){const t=await this.publicGetMarkets(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"id"),a=this.safeString(i,"name"),[n,o]=a.split("/"),c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o);s.push({id:r,symbol:a,base:c,quote:d,baseId:n,quoteId:o,info:i,active:void 0,precision:this.precision,limits:this.limits})}return s}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetMembersMe(e),s=this.safeValue(t,"accounts"),i={info:s};for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"currency"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(t,"balance"),n.used=this.safeString(t,"locked"),i[a]=n}return this.parseBalance(i,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),r={market:i.id};void 0!==t&&(r.limit=t),r.market=i.id;const a=await this.publicGetDepth(this.extend(r,s)),n=this.safeTimestamp(a,"timestamp");return this.parseOrderBook(a,e,n)}parseTicker(e,t){const s=this.safeTimestamp(e,"at");let i;e=this.safeValue(e,"ticker",{}),void 0!==t&&(i=t.symbol);const r=this.safeNumber(e,"last");return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"buy"),ask:this.safeNumber(e,"sell"),bidVolume:void 0,askVolume:void 0,vwap:void 0,open:void 0,close:r,last:r,change:void 0,percentage:void 0,previousClose:void 0,average:void 0,baseVolume:this.safeNumber(e,"vol"),quoteVolume:void 0,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTickers(t),i=Object.keys(s),r={};for(let e=0;e<i.length;e++){const t=i[e],a=this.safeMarket(t),n=a.symbol,o=s[t];r[n]=this.parseTicker(o,a)}return this.filterByArray(r,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={market:s.id},r=await this.publicGetTickersMarket(this.extend(i,t));return this.parseTicker(r,s)}parseTrade(e,t){const s=this.parse8601(this.safeString(e,"created_at")),i=this.safeString(e,"id"),r=this.safeString(e,"price"),a=this.safeString(e,"volume"),n=this.parseNumber(r),o=this.parseNumber(a);let d,h=this.safeNumber(e,"funds");return void 0===h&&(h=this.parseNumber(c.stringMul(r,a))),void 0!==t&&(d=t.symbol),{id:i,info:e,timestamp:s,datetime:this.iso8601(s),symbol:d,type:void 0,side:void 0,order:void 0,takerOrMaker:void 0,price:n,amount:o,cost:h,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={market:r.id},n=await this.publicGetTrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}parseOHLCV(e,t){return[this.safeTimestamp(e,0),this.safeNumber(e,1),this.safeNumber(e,2),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,5)]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e);void 0===i&&(i=30);const n={market:a.id,period:this.timeframes[t],limit:i};n.timestamp=void 0!==s?parseInt(s/1e3):18e5;const o=await this.publicGetK(this.extend(n,r));return"null"===o?[]:this.parseOHLCVs(o,a,t,s,i)}parseOrderStatus(e){return this.safeString({done:"closed",wait:"open",cancel:"canceled"},e,e)}parseOrder(e,t){const s=this.safeString(e,"market"),i=this.safeSymbol(s,t),r=this.parse8601(this.safeString(e,"created_at")),a=this.parseOrderStatus(this.safeString(e,"state")),n=this.safeString(e,"id"),o=this.safeString(e,"ord_type"),c=this.safeString(e,"side"),d=this.safeNumber(e,"price"),h=this.safeNumber(e,"volume"),u=this.safeNumber(e,"executed_volume"),l=this.safeNumber(e,"remaining_volume"),f=this.safeNumber(e,"avg_price");return this.safeOrder({id:n,clientOrderId:void 0,timestamp:r,datetime:this.iso8601(r),lastTradeTimestamp:void 0,status:a,symbol:i,type:o,timeInForce:void 0,postOnly:void 0,side:c,price:d,stopPrice:void 0,amount:h,filled:u,remaining:l,cost:void 0,trades:void 0,fee:void 0,info:e,average:f})}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n={market:this.marketId(e),side:s,volume:i.toString(),ord_type:t};"limit"===t&&(n.price=r.toString());const o=await this.privatePostOrders(this.extend(n,a));return this.parseOrder(o)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={id:e},r=await this.privatePostOrderDelete(this.extend(i,s)),a=this.parseOrder(r),o=this.safeString(a,"status");if("closed"===o||"canceled"===o)throw new n(this.id+" "+this.json(a));return a}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a=this.currency(e),n=this.safeString(r,"id");if(void 0===n)throw new o(this.id+" withdraw() requires an extra `id` param (withdraw account id according to withdraws/bind_account_list endpoint");const c={id:n,currency_type:"coin",currency:a.id,body:t};void 0!==i&&(c.memo=i);return{info:await this.privatePostWithdrawsApply(this.extend(c,r)),id:void 0}}nonce(){return this.milliseconds()}encodeParams(e){return this.urlencode(this.keysort(e))}sign(e,t="public",s="GET",i={},r,a){const n="/api/"+this.version+"/"+this.implodeParams(e,i)+".json",o=this.omit(i,this.extractParams(e));let c=this.urls.api+n;if("public"===t)Object.keys(o).length&&(c+="?"+this.urlencode(o));else{this.checkRequiredCredentials();const e=this.nonce().toString(),t=this.keysort(this.extend({access_key:this.apiKey,tonce:e},i)),o=this.urlencode(t),d=s+"|"+n+"|"+o,h=o+"&signature="+this.hmac(this.encode(d),this.encode(this.secret));"GET"===s?c+="?"+h:(a=h,r={"Content-Type":"application/x-www-form-urlencoded"})}return{url:c,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(400===e||void 0===o){const e=this.id+" "+n;if(void 0===o)throw new r(e);const t=this.safeValue(o,"error",{}),s=this.safeString(t,"code");this.throwExactlyMatchedException(this.exceptions,s,e)}}}},6974:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,ExchangeNotAvailable:n,InsufficientFunds:o,OrderNotFound:c,DDoSProtection:d,InvalidOrder:h,AuthenticationError:u}=s(3449),l=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"tidex",name:"Tidex",countries:["UK"],rateLimit:2e3,version:"3",userAgent:this.userAgents.chrome,has:{cancelOrder:!0,CORS:!1,createMarketOrder:!1,createOrder:!0,fetchBalance:!0,fetchCurrencies:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrderBooks:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,withdraw:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/30781780-03149dc4-a12e-11e7-82bb-313b269d24d4.jpg",api:{web:"https://gate.tidex.com/api",public:"https://api.tidex.com/api/3",private:"https://api.tidex.com/tapi"},www:"https://tidex.com",doc:"https://tidex.com/exchange/public-api",referral:"https://tidex.com/exchange/?ref=57f5638d9cd7",fees:["https://tidex.com/exchange/assets-spec","https://tidex.com/exchange/pairs-spec"]},api:{web:{get:["currency","pairs","tickers","orders","ordershistory","trade-data","trade-data/{id}"]},public:{get:["info","ticker/{pair}","depth/{pair}","trades/{pair}"]},private:{post:["getInfoExt","getInfo","Trade","ActiveOrders","OrderInfo","CancelOrder","TradeHistory","CoinDepositAddress","WithdrawCoin","CreateCoupon","RedeemCoupon"]}},fees:{trading:{feeSide:"get",tierBased:!1,percentage:!0,taker:.001,maker:.001}},commonCurrencies:{DSH:"DASH",EMGO:"MGO",MGO:"WMGO"},exceptions:{exact:{803:h,804:h,805:h,806:h,807:h,831:o,832:o,833:c},broad:{"Invalid pair name":r,"invalid api key":u,"invalid sign":u,"api key dont have trade permission":u,"invalid parameter":h,"invalid order":h,"Requests too often":d,"not available":n,"data unavailable":n,"external service unavailable":n}},options:{fetchTickersMaxLength:2048},orders:{}})}async fetchCurrencies(e={}){const t=await this.webGetCurrency(e),s={};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"symbol"),a=this.safeInteger(i,"amountPoint"),n=this.safeCurrencyCode(r);let o=!0===this.safeValue(i,"visible");const c=!0===this.safeValue(i,"withdrawEnable"),d=!0===this.safeValue(i,"depositEnable");c&&d||(o=!1);const h=this.safeString(i,"name"),u=this.safeNumber(i,"withdrawFee");s[n]={id:r,code:n,name:h,active:o,precision:a,funding:{withdraw:{active:c,fee:u},deposit:{active:d,fee:this.parseNumber("0")}},limits:{amount:{min:void 0,max:void 0},withdraw:{min:this.safeNumber(i,"withdrawMinAmount"),max:void 0},deposit:{min:this.safeNumber(i,"depositMinAmount"),max:void 0}},info:i}}return s}async fetchMarkets(e={}){const t=(await this.publicGetInfo(e)).pairs,s=Object.keys(t),i=[];for(let e=0;e<s.length;e++){const r=s[e],a=t[r],[n,o]=r.split("_"),c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o),h=c+"/"+d,u={amount:this.safeInteger(a,"decimal_places"),price:this.safeInteger(a,"decimal_places")},f={amount:{min:this.safeNumber(a,"min_amount"),max:this.safeNumber(a,"max_amount")},price:{min:this.safeNumber(a,"min_price"),max:this.safeNumber(a,"max_price")},cost:{min:this.safeNumber(a,"min_total")}},p=0===this.safeInteger(a,"hidden");let m=this.safeString(a,"fee");m=l.stringDiv(m,"100");const b=this.parseNumber(m);i.push({id:r,symbol:h,base:c,quote:d,baseId:n,quoteId:o,active:p,taker:b,precision:u,limits:f,info:a})}return i}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostGetInfoExt(e),s=this.safeValue(t,"return"),i=this.safeTimestamp(s,"server_time"),r={info:t,timestamp:i,datetime:this.iso8601(i)},a=this.safeValue(s,"funds",{}),n=Object.keys(a);for(let e=0;e<n.length;e++){const t=n[e],s=this.safeCurrencyCode(t),i=this.safeValue(a,t,{}),o=this.account();o.free=this.safeString(i,"value"),o.used=this.safeString(i,"inOrders"),r[s]=o}return this.parseBalance(r,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),a={pair:i.id};void 0!==t&&(a.limit=t);const n=await this.publicGetDepthPair(this.extend(a,s));if(!(i.id in n))throw new r(this.id+" "+i.symbol+" order book is empty or not available");const o=n[i.id];return this.parseOrderBook(o,e)}async fetchOrderBooks(e,t,s={}){let i;if(await this.loadMarkets(),void 0===e){if(i=this.ids.join("-"),i.length>2048){const e=this.ids.length;throw new r(this.id+" has "+e.toString()+" symbols exceeding max URL length, you are required to specify a list of symbols in the first argument to fetchOrderBooks")}}else i=this.marketIds(e),i=i.join("-");const a={pair:i};void 0!==t&&(a.limit=t);const n=await this.publicGetDepthPair(this.extend(a,s)),o={};i=Object.keys(n);for(let e=0;e<i.length;e++){const t=i[e];o[this.safeSymbol(t)]=this.parseOrderBook(n[t])}return o}parseTicker(e,t){let s,i=this.safeTimestamp(e,"updated");void 0!==t&&(s=t.symbol,t.active||(i=void 0));const r=this.safeNumber(e,"last");return{symbol:s,timestamp:i,datetime:this.iso8601(i),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"buy"),bidVolume:void 0,ask:this.safeNumber(e,"sell"),askVolume:void 0,vwap:void 0,open:void 0,close:r,last:r,previousClose:void 0,change:void 0,percentage:void 0,average:this.safeNumber(e,"avg"),baseVolume:this.safeNumber(e,"vol_cur"),quoteVolume:this.safeNumber(e,"vol"),info:e}}async fetchTickers(e,t={}){await this.loadMarkets();let s=this.ids;if(void 0===e){const e=s.length;if(s=s.join("-"),s.length>this.options.fetchTickersMaxLength){const t=this.safeInteger(this.options,"fetchTickersMaxLength",2048);throw new a(this.id+" has "+e.toString()+" markets exceeding max URL length for this endpoint ("+t.toString()+" characters), please, specify a list of symbols of interest in the first argument to fetchTickers")}}else s=this.marketIds(e),s=s.join("-");const i={pair:s},r=await this.publicGetTickerPair(this.extend(i,t)),n={},o=Object.keys(r);for(let e=0;e<o.length;e++){const t=o[e],s=this.safeMarket(t);n[s.symbol]=this.parseTicker(r[t],s)}return this.filterByArray(n,"symbol",e)}async fetchTicker(e,t={}){return(await this.fetchTickers([e],t))[e]}parseTrade(e,t){const s=this.safeTimestamp(e,"timestamp");let i=this.safeString(e,"type");"ask"===i?i="sell":"bid"===i&&(i="buy");const r=this.safeString2(e,"rate","price"),a=this.safeString2(e,"trade_id","tid"),n=this.safeString(e,"order_id"),o=this.safeString(e,"pair"),c=this.safeSymbol(o,t),d=this.safeString(e,"amount"),h=this.parseNumber(r),u=this.parseNumber(d),f=this.parseNumber(l.stringMul(r,d)),p="limit";let m,b;const g=this.safeNumber(e,"commission");if(void 0!==g){const t=this.safeString(e,"commissionCurrency");b={cost:g,currency:this.safeCurrencyCode(t)}}const y=this.safeValue(e,"is_your_order");return void 0!==y&&(m="taker",y&&(m="maker"),void 0===b&&(b=this.calculateFee(c,p,i,u,h,m))),{id:a,order:n,timestamp:s,datetime:this.iso8601(s),symbol:c,type:p,side:i,takerOrMaker:m,price:h,amount:u,cost:f,fee:b,info:e}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={pair:r.id};void 0!==s&&(a.limit=s);const n=await this.publicGetTradesPair(this.extend(a,i));if(Array.isArray(n)){if(0===n.length)return[]}return this.parseTrades(n[r.id],r,t,s)}async createOrder(e,t,s,i,a,n={}){if("market"===t)throw new r(this.id+" allows limit orders only");await this.loadMarkets();const o={pair:this.market(e).id,type:s,amount:this.amountToPrecision(e,i),rate:this.priceToPrecision(e,a)};a=parseFloat(a),i=parseFloat(i);const c=await this.privatePostTrade(this.extend(o,n));let d,h="open",u=0,l=i;const f=this.safeValue(c,"return");void 0!==f&&(d=this.safeString(f,"order_id"),"0"===d&&(d=this.safeString(f,"init_order_id"),h="closed"),u=this.safeNumber(f,"received",u),l=this.safeNumber(f,"remains",i));const p=this.milliseconds();return this.safeOrder({id:d,timestamp:p,datetime:this.iso8601(p),lastTradeTimestamp:void 0,status:h,symbol:e,type:t,side:s,price:a,cost:void 0,amount:i,remaining:l,filled:u,fee:void 0,info:c,clientOrderId:void 0,average:void 0,trades:void 0})}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={order_id:parseInt(e)};return await this.privatePostCancelOrder(this.extend(i,s))}parseOrderStatus(e){return this.safeString({0:"open",1:"closed",2:"canceled",3:"canceled"},e,e)}parseOrder(e,t){const s=this.safeString(e,"id"),i=this.parseOrderStatus(this.safeString(e,"status")),r=this.safeTimestamp(e,"timestamp_created"),a=this.safeString(e,"pair"),n=this.safeSymbol(a,t);let o,c;const d=this.safeNumber(e,"rate");"start_amount"in e?(c=this.safeNumber(e,"start_amount"),o=this.safeNumber(e,"amount")):o=this.safeNumber(e,"amount");return this.safeOrder({info:e,id:s,clientOrderId:void 0,symbol:n,timestamp:r,datetime:this.iso8601(r),lastTradeTimestamp:void 0,type:"limit",timeInForce:void 0,postOnly:void 0,side:this.safeString(e,"type"),price:d,stopPrice:void 0,cost:void 0,amount:c,remaining:o,filled:void 0,status:i,fee:undefined,average:void 0,trades:void 0})}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={order_id:parseInt(e)},r=await this.privatePostOrderInfo(this.extend(i,s));e=e.toString();const a=this.safeValue(r,"return",{}),n=this.safeValue(a,e);return this.parseOrder(this.extend({id:e},n))}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.market(e),r.pair=a.id);const n=await this.privatePostActiveOrders(this.extend(r,i)),o=this.safeValue(n,"return",[]);return this.parseOrders(o,a,t,s)}async fetchMyTrades(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.market(e),a.pair=r.id),void 0!==s&&(a.count=parseInt(s)),void 0!==t&&(a.since=parseInt(t/1e3));const n=await this.privatePostTradeHistory(this.extend(a,i)),o=this.safeValue(n,"return",[]);return this.parseTrades(o,r,t,s)}async withdraw(e,t,s,i,a={}){this.checkAddress(s),await this.loadMarkets();const n={coinName:this.currency(e).id,amount:parseFloat(t),address:s};if(void 0!==i)throw new r(this.id+" withdraw() does not support the tag argument yet due to a lack of docs on withdrawing with tag/memo on behalf of the exchange.");const o=await this.privatePostWithdrawCoin(this.extend(n,a));return{info:o,id:o.return.tId}}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t];const o=this.omit(i,this.extractParams(e));if("private"===t){this.checkRequiredCredentials();const t=this.nonce();a=this.urlencode(this.extend({nonce:t,method:e},o));const s=this.hmac(this.encode(a),this.encode(this.secret),"sha512");r={"Content-Type":"application/x-www-form-urlencoded",Key:this.apiKey,Sign:s}}else"public"===t?(n+="/"+this.implodeParams(e,i),Object.keys(o).length&&(n+="?"+this.urlencode(o))):(n+="/"+this.implodeParams(e,i),"GET"===s?Object.keys(o).length&&(n+="?"+this.urlencode(o)):Object.keys(o).length&&(a=this.json(o),r={"Content-Type":"application/json"}));return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0!==o&&"success"in o){let e=this.safeValue(o,"success",!1);if("string"==typeof e&&(e="true"===e||"1"===e),!e){const e=this.safeString(o,"code"),t=this.safeString(o,"error"),s=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,e,s),this.throwExactlyMatchedException(this.exceptions.exact,t,s),this.throwBroadlyMatchedException(this.exceptions.broad,t,s),new r(s)}}}}},1378:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,PermissionDenied:a,ExchangeNotAvailable:n,InsufficientFunds:o,OrderNotFound:c,InvalidOrder:d,RateLimitExceeded:h,NotSupported:u,BadRequest:l,AuthenticationError:f}=s(3449),p=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"timex",name:"TimeX",countries:["AU"],version:"v1",rateLimit:1500,has:{cancelOrder:!0,cancelOrders:!0,CORS:!1,createOrder:!0,editOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTradingFee:!0},timeframes:{"1m":"I1","5m":"I5","15m":"I15","30m":"I30","1h":"H1","2h":"H2","4h":"H4","6h":"H6","12h":"H12","1d":"D1","1w":"W1"},urls:{logo:"https://user-images.githubusercontent.com/1294454/70423869-6839ab00-1a7f-11ea-8f94-13ae72c31115.jpg",api:"https://plasma-relay-backend.timex.io",www:"https://timex.io",doc:"https://docs.timex.io",referral:"https://timex.io/?refcode=1x27vNkTbP1uwkCck"},api:{custody:{get:["credentials","credentials/h/{hash}","credentials/k/{key}","credentials/me/address","deposit-addresses","deposit-addresses/h/{hash}"]},history:{get:["orders","orders/details","orders/export/csv","trades","trades/export/csv"]},currencies:{get:["a/{address}","i/{id}","s/{symbol}"],post:["perform","prepare","remove/perform","s/{symbol}/remove/prepare","s/{symbol}/update/perform","s/{symbol}/update/prepare"]},markets:{get:["i/{id}","s/{symbol}"],post:["perform","prepare","remove/perform","s/{symbol}/remove/prepare","s/{symbol}/update/perform","s/{symbol}/update/prepare"]},public:{get:["candles","currencies","markets","orderbook","orderbook/raw","orderbook/v2","tickers","trades"]},statistics:{get:["address"]},trading:{get:["balances","fees","orders"],post:["orders","orders/json"],put:["orders","orders/json"],delete:["orders","orders/json"]},tradingview:{get:["config","history","symbol_info","time"]}},exceptions:{exact:{0:r,1:u,4e3:l,4001:l,4002:o,4003:f,4004:f,4005:l,4006:l,4007:l,4300:a,4100:f,4400:c,5001:d,5002:r,400:l,401:f,403:a,404:c,429:h,500:r,503:n},broad:{Insufficient:o}},options:{fetchTickers:{period:"1d"},fetchTrades:{sort:"timestamp,asc"},fetchMyTrades:{sort:"timestamp,asc"},fetchOpenOrders:{sort:"createdAt,asc"},fetchClosedOrders:{sort:"createdAt,asc"},defaultSort:"timestamp,asc",defaultSortOrders:"createdAt,asc"}})}async fetchMarkets(e={}){const t=await this.publicGetMarkets(e),s=[];for(let e=0;e<t.length;e++)s.push(this.parseMarket(t[e]));return s}async fetchCurrencies(e={}){const t=await this.publicGetCurrencies(e),s=[];for(let e=0;e<t.length;e++){const i=t[e];s.push(this.parseCurrency(i))}return this.indexBy(s,"code")}async fetchTickers(e,t={}){await this.loadMarkets();const s=this.safeString(this.options.fetchTickers,"period","1d"),i={period:this.timeframes[s]},r=await this.publicGetTickers(this.extend(i,t));return this.parseTickers(r,e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i=this.safeString(this.options.fetchTickers,"period","1d"),r={market:s.id,period:this.timeframes[i]},a=await this.publicGetTickers(this.extend(r,t)),n=this.safeValue(a,0);return this.parseTicker(n,s)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={market:this.market(e).id};void 0!==t&&(i.limit=t);const r=await this.publicGetOrderbookV2(this.extend(i,s)),a=this.parse8601(this.safeString(r,"timestamp"));return this.parseOrderBook(r,e,a,"bid","ask","price","baseTokenAmount")}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a=this.safeValue(this.options,"fetchTrades",{}),n=this.safeValue(a,"sort","timestamp,asc"),o=this.safeString(i,"sort",n),c=this.omit(i,"sort"),d={market:r.id,sort:o};void 0!==t&&(d.from=this.iso8601(t)),void 0!==s&&(d.size=s);const h=await this.publicGetTrades(this.extend(d,c));return this.parseTrades(h,r,t,s)}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={market:a.id,period:this.timeframes[t]},o=this.parseTimeframe(t);if(void 0!==s)n.from=this.iso8601(s),void 0!==i&&(n.till=this.iso8601(this.sum(s,this.sum(i,1)*o*1e3)));else if(void 0!==i){const e=this.milliseconds();n.till=this.iso8601(e),n.from=this.iso8601(e-i*o*1e3-1)}else n.till=this.iso8601(this.milliseconds());const c=await this.publicGetCandles(this.extend(n,r));return this.parseOHLCVs(c,a,t,s,i)}async fetchBalance(e={}){await this.loadMarkets();const t=await this.tradingGetBalances(e),s={info:t,timestamp:void 0,datetime:void 0};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"currency"),a=this.safeCurrencyCode(r),n=this.account();n.total=this.safeString(i,"totalBalance"),n.used=this.safeString(i,"lockedBalance"),s[a]=n}return this.parseBalance(s,!1)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const n=this.market(e),o=s.toUpperCase(),c=t.toUpperCase(),h={symbol:n.id,quantity:this.amountToPrecision(e,i),side:o,orderTypes:c};let u=a;if("LIMIT"===c){h.price=this.priceToPrecision(e,r);const s=this.safeInteger(this.options,"expireIn"),i=this.safeValue(a,"expireTime"),n=this.safeValue(a,"expireIn",s);if(void 0!==i)h.expireTime=i;else{if(void 0===n)throw new d(this.id+" createOrder() method requires a expireTime or expireIn param for a "+t+" order, you can also set the expireIn exchange-wide option");h.expireIn=n}u=this.omit(a,["expireTime","expireIn"])}else h.price=0;const l=await this.tradingPostOrders(this.extend(h,u)),f=this.safeValue(l,"orders",[]),p=this.safeValue(f,0,{});return this.parseOrder(p,n)}async editOrder(e,t,s,i,r,a,n={}){await this.loadMarkets();const o=this.market(t),c={id:e};void 0!==r&&(c.quantity=this.amountToPrecision(t,r)),void 0!==a&&(c.price=this.priceToPrecision(t,a));const d=await this.tradingPutOrders(this.extend(c,n));if("unchangedOrders"in d){const e=this.safeValue(d,"unchangedOrders",[]);return{id:this.safeString(e,0),info:d}}const h=this.safeValue(d,"changedOrders",[]),u=this.safeValue(h,0,{}),l=this.safeValue(u,"newOrder",{});return this.parseOrder(l,o)}async cancelOrder(e,t,s={}){return await this.loadMarkets(),await this.cancelOrders([e],t,s)}async cancelOrders(e,t,s={}){await this.loadMarkets();const i={id:e};return await this.tradingDeleteOrders(this.extend(i,s))}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={orderHash:e},r=await this.historyGetOrdersDetails(i),a=this.safeValue(r,"order",{}),n=this.safeValue(r,"trades",[]);return this.parseOrder(this.extend(a,{trades:n}))}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets();const r=this.safeValue(this.options,"fetchOpenOrders",{}),a=this.safeValue(r,"sort","createdAt,asc"),n=this.safeString(i,"sort",a),o=this.omit(i,"sort"),c={sort:n};let d;void 0!==e&&(d=this.market(e),c.symbol=d.id),void 0!==s&&(c.size=s);const h=await this.tradingGetOrders(this.extend(c,o)),u=this.safeValue(h,"orders",[]);return this.parseOrders(u,d,t,s)}async fetchClosedOrders(e,t,s,i={}){await this.loadMarkets();const r=this.safeValue(this.options,"fetchClosedOrders",{}),a=this.safeValue(r,"sort","createdAt,asc"),n=this.safeString(i,"sort",a),o=this.omit(i,"sort"),c={sort:n,side:"BUY"};let d;void 0!==e&&(d=this.market(e),c.symbol=d.id),void 0!==t&&(c.from=this.iso8601(t)),void 0!==s&&(c.size=s);const h=await this.historyGetOrders(this.extend(c,o)),u=this.safeValue(h,"orders",[]);return this.parseOrders(u,d,t,s)}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r=this.safeValue(this.options,"fetchMyTrades",{}),a=this.safeValue(r,"sort","timestamp,asc"),n=this.safeString(i,"sort",a),o=this.omit(i,"sort"),c={sort:n};let d;void 0!==e&&(d=this.market(e),c.symbol=d.id),void 0!==t&&(c.from=this.iso8601(t)),void 0!==s&&(c.size=s);const h=await this.historyGetTrades(this.extend(c,o)),u=this.safeValue(h,"trades",[]);return this.parseTrades(u,d,t,s)}async fetchTradingFee(e,t={}){await this.loadMarkets();const s={markets:this.market(e).id},i=await this.tradingGetFees(this.extend(s,t)),r=this.safeValue(i,0,{});return{info:i,maker:this.safeNumber(r,"fee"),taker:void 0}}parseMarket(e){const t=!this.safeValue(e,"locked"),s=this.safeString(e,"symbol"),i=this.safeString(e,"baseCurrency"),r=this.safeString(e,"quoteCurrency"),a=this.safeCurrencyCode(i),n=this.safeCurrencyCode(r),o=a+"/"+n,c={amount:this.precisionFromString(this.safeString(e,"quantityIncrement")),price:this.precisionFromString(this.safeString(e,"tickSize"))},d=this.safeNumber(e,"quantityIncrement"),h=this.safeNumber(e,"baseMinSize"),u=Math.max(d,h),l=this.safeNumber(e,"tickSize"),f=this.safeNumber(e,"quoteMinSize");return{id:s,symbol:o,base:a,quote:n,baseId:i,quoteId:r,type:"spot",active:t,precision:c,limits:{amount:{min:u,max:void 0},price:{min:l,max:void 0},cost:{min:Math.max(f,u*l),max:void 0}},taker:this.safeNumber(e,"takerFee"),maker:this.safeNumber(e,"makerFee"),info:e}}parseCurrency(e){const t=this.safeString(e,"symbol"),s=this.safeCurrencyCode(t),i=this.safeString(e,"name"),r=this.safeInteger(e,"decimals"),a=this.safeValue(e,"active"),n=this.safeString(e,"withdrawalFee"),o=this.safeInteger(e,"tradeDecimals");let c;if(void 0!==n&&void 0!==o){const e=n.length-o;if(e>0){const t=n.slice(0,e),s=n.slice(-e);c=parseFloat(t+"."+s)}else{let t=".";for(let s=0;s<-e;s++)t+="0";c=parseFloat(t+n)}}return{id:s,code:s,info:e,type:void 0,name:i,active:a,fee:c,precision:r,limits:{withdraw:{min:c,max:void 0},amount:{min:void 0,max:void 0}}}}parseTicker(e,t){const s=this.safeString(e,"market"),i=this.safeSymbol(s,t,"/"),r=this.parse8601(this.safeString(e,"timestamp")),a=this.safeNumber(e,"last"),n=this.safeNumber(e,"open");let o,c,d;return void 0!==a&&void 0!==n&&(o=a-n,c=this.sum(a,n)/2),void 0!==o&&n&&(d=o/n*100),{symbol:i,info:e,timestamp:r,datetime:this.iso8601(r),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"bid"),bidVolume:void 0,ask:this.safeNumber(e,"ask"),askVolume:void 0,vwap:void 0,open:n,close:a,last:a,previousClose:void 0,change:o,percentage:d,average:c,baseVolume:this.safeNumber(e,"volume"),quoteVolume:this.safeNumber(e,"volumeQuote")}}parseTrade(e,t){const s=this.safeString(e,"symbol"),i=this.safeSymbol(s,t),r=this.parse8601(this.safeString(e,"timestamp")),a=this.safeString(e,"price"),n=this.safeString(e,"quantity"),o=this.parseNumber(a),c=this.parseNumber(n),d=this.parseNumber(p.stringMul(a,n)),h=this.safeString(e,"id"),u=this.safeStringLower2(e,"direction","side"),l=this.safeStringLower(e,"makerOrTaker");let f,m;void 0!==l&&(f=this.safeString(e,l+"OrderId"));const b=this.safeNumber(e,"fee"),g=this.safeCurrencyCode(this.safeString(e,"feeToken"));return void 0!==b&&(m={cost:b,currency:g}),{info:e,id:h,timestamp:r,datetime:this.iso8601(r),symbol:i,order:f,type:void 0,side:u,price:o,amount:c,cost:d,takerOrMaker:l,fee:m}}parseOHLCV(e,t){return[this.parse8601(this.safeString(e,"timestamp")),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}parseOrder(e,t){const s=this.safeString(e,"id"),i=this.safeStringLower(e,"type"),r=this.safeStringLower(e,"side"),a=this.safeString(e,"symbol"),n=this.safeSymbol(a,t),o=this.parse8601(this.safeString(e,"createdAt")),c=this.safeNumber(e,"price"),d=this.safeNumber(e,"quantity"),h=this.safeNumber(e,"filledQuantity"),u=this.safeNumber(e,"cancelledQuantity");let l;void 0!==d&&void 0!==h&&(l=h>=d?"closed":void 0!==u&&u>0?"canceled":"open");const f=this.safeValue(e,"trades",[]),p=this.parseTrades(f,t,void 0,void 0,{order:s,type:i}),m=this.safeString(e,"clientOrderId");return this.safeOrder({info:e,id:s,clientOrderId:m,timestamp:o,datetime:this.iso8601(o),lastTradeTimestamp:void 0,symbol:n,type:i,timeInForce:void 0,postOnly:void 0,side:r,price:c,stopPrice:void 0,amount:d,cost:void 0,average:void 0,filled:h,remaining:void 0,status:l,fee:void 0,trades:p})}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api+"/"+t+"/"+e;if(Object.keys(i).length&&(n+="?"+this.urlencodeWithArrayRepeat(i)),"public"!==t){this.checkRequiredCredentials();const e=this.stringToBase64(this.apiKey+":"+this.secret);r={authorization:"Basic "+this.decode(e)}}return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0!==o&&e>=400){const e=this.id+" "+n;let t=this.safeValue(o,"error");void 0===t&&(t=o);const s=this.safeString2(t,"code","status"),i=this.safeString2(t,"message","debugMessage");throw this.throwBroadlyMatchedException(this.exceptions.broad,i,e),this.throwExactlyMatchedException(this.exceptions.exact,s,e),this.throwExactlyMatchedException(this.exceptions.exact,i,e),new r(e)}}}},7705:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,BadRequest:a,AuthenticationError:n,InvalidOrder:o,InsufficientFunds:c,OrderNotFound:d,PermissionDenied:h,AddressPending:u}=s(3449),l=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"upbit",name:"Upbit",countries:["KR"],version:"v1",rateLimit:1e3,pro:!0,has:{cancelOrder:!0,CORS:!0,createDepositAddress:!0,createMarketOrder:!0,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchMarkets:!0,fetchMyTrades:!1,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrderBooks:!0,fetchOrders:!1,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTransactions:!1,fetchWithdrawals:!0,withdraw:!0},timeframes:{"1m":"minutes","3m":"minutes","5m":"minutes","15m":"minutes","30m":"minutes","1h":"minutes","4h":"minutes","1d":"days","1w":"weeks","1M":"months"},hostname:"api.upbit.com",urls:{logo:"https://user-images.githubusercontent.com/1294454/49245610-eeaabe00-f423-11e8-9cba-4b0aed794799.jpg",api:{public:"https://{hostname}",private:"https://{hostname}"},www:"https://upbit.com",doc:"https://docs.upbit.com/docs/%EC%9A%94%EC%B2%AD-%EC%88%98-%EC%A0%9C%ED%95%9C",fees:"https://upbit.com/service_center/guide"},api:{public:{get:["market/all","candles/{timeframe}","candles/{timeframe}/{unit}","candles/minutes/{unit}","candles/minutes/1","candles/minutes/3","candles/minutes/5","candles/minutes/15","candles/minutes/30","candles/minutes/60","candles/minutes/240","candles/days","candles/weeks","candles/months","trades/ticks","ticker","orderbook"]},private:{get:["accounts","orders/chance","order","orders","withdraws","withdraw","withdraws/chance","deposits","deposit","deposits/coin_addresses","deposits/coin_address"],post:["orders","withdraws/coin","withdraws/krw","deposits/generate_coin_address"],delete:["order"]}},fees:{trading:{tierBased:!1,percentage:!0,maker:.0025,taker:.0025},funding:{tierBased:!1,percentage:!1,withdraw:{},deposit:{}}},exceptions:{exact:{"This key has expired.":n,"Missing request parameter error. Check the required parameters!":a,"side is missing, side does not have a valid value":o},broad:{thirdparty_agreement_required:h,out_of_scope:h,order_not_found:d,insufficient_funds:c,invalid_access_key:n,jwt_verification:n,create_ask_error:r,create_bid_error:r,volume_too_large:o,invalid_funds:o}},options:{createMarketBuyOrderRequiresPrice:!0,fetchTickersMaxLength:4096,fetchOrderBooksMaxLength:4096,tradingFeesByQuoteCurrency:{KRW:5e-4}},commonCurrencies:{TON:"Tokamak Network"}})}async fetchCurrency(e,t={}){await this.loadMarkets();const s=this.currency(e);return await this.fetchCurrencyById(s.id,t)}async fetchCurrencyById(e,t={}){const s={currency:e},i=await this.privateGetWithdrawsChance(this.extend(s,t)),r=this.safeValue(i,"member_level",{}),a=this.safeValue(i,"currency",{}),n=this.safeValue(i,"withdraw_limit",{}),o=this.safeValue(n,"can_withdraw"),c=this.safeString(a,"wallet_state"),d=this.safeValue(r,"wallet_locked"),h=this.safeValue(r,"locked");let u=!0;void 0===o||o?("working"!==c||void 0!==d&&d||void 0!==h&&h)&&(u=!1):u=!1;const l=this.safeNumber(n,"onetime"),f=this.safeNumber(n,"daily",l),p=this.safeNumber(n,"remaining_daily",f);let m;m=p>0?p:f;const b=this.safeString(a,"code"),g=this.safeCurrencyCode(b);return{info:i,id:b,code:g,name:g,active:u,fee:this.safeNumber(a,"withdraw_fee"),precision:undefined,limits:{withdraw:{min:this.safeNumber(n,"minimum"),max:m}}}}async fetchMarket(e,t={}){await this.loadMarkets();const s=this.market(e);return await this.fetchMarketById(s.id,t)}async fetchMarketById(e,t={}){const s={market:e},i=await this.privateGetOrdersChance(this.extend(s,t)),r=this.safeValue(i,"market"),a=this.safeValue(r,"bid"),n=this.safeValue(r,"ask"),o=this.safeString(r,"id"),c=this.safeString(n,"currency"),d=this.safeString(a,"currency"),h=this.safeCurrencyCode(c),u=this.safeCurrencyCode(d),l=h+"/"+u,f={amount:8,price:8},p="active"===this.safeString(r,"state"),m=this.safeNumber(i,"bid_fee"),b=this.safeNumber(i,"ask_fee"),g=Math.max(m,b);return{info:i,id:o,symbol:l,base:h,quote:u,baseId:c,quoteId:d,active:p,precision:f,maker:g,taker:g,limits:{amount:{min:this.safeNumber(n,"min_total"),max:void 0},price:{min:Math.pow(10,-f.price),max:void 0},cost:{min:this.safeNumber(a,"min_total"),max:this.safeNumber(r,"max_total")}}}}async fetchMarkets(e={}){const t=await this.publicGetMarketAll(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"market"),[a,n]=r.split("-"),o=this.safeCurrencyCode(n),c=this.safeCurrencyCode(a),d=o+"/"+c,h={amount:8,price:8},u=!0,l=this.safeNumber(this.options.tradingFeesByQuoteCurrency,c,this.fees.trading.maker),f=this.safeNumber(this.options.tradingFeesByQuoteCurrency,c,this.fees.trading.taker);s.push({id:r,symbol:d,base:o,quote:c,baseId:n,quoteId:a,active:u,info:i,precision:h,maker:l,taker:f,limits:{amount:{min:Math.pow(10,-h.amount),max:void 0},price:{min:Math.pow(10,-h.price),max:void 0},cost:{min:void 0,max:void 0}}})}return s}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetAccounts(e),s={info:t,timestamp:void 0,datetime:void 0};for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"currency"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(i,"balance"),n.used=this.safeString(i,"locked"),s[a]=n}return this.parseBalance(s,!1)}async fetchOrderBooks(e,t,s={}){let i;if(await this.loadMarkets(),void 0===e){if(i=this.ids.join(","),i.length>this.options.fetchOrderBooksMaxLength){const e=this.ids.length;throw new r(this.id+" has "+e.toString()+" symbols ("+i.length.toString()+" characters) exceeding max URL length ("+this.options.fetchOrderBooksMaxLength.toString()+" characters), you are required to specify a list of symbols in the first argument to fetchOrderBooks")}}else i=this.marketIds(e),i=i.join(",");const a={markets:i},n=await this.publicGetOrderbook(this.extend(a,s)),o={};for(let e=0;e<n.length;e++){const t=n[e],s=this.safeString(t,"market"),i=this.safeSymbol(s,void 0,"-"),r=this.safeInteger(t,"timestamp");o[i]={symbol:i,bids:this.sortBy(this.parseBidsAsks(t.orderbook_units,"bid_price","bid_size"),0,!0),asks:this.sortBy(this.parseBidsAsks(t.orderbook_units,"ask_price","ask_size"),0),timestamp:r,datetime:this.iso8601(r),nonce:void 0}}return o}async fetchOrderBook(e,t,s={}){const i=await this.fetchOrderBooks([e],t,s);return this.safeValue(i,e)}parseTicker(e,t){const s=this.safeInteger(e,"trade_timestamp"),i=this.safeString2(e,"market","code"),r=this.safeSymbol(i,t,"-"),a=this.safeNumber(e,"prev_closing_price"),n=this.safeNumber(e,"trade_price"),o=this.safeNumber(e,"signed_change_price"),c=this.safeNumber(e,"signed_change_rate");return{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high_price"),low:this.safeNumber(e,"low_price"),bid:void 0,bidVolume:void 0,ask:void 0,askVolume:void 0,vwap:void 0,open:this.safeNumber(e,"opening_price"),close:n,last:n,previousClose:a,change:o,percentage:c,average:void 0,baseVolume:this.safeNumber(e,"acc_trade_volume_24h"),quoteVolume:this.safeNumber(e,"acc_trade_price_24h"),info:e}}async fetchTickers(e,t={}){let s;if(await this.loadMarkets(),void 0===e){if(s=this.ids.join(","),s.length>this.options.fetchTickersMaxLength){const e=this.ids.length;throw new r(this.id+" has "+e.toString()+" symbols exceeding max URL length, you are required to specify a list of symbols in the first argument to fetchTickers")}}else s=this.marketIds(e),s=s.join(",");const i={markets:s},a=await this.publicGetTicker(this.extend(i,t)),n={};for(let e=0;e<a.length;e++){const t=this.parseTicker(a[e]);n[t.symbol]=t}return this.filterByArray(n,"symbol",e)}async fetchTicker(e,t={}){const s=await this.fetchTickers([e],t);return this.safeValue(s,e)}parseTrade(e,t){const s=this.safeString2(e,"sequential_id","uuid");let i,r=this.safeInteger(e,"timestamp");void 0===r&&(r=this.parse8601(this.safeString(e,"created_at")));const a=this.safeStringLower2(e,"ask_bid","side");"ask"===a?i="sell":"bid"===a&&(i="buy");let n=this.safeNumber(e,"funds");const o=this.safeString2(e,"trade_price","price"),c=this.safeString2(e,"trade_volume","volume"),d=this.parseNumber(o),h=this.parseNumber(c);void 0===n&&(n=this.parseNumber(l.stringMul(o,c)));const u=this.safeString2(e,"market","code");let f,p,m;if(void 0!==(t=this.safeMarket(u,t)))m=t.symbol,p=t.quote;else{const[e,t]=u.split("-"),s=this.safeCurrencyCode(e),i=this.safeCurrencyCode(t);m=s+"/"+i,p=i}const b=this.safeString(e,a+"_fee");return void 0!==b&&(f={currency:p,cost:b}),{id:s,info:e,order:undefined,timestamp:r,datetime:this.iso8601(r),symbol:m,type:void 0,side:i,takerOrMaker:void 0,price:d,amount:h,cost:n,fee:f}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e);void 0===s&&(s=200);const a={market:r.id,count:s},n=await this.publicGetTradesTicks(this.extend(a,i));return this.parseTrades(n,r,t,s)}parseOHLCV(e,t){return[this.parse8601(this.safeString(e,"candle_date_time_utc")),this.safeNumber(e,"opening_price"),this.safeNumber(e,"high_price"),this.safeNumber(e,"low_price"),this.safeNumber(e,"trade_price"),this.safeNumber(e,"candle_acc_trade_volume")]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n=this.parseTimeframe(t),o=this.timeframes[t];void 0===i&&(i=200);const c={market:a.id,timeframe:o,count:i};let d="publicGetCandlesTimeframe";if("minutes"===o){const e=Math.round(n/60);c.unit=e,d+="Unit"}void 0!==s&&(c.to=this.iso8601(this.sum(s,n*i*1e3)));const h=await this[d](this.extend(c,r));return this.parseOHLCVs(h,a,t,s,i)}async createOrder(e,t,s,i,r,a={}){if("market"===t&&"buy"===s&&this.options.createMarketBuyOrderRequiresPrice){if(void 0===r)throw new o(this.id+" createOrder() requires the price argument with market buy orders to calculate total order cost (amount to spend), where cost = amount * price. Supply a price argument to createOrder() call if you want the cost to be calculated for you from price and amount, or, alternatively, add .options['createMarketBuyOrderRequiresPrice'] = false to supply the cost in the amount argument (the exchange-specific behaviour)");i*=r}let n;if("buy"===s)n="bid";else{if("sell"!==s)throw new o(this.id+" createOrder allows buy or sell side only!");n="ask"}await this.loadMarkets();const c={market:this.market(e).id,side:n};"limit"===t?(c.volume=this.amountToPrecision(e,i),c.price=this.priceToPrecision(e,r),c.ord_type=t):"market"===t&&("buy"===s?(c.ord_type="price",c.price=this.priceToPrecision(e,i)):"sell"===s&&(c.ord_type=t,c.volume=this.amountToPrecision(e,i)));const d=this.safeString2(a,"clientOrderId","identifier");void 0!==d&&(c.identifier=d),a=this.omit(a,["clientOrderId","identifier"]);const h=await this.privatePostOrders(this.extend(c,a));return this.parseOrder(h)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={uuid:e},r=await this.privateDeleteOrder(this.extend(i,s));return this.parseOrder(r)}async fetchDeposits(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.currency=a.id),void 0!==s&&(r.limit=s);const n=await this.privateGetDeposits(this.extend(r,i));return this.parseTransactions(n,a,t,s)}async fetchWithdrawals(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.currency=a.id),void 0!==s&&(r.limit=s);const n=await this.privateGetWithdraws(this.extend(r,i));return this.parseTransactions(n,a,t,s)}parseTransactionStatus(e){return this.safeString({submitting:"pending",submitted:"pending",almost_accepted:"pending",rejected:"failed",accepted:"pending",processing:"pending",done:"ok",canceled:"canceled"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"uuid"),i=this.safeNumber(e,"amount"),r=this.safeString(e,"txid"),a=this.parse8601(this.safeString(e,"done_at")),n=this.parse8601(this.safeString(e,"created_at",a));let o=this.safeString(e,"type");"withdraw"===o&&(o="withdrawal");const c=this.safeString(e,"currency"),d=this.safeCurrencyCode(c),h=this.parseTransactionStatus(this.safeStringLower(e,"state")),u=this.safeNumber(e,"fee");return{info:e,id:s,currency:d,amount:i,address:undefined,tag:undefined,status:h,type:o,updated:a,txid:r,timestamp:n,datetime:this.iso8601(n),fee:{currency:d,cost:u}}}parseOrderStatus(e){return this.safeString({wait:"open",done:"closed",cancel:"canceled"},e,e)}parseOrder(e,t){const s=this.safeString(e,"uuid");let i=this.safeString(e,"side");i="bid"===i?"buy":"sell";let r=this.safeString(e,"ord_type");const a=this.parse8601(this.safeString(e,"created_at")),n=this.parseOrderStatus(this.safeString(e,"state"));let o,c=this.safeNumber(e,"price");const d=this.safeNumber(e,"volume"),h=this.safeNumber(e,"remaining_volume"),u=this.safeNumber(e,"executed_volume");let l,f,p;"price"===r&&(r="market",l=c,c=void 0);let m=this.safeNumber(e,"paid_fee");const b=this.safeString(e,"market");t=this.safeMarket(b,t);let g=this.safeValue(e,"trades",[]);g=this.parseTrades(g,t,void 0,void 0,{order:s,type:r});const y=g.length;if(y>0){o=g[y-1].timestamp;let e=!1;void 0===m&&(e=!0,m=0),l=0;for(let t=0;t<y;t++){const s=g[t];if(l=this.sum(l,s.cost),e){const e=this.safeValue(g[t],"fee",{}),s=this.safeNumber(e,"cost");void 0!==s&&(m=this.sum(m,s))}}f=l/u}void 0!==m&&(p={currency:t.quote,cost:m});return{info:e,id:s,clientOrderId:void 0,timestamp:a,datetime:this.iso8601(a),lastTradeTimestamp:o,symbol:t.symbol,type:r,timeInForce:void 0,postOnly:void 0,side:i,price:c,stopPrice:void 0,cost:l,average:f,amount:d,filled:u,remaining:h,status:n,fee:p,trades:g}}async fetchOrdersByState(e,t,s,i,r={}){await this.loadMarkets();const a={state:e};let n;void 0!==t&&(n=this.market(t),a.market=n.id);const o=await this.privateGetOrders(this.extend(a,r));return this.parseOrders(o,n,s,i)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrdersByState("wait",e,t,s,i)}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrdersByState("done",e,t,s,i)}async fetchCanceledOrders(e,t,s,i={}){return await this.fetchOrdersByState("cancel",e,t,s,i)}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={uuid:e},r=await this.privateGetOrder(this.extend(i,s));return this.parseOrder(r)}async fetchDepositAddresses(e,t={}){await this.loadMarkets();const s=await this.privateGetDepositsCoinAddresses(t);return this.parseDepositAddresses(s)}parseDepositAddress(e,t){const s=this.safeString(e,"deposit_address"),i=this.safeString(e,"secondary_address"),r=this.safeString(e,"currency"),a=this.safeCurrencyCode(r);return this.checkAddress(s),{currency:a,address:s,tag:i,info:e}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e),i=await this.privateGetDepositsCoinAddress(this.extend({currency:s.id},t));return this.parseDepositAddress(i)}async createDepositAddress(e,t={}){await this.loadMarkets();const s={currency:this.currency(e).id},i=await this.privatePostDepositsGenerateCoinAddress(this.extend(s,t));if(void 0!==this.safeString(i,"message"))throw new u(this.id+" is generating "+e+" deposit address, call fetchDepositAddress or createDepositAddress one more time later to retrieve the generated address");return this.parseDepositAddress(i)}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets();const a=this.currency(e),n={amount:t};let o="privatePostWithdraws";"KRW"!==e?(o+="Coin",n.currency=a.id,n.address=s,void 0!==i&&(n.secondary_address=i)):o+="Krw";const c=await this[o](this.extend(n,r));return this.parseTransaction(c)}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n=this.implodeParams(this.urls.api[t],{hostname:this.hostname});n+="/"+this.version+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if("POST"!==s&&Object.keys(o).length&&(n+="?"+this.urlencode(o)),"private"===t){this.checkRequiredCredentials();const e=this.nonce(),t={access_key:this.apiKey,nonce:e};if(Object.keys(o).length){const e=this.urlencode(o),s=this.hash(this.encode(e),"sha512");t.query_hash=s,t.query_hash_alg="SHA512"}r={Authorization:"Bearer "+this.jwt(t,this.encode(this.secret))},"GET"!==s&&"DELETE"!==s&&(a=this.json(i),r["Content-Type"]="application/json")}return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0===o)return;const h=this.safeValue(o,"error");if(void 0!==h){const e=this.safeString(h,"message"),t=this.safeString(h,"name"),s=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,e,s),this.throwExactlyMatchedException(this.exceptions.exact,t,s),this.throwBroadlyMatchedException(this.exceptions.broad,e,s),this.throwBroadlyMatchedException(this.exceptions.broad,t,s),new r(s)}}}},3571:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,OrderNotFound:a,InvalidOrder:n,BadRequest:o,AuthenticationError:c,RateLimitExceeded:d,RequestTimeout:h,BadSymbol:u,AddressPending:l,PermissionDenied:f,InsufficientFunds:p}=s(3449),{ROUND:m}=s(2115),b=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"vcc",name:"VCC Exchange",countries:["VN"],rateLimit:1e3,version:"v3",has:{cancelAllOrders:!0,cancelOrder:!0,createOrder:!0,editOrder:!1,fetchBalance:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!1,fetchTicker:"emulated",fetchTickers:!0,fetchTrades:!0,fetchTradingFees:!1,fetchTransactions:!0,fetchWithdrawals:!0},timeframes:{"1m":"60000","5m":"300000","15m":"900000","30m":"1800000","1h":"3600000","2h":"7200000","4h":"14400000","6h":"21600000","12h":"43200000","1d":"86400000","1w":"604800000"},urls:{logo:"https://user-images.githubusercontent.com/1294454/100545356-8427f500-326c-11eb-9539-7d338242d61b.jpg",api:{public:"https://api.vcc.exchange",private:"https://api.vcc.exchange"},www:"https://vcc.exchange",doc:["https://vcc.exchange/api"],fees:"https://support.vcc.exchange/hc/en-us/articles/360016401754",referral:"https://vcc.exchange?ref=l4xhrH"},api:{public:{get:["summary","exchange_info","assets","ticker","trades/{market_pair}","orderbook/{market_pair}","chart/bars","tick_sizes"]},private:{get:["user","balance","orders/{order_id}","orders/open","orders","orders/trades","deposit-address","transactions"],post:["orders"],put:["orders/{order_id}/cancel","orders/cancel-by-type","orders/cancel-all"]}},fees:{trading:{tierBased:!1,percentage:!0,maker:.002,taker:.002}},exceptions:{exact:{},broad:{"limit may not be greater than":o,"Insufficient balance":p,Unauthenticated:c,"signature is invalid":c,Timeout:h,"Too many requests":d,"quantity field is required":n,"price field is required":n,error_security_level:f,"pair is invalid":u,"type is invalid":n,"Data not found":a}}})}async fetchMarkets(e={}){const t=await this.publicGetExchangeInfo(e),s=this.safeValue(t,"data"),i=this.safeValue(s,"symbols"),r=[];for(let e=0;e<i.length;e++){const t=this.safeValue(i,e),s=this.safeString(t,"symbol"),a=s.replace("/","_"),n=this.safeString(t,"coin"),o=this.safeString(t,"currency"),c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o),h=this.safeValue(t,"active"),u=this.safeValue(t,"precision",{}),l=this.safeValue(t,"limits",{}),f=this.safeValue(l,"amount",{}),p=this.safeValue(l,"price",{}),m=this.safeValue(l,"cost",{}),b={info:t,id:a,symbol:s,base:c,quote:d,baseId:n,quoteId:o,active:h,precision:{price:this.safeInteger(u,"price"),amount:this.safeInteger(u,"amount"),cost:this.safeInteger(u,"cost")},limits:{amount:{min:this.safeNumber(f,"min"),max:void 0},price:{min:this.safeNumber(p,"min"),max:void 0},cost:{min:this.safeNumber(m,"min"),max:void 0}}};r.push(b)}return r}async fetchCurrencies(e={}){const t=await this.publicGetAssets(e),s={},i=this.safeValue(t,"data"),r=Object.keys(i);for(let e=0;e<r.length;e++){const t=this.safeStringLower(r,e),a=this.safeValue(i,r[e]),n=this.safeCurrencyCode(t),o=this.safeValue(a,"can_deposit"),c=this.safeValue(a,"can_withdraw"),d=o&&c;s[n]={id:t,code:n,name:this.safeString(a,"name"),active:d,fee:this.safeNumber(a,"withdrawal_fee"),precision:this.safeInteger(a,"decimal"),limits:{withdraw:{min:this.safeNumber(a,"min_withdraw"),max:this.safeNumber(a,"max_withdraw")}}}}return s}async fetchTradingFee(e,t={}){await this.loadMarkets();const s=this.market(e),i=this.extend({symbol:s.id},this.omit(t,"symbol")),r=await this.privateGetTradingFeeSymbol(i);return{info:r,maker:this.safeNumber(r,"provideLiquidityRate"),taker:this.safeNumber(r,"takeLiquidityRate")}}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetBalance(e),s=this.safeValue(t,"data"),i={info:t,timestamp:void 0,datetime:void 0},r=Object.keys(s);for(let e=0;e<r.length;e++){const t=r[e],a=this.safeCurrencyCode(t),n=this.safeValue(s,t),o=this.account();o.free=this.safeString(n,"available_balance"),o.total=this.safeString(n,"balance"),i[a]=o}return this.parseBalance(i,!1)}parseOHLCV(e,t){return[this.safeInteger(e,"time"),this.safeNumber(e,"open"),this.safeNumber(e,"high"),this.safeNumber(e,"low"),this.safeNumber(e,"close"),this.safeNumber(e,"volume")]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={coin:a.baseId,currency:a.quoteId,resolution:this.timeframes[t]};i=void 0===i?100:i,i=Math.min(100,i);const o=this.parseTimeframe(t);if(void 0===s){const e=this.seconds();n.to=e,n.from=e-i*o}else{const e=parseInt(s/1e3);n.from=e,n.to=this.sum(e,i*o)}const c=await this.publicGetChartBars(this.extend(n,r));return this.parseOHLCVs(c,a,t,s,i)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={market_pair:this.market(e).id,level:2};if(void 0!==t){if(0!==t&&5!==t&&10!==t&&20!==t&&50!==t&&100!==t&&500!==t)throw new o(this.id+" fetchOrderBook limit must be 0, 5, 10, 20, 50, 100, 500 if specified");i.depth=t}const r=await this.publicGetOrderbookMarketPair(this.extend(i,s)),a=this.safeValue(r,"data"),n=this.safeValue(a,"timestamp");return this.parseOrderBook(a,e,n,"bids","asks",0,1)}parseTicker(e,t){const s=this.milliseconds(),i=this.safeNumber(e,"base_volume"),r=this.safeNumber(e,"quote_volume"),a=this.safeNumber(e,"open_price"),n=this.safeNumber(e,"last_price");let o,c,d;void 0!==n&&void 0!==a&&(o=n-a,d=this.sum(n,a)/2,a>0&&(c=o/a*100));const h=this.vwap(i,r);return{symbol:void 0===t?void 0:t.symbol,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"max_price"),low:this.safeNumber(e,"min_price"),bid:this.safeNumber(e,"bid"),bidVolume:void 0,ask:this.safeNumber(e,"ask"),askVolume:void 0,vwap:h,open:a,close:n,last:n,previousClose:void 0,change:o,percentage:c,average:d,baseVolume:i,quoteVolume:r,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetTicker(t),i={},r=this.safeValue(s,"data"),a=Object.keys(r);for(let e=0;e<a.length;e++){const t=a[e],s=this.safeMarket(t,void 0,"_");i[s.symbol]=this.parseTicker(r[t],s)}return this.filterByArray(i,"symbol",e)}parseTrade(e,t){const s=this.safeInteger2(e,"trade_timestamp","created_at"),i=this.safeStringUpper(e,"coin"),r=this.safeStringUpper(e,"currency");let a;void 0!==i&&void 0!==r&&(a=i+"_"+r);const n=(t=this.safeMarket(a,t,"_")).symbol,o=this.safeString(e,"price"),c=this.safeString2(e,"base_volume","quantity"),d=this.parseNumber(o),h=this.parseNumber(c);let u=this.safeNumber2(e,"quote_volume","amount");void 0===u&&(u=this.parseNumber(b.stringMul(o,c)));const l=this.safeString2(e,"type","trade_type"),f=this.safeString2(e,"trade_id","id"),p=this.safeNumber(e,"fee");let m;return void 0!==p&&(m={cost:p,currency:t.quote}),{info:e,id:f,order:void 0,timestamp:s,datetime:this.iso8601(s),symbol:n,type:void 0,side:l,takerOrMaker:void 0,price:d,amount:h,cost:u,fee:m}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={market_pair:r.id};void 0!==s&&(a.count=Math.min(1e3,s));const n=await this.publicGetTradesMarketPair(this.extend(a,i)),o=this.safeValue(n,"data");return this.parseTrades(o,r,t,s)}async fetchTransactions(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.currency=a.id),void 0!==s&&(r.limit=Math.min(1e3,s)),void 0!==t&&(r.start=t);const n=await this.privateGetTransactions(this.extend(r,i));let o=this.safeValue(n,"data",{});return o=this.safeValue(o,"data",[]),this.parseTransactions(o,a,t,s)}async fetchDeposits(e,t,s,i={}){return await this.fetchTransactions(e,t,s,this.extend({type:"deposit"},i))}async fetchWithdrawals(e,t,s,i={}){return await this.fetchTransactions(e,t,s,this.extend({type:"withdraw"},i))}parseTransaction(e,t){const s=this.safeString(e,"id"),i=this.safeInteger(e,"created_at"),r=this.safeInteger(e,"updated_at"),a=this.safeString(e,"currency"),n=this.safeCurrencyCode(a,t),o=this.parseTransactionStatus(this.safeString(e,"status"));let c=this.safeNumber(e,"amount");void 0!==c&&(c=Math.abs(c));const d=this.safeString(e,"blockchain_address"),h=this.safeString(e,"transaction_id"),u=this.safeString(e,"destination_tag");let l;const f=this.safeNumber(e,"fee");void 0!==f&&(l={cost:f,currency:n});const p=c>0?"deposit":"withdrawal";return{info:e,id:s,txid:h,timestamp:i,datetime:this.iso8601(i),address:d,addressTo:d,addressFrom:void 0,tag:u,tagTo:u,tagFrom:void 0,type:p,amount:c,currency:n,status:o,updated:r,fee:l}}parseTransactionStatus(e){return this.safeString({pending:"pending",error:"failed",success:"ok",cancel:"canceled"},e,e)}parseTransactionType(e){return this.safeString({deposit:"deposit",withdraw:"withdrawal"},e,e)}costToPrecision(e,t){return this.decimalToPrecision(t,m,this.markets[e].precision.cost,this.precisionMode,this.paddingMode)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();const o=this.market(e),c={coin:o.baseId,currency:o.quoteId,trade_type:s,type:t};if("ceiling_market"===t){const s=this.safeValue(a,"ceiling");if(void 0!==s)c.ceiling=this.costToPrecision(e,s);else{if(void 0===r)throw new n(this.id+" createOrder() requires a price argument or a ceiling parameter for "+t+" orders");c.ceiling=this.costToPrecision(e,i*r)}}else c.quantity=this.amountToPrecision(e,i);"limit"===t&&(c.price=this.priceToPrecision(e,r));void 0!==this.safeValue2(a,"stop_price","stopPrice")&&(c.is_stop=1,c.stop_condition="buy"===s?"le":"ge",c.stop_price=this.priceToPrecision(e,r)),a=this.omit(a,["stop_price","stopPrice"]);const d=await this.privatePostOrders(this.extend(c,a)),h=this.safeValue(d,"data");return this.parseOrder(h,o)}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={order_id:e},r=await this.privatePutOrdersOrderIdCancel(this.extend(i,s));return this.parseOrder(r)}async cancelAllOrders(e,t={}){const s=this.safeString(t,"type"),i=void 0===s?"privatePutOrdersCancelAll":"privatePutOrdersCancelByType",r={};void 0!==s&&(r.type=s),await this.loadMarkets();const a=await this[i](this.extend(r,t));let n=this.safeValue(a,"data",{});return n=this.safeValue(a,"data",[]),this.parseOrders(n)}parseOrderStatus(e){return this.safeString({pending:"open",stopping:"open",executing:"open",executed:"closed",canceled:"canceled"},e,e)}parseOrder(e,t){const s=this.safeValue(e,"created_at"),i=this.safeValue(e,"updated_at"),r=this.safeStringUpper(e,"coin")+"_"+this.safeStringUpper(e,"currency"),a=(t=this.safeMarket(r,t,"_")).symbol,n=this.safeNumber(e,"quantity"),o=this.safeNumber(e,"executed_quantity"),c=this.parseOrderStatus(this.safeString(e,"status")),d=this.safeNumber(e,"ceiling"),h=this.safeString(e,"id"),u=this.safeNumber(e,"price"),l=this.safeNumber(e,"executed_price"),f=this.safeNumber(e,"remaining"),p=this.safeString(e,"type"),m=this.safeString(e,"trade_type"),b={currency:t.quote,cost:this.safeNumber(e,"fee"),rate:this.safeNumber(e,"fee_rate")};let g;i!==s&&(g=i);const y=this.safeNumber(e,"stopPrice");return this.safeOrder({id:h,clientOrderId:h,timestamp:s,datetime:this.iso8601(s),lastTradeTimestamp:g,status:c,symbol:a,type:p,timeInForce:void 0,postOnly:void 0,side:m,price:u,stopPrice:y,average:l,amount:n,cost:d,filled:o,remaining:f,fee:b,trades:void 0,info:e})}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={order_id:e},r=await this.privateGetOrdersOrderId(this.extend(i,s)),a=this.safeValue(r,"data");return this.parseOrder(a)}async fetchOrdersWithMethod(e,t,s,i,r={}){await this.loadMarkets();const a={};let n;void 0!==t&&(n=this.market(t),a.coin=n.baseId,a.currency=n.quoteId),void 0!==s&&(a.start_date=s),void 0!==i&&(a.limit=Math.min(1e3,i));const o=await this[e](this.extend(a,r));let c=this.safeValue(o,"data",{});return c=this.safeValue(c,"data",[]),this.parseOrders(c,n,s,i)}async fetchOpenOrders(e,t,s,i={}){return await this.fetchOrdersWithMethod("privateGetOrdersOpen",e,t,s,i)}async fetchClosedOrders(e,t,s,i={}){return await this.fetchOrdersWithMethod("privateGetOrders",e,t,s,i)}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.market(e),r.coin=a.baseId,r.currency=a.quoteId),void 0!==t&&(r.start_date=t),void 0!==s&&(r.limit=Math.min(1e3,s));const n=await this.privateGetOrdersTrades(this.extend(r,i));let o=this.safeValue(n,"data",{});return o=this.safeValue(o,"data",[]),this.parseTrades(o,a,t,s)}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={currency:this.currency(e).id},i=await this.privateGetDepositAddress(this.extend(s,t)),r=this.safeValue(i,"data");if("REQUESTED"===this.safeString(r,"status"))throw new l(this.id+" is generating "+e+" deposit address, call fetchDepositAddress one more time later to retrieve the generated address");const a=this.safeString(r,"blockchain_address");this.checkAddress(a);const n=this.safeString(r,"blockchain_tag"),o=this.safeString(r,"currency");return{currency:this.safeCurrencyCode(o),address:a,tag:n,info:r}}sign(e,t="public",s="GET",i={},r,a){let n=this.version+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if(Object.keys(o).length&&(n+="?"+this.urlencode(o)),"private"===t){this.checkRequiredCredentials();const e=this.milliseconds().toString();"GET"!==s&&(a=this.json(o));const t=s+" "+n,i=this.hmac(this.encode(t),this.encode(this.secret),"sha256");r={Authorization:"Bearer "+this.apiKey,"Content-Type":"application/json",timestamp:e,signature:i}}return n=this.urls.api[t]+"/"+n,{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0===o)return;const h=this.safeString(o,"message");if(void 0!==h){const e=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,h,e),this.throwBroadlyMatchedException(this.exceptions.broad,n,e),new r(e)}}}},6091:(e,t,s)=>{"use strict";const i=s(8819),{ArgumentsRequired:r,AuthenticationError:a,InsufficientFunds:n,InvalidOrder:o,AccountSuspended:c,ExchangeError:d,DuplicateOrderId:h,OrderNotFound:u,BadSymbol:l,ExchangeNotAvailable:f,BadRequest:p}=s(3449),m=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"wavesexchange",name:"Waves.Exchange",countries:["CH"],rateLimit:500,certified:!0,pro:!1,has:{cancelOrder:!0,createMarketOrder:!1,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchDepositAddress:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrderBook:!0,fetchOrders:!0,fetchTicker:!0,fetchTrades:!0,withdraw:!0},timeframes:{"1m":"1m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","2h":"2h","3h":"3h","4h":"4h","6h":"6h","12h":"12h","1d":"1d","1w":"1w","1M":"1M"},urls:{logo:"https://user-images.githubusercontent.com/1294454/84547058-5fb27d80-ad0b-11ea-8711-78ac8b3c7f31.jpg",api:{matcher:"http://matcher.waves.exchange",node:"https://nodes.waves.exchange",public:"https://api.wavesplatform.com/v0",private:"https://api.waves.exchange/v1",forward:"https://waves.exchange/api/v1/forward/matcher",market:"https://waves.exchange/api/v1/forward/marketdata/api/v1"},doc:"https://docs.waves.exchange",www:"https://waves.exchange"},api:{matcher:{get:["matcher","matcher/settings","matcher/settings/rates","matcher/balance/reserved/{publicKey}","matcher/debug/allSnashotOffsets","matcher/debug/currentOffset","matcher/debug/lastOffset","matcher/debug/oldestSnapshotOffset","matcher/orderbook","matcher/orderbook/{amountAsset}/{priceAsset}","matcher/orderbook/{baseId}/{quoteId}/publicKey/{publicKey}","matcher/orderbook/{baseId}/{quoteId}/{orderId}","matcher/orderbook/{baseId}/{quoteId}/info","matcher/orderbook/{baseId}/{quoteId}/status","matcher/orderbook/{baseId}/{quoteId}/tradeableBalance/{address}","matcher/orderbook/{publicKey}","matcher/orderbook/{publicKey}/{orderId}","matcher/orders/{address}","matcher/orders/{address}/{orderId}","matcher/transactions/{orderId}"],post:["matcher/orderbook","matcher/orderbook/market","matcher/orderbook/cancel","matcher/orderbook/{baseId}/{quoteId}/cancel","matcher/debug/saveSnapshots","matcher/orders/{address}/cancel","matcher/orders/cancel/{orderId}"],delete:["matcher/orderbook/{baseId}/{quoteId}","matcher/settings/rates/{assetId}"],put:["matcher/settings/rates/{assetId}"]},node:{get:["addresses","addresses/balance/{address}","addresses/balance/{address}/{confirmations}","addresses/balance/details/{address}","addresses/data/{address}","addresses/data/{address}/{key}","addresses/effectiveBalance/{address}","addresses/effectiveBalance/{address}/{confirmations}","addresses/publicKey/{publicKey}","addresses/scriptInfo/{address}","addresses/scriptInfo/{address}/meta","addresses/seed/{address}","addresses/seq/{from}/{to}","addresses/validate/{address}","alias/by-address/{address}","alias/by-alias/{alias}","assets/{assetId}/distribution/{height}/{limit}","assets/balance/{address}","assets/balance/{address}/{assetId}","assets/details/{assetId}","assets/nft/{address}/limit/{limit}","blockchain/rewards","blockchain/rewards/height","blocks/address/{address}/{from}/{to}/","blocks/at/{height}","blocks/delay/{signature}/{blockNum}","blocks/first","blocks/headers/last","blocks/headers/seq/{from}/{to}","blocks/height","blocks/height/{signature}","blocks/last","blocks/seq/{from}/{to}","blocks/signature/{signature}","consensus/algo","consensus/basetarget","consensus/basetarget/{blockId}","consensus/{generatingbalance}/address","consensus/generationsignature","consensus/generationsignature/{blockId}","debug/balances/history/{address}","debug/blocks/{howMany}","debug/configInfo","debug/historyInfo","debug/info","debug/minerInfo","debug/portfolios/{address}","debug/state","debug/stateChanges/address/{address}","debug/stateChanges/info/{id}","debug/stateWaves/{height}","leasing/active/{address}","node/state","node/version","peers/all","peers/blacklisted","peers/connected","peers/suspended","transactions/address/{address}/limit/{limit}","transactions/info/{id}","transactions/status","transactions/unconfirmed","transactions/unconfirmed/info/{id}","transactions/unconfirmed/size","utils/seed","utils/seed/{length}","utils/time","wallet/seed"],post:["addresses","addresses/data/{address}","addresses/sign/{address}","addresses/signText/{address}","addresses/verify/{address}","addresses/verifyText/{address}","debug/blacklist","debug/print","debug/rollback","debug/validate","node/stop","peers/clearblacklist","peers/connect","transactions/broadcast","transactions/calculateFee","tranasctions/sign","transactions/sign/{signerAddress}","tranasctions/status","utils/hash/fast","utils/hash/secure","utils/script/compileCode","utils/script/compileWithImports","utils/script/decompile","utils/script/estimate","utils/sign/{privateKey}","utils/transactionsSerialize"],delete:["addresses/{address}","debug/rollback-to/{signature}"]},public:{get:["pairs","candles/{baseId}/{quoteId}","transactions/exchange"]},private:{get:["deposit/addresses/{code}","deposit/currencies","withdraw/currencies","withdraw/addresses/{currency}/{address}"],post:["oauth2/token"]},forward:{get:["matcher/orders/{address}","matcher/orders/{address}/{orderId}"],post:["matcher/orders/{wavesAddress}/cancel"]},market:{get:["tickers"]}},options:{allowedCandles:1440,accessToken:void 0,matcherPublicKey:void 0,quotes:void 0,createOrderDefaultExpiry:24192e5,wavesAddress:void 0,withdrawFeeUSDN:7420,withdrawFeeWAVES:1e5,wavesPrecision:8},requiresEddsa:!0,exceptions:{3147270:n,112:n,4:d,13:f,14:f,3145733:c,3148040:h,3148801:a,9440512:a,9440771:l,9441026:o,9441282:o,9441286:o,9441295:o,9441540:o,9441542:o,106954752:a,106954769:a,106957828:a,106960131:a,106981137:a,9437193:u,1048577:p,1051904:a}})}async getQuotes(){let e=this.safeValue(this.options,"quotes");if(e)return e;{const t=await this.matcherGetMatcherSettings();e={};const s=this.safeValue(t,"priceAssets");for(let t=0;t<s.length;t++)e[s[t]]=!0;return this.options.quotes=e,e}}async fetchMarkets(e={}){const t=await this.marketGetTickers(),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"amountAssetID"),a=this.safeString(i,"priceAssetID"),n=r+"/"+a,o=this.safeString(i,"symbol"),[c,d]=o.split("/"),h=this.safeCurrencyCode(c)+"/"+this.safeCurrencyCode(d),u={amount:this.safeInteger(i,"amountAssetDecimals"),price:this.safeInteger(i,"priceAssetDecimals")};s.push({symbol:h,id:n,base:c,quote:d,baseId:r,quoteId:a,info:i,precision:u})}return s}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),r=this.extend({amountAsset:i.baseId,priceAsset:i.quoteId},s),a=await this.matcherGetMatcherOrderbookAmountAssetPriceAsset(r),n=this.safeInteger(a,"timestamp");return{symbol:e,bids:this.parseOrderBookSide(this.safeValue(a,"bids"),i,t),asks:this.parseOrderBookSide(this.safeValue(a,"asks"),i,t),timestamp:n,datetime:this.iso8601(n),nonce:void 0}}parseOrderBookSide(e,t,s){const i=t.precision,r=this.safeInteger(this.options,"wavesPrecision",8),a=Math.pow(10,i.amount),n=i.amount-i.price,o=Math.pow(10,r-n),c=[];for(let t=0;t<e.length;t++){const i=e[t],r=this.safeInteger(i,"price",0)/o,n=this.safeInteger(i,"amount",0)/a;if(void 0!==s&&t>s)break;c.push([r,n])}return c}checkRequiredKeys(){if(void 0===this.apiKey)throw new a(this.id+" requires apiKey credential");if(void 0===this.secret)throw new a(this.id+" requires secret credential");let e,t;try{e=this.base58ToBinary(this.apiKey)}catch(e){throw new a(this.id+" apiKey must be a base58 encoded public key")}try{t=this.base58ToBinary(this.secret)}catch(e){throw new a(this.id+" secret must be a base58 encoded private key")}const s=this.binaryToBase16(e),i=this.binaryToBase16(t);if(64!==s.length)throw new a(this.id+" apiKey must be a base58 encoded public key");if(64!==i.length)throw new a(this.id+" secret must be a base58 encoded private key")}sign(e,t="public",s="GET",i={},r,a){const n=this.omit(i,this.extractParams(e)),o="matcher/orders/{wavesAddress}/cancel"===e;e=this.implodeParams(e,i);let c=this.urls.api[t]+"/"+e,d=this.urlencode(n);if("private"===t||"forward"===t){r={Accept:"application/json"};const e=this.safeString(this.options,"accessToken");e&&(r.Authorization="Bearer "+e),r["content-type"]="POST"===s?"application/json":"application/x-www-form-urlencoded",o&&(a=this.json([n.orderId]),d=""),d.length>0&&(c+="?"+d)}else"matcher"===t?"POST"===s?(r={"content-type":"application/json"},a=this.json(n)):r=n:"POST"===s?(r={"content-type":"application/json"},a=this.json(n)):(r={"content-type":"application/x-www-form-urlencoded"},d.length>0&&(c+="?"+d));return{url:c,method:s,body:a,headers:r}}async getAccessToken(){if(!this.safeString(this.options,"accessToken")){const e="ffffff01",t=604800;let s=this.sum(this.seconds(),t);s=s.toString();const i="waves.exchange",r="W:"+i+":"+s,a=e+this.binaryToBase16(this.stringToBinary(this.encode(r))),n=this.binaryToBase16(this.base58ToBinary(this.secret)),o=this.eddsa(a,n,"ed25519"),c={grant_type:"password",scope:"general",username:this.apiKey,password:s+":"+o,client_id:i},d=await this.privatePostOauth2Token(c);return this.options.accessToken=this.safeString(d,"access_token"),this.options.accessToken}}parseTicker(e,t){const s=void 0,i=this.safeString(e,"amountAsset"),r=this.safeString(e,"priceAsset");let a;if(void 0!==i&&void 0!==r){const e=i+"/"+r;if(e in this.markets_by_id)t=this.markets_by_id[e];else{a=this.safeCurrencyCode(i)+"/"+this.safeCurrencyCode(r)}}void 0===a&&void 0!==t&&(a=t.symbol);const n=this.safeValue(e,"data",{}),o=this.safeNumber(n,"lastPrice"),c=this.safeNumber(n,"low"),d=this.safeNumber(n,"high"),h=this.safeNumber(n,"weightedAveragePrice"),u=this.safeNumber(n,"volume"),l=this.safeNumber(n,"quoteVolume"),f=this.safeNumber(n,"firstPrice");let p,m,b;return void 0!==o&&void 0!==f&&(p=o-f,m=this.sum(o,f)/2,f>0&&(b=p/f*100)),{symbol:a,timestamp:s,datetime:this.iso8601(s),high:d,low:c,bid:void 0,bidVolume:void 0,ask:void 0,askVolume:void 0,vwap:h,open:f,close:o,last:o,previousClose:void 0,change:p,percentage:b,average:m,baseVolume:u,quoteVolume:l,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={pairs:s.id},r=await this.publicGetPairs(this.extend(i,t)),a=this.safeValue(r,"data",[]),n=this.safeValue(a,0,{});return this.parseTicker(n,s)}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={baseId:a.baseId,quoteId:a.quoteId,interval:this.timeframes[t]};if(void 0!==s)n.timeStart=s.toString();else{const e=this.safeInteger(this.options,"allowedCandles",1440),s=1e3*this.parseTimeframe(t),i=Math.floor(this.milliseconds()/s)*s-(e-1)*s;n.timeStart=i.toString()}const o=await this.publicGetCandlesBaseIdQuoteId(this.extend(n,r)),c=this.safeValue(o,"data",[]),d=this.parseOHLCVs(c,a,t,s,i);let h;const u=d.length;for(let e=0;e<d.length;e++){const t=u-e-1,s=d[t];void 0===s[1]&&(s[1]=h,s[2]=h,s[3]=h,s[4]=h,d[t]=s),h=s[4]}return d}parseOHLCV(e,t){const s=this.safeValue(e,"data",{});return[this.parse8601(this.safeString(s,"time")),this.safeNumber(s,"open"),this.safeNumber(s,"high"),this.safeNumber(s,"low"),this.safeNumber(s,"close"),this.safeNumber(s,"volume",0)]}async fetchDepositAddress(e,t={}){await this.getAccessToken();const s=await this.privateGetDepositCurrencies(),i={},r=this.safeValue(s,"items",[]);for(let e=0;e<r.length;e++){const t=r[e];i[this.safeString(t,"id")]=!0}if(!(e in i)){const t=Object.keys(i);throw new d(this.id+" fetch "+e+" deposit address not supported. Currency code must be one of "+t.toString())}const a=this.extend({code:e},t),n=await this.privateGetDepositAddressesCode(a),o=this.safeValue(n,"deposit_addresses");return{address:this.safeString(o,0),code:e,tag:void 0,info:n}}async getMatcherPublicKey(){const e=this.safeString(this.options,"matcherPublicKey");if(e)return e;{const e=await this.matcherGetMatcher();return this.options.matcherPublicKey=e.slice(1,e.length-1),this.options.matcherPublicKey}}getAssetBytes(e){return"WAVES"===e?this.numberToBE(0,1):this.binaryConcat(this.numberToBE(1,1),this.base58ToBinary(e))}getAssetId(e){return"WAVES"===e?"":e}priceToPrecision(e,t){const s=this.markets[e],i=this.safeInteger(this.options,"wavesPrecision",8),r=s.precision.amount-s.precision.price;return parseInt(parseFloat(this.toWei(t,i-r)))}amountToPrecision(e,t){return parseInt(parseFloat(this.toWei(t,this.markets[e].precision.amount)))}currencyToPrecision(e,t){return parseInt(parseFloat(this.toWei(t,this.currencies[e].precision)))}currencyFromPrecision(e,t){return this.fromWei(t,this.currencies[e].precision)}priceFromPrecision(e,t){const s=this.markets[e],i=this.safeInteger(this.options,"wavesPrecision",8),r=s.precision.amount-s.precision.price;return this.fromWei(t,i-r)}getDefaultExpiry(){const e=this.safeInteger(this.options,"createOrderDefaultExpiry");return e||(this.options.createOrderDefaultExpiry=24192e5,this.options.createOrderDefaultExpiry)}async createOrder(e,t,s,i,r,a={}){this.checkRequiredDependencies(),this.checkRequiredKeys(),await this.loadMarkets();const o=this.market(e),c=await this.getMatcherPublicKey(),d=this.getAssetId(o.baseId),h=this.getAssetId(o.quoteId);i=this.amountToPrecision(e,i),r=this.priceToPrecision(e,r);const u="buy"===s?0:1,l=this.milliseconds(),f=this.sum(l,this.getDefaultExpiry()),p=await this.matcherGetMatcherSettings(),m=this.safeValue(p,"orderFee"),b=this.safeValue(m,"dynamic"),g=this.safeInteger(b,"baseFee"),y=this.currencyFromPrecision("WAVES",g),v=this.safeValue(b,"rates"),w=Object.keys(v);let k,S;if("feeAssetId"in a)k=a.feeAssetId;else if("feeAssetId"in this.options)k=this.options.feeAssetId;else{const e=await this.fetchBalance();if(e.WAVES.free>y)k="WAVES",S=g;else for(let t=0;t<w.length;t++){const s=w[t],i=this.safeCurrencyCode(s),r=this.safeValue(this.safeValue(e,i,{}),"free"),a=v[s]*y;if(void 0!==r&&r>a){k=s;break}}}if(void 0===k)throw n(this.id+" not enough funds to cover the fee, specify feeAssetId in params or options, or buy some WAVES");if(void 0===S){const e=this.safeInteger(this.options,"wavesPrecision",8),t=this.safeNumber(v,k),s=this.safeCurrencyCode(k),i=this.currency(s),r=Math.pow(10,e-i.precision);S=Math.ceil(t*g/r)}const _=[this.numberToBE(3,1),this.base58ToBinary(this.apiKey),this.base58ToBinary(c),this.getAssetBytes(o.baseId),this.getAssetBytes(o.quoteId),this.numberToBE(u,1),this.numberToBE(r,8),this.numberToBE(i,8),this.numberToBE(l,8),this.numberToBE(f,8),this.numberToBE(S,8),this.getAssetBytes(k)],O=this.binaryConcatArray(_),T=this.eddsa(this.binaryToBase16(O),this.binaryToBase16(this.base58ToBinary(this.secret)),"ed25519"),x={amountAsset:d,priceAsset:h},C={senderPublicKey:this.apiKey,matcherPublicKey:c,assetPair:x,orderType:s,price:r,amount:i,timestamp:l,expiration:f,matcherFee:S,signature:T,version:3};"WAVES"!==k&&(C.matcherFeeAssetId=k);const I=await this.matcherPostMatcherOrderbook(C),M=this.safeValue(I,"message");return this.parseOrder(M,o)}async cancelOrder(e,t,s={}){this.checkRequiredDependencies(),this.checkRequiredKeys(),await this.getAccessToken();const i=await this.getWavesAddress(),r=await this.forwardPostMatcherOrdersWavesAddressCancel({wavesAddress:i,orderId:e}),a=this.safeValue(r,"message"),n=this.safeValue(a,0),o=this.safeValue(n,0);return{info:r,id:this.safeString(o,"orderId"),clientOrderId:void 0,timestamp:void 0,datetime:void 0,lastTradeTimestamp:void 0,symbol:t,type:void 0,side:void 0,price:void 0,amount:void 0,cost:void 0,average:void 0,filled:void 0,remaining:void 0,status:void 0,fee:void 0,trades:void 0}}async fetchOrders(e,t,s,i={}){if(this.checkRequiredDependencies(),this.checkRequiredKeys(),void 0===e)throw new r(this.id+" fetchOrders() requires symbol argument");await this.loadMarkets();const a=this.market(e),n=this.milliseconds(),o=[this.base58ToBinary(this.apiKey),this.numberToBE(n,8)],c=this.binaryConcatArray(o),d=this.binaryToBase16(this.base58ToBinary(this.secret)),h=this.eddsa(this.binaryToBase16(c),d,"ed25519"),u={Accept:"application/json",Timestamp:n.toString(),Signature:h,publicKey:this.apiKey,baseId:a.baseId,quoteId:a.quoteId},l=await this.matcherGetMatcherOrderbookBaseIdQuoteIdPublicKeyPublicKey(this.extend(u,i));return this.parseOrders(l,a,t,s)}async fetchOpenOrders(e,t,s,i={}){let r;await this.loadMarkets(),await this.getAccessToken(),void 0!==e&&(r=this.market(e));const a={address:await this.getWavesAddress(),activeOnly:!0},n=await this.forwardGetMatcherOrdersAddress(a);return this.parseOrders(n,r,t,s)}async fetchClosedOrders(e,t,s,i={}){let r;await this.loadMarkets(),await this.getAccessToken(),void 0!==e&&(r=this.market(e));const a={address:await this.getWavesAddress(),closedOnly:!0},n=await this.forwardGetMatcherOrdersAddress(a);return this.parseOrders(n,r,t,s)}parseOrderStatus(e){return this.safeString({Cancelled:"canceled",Accepted:"open",Filled:"closed",PartiallyFilled:"open"},e,e)}getSymbolFromAssetPair(e){const t=this.safeString(e,"amountAsset","WAVES"),s=this.safeString(e,"priceAsset","WAVES");return this.safeCurrencyCode(t)+"/"+this.safeCurrencyCode(s)}parseOrder(e,t){const s=this.safeInteger(e,"timestamp"),i=this.safeString2(e,"type","orderType");let r="limit";"type"in e&&(r=this.safeString(e,"orderType",r));const a=this.safeString(e,"id");let n=this.safeString(e,"filled"),o=this.safeString(e,"price"),c=this.safeString(e,"amount");const d=this.safeValue(e,"assetPair");let h;void 0!==d?h=this.getSymbolFromAssetPair(d):void 0!==t&&(h=t.symbol);const u=this.safeCurrencyCode(this.safeString(d,"amountAsset","WAVES"));let l,f;o=this.priceFromPrecision(h,o),c=this.currencyFromPrecision(u,c),void 0!==o&&void 0!==c&&(l=o*c),n=this.currencyFromPrecision(u,n),void 0!==n&&void 0!==c&&(f=c-n);const p=this.priceFromPrecision(h,this.safeString(e,"avgWeighedPrice")),m=this.parseOrderStatus(this.safeString(e,"status"));let b;if("type"in e){const t=this.safeCurrencyCode(this.safeString(e,"feeAsset"));b={currency:t,fee:this.currencyFromPrecision(t,this.safeInteger(e,"filledFee"))}}else{const t=this.safeCurrencyCode(this.safeString(e,"matcherFeeAssetId","WAVES"));b={currency:t,fee:this.currencyFromPrecision(t,this.safeInteger(e,"matcherFee"))}}return{info:e,id:a,clientOrderId:void 0,timestamp:s,datetime:this.iso8601(s),lastTradeTimestamp:void 0,symbol:h,type:r,timeInForce:void 0,postOnly:void 0,side:i,price:o,stopPrice:void 0,amount:c,cost:l,average:p,filled:n,remaining:f,status:m,fee:b,trades:void 0}}async getWavesAddress(){const e=this.safeString(this.options,"wavesAddress");if(void 0===e){const e={publicKey:this.apiKey},t=await this.nodeGetAddressesPublicKeyPublicKey(e);return this.options.wavesAddress=this.safeString(t,"address"),this.options.wavesAddress}return e}async fetchBalance(e={}){this.checkRequiredDependencies(),this.checkRequiredKeys(),await this.loadMarkets();const t=await this.getWavesAddress(),s={address:t},i=await this.nodeGetAssetsBalanceAddress(s),r=this.safeValue(i,"balances"),a={};let n;for(let e=0;e<r.length;e++){const t=r[e],s=this.safeInteger(t,"timestamp");n=void 0===n?s:Math.max(n,s);const i=this.safeValue(t,"issueTransaction"),o=this.safeInteger(i,"decimals"),c=this.safeString(t,"assetId"),d=this.safeNumber(t,"balance");let h;c in this.currencies_by_id&&(h=this.safeCurrencyCode(c),a[h]=this.account(),a[h].total=this.fromWei(d,o))}const o=this.milliseconds(),c=[this.base58ToBinary(this.apiKey),this.numberToBE(o,8)],d=this.binaryConcatArray(c),h=this.binaryToBase16(this.base58ToBinary(this.secret)),u=this.eddsa(this.binaryToBase16(d),h,"ed25519"),l={publicKey:this.apiKey,signature:u,timestamp:o.toString()},f=await this.matcherGetMatcherBalanceReservedPublicKey(l),p=Object.keys(f);for(let e=0;e<p.length;e++){const t=p[e],s=this.safeCurrencyCode(t);s in a||(a[s]=this.account());const i=this.safeNumber(f,t);a[s].used=this.currencyFromPrecision(s,i)}const m={address:t},b=await this.nodeGetAddressesBalanceAddress(m);a.WAVES=this.safeValue(a,"WAVES",{}),a.WAVES.total=this.currencyFromPrecision("WAVES",this.safeNumber(b,"balance"));const g=Object.keys(a);for(let e=0;e<g.length;e++){const t=g[e];void 0===this.safeValue(a[t],"used")&&(a[t].used=0)}return a.timestamp=n,a.datetime=this.iso8601(n),this.parseBalance(a)}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={sender:await this.getWavesAddress(),amountAsset:r.baseId,priceAsset:r.quoteId},n=await this.publicGetTransactionsExchange(a),o=this.safeValue(n,"data");return this.parseTrades(o,r,t,s)}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={amountAsset:r.baseId,priceAsset:r.quoteId};void 0!==s&&(a.limit=s),void 0!==t&&(a.timeStart=t);const n=await this.publicGetTransactionsExchange(a),o=this.safeValue(n,"data");return this.parseTrades(o,r,t,s)}parseTrade(e,t){const s=this.safeValue(e,"data"),i=this.safeString(s,"timestamp"),r=this.parse8601(i),a=this.safeString(s,"id"),n=this.safeString(s,"price"),o=this.safeString(s,"amount"),c=this.parseNumber(n),d=this.parseNumber(o),h=this.parseNumber(m.stringMul(n,o)),u=this.safeValue(s,"order1"),l=this.safeValue(s,"order2");let f,p;f=this.safeString(u,"senderPublicKey")===this.apiKey?u:l;const b=this.safeValue(f,"assetPair");void 0!==b?p=this.getSymbolFromAssetPair(b):void 0!==t&&(p=t.symbol);const g=this.safeString(f,"orderType");return{info:e,timestamp:r,datetime:i,symbol:p,id:a,order:this.safeString(f,"id"),type:void 0,side:g,takerOrMaker:void 0,price:c,amount:d,cost:h,fee:{cost:this.safeNumber(s,"fee"),currency:this.safeCurrencyCode(this.safeString(f,"matcherFeeAssetId","WAVES"))}}}handleErrors(e,t,s,i,r,a,n,o,c){const h=this.safeString(n,"error"),u=this.safeValue(n,"success",!0),l=this.safeValue(this.exceptions,h);if(void 0!==l){const e=this.safeString(n,"message");throw new l(this.id+" "+e)}if("Validation Error"===this.safeString(n,"message"))throw new p(this.id+" "+a);if(!u)throw new d(this.id+" "+a)}async withdraw(e,t,s,i,r={}){if("WAVES"!==e){const t=await this.privateGetWithdrawCurrencies(),s={},i=this.safeValue(t,"items",[]);for(let e=0;e<i.length;e++){const t=i[e];s[this.safeString(t,"id")]=!0}if(!(e in s)){const t=Object.keys(s);throw new d(this.id+" fetch "+e+" withdrawals are not supported. Currency code must be one of "+t.toString())}}await this.loadMarkets();const a=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n={};for(let e=0;e<a.length;e++){n[a[e]]=!0}let o=!0;const c=this.remove0xPrefix(s).toLowerCase();for(let e=0;e<c.length;e++){if(!(c[e]in n)){o=!1;break}}let h;if(await this.getAccessToken(),"WAVES"!==e||o){const i={address:s,currency:e},r=await this.privateGetWithdrawAddressesCurrencyAddress(i),a=this.safeValue(r,"currency"),n=this.safeValue(a,"allowed_amount"),o=this.safeNumber(n,"min");if(t<=o)throw new p(this.id+" "+e+" withdraw failed, amount "+t.toString()+" must be greater than the minimum allowed amount of "+o.toString());const c=this.safeValue(r,"proxy_addresses",[]);h=this.safeString(c,0)}else h=s;const u=this.safeInteger(this.options,"withdrawFeeWAVES",1e5),l="WAVES",f=this.currencyToPrecision(e,t),m=this.currency(e),b=this.milliseconds(),g=[this.numberToBE(4,1),this.numberToBE(2,1),this.base58ToBinary(this.apiKey),this.getAssetBytes(m.id),this.getAssetBytes(l),this.numberToBE(b,8),this.numberToBE(f,8),this.numberToBE(u,8),this.base58ToBinary(h),this.numberToBE(0,2)],y=this.binaryConcatArray(g),v=this.binaryToBase16(this.base58ToBinary(this.secret)),w=this.eddsa(this.binaryToBase16(y),v,"ed25519"),k={senderPublicKey:this.apiKey,amount:f,fee:u,type:4,version:2,attachment:"",feeAssetId:this.getAssetId(l),proofs:[w],assetId:this.getAssetId(m.id),recipient:h,timestamp:b,signature:w};return await this.nodePostTransactionsBroadcast(k)}}},390:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeNotAvailable:r,ExchangeError:a,DDoSProtection:n,BadSymbol:o}=s(3449),c=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"whitebit",name:"WhiteBit",version:"v2",countries:["EE"],rateLimit:500,has:{cancelOrder:!1,CORS:!1,createDepositAddress:!1,createLimitOrder:!1,createMarketOrder:!1,createOrder:!1,deposit:!1,editOrder:!1,fetchBalance:!1,fetchBidsAsks:!1,fetchCurrencies:!0,fetchMarkets:!0,fetchOHLCV:!0,fetchOrderBook:!0,fetchStatus:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTradingFees:!0,privateAPI:!1,publicAPI:!0},timeframes:{"1m":"1m","3m":"3m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","2h":"2h","4h":"4h","6h":"6h","8h":"8h","12h":"12h","1d":"1d","3d":"3d","1w":"1w","1M":"1M"},urls:{logo:"https://user-images.githubusercontent.com/1294454/66732963-8eb7dd00-ee66-11e9-849b-10d9282bb9e0.jpg",api:{web:"https://whitebit.com/",publicV2:"https://whitebit.com/api/v2/public",publicV1:"https://whitebit.com/api/v1/public"},www:"https://www.whitebit.com",doc:"https://documenter.getpostman.com/view/7473075/Szzj8dgv?version=latest",fees:"https://whitebit.com/fee-schedule",referral:"https://whitebit.com/referral/d9bdf40e-28f2-4b52-b2f9-cd1415d82963"},api:{web:{get:["v1/healthcheck"]},publicV1:{get:["markets","tickers","ticker","symbols","depth/result","history","kline"]},publicV2:{get:["markets","ticker","assets","fee","depth/{market}","trades/{market}"]}},fees:{trading:{tierBased:!1,percentage:!0,taker:.001,maker:.001}},options:{fetchTradesMethod:"fetchTradesV1"},exceptions:{exact:{503:r},broad:{"Market is not available":o}}})}async fetchMarkets(e={}){const t=await this.publicV2GetMarkets(e),s=this.safeValue(t,"result"),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"name"),a=this.safeString(t,"stock"),n=this.safeString(t,"money"),o=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),d={id:r,symbol:o+"/"+c,base:o,quote:c,baseId:a,quoteId:n,info:t,active:this.safeValue(t,"tradesEnabled"),precision:{amount:this.safeInteger(t,"stockPrec"),price:this.safeInteger(t,"moneyPrec")},limits:{amount:{min:this.safeNumber(t,"minAmount"),max:void 0},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(t,"minTotal"),max:void 0}}};i.push(d)}return i}async fetchCurrencies(e={}){const t=await this.publicV2GetAssets(e),s=this.safeValue(t,"result"),i=Object.keys(s),r={};for(let e=0;e<i.length;e++){const t=i[e],a=s[t],n=this.safeValue(a,"canDeposit",!0),o=this.safeValue(a,"canWithdraw",!0),c=n&&o,d=this.safeCurrencyCode(t);r[d]={id:t,code:d,info:a,name:void 0,active:c,fee:void 0,precision:void 0,limits:{amount:{min:void 0,max:void 0},withdraw:{min:this.safeNumber(a,"minWithdrawal"),max:this.safeNumber(a,"maxWithdrawal")}}}}return r}async fetchTradingFees(e={}){const t=await this.publicV2GetFee(e),s=this.safeValue(t,"result");return{maker:this.safeNumber(s,"makerFee"),taker:this.safeNumber(s,"takerFee")}}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={market:s.id},r=await this.publicV1GetTicker(this.extend(i,t)),a=this.safeValue(r,"result",{});return this.parseTicker(a,s)}parseTicker(e,t){const s=this.safeTimestamp(e,"at",this.milliseconds());let i;e=this.safeValue(e,"ticker",e),void 0!==t&&(i=t.symbol);const r=this.safeNumber(e,"last"),a=this.safeNumber(e,"change");let n;return void 0!==a&&(n=this.numberToString(.01*a)),{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"bid"),bidVolume:void 0,ask:this.safeNumber(e,"ask"),askVolume:void 0,vwap:void 0,open:this.safeNumber(e,"open"),close:r,last:r,previousClose:void 0,change:n,percentage:a,average:void 0,baseVolume:this.safeNumber(e,"volume"),quoteVolume:this.safeNumber(e,"deal"),info:e}}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicV1GetTickers(t),i=this.safeValue(s,"result"),r=Object.keys(i),a={};for(let e=0;e<r.length;e++){const t=r[e],s=this.safeMarket(t),n=this.parseTicker(i[t],s);a[n.symbol]=n}return this.filterByArray(a,"symbol",e)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={market:this.market(e).id};void 0!==t&&(i.limit=t);const r=await this.publicV2GetDepthMarket(this.extend(i,s)),a=this.safeValue(r,"result",{}),n=this.parse8601(this.safeString(a,"lastUpdateTimestamp"));return this.parseOrderBook(a,e,n)}async fetchTradesV1(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={market:r.id,lastId:1};void 0!==s&&(a.limit=s);const n=await this.publicV1GetHistory(this.extend(a,i)),o=this.safeValue(n,"result",[]);return this.parseTrades(o,r,t,s)}async fetchTradesV2(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={market:r.id};void 0!==s&&(a.limit=s);const n=await this.publicV2GetTradesMarket(this.extend(a,i)),o=this.safeValue(n,"result",[]);return this.parseTrades(o,r,t,s)}async fetchTrades(e,t,s,i={}){const r=this.safeString(this.options,"fetchTradesMethod","fetchTradesV2");return await this[r](e,t,s,i)}parseTrade(e,t){let s=this.safeValue(e,"time");s="string"==typeof s?this.parse8601(s):parseInt(1e3*s);const i=this.safeString(e,"price"),r=this.safeString2(e,"amount","volume"),a=this.parseNumber(c.stringMul(i,r)),n=this.parseNumber(i),o=this.parseNumber(r),d=this.safeString2(e,"id","tradeId");let h,u=this.safeString(e,"type");if(void 0===u){u=this.safeValue(e,"isBuyerMaker")?"buy":"sell"}return void 0!==t&&(h=t.symbol),{info:e,timestamp:s,datetime:this.iso8601(s),symbol:h,id:d,order:void 0,type:void 0,takerOrMaker:void 0,side:u,price:n,amount:o,cost:a,fee:void 0}}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={market:a.id,interval:this.timeframes[t]};if(void 0!==s){const e=1440;void 0===i&&(i=e),i=Math.min(i,e);const r=parseInt(s/1e3),a=this.parseTimeframe(t),o=this.sum(r,a*i);n.start=r,n.end=o}void 0!==i&&(n.limit=i);const o=await this.publicV1GetKline(this.extend(n,r)),c=this.safeValue(o,"result",[]);return this.parseOHLCVs(c,a,t,s,i)}parseOHLCV(e,t){return[this.safeTimestamp(e,0),this.safeNumber(e,1),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,2),this.safeNumber(e,5)]}async fetchStatus(e={}){const t=await this.webGetV1Healthcheck(e);let s="ok";return 503===this.safeInteger(t,"status")&&(s="maintenance"),this.status=this.extend(this.status,{status:s,updated:this.milliseconds()}),this.status}sign(e,t="publicV1",s="GET",i={},r,a){const n=this.omit(i,this.extractParams(e));let o=this.urls.api[t]+"/"+this.implodeParams(e,i);return Object.keys(n).length&&(o+="?"+this.urlencode(n)),{url:o,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,o,c,d,h){if(418===e||429===e)throw new n(this.id+" "+e.toString()+" "+t+" "+o);if(404===e)throw new a(this.id+" "+e.toString()+" endpoint not found");if(void 0!==c){if(!this.safeValue(c,"success")){const e=this.id+" "+o,t=this.safeString(c,"status");throw"string"==typeof t&&this.throwExactlyMatchedException(this.exceptions.exact,t,e),this.throwBroadlyMatchedException(this.exceptions.broad,o,e),new a(e)}}}}},9741:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,BadRequest:n,InsufficientFunds:o,InvalidAddress:c,BadSymbol:d,InvalidOrder:h}=s(3449),u=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"xena",name:"Xena Exchange",countries:["VC","UK"],rateLimit:100,certified:!0,has:{CORS:!1,cancelAllOrders:!0,cancelOrder:!0,createDepositAddress:!0,createOrder:!0,editOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDeposits:!0,fetchLedger:!0,fetchMarkets:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrderBook:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchWithdrawals:!0,withdraw:!0},urls:{logo:"https://user-images.githubusercontent.com/51840849/87489843-bb469280-c64c-11ea-91aa-69c6326506af.jpg",test:{public:"https://trading.demo.xena.io/api",private:"https://api.demo.xena.io"},api:{public:"https://trading.xena.exchange/api",private:"https://api.xena.exchange"},www:"https://xena.exchange",doc:"https://support.xena.exchange/support/solutions/44000808700",fees:"https://trading.xena.exchange/en/platform-specification/fee-schedule"},timeframes:{"1m":"1m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","4h":"4h","12h":"12h","1d":"1d","1w":"1w"},api:{public:{get:["common/currencies","common/instruments","common/features","common/commissions","common/news","market-data/candles/{marketId}/{timeframe}","market-data/market-watch","market-data/dom/{symbol}","market-data/candles/{symbol}/{timeframe}","market-data/trades/{symbol}","market-data/server-time","market-data/v2/candles/{symbol}/{timeframe}","market-data/v2/trades/{symbol}","market-data/v2/dom/{symbol}/","market-data/v2/server-time"]},private:{get:["trading/accounts/{accountId}/order","trading/accounts/{accountId}/active-orders","trading/accounts/{accountId}/last-order-statuses","trading/accounts/{accountId}/positions","trading/accounts/{accountId}/positions-history","trading/accounts/{accountId}/margin-requirements","trading/accounts","trading/accounts/{accountId}/balance","trading/accounts/{accountId}/trade-history","transfers/accounts","transfers/accounts/{accountId}","transfers/accounts/{accountId}/deposit-address/{currency}","transfers/accounts/{accountId}/deposits","transfers/accounts/{accountId}/trusted-addresses","transfers/accounts/{accountId}/withdrawals","transfers/accounts/{accountId}/balance-history"],post:["trading/order/new","trading/order/heartbeat","trading/order/cancel","trading/order/mass-cancel","trading/order/replace","trading/position/maintenance","transfers/accounts/{accountId}/withdrawals","transfers/accounts/{accountId}/deposit-address/{currency}"]}},fees:{trading:{maker:5e-4,taker:.001,tierBased:!0,percentage:!0},funding:{tierBased:!1,percentage:!1,withdraw:{},deposit:{}}},exceptions:{exact:{"Validation failed":n,"Unknown derivative symbol":d,"Unknown account":n,"Wrong TransactTime":n,"ClOrdId is empty":n},broad:{"Invalid aggregation ratio or depth":n,address:c,"Money not enough":o,"parse error":n,"Not enough":o}},options:{defaultType:"margin",accountId:void 0}})}async fetchTime(e={}){const t=await this.publicGetMarketDataV2ServerTime(e),s=this.safeInteger(t,"transactTime");return parseInt(s/1e6)}async fetchMarkets(e={}){const t=await this.publicGetCommonInstruments(e),s=[];for(let e=0;e<t.length;e++){const i=t[e];let r=this.safeStringLower(i,"type");const a=this.safeString(i,"symbol"),n=this.safeString(i,"id"),o=this.safeString(i,"marginType"),c=this.safeString(i,"baseCurrency"),d=this.safeString(i,"quoteCurrency"),h=this.safeCurrencyCode(c),u=this.safeCurrencyCode(d);let l=a;"margin"===r&&("XenaFuture"===o?r="future":"XenaListedPerpetual"===o&&(r="swap",l=h+"/"+u));const f="future"===r,p="swap"===r,m={price:this.safeInteger2(i,"tickSize","pricePrecision"),amount:0},b=this.safeNumber(i,"maxOrderQty"),g={amount:{min:void 0,max:void 0},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(i,"minOrderQuantity"),max:b}},y=this.safeValue(i,"enabled",!1),v=this.safeValue(i,"inverse",!1);s.push({id:a,symbol:l,base:h,quote:u,baseId:c,quoteId:d,numericId:n,active:y,type:r,spot:!1,future:f,swap:p,inverse:v,precision:m,limits:g,info:i})}return s}async fetchCurrencies(e={}){const t=await this.publicGetCommonCurrencies(e),s=Object.keys(t),i={};for(let e=0;e<s.length;e++){const r=s[e],a=t[r],n=this.safeCurrencyCode(r),o=this.safeString(a,"title"),c=this.safeInteger(a,"precision"),d=!0===this.safeValue(a,"enabled"),h=this.safeValue(a,"withdraw",{});i[n]={id:r,code:n,info:a,name:o,active:d,fee:this.safeNumber(h,"commission"),precision:c,limits:{amount:{min:void 0,max:void 0},withdraw:{min:this.safeNumber(h,"minAmount"),max:void 0}}}}return i}parseTicker(e,t){const s=this.milliseconds(),i=this.safeString(e,"symbol"),r=this.safeSymbol(i,t),a=this.safeNumber(e,"lastPx"),n=this.safeNumber(e,"firstPx");let o,c,d;void 0!==a&&void 0!==n&&(c=a-n,d=this.sum(a,n)/2,n>0&&(o=c/n*100));const h=this.safeNumber(e,"buyVolume"),u=this.safeNumber(e,"sellVolume"),l=this.sum(h,u);return{symbol:r,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"highPx"),low:this.safeNumber(e,"lowPx"),bid:this.safeNumber(e,"bid"),bidVolume:void 0,ask:this.safeNumber(e,"ask"),askVolume:void 0,vwap:void 0,open:n,close:a,last:a,previousClose:void 0,change:c,percentage:o,average:d,baseVolume:l,quoteVolume:void 0,info:e}}async fetchTicker(e,t={}){await this.loadMarkets();const s=await this.fetchTickers(void 0,t);if(e in s)return s[e];throw new d(this.id+" fetchTicker could not find a ticker with symbol "+e)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetMarketDataMarketWatch(t),i={};for(let e=0;e<s.length;e++){const t=this.parseTicker(s[e]);i[t.symbol]=t}return this.filterByArray(i,"symbol",e)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={symbol:this.marketId(e)};void 0!==t&&(i.depth=t);const r=await this.publicGetMarketDataV2DomSymbol(this.extend(i,s)),a=this.safeValue(r,"mdEntry",[]),n=this.groupBy(a,"mdEntryType"),o=this.safeInteger(r,"lastUpdateTime"),c=parseInt(o/1e6);return this.parseOrderBook(n,e,c,"0","1","mdEntryPx","mdEntrySize")}async fetchAccounts(e={}){const t=await this.privateGetTradingAccounts(e),s=this.safeValue(t,"accounts"),i=[];for(let e=0;e<s.length;e++){const t=s[e],r=this.safeString(t,"id"),a=this.safeString(t,"currency"),n=this.safeCurrencyCode(a),o=this.safeStringLower(t,"kind");i.push({id:r,type:o,currency:n,info:t})}return i}async findAccountByType(e){await this.loadMarkets(),await this.loadAccounts();const t=this.groupBy(this.accounts,"type"),s=this.safeValue(t,e);if(void 0===s)throw new r(this.id+" findAccountByType() could not find an accountId with type '"+e+"', specify the 'accountId' parameter instead");if(s.length>1)throw new r(this.id+" findAccountByType() found more than one accountId with type '"+e+"', specify the 'accountId' parameter instead");return s[0]}async getAccountId(e){await this.loadMarkets(),await this.loadAccounts();const t=this.safeString(this.options,"accountId"),s=this.safeString(e,"accountId",t);if(void 0!==s)return s;const i=this.safeString(this.options,"defaultType","margin"),r=this.safeString(e,"type",i);if(e=this.omit(e,"type"),void 0===r)throw new a(this.id+" requires an 'accountId' parameter or a 'type' parameter ('spot' or 'margin')");return(await this.findAccountByType(r)).id}async fetchBalance(e={}){await this.loadMarkets(),await this.loadAccounts();const t={accountId:await this.getAccountId(e)},s=await this.privateGetTradingAccountsAccountIdBalance(this.extend(t,e)),i={info:s};let r;const a=this.safeValue(s,"balances",[]);for(let e=0;e<a.length;e++){const t=a[e],s=this.safeString(t,"lastUpdateTime").slice(0,13),n=parseInt(s);r=void 0===r?n:Math.max(r,n);const o=this.safeString(t,"currency"),c=this.safeCurrencyCode(o),d=this.account();d.free=this.safeString(t,"available"),d.used=this.safeString(t,"onHold"),i[c]=d}return i.timestamp=r,i.datetime=this.iso8601(r),this.parseBalance(i,!1)}parseTrade(e,t){const s=this.safeString(e,"tradeId");let i=this.safeInteger(e,"transactTime");void 0!==i&&(i=parseInt(i/1e6));let r=this.safeStringLower2(e,"side","aggressorSide");"1"===r?r="buy":"2"===r&&(r="sell");const a=this.safeString(e,"orderId"),n=this.safeString(e,"symbol"),o=this.safeSymbol(n,t),c=this.safeString2(e,"lastPx","mdEntryPx"),d=this.safeString2(e,"lastQty","mdEntrySize"),h=this.parseNumber(c),l=this.parseNumber(d),f=this.parseNumber(u.stringMul(c,d));let p;const m=this.safeNumber(e,"commission");if(void 0!==m){const t=this.safeString(e,"commCurrency"),s=this.safeCurrencyCode(t);p={cost:m,rate:this.safeNumber(e,"commRate"),currency:s}}return{id:s,info:e,timestamp:i,datetime:this.iso8601(i),symbol:o,type:void 0,order:a,side:r,takerOrMaker:void 0,price:h,amount:l,cost:f,fee:p}}async fetchMyTrades(e,t,s,i={}){await this.loadMarkets(),await this.loadAccounts();const r={accountId:await this.getAccountId(i)};let a;void 0!==e&&(a=this.market(e),r.symbol=a.id),void 0!==t&&(r.from=1e6*t),void 0!==s&&(r.limit=s);const n=await this.privateGetTradingAccountsAccountIdTradeHistory(this.extend(r,i));return this.parseTrades(n,a,t,s)}parseOHLCV(e,t){const s=this.safeInteger(e,"transactTime"),i=parseInt(s/1e6),r=this.safeNumber(e,"buyVolume"),a=this.safeNumber(e,"sellVolume"),n=this.sum(r,a);return[i,this.safeNumber(e,"firstPx"),this.safeNumber(e,"highPx"),this.safeNumber(e,"lowPx"),this.safeNumber(e,"lastPx"),n]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e),n={symbol:a.id,timeframe:this.timeframes[t]},o=1e3*this.parseTimeframe(t);if(void 0!==s)n.from=1e6*s,void 0!==i&&(n.to=1e6*this.sum(s,i*o));else{const e=this.milliseconds();void 0!==i&&(n.from=1e6*(e-i*o))}const c=await this.publicGetMarketDataV2CandlesSymbolTimeframe(this.extend(n,r)),d=this.safeValue(c,"mdEntry",[]);return this.parseOHLCVs(d,a,t,s,i)}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={symbol:r.id};void 0!==t&&(a.from=this.iso8601(t)),void 0!==s&&(a.limit=s);const n=await this.publicGetMarketDataV2TradesSymbol(this.extend(a,i)),o=this.safeValue(n,"mdEntry",[]);return this.parseTrades(o,r,t,s)}parseOrderStatus(e){return this.safeString({A:"open",0:"open",1:"open",2:"closed",6:"canceled",4:"canceled",E:"open",8:"rejected"},e,e)}parseOrder(e,t){const s=this.safeString(e,"orderId"),i=this.safeString(e,"clOrdId"),r=this.safeInteger(e,"transactTime"),a=parseInt(r/1e6),n=this.parseOrderStatus(this.safeString(e,"ordStatus")),o=this.safeString(e,"symbol"),c=this.safeSymbol(o,t),d=this.safeNumber(e,"price"),h=this.safeNumber(e,"orderQty"),u=this.safeNumber(e,"cumQty"),l=this.safeNumber(e,"leavesQty");let f=this.safeStringLower(e,"side");"1"===f?f="buy":"1"===f&&(f="sell");let p=this.safeStringLower(e,"ordType");return"1"===p?p="market":"2"===p?p="limit":"3"===p?p="stop":"4"===p&&(p="stop-limit"),this.safeOrder({id:s,clientOrderId:i,info:e,timestamp:a,datetime:this.iso8601(a),lastTradeTimestamp:void 0,symbol:c,type:p,timeInForce:void 0,postOnly:void 0,side:f,price:d,stopPrice:void 0,amount:h,cost:void 0,average:void 0,filled:u,remaining:l,status:n,fee:void 0,trades:void 0})}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets(),await this.loadAccounts();const n=await this.getAccountId(a),o=this.safeString({market:"1",limit:"2",stop:"3","stop-limit":"4"},t);if(void 0===o)throw new h(this.id+" createOrder does not support order type "+t+", supported order types are market, limit, stop, stop-limit");const c=this.safeString({buy:"1",sell:"2"},s);if(void 0===c)throw new h(this.id+" createOrder does not support order side "+s+", supported order sides are buy, sell");const d=this.market(e),u={account:parseInt(n),symbol:d.id,ordType:o,side:c,orderQty:this.amountToPrecision(e,i),transactTime:1e6*this.milliseconds()};if("limit"===t||"stop-limit"===t){if(void 0===r)throw new h(this.id+" createOrder() requires a price argument for order type "+t);u.price=this.priceToPrecision(e,r)}if("stop"===t||"stop-limit"===t){const s=this.safeNumber(a,"stopPx");if(void 0===s)throw new h(this.id+" createOrder() requires a stopPx param for order type "+t);u.stopPx=this.priceToPrecision(e,s),a=this.omit(a,"stopPx")}const l=this.safeString2(a,"clientOrderId","clOrdId",this.uuid());void 0!==l&&(u.clOrdId=l,a=this.omit(a,["clientOrderId","clOrdId"]));const f=await this.privatePostTradingOrderNew(this.extend(u,a));return this.parseOrder(f,d)}async editOrder(e,t,s,i,r,n,o={}){if(void 0===t)throw new a(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets(),await this.loadAccounts();const c=await this.getAccountId(o),d=this.market(t),h={account:parseInt(c),clOrdId:this.uuid(),symbol:d.id,transactTime:1e6*this.milliseconds()},u=this.safeString2(o,"clientOrderId","origClOrdId");void 0!==u?(h.origClOrdId=u,o=this.omit(o,["clientOrderId","origClOrdId"])):h.orderId=e,void 0!==r&&(h.orderQty=this.amountToPrecision(t,r)),void 0!==n&&(h.price=this.priceToPrecision(t,n));const l=this.safeNumber(o,"stopPx");void 0!==l&&(h.stopPx=this.priceToPrecision(t,l),o=this.omit(o,"stopPx"));const f=this.safeNumber(o,"capPrice");void 0!==f&&(h.capPrice=this.priceToPrecision(t,f),o=this.omit(o,"capPrice"));const p=await this.privatePostTradingOrderReplace(this.extend(h,o));return this.parseOrder(p,d)}async cancelOrder(e,t,s={}){if(void 0===t)throw new a(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets(),await this.loadAccounts();const i=await this.getAccountId(s),r=this.safeString2(s,"clientOrderId","origClOrdId");s=this.omit(s,["clientOrderId","origClOrdId"]);const n=this.market(t),o={account:parseInt(i),symbol:n.id,clOrdId:this.uuid(),transactTime:1e6*this.milliseconds()};void 0!==r?o.origClOrdId=r:o.orderId=e;const c=await this.privatePostTradingOrderCancel(this.extend(o,s));return this.parseOrder(c,n)}async cancelAllOrders(e,t={}){await this.loadMarkets(),await this.loadAccounts();const s=await this.getAccountId(t),i={account:parseInt(s),clOrdId:this.uuid()};if(void 0!==e){const t=this.market(e);i.symbol=t.id,i.massCancelRequestType="1"}else i.massCancelRequestType="7";return await this.privatePostTradingOrderMassCancel(this.extend(i,t))}async fetchOpenOrders(e,t,s,i={}){await this.loadMarkets(),await this.loadAccounts();const r={accountId:await this.getAccountId(i)};let a;void 0!==e&&(a=this.market(e),r.symbol=a.id);const n=await this.privateGetTradingAccountsAccountIdActiveOrders(this.extend(r,i));return this.parseOrders(n,a,t,s)}async fetchClosedOrders(e,t,s,i={}){await this.loadMarkets(),await this.loadAccounts();const r={accountId:await this.getAccountId(i)};let a;void 0!==e&&(a=this.market(e),r.symbol=a.id),void 0!==t&&(r.from=1e6*this.iso8601(t)),void 0!==s&&(r.limit=s);const n=await this.privateGetTradingAccountsAccountIdLastOrderStatuses(this.extend(r,i));return this.parseOrders(n,a,t,s)}async createDepositAddress(e,t={}){await this.loadMarkets(),await this.loadAccounts();const s={accountId:await this.getAccountId(t),currency:this.currency(e).id},i=await this.privatePostTransfersAccountsAccountIdDepositAddressCurrency(this.extend(s,t)),r=this.safeValue(i,"address");return this.checkAddress(r),{currency:e,address:r,tag:undefined,info:i}}async fetchDepositAddress(e,t={}){await this.loadMarkets(),await this.loadAccounts();const s={accountId:await this.getAccountId(t),currency:this.currency(e).id},i=await this.privateGetTransfersAccountsAccountIdDepositAddressCurrency(this.extend(s,t)),r=this.safeValue(i,"address");return this.checkAddress(r),{currency:e,address:r,tag:undefined,info:i}}async fetchTransactionsByType(e,t,s,i,r={}){if(void 0===t)throw new a(this.id+" fetchTransactions() requires a currency `code` argument");await this.loadMarkets(),await this.loadAccounts();const n=await this.getAccountId(r),o=this.currency(t),c={currency:o.id,accountId:n};void 0!==s&&(c.since=parseInt(s/1e3));const d="privateGetTransfersAccountsAccountId"+this.capitalize(e),h=await this[d](this.extend(c,r)),u=this.safeValue(h,e,[]);return this.parseTransactions(u,o,s,i)}async fetchWithdrawals(e,t,s,i={}){return await this.fetchTransactionsByType("withdrawals",e,t,s,i)}async fetchDeposits(e,t,s,i={}){return await this.fetchTransactionsByType("deposits",e,t,s,i)}parseTransaction(e,t){const s=this.safeString(e,"withdrawalRequestId"),i=void 0===s?"deposit":"withdrawal";let r=this.safeInteger(e,"lastUpdated");void 0!==r&&(r=parseInt(r/1e6));const a=void 0,n=this.safeString(e,"txId"),o=this.safeString(e,"currency"),c=this.safeCurrencyCode(o,t),d=this.safeString(e,"address"),h=d,u=this.safeNumber(e,"amount"),l=this.parseTransactionStatus(this.safeString(e,"status"));return{info:e,id:s,txid:n,timestamp:a,datetime:this.iso8601(a),addressFrom:undefined,addressTo:h,address:d,tagFrom:void 0,tagTo:void 0,tag:void 0,type:i,amount:u,currency:c,status:l,updated:r,fee:undefined}}parseTransactionStatus(e){return this.safeString({1:"pending",2:"ok",3:"failed",4:"failed",5:"pending",100:"pending",101:"pending",102:"pending",103:"pending"},e,e)}async withdraw(e,t,s,i,r={}){this.checkAddress(s),await this.loadMarkets(),await this.loadAccounts();const a=await this.getAccountId(r),n=this.currency(e);let o=this.uuid();o=o.split("-"),o=o.join("");const c={currency:n.id,accountId:a,amount:this.currencyToPrecision(e,t),address:s,id:o},d=await this.privatePostTransfersAccountsAccountIdWithdrawals(this.extend(c,r));return this.parseTransaction(d,n)}parseLedgerEntryType(e){return this.safeString({deposit:"transaction",withdrawal:"transaction","internal deposit":"transfer","internal withdrawal":"transfer",rebate:"rebate",reward:"reward"},e,e)}parseLedgerEntry(e,t){const s=this.safeString(e,"id");let i;const r=this.safeString(e,"accountId"),a=this.parseLedgerEntryType(this.safeString(e,"kind")),n=this.safeCurrencyCode(this.safeString(e,"currency"),t);let o=this.safeNumber(e,"amount");o<0?(i="out",o=Math.abs(o)):i="in";let c=this.safeInteger(e,"ts");void 0!==c&&(c=parseInt(c/1e6));const d={cost:this.safeNumber(e,"commission"),currency:n};return{info:e,id:s,direction:i,account:r,referenceId:undefined,referenceAccount:undefined,type:a,currency:n,amount:o,before:undefined,after:this.safeNumber(e,"balance"),status:"ok",timestamp:c,datetime:this.iso8601(c),fee:d}}async fetchLedger(e,t,s,i={}){await this.loadMarkets(),await this.loadAccounts();const r={accountId:await this.getAccountId(i)};let a;void 0!==e&&(a=this.currency(e),r.symbol=a.id),void 0!==t&&(r.from=1e6*t),void 0!==s&&(r.limit=s);const n=await this.privateGetTransfersAccountsAccountIdBalanceHistory(this.extend(r,i));return this.parseLedger(n,a,t,s)}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t]+"/"+this.implodeParams(e,i);const o=this.omit(i,this.extractParams(e));if("public"===t)Object.keys(o).length&&(n+="?"+this.urlencode(o));else if("private"===t){this.checkRequiredCredentials();let e=this.nonce();e=e.toString(),e+="000000";const t="AUTH"+e,i=this.secret.slice(14,78),c=this.ecdsa(t,i,"p256","sha256"),d=c.r+c.s;r={"X-AUTH-API-KEY":this.apiKey,"X-AUTH-API-PAYLOAD":t,"X-AUTH-API-SIGNATURE":d,"X-AUTH-API-NONCE":e},"GET"===s?Object.keys(o).length&&(n+="?"+this.urlencode(o)):"POST"===s&&(a=this.json(o),r["Content-Type"]="application/json")}return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0!==o&&e>=400){const e=this.id+" "+this.json(o),t=this.safeString(o,"error"),s=this.exceptions.exact;if(t in s)throw new s[t](e);const i=this.exceptions.broad,a=this.findBroadlyMatchedKey(i,n);if(void 0!==a)throw new i[a](e);throw new r(e)}}}},5927:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,ArgumentsRequired:a,ExchangeNotAvailable:n,InvalidNonce:o,InsufficientFunds:c,OrderNotFound:d,DDoSProtection:h,InvalidOrder:u,AuthenticationError:l,RateLimitExceeded:f}=s(3449),p=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"yobit",name:"YoBit",countries:["RU"],rateLimit:3e3,version:"3",has:{cancelOrder:!0,CORS:!1,createDepositAddress:!0,createMarketOrder:!1,createOrder:!0,fetchBalance:!0,fetchDepositAddress:!0,fetchDeposits:!1,fetchMarkets:!0,fetchMyTrades:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrderBooks:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchTransactions:!1,fetchWithdrawals:!1,withdraw:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/27766910-cdcbfdae-5eea-11e7-9859-03fea873272d.jpg",api:{public:"https://yobit.net/api",private:"https://yobit.net/tapi"},www:"https://www.yobit.net",doc:"https://www.yobit.net/en/api/",fees:"https://www.yobit.net/en/fees/"},api:{public:{get:["depth/{pair}","info","ticker/{pair}","trades/{pair}"]},private:{post:["ActiveOrders","CancelOrder","GetDepositAddress","getInfo","OrderInfo","Trade","TradeHistory","WithdrawCoinsToAddress"]}},fees:{trading:{maker:.002,taker:.002},funding:{withdraw:{}}},commonCurrencies:{AIR:"AirCoin",ANI:"ANICoin",ANT:"AntsCoin",ATMCHA:"ATM",ASN:"Ascension",AST:"Astral",ATM:"Autumncoin",BCC:"BCH",BCS:"BitcoinStake",BITS:"Bitstar",BLN:"Bulleon",BNS:"Benefit Bonus Coin",BOT:"BOTcoin",BON:"BONES",BPC:"BitcoinPremium",BST:"BitStone",BTS:"Bitshares2",CAT:"BitClave",CBC:"CryptoBossCoin",CMT:"CometCoin",COIN:"Coin.com",COV:"Coven Coin",COVX:"COV",CPC:"Capricoin",CREDIT:"Creditbit",CS:"CryptoSpots",DCT:"Discount",DFT:"DraftCoin",DGD:"DarkGoldCoin",DIRT:"DIRTY",DROP:"FaucetCoin",DSH:"DASH",EKO:"EkoCoin",ENTER:"ENTRC",EPC:"ExperienceCoin",ESC:"EdwardSnowden",EUROPE:"EUROP",EXT:"LifeExtension",FUND:"FUNDChains",FUNK:"FUNKCoin",GCC:"GlobalCryptocurrency",GEN:"Genstake",GENE:"Genesiscoin",GOLD:"GoldMint",GOT:"Giotto Coin",GSX:"GlowShares",HTML5:"HTML",HYPERX:"HYPER",ICN:"iCoin",INSANE:"INSN",JNT:"JointCoin",JPC:"JupiterCoin",JWL:"Jewels",KNC:"KingN Coin",LBTCX:"LiteBitcoin",LIZI:"LiZi",LOC:"LocoCoin",LOCX:"LOC",LUNYR:"LUN",LUN:"LunarCoin",LUNA:"Luna Coin",MASK:"Yobit MASK",MDT:"Midnight",MIS:"MIScoin",NAV:"NavajoCoin",NBT:"NiceBytes",OMG:"OMGame",ONX:"Onix",PAC:"$PAC",PLAY:"PlayCoin",PIVX:"Darknet",PRS:"PRE",PUTIN:"PutinCoin",STK:"StakeCoin",SUB:"Subscriptio",PAY:"EPAY",PLC:"Platin Coin",RAI:"RaiderCoin",RCN:"RCoin",REP:"Republicoin",RUR:"RUB",SBTC:"Super Bitcoin",TTC:"TittieCoin",UNI:"Universe",UST:"Uservice",VOL:"VolumeCoin",XIN:"XINCoin",XRA:"Ratecoin"},options:{fetchOrdersRequiresSymbol:!0,fetchTickersMaxLength:512},exceptions:{exact:{803:u,804:u,805:u,806:u,807:u,831:c,832:c,833:d},broad:{"Invalid pair name":r,"invalid api key":l,"invalid sign":l,"api key dont have trade permission":l,"invalid parameter":u,"invalid order":u,"The given order has already been cancelled":u,"Requests too often":h,"not available":n,"data unavailable":n,"external service unavailable":n,"Total transaction amount":u,"The given order has already been closed and cannot be cancelled":u,"Insufficient funds":c,"invalid key":l,"invalid nonce":o,"Total order amount is less than minimal amount":u,"Rate Limited":f}},orders:{}})}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostGetInfo(e),s=this.safeValue(t,"return",{}),i=this.safeInteger(s,"server_time"),r={info:t,timestamp:i,datetime:this.iso8601(i)},a=this.safeValue(s,"funds",{}),n=this.safeValue(s,"funds_incl_orders",{}),o=Object.keys(this.extend(a,n));for(let e=0;e<o.length;e++){const t=o[e],s=this.safeCurrencyCode(t),i=this.account();i.free=this.safeString(a,t),i.total=this.safeString(n,t),r[s]=i}return this.parseBalance(r,!1)}async fetchMarkets(e={}){const t=await this.publicGetInfo(e),s=this.safeValue(t,"pairs"),i=Object.keys(s),r=[];for(let e=0;e<i.length;e++){const t=i[e],a=s[t],[n,o]=t.split("_");let c=n.toUpperCase(),d=o.toUpperCase();c=this.safeCurrencyCode(c),d=this.safeCurrencyCode(d);const h=c+"/"+d,u={amount:this.safeInteger(a,"decimal_places"),price:this.safeInteger(a,"decimal_places")},l={amount:{min:this.safeNumber(a,"min_amount"),max:this.safeNumber(a,"max_amount")},price:{min:this.safeNumber(a,"min_price"),max:this.safeNumber(a,"max_price")},cost:{min:this.safeNumber(a,"min_total")}},f=0===this.safeInteger(a,"hidden");let m=this.safeString(a,"fee");m=p.stringDiv(m,"100");const b=this.parseNumber(m),g=this.parseNumber(m);r.push({id:t,symbol:h,base:c,quote:d,baseId:n,quoteId:o,active:f,taker:b,maker:g,precision:u,limits:l,info:a})}return r}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i=this.market(e),a={pair:i.id};void 0!==t&&(a.limit=t);const n=await this.publicGetDepthPair(this.extend(a,s));if(!(i.id in n))throw new r(this.id+" "+i.symbol+" order book is empty or not available");const o=n[i.id];return this.parseOrderBook(o,e)}async fetchOrderBooks(e,t,s={}){let i;if(await this.loadMarkets(),void 0===e){if(i=this.ids.join("-"),i.length>2048){const e=this.ids.length;throw new r(this.id+" has "+e.toString()+" symbols exceeding max URL length, you are required to specify a list of symbols in the first argument to fetchOrderBooks")}}else i=this.marketIds(e),i=i.join("-");const a={pair:i};void 0!==t&&(a.limit=t);const n=await this.publicGetDepthPair(this.extend(a,s)),o={};i=Object.keys(n);for(let e=0;e<i.length;e++){const t=i[e];o[this.safeSymbol(t)]=this.parseOrderBook(n[t])}return o}parseTicker(e,t){const s=this.safeTimestamp(e,"updated");let i;void 0!==t&&(i=t.symbol);const r=this.safeNumber(e,"last");return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"buy"),bidVolume:void 0,ask:this.safeNumber(e,"sell"),askVolume:void 0,vwap:void 0,open:void 0,close:r,last:r,previousClose:void 0,change:void 0,percentage:void 0,average:this.safeNumber(e,"avg"),baseVolume:this.safeNumber(e,"vol_cur"),quoteVolume:this.safeNumber(e,"vol"),info:e}}async fetchTickers(e,t={}){await this.loadMarkets();let s=this.ids;if(void 0===e){const e=s.length;s=s.join("-");const t=this.safeInteger(this.options,"fetchTickersMaxLength",2048);if(s.length>this.options.fetchTickersMaxLength)throw new a(this.id+" has "+e.toString()+" markets exceeding max URL length for this endpoint ("+t.toString()+" characters), please, specify a list of symbols of interest in the first argument to fetchTickers")}else s=this.marketIds(e),s=s.join("-");const i={pair:s},r=await this.publicGetTickerPair(this.extend(i,t)),n={},o=Object.keys(r);for(let e=0;e<o.length;e++){const t=o[e],s=r[t],i=this.safeMarket(t);n[i.symbol]=this.parseTicker(s,i)}return this.filterByArray(n,"symbol",e)}async fetchTicker(e,t={}){return(await this.fetchTickers([e],t))[e]}parseTrade(e,t){const s=this.safeTimestamp(e,"timestamp");let i=this.safeString(e,"type");"ask"===i?i="sell":"bid"===i&&(i="buy");const r=this.safeString2(e,"rate","price"),a=this.safeString2(e,"trade_id","tid"),n=this.safeString(e,"order_id"),o=this.safeString(e,"pair"),c=this.safeSymbol(o,t),d=this.safeString(e,"amount"),h=this.parseNumber(p.stringMul(r,d)),u=this.parseNumber(r),l=this.parseNumber(d),f="limit";let m;const b=this.safeNumber(e,"commission");if(void 0!==b){const t=this.safeString(e,"commissionCurrency");m={cost:b,currency:this.safeCurrencyCode(t)}}return void 0!==this.safeValue(e,"is_your_order")&&void 0===m&&(m=this.calculateFee(c,f,i,l,u,"taker")),{id:a,order:n,timestamp:s,datetime:this.iso8601(s),symbol:c,type:f,side:i,takerOrMaker:void 0,price:u,amount:l,cost:h,fee:m,info:e}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={pair:r.id};void 0!==s&&(a.limit=s);const n=await this.publicGetTradesPair(this.extend(a,i));if(Array.isArray(n)){if(0===n.length)return[]}return this.parseTrades(n[r.id],r,t,s)}async createOrder(e,t,s,i,a,n={}){if("market"===t)throw new r(this.id+" allows limit orders only");await this.loadMarkets();const o={pair:this.market(e).id,type:s,amount:this.amountToPrecision(e,i),rate:this.priceToPrecision(e,a)};a=parseFloat(a),i=parseFloat(i);const c=await this.privatePostTrade(this.extend(o,n));let d,h="open",u=0,l=i;"return"in c&&(d=this.safeString(c.return,"order_id"),"0"===d&&(d=this.safeString(c.return,"init_order_id"),h="closed"),u=this.safeNumber(c.return,"received",0),l=this.safeNumber(c.return,"remains",i));const f=this.milliseconds();return{id:d,timestamp:f,datetime:this.iso8601(f),lastTradeTimestamp:void 0,status:h,symbol:e,type:t,side:s,price:a,cost:a*u,amount:i,remaining:l,filled:u,fee:void 0,info:c,clientOrderId:void 0,average:void 0,trades:void 0}}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={order_id:parseInt(e)};return await this.privatePostCancelOrder(this.extend(i,s))}parseOrderStatus(e){return this.safeString({0:"open",1:"closed",2:"canceled",3:"open"},e,e)}parseOrder(e,t){const s=this.safeString(e,"id"),i=this.parseOrderStatus(this.safeString(e,"status")),r=this.safeTimestamp(e,"timestamp_created"),a=this.safeString(e,"pair"),n=this.safeSymbol(a,t),o=this.safeNumber(e,"amount"),c=this.safeNumber(e,"start_amount"),d=this.safeNumber(e,"rate"),h=this.safeString(e,"type");return this.safeOrder({info:e,id:s,clientOrderId:void 0,symbol:n,timestamp:r,datetime:this.iso8601(r),lastTradeTimestamp:void 0,type:"limit",timeInForce:void 0,postOnly:void 0,side:h,price:d,stopPrice:void 0,cost:void 0,amount:c,remaining:o,filled:void 0,status:i,fee:undefined,average:void 0,trades:void 0})}async fetchOrder(e,t,s={}){await this.loadMarkets();const i={order_id:parseInt(e)},r=await this.privatePostOrderInfo(this.extend(i,s));e=e.toString();const a=this.safeValue(r,"return",{});return this.parseOrder(this.extend({id:e},a[e]))}async fetchOpenOrders(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchOpenOrders() requires a symbol argument");await this.loadMarkets();const r={};if(void 0!==e){const t=this.market(e);r.pair=t.id}const n=await this.privatePostActiveOrders(this.extend(r,i)),o=this.safeValue(n,"return",[]);return this.parseOrders(o,undefined,t,s)}async fetchMyTrades(e,t,s,i={}){if(void 0===e)throw new a(this.id+" fetchMyTrades() requires a `symbol` argument");await this.loadMarkets();const r=this.market(e),n={pair:r.id};void 0!==s&&(n.count=parseInt(s)),void 0!==t&&(n.since=parseInt(t/1e3));const o=await this.privatePostTradeHistory(this.extend(n,i)),c=this.safeValue(o,"return",{}),d=Object.keys(c),h=[];for(let e=0;e<d.length;e++){const t=d[e],s=this.parseTrade(this.extend(c[t],{trade_id:t}),r);h.push(s)}return this.filterBySymbolSinceLimit(h,e,t,s)}async createDepositAddress(e,t={}){const s=await this.fetchDepositAddress(e,this.extend({need_new:1},t)),i=this.safeString(s,"address");return this.checkAddress(i),{currency:e,address:i,tag:void 0,info:s.info}}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s={coinName:this.currency(e).id,need_new:0},i=await this.privatePostGetDepositAddress(this.extend(s,t)),r=this.safeString(i.return,"address");return this.checkAddress(r),{currency:e,address:r,tag:void 0,info:i}}async withdraw(e,t,s,i,a={}){this.checkAddress(s),await this.loadMarkets();const n={coinName:this.currency(e).id,amount:t,address:s};if(void 0!==i)throw new r(this.id+" withdraw() does not support the tag argument yet due to a lack of docs on withdrawing with tag/memo on behalf of the exchange.");return{info:await this.privatePostWithdrawCoinsToAddress(this.extend(n,a)),id:void 0}}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t];const o=this.omit(i,this.extractParams(e));if("private"===t){this.checkRequiredCredentials();const t=this.nonce();a=this.urlencode(this.extend({nonce:t,method:e},o));const s=this.hmac(this.encode(a),this.encode(this.secret),"sha512");r={"Content-Type":"application/x-www-form-urlencoded",Key:this.apiKey,Sign:s}}else"public"===t?(n+="/"+this.version+"/"+this.implodeParams(e,i),Object.keys(o).length&&(n+="?"+this.urlencode(o))):(n+="/"+this.implodeParams(e,i),"GET"===s?Object.keys(o).length&&(n+="?"+this.urlencode(o)):Object.keys(o).length&&(a=this.json(o),r={"Content-Type":"application/json"}));return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0!==o&&"success"in o){let e=this.safeValue(o,"success",!1);if("string"==typeof e&&(e="true"===e||"1"===e),!e){const e=this.safeString(o,"code"),t=this.safeString(o,"error"),s=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,e,s),this.throwExactlyMatchedException(this.exceptions.exact,t,s),this.throwBroadlyMatchedException(this.exceptions.broad,t,s),new r(s)}}}}},4422:(e,t,s)=>{"use strict";const i=s(8819),{ExchangeError:r,BadRequest:a}=s(3449),n=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"zaif",name:"Zaif",countries:["JP"],rateLimit:2e3,version:"1",has:{cancelOrder:!0,CORS:!1,createMarketOrder:!1,createOrder:!0,fetchBalance:!0,fetchClosedOrders:!0,fetchMarkets:!0,fetchOrderBook:!0,fetchOpenOrders:!0,fetchTicker:!0,fetchTrades:!0,withdraw:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/27766927-39ca2ada-5eeb-11e7-972f-1b4199518ca6.jpg",api:"https://api.zaif.jp",www:"https://zaif.jp",doc:["https://techbureau-api-document.readthedocs.io/ja/latest/index.html","https://corp.zaif.jp/api-docs","https://corp.zaif.jp/api-docs/api_links","https://www.npmjs.com/package/zaif.jp","https://github.com/you21979/node-zaif"],fees:"https://zaif.jp/fee?lang=en"},fees:{trading:{percentage:!0,taker:.001,maker:0}},api:{public:{get:["depth/{pair}","currencies/{pair}","currencies/all","currency_pairs/{pair}","currency_pairs/all","last_price/{pair}","ticker/{pair}","trades/{pair}"]},private:{post:["active_orders","cancel_order","deposit_history","get_id_info","get_info","get_info2","get_personal_info","trade","trade_history","withdraw","withdraw_history"]},ecapi:{post:["createInvoice","getInvoice","getInvoiceIdsByOrderNumber","cancelInvoice"]},tlapi:{post:["get_positions","position_history","active_positions","create_position","change_position","cancel_position"]},fapi:{get:["groups/{group_id}","last_price/{group_id}/{pair}","ticker/{group_id}/{pair}","trades/{group_id}/{pair}","depth/{group_id}/{pair}"]}},options:{fees:{"BTC/JPY":{maker:0,taker:0},"BCH/JPY":{maker:0,taker:.003},"BCH/BTC":{maker:0,taker:.003},"PEPECASH/JPY":{maker:0,taker:1e-4},"PEPECASH/BT":{maker:0,taker:1e-4}}},exceptions:{exact:{"unsupported currency_pair":a},broad:{}}})}async fetchMarkets(e={}){const t=await this.publicGetCurrencyPairsAll(e),s=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"currency_pair"),a=this.safeString(i,"name"),[n,o]=a.split("/"),c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o),h=c+"/"+d,u={amount:-Math.log10(this.safeNumber(i,"item_unit_step")),price:this.safeInteger(i,"aux_unit_point")},l=this.safeValue(this.options.fees,h,this.fees.trading),f=l.taker,p=l.maker;s.push({id:r,symbol:h,base:c,quote:d,baseId:n,quoteId:o,active:!0,precision:u,taker:f,maker:p,limits:{amount:{min:this.safeNumber(i,"item_unit_min"),max:void 0},price:{min:this.safeNumber(i,"aux_unit_min"),max:void 0},cost:{min:void 0,max:void 0}},info:i})}return s}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privatePostGetInfo(e),s=this.safeValue(t,"return",{}),i=this.safeValue(s,"deposit"),r={info:t,timestamp:void 0,datetime:void 0},a=this.safeValue(s,"funds",{}),n=Object.keys(a);for(let e=0;e<n.length;e++){const t=n[e],s=this.safeCurrencyCode(t),o=this.safeString(a,t),c=this.account();c.free=o,c.total=o,void 0!==i&&t in i&&(c.total=this.safeString(i,t)),r[s]=c}return this.parseBalance(r,!1)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={pair:this.marketId(e)},r=await this.publicGetDepthPair(this.extend(i,s));return this.parseOrderBook(r,e)}async fetchTicker(e,t={}){await this.loadMarkets();const s={pair:this.marketId(e)},i=await this.publicGetTickerPair(this.extend(s,t)),r=this.milliseconds(),a=this.safeNumber(i,"vwap"),n=this.safeNumber(i,"volume");let o;void 0!==n&&void 0!==a&&(o=n*a);const c=this.safeNumber(i,"last");return{symbol:e,timestamp:r,datetime:this.iso8601(r),high:this.safeNumber(i,"high"),low:this.safeNumber(i,"low"),bid:this.safeNumber(i,"bid"),bidVolume:void 0,ask:this.safeNumber(i,"ask"),askVolume:void 0,vwap:a,open:void 0,close:c,last:c,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:n,quoteVolume:o,info:i}}parseTrade(e,t){let s=this.safeString(e,"trade_type");s="bid"===s?"buy":"sell";const i=this.safeTimestamp(e,"date"),r=this.safeString2(e,"id","tid"),a=this.safeString(e,"price"),o=this.safeString(e,"amount"),c=this.parseNumber(a),d=this.parseNumber(o),h=this.parseNumber(n.stringMul(a,o)),u=this.safeString(e,"currency_pair"),l=this.safeSymbol(u,t,"_");return{id:r,info:e,timestamp:i,datetime:this.iso8601(i),symbol:l,type:void 0,side:s,order:void 0,takerOrMaker:void 0,price:c,amount:d,cost:h,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={pair:r.id};let n=await this.publicGetTradesPair(this.extend(a,i));if(1===n.length){const e=n[0];Object.keys(e).length||(n=[])}return this.parseTrades(n,r,t,s)}async createOrder(e,t,s,i,a,n={}){if(await this.loadMarkets(),"limit"!==t)throw new r(this.id+" allows limit orders only");const o={currency_pair:this.marketId(e),action:"buy"===s?"bid":"ask",amount:i,price:a},c=await this.privatePostTrade(this.extend(o,n));return{info:c,id:c.return.order_id.toString()}}async cancelOrder(e,t,s={}){const i={order_id:e};return await this.privatePostCancelOrder(this.extend(i,s))}parseOrder(e,t){let s=this.safeString(e,"action");s="bid"===s?"buy":"sell";const i=this.safeTimestamp(e,"timestamp"),r=this.safeString(e,"currency_pair"),a=this.safeSymbol(r,t,"_"),n=this.safeNumber(e,"price"),o=this.safeNumber(e,"amount"),c=this.safeString(e,"id");return this.safeOrder({id:c,clientOrderId:void 0,timestamp:i,datetime:this.iso8601(i),lastTradeTimestamp:void 0,status:"open",symbol:a,type:"limit",timeInForce:void 0,postOnly:void 0,side:s,price:n,stopPrice:void 0,cost:void 0,amount:o,filled:void 0,remaining:void 0,trades:void 0,fee:void 0,info:e,average:void 0})}async fetchOpenOrders(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.market(e),a.currency_pair=r.id);const n=await this.privatePostActiveOrders(this.extend(a,i));return this.parseOrders(n.return,r,t,s)}async fetchClosedOrders(e,t,s,i={}){let r;await this.loadMarkets();const a={};void 0!==e&&(r=this.market(e),a.currency_pair=r.id);const n=await this.privatePostTradeHistory(this.extend(a,i));return this.parseOrders(n.return,r,t,s)}async withdraw(e,t,s,i,a={}){this.checkAddress(s),await this.loadMarkets();const n=this.currency(e);if("JPY"===e)throw new r(this.id+" withdraw() does not allow "+e+" withdrawals");const o={currency:n.id,amount:t,address:s};void 0!==i&&(o.message=i);const c=await this.privatePostWithdraw(this.extend(o,a));return{info:c,id:c.return.txid,fee:c.return.fee}}nonce(){return parseFloat(this.milliseconds()/1e3).toFixed(8)}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api+"/";if("public"===t)n+="api/"+this.version+"/"+this.implodeParams(e,i);else if("fapi"===t)n+="fapi/"+this.version+"/"+this.implodeParams(e,i);else{this.checkRequiredCredentials(),n+="ecapi"===t?"ecapi":"tlapi"===t?"tlapi":"tapi";const s=this.nonce();a=this.urlencode(this.extend({method:e,nonce:s},i)),r={"Content-Type":"application/x-www-form-urlencoded",Key:this.apiKey,Sign:this.hmac(this.encode(a),this.encode(this.secret),"sha512")}}return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,a,n,o,c,d){if(void 0===o)return;const h=this.id+" "+n,u=this.safeString(o,"error");if(void 0!==u)throw this.throwExactlyMatchedException(this.exceptions.exact,u,h),this.throwBroadlyMatchedException(this.exceptions.broad,u,h),new r(h);if(!this.safeValue(o,"success",!0))throw new r(h)}}},927:(e,t,s)=>{"use strict";const i=s(8819),{BadRequest:r,ExchangeError:a,ArgumentsRequired:n,AuthenticationError:o,InsufficientFunds:c,OrderNotFound:d,ExchangeNotAvailable:h,RateLimitExceeded:u,PermissionDenied:l,InvalidOrder:f,InvalidAddress:p,OnMaintenance:m,RequestTimeout:b,AccountSuspended:g}=s(3449),y=s(6832);e.exports=class extends i{describe(){return this.deepExtend(super.describe(),{id:"zb",name:"ZB",countries:["CN"],rateLimit:100,version:"v1",certified:!0,pro:!0,has:{cancelOrder:!0,CORS:!1,createMarketOrder:!1,createOrder:!0,fetchBalance:!0,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDepositAddresses:!0,fetchDeposits:!0,fetchMarkets:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchClosedOrders:!0,fetchTicker:!0,fetchTickers:!0,fetchTrades:!0,fetchWithdrawals:!0,withdraw:!0},timeframes:{"1m":"1min","3m":"3min","5m":"5min","15m":"15min","30m":"30min","1h":"1hour","2h":"2hour","4h":"4hour","6h":"6hour","12h":"12hour","1d":"1day","3d":"3day","1w":"1week"},exceptions:{ws:{1001:a,1002:a,1003:o,1004:o,1005:o,1006:l,1007:a,1009:m,1010:h,1012:l,1013:a,1014:a,2001:c,2002:c,2003:c,2005:c,2006:c,2007:c,2008:c,2009:c,3001:d,3002:f,3003:f,3004:o,3005:r,3006:l,3007:b,3008:a,3009:f,3010:l,3011:f,3012:f,4001:g,4002:u},exact:{1001:a,1002:a,1003:o,1004:o,1005:o,1006:o,1009:h,1010:h,1012:l,1013:a,1014:a,2001:c,2002:c,2003:c,2005:c,2006:c,2007:c,2008:c,2009:c,3001:d,3002:f,3003:f,3004:o,3005:r,3006:o,3007:o,3008:d,3009:f,3010:l,3011:f,3012:f,4001:h,4002:u},broad:{"提币地址有误，请先添加提币地址。":p}},urls:{logo:"https://user-images.githubusercontent.com/1294454/32859187-cd5214f0-ca5e-11e7-967d-96568e2e2bd1.jpg",api:{public:"https://api.zb.today/data",private:"https://trade.zb.today/api",trade:"https://trade.zb.today/api"},www:"https://www.zb.com",doc:"https://www.zb.com/i/developer",fees:"https://www.zb.com/i/rate",referral:{url:"https://www.zbex.club/en/register?ref=4301lera",discount:.16}},api:{trade:{get:["getFeeInfo"]},public:{get:["markets","ticker","allTicker","depth","trades","kline","getGroupMarkets"]},private:{get:["order","orderMoreV2","cancelOrder","getOrder","getOrders","getOrdersNew","getOrdersIgnoreTradeType","getUnfinishedOrdersIgnoreTradeType","getFinishedAndPartialOrders","getAccountInfo","getUserAddress","getPayinAddress","getWithdrawAddress","getWithdrawRecord","getChargeRecord","getCnyWithdrawRecord","getCnyChargeRecord","withdraw","addSubUser","getSubUserList","doTransferFunds","createSubUserKey","getLeverAssetsInfo","getLeverBills","transferInLever","transferOutLever","loan","cancelLoan","getLoans","getLoanRecords","borrow","autoBorrow","repay","doAllRepay","getRepayments","getFinanceRecords","changeInvestMark","changeLoop","getCrossAssets","getCrossBills","transferInCross","transferOutCross","doCrossLoan","doCrossRepay","getCrossRepayRecords"]}},fees:{funding:{withdraw:{BTC:1e-4,BCH:6e-4,LTC:.005,ETH:.01,ETC:.01,BTS:3,EOS:1,QTUM:.01,HSR:.001,XRP:.1,USDT:"0.1%",QCASH:5,DASH:.002,BCD:0,UBTC:0,SBTC:0,INK:20,TV:.1,BTH:0,BCX:0,LBTC:0,CHAT:20,bitCNY:20,HLC:20,BTP:0,BCW:0}},trading:{maker:.002,taker:.002}},commonCurrencies:{ANG:"Anagram",ENT:"ENTCash"}})}async fetchMarkets(e={}){const t=await this.publicGetMarkets(e),s=Object.keys(t),i=[];for(let e=0;e<s.length;e++){const r=s[e],a=t[r],[n,o]=r.split("_"),c=this.safeCurrencyCode(n),d=this.safeCurrencyCode(o),h=c+"/"+d,u=this.safeString(a,"amountScale"),l=this.safeString(a,"priceScale"),f=this.parsePrecision(u),p=this.parsePrecision(l),m={amount:parseInt(u),price:parseInt(l)};i.push({id:r,symbol:h,baseId:n,quoteId:o,base:c,quote:d,active:!0,precision:m,limits:{amount:{min:this.parseNumber(f),max:void 0},price:{min:this.parseNumber(p),max:void 0},cost:{min:0,max:void 0}},info:a})}return i}async fetchCurrencies(e={}){const t=await this.tradeGetGetFeeInfo(e),s=this.safeValue(t,"result",{}),i=Object.keys(s),r={};for(let e=0;e<i.length;e++){const t=i[e],a=s[t],n=this.safeCurrencyCode(t),o=void 0;let c=!0,d=!0;const h={};for(let e=0;e<a.length;e++){const t=a[e],s=this.safeString(t,"chainName"),i=this.safeNumber(t,"fee"),r=this.safeValue(t,"canDeposit"),n=this.safeValue(t,"canWithdraw");d=d||r,c=c||n,h[s]=i}const u=c&&d;r[n]={id:t,name:void 0,code:n,precision:o,info:a,active:u,fee:void 0,fees:h,limits:this.limits}}return r}async fetchBalance(e={}){await this.loadMarkets();const t=await this.privateGetGetAccountInfo(e),s=this.safeValue(t.result,"coins"),i={info:t,timestamp:void 0,datetime:void 0};for(let e=0;e<s.length;e++){const t=s[e],r=this.account(),a=this.safeString(t,"key"),n=this.safeCurrencyCode(a);r.free=this.safeString(t,"available"),r.used=this.safeString(t,"freez"),i[n]=r}return this.parseBalance(i,!1)}parseDepositAddress(e,t){let s,i=this.safeString2(e,"key","address");const r=this.safeString(e,"memo");if(void 0!==r)s=r;else if(i.indexOf("_")>=0){const e=i.split("_");i=e[0],s=e[1]}const a=this.safeString(e,"blockChain");return{currency:this.safeCurrencyCode(a,t),address:i,tag:s,info:e}}async fetchDepositAddresses(e,t={}){await this.loadMarkets();const s=await this.privateGetGetPayinAddress(t),i=this.safeValue(s,"message",{}),r=this.safeValue(i,"datas",[]);return this.parseDepositAddresses(r,e)}async fetchDepositAddress(e,t={}){await this.loadMarkets();const s=this.currency(e),i={currency:s.id},r=await this.privateGetGetUserAddress(this.extend(i,t)),a=this.safeValue(r,"message",{}),n=this.safeValue(a,"datas",{});return this.parseDepositAddress(n,s)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();const i={market:this.market(e).id};void 0!==t&&(i.size=t);const r=await this.publicGetDepth(this.extend(i,s));return this.parseOrderBook(r,e)}async fetchTickers(e,t={}){await this.loadMarkets();const s=await this.publicGetAllTicker(t),i={},r={},a=Object.keys(this.markets_by_id);for(let e=0;e<a.length;e++){r[a[e].replace("_","")]=this.markets_by_id[a[e]]}const n=Object.keys(s);for(let e=0;e<n.length;e++){const t=r[n[e]];i[t.symbol]=this.parseTicker(s[n[e]],t)}return this.filterByArray(i,"symbol",e)}async fetchTicker(e,t={}){await this.loadMarkets();const s=this.market(e),i={market:s.id},r=await this.publicGetTicker(this.extend(i,t)),a=this.safeValue(r,"ticker",{});return a.date=this.safeValue(r,"date"),this.parseTicker(a,s)}parseTicker(e,t){const s=this.safeInteger(e,"date",this.milliseconds());let i;void 0!==t&&(i=t.symbol);const r=this.safeNumber(e,"last");return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeNumber(e,"high"),low:this.safeNumber(e,"low"),bid:this.safeNumber(e,"buy"),bidVolume:void 0,ask:this.safeNumber(e,"sell"),askVolume:void 0,vwap:void 0,open:void 0,close:r,last:r,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeNumber(e,"vol"),quoteVolume:void 0,info:e}}parseOHLCV(e,t){return[this.safeInteger(e,0),this.safeNumber(e,1),this.safeNumber(e,2),this.safeNumber(e,3),this.safeNumber(e,4),this.safeNumber(e,5)]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();const a=this.market(e);void 0===i&&(i=1e3);const n={market:a.id,type:this.timeframes[t],limit:i};void 0!==s&&(n.since=s);const o=await this.publicGetKline(this.extend(n,r)),c=this.safeValue(o,"data",[]);return this.parseOHLCVs(c,a,t,s,i)}parseTrade(e,t){const s=this.safeTimestamp(e,"date");let i=this.safeString(e,"trade_type");i="bid"===i?"buy":"sell";const r=this.safeString(e,"tid"),a=this.safeString(e,"price"),n=this.safeString(e,"amount"),o=y.stringMul(a,n),c=this.parseNumber(a),d=this.parseNumber(n),h=this.parseNumber(o);let u;return void 0!==t&&(u=t.symbol),{info:e,id:r,timestamp:s,datetime:this.iso8601(s),symbol:u,type:void 0,side:i,order:void 0,takerOrMaker:void 0,price:c,amount:d,cost:h,fee:void 0}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();const r=this.market(e),a={market:r.id},n=await this.publicGetTrades(this.extend(a,i));return this.parseTrades(n,r,t,s)}async createOrder(e,t,s,i,r,a={}){if("limit"!==t)throw new f(this.id+" allows limit orders only");await this.loadMarkets();const n={price:this.priceToPrecision(e,r),amount:this.amountToPrecision(e,i),tradeType:"buy"===s?"1":"0",currency:this.marketId(e)},o=await this.privateGetOrder(this.extend(n,a));return{info:o,id:o.id}}async cancelOrder(e,t,s={}){await this.loadMarkets();const i={id:e.toString(),currency:this.marketId(t)};return await this.privateGetCancelOrder(this.extend(i,s))}async fetchOrder(e,t,s={}){if(void 0===t)throw new n(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const i={id:e.toString(),currency:this.marketId(t)},r=await this.privateGetGetOrder(this.extend(i,s));return this.parseOrder(r,void 0)}async fetchOrders(e,t,s=50,i={}){if(void 0===e)throw new n(this.id+"fetchOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a={currency:r.id,pageIndex:1,pageSize:s};let o,c="privateGetGetOrdersIgnoreTradeType";"tradeType"in i&&(c="privateGetGetOrdersNew");try{o=await this[c](this.extend(a,i))}catch(e){if(e instanceof d)return[];throw e}return this.parseOrders(o,r,t,s)}async fetchClosedOrders(e,t,s,i={}){if(void 0===e)throw new n(this.id+"fetchClosedOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a={currency:r.id,pageIndex:1,pageSize:10},o=await this.privateGetGetFinishedAndPartialOrders(this.extend(a,i));return this.parseOrders(o,r,t,s)}async fetchOpenOrders(e,t,s=10,i={}){if(void 0===e)throw new n(this.id+"fetchOpenOrders() requires a symbol argument");await this.loadMarkets();const r=this.market(e),a={currency:r.id,pageIndex:1,pageSize:s};let o,c="privateGetGetUnfinishedOrdersIgnoreTradeType";"tradeType"in i&&(c="privateGetGetOrdersNew");try{o=await this[c](this.extend(a,i))}catch(e){if(e instanceof d)return[];throw e}return this.parseOrders(o,r,t,s)}parseOrder(e,t){let s=this.safeInteger(e,"type");s=1===s?"buy":"sell";const i=this.safeInteger(e,"trade_date"),r=this.safeString(e,"currency"),a=this.safeSymbol(r,t,"_"),n=this.safeNumber(e,"price"),o=this.safeNumber(e,"trade_amount"),c=this.safeNumber(e,"total_amount"),d=this.safeNumber(e,"trade_money"),h=this.parseOrderStatus(this.safeString(e,"status")),u=this.safeString(e,"id"),l=this.safeNumber(e,"fees");let f;if(void 0!==l){let i;!0===this.safeValue(e,"useZbFee")?i="ZB":void 0!==t&&(i="sell"===s?t.quote:t.base),f={cost:l,currency:i}}return this.safeOrder({info:e,id:u,clientOrderId:void 0,timestamp:i,datetime:this.iso8601(i),lastTradeTimestamp:void 0,symbol:a,type:"limit",timeInForce:void 0,postOnly:void 0,side:s,price:n,stopPrice:void 0,average:void 0,cost:d,amount:c,filled:o,remaining:void 0,status:h,fee:f,trades:void 0})}parseOrderStatus(e){return this.safeString({0:"open",1:"canceled",2:"closed",3:"open"},e,e)}parseTransactionStatus(e){return this.safeString({0:"pending",1:"failed",2:"ok",3:"canceled",5:"ok"},e,e)}parseTransaction(e,t){const s=this.safeString(e,"id"),i=this.safeString(e,"hash"),r=this.safeNumber(e,"amount");let a=this.parse8601(this.safeString(e,"submit_time"));a=this.safeInteger(e,"submitTime",a);let n,o=this.safeString2(e,"toAddress","address");if(void 0!==o){const e=o.split("_");o=this.safeString(e,0),n=this.safeString(e,1)}const c=this.safeInteger(e,"confirmTimes"),d=this.safeInteger(e,"manageTime");let h;const u=this.safeString(e,"currency"),l=this.safeCurrencyCode(u,t);void 0!==o&&(h=void 0===c?"withdrawal":"deposit");const f=this.parseTransactionStatus(this.safeString(e,"status"));let p;const m=this.safeNumber(e,"fees");return void 0!==m&&(p={cost:m,currency:l}),{info:e,id:s,txid:i,timestamp:a,datetime:this.iso8601(a),addressFrom:void 0,address:o,addressTo:o,tagFrom:void 0,tag:n,tagTo:n,type:h,amount:r,currency:l,status:f,updated:d,fee:p}}async withdraw(e,t,s,i,r={}){const a=this.safeString(r,"safePwd",this.password);if(void 0===a)throw new n(this.id+" withdraw() requires exchange.password or a safePwd parameter");const o=this.safeNumber(r,"fees");if(void 0===o)throw new n(this.id+" withdraw() requires a fees parameter");this.checkAddress(s),await this.loadMarkets();const c=this.currency(e);void 0!==i&&(s+="_"+i);const d={amount:this.currencyToPrecision(e,t),currency:c.id,fees:this.currencyToPrecision(e,o),method:"withdraw",receiveAddr:s,safePwd:a},h=await this.privateGetWithdraw(this.extend(d,r)),u=this.parseTransaction(h,c);return this.extend(u,{type:"withdrawal",address:s,addressTo:s,amount:t})}async fetchWithdrawals(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.currency=a.id),void 0!==s&&(r.pageSize=s);const n=await this.privateGetGetWithdrawRecord(this.extend(r,i)),o=this.safeValue(n,"message",{}),c=this.safeValue(o,"datas",{}),d=this.safeValue(c,"list",[]);return this.parseTransactions(d,a,t,s)}async fetchDeposits(e,t,s,i={}){await this.loadMarkets();const r={};let a;void 0!==e&&(a=this.currency(e),r.currency=a.id),void 0!==s&&(r.pageSize=s);const n=await this.privateGetGetChargeRecord(this.extend(r,i)),o=this.safeValue(n,"message",{}),c=this.safeValue(o,"datas",{}),d=this.safeValue(c,"list",[]);return this.parseTransactions(d,a,t,s)}nonce(){return this.milliseconds()}sign(e,t="public",s="GET",i={},r,a){let n=this.urls.api[t];if("public"===t)n+="/"+this.version+"/"+e,Object.keys(i).length&&(n+="?"+this.urlencode(i));else if("trade"===t)n+="/"+e,Object.keys(i).length&&(n+="?"+this.urlencode(i));else{let t=this.keysort(this.extend({method:e,accesskey:this.apiKey},i));const s=this.nonce();t=this.keysort(t);const r=this.rawencode(t),a=this.hash(this.encode(this.secret),"sha1");n+="/"+e+"?"+r+"&"+("sign="+this.hmac(this.encode(r),this.encode(a),"md5")+"&reqTime="+s.toString())}return{url:n,method:s,body:a,headers:r}}handleErrors(e,t,s,i,r,n,o,c,d){if(void 0!==o&&"{"===n[0]){const e=this.id+" "+n;if(this.throwBroadlyMatchedException(this.exceptions.broad,n,e),"code"in o){const t=this.safeString(o,"code");if(this.throwExactlyMatchedException(this.exceptions.exact,t,e),"1000"!==t)throw new a(e)}const t=this.safeValue(o,"result");if(void 0!==t&&!t){throw"服务端忙碌"===this.safeString(o,"message")?new h(e):new a(e)}}}}},7567:e=>{"use strict";e.exports=JSON.parse('{"O_RDONLY":0,"O_WRONLY":1,"O_RDWR":2,"S_IFMT":61440,"S_IFREG":32768,"S_IFDIR":16384,"S_IFCHR":8192,"S_IFBLK":24576,"S_IFIFO":4096,"S_IFLNK":40960,"S_IFSOCK":49152,"O_CREAT":512,"O_EXCL":2048,"O_NOCTTY":131072,"O_TRUNC":1024,"O_APPEND":8,"O_DIRECTORY":1048576,"O_NOFOLLOW":256,"O_SYNC":128,"O_SYMLINK":2097152,"O_NONBLOCK":4,"S_IRWXU":448,"S_IRUSR":256,"S_IWUSR":128,"S_IXUSR":64,"S_IRWXG":56,"S_IRGRP":32,"S_IWGRP":16,"S_IXGRP":8,"S_IRWXO":7,"S_IROTH":4,"S_IWOTH":2,"S_IXOTH":1,"E2BIG":7,"EACCES":13,"EADDRINUSE":48,"EADDRNOTAVAIL":49,"EAFNOSUPPORT":47,"EAGAIN":35,"EALREADY":37,"EBADF":9,"EBADMSG":94,"EBUSY":16,"ECANCELED":89,"ECHILD":10,"ECONNABORTED":53,"ECONNREFUSED":61,"ECONNRESET":54,"EDEADLK":11,"EDESTADDRREQ":39,"EDOM":33,"EDQUOT":69,"EEXIST":17,"EFAULT":14,"EFBIG":27,"EHOSTUNREACH":65,"EIDRM":90,"EILSEQ":92,"EINPROGRESS":36,"EINTR":4,"EINVAL":22,"EIO":5,"EISCONN":56,"EISDIR":21,"ELOOP":62,"EMFILE":24,"EMLINK":31,"EMSGSIZE":40,"EMULTIHOP":95,"ENAMETOOLONG":63,"ENETDOWN":50,"ENETRESET":52,"ENETUNREACH":51,"ENFILE":23,"ENOBUFS":55,"ENODATA":96,"ENODEV":19,"ENOENT":2,"ENOEXEC":8,"ENOLCK":77,"ENOLINK":97,"ENOMEM":12,"ENOMSG":91,"ENOPROTOOPT":42,"ENOSPC":28,"ENOSR":98,"ENOSTR":99,"ENOSYS":78,"ENOTCONN":57,"ENOTDIR":20,"ENOTEMPTY":66,"ENOTSOCK":38,"ENOTSUP":45,"ENOTTY":25,"ENXIO":6,"EOPNOTSUPP":102,"EOVERFLOW":84,"EPERM":1,"EPIPE":32,"EPROTO":100,"EPROTONOSUPPORT":43,"EPROTOTYPE":41,"ERANGE":34,"EROFS":30,"ESPIPE":29,"ESRCH":3,"ESTALE":70,"ETIME":101,"ETIMEDOUT":60,"ETXTBSY":26,"EWOULDBLOCK":35,"EXDEV":18,"SIGHUP":1,"SIGINT":2,"SIGQUIT":3,"SIGILL":4,"SIGTRAP":5,"SIGABRT":6,"SIGIOT":6,"SIGBUS":10,"SIGFPE":8,"SIGKILL":9,"SIGUSR1":30,"SIGSEGV":11,"SIGUSR2":31,"SIGPIPE":13,"SIGALRM":14,"SIGTERM":15,"SIGCHLD":20,"SIGCONT":19,"SIGSTOP":17,"SIGTSTP":18,"SIGTTIN":21,"SIGTTOU":22,"SIGURG":16,"SIGXCPU":24,"SIGXFSZ":25,"SIGVTALRM":26,"SIGPROF":27,"SIGWINCH":28,"SIGIO":23,"SIGSYS":12,"SSL_OP_ALL":2147486719,"SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION":262144,"SSL_OP_CIPHER_SERVER_PREFERENCE":4194304,"SSL_OP_CISCO_ANYCONNECT":32768,"SSL_OP_COOKIE_EXCHANGE":8192,"SSL_OP_CRYPTOPRO_TLSEXT_BUG":2147483648,"SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS":2048,"SSL_OP_EPHEMERAL_RSA":0,"SSL_OP_LEGACY_SERVER_CONNECT":4,"SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER":32,"SSL_OP_MICROSOFT_SESS_ID_BUG":1,"SSL_OP_MSIE_SSLV2_RSA_PADDING":0,"SSL_OP_NETSCAPE_CA_DN_BUG":536870912,"SSL_OP_NETSCAPE_CHALLENGE_BUG":2,"SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG":1073741824,"SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG":8,"SSL_OP_NO_COMPRESSION":131072,"SSL_OP_NO_QUERY_MTU":4096,"SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION":65536,"SSL_OP_NO_SSLv2":16777216,"SSL_OP_NO_SSLv3":33554432,"SSL_OP_NO_TICKET":16384,"SSL_OP_NO_TLSv1":67108864,"SSL_OP_NO_TLSv1_1":268435456,"SSL_OP_NO_TLSv1_2":134217728,"SSL_OP_PKCS1_CHECK_1":0,"SSL_OP_PKCS1_CHECK_2":0,"SSL_OP_SINGLE_DH_USE":1048576,"SSL_OP_SINGLE_ECDH_USE":524288,"SSL_OP_SSLEAY_080_CLIENT_DH_BUG":128,"SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG":0,"SSL_OP_TLS_BLOCK_PADDING_BUG":512,"SSL_OP_TLS_D5_BUG":256,"SSL_OP_TLS_ROLLBACK_BUG":8388608,"ENGINE_METHOD_DSA":2,"ENGINE_METHOD_DH":4,"ENGINE_METHOD_RAND":8,"ENGINE_METHOD_ECDH":16,"ENGINE_METHOD_ECDSA":32,"ENGINE_METHOD_CIPHERS":64,"ENGINE_METHOD_DIGESTS":128,"ENGINE_METHOD_STORE":256,"ENGINE_METHOD_PKEY_METHS":512,"ENGINE_METHOD_PKEY_ASN1_METHS":1024,"ENGINE_METHOD_ALL":65535,"ENGINE_METHOD_NONE":0,"DH_CHECK_P_NOT_SAFE_PRIME":2,"DH_CHECK_P_NOT_PRIME":1,"DH_UNABLE_TO_CHECK_GENERATOR":4,"DH_NOT_SUITABLE_GENERATOR":8,"NPN_ENABLED":1,"RSA_PKCS1_PADDING":1,"RSA_SSLV23_PADDING":2,"RSA_NO_PADDING":3,"RSA_PKCS1_OAEP_PADDING":4,"RSA_X931_PADDING":5,"RSA_PKCS1_PSS_PADDING":6,"POINT_CONVERSION_COMPRESSED":2,"POINT_CONVERSION_UNCOMPRESSED":4,"POINT_CONVERSION_HYBRID":6,"F_OK":0,"R_OK":4,"W_OK":2,"X_OK":1,"UV_UDP_REUSEADDR":4}')},6497:(e,t,s)=>{var i=s(8764).Buffer;function r(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===r(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===r(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===r(e)},t.isError=function(e){return"[object Error]"===r(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=i.isBuffer},7187:e=>{"use strict";var t,s="object"==typeof Reflect?Reflect:null,i=s&&"function"==typeof s.apply?s.apply:function(e,t,s){return Function.prototype.apply.call(e,t,s)};t=s&&"function"==typeof s.ownKeys?s.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(s,i){function r(s){e.removeListener(t,a),i(s)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",r),s([].slice.call(arguments))}m(e,t,a,{once:!0}),"error"!==t&&function(e,t,s){"function"==typeof e.on&&m(e,"error",t,s)}(e,r,{once:!0})}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var n=10;function o(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function d(e,t,s,i){var r,a,n,d;if(o(s),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,s.listener?s.listener:s),a=e._events),n=a[t]),void 0===n)n=a[t]=s,++e._eventsCount;else if("function"==typeof n?n=a[t]=i?[s,n]:[n,s]:i?n.unshift(s):n.push(s),(r=c(e))>0&&n.length>r&&!n.warned){n.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+n.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=n.length,d=h,console&&console.warn&&console.warn(d)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,s){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:s},r=h.bind(i);return r.listener=s,i.wrapFn=r,r}function l(e,t,s){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?s?[r.listener||r]:[r]:s?function(e){for(var t=new Array(e.length),s=0;s<t.length;++s)t[s]=e[s].listener||e[s];return t}(r):p(r,r.length)}function f(e){var t=this._events;if(void 0!==t){var s=t[e];if("function"==typeof s)return 1;if(void 0!==s)return s.length}return 0}function p(e,t){for(var s=new Array(t),i=0;i<t;++i)s[i]=e[i];return s}function m(e,t,s,i){if("function"==typeof e.on)i.once?e.once(t,s):e.on(t,s);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(a){i.once&&e.removeEventListener(t,r),s(a)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return n},set:function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");n=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(e){for(var t=[],s=1;s<arguments.length;s++)t.push(arguments[s]);var r="error"===e,a=this._events;if(void 0!==a)r=r&&void 0===a.error;else if(!r)return!1;if(r){var n;if(t.length>0&&(n=t[0]),n instanceof Error)throw n;var o=new Error("Unhandled error."+(n?" ("+n.message+")":""));throw o.context=n,o}var c=a[e];if(void 0===c)return!1;if("function"==typeof c)i(c,this,t);else{var d=c.length,h=p(c,d);for(s=0;s<d;++s)i(h[s],this,t)}return!0},a.prototype.addListener=function(e,t){return d(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return d(this,e,t,!0)},a.prototype.once=function(e,t){return o(t),this.on(e,u(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return o(t),this.prependListener(e,u(this,e,t)),this},a.prototype.removeListener=function(e,t){var s,i,r,a,n;if(o(t),void 0===(i=this._events))return this;if(void 0===(s=i[e]))return this;if(s===t||s.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,s.listener||t));else if("function"!=typeof s){for(r=-1,a=s.length-1;a>=0;a--)if(s[a]===t||s[a].listener===t){n=s[a].listener,r=a;break}if(r<0)return this;0===r?s.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(s,r),1===s.length&&(i[e]=s[0]),void 0!==i.removeListener&&this.emit("removeListener",e,n||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,s,i;if(void 0===(s=this._events))return this;if(void 0===s.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==s[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete s[e]),this;if(0===arguments.length){var r,a=Object.keys(s);for(i=0;i<a.length;++i)"removeListener"!==(r=a[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=s[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},a.prototype.listeners=function(e){return l(this,e,!0)},a.prototype.rawListeners=function(e){return l(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},a.prototype.listenerCount=f,a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},9267:(e,t,s)=>{var i=s(8501),r=s(8575),a=e.exports;for(var n in i)i.hasOwnProperty(n)&&(a[n]=i[n]);function o(e){if("string"==typeof e&&(e=r.parse(e)),e.protocol||(e.protocol="https:"),"https:"!==e.protocol)throw new Error('Protocol "'+e.protocol+'" not supported. Expected "https:"');return e}a.request=function(e,t){return e=o(e),i.request.call(this,e,t)},a.get=function(e,t){return e=o(e),i.get.call(this,e,t)}},645:(e,t)=>{t.read=function(e,t,s,i,r){var a,n,o=8*r-i-1,c=(1<<o)-1,d=c>>1,h=-7,u=s?r-1:0,l=s?-1:1,f=e[t+u];for(u+=l,a=f&(1<<-h)-1,f>>=-h,h+=o;h>0;a=256*a+e[t+u],u+=l,h-=8);for(n=a&(1<<-h)-1,a>>=-h,h+=i;h>0;n=256*n+e[t+u],u+=l,h-=8);if(0===a)a=1-d;else{if(a===c)return n?NaN:1/0*(f?-1:1);n+=Math.pow(2,i),a-=d}return(f?-1:1)*n*Math.pow(2,a-i)},t.write=function(e,t,s,i,r,a){var n,o,c,d=8*a-r-1,h=(1<<d)-1,u=h>>1,l=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:a-1,p=i?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,n=h):(n=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-n))<1&&(n--,c*=2),(t+=n+u>=1?l/c:l*Math.pow(2,1-u))*c>=2&&(n++,c/=2),n+u>=h?(o=0,n=h):n+u>=1?(o=(t*c-1)*Math.pow(2,r),n+=u):(o=t*Math.pow(2,u-1)*Math.pow(2,r),n=0));r>=8;e[s+f]=255&o,f+=p,o/=256,r-=8);for(n=n<<r|o,d+=r;d>0;e[s+f]=255&n,f+=p,n/=256,d-=8);e[s+f-p]|=128*m}},5717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var s=function(){};s.prototype=t.prototype,e.prototype=new s,e.prototype.constructor=e}}},5826:e=>{var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},7418:e=>{"use strict";var t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function r(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},s=0;s<10;s++)t["_"+String.fromCharCode(s)]=s;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(e){i[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(e){return!1}}()?Object.assign:function(e,a){for(var n,o,c=r(e),d=1;d<arguments.length;d++){for(var h in n=Object(arguments[d]))s.call(n,h)&&(c[h]=n[h]);if(t){o=t(n);for(var u=0;u<o.length;u++)i.call(n,o[u])&&(c[o[u]]=n[o[u]])}}return c}},4236:(e,t)=>{"use strict";var s="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var s=t.shift();if(s){if("object"!=typeof s)throw new TypeError(s+"must be non-object");for(var r in s)i(s,r)&&(e[r]=s[r])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,s,i,r){if(t.subarray&&e.subarray)e.set(t.subarray(s,s+i),r);else for(var a=0;a<i;a++)e[r+a]=t[s+a]},flattenChunks:function(e){var t,s,i,r,a,n;for(i=0,t=0,s=e.length;t<s;t++)i+=e[t].length;for(n=new Uint8Array(i),r=0,t=0,s=e.length;t<s;t++)a=e[t],n.set(a,r),r+=a.length;return n}},a={arraySet:function(e,t,s,i,r){for(var a=0;a<i;a++)e[r+a]=t[s+a]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,r)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,a))},t.setTyped(s)},6069:e=>{"use strict";e.exports=function(e,t,s,i){for(var r=65535&e|0,a=e>>>16&65535|0,n=0;0!==s;){s-=n=s>2e3?2e3:s;do{a=a+(r=r+t[i++]|0)|0}while(--n);r%=65521,a%=65521}return r|a<<16|0}},1619:e=>{"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},2869:e=>{"use strict";var t=function(){for(var e,t=[],s=0;s<256;s++){e=s;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[s]=e}return t}();e.exports=function(e,s,i,r){var a=t,n=r+i;e^=-1;for(var o=r;o<n;o++)e=e>>>8^a[255&(e^s[o])];return-1^e}},405:(e,t,s)=>{"use strict";var i,r=s(4236),a=s(342),n=s(6069),o=s(2869),c=s(8898),d=-2,h=258,u=262,l=103,f=113,p=666;function m(e,t){return e.msg=c[t],t}function b(e){return(e<<1)-(e>4?9:0)}function g(e){for(var t=e.length;--t>=0;)e[t]=0}function y(e){var t=e.state,s=t.pending;s>e.avail_out&&(s=e.avail_out),0!==s&&(r.arraySet(e.output,t.pending_buf,t.pending_out,s,e.next_out),e.next_out+=s,t.pending_out+=s,e.total_out+=s,e.avail_out-=s,t.pending-=s,0===t.pending&&(t.pending_out=0))}function v(e,t){a._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,y(e.strm)}function w(e,t){e.pending_buf[e.pending++]=t}function k(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function S(e,t){var s,i,r=e.max_chain_length,a=e.strstart,n=e.prev_length,o=e.nice_match,c=e.strstart>e.w_size-u?e.strstart-(e.w_size-u):0,d=e.window,l=e.w_mask,f=e.prev,p=e.strstart+h,m=d[a+n-1],b=d[a+n];e.prev_length>=e.good_match&&(r>>=2),o>e.lookahead&&(o=e.lookahead);do{if(d[(s=t)+n]===b&&d[s+n-1]===m&&d[s]===d[a]&&d[++s]===d[a+1]){a+=2,s++;do{}while(d[++a]===d[++s]&&d[++a]===d[++s]&&d[++a]===d[++s]&&d[++a]===d[++s]&&d[++a]===d[++s]&&d[++a]===d[++s]&&d[++a]===d[++s]&&d[++a]===d[++s]&&a<p);if(i=h-(p-a),a=p-h,i>n){if(e.match_start=t,n=i,i>=o)break;m=d[a+n-1],b=d[a+n]}}}while((t=f[t&l])>c&&0!=--r);return n<=e.lookahead?n:e.lookahead}function _(e){var t,s,i,a,c,d,h,l,f,p,m=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=m+(m-u)){r.arraySet(e.window,e.window,m,m,0),e.match_start-=m,e.strstart-=m,e.block_start-=m,t=s=e.hash_size;do{i=e.head[--t],e.head[t]=i>=m?i-m:0}while(--s);t=s=m;do{i=e.prev[--t],e.prev[t]=i>=m?i-m:0}while(--s);a+=m}if(0===e.strm.avail_in)break;if(d=e.strm,h=e.window,l=e.strstart+e.lookahead,f=a,p=void 0,(p=d.avail_in)>f&&(p=f),s=0===p?0:(d.avail_in-=p,r.arraySet(h,d.input,d.next_in,p,l),1===d.state.wrap?d.adler=n(d.adler,h,p,l):2===d.state.wrap&&(d.adler=o(d.adler,h,p,l)),d.next_in+=p,d.total_in+=p,p),e.lookahead+=s,e.lookahead+e.insert>=3)for(c=e.strstart-e.insert,e.ins_h=e.window[c],e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+3-1])&e.hash_mask,e.prev[c&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=c,c++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<u&&0!==e.strm.avail_in)}function O(e,t){for(var s,i;;){if(e.lookahead<u){if(_(e),e.lookahead<u&&0===t)return 1;if(0===e.lookahead)break}if(s=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==s&&e.strstart-s<=e.w_size-u&&(e.match_length=S(e,s)),e.match_length>=3)if(i=a._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(v(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(v(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(v(e,!1),0===e.strm.avail_out)?1:2}function T(e,t){for(var s,i,r;;){if(e.lookahead<u){if(_(e),e.lookahead<u&&0===t)return 1;if(0===e.lookahead)break}if(s=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==s&&e.prev_length<e.max_lazy_match&&e.strstart-s<=e.w_size-u&&(e.match_length=S(e,s),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-3,i=a._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(v(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((i=a._tr_tally(e,0,e.window[e.strstart-1]))&&v(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=a._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(v(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(v(e,!1),0===e.strm.avail_out)?1:2}function x(e,t,s,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=s,this.max_chain=i,this.func=r}function C(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(1146),this.dyn_dtree=new r.Buf16(122),this.bl_tree=new r.Buf16(78),g(this.dyn_ltree),g(this.dyn_dtree),g(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(16),this.heap=new r.Buf16(573),g(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(573),g(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function I(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:f,e.adler=2===t.wrap?0:1,t.last_flush=0,a._tr_init(t),0):m(e,d)}function M(e){var t,s=I(e);return 0===s&&((t=e.state).window_size=2*t.w_size,g(t.head),t.max_lazy_match=i[t.level].max_lazy,t.good_match=i[t.level].good_length,t.nice_match=i[t.level].nice_length,t.max_chain_length=i[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),s}function N(e,t,s,i,a,n){if(!e)return d;var o=1;if(-1===t&&(t=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),a<1||a>9||8!==s||i<8||i>15||t<0||t>9||n<0||n>4)return m(e,d);8===i&&(i=9);var c=new C;return e.state=c,c.strm=e,c.wrap=o,c.gzhead=null,c.w_bits=i,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=a+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+3-1)/3),c.window=new r.Buf8(2*c.w_size),c.head=new r.Buf16(c.hash_size),c.prev=new r.Buf16(c.w_size),c.lit_bufsize=1<<a+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new r.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=n,c.method=s,M(e)}i=[new x(0,0,0,0,(function(e,t){var s=65535;for(s>e.pending_buf_size-5&&(s=e.pending_buf_size-5);;){if(e.lookahead<=1){if(_(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+s;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,v(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-u&&(v(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(v(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(v(e,!1),e.strm.avail_out),1)})),new x(4,4,8,4,O),new x(4,5,16,8,O),new x(4,6,32,32,O),new x(4,4,16,16,T),new x(8,16,32,32,T),new x(8,16,128,128,T),new x(8,32,128,256,T),new x(32,128,258,1024,T),new x(32,258,258,4096,T)],t.deflateInit=function(e,t){return N(e,t,8,15,8,0)},t.deflateInit2=N,t.deflateReset=M,t.deflateResetKeep=I,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?d:(e.state.gzhead=t,0):d},t.deflate=function(e,t){var s,r,n,c;if(!e||!e.state||t>5||t<0)return e?m(e,d):d;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||r.status===p&&4!==t)return m(e,0===e.avail_out?-5:d);if(r.strm=e,s=r.last_flush,r.last_flush=t,42===r.status)if(2===r.wrap)e.adler=0,w(r,31),w(r,139),w(r,8),r.gzhead?(w(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),w(r,255&r.gzhead.time),w(r,r.gzhead.time>>8&255),w(r,r.gzhead.time>>16&255),w(r,r.gzhead.time>>24&255),w(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),w(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(w(r,255&r.gzhead.extra.length),w(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=o(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(w(r,0),w(r,0),w(r,0),w(r,0),w(r,0),w(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),w(r,3),r.status=f);else{var u=8+(r.w_bits-8<<4)<<8;u|=(r.strategy>=2||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(u|=32),u+=31-u%31,r.status=f,k(r,u),0!==r.strstart&&(k(r,e.adler>>>16),k(r,65535&e.adler)),e.adler=1}if(69===r.status)if(r.gzhead.extra){for(n=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>n&&(e.adler=o(e.adler,r.pending_buf,r.pending-n,n)),y(e),n=r.pending,r.pending!==r.pending_buf_size));)w(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>n&&(e.adler=o(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(e.adler=o(e.adler,r.pending_buf,r.pending-n,n)),y(e),n=r.pending,r.pending===r.pending_buf_size)){c=1;break}c=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,w(r,c)}while(0!==c);r.gzhead.hcrc&&r.pending>n&&(e.adler=o(e.adler,r.pending_buf,r.pending-n,n)),0===c&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(e.adler=o(e.adler,r.pending_buf,r.pending-n,n)),y(e),n=r.pending,r.pending===r.pending_buf_size)){c=1;break}c=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,w(r,c)}while(0!==c);r.gzhead.hcrc&&r.pending>n&&(e.adler=o(e.adler,r.pending_buf,r.pending-n,n)),0===c&&(r.status=l)}else r.status=l;if(r.status===l&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&y(e),r.pending+2<=r.pending_buf_size&&(w(r,255&e.adler),w(r,e.adler>>8&255),e.adler=0,r.status=f)):r.status=f),0!==r.pending){if(y(e),0===e.avail_out)return r.last_flush=-1,0}else if(0===e.avail_in&&b(t)<=b(s)&&4!==t)return m(e,-5);if(r.status===p&&0!==e.avail_in)return m(e,-5);if(0!==e.avail_in||0!==r.lookahead||0!==t&&r.status!==p){var S=2===r.strategy?function(e,t){for(var s;;){if(0===e.lookahead&&(_(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,s=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,s&&(v(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(v(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(v(e,!1),0===e.strm.avail_out)?1:2}(r,t):3===r.strategy?function(e,t){for(var s,i,r,n,o=e.window;;){if(e.lookahead<=h){if(_(e),e.lookahead<=h&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=o[r=e.strstart-1])===o[++r]&&i===o[++r]&&i===o[++r]){n=e.strstart+h;do{}while(i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<n);e.match_length=h-(n-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(s=a._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(s=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),s&&(v(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(v(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(v(e,!1),0===e.strm.avail_out)?1:2}(r,t):i[r.level].func(r,t);if(3!==S&&4!==S||(r.status=p),1===S||3===S)return 0===e.avail_out&&(r.last_flush=-1),0;if(2===S&&(1===t?a._tr_align(r):5!==t&&(a._tr_stored_block(r,0,0,!1),3===t&&(g(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),y(e),0===e.avail_out))return r.last_flush=-1,0}return 4!==t?0:r.wrap<=0?1:(2===r.wrap?(w(r,255&e.adler),w(r,e.adler>>8&255),w(r,e.adler>>16&255),w(r,e.adler>>24&255),w(r,255&e.total_in),w(r,e.total_in>>8&255),w(r,e.total_in>>16&255),w(r,e.total_in>>24&255)):(k(r,e.adler>>>16),k(r,65535&e.adler)),y(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?0:1)},t.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&t!==l&&t!==f&&t!==p?m(e,d):(e.state=null,t===f?m(e,-3):0):d},t.deflateSetDictionary=function(e,t){var s,i,a,o,c,h,u,l,f=t.length;if(!e||!e.state)return d;if(2===(o=(s=e.state).wrap)||1===o&&42!==s.status||s.lookahead)return d;for(1===o&&(e.adler=n(e.adler,t,f,0)),s.wrap=0,f>=s.w_size&&(0===o&&(g(s.head),s.strstart=0,s.block_start=0,s.insert=0),l=new r.Buf8(s.w_size),r.arraySet(l,t,f-s.w_size,s.w_size,0),t=l,f=s.w_size),c=e.avail_in,h=e.next_in,u=e.input,e.avail_in=f,e.next_in=0,e.input=t,_(s);s.lookahead>=3;){i=s.strstart,a=s.lookahead-2;do{s.ins_h=(s.ins_h<<s.hash_shift^s.window[i+3-1])&s.hash_mask,s.prev[i&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=i,i++}while(--a);s.strstart=i,s.lookahead=2,_(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=2,s.match_available=0,e.next_in=h,e.input=u,e.avail_in=c,s.wrap=o,0},t.deflateInfo="pako deflate (from Nodeca project)"},4264:e=>{"use strict";e.exports=function(e,t){var s,i,r,a,n,o,c,d,h,u,l,f,p,m,b,g,y,v,w,k,S,_,O,T,x;s=e.state,i=e.next_in,T=e.input,r=i+(e.avail_in-5),a=e.next_out,x=e.output,n=a-(t-e.avail_out),o=a+(e.avail_out-257),c=s.dmax,d=s.wsize,h=s.whave,u=s.wnext,l=s.window,f=s.hold,p=s.bits,m=s.lencode,b=s.distcode,g=(1<<s.lenbits)-1,y=(1<<s.distbits)-1;e:do{p<15&&(f+=T[i++]<<p,p+=8,f+=T[i++]<<p,p+=8),v=m[f&g];t:for(;;){if(f>>>=w=v>>>24,p-=w,0===(w=v>>>16&255))x[a++]=65535&v;else{if(!(16&w)){if(0==(64&w)){v=m[(65535&v)+(f&(1<<w)-1)];continue t}if(32&w){s.mode=12;break e}e.msg="invalid literal/length code",s.mode=30;break e}k=65535&v,(w&=15)&&(p<w&&(f+=T[i++]<<p,p+=8),k+=f&(1<<w)-1,f>>>=w,p-=w),p<15&&(f+=T[i++]<<p,p+=8,f+=T[i++]<<p,p+=8),v=b[f&y];s:for(;;){if(f>>>=w=v>>>24,p-=w,!(16&(w=v>>>16&255))){if(0==(64&w)){v=b[(65535&v)+(f&(1<<w)-1)];continue s}e.msg="invalid distance code",s.mode=30;break e}if(S=65535&v,p<(w&=15)&&(f+=T[i++]<<p,(p+=8)<w&&(f+=T[i++]<<p,p+=8)),(S+=f&(1<<w)-1)>c){e.msg="invalid distance too far back",s.mode=30;break e}if(f>>>=w,p-=w,S>(w=a-n)){if((w=S-w)>h&&s.sane){e.msg="invalid distance too far back",s.mode=30;break e}if(_=0,O=l,0===u){if(_+=d-w,w<k){k-=w;do{x[a++]=l[_++]}while(--w);_=a-S,O=x}}else if(u<w){if(_+=d+u-w,(w-=u)<k){k-=w;do{x[a++]=l[_++]}while(--w);if(_=0,u<k){k-=w=u;do{x[a++]=l[_++]}while(--w);_=a-S,O=x}}}else if(_+=u-w,w<k){k-=w;do{x[a++]=l[_++]}while(--w);_=a-S,O=x}for(;k>2;)x[a++]=O[_++],x[a++]=O[_++],x[a++]=O[_++],k-=3;k&&(x[a++]=O[_++],k>1&&(x[a++]=O[_++]))}else{_=a-S;do{x[a++]=x[_++],x[a++]=x[_++],x[a++]=x[_++],k-=3}while(k>2);k&&(x[a++]=x[_++],k>1&&(x[a++]=x[_++]))}break}}break}}while(i<r&&a<o);i-=k=p>>3,f&=(1<<(p-=k<<3))-1,e.next_in=i,e.next_out=a,e.avail_in=i<r?r-i+5:5-(i-r),e.avail_out=a<o?o-a+257:257-(a-o),s.hold=f,s.bits=p}},7948:(e,t,s)=>{"use strict";var i=s(4236),r=s(6069),a=s(2869),n=s(4264),o=s(9241),c=-2,d=12,h=30;function u(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function l(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function f(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(852),t.distcode=t.distdyn=new i.Buf32(592),t.sane=1,t.back=-1,0):c}function p(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,f(e)):c}function m(e,t){var s,i;return e&&e.state?(i=e.state,t<0?(s=0,t=-t):(s=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?c:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=s,i.wbits=t,p(e))):c}function b(e,t){var s,i;return e?(i=new l,e.state=i,i.window=null,0!==(s=m(e,t))&&(e.state=null),s):c}var g,y,v=!0;function w(e){if(v){var t;for(g=new i.Buf32(512),y=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(1,e.lens,0,288,g,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(2,e.lens,0,32,y,0,e.work,{bits:5}),v=!1}e.lencode=g,e.lenbits=9,e.distcode=y,e.distbits=5}function k(e,t,s,r){var a,n=e.state;return null===n.window&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new i.Buf8(n.wsize)),r>=n.wsize?(i.arraySet(n.window,t,s-n.wsize,n.wsize,0),n.wnext=0,n.whave=n.wsize):((a=n.wsize-n.wnext)>r&&(a=r),i.arraySet(n.window,t,s-r,a,n.wnext),(r-=a)?(i.arraySet(n.window,t,s-r,r,0),n.wnext=r,n.whave=n.wsize):(n.wnext+=a,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=a))),0}t.inflateReset=p,t.inflateReset2=m,t.inflateResetKeep=f,t.inflateInit=function(e){return b(e,15)},t.inflateInit2=b,t.inflate=function(e,t){var s,l,f,p,m,b,g,y,v,S,_,O,T,x,C,I,M,N,A,E,P,B,V,L,q=0,D=new i.Buf8(4),R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return c;(s=e.state).mode===d&&(s.mode=13),m=e.next_out,f=e.output,g=e.avail_out,p=e.next_in,l=e.input,b=e.avail_in,y=s.hold,v=s.bits,S=b,_=g,B=0;e:for(;;)switch(s.mode){case 1:if(0===s.wrap){s.mode=13;break}for(;v<16;){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}if(2&s.wrap&&35615===y){s.check=0,D[0]=255&y,D[1]=y>>>8&255,s.check=a(s.check,D,2,0),y=0,v=0,s.mode=2;break}if(s.flags=0,s.head&&(s.head.done=!1),!(1&s.wrap)||(((255&y)<<8)+(y>>8))%31){e.msg="incorrect header check",s.mode=h;break}if(8!=(15&y)){e.msg="unknown compression method",s.mode=h;break}if(v-=4,P=8+(15&(y>>>=4)),0===s.wbits)s.wbits=P;else if(P>s.wbits){e.msg="invalid window size",s.mode=h;break}s.dmax=1<<P,e.adler=s.check=1,s.mode=512&y?10:d,y=0,v=0;break;case 2:for(;v<16;){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}if(s.flags=y,8!=(255&s.flags)){e.msg="unknown compression method",s.mode=h;break}if(57344&s.flags){e.msg="unknown header flags set",s.mode=h;break}s.head&&(s.head.text=y>>8&1),512&s.flags&&(D[0]=255&y,D[1]=y>>>8&255,s.check=a(s.check,D,2,0)),y=0,v=0,s.mode=3;case 3:for(;v<32;){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}s.head&&(s.head.time=y),512&s.flags&&(D[0]=255&y,D[1]=y>>>8&255,D[2]=y>>>16&255,D[3]=y>>>24&255,s.check=a(s.check,D,4,0)),y=0,v=0,s.mode=4;case 4:for(;v<16;){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}s.head&&(s.head.xflags=255&y,s.head.os=y>>8),512&s.flags&&(D[0]=255&y,D[1]=y>>>8&255,s.check=a(s.check,D,2,0)),y=0,v=0,s.mode=5;case 5:if(1024&s.flags){for(;v<16;){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}s.length=y,s.head&&(s.head.extra_len=y),512&s.flags&&(D[0]=255&y,D[1]=y>>>8&255,s.check=a(s.check,D,2,0)),y=0,v=0}else s.head&&(s.head.extra=null);s.mode=6;case 6:if(1024&s.flags&&((O=s.length)>b&&(O=b),O&&(s.head&&(P=s.head.extra_len-s.length,s.head.extra||(s.head.extra=new Array(s.head.extra_len)),i.arraySet(s.head.extra,l,p,O,P)),512&s.flags&&(s.check=a(s.check,l,O,p)),b-=O,p+=O,s.length-=O),s.length))break e;s.length=0,s.mode=7;case 7:if(2048&s.flags){if(0===b)break e;O=0;do{P=l[p+O++],s.head&&P&&s.length<65536&&(s.head.name+=String.fromCharCode(P))}while(P&&O<b);if(512&s.flags&&(s.check=a(s.check,l,O,p)),b-=O,p+=O,P)break e}else s.head&&(s.head.name=null);s.length=0,s.mode=8;case 8:if(4096&s.flags){if(0===b)break e;O=0;do{P=l[p+O++],s.head&&P&&s.length<65536&&(s.head.comment+=String.fromCharCode(P))}while(P&&O<b);if(512&s.flags&&(s.check=a(s.check,l,O,p)),b-=O,p+=O,P)break e}else s.head&&(s.head.comment=null);s.mode=9;case 9:if(512&s.flags){for(;v<16;){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}if(y!==(65535&s.check)){e.msg="header crc mismatch",s.mode=h;break}y=0,v=0}s.head&&(s.head.hcrc=s.flags>>9&1,s.head.done=!0),e.adler=s.check=0,s.mode=d;break;case 10:for(;v<32;){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}e.adler=s.check=u(y),y=0,v=0,s.mode=11;case 11:if(0===s.havedict)return e.next_out=m,e.avail_out=g,e.next_in=p,e.avail_in=b,s.hold=y,s.bits=v,2;e.adler=s.check=1,s.mode=d;case d:if(5===t||6===t)break e;case 13:if(s.last){y>>>=7&v,v-=7&v,s.mode=27;break}for(;v<3;){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}switch(s.last=1&y,v-=1,3&(y>>>=1)){case 0:s.mode=14;break;case 1:if(w(s),s.mode=20,6===t){y>>>=2,v-=2;break e}break;case 2:s.mode=17;break;case 3:e.msg="invalid block type",s.mode=h}y>>>=2,v-=2;break;case 14:for(y>>>=7&v,v-=7&v;v<32;){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}if((65535&y)!=(y>>>16^65535)){e.msg="invalid stored block lengths",s.mode=h;break}if(s.length=65535&y,y=0,v=0,s.mode=15,6===t)break e;case 15:s.mode=16;case 16:if(O=s.length){if(O>b&&(O=b),O>g&&(O=g),0===O)break e;i.arraySet(f,l,p,O,m),b-=O,p+=O,g-=O,m+=O,s.length-=O;break}s.mode=d;break;case 17:for(;v<14;){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}if(s.nlen=257+(31&y),y>>>=5,v-=5,s.ndist=1+(31&y),y>>>=5,v-=5,s.ncode=4+(15&y),y>>>=4,v-=4,s.nlen>286||s.ndist>30){e.msg="too many length or distance symbols",s.mode=h;break}s.have=0,s.mode=18;case 18:for(;s.have<s.ncode;){for(;v<3;){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}s.lens[R[s.have++]]=7&y,y>>>=3,v-=3}for(;s.have<19;)s.lens[R[s.have++]]=0;if(s.lencode=s.lendyn,s.lenbits=7,V={bits:s.lenbits},B=o(0,s.lens,0,19,s.lencode,0,s.work,V),s.lenbits=V.bits,B){e.msg="invalid code lengths set",s.mode=h;break}s.have=0,s.mode=19;case 19:for(;s.have<s.nlen+s.ndist;){for(;I=(q=s.lencode[y&(1<<s.lenbits)-1])>>>16&255,M=65535&q,!((C=q>>>24)<=v);){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}if(M<16)y>>>=C,v-=C,s.lens[s.have++]=M;else{if(16===M){for(L=C+2;v<L;){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}if(y>>>=C,v-=C,0===s.have){e.msg="invalid bit length repeat",s.mode=h;break}P=s.lens[s.have-1],O=3+(3&y),y>>>=2,v-=2}else if(17===M){for(L=C+3;v<L;){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}v-=C,P=0,O=3+(7&(y>>>=C)),y>>>=3,v-=3}else{for(L=C+7;v<L;){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}v-=C,P=0,O=11+(127&(y>>>=C)),y>>>=7,v-=7}if(s.have+O>s.nlen+s.ndist){e.msg="invalid bit length repeat",s.mode=h;break}for(;O--;)s.lens[s.have++]=P}}if(s.mode===h)break;if(0===s.lens[256]){e.msg="invalid code -- missing end-of-block",s.mode=h;break}if(s.lenbits=9,V={bits:s.lenbits},B=o(1,s.lens,0,s.nlen,s.lencode,0,s.work,V),s.lenbits=V.bits,B){e.msg="invalid literal/lengths set",s.mode=h;break}if(s.distbits=6,s.distcode=s.distdyn,V={bits:s.distbits},B=o(2,s.lens,s.nlen,s.ndist,s.distcode,0,s.work,V),s.distbits=V.bits,B){e.msg="invalid distances set",s.mode=h;break}if(s.mode=20,6===t)break e;case 20:s.mode=21;case 21:if(b>=6&&g>=258){e.next_out=m,e.avail_out=g,e.next_in=p,e.avail_in=b,s.hold=y,s.bits=v,n(e,_),m=e.next_out,f=e.output,g=e.avail_out,p=e.next_in,l=e.input,b=e.avail_in,y=s.hold,v=s.bits,s.mode===d&&(s.back=-1);break}for(s.back=0;I=(q=s.lencode[y&(1<<s.lenbits)-1])>>>16&255,M=65535&q,!((C=q>>>24)<=v);){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}if(I&&0==(240&I)){for(N=C,A=I,E=M;I=(q=s.lencode[E+((y&(1<<N+A)-1)>>N)])>>>16&255,M=65535&q,!(N+(C=q>>>24)<=v);){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}y>>>=N,v-=N,s.back+=N}if(y>>>=C,v-=C,s.back+=C,s.length=M,0===I){s.mode=26;break}if(32&I){s.back=-1,s.mode=d;break}if(64&I){e.msg="invalid literal/length code",s.mode=h;break}s.extra=15&I,s.mode=22;case 22:if(s.extra){for(L=s.extra;v<L;){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}s.length+=y&(1<<s.extra)-1,y>>>=s.extra,v-=s.extra,s.back+=s.extra}s.was=s.length,s.mode=23;case 23:for(;I=(q=s.distcode[y&(1<<s.distbits)-1])>>>16&255,M=65535&q,!((C=q>>>24)<=v);){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}if(0==(240&I)){for(N=C,A=I,E=M;I=(q=s.distcode[E+((y&(1<<N+A)-1)>>N)])>>>16&255,M=65535&q,!(N+(C=q>>>24)<=v);){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}y>>>=N,v-=N,s.back+=N}if(y>>>=C,v-=C,s.back+=C,64&I){e.msg="invalid distance code",s.mode=h;break}s.offset=M,s.extra=15&I,s.mode=24;case 24:if(s.extra){for(L=s.extra;v<L;){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}s.offset+=y&(1<<s.extra)-1,y>>>=s.extra,v-=s.extra,s.back+=s.extra}if(s.offset>s.dmax){e.msg="invalid distance too far back",s.mode=h;break}s.mode=25;case 25:if(0===g)break e;if(O=_-g,s.offset>O){if((O=s.offset-O)>s.whave&&s.sane){e.msg="invalid distance too far back",s.mode=h;break}O>s.wnext?(O-=s.wnext,T=s.wsize-O):T=s.wnext-O,O>s.length&&(O=s.length),x=s.window}else x=f,T=m-s.offset,O=s.length;O>g&&(O=g),g-=O,s.length-=O;do{f[m++]=x[T++]}while(--O);0===s.length&&(s.mode=21);break;case 26:if(0===g)break e;f[m++]=s.length,g--,s.mode=21;break;case 27:if(s.wrap){for(;v<32;){if(0===b)break e;b--,y|=l[p++]<<v,v+=8}if(_-=g,e.total_out+=_,s.total+=_,_&&(e.adler=s.check=s.flags?a(s.check,f,_,m-_):r(s.check,f,_,m-_)),_=g,(s.flags?y:u(y))!==s.check){e.msg="incorrect data check",s.mode=h;break}y=0,v=0}s.mode=28;case 28:if(s.wrap&&s.flags){for(;v<32;){if(0===b)break e;b--,y+=l[p++]<<v,v+=8}if(y!==(4294967295&s.total)){e.msg="incorrect length check",s.mode=h;break}y=0,v=0}s.mode=29;case 29:B=1;break e;case h:B=-3;break e;case 31:return-4;case 32:default:return c}return e.next_out=m,e.avail_out=g,e.next_in=p,e.avail_in=b,s.hold=y,s.bits=v,(s.wsize||_!==e.avail_out&&s.mode<h&&(s.mode<27||4!==t))&&k(e,e.output,e.next_out,_-e.avail_out)?(s.mode=31,-4):(S-=e.avail_in,_-=e.avail_out,e.total_in+=S,e.total_out+=_,s.total+=_,s.wrap&&_&&(e.adler=s.check=s.flags?a(s.check,f,_,e.next_out-_):r(s.check,f,_,e.next_out-_)),e.data_type=s.bits+(s.last?64:0)+(s.mode===d?128:0)+(20===s.mode||15===s.mode?256:0),(0===S&&0===_||4===t)&&0===B&&(B=-5),B)},t.inflateEnd=function(e){if(!e||!e.state)return c;var t=e.state;return t.window&&(t.window=null),e.state=null,0},t.inflateGetHeader=function(e,t){var s;return e&&e.state?0==(2&(s=e.state).wrap)?c:(s.head=t,t.done=!1,0):c},t.inflateSetDictionary=function(e,t){var s,i=t.length;return e&&e.state?0!==(s=e.state).wrap&&11!==s.mode?c:11===s.mode&&r(1,t,i,0)!==s.check?-3:k(e,t,i,i)?(s.mode=31,-4):(s.havedict=1,0):c},t.inflateInfo="pako inflate (from Nodeca project)"},9241:(e,t,s)=>{"use strict";var i=s(4236),r=15,a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,s,d,h,u,l,f){var p,m,b,g,y,v,w,k,S,_=f.bits,O=0,T=0,x=0,C=0,I=0,M=0,N=0,A=0,E=0,P=0,B=null,V=0,L=new i.Buf16(16),q=new i.Buf16(16),D=null,R=0;for(O=0;O<=r;O++)L[O]=0;for(T=0;T<d;T++)L[t[s+T]]++;for(I=_,C=r;C>=1&&0===L[C];C--);if(I>C&&(I=C),0===C)return h[u++]=20971520,h[u++]=20971520,f.bits=1,0;for(x=1;x<C&&0===L[x];x++);for(I<x&&(I=x),A=1,O=1;O<=r;O++)if(A<<=1,(A-=L[O])<0)return-1;if(A>0&&(0===e||1!==C))return-1;for(q[1]=0,O=1;O<r;O++)q[O+1]=q[O]+L[O];for(T=0;T<d;T++)0!==t[s+T]&&(l[q[t[s+T]]++]=T);if(0===e?(B=D=l,v=19):1===e?(B=a,V-=257,D=n,R-=257,v=256):(B=o,D=c,v=-1),P=0,T=0,O=x,y=u,M=I,N=0,b=-1,g=(E=1<<I)-1,1===e&&E>852||2===e&&E>592)return 1;for(;;){w=O-N,l[T]<v?(k=0,S=l[T]):l[T]>v?(k=D[R+l[T]],S=B[V+l[T]]):(k=96,S=0),p=1<<O-N,x=m=1<<M;do{h[y+(P>>N)+(m-=p)]=w<<24|k<<16|S|0}while(0!==m);for(p=1<<O-1;P&p;)p>>=1;if(0!==p?(P&=p-1,P+=p):P=0,T++,0==--L[O]){if(O===C)break;O=t[s+l[T]]}if(O>I&&(P&g)!==b){for(0===N&&(N=I),y+=x,A=1<<(M=O-N);M+N<C&&!((A-=L[M+N])<=0);)M++,A<<=1;if(E+=1<<M,1===e&&E>852||2===e&&E>592)return 1;h[b=P&g]=I<<24|M<<16|y-u|0}}return 0!==P&&(h[y+P]=O-N<<24|64<<16|0),f.bits=I,0}},8898:e=>{"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},342:(e,t,s)=>{"use strict";var i=s(4236);function r(e){for(var t=e.length;--t>=0;)e[t]=0}var a=256,n=286,o=30,c=15,d=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],h=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],f=new Array(576);r(f);var p=new Array(60);r(p);var m=new Array(512);r(m);var b=new Array(256);r(b);var g=new Array(29);r(g);var y,v,w,k=new Array(o);function S(e,t,s,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=s,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}function _(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function O(e){return e<256?m[e]:m[256+(e>>>7)]}function T(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function x(e,t,s){e.bi_valid>16-s?(e.bi_buf|=t<<e.bi_valid&65535,T(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=s-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=s)}function C(e,t,s){x(e,s[2*t],s[2*t+1])}function I(e,t){var s=0;do{s|=1&e,e>>>=1,s<<=1}while(--t>0);return s>>>1}function M(e,t,s){var i,r,a=new Array(16),n=0;for(i=1;i<=c;i++)a[i]=n=n+s[i-1]<<1;for(r=0;r<=t;r++){var o=e[2*r+1];0!==o&&(e[2*r]=I(a[o]++,o))}}function N(e){var t;for(t=0;t<n;t++)e.dyn_ltree[2*t]=0;for(t=0;t<o;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function A(e){e.bi_valid>8?T(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function E(e,t,s,i){var r=2*t,a=2*s;return e[r]<e[a]||e[r]===e[a]&&i[t]<=i[s]}function P(e,t,s){for(var i=e.heap[s],r=s<<1;r<=e.heap_len&&(r<e.heap_len&&E(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!E(t,i,e.heap[r],e.depth));)e.heap[s]=e.heap[r],s=r,r<<=1;e.heap[s]=i}function B(e,t,s){var i,r,n,o,c=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],r=e.pending_buf[e.l_buf+c],c++,0===i?C(e,r,t):(C(e,(n=b[r])+a+1,t),0!==(o=d[n])&&x(e,r-=g[n],o),C(e,n=O(--i),s),0!==(o=h[n])&&x(e,i-=k[n],o))}while(c<e.last_lit);C(e,256,t)}function V(e,t){var s,i,r,a=t.dyn_tree,n=t.stat_desc.static_tree,o=t.stat_desc.has_stree,d=t.stat_desc.elems,h=-1;for(e.heap_len=0,e.heap_max=573,s=0;s<d;s++)0!==a[2*s]?(e.heap[++e.heap_len]=h=s,e.depth[s]=0):a[2*s+1]=0;for(;e.heap_len<2;)a[2*(r=e.heap[++e.heap_len]=h<2?++h:0)]=1,e.depth[r]=0,e.opt_len--,o&&(e.static_len-=n[2*r+1]);for(t.max_code=h,s=e.heap_len>>1;s>=1;s--)P(e,a,s);r=d;do{s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],P(e,a,1),i=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=i,a[2*r]=a[2*s]+a[2*i],e.depth[r]=(e.depth[s]>=e.depth[i]?e.depth[s]:e.depth[i])+1,a[2*s+1]=a[2*i+1]=r,e.heap[1]=r++,P(e,a,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var s,i,r,a,n,o,d=t.dyn_tree,h=t.max_code,u=t.stat_desc.static_tree,l=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,m=t.stat_desc.max_length,b=0;for(a=0;a<=c;a++)e.bl_count[a]=0;for(d[2*e.heap[e.heap_max]+1]=0,s=e.heap_max+1;s<573;s++)(a=d[2*d[2*(i=e.heap[s])+1]+1]+1)>m&&(a=m,b++),d[2*i+1]=a,i>h||(e.bl_count[a]++,n=0,i>=p&&(n=f[i-p]),o=d[2*i],e.opt_len+=o*(a+n),l&&(e.static_len+=o*(u[2*i+1]+n)));if(0!==b){do{for(a=m-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[m]--,b-=2}while(b>0);for(a=m;0!==a;a--)for(i=e.bl_count[a];0!==i;)(r=e.heap[--s])>h||(d[2*r+1]!==a&&(e.opt_len+=(a-d[2*r+1])*d[2*r],d[2*r+1]=a),i--)}}(e,t),M(a,h,e.bl_count)}function L(e,t,s){var i,r,a=-1,n=t[1],o=0,c=7,d=4;for(0===n&&(c=138,d=3),t[2*(s+1)+1]=65535,i=0;i<=s;i++)r=n,n=t[2*(i+1)+1],++o<c&&r===n||(o<d?e.bl_tree[2*r]+=o:0!==r?(r!==a&&e.bl_tree[2*r]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,a=r,0===n?(c=138,d=3):r===n?(c=6,d=3):(c=7,d=4))}function q(e,t,s){var i,r,a=-1,n=t[1],o=0,c=7,d=4;for(0===n&&(c=138,d=3),i=0;i<=s;i++)if(r=n,n=t[2*(i+1)+1],!(++o<c&&r===n)){if(o<d)do{C(e,r,e.bl_tree)}while(0!=--o);else 0!==r?(r!==a&&(C(e,r,e.bl_tree),o--),C(e,16,e.bl_tree),x(e,o-3,2)):o<=10?(C(e,17,e.bl_tree),x(e,o-3,3)):(C(e,18,e.bl_tree),x(e,o-11,7));o=0,a=r,0===n?(c=138,d=3):r===n?(c=6,d=3):(c=7,d=4)}}r(k);var D=!1;function R(e,t,s,r){x(e,0+(r?1:0),3),function(e,t,s,r){A(e),r&&(T(e,s),T(e,~s)),i.arraySet(e.pending_buf,e.window,t,s,e.pending),e.pending+=s}(e,t,s,!0)}t._tr_init=function(e){D||(!function(){var e,t,s,i,r,a=new Array(16);for(s=0,i=0;i<28;i++)for(g[i]=s,e=0;e<1<<d[i];e++)b[s++]=i;for(b[s-1]=i,r=0,i=0;i<16;i++)for(k[i]=r,e=0;e<1<<h[i];e++)m[r++]=i;for(r>>=7;i<o;i++)for(k[i]=r<<7,e=0;e<1<<h[i]-7;e++)m[256+r++]=i;for(t=0;t<=c;t++)a[t]=0;for(e=0;e<=143;)f[2*e+1]=8,e++,a[8]++;for(;e<=255;)f[2*e+1]=9,e++,a[9]++;for(;e<=279;)f[2*e+1]=7,e++,a[7]++;for(;e<=287;)f[2*e+1]=8,e++,a[8]++;for(M(f,287,a),e=0;e<o;e++)p[2*e+1]=5,p[2*e]=I(e,5);y=new S(f,d,257,n,c),v=new S(p,h,0,o,c),w=new S(new Array(0),u,0,19,7)}(),D=!0),e.l_desc=new _(e.dyn_ltree,y),e.d_desc=new _(e.dyn_dtree,v),e.bl_desc=new _(e.bl_tree,w),e.bi_buf=0,e.bi_valid=0,N(e)},t._tr_stored_block=R,t._tr_flush_block=function(e,t,s,i){var r,n,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,s=4093624447;for(t=0;t<=31;t++,s>>>=1)if(1&s&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<a;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),V(e,e.l_desc),V(e,e.d_desc),o=function(e){var t;for(L(e,e.dyn_ltree,e.l_desc.max_code),L(e,e.dyn_dtree,e.d_desc.max_code),V(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*l[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),r=e.opt_len+3+7>>>3,(n=e.static_len+3+7>>>3)<=r&&(r=n)):r=n=s+5,s+4<=r&&-1!==t?R(e,t,s,i):4===e.strategy||n===r?(x(e,2+(i?1:0),3),B(e,f,p)):(x(e,4+(i?1:0),3),function(e,t,s,i){var r;for(x(e,t-257,5),x(e,s-1,5),x(e,i-4,4),r=0;r<i;r++)x(e,e.bl_tree[2*l[r]+1],3);q(e,e.dyn_ltree,t-1),q(e,e.dyn_dtree,s-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),B(e,e.dyn_ltree,e.dyn_dtree)),N(e),i&&A(e)},t._tr_tally=function(e,t,s){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&s,e.last_lit++,0===t?e.dyn_ltree[2*s]++:(e.matches++,t--,e.dyn_ltree[2*(b[s]+a+1)]++,e.dyn_dtree[2*O(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){x(e,2,3),C(e,256,f),function(e){16===e.bi_valid?(T(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},2292:e=>{"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},8212:(e,t,s)=>{"use strict";var i=s(4155);void 0===i||!i.version||0===i.version.indexOf("v0.")||0===i.version.indexOf("v1.")&&0!==i.version.indexOf("v1.8.")?e.exports={nextTick:function(e,t,s,r){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var a,n,o=arguments.length;switch(o){case 0:case 1:return i.nextTick(e);case 2:return i.nextTick((function(){e.call(null,t)}));case 3:return i.nextTick((function(){e.call(null,t,s)}));case 4:return i.nextTick((function(){e.call(null,t,s,r)}));default:for(a=new Array(o-1),n=0;n<a.length;)a[n++]=arguments[n];return i.nextTick((function(){e.apply(null,a)}))}}}:e.exports=i},4155:e=>{var t,s,i=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function n(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(s){try{return t.call(null,e,0)}catch(s){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{s="function"==typeof clearTimeout?clearTimeout:a}catch(e){s=a}}();var o,c=[],d=!1,h=-1;function u(){d&&o&&(d=!1,o.length?c=o.concat(c):h=-1,c.length&&l())}function l(){if(!d){var e=n(u);d=!0;for(var t=c.length;t;){for(o=c,c=[];++h<t;)o&&o[h].run();h=-1,t=c.length}o=null,d=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===a||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];c.push(new f(e,t)),1!==c.length||d||n(l)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},6606:e=>{var t;window,t=function(){return function(e){var t={};function s(i){if(t[i])return t[i].exports;var r=t[i]={i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}return s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(i,r,function(t){return e[t]}.bind(null,r));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=2)}([function(e,t,s){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(e,t)},function(e,t){function s(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)});Object.defineProperty(t,"__esModule",{value:!0});var a=256,n=function(){function e(e){void 0===e&&(e="="),this._paddingCharacter=e}return e.prototype.encodedLength=function(e){return this._paddingCharacter?(e+2)/3*4|0:(8*e+5)/6|0},e.prototype.encode=function(e){for(var t="",s=0;s<e.length-2;s+=3){var i=e[s]<<16|e[s+1]<<8|e[s+2];t+=this._encodeByte(i>>>18&63),t+=this._encodeByte(i>>>12&63),t+=this._encodeByte(i>>>6&63),t+=this._encodeByte(i>>>0&63)}var r=e.length-s;return r>0&&(i=e[s]<<16|(2===r?e[s+1]<<8:0),t+=this._encodeByte(i>>>18&63),t+=this._encodeByte(i>>>12&63),t+=2===r?this._encodeByte(i>>>6&63):this._paddingCharacter||"",t+=this._paddingCharacter||""),t},e.prototype.maxDecodedLength=function(e){return this._paddingCharacter?e/4*3|0:(6*e+7)/8|0},e.prototype.decodedLength=function(e){return this.maxDecodedLength(e.length-this._getPaddingLength(e))},e.prototype.decode=function(e){if(0===e.length)return new Uint8Array(0);for(var t=this._getPaddingLength(e),s=e.length-t,i=new Uint8Array(this.maxDecodedLength(s)),r=0,n=0,o=0,c=0,d=0,h=0,u=0;n<s-4;n+=4)c=this._decodeChar(e.charCodeAt(n+0)),d=this._decodeChar(e.charCodeAt(n+1)),h=this._decodeChar(e.charCodeAt(n+2)),u=this._decodeChar(e.charCodeAt(n+3)),i[r++]=c<<2|d>>>4,i[r++]=d<<4|h>>>2,i[r++]=h<<6|u,o|=c&a,o|=d&a,o|=h&a,o|=u&a;if(n<s-1&&(c=this._decodeChar(e.charCodeAt(n)),d=this._decodeChar(e.charCodeAt(n+1)),i[r++]=c<<2|d>>>4,o|=c&a,o|=d&a),n<s-2&&(h=this._decodeChar(e.charCodeAt(n+2)),i[r++]=d<<4|h>>>2,o|=h&a),n<s-3&&(u=this._decodeChar(e.charCodeAt(n+3)),i[r++]=h<<6|u,o|=u&a),0!==o)throw new Error("Base64Coder: incorrect characters for decoding");return i},e.prototype._encodeByte=function(e){var t=e;return t+=65,t+=25-e>>>8&6,t+=51-e>>>8&-75,t+=61-e>>>8&-15,t+=62-e>>>8&3,String.fromCharCode(t)},e.prototype._decodeChar=function(e){var t=a;return t+=(42-e&e-44)>>>8&-256+e-43+62,t+=(46-e&e-48)>>>8&-256+e-47+63,t+=(47-e&e-58)>>>8&-256+e-48+52,t+=(64-e&e-91)>>>8&-256+e-65+0,t+=(96-e&e-123)>>>8&-256+e-97+26},e.prototype._getPaddingLength=function(e){var t=0;if(this._paddingCharacter){for(var s=e.length-1;s>=0&&e[s]===this._paddingCharacter;s--)t++;if(e.length<4||t>2)throw new Error("Base64Coder: incorrect padding")}return t},e}();t.Coder=n;var o=new n;t.encode=function(e){return o.encode(e)},t.decode=function(e){return o.decode(e)};var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype._encodeByte=function(e){var t=e;return t+=65,t+=25-e>>>8&6,t+=51-e>>>8&-75,t+=61-e>>>8&-13,t+=62-e>>>8&49,String.fromCharCode(t)},t.prototype._decodeChar=function(e){var t=a;return t+=(44-e&e-46)>>>8&-256+e-45+62,t+=(94-e&e-96)>>>8&-256+e-95+63,t+=(47-e&e-58)>>>8&-256+e-48+52,t+=(64-e&e-91)>>>8&-256+e-65+0,t+=(96-e&e-123)>>>8&-256+e-97+26},t}(n);t.URLSafeCoder=c;var d=new c;t.encodeURLSafe=function(e){return d.encode(e)},t.decodeURLSafe=function(e){return d.decode(e)},t.encodedLength=function(e){return o.encodedLength(e)},t.maxDecodedLength=function(e){return o.maxDecodedLength(e)},t.decodedLength=function(e){return o.decodedLength(e)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="utf8: invalid string",r="utf8: invalid source encoding";function a(e){for(var t=0,s=0;s<e.length;s++){var r=e.charCodeAt(s);if(r<128)t+=1;else if(r<2048)t+=2;else if(r<55296)t+=3;else{if(!(r<=57343))throw new Error(i);if(s>=e.length-1)throw new Error(i);s++,t+=4}}return t}t.encode=function(e){for(var t=new Uint8Array(a(e)),s=0,i=0;i<e.length;i++){var r=e.charCodeAt(i);r<128?t[s++]=r:r<2048?(t[s++]=192|r>>6,t[s++]=128|63&r):r<55296?(t[s++]=224|r>>12,t[s++]=128|r>>6&63,t[s++]=128|63&r):(i++,r=(1023&r)<<10,r|=1023&e.charCodeAt(i),r+=65536,t[s++]=240|r>>18,t[s++]=128|r>>12&63,t[s++]=128|r>>6&63,t[s++]=128|63&r)}return t},t.encodedLength=a,t.decode=function(e){for(var t=[],s=0;s<e.length;s++){var i=e[s];if(128&i){var a=void 0;if(i<224){if(s>=e.length)throw new Error(r);if(128!=(192&(n=e[++s])))throw new Error(r);i=(31&i)<<6|63&n,a=128}else if(i<240){if(s>=e.length-1)throw new Error(r);var n=e[++s],o=e[++s];if(128!=(192&n)||128!=(192&o))throw new Error(r);i=(15&i)<<12|(63&n)<<6|63&o,a=2048}else{if(!(i<248))throw new Error(r);if(s>=e.length-2)throw new Error(r);n=e[++s],o=e[++s];var c=e[++s];if(128!=(192&n)||128!=(192&o)||128!=(192&c))throw new Error(r);i=(15&i)<<18|(63&n)<<12|(63&o)<<6|63&c,a=65536}if(i<a||i>=55296&&i<=57343)throw new Error(r);if(i>=65536){if(i>1114111)throw new Error(r);i-=65536,t.push(String.fromCharCode(55296|i>>10)),i=56320|1023&i}}t.push(String.fromCharCode(i))}return t.join("")}},function(e,t,s){e.exports=s(3).default},function(e,t,s){"use strict";s.r(t);for(var i,r=function(){function e(e,t){this.lastId=0,this.prefix=e,this.name=t}return e.prototype.create=function(e){this.lastId++;var t=this.lastId,s=this.prefix+t,i=this.name+"["+t+"]",r=!1,a=function(){r||(e.apply(null,arguments),r=!0)};return this[t]=a,{number:t,id:s,name:i,callback:a}},e.prototype.remove=function(e){delete this[e.number]},e}(),a=new r("_pusher_script_","Pusher.ScriptReceivers"),n={VERSION:"7.0.3",PROTOCOL:7,wsPort:80,wssPort:443,wsPath:"",httpHost:"sockjs.pusher.com",httpPort:80,httpsPort:443,httpPath:"/pusher",stats_host:"stats.pusher.com",authEndpoint:"/pusher/auth",authTransport:"ajax",activityTimeout:12e4,pongTimeout:3e4,unavailableTimeout:1e4,cluster:"mt1",cdn_http:"http://js.pusher.com",cdn_https:"https://js.pusher.com",dependency_suffix:""},o=function(){function e(e){this.options=e,this.receivers=e.receivers||a,this.loading={}}return e.prototype.load=function(e,t,s){var i=this;if(i.loading[e]&&i.loading[e].length>0)i.loading[e].push(s);else{i.loading[e]=[s];var r=kt.createScriptRequest(i.getPath(e,t)),a=i.receivers.create((function(t){if(i.receivers.remove(a),i.loading[e]){var s=i.loading[e];delete i.loading[e];for(var n=function(e){e||r.cleanup()},o=0;o<s.length;o++)s[o](t,n)}}));r.send(a)}},e.prototype.getRoot=function(e){var t=kt.getDocument().location.protocol;return(e&&e.useTLS||"https:"===t?this.options.cdn_https:this.options.cdn_http).replace(/\/*$/,"")+"/"+this.options.version},e.prototype.getPath=function(e,t){return this.getRoot(t)+"/"+e+this.options.suffix+".js"},e}(),c=new r("_pusher_dependencies","Pusher.DependenciesReceivers"),d=new o({cdn_http:n.cdn_http,cdn_https:n.cdn_https,version:n.VERSION,suffix:n.dependency_suffix,receivers:c}),h={baseUrl:"https://pusher.com",urls:{authenticationEndpoint:{path:"/docs/authenticating_users"},javascriptQuickStart:{path:"/docs/javascript_quick_start"},triggeringClientEvents:{path:"/docs/client_api_guide/client_events#trigger-events"},encryptedChannelSupport:{fullUrl:"https://github.com/pusher/pusher-js/tree/cc491015371a4bde5743d1c87a0fbac0feb53195#encrypted-channel-support"}}},u=function(e){var t,s=h.urls[e];return s?(s.fullUrl?t=s.fullUrl:s.path&&(t=h.baseUrl+s.path),t?"See: "+t:""):""},l=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(e,t)},function(e,t){function s(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)}),f=function(e){function t(t){var s=this.constructor,i=e.call(this,t)||this;return Object.setPrototypeOf(i,s.prototype),i}return l(t,e),t}(Error),p=function(e){function t(t){var s=this.constructor,i=e.call(this,t)||this;return Object.setPrototypeOf(i,s.prototype),i}return l(t,e),t}(Error),m=function(e){function t(t){var s=this.constructor,i=e.call(this,t)||this;return Object.setPrototypeOf(i,s.prototype),i}return l(t,e),t}(Error),b=function(e){function t(t){var s=this.constructor,i=e.call(this,t)||this;return Object.setPrototypeOf(i,s.prototype),i}return l(t,e),t}(Error),g=function(e){function t(t){var s=this.constructor,i=e.call(this,t)||this;return Object.setPrototypeOf(i,s.prototype),i}return l(t,e),t}(Error),y=function(e){function t(t){var s=this.constructor,i=e.call(this,t)||this;return Object.setPrototypeOf(i,s.prototype),i}return l(t,e),t}(Error),v=function(e){function t(t){var s=this.constructor,i=e.call(this,t)||this;return Object.setPrototypeOf(i,s.prototype),i}return l(t,e),t}(Error),w=function(e){function t(t,s){var i=this.constructor,r=e.call(this,s)||this;return r.status=t,Object.setPrototypeOf(r,i.prototype),r}return l(t,e),t}(Error),k=function(e,t,s){var i,r=this;for(var a in(i=kt.createXHR()).open("POST",r.options.authEndpoint,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.authOptions.headers)i.setRequestHeader(a,this.authOptions.headers[a]);return i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status){var e=void 0,t=!1;try{e=JSON.parse(i.responseText),t=!0}catch(e){s(new w(200,"JSON returned from auth endpoint was invalid, yet status code was 200. Data was: "+i.responseText),{auth:""})}t&&s(null,e)}else{var a=u("authenticationEndpoint");s(new w(i.status,"Unable to retrieve auth string from auth endpoint - received status: "+i.status+" from "+r.options.authEndpoint+". Clients must be authenticated to join private or presence channels. "+a),{auth:""})}},i.send(this.composeQuery(t)),i},S=String.fromCharCode,_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",O={},T=0,x=_.length;T<x;T++)O[_.charAt(T)]=T;var C=function(e){var t=e.charCodeAt(0);return t<128?e:t<2048?S(192|t>>>6)+S(128|63&t):S(224|t>>>12&15)+S(128|t>>>6&63)+S(128|63&t)},I=function(e){return e.replace(/[^\x00-\x7F]/g,C)},M=function(e){var t=[0,2,1][e.length%3],s=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[_.charAt(s>>>18),_.charAt(s>>>12&63),t>=2?"=":_.charAt(s>>>6&63),t>=1?"=":_.charAt(63&s)].join("")},N=window.btoa||function(e){return e.replace(/[\s\S]{1,3}/g,M)},A=function(){function e(e,t,s,i){var r=this;this.clear=t,this.timer=e((function(){r.timer&&(r.timer=i(r.timer))}),s)}return e.prototype.isRunning=function(){return null!==this.timer},e.prototype.ensureAborted=function(){this.timer&&(this.clear(this.timer),this.timer=null)},e}(),E=function(){var e=function(t,s){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(t,s)};return function(t,s){function i(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(i.prototype=s.prototype,new i)}}();function P(e){window.clearTimeout(e)}function B(e){window.clearInterval(e)}var V=function(e){function t(t,s){return e.call(this,setTimeout,P,t,(function(e){return s(),null}))||this}return E(t,e),t}(A),L=function(e){function t(t,s){return e.call(this,setInterval,B,t,(function(e){return s(),e}))||this}return E(t,e),t}(A),q={now:function(){return Date.now?Date.now():(new Date).valueOf()},defer:function(e){return new V(0,e)},method:function(e){for(var t=[],s=1;s<arguments.length;s++)t[s-1]=arguments[s];var i=Array.prototype.slice.call(arguments,1);return function(t){return t[e].apply(t,i.concat(arguments))}}};function D(e){for(var t=[],s=1;s<arguments.length;s++)t[s-1]=arguments[s];for(var i=0;i<t.length;i++){var r=t[i];for(var a in r)r[a]&&r[a].constructor&&r[a].constructor===Object?e[a]=D(e[a]||{},r[a]):e[a]=r[a]}return e}function R(){for(var e=["Pusher"],t=0;t<arguments.length;t++)"string"==typeof arguments[t]?e.push(arguments[t]):e.push(Z(arguments[t]));return e.join(" : ")}function G(e,t){var s=Array.prototype.indexOf;if(null===e)return-1;if(s&&e.indexOf===s)return e.indexOf(t);for(var i=0,r=e.length;i<r;i++)if(e[i]===t)return i;return-1}function F(e,t){for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t(e[s],s,e)}function U(e){var t=[];return F(e,(function(e,s){t.push(s)})),t}function j(e,t,s){for(var i=0;i<e.length;i++)t.call(s||window,e[i],i,e)}function H(e,t){for(var s=[],i=0;i<e.length;i++)s.push(t(e[i],i,e,s));return s}function z(e,t){t=t||function(e){return!!e};for(var s=[],i=0;i<e.length;i++)t(e[i],i,e,s)&&s.push(e[i]);return s}function W(e,t){var s={};return F(e,(function(i,r){(t&&t(i,r,e,s)||Boolean(i))&&(s[r]=i)})),s}function K(e,t){for(var s=0;s<e.length;s++)if(t(e[s],s,e))return!0;return!1}function X(e){return t=function(e){return"object"==typeof e&&(e=Z(e)),encodeURIComponent((t=e.toString(),N(I(t))));var t},s={},F(e,(function(e,i){s[i]=t(e)})),s;var t,s}function Y(e){var t,s,i=W(e,(function(e){return void 0!==e}));return H((t=X(i),s=[],F(t,(function(e,t){s.push([t,e])})),s),q.method("join","=")).join("&")}function Z(e){try{return JSON.stringify(e)}catch(i){return JSON.stringify((t=[],s=[],function e(i,r){var a,n,o;switch(typeof i){case"object":if(!i)return null;for(a=0;a<t.length;a+=1)if(t[a]===i)return{$ref:s[a]};if(t.push(i),s.push(r),"[object Array]"===Object.prototype.toString.apply(i))for(o=[],a=0;a<i.length;a+=1)o[a]=e(i[a],r+"["+a+"]");else for(n in o={},i)Object.prototype.hasOwnProperty.call(i,n)&&(o[n]=e(i[n],r+"["+JSON.stringify(n)+"]"));return o;case"number":case"string":case"boolean":return i}}(e,"$")))}var t,s}var Q=new(function(){function e(){this.globalLog=function(e){window.console&&window.console.log&&window.console.log(e)}}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.log(this.globalLog,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.log(this.globalLogWarn,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.log(this.globalLogError,e)},e.prototype.globalLogWarn=function(e){window.console&&window.console.warn?window.console.warn(e):this.globalLog(e)},e.prototype.globalLogError=function(e){window.console&&window.console.error?window.console.error(e):this.globalLogWarn(e)},e.prototype.log=function(e){for(var t=[],s=1;s<arguments.length;s++)t[s-1]=arguments[s];var i=R.apply(this,arguments);if(Vt.log)Vt.log(i);else if(Vt.logToConsole){var r=e.bind(this);r(i)}},e}()),J=function(e,t,s){void 0!==this.authOptions.headers&&Q.warn("To send headers with the auth request, you must use AJAX, rather than JSONP.");var i=e.nextAuthCallbackID.toString();e.nextAuthCallbackID++;var r=e.getDocument(),a=r.createElement("script");e.auth_callbacks[i]=function(e){s(null,e)};var n="Pusher.auth_callbacks['"+i+"']";a.src=this.options.authEndpoint+"?callback="+encodeURIComponent(n)+"&"+this.composeQuery(t);var o=r.getElementsByTagName("head")[0]||r.documentElement;o.insertBefore(a,o.firstChild)},$=function(){function e(e){this.src=e}return e.prototype.send=function(e){var t=this,s="Error loading "+t.src;t.script=document.createElement("script"),t.script.id=e.id,t.script.src=t.src,t.script.type="text/javascript",t.script.charset="UTF-8",t.script.addEventListener?(t.script.onerror=function(){e.callback(s)},t.script.onload=function(){e.callback(null)}):t.script.onreadystatechange=function(){"loaded"!==t.script.readyState&&"complete"!==t.script.readyState||e.callback(null)},void 0===t.script.async&&document.attachEvent&&/opera/i.test(navigator.userAgent)?(t.errorScript=document.createElement("script"),t.errorScript.id=e.id+"_error",t.errorScript.text=e.name+"('"+s+"');",t.script.async=t.errorScript.async=!1):t.script.async=!0;var i=document.getElementsByTagName("head")[0];i.insertBefore(t.script,i.firstChild),t.errorScript&&i.insertBefore(t.errorScript,t.script.nextSibling)},e.prototype.cleanup=function(){this.script&&(this.script.onload=this.script.onerror=null,this.script.onreadystatechange=null),this.script&&this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.errorScript&&this.errorScript.parentNode&&this.errorScript.parentNode.removeChild(this.errorScript),this.script=null,this.errorScript=null},e}(),ee=function(){function e(e,t){this.url=e,this.data=t}return e.prototype.send=function(e){if(!this.request){var t=Y(this.data),s=this.url+"/"+e.number+"?"+t;this.request=kt.createScriptRequest(s),this.request.send(e)}},e.prototype.cleanup=function(){this.request&&this.request.cleanup()},e}(),te={name:"jsonp",getAgent:function(e,t){return function(s,i){var r="http"+(t?"s":"")+"://"+(e.host||e.options.host)+e.options.path,n=kt.createJSONPRequest(r,s),o=kt.ScriptReceivers.create((function(t,s){a.remove(o),n.cleanup(),s&&s.host&&(e.host=s.host),i&&i(t,s)}));n.send(o)}}};function se(e,t,s){return e+(t.useTLS?"s":"")+"://"+(t.useTLS?t.hostTLS:t.hostNonTLS)+s}function ie(e,t){return"/app/"+e+"?protocol="+n.PROTOCOL+"&client=js&version="+n.VERSION+(t?"&"+t:"")}var re={getInitial:function(e,t){return se("ws",t,(t.httpPath||"")+ie(e,"flash=false"))}},ae={getInitial:function(e,t){return se("http",t,(t.httpPath||"/pusher")+ie(e))}},ne={getInitial:function(e,t){return se("http",t,t.httpPath||"/pusher")},getPath:function(e,t){return ie(e)}},oe=function(){function e(){this._callbacks={}}return e.prototype.get=function(e){return this._callbacks[ce(e)]},e.prototype.add=function(e,t,s){var i=ce(e);this._callbacks[i]=this._callbacks[i]||[],this._callbacks[i].push({fn:t,context:s})},e.prototype.remove=function(e,t,s){if(e||t||s){var i=e?[ce(e)]:U(this._callbacks);t||s?this.removeCallback(i,t,s):this.removeAllCallbacks(i)}else this._callbacks={}},e.prototype.removeCallback=function(e,t,s){j(e,(function(e){this._callbacks[e]=z(this._callbacks[e]||[],(function(e){return t&&t!==e.fn||s&&s!==e.context})),0===this._callbacks[e].length&&delete this._callbacks[e]}),this)},e.prototype.removeAllCallbacks=function(e){j(e,(function(e){delete this._callbacks[e]}),this)},e}();function ce(e){return"_"+e}var de=function(){function e(e){this.callbacks=new oe,this.global_callbacks=[],this.failThrough=e}return e.prototype.bind=function(e,t,s){return this.callbacks.add(e,t,s),this},e.prototype.bind_global=function(e){return this.global_callbacks.push(e),this},e.prototype.unbind=function(e,t,s){return this.callbacks.remove(e,t,s),this},e.prototype.unbind_global=function(e){return e?(this.global_callbacks=z(this.global_callbacks||[],(function(t){return t!==e})),this):(this.global_callbacks=[],this)},e.prototype.unbind_all=function(){return this.unbind(),this.unbind_global(),this},e.prototype.emit=function(e,t,s){for(var i=0;i<this.global_callbacks.length;i++)this.global_callbacks[i](e,t);var r=this.callbacks.get(e),a=[];if(s?a.push(t,s):t&&a.push(t),r&&r.length>0)for(i=0;i<r.length;i++)r[i].fn.apply(r[i].context||window,a);else this.failThrough&&this.failThrough(e,t);return this},e}(),he=function(){var e=function(t,s){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(t,s)};return function(t,s){function i(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(i.prototype=s.prototype,new i)}}(),ue=function(e){function t(t,s,i,r,a){var n=e.call(this)||this;return n.initialize=kt.transportConnectionInitializer,n.hooks=t,n.name=s,n.priority=i,n.key=r,n.options=a,n.state="new",n.timeline=a.timeline,n.activityTimeout=a.activityTimeout,n.id=n.timeline.generateUniqueID(),n}return he(t,e),t.prototype.handlesActivityChecks=function(){return Boolean(this.hooks.handlesActivityChecks)},t.prototype.supportsPing=function(){return Boolean(this.hooks.supportsPing)},t.prototype.connect=function(){var e=this;if(this.socket||"initialized"!==this.state)return!1;var t=this.hooks.urls.getInitial(this.key,this.options);try{this.socket=this.hooks.getSocket(t,this.options)}catch(t){return q.defer((function(){e.onError(t),e.changeState("closed")})),!1}return this.bindListeners(),Q.debug("Connecting",{transport:this.name,url:t}),this.changeState("connecting"),!0},t.prototype.close=function(){return!!this.socket&&(this.socket.close(),!0)},t.prototype.send=function(e){var t=this;return"open"===this.state&&(q.defer((function(){t.socket&&t.socket.send(e)})),!0)},t.prototype.ping=function(){"open"===this.state&&this.supportsPing()&&this.socket.ping()},t.prototype.onOpen=function(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0},t.prototype.onError=function(e){this.emit("error",{type:"WebSocketError",error:e}),this.timeline.error(this.buildTimelineMessage({error:e.toString()}))},t.prototype.onClose=function(e){e?this.changeState("closed",{code:e.code,reason:e.reason,wasClean:e.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0},t.prototype.onMessage=function(e){this.emit("message",e)},t.prototype.onActivity=function(){this.emit("activity")},t.prototype.bindListeners=function(){var e=this;this.socket.onopen=function(){e.onOpen()},this.socket.onerror=function(t){e.onError(t)},this.socket.onclose=function(t){e.onClose(t)},this.socket.onmessage=function(t){e.onMessage(t)},this.supportsPing()&&(this.socket.onactivity=function(){e.onActivity()})},t.prototype.unbindListeners=function(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))},t.prototype.changeState=function(e,t){this.state=e,this.timeline.info(this.buildTimelineMessage({state:e,params:t})),this.emit(e,t)},t.prototype.buildTimelineMessage=function(e){return D({cid:this.id},e)},t}(de),le=function(){function e(e){this.hooks=e}return e.prototype.isSupported=function(e){return this.hooks.isSupported(e)},e.prototype.createConnection=function(e,t,s,i){return new ue(this.hooks,e,t,s,i)},e}(),fe=new le({urls:re,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return Boolean(kt.getWebSocketAPI())},isSupported:function(){return Boolean(kt.getWebSocketAPI())},getSocket:function(e){return kt.createWebSocket(e)}}),pe={urls:ae,handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return!0}},me=D({getSocket:function(e){return kt.HTTPFactory.createStreamingSocket(e)}},pe),be=D({getSocket:function(e){return kt.HTTPFactory.createPollingSocket(e)}},pe),ge={isSupported:function(){return kt.isXHRSupported()}},ye={ws:fe,xhr_streaming:new le(D({},me,ge)),xhr_polling:new le(D({},be,ge))},ve=new le({file:"sockjs",urls:ne,handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:function(){return void 0!==window.SockJS},getSocket:function(e,t){return new window.SockJS(e,null,{js_path:d.getPath("sockjs",{useTLS:t.useTLS}),ignore_null_origin:t.ignoreNullOrigin})},beforeOpen:function(e,t){e.send(JSON.stringify({path:t}))}}),we={isSupported:function(e){return kt.isXDRSupported(e.useTLS)}},ke=new le(D({},me,we)),Se=new le(D({},be,we));ye.xdr_streaming=ke,ye.xdr_polling=Se,ye.sockjs=ve;var _e=ye,Oe=function(){var e=function(t,s){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(t,s)};return function(t,s){function i(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(i.prototype=s.prototype,new i)}}(),Te=new(function(e){function t(){var t=e.call(this)||this,s=t;return void 0!==window.addEventListener&&(window.addEventListener("online",(function(){s.emit("online")}),!1),window.addEventListener("offline",(function(){s.emit("offline")}),!1)),t}return Oe(t,e),t.prototype.isOnline=function(){return void 0===window.navigator.onLine||window.navigator.onLine},t}(de)),xe=function(){function e(e,t,s){this.manager=e,this.transport=t,this.minPingDelay=s.minPingDelay,this.maxPingDelay=s.maxPingDelay,this.pingDelay=void 0}return e.prototype.createConnection=function(e,t,s,i){var r=this;i=D({},i,{activityTimeout:this.pingDelay});var a=this.transport.createConnection(e,t,s,i),n=null,o=function(){a.unbind("open",o),a.bind("closed",c),n=q.now()},c=function(e){if(a.unbind("closed",c),1002===e.code||1003===e.code)r.manager.reportDeath();else if(!e.wasClean&&n){var t=q.now()-n;t<2*r.maxPingDelay&&(r.manager.reportDeath(),r.pingDelay=Math.max(t/2,r.minPingDelay))}};return a.bind("open",o),a},e.prototype.isSupported=function(e){return this.manager.isAlive()&&this.transport.isSupported(e)},e}(),Ce={decodeMessage:function(e){try{var t=JSON.parse(e.data),s=t.data;if("string"==typeof s)try{s=JSON.parse(t.data)}catch(e){}var i={event:t.event,channel:t.channel,data:s};return t.user_id&&(i.user_id=t.user_id),i}catch(t){throw{type:"MessageParseError",error:t,data:e.data}}},encodeMessage:function(e){return JSON.stringify(e)},processHandshake:function(e){var t=Ce.decodeMessage(e);if("pusher:connection_established"===t.event){if(!t.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:t.data.socket_id,activityTimeout:1e3*t.data.activity_timeout}}if("pusher:error"===t.event)return{action:this.getCloseAction(t.data),error:this.getCloseError(t.data)};throw"Invalid handshake"},getCloseAction:function(e){return e.code<4e3?e.code>=1002&&e.code<=1004?"backoff":null:4e3===e.code?"tls_only":e.code<4100?"refused":e.code<4200?"backoff":e.code<4300?"retry":"refused"},getCloseError:function(e){return 1e3!==e.code&&1001!==e.code?{type:"PusherError",data:{code:e.code,message:e.reason||e.message}}:null}},Ie=Ce,Me=function(){var e=function(t,s){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(t,s)};return function(t,s){function i(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(i.prototype=s.prototype,new i)}}(),Ne=function(e){function t(t,s){var i=e.call(this)||this;return i.id=t,i.transport=s,i.activityTimeout=s.activityTimeout,i.bindListeners(),i}return Me(t,e),t.prototype.handlesActivityChecks=function(){return this.transport.handlesActivityChecks()},t.prototype.send=function(e){return this.transport.send(e)},t.prototype.send_event=function(e,t,s){var i={event:e,data:t};return s&&(i.channel=s),Q.debug("Event sent",i),this.send(Ie.encodeMessage(i))},t.prototype.ping=function(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})},t.prototype.close=function(){this.transport.close()},t.prototype.bindListeners=function(){var e=this,t={message:function(t){var s;try{s=Ie.decodeMessage(t)}catch(s){e.emit("error",{type:"MessageParseError",error:s,data:t.data})}if(void 0!==s){switch(Q.debug("Event recd",s),s.event){case"pusher:error":e.emit("error",{type:"PusherError",data:s.data});break;case"pusher:ping":e.emit("ping");break;case"pusher:pong":e.emit("pong")}e.emit("message",s)}},activity:function(){e.emit("activity")},error:function(t){e.emit("error",t)},closed:function(t){s(),t&&t.code&&e.handleCloseEvent(t),e.transport=null,e.emit("closed")}},s=function(){F(t,(function(t,s){e.transport.unbind(s,t)}))};F(t,(function(t,s){e.transport.bind(s,t)}))},t.prototype.handleCloseEvent=function(e){var t=Ie.getCloseAction(e),s=Ie.getCloseError(e);s&&this.emit("error",s),t&&this.emit(t,{action:t,error:s})},t}(de),Ae=function(){function e(e,t){this.transport=e,this.callback=t,this.bindListeners()}return e.prototype.close=function(){this.unbindListeners(),this.transport.close()},e.prototype.bindListeners=function(){var e=this;this.onMessage=function(t){var s;e.unbindListeners();try{s=Ie.processHandshake(t)}catch(t){return e.finish("error",{error:t}),void e.transport.close()}"connected"===s.action?e.finish("connected",{connection:new Ne(s.id,e.transport),activityTimeout:s.activityTimeout}):(e.finish(s.action,{error:s.error}),e.transport.close())},this.onClosed=function(t){e.unbindListeners();var s=Ie.getCloseAction(t)||"backoff",i=Ie.getCloseError(t);e.finish(s,{error:i})},this.transport.bind("message",this.onMessage),this.transport.bind("closed",this.onClosed)},e.prototype.unbindListeners=function(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)},e.prototype.finish=function(e,t){this.callback(D({transport:this.transport,action:e},t))},e}(),Ee=function(){function e(e,t){this.channel=e;var s=t.authTransport;if(void 0===kt.getAuthorizers()[s])throw"'"+s+"' is not a recognized auth transport";this.type=s,this.options=t,this.authOptions=t.auth||{}}return e.prototype.composeQuery=function(e){var t="socket_id="+encodeURIComponent(e)+"&channel_name="+encodeURIComponent(this.channel.name);for(var s in this.authOptions.params)t+="&"+encodeURIComponent(s)+"="+encodeURIComponent(this.authOptions.params[s]);return t},e.prototype.authorize=function(t,s){e.authorizers=e.authorizers||kt.getAuthorizers(),e.authorizers[this.type].call(this,kt,t,s)},e}(),Pe=function(){function e(e,t){this.timeline=e,this.options=t||{}}return e.prototype.send=function(e,t){this.timeline.isEmpty()||this.timeline.send(kt.TimelineTransport.getAgent(this,e),t)},e}(),Be=function(){var e=function(t,s){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(t,s)};return function(t,s){function i(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(i.prototype=s.prototype,new i)}}(),Ve=function(e){function t(t,s){var i=e.call(this,(function(e,s){Q.debug("No callbacks on "+t+" for "+e)}))||this;return i.name=t,i.pusher=s,i.subscribed=!1,i.subscriptionPending=!1,i.subscriptionCancelled=!1,i}return Be(t,e),t.prototype.authorize=function(e,t){return t(null,{auth:""})},t.prototype.trigger=function(e,t){if(0!==e.indexOf("client-"))throw new f("Event '"+e+"' does not start with 'client-'");if(!this.subscribed){var s=u("triggeringClientEvents");Q.warn("Client event triggered before channel 'subscription_succeeded' event . "+s)}return this.pusher.send_event(e,t,this.name)},t.prototype.disconnect=function(){this.subscribed=!1,this.subscriptionPending=!1},t.prototype.handleEvent=function(e){var t=e.event,s=e.data;"pusher_internal:subscription_succeeded"===t?this.handleSubscriptionSucceededEvent(e):0!==t.indexOf("pusher_internal:")&&this.emit(t,s,{})},t.prototype.handleSubscriptionSucceededEvent=function(e){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):this.emit("pusher:subscription_succeeded",e.data)},t.prototype.subscribe=function(){var e=this;this.subscribed||(this.subscriptionPending=!0,this.subscriptionCancelled=!1,this.authorize(this.pusher.connection.socket_id,(function(t,s){t?(e.subscriptionPending=!1,Q.error(t.toString()),e.emit("pusher:subscription_error",Object.assign({},{type:"AuthError",error:t.message},t instanceof w?{status:t.status}:{}))):e.pusher.send_event("pusher:subscribe",{auth:s.auth,channel_data:s.channel_data,channel:e.name})})))},t.prototype.unsubscribe=function(){this.subscribed=!1,this.pusher.send_event("pusher:unsubscribe",{channel:this.name})},t.prototype.cancelSubscription=function(){this.subscriptionCancelled=!0},t.prototype.reinstateSubscription=function(){this.subscriptionCancelled=!1},t}(de),Le=function(){var e=function(t,s){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(t,s)};return function(t,s){function i(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(i.prototype=s.prototype,new i)}}(),qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Le(t,e),t.prototype.authorize=function(e,t){return Xe.createAuthorizer(this,this.pusher.config).authorize(e,t)},t}(Ve),De=function(){function e(){this.reset()}return e.prototype.get=function(e){return Object.prototype.hasOwnProperty.call(this.members,e)?{id:e,info:this.members[e]}:null},e.prototype.each=function(e){var t=this;F(this.members,(function(s,i){e(t.get(i))}))},e.prototype.setMyID=function(e){this.myID=e},e.prototype.onSubscription=function(e){this.members=e.presence.hash,this.count=e.presence.count,this.me=this.get(this.myID)},e.prototype.addMember=function(e){return null===this.get(e.user_id)&&this.count++,this.members[e.user_id]=e.user_info,this.get(e.user_id)},e.prototype.removeMember=function(e){var t=this.get(e.user_id);return t&&(delete this.members[e.user_id],this.count--),t},e.prototype.reset=function(){this.members={},this.count=0,this.myID=null,this.me=null},e}(),Re=function(){var e=function(t,s){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(t,s)};return function(t,s){function i(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(i.prototype=s.prototype,new i)}}(),Ge=function(e){function t(t,s){var i=e.call(this,t,s)||this;return i.members=new De,i}return Re(t,e),t.prototype.authorize=function(t,s){var i=this;e.prototype.authorize.call(this,t,(function(e,t){if(!e){if(void 0===(t=t).channel_data){var r=u("authenticationEndpoint");return Q.error("Invalid auth response for channel '"+i.name+"',expected 'channel_data' field. "+r),void s("Invalid auth response")}var a=JSON.parse(t.channel_data);i.members.setMyID(a.user_id)}s(e,t)}))},t.prototype.handleEvent=function(e){var t=e.event;if(0===t.indexOf("pusher_internal:"))this.handleInternalEvent(e);else{var s=e.data,i={};e.user_id&&(i.user_id=e.user_id),this.emit(t,s,i)}},t.prototype.handleInternalEvent=function(e){var t=e.event,s=e.data;switch(t){case"pusher_internal:subscription_succeeded":this.handleSubscriptionSucceededEvent(e);break;case"pusher_internal:member_added":var i=this.members.addMember(s);this.emit("pusher:member_added",i);break;case"pusher_internal:member_removed":var r=this.members.removeMember(s);r&&this.emit("pusher:member_removed",r)}},t.prototype.handleSubscriptionSucceededEvent=function(e){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):(this.members.onSubscription(e.data),this.emit("pusher:subscription_succeeded",this.members))},t.prototype.disconnect=function(){this.members.reset(),e.prototype.disconnect.call(this)},t}(qe),Fe=s(1),Ue=s(0),je=function(){var e=function(t,s){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(t,s)};return function(t,s){function i(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(i.prototype=s.prototype,new i)}}(),He=function(e){function t(t,s,i){var r=e.call(this,t,s)||this;return r.key=null,r.nacl=i,r}return je(t,e),t.prototype.authorize=function(t,s){var i=this;e.prototype.authorize.call(this,t,(function(e,t){if(e)s(e,t);else{var r=t.shared_secret;r?(i.key=Object(Ue.decode)(r),delete t.shared_secret,s(null,t)):s(new Error("No shared_secret key in auth payload for encrypted channel: "+i.name),null)}}))},t.prototype.trigger=function(e,t){throw new g("Client events are not currently supported for encrypted channels")},t.prototype.handleEvent=function(t){var s=t.event,i=t.data;0!==s.indexOf("pusher_internal:")&&0!==s.indexOf("pusher:")?this.handleEncryptedEvent(s,i):e.prototype.handleEvent.call(this,t)},t.prototype.handleEncryptedEvent=function(e,t){var s=this;if(this.key)if(t.ciphertext&&t.nonce){var i=Object(Ue.decode)(t.ciphertext);if(i.length<this.nacl.secretbox.overheadLength)Q.error("Expected encrypted event ciphertext length to be "+this.nacl.secretbox.overheadLength+", got: "+i.length);else{var r=Object(Ue.decode)(t.nonce);if(r.length<this.nacl.secretbox.nonceLength)Q.error("Expected encrypted event nonce length to be "+this.nacl.secretbox.nonceLength+", got: "+r.length);else{var a=this.nacl.secretbox.open(i,r,this.key);if(null===a)return Q.debug("Failed to decrypt an event, probably because it was encrypted with a different key. Fetching a new key from the authEndpoint..."),void this.authorize(this.pusher.connection.socket_id,(function(t,n){t?Q.error("Failed to make a request to the authEndpoint: "+n+". Unable to fetch new key, so dropping encrypted event"):null!==(a=s.nacl.secretbox.open(i,r,s.key))?s.emit(e,s.getDataToEmit(a)):Q.error("Failed to decrypt event with new key. Dropping encrypted event")}));this.emit(e,this.getDataToEmit(a))}}}else Q.error("Unexpected format for encrypted event, expected object with `ciphertext` and `nonce` fields, got: "+t);else Q.debug("Received encrypted event before key has been retrieved from the authEndpoint")},t.prototype.getDataToEmit=function(e){var t=Object(Fe.decode)(e);try{return JSON.parse(t)}catch(e){return t}},t}(qe),ze=function(){var e=function(t,s){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(t,s)};return function(t,s){function i(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(i.prototype=s.prototype,new i)}}(),We=function(e){function t(t,s){var i=e.call(this)||this;i.state="initialized",i.connection=null,i.key=t,i.options=s,i.timeline=i.options.timeline,i.usingTLS=i.options.useTLS,i.errorCallbacks=i.buildErrorCallbacks(),i.connectionCallbacks=i.buildConnectionCallbacks(i.errorCallbacks),i.handshakeCallbacks=i.buildHandshakeCallbacks(i.errorCallbacks);var r=kt.getNetwork();return r.bind("online",(function(){i.timeline.info({netinfo:"online"}),"connecting"!==i.state&&"unavailable"!==i.state||i.retryIn(0)})),r.bind("offline",(function(){i.timeline.info({netinfo:"offline"}),i.connection&&i.sendActivityCheck()})),i.updateStrategy(),i}return ze(t,e),t.prototype.connect=function(){this.connection||this.runner||(this.strategy.isSupported()?(this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()):this.updateState("failed"))},t.prototype.send=function(e){return!!this.connection&&this.connection.send(e)},t.prototype.send_event=function(e,t,s){return!!this.connection&&this.connection.send_event(e,t,s)},t.prototype.disconnect=function(){this.disconnectInternally(),this.updateState("disconnected")},t.prototype.isUsingTLS=function(){return this.usingTLS},t.prototype.startConnecting=function(){var e=this,t=function(s,i){s?e.runner=e.strategy.connect(0,t):"error"===i.action?(e.emit("error",{type:"HandshakeError",error:i.error}),e.timeline.error({handshakeError:i.error})):(e.abortConnecting(),e.handshakeCallbacks[i.action](i))};this.runner=this.strategy.connect(0,t)},t.prototype.abortConnecting=function(){this.runner&&(this.runner.abort(),this.runner=null)},t.prototype.disconnectInternally=function(){this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection&&this.abandonConnection().close()},t.prototype.updateStrategy=function(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,useTLS:this.usingTLS})},t.prototype.retryIn=function(e){var t=this;this.timeline.info({action:"retry",delay:e}),e>0&&this.emit("connecting_in",Math.round(e/1e3)),this.retryTimer=new V(e||0,(function(){t.disconnectInternally(),t.connect()}))},t.prototype.clearRetryTimer=function(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)},t.prototype.setUnavailableTimer=function(){var e=this;this.unavailableTimer=new V(this.options.unavailableTimeout,(function(){e.updateState("unavailable")}))},t.prototype.clearUnavailableTimer=function(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()},t.prototype.sendActivityCheck=function(){var e=this;this.stopActivityCheck(),this.connection.ping(),this.activityTimer=new V(this.options.pongTimeout,(function(){e.timeline.error({pong_timed_out:e.options.pongTimeout}),e.retryIn(0)}))},t.prototype.resetActivityCheck=function(){var e=this;this.stopActivityCheck(),this.connection&&!this.connection.handlesActivityChecks()&&(this.activityTimer=new V(this.activityTimeout,(function(){e.sendActivityCheck()})))},t.prototype.stopActivityCheck=function(){this.activityTimer&&this.activityTimer.ensureAborted()},t.prototype.buildConnectionCallbacks=function(e){var t=this;return D({},e,{message:function(e){t.resetActivityCheck(),t.emit("message",e)},ping:function(){t.send_event("pusher:pong",{})},activity:function(){t.resetActivityCheck()},error:function(e){t.emit("error",e)},closed:function(){t.abandonConnection(),t.shouldRetry()&&t.retryIn(1e3)}})},t.prototype.buildHandshakeCallbacks=function(e){var t=this;return D({},e,{connected:function(e){t.activityTimeout=Math.min(t.options.activityTimeout,e.activityTimeout,e.connection.activityTimeout||1/0),t.clearUnavailableTimer(),t.setConnection(e.connection),t.socket_id=t.connection.id,t.updateState("connected",{socket_id:t.socket_id})}})},t.prototype.buildErrorCallbacks=function(){var e=this,t=function(t){return function(s){s.error&&e.emit("error",{type:"WebSocketError",error:s.error}),t(s)}};return{tls_only:t((function(){e.usingTLS=!0,e.updateStrategy(),e.retryIn(0)})),refused:t((function(){e.disconnect()})),backoff:t((function(){e.retryIn(1e3)})),retry:t((function(){e.retryIn(0)}))}},t.prototype.setConnection=function(e){for(var t in this.connection=e,this.connectionCallbacks)this.connection.bind(t,this.connectionCallbacks[t]);this.resetActivityCheck()},t.prototype.abandonConnection=function(){if(this.connection){for(var e in this.stopActivityCheck(),this.connectionCallbacks)this.connection.unbind(e,this.connectionCallbacks[e]);var t=this.connection;return this.connection=null,t}},t.prototype.updateState=function(e,t){var s=this.state;if(this.state=e,s!==e){var i=e;"connected"===i&&(i+=" with new socket ID "+t.socket_id),Q.debug("State changed",s+" -> "+i),this.timeline.info({state:e,params:t}),this.emit("state_change",{previous:s,current:e}),this.emit(e,t)}},t.prototype.shouldRetry=function(){return"connecting"===this.state||"connected"===this.state},t}(de),Ke=function(){function e(){this.channels={}}return e.prototype.add=function(e,t){return this.channels[e]||(this.channels[e]=function(e,t){if(0===e.indexOf("private-encrypted-")){if(t.config.nacl)return Xe.createEncryptedChannel(e,t,t.config.nacl);var s="Tried to subscribe to a private-encrypted- channel but no nacl implementation available",i=u("encryptedChannelSupport");throw new g(s+". "+i)}return 0===e.indexOf("private-")?Xe.createPrivateChannel(e,t):0===e.indexOf("presence-")?Xe.createPresenceChannel(e,t):Xe.createChannel(e,t)}(e,t)),this.channels[e]},e.prototype.all=function(){return function(e){var t=[];return F(e,(function(e){t.push(e)})),t}(this.channels)},e.prototype.find=function(e){return this.channels[e]},e.prototype.remove=function(e){var t=this.channels[e];return delete this.channels[e],t},e.prototype.disconnect=function(){F(this.channels,(function(e){e.disconnect()}))},e}(),Xe={createChannels:function(){return new Ke},createConnectionManager:function(e,t){return new We(e,t)},createChannel:function(e,t){return new Ve(e,t)},createPrivateChannel:function(e,t){return new qe(e,t)},createPresenceChannel:function(e,t){return new Ge(e,t)},createEncryptedChannel:function(e,t,s){return new He(e,t,s)},createTimelineSender:function(e,t){return new Pe(e,t)},createAuthorizer:function(e,t){return t.authorizer?t.authorizer(e,t):new Ee(e,t)},createHandshake:function(e,t){return new Ae(e,t)},createAssistantToTheTransportManager:function(e,t,s){return new xe(e,t,s)}},Ye=function(){function e(e){this.options=e||{},this.livesLeft=this.options.lives||1/0}return e.prototype.getAssistant=function(e){return Xe.createAssistantToTheTransportManager(this,e,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})},e.prototype.isAlive=function(){return this.livesLeft>0},e.prototype.reportDeath=function(){this.livesLeft-=1},e}(),Ze=function(){function e(e,t){this.strategies=e,this.loop=Boolean(t.loop),this.failFast=Boolean(t.failFast),this.timeout=t.timeout,this.timeoutLimit=t.timeoutLimit}return e.prototype.isSupported=function(){return K(this.strategies,q.method("isSupported"))},e.prototype.connect=function(e,t){var s=this,i=this.strategies,r=0,a=this.timeout,n=null,o=function(c,d){d?t(null,d):(r+=1,s.loop&&(r%=i.length),r<i.length?(a&&(a*=2,s.timeoutLimit&&(a=Math.min(a,s.timeoutLimit))),n=s.tryStrategy(i[r],e,{timeout:a,failFast:s.failFast},o)):t(!0))};return n=this.tryStrategy(i[r],e,{timeout:a,failFast:this.failFast},o),{abort:function(){n.abort()},forceMinPriority:function(t){e=t,n&&n.forceMinPriority(t)}}},e.prototype.tryStrategy=function(e,t,s,i){var r=null,a=null;return s.timeout>0&&(r=new V(s.timeout,(function(){a.abort(),i(!0)}))),a=e.connect(t,(function(e,t){e&&r&&r.isRunning()&&!s.failFast||(r&&r.ensureAborted(),i(e,t))})),{abort:function(){r&&r.ensureAborted(),a.abort()},forceMinPriority:function(e){a.forceMinPriority(e)}}},e}(),Qe=function(){function e(e){this.strategies=e}return e.prototype.isSupported=function(){return K(this.strategies,q.method("isSupported"))},e.prototype.connect=function(e,t){return function(e,t,s){var i=H(e,(function(e,i,r,a){return e.connect(t,s(i,a))}));return{abort:function(){j(i,Je)},forceMinPriority:function(e){j(i,(function(t){t.forceMinPriority(e)}))}}}(this.strategies,e,(function(e,s){return function(i,r){s[e].error=i,i?function(e){return function(e,t){for(var s=0;s<e.length;s++)if(!t(e[s],s,e))return!1;return!0}(e,(function(e){return Boolean(e.error)}))}(s)&&t(!0):(j(s,(function(e){e.forceMinPriority(r.transport.priority)})),t(null,r))}}))},e}();function Je(e){e.error||e.aborted||(e.abort(),e.aborted=!0)}var $e=function(){function e(e,t,s){this.strategy=e,this.transports=t,this.ttl=s.ttl||18e5,this.usingTLS=s.useTLS,this.timeline=s.timeline}return e.prototype.isSupported=function(){return this.strategy.isSupported()},e.prototype.connect=function(e,t){var s=this.usingTLS,i=function(e){var t=kt.getLocalStorage();if(t)try{var s=t[et(e)];if(s)return JSON.parse(s)}catch(t){tt(e)}return null}(s),r=[this.strategy];if(i&&i.timestamp+this.ttl>=q.now()){var a=this.transports[i.transport];a&&(this.timeline.info({cached:!0,transport:i.transport,latency:i.latency}),r.push(new Ze([a],{timeout:2*i.latency+1e3,failFast:!0})))}var n=q.now(),o=r.pop().connect(e,(function i(a,c){a?(tt(s),r.length>0?(n=q.now(),o=r.pop().connect(e,i)):t(a)):(function(e,t,s){var i=kt.getLocalStorage();if(i)try{i[et(e)]=Z({timestamp:q.now(),transport:t,latency:s})}catch(e){}}(s,c.transport.name,q.now()-n),t(null,c))}));return{abort:function(){o.abort()},forceMinPriority:function(t){e=t,o&&o.forceMinPriority(t)}}},e}();function et(e){return"pusherTransport"+(e?"TLS":"NonTLS")}function tt(e){var t=kt.getLocalStorage();if(t)try{delete t[et(e)]}catch(e){}}var st=function(){function e(e,t){var s=t.delay;this.strategy=e,this.options={delay:s}}return e.prototype.isSupported=function(){return this.strategy.isSupported()},e.prototype.connect=function(e,t){var s,i=this.strategy,r=new V(this.options.delay,(function(){s=i.connect(e,t)}));return{abort:function(){r.ensureAborted(),s&&s.abort()},forceMinPriority:function(t){e=t,s&&s.forceMinPriority(t)}}},e}(),it=function(){function e(e,t,s){this.test=e,this.trueBranch=t,this.falseBranch=s}return e.prototype.isSupported=function(){return(this.test()?this.trueBranch:this.falseBranch).isSupported()},e.prototype.connect=function(e,t){return(this.test()?this.trueBranch:this.falseBranch).connect(e,t)},e}(),rt=function(){function e(e){this.strategy=e}return e.prototype.isSupported=function(){return this.strategy.isSupported()},e.prototype.connect=function(e,t){var s=this.strategy.connect(e,(function(e,i){i&&s.abort(),t(e,i)}));return s},e}();function at(e){return function(){return e.isSupported()}}var nt,ot=function(e,t,s){var i={};function r(t,r,a,n,o){var c=s(e,t,r,a,n,o);return i[t]=c,c}var a,n=Object.assign({},t,{hostNonTLS:e.wsHost+":"+e.wsPort,hostTLS:e.wsHost+":"+e.wssPort,httpPath:e.wsPath}),o=Object.assign({},n,{useTLS:!0}),c=Object.assign({},t,{hostNonTLS:e.httpHost+":"+e.httpPort,hostTLS:e.httpHost+":"+e.httpsPort,httpPath:e.httpPath}),d={loop:!0,timeout:15e3,timeoutLimit:6e4},h=new Ye({lives:2,minPingDelay:1e4,maxPingDelay:e.activityTimeout}),u=new Ye({lives:2,minPingDelay:1e4,maxPingDelay:e.activityTimeout}),l=r("ws","ws",3,n,h),f=r("wss","ws",3,o,h),p=r("sockjs","sockjs",1,c),m=r("xhr_streaming","xhr_streaming",1,c,u),b=r("xdr_streaming","xdr_streaming",1,c,u),g=r("xhr_polling","xhr_polling",1,c),y=r("xdr_polling","xdr_polling",1,c),v=new Ze([l],d),w=new Ze([f],d),k=new Ze([p],d),S=new Ze([new it(at(m),m,b)],d),_=new Ze([new it(at(g),g,y)],d),O=new Ze([new it(at(S),new Qe([S,new st(_,{delay:4e3})]),_)],d),T=new it(at(O),O,k);return a=t.useTLS?new Qe([v,new st(T,{delay:2e3})]):new Qe([v,new st(w,{delay:2e3}),new st(T,{delay:5e3})]),new $e(new rt(new it(at(l),a,T)),i,{ttl:18e5,timeline:t.timeline,useTLS:t.useTLS})},ct={getRequest:function(e){var t=new window.XDomainRequest;return t.ontimeout=function(){e.emit("error",new p),e.close()},t.onerror=function(t){e.emit("error",t),e.close()},t.onprogress=function(){t.responseText&&t.responseText.length>0&&e.onChunk(200,t.responseText)},t.onload=function(){t.responseText&&t.responseText.length>0&&e.onChunk(200,t.responseText),e.emit("finished",200),e.close()},t},abortRequest:function(e){e.ontimeout=e.onerror=e.onprogress=e.onload=null,e.abort()}},dt=function(){var e=function(t,s){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(t,s)};return function(t,s){function i(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(i.prototype=s.prototype,new i)}}(),ht=function(e){function t(t,s,i){var r=e.call(this)||this;return r.hooks=t,r.method=s,r.url=i,r}return dt(t,e),t.prototype.start=function(e){var t=this;this.position=0,this.xhr=this.hooks.getRequest(this),this.unloader=function(){t.close()},kt.addUnloadListener(this.unloader),this.xhr.open(this.method,this.url,!0),this.xhr.setRequestHeader&&this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.send(e)},t.prototype.close=function(){this.unloader&&(kt.removeUnloadListener(this.unloader),this.unloader=null),this.xhr&&(this.hooks.abortRequest(this.xhr),this.xhr=null)},t.prototype.onChunk=function(e,t){for(;;){var s=this.advanceBuffer(t);if(!s)break;this.emit("chunk",{status:e,data:s})}this.isBufferTooLong(t)&&this.emit("buffer_too_long")},t.prototype.advanceBuffer=function(e){var t=e.slice(this.position),s=t.indexOf("\n");return-1!==s?(this.position+=s+1,t.slice(0,s)):null},t.prototype.isBufferTooLong=function(e){return this.position===e.length&&e.length>262144},t}(de);!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSED=3]="CLOSED"}(nt||(nt={}));var ut=nt,lt=1;function ft(e){var t=-1===e.indexOf("?")?"?":"&";return e+t+"t="+ +new Date+"&n="+lt++}function pt(e){return Math.floor(Math.random()*e)}var mt,bt=function(){function e(e,t){this.hooks=e,this.session=pt(1e3)+"/"+function(e){for(var t=[],s=0;s<e;s++)t.push(pt(32).toString(32));return t.join("")}(8),this.location=function(e){var t=/([^\?]*)\/*(\??.*)/.exec(e);return{base:t[1],queryString:t[2]}}(t),this.readyState=ut.CONNECTING,this.openStream()}return e.prototype.send=function(e){return this.sendRaw(JSON.stringify([e]))},e.prototype.ping=function(){this.hooks.sendHeartbeat(this)},e.prototype.close=function(e,t){this.onClose(e,t,!0)},e.prototype.sendRaw=function(e){if(this.readyState!==ut.OPEN)return!1;try{return kt.createSocketRequest("POST",ft((t=this.location,s=this.session,t.base+"/"+s+"/xhr_send"))).start(e),!0}catch(e){return!1}var t,s},e.prototype.reconnect=function(){this.closeStream(),this.openStream()},e.prototype.onClose=function(e,t,s){this.closeStream(),this.readyState=ut.CLOSED,this.onclose&&this.onclose({code:e,reason:t,wasClean:s})},e.prototype.onChunk=function(e){var t;if(200===e.status)switch(this.readyState===ut.OPEN&&this.onActivity(),e.data.slice(0,1)){case"o":t=JSON.parse(e.data.slice(1)||"{}"),this.onOpen(t);break;case"a":t=JSON.parse(e.data.slice(1)||"[]");for(var s=0;s<t.length;s++)this.onEvent(t[s]);break;case"m":t=JSON.parse(e.data.slice(1)||"null"),this.onEvent(t);break;case"h":this.hooks.onHeartbeat(this);break;case"c":t=JSON.parse(e.data.slice(1)||"[]"),this.onClose(t[0],t[1],!0)}},e.prototype.onOpen=function(e){var t,s,i;this.readyState===ut.CONNECTING?(e&&e.hostname&&(this.location.base=(t=this.location.base,s=e.hostname,(i=/(https?:\/\/)([^\/:]+)((\/|:)?.*)/.exec(t))[1]+s+i[3])),this.readyState=ut.OPEN,this.onopen&&this.onopen()):this.onClose(1006,"Server lost session",!0)},e.prototype.onEvent=function(e){this.readyState===ut.OPEN&&this.onmessage&&this.onmessage({data:e})},e.prototype.onActivity=function(){this.onactivity&&this.onactivity()},e.prototype.onError=function(e){this.onerror&&this.onerror(e)},e.prototype.openStream=function(){var e=this;this.stream=kt.createSocketRequest("POST",ft(this.hooks.getReceiveURL(this.location,this.session))),this.stream.bind("chunk",(function(t){e.onChunk(t)})),this.stream.bind("finished",(function(t){e.hooks.onFinished(e,t)})),this.stream.bind("buffer_too_long",(function(){e.reconnect()}));try{this.stream.start()}catch(t){q.defer((function(){e.onError(t),e.onClose(1006,"Could not start streaming",!1)}))}},e.prototype.closeStream=function(){this.stream&&(this.stream.unbind_all(),this.stream.close(),this.stream=null)},e}(),gt={getReceiveURL:function(e,t){return e.base+"/"+t+"/xhr_streaming"+e.queryString},onHeartbeat:function(e){e.sendRaw("[]")},sendHeartbeat:function(e){e.sendRaw("[]")},onFinished:function(e,t){e.onClose(1006,"Connection interrupted ("+t+")",!1)}},yt={getReceiveURL:function(e,t){return e.base+"/"+t+"/xhr"+e.queryString},onHeartbeat:function(){},sendHeartbeat:function(e){e.sendRaw("[]")},onFinished:function(e,t){200===t?e.reconnect():e.onClose(1006,"Connection interrupted ("+t+")",!1)}},vt={getRequest:function(e){var t=new(kt.getXHRAPI());return t.onreadystatechange=t.onprogress=function(){switch(t.readyState){case 3:t.responseText&&t.responseText.length>0&&e.onChunk(t.status,t.responseText);break;case 4:t.responseText&&t.responseText.length>0&&e.onChunk(t.status,t.responseText),e.emit("finished",t.status),e.close()}},t},abortRequest:function(e){e.onreadystatechange=null,e.abort()}},wt={createStreamingSocket:function(e){return this.createSocket(gt,e)},createPollingSocket:function(e){return this.createSocket(yt,e)},createSocket:function(e,t){return new bt(e,t)},createXHR:function(e,t){return this.createRequest(vt,e,t)},createRequest:function(e,t,s){return new ht(e,t,s)},createXDR:function(e,t){return this.createRequest(ct,e,t)}},kt={nextAuthCallbackID:1,auth_callbacks:{},ScriptReceivers:a,DependenciesReceivers:c,getDefaultStrategy:ot,Transports:_e,transportConnectionInitializer:function(){var e=this;e.timeline.info(e.buildTimelineMessage({transport:e.name+(e.options.useTLS?"s":"")})),e.hooks.isInitialized()?e.changeState("initialized"):e.hooks.file?(e.changeState("initializing"),d.load(e.hooks.file,{useTLS:e.options.useTLS},(function(t,s){e.hooks.isInitialized()?(e.changeState("initialized"),s(!0)):(t&&e.onError(t),e.onClose(),s(!1))}))):e.onClose()},HTTPFactory:wt,TimelineTransport:te,getXHRAPI:function(){return window.XMLHttpRequest},getWebSocketAPI:function(){return window.WebSocket||window.MozWebSocket},setup:function(e){var t=this;window.Pusher=e;var s=function(){t.onDocumentBody(e.ready)};window.JSON?s():d.load("json2",{},s)},getDocument:function(){return document},getProtocol:function(){return this.getDocument().location.protocol},getAuthorizers:function(){return{ajax:k,jsonp:J}},onDocumentBody:function(e){var t=this;document.body?e():setTimeout((function(){t.onDocumentBody(e)}),0)},createJSONPRequest:function(e,t){return new ee(e,t)},createScriptRequest:function(e){return new $(e)},getLocalStorage:function(){try{return window.localStorage}catch(e){return}},createXHR:function(){return this.getXHRAPI()?this.createXMLHttpRequest():this.createMicrosoftXHR()},createXMLHttpRequest:function(){return new(this.getXHRAPI())},createMicrosoftXHR:function(){return new ActiveXObject("Microsoft.XMLHTTP")},getNetwork:function(){return Te},createWebSocket:function(e){return new(this.getWebSocketAPI())(e)},createSocketRequest:function(e,t){if(this.isXHRSupported())return this.HTTPFactory.createXHR(e,t);if(this.isXDRSupported(0===t.indexOf("https:")))return this.HTTPFactory.createXDR(e,t);throw"Cross-origin HTTP requests are not supported"},isXHRSupported:function(){var e=this.getXHRAPI();return Boolean(e)&&void 0!==(new e).withCredentials},isXDRSupported:function(e){var t=e?"https:":"http:",s=this.getProtocol();return Boolean(window.XDomainRequest)&&s===t},addUnloadListener:function(e){void 0!==window.addEventListener?window.addEventListener("unload",e,!1):void 0!==window.attachEvent&&window.attachEvent("onunload",e)},removeUnloadListener:function(e){void 0!==window.addEventListener?window.removeEventListener("unload",e,!1):void 0!==window.detachEvent&&window.detachEvent("onunload",e)}};!function(e){e[e.ERROR=3]="ERROR",e[e.INFO=6]="INFO",e[e.DEBUG=7]="DEBUG"}(mt||(mt={}));var St=mt,_t=function(){function e(e,t,s){this.key=e,this.session=t,this.events=[],this.options=s||{},this.sent=0,this.uniqueID=0}return e.prototype.log=function(e,t){e<=this.options.level&&(this.events.push(D({},t,{timestamp:q.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())},e.prototype.error=function(e){this.log(St.ERROR,e)},e.prototype.info=function(e){this.log(St.INFO,e)},e.prototype.debug=function(e){this.log(St.DEBUG,e)},e.prototype.isEmpty=function(){return 0===this.events.length},e.prototype.send=function(e,t){var s=this,i=D({session:this.session,bundle:this.sent+1,key:this.key,lib:"js",version:this.options.version,cluster:this.options.cluster,features:this.options.features,timeline:this.events},this.options.params);return this.events=[],e(i,(function(e,i){e||s.sent++,t&&t(e,i)})),!0},e.prototype.generateUniqueID=function(){return this.uniqueID++,this.uniqueID},e}(),Ot=function(){function e(e,t,s,i){this.name=e,this.priority=t,this.transport=s,this.options=i||{}}return e.prototype.isSupported=function(){return this.transport.isSupported({useTLS:this.options.useTLS})},e.prototype.connect=function(e,t){var s=this;if(!this.isSupported())return Tt(new v,t);if(this.priority<e)return Tt(new m,t);var i=!1,r=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),a=null,n=function(){r.unbind("initialized",n),r.connect()},o=function(){a=Xe.createHandshake(r,(function(e){i=!0,h(),t(null,e)}))},c=function(e){h(),t(e)},d=function(){var e;h(),e=Z(r),t(new b(e))},h=function(){r.unbind("initialized",n),r.unbind("open",o),r.unbind("error",c),r.unbind("closed",d)};return r.bind("initialized",n),r.bind("open",o),r.bind("error",c),r.bind("closed",d),r.initialize(),{abort:function(){i||(h(),a?a.close():r.close())},forceMinPriority:function(e){i||s.priority<e&&(a?a.close():r.close())}}},e}();function Tt(e,t){return q.defer((function(){t(e)})),{abort:function(){},forceMinPriority:function(){}}}var xt=kt.Transports,Ct=function(e,t,s,i,r,a){var n,o=xt[s];if(!o)throw new y(s);return e.enabledTransports&&-1===G(e.enabledTransports,t)||e.disabledTransports&&-1!==G(e.disabledTransports,t)?n=It:(r=Object.assign({ignoreNullOrigin:e.ignoreNullOrigin},r),n=new Ot(t,i,a?a.getAssistant(o):o,r)),n},It={isSupported:function(){return!1},connect:function(e,t){var s=q.defer((function(){t(new v)}));return{abort:function(){s.ensureAborted()},forceMinPriority:function(){}}}};function Mt(e){return e.httpHost?e.httpHost:e.cluster?"sockjs-"+e.cluster+".pusher.com":n.httpHost}function Nt(e){return e.wsHost?e.wsHost:e.cluster?At(e.cluster):At(n.cluster)}function At(e){return"ws-"+e+".pusher.com"}function Et(e){return"https:"===kt.getProtocol()||!1!==e.forceTLS}function Pt(e){return"enableStats"in e?e.enableStats:"disableStats"in e&&!e.disableStats}var Bt=function(){function e(t,s){var i,r,a=this;if(function(e){if(null==e)throw"You must pass your app key when you instantiate Pusher."}(t),!(s=s||{}).cluster&&!s.wsHost&&!s.httpHost){var o=u("javascriptQuickStart");Q.warn("You should always specify a cluster when connecting. "+o)}"disableStats"in s&&Q.warn("The disableStats option is deprecated in favor of enableStats"),this.key=t,this.config=(r={activityTimeout:(i=s).activityTimeout||n.activityTimeout,authEndpoint:i.authEndpoint||n.authEndpoint,authTransport:i.authTransport||n.authTransport,cluster:i.cluster||n.cluster,httpPath:i.httpPath||n.httpPath,httpPort:i.httpPort||n.httpPort,httpsPort:i.httpsPort||n.httpsPort,pongTimeout:i.pongTimeout||n.pongTimeout,statsHost:i.statsHost||n.stats_host,unavailableTimeout:i.unavailableTimeout||n.unavailableTimeout,wsPath:i.wsPath||n.wsPath,wsPort:i.wsPort||n.wsPort,wssPort:i.wssPort||n.wssPort,enableStats:Pt(i),httpHost:Mt(i),useTLS:Et(i),wsHost:Nt(i)},"auth"in i&&(r.auth=i.auth),"authorizer"in i&&(r.authorizer=i.authorizer),"disabledTransports"in i&&(r.disabledTransports=i.disabledTransports),"enabledTransports"in i&&(r.enabledTransports=i.enabledTransports),"ignoreNullOrigin"in i&&(r.ignoreNullOrigin=i.ignoreNullOrigin),"timelineParams"in i&&(r.timelineParams=i.timelineParams),"nacl"in i&&(r.nacl=i.nacl),r),this.channels=Xe.createChannels(),this.global_emitter=new de,this.sessionID=Math.floor(1e9*Math.random()),this.timeline=new _t(this.key,this.sessionID,{cluster:this.config.cluster,features:e.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:St.INFO,version:n.VERSION}),this.config.enableStats&&(this.timelineSender=Xe.createTimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/"+kt.TimelineTransport.name})),this.connection=Xe.createConnectionManager(this.key,{getStrategy:function(e){return kt.getDefaultStrategy(a.config,e,Ct)},timeline:this.timeline,activityTimeout:this.config.activityTimeout,pongTimeout:this.config.pongTimeout,unavailableTimeout:this.config.unavailableTimeout,useTLS:Boolean(this.config.useTLS)}),this.connection.bind("connected",(function(){a.subscribeAll(),a.timelineSender&&a.timelineSender.send(a.connection.isUsingTLS())})),this.connection.bind("message",(function(e){var t=0===e.event.indexOf("pusher_internal:");if(e.channel){var s=a.channel(e.channel);s&&s.handleEvent(e)}t||a.global_emitter.emit(e.event,e.data)})),this.connection.bind("connecting",(function(){a.channels.disconnect()})),this.connection.bind("disconnected",(function(){a.channels.disconnect()})),this.connection.bind("error",(function(e){Q.warn(e)})),e.instances.push(this),this.timeline.info({instances:e.instances.length}),e.isReady&&this.connect()}return e.ready=function(){e.isReady=!0;for(var t=0,s=e.instances.length;t<s;t++)e.instances[t].connect()},e.getClientFeatures=function(){return U(W({ws:kt.Transports.ws},(function(e){return e.isSupported({})})))},e.prototype.channel=function(e){return this.channels.find(e)},e.prototype.allChannels=function(){return this.channels.all()},e.prototype.connect=function(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var e=this.connection.isUsingTLS(),t=this.timelineSender;this.timelineSenderTimer=new L(6e4,(function(){t.send(e)}))}},e.prototype.disconnect=function(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)},e.prototype.bind=function(e,t,s){return this.global_emitter.bind(e,t,s),this},e.prototype.unbind=function(e,t,s){return this.global_emitter.unbind(e,t,s),this},e.prototype.bind_global=function(e){return this.global_emitter.bind_global(e),this},e.prototype.unbind_global=function(e){return this.global_emitter.unbind_global(e),this},e.prototype.unbind_all=function(e){return this.global_emitter.unbind_all(),this},e.prototype.subscribeAll=function(){var e;for(e in this.channels.channels)this.channels.channels.hasOwnProperty(e)&&this.subscribe(e)},e.prototype.subscribe=function(e){var t=this.channels.add(e,this);return t.subscriptionPending&&t.subscriptionCancelled?t.reinstateSubscription():t.subscriptionPending||"connected"!==this.connection.state||t.subscribe(),t},e.prototype.unsubscribe=function(e){var t=this.channels.find(e);t&&t.subscriptionPending?t.cancelSubscription():(t=this.channels.remove(e))&&t.subscribed&&t.unsubscribe()},e.prototype.send_event=function(e,t,s){return this.connection.send_event(e,t,s)},e.prototype.shouldUseTLS=function(){return this.config.useTLS},e.instances=[],e.isReady=!1,e.logToConsole=!1,e.Runtime=kt,e.ScriptReceivers=kt.ScriptReceivers,e.DependenciesReceivers=kt.DependenciesReceivers,e.auth_callbacks=kt.auth_callbacks,e}(),Vt=t.default=Bt;kt.setup(Bt)}])},e.exports=t()},2587:e=>{"use strict";function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,s,i,r){s=s||"&",i=i||"=";var a={};if("string"!=typeof e||0===e.length)return a;var n=/\+/g;e=e.split(s);var o=1e3;r&&"number"==typeof r.maxKeys&&(o=r.maxKeys);var c=e.length;o>0&&c>o&&(c=o);for(var d=0;d<c;++d){var h,u,l,f,p=e[d].replace(n,"%20"),m=p.indexOf(i);m>=0?(h=p.substr(0,m),u=p.substr(m+1)):(h=p,u=""),l=decodeURIComponent(h),f=decodeURIComponent(u),t(a,l)?Array.isArray(a[l])?a[l].push(f):a[l]=[a[l],f]:a[l]=f}return a}},2182:e=>{"use strict";var t=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,s,i,r){return s=s||"&",i=i||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(r){var a=encodeURIComponent(t(r))+i;return Array.isArray(e[r])?e[r].map((function(e){return a+encodeURIComponent(t(e))})).join(s):a+encodeURIComponent(t(e[r]))})).join(s):r?encodeURIComponent(t(r))+i+encodeURIComponent(t(e)):""}},7673:(e,t,s)=>{"use strict";t.decode=t.parse=s(2587),t.encode=t.stringify=s(2182)},74:(e,t,s)=>{e.exports=s(6753)},6753:(e,t,s)=>{"use strict";var i=s(8212),r=Object.keys||function(e){var t=[];for(var s in e)t.push(s);return t};e.exports=u;var a=Object.create(s(6497));a.inherits=s(5717);var n=s(9481),o=s(4229);a.inherits(u,n);for(var c=r(o.prototype),d=0;d<c.length;d++){var h=c[d];u.prototype[h]||(u.prototype[h]=o.prototype[h])}function u(e){if(!(this instanceof u))return new u(e);n.call(this,e),o.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",l)}function l(){this.allowHalfOpen||this._writableState.ended||i.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),u.prototype._destroy=function(e,t){this.push(null),this.end(),i.nextTick(t,e)}},2725:(e,t,s)=>{"use strict";e.exports=a;var i=s(4605),r=Object.create(s(6497));function a(e){if(!(this instanceof a))return new a(e);i.call(this,e)}r.inherits=s(5717),r.inherits(a,i),a.prototype._transform=function(e,t,s){s(null,e)}},9481:(e,t,s)=>{"use strict";var i=s(4155),r=s(8212);e.exports=v;var a,n=s(5826);v.ReadableState=y;s(7187).EventEmitter;var o=function(e,t){return e.listeners(t).length},c=s(2503),d=s(9509).Buffer,h=s.g.Uint8Array||function(){};var u=Object.create(s(6497));u.inherits=s(5717);var l=s(4616),f=void 0;f=l&&l.debuglog?l.debuglog("stream"):function(){};var p,m=s(5057),b=s(1195);u.inherits(v,c);var g=["error","close","destroy","pause","resume"];function y(e,t){e=e||{};var i=t instanceof(a=a||s(6753));this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,n=e.readableHighWaterMark,o=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i&&(n||0===n)?n:o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(p||(p=s(4626).s),this.decoder=new p(e.encoding),this.encoding=e.encoding)}function v(e){if(a=a||s(6753),!(this instanceof v))return new v(e);this._readableState=new y(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),c.call(this)}function w(e,t,s,i,r){var a,n=e._readableState;null===t?(n.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var s=t.decoder.end();s&&s.length&&(t.buffer.push(s),t.length+=t.objectMode?1:s.length)}t.ended=!0,O(e)}(e,n)):(r||(a=function(e,t){var s;i=t,d.isBuffer(i)||i instanceof h||"string"==typeof t||void 0===t||e.objectMode||(s=new TypeError("Invalid non-string/buffer chunk"));var i;return s}(n,t)),a?e.emit("error",a):n.objectMode||t&&t.length>0?("string"==typeof t||n.objectMode||Object.getPrototypeOf(t)===d.prototype||(t=function(e){return d.from(e)}(t)),i?n.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):k(e,n,t,!0):n.ended?e.emit("error",new Error("stream.push() after EOF")):(n.reading=!1,n.decoder&&!s?(t=n.decoder.write(t),n.objectMode||0!==t.length?k(e,n,t,!1):x(e,n)):k(e,n,t,!1))):i||(n.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(n)}function k(e,t,s,i){t.flowing&&0===t.length&&!t.sync?(e.emit("data",s),e.read(0)):(t.length+=t.objectMode?1:s.length,i?t.buffer.unshift(s):t.buffer.push(s),t.needReadable&&O(e)),x(e,t)}Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),v.prototype.destroy=b.destroy,v.prototype._undestroy=b.undestroy,v.prototype._destroy=function(e,t){this.push(null),t(e)},v.prototype.push=function(e,t){var s,i=this._readableState;return i.objectMode?s=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=d.from(e,t),t=""),s=!0),w(this,e,t,!1,s)},v.prototype.unshift=function(e){return w(this,e,null,!0,!1)},v.prototype.isPaused=function(){return!1===this._readableState.flowing},v.prototype.setEncoding=function(e){return p||(p=s(4626).s),this._readableState.decoder=new p(e),this._readableState.encoding=e,this};var S=8388608;function _(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=S?e=S:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function O(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(f("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?r.nextTick(T,e):T(e))}function T(e){f("emit readable"),e.emit("readable"),N(e)}function x(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(C,e,t))}function C(e,t){for(var s=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(f("maybeReadMore read 0"),e.read(0),s!==t.length);)s=t.length;t.readingMore=!1}function I(e){f("readable nexttick read 0"),e.read(0)}function M(e,t){t.reading||(f("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),N(e),t.flowing&&!t.reading&&e.read(0)}function N(e){var t=e._readableState;for(f("flow",t.flowing);t.flowing&&null!==e.read(););}function A(e,t){return 0===t.length?null:(t.objectMode?s=t.buffer.shift():!e||e>=t.length?(s=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):s=function(e,t,s){var i;e<t.head.data.length?(i=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):i=e===t.head.data.length?t.shift():s?function(e,t){var s=t.head,i=1,r=s.data;e-=r.length;for(;s=s.next;){var a=s.data,n=e>a.length?a.length:e;if(n===a.length?r+=a:r+=a.slice(0,e),0===(e-=n)){n===a.length?(++i,s.next?t.head=s.next:t.head=t.tail=null):(t.head=s,s.data=a.slice(n));break}++i}return t.length-=i,r}(e,t):function(e,t){var s=d.allocUnsafe(e),i=t.head,r=1;i.data.copy(s),e-=i.data.length;for(;i=i.next;){var a=i.data,n=e>a.length?a.length:e;if(a.copy(s,s.length-e,0,n),0===(e-=n)){n===a.length?(++r,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i,i.data=a.slice(n));break}++r}return t.length-=r,s}(e,t);return i}(e,t.buffer,t.decoder),s);var s}function E(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,r.nextTick(P,t,e))}function P(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function B(e,t){for(var s=0,i=e.length;s<i;s++)if(e[s]===t)return s;return-1}v.prototype.read=function(e){f("read",e),e=parseInt(e,10);var t=this._readableState,s=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return f("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?E(this):O(this),null;if(0===(e=_(e,t))&&t.ended)return 0===t.length&&E(this),null;var i,r=t.needReadable;return f("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&f("length less than watermark",r=!0),t.ended||t.reading?f("reading or ended",r=!1):r&&(f("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=_(s,t))),null===(i=e>0?A(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),s!==e&&t.ended&&E(this)),null!==i&&this.emit("data",i),i},v.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},v.prototype.pipe=function(e,t){var s=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=e;break;case 1:a.pipes=[a.pipes,e];break;default:a.pipes.push(e)}a.pipesCount+=1,f("pipe count=%d opts=%j",a.pipesCount,t);var c=(!t||!1!==t.end)&&e!==i.stdout&&e!==i.stderr?h:v;function d(t,i){f("onunpipe"),t===s&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,f("cleanup"),e.removeListener("close",g),e.removeListener("finish",y),e.removeListener("drain",u),e.removeListener("error",b),e.removeListener("unpipe",d),s.removeListener("end",h),s.removeListener("end",v),s.removeListener("data",m),l=!0,!a.awaitDrain||e._writableState&&!e._writableState.needDrain||u())}function h(){f("onend"),e.end()}a.endEmitted?r.nextTick(c):s.once("end",c),e.on("unpipe",d);var u=function(e){return function(){var t=e._readableState;f("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,N(e))}}(s);e.on("drain",u);var l=!1;var p=!1;function m(t){f("ondata"),p=!1,!1!==e.write(t)||p||((1===a.pipesCount&&a.pipes===e||a.pipesCount>1&&-1!==B(a.pipes,e))&&!l&&(f("false write response, pause",s._readableState.awaitDrain),s._readableState.awaitDrain++,p=!0),s.pause())}function b(t){f("onerror",t),v(),e.removeListener("error",b),0===o(e,"error")&&e.emit("error",t)}function g(){e.removeListener("finish",y),v()}function y(){f("onfinish"),e.removeListener("close",g),v()}function v(){f("unpipe"),s.unpipe(e)}return s.on("data",m),function(e,t,s){if("function"==typeof e.prependListener)return e.prependListener(t,s);e._events&&e._events[t]?n(e._events[t])?e._events[t].unshift(s):e._events[t]=[s,e._events[t]]:e.on(t,s)}(e,"error",b),e.once("close",g),e.once("finish",y),e.emit("pipe",s),a.flowing||(f("pipe resume"),s.resume()),e},v.prototype.unpipe=function(e){var t=this._readableState,s={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,s)),this;if(!e){var i=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<r;a++)i[a].emit("unpipe",this,s);return this}var n=B(t.pipes,e);return-1===n||(t.pipes.splice(n,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,s)),this},v.prototype.on=function(e,t){var s=c.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&O(this):r.nextTick(I,this))}return s},v.prototype.addListener=v.prototype.on,v.prototype.resume=function(){var e=this._readableState;return e.flowing||(f("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(M,e,t))}(this,e)),this},v.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},v.prototype.wrap=function(e){var t=this,s=this._readableState,i=!1;for(var r in e.on("end",(function(){if(f("wrapped end"),s.decoder&&!s.ended){var e=s.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(r){(f("wrapped data"),s.decoder&&(r=s.decoder.write(r)),s.objectMode&&null==r)||(s.objectMode||r&&r.length)&&(t.push(r)||(i=!0,e.pause()))})),e)void 0===this[r]&&"function"==typeof e[r]&&(this[r]=function(t){return function(){return e[t].apply(e,arguments)}}(r));for(var a=0;a<g.length;a++)e.on(g[a],this.emit.bind(this,g[a]));return this._read=function(t){f("wrapped _read",t),i&&(i=!1,e.resume())},this},Object.defineProperty(v.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),v._fromList=A},4605:(e,t,s)=>{"use strict";e.exports=n;var i=s(6753),r=Object.create(s(6497));function a(e,t){var s=this._transformState;s.transforming=!1;var i=s.writecb;if(!i)return this.emit("error",new Error("write callback called multiple times"));s.writechunk=null,s.writecb=null,null!=t&&this.push(t),i(e);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function n(e){if(!(this instanceof n))return new n(e);i.call(this,e),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",o)}function o(){var e=this;"function"==typeof this._flush?this._flush((function(t,s){c(e,t,s)})):c(this,null,null)}function c(e,t,s){if(t)return e.emit("error",t);if(null!=s&&e.push(s),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}r.inherits=s(5717),r.inherits(n,i),n.prototype.push=function(e,t){return this._transformState.needTransform=!1,i.prototype.push.call(this,e,t)},n.prototype._transform=function(e,t,s){throw new Error("_transform() is not implemented")},n.prototype._write=function(e,t,s){var i=this._transformState;if(i.writecb=s,i.writechunk=e,i.writeencoding=t,!i.transforming){var r=this._readableState;(i.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},n.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},n.prototype._destroy=function(e,t){var s=this;i.prototype._destroy.call(this,e,(function(e){t(e),s.emit("close")}))}},4229:(e,t,s)=>{"use strict";var i=s(4155),r=s(8212);function a(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,s){var i=e.entry;e.entry=null;for(;i;){var r=i.callback;t.pendingcb--,r(s),i=i.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=g;var n,o=!i.browser&&["v0.10","v0.9."].indexOf(i.version.slice(0,5))>-1?setImmediate:r.nextTick;g.WritableState=b;var c=Object.create(s(6497));c.inherits=s(5717);var d={deprecate:s(4927)},h=s(2503),u=s(9509).Buffer,l=s.g.Uint8Array||function(){};var f,p=s(1195);function m(){}function b(e,t){n=n||s(6753),e=e||{};var i=t instanceof n;this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var c=e.highWaterMark,d=e.writableHighWaterMark,h=this.objectMode?16:16384;this.highWaterMark=c||0===c?c:i&&(d||0===d)?d:h,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var u=!1===e.decodeStrings;this.decodeStrings=!u,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var s=e._writableState,i=s.sync,a=s.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(s),t)!function(e,t,s,i,a){--t.pendingcb,s?(r.nextTick(a,i),r.nextTick(_,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(a(i),e._writableState.errorEmitted=!0,e.emit("error",i),_(e,t))}(e,s,i,t,a);else{var n=k(s);n||s.corked||s.bufferProcessing||!s.bufferedRequest||w(e,s),i?o(v,e,s,n,a):v(e,s,n,a)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function g(e){if(n=n||s(6753),!(f.call(g,this)||this instanceof n))return new g(e);this._writableState=new b(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),h.call(this)}function y(e,t,s,i,r,a,n){t.writelen=i,t.writecb=n,t.writing=!0,t.sync=!0,s?e._writev(r,t.onwrite):e._write(r,a,t.onwrite),t.sync=!1}function v(e,t,s,i){s||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,i(),_(e,t)}function w(e,t){t.bufferProcessing=!0;var s=t.bufferedRequest;if(e._writev&&s&&s.next){var i=t.bufferedRequestCount,r=new Array(i),n=t.corkedRequestsFree;n.entry=s;for(var o=0,c=!0;s;)r[o]=s,s.isBuf||(c=!1),s=s.next,o+=1;r.allBuffers=c,y(e,t,!0,t.length,r,"",n.finish),t.pendingcb++,t.lastBufferedRequest=null,n.next?(t.corkedRequestsFree=n.next,n.next=null):t.corkedRequestsFree=new a(t),t.bufferedRequestCount=0}else{for(;s;){var d=s.chunk,h=s.encoding,u=s.callback;if(y(e,t,!1,t.objectMode?1:d.length,d,h,u),s=s.next,t.bufferedRequestCount--,t.writing)break}null===s&&(t.lastBufferedRequest=null)}t.bufferedRequest=s,t.bufferProcessing=!1}function k(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function S(e,t){e._final((function(s){t.pendingcb--,s&&e.emit("error",s),t.prefinished=!0,e.emit("prefinish"),_(e,t)}))}function _(e,t){var s=k(t);return s&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,r.nextTick(S,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),s}c.inherits(g,h),b.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(b.prototype,"buffer",{get:d.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(f=Function.prototype[Symbol.hasInstance],Object.defineProperty(g,Symbol.hasInstance,{value:function(e){return!!f.call(this,e)||this===g&&(e&&e._writableState instanceof b)}})):f=function(e){return e instanceof this},g.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},g.prototype.write=function(e,t,s){var i,a=this._writableState,n=!1,o=!a.objectMode&&(i=e,u.isBuffer(i)||i instanceof l);return o&&!u.isBuffer(e)&&(e=function(e){return u.from(e)}(e)),"function"==typeof t&&(s=t,t=null),o?t="buffer":t||(t=a.defaultEncoding),"function"!=typeof s&&(s=m),a.ended?function(e,t){var s=new Error("write after end");e.emit("error",s),r.nextTick(t,s)}(this,s):(o||function(e,t,s,i){var a=!0,n=!1;return null===s?n=new TypeError("May not write null values to stream"):"string"==typeof s||void 0===s||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n&&(e.emit("error",n),r.nextTick(i,n),a=!1),a}(this,a,e,s))&&(a.pendingcb++,n=function(e,t,s,i,r,a){if(!s){var n=function(e,t,s){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=u.from(t,s));return t}(t,i,r);i!==n&&(s=!0,r="buffer",i=n)}var o=t.objectMode?1:i.length;t.length+=o;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var d=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:r,isBuf:s,callback:a,next:null},d?d.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else y(e,t,!1,o,i,r,a);return c}(this,a,o,e,t,s)),n},g.prototype.cork=function(){this._writableState.corked++},g.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||w(this,e))},g.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),g.prototype._write=function(e,t,s){s(new Error("_write() is not implemented"))},g.prototype._writev=null,g.prototype.end=function(e,t,s){var i=this._writableState;"function"==typeof e?(s=e,e=null,t=null):"function"==typeof t&&(s=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(e,t,s){t.ending=!0,_(e,t),s&&(t.finished?r.nextTick(s):e.once("finish",s));t.ended=!0,e.writable=!1}(this,i,s)},Object.defineProperty(g.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),g.prototype.destroy=p.destroy,g.prototype._undestroy=p.undestroy,g.prototype._destroy=function(e,t){this.end(),t(e)}},5057:(e,t,s)=>{"use strict";var i=s(9509).Buffer,r=s(2361);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,s=""+t.data;t=t.next;)s+=e+t.data;return s},e.prototype.concat=function(e){if(0===this.length)return i.alloc(0);if(1===this.length)return this.head.data;for(var t,s,r,a=i.allocUnsafe(e>>>0),n=this.head,o=0;n;)t=n.data,s=a,r=o,t.copy(s,r),o+=n.data.length,n=n.next;return a},e}(),r&&r.inspect&&r.inspect.custom&&(e.exports.prototype[r.inspect.custom]=function(){var e=r.inspect({length:this.length});return this.constructor.name+" "+e})},1195:(e,t,s)=>{"use strict";var i=s(8212);function r(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var s=this,a=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return a||n?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||i.nextTick(r,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(i.nextTick(r,s,e),s._writableState&&(s._writableState.errorEmitted=!0)):t&&t(e)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},2503:(e,t,s)=>{e.exports=s(7187).EventEmitter},4626:(e,t,s)=>{"use strict";var i=s(9509).Buffer,r=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===r||!r(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=d,t=4;break;case"utf8":this.fillLast=o,t=4;break;case"base64":this.text=h,this.end=u,t=3;break;default:return this.write=l,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function n(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function o(e){var t=this.lastTotal-this.lastNeed,s=function(e,t,s){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==s?s:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var s=e.toString("utf16le",t);if(s){var i=s.charCodeAt(s.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],s.slice(0,-1)}return s}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function d(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var s=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,s)}return t}function h(e,t){var s=(e.length-t)%3;return 0===s?e.toString("base64",t):(this.lastNeed=3-s,this.lastTotal=3,1===s?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-s))}function u(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function l(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.s=a,a.prototype.write=function(e){if(0===e.length)return"";var t,s;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";s=this.lastNeed,this.lastNeed=0}else s=0;return s<e.length?t?t+this.text(e,s):this.text(e,s):t||""},a.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},a.prototype.text=function(e,t){var s=function(e,t,s){var i=t.length-1;if(i<s)return 0;var r=n(t[i]);if(r>=0)return r>0&&(e.lastNeed=r-1),r;if(--i<s||-2===r)return 0;if((r=n(t[i]))>=0)return r>0&&(e.lastNeed=r-2),r;if(--i<s||-2===r)return 0;if((r=n(t[i]))>=0)return r>0&&(2===r?r=0:e.lastNeed=r-3),r;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=s;var i=e.length-(s-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},a.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},5799:(e,t,s)=>{e.exports=s(8473).PassThrough},8473:(e,t,s)=>{(t=e.exports=s(9481)).Stream=t,t.Readable=t,t.Writable=s(4229),t.Duplex=s(6753),t.Transform=s(4605),t.PassThrough=s(2725)},4219:(e,t,s)=>{e.exports=s(8473).Transform},4796:(e,t,s)=>{e.exports=s(4229)},5666:e=>{var t=function(e){"use strict";var t,s=Object.prototype,i=s.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",n=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function c(e,t,s){return Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,s){return e[t]=s}}function d(e,t,s,i){var r=t&&t.prototype instanceof b?t:b,a=Object.create(r.prototype),n=new I(i||[]);return a._invoke=function(e,t,s){var i=u;return function(r,a){if(i===f)throw new Error("Generator is already running");if(i===p){if("throw"===r)throw a;return N()}for(s.method=r,s.arg=a;;){var n=s.delegate;if(n){var o=T(n,s);if(o){if(o===m)continue;return o}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(i===u)throw i=p,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);i=f;var c=h(e,t,s);if("normal"===c.type){if(i=s.done?p:l,c.arg===m)continue;return{value:c.arg,done:s.done}}"throw"===c.type&&(i=p,s.method="throw",s.arg=c.arg)}}}(e,s,n),a}function h(e,t,s){try{return{type:"normal",arg:e.call(t,s)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var u="suspendedStart",l="suspendedYield",f="executing",p="completed",m={};function b(){}function g(){}function y(){}var v={};v[a]=function(){return this};var w=Object.getPrototypeOf,k=w&&w(w(M([])));k&&k!==s&&i.call(k,a)&&(v=k);var S=y.prototype=b.prototype=Object.create(v);function _(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function s(r,a,n,o){var c=h(e[r],e,a);if("throw"!==c.type){var d=c.arg,u=d.value;return u&&"object"==typeof u&&i.call(u,"__await")?t.resolve(u.__await).then((function(e){s("next",e,n,o)}),(function(e){s("throw",e,n,o)})):t.resolve(u).then((function(e){d.value=e,n(d)}),(function(e){return s("throw",e,n,o)}))}o(c.arg)}var r;this._invoke=function(e,i){function a(){return new t((function(t,r){s(e,i,t,r)}))}return r=r?r.then(a,a):a()}}function T(e,s){var i=e.iterator[s.method];if(i===t){if(s.delegate=null,"throw"===s.method){if(e.iterator.return&&(s.method="return",s.arg=t,T(e,s),"throw"===s.method))return m;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var r=h(i,e.iterator,s.arg);if("throw"===r.type)return s.method="throw",s.arg=r.arg,s.delegate=null,m;var a=r.arg;return a?a.done?(s[e.resultName]=a.value,s.next=e.nextLoc,"return"!==s.method&&(s.method="next",s.arg=t),s.delegate=null,m):a:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,m)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function M(e){if(e){var s=e[a];if(s)return s.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function s(){for(;++r<e.length;)if(i.call(e,r))return s.value=e[r],s.done=!1,s;return s.value=t,s.done=!0,s};return n.next=n}}return{next:N}}function N(){return{value:t,done:!0}}return g.prototype=S.constructor=y,y.constructor=g,g.displayName=c(y,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,o,"GeneratorFunction")),e.prototype=Object.create(S),e},e.awrap=function(e){return{__await:e}},_(O.prototype),O.prototype[n]=function(){return this},e.AsyncIterator=O,e.async=function(t,s,i,r,a){void 0===a&&(a=Promise);var n=new O(d(t,s,i,r),a);return e.isGeneratorFunction(s)?n:n.next().then((function(e){return e.done?e.value:n.next()}))},_(S),c(S,o,"Generator"),S[a]=function(){return this},S.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var s in e)t.push(s);return t.reverse(),function s(){for(;t.length;){var i=t.pop();if(i in e)return s.value=i,s.done=!1,s}return s.done=!0,s}},e.values=M,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var s in this)"t"===s.charAt(0)&&i.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var s=this;function r(i,r){return o.type="throw",o.arg=e,s.next=i,r&&(s.method="next",s.arg=t),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var n=this.tryEntries[a],o=n.completion;if("root"===n.tryLoc)return r("end");if(n.tryLoc<=this.prev){var c=i.call(n,"catchLoc"),d=i.call(n,"finallyLoc");if(c&&d){if(this.prev<n.catchLoc)return r(n.catchLoc,!0);if(this.prev<n.finallyLoc)return r(n.finallyLoc)}else if(c){if(this.prev<n.catchLoc)return r(n.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return r(n.finallyLoc)}}}},abrupt:function(e,t){for(var s=this.tryEntries.length-1;s>=0;--s){var r=this.tryEntries[s];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var n=a?a.completion:{};return n.type=e,n.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(n)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var s=this.tryEntries[t];if(s.finallyLoc===e)return this.complete(s.completion,s.afterLoc),C(s),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var s=this.tryEntries[t];if(s.tryLoc===e){var i=s.completion;if("throw"===i.type){var r=i.arg;C(s)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,s,i){return this.delegate={iterator:M(e),resultName:s,nextLoc:i},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}},9509:(e,t,s)=>{var i=s(8764),r=i.Buffer;function a(e,t){for(var s in e)t[s]=e[s]}function n(e,t,s){return r(e,t,s)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=i:(a(i,t),t.Buffer=n),a(r,n),n.from=function(e,t,s){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,s)},n.alloc=function(e,t,s){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=r(e);return void 0!==t?"string"==typeof s?i.fill(t,s):i.fill(t):i.fill(0),i},n.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},n.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},2830:(e,t,s)=>{e.exports=r;var i=s(7187).EventEmitter;function r(){i.call(this)}s(5717)(r,i),r.Readable=s(8473),r.Writable=s(4796),r.Duplex=s(74),r.Transform=s(4219),r.PassThrough=s(5799),r.Stream=r,r.prototype.pipe=function(e,t){var s=this;function r(t){e.writable&&!1===e.write(t)&&s.pause&&s.pause()}function a(){s.readable&&s.resume&&s.resume()}s.on("data",r),e.on("drain",a),e._isStdio||t&&!1===t.end||(s.on("end",o),s.on("close",c));var n=!1;function o(){n||(n=!0,e.end())}function c(){n||(n=!0,"function"==typeof e.destroy&&e.destroy())}function d(e){if(h(),0===i.listenerCount(this,"error"))throw e}function h(){s.removeListener("data",r),e.removeListener("drain",a),s.removeListener("end",o),s.removeListener("close",c),s.removeListener("error",d),e.removeListener("error",d),s.removeListener("end",h),s.removeListener("close",h),e.removeListener("close",h)}return s.on("error",d),e.on("error",d),s.on("end",h),s.on("close",h),e.on("close",h),e.emit("pipe",s),e}},8501:(e,t,s)=>{var i=s(1989),r=s(5676),a=s(7529),n=s(584),o=s(8575),c=t;c.request=function(e,t){e="string"==typeof e?o.parse(e):a(e);var r=-1===s.g.location.protocol.search(/^https?:$/)?"http:":"",n=e.protocol||r,c=e.hostname||e.host,d=e.port,h=e.path||"/";c&&-1!==c.indexOf(":")&&(c="["+c+"]"),e.url=(c?n+"//"+c:"")+(d?":"+d:"")+h,e.method=(e.method||"GET").toUpperCase(),e.headers=e.headers||{};var u=new i(e);return t&&u.on("response",t),u},c.get=function(e,t){var s=c.request(e,t);return s.end(),s},c.ClientRequest=i,c.IncomingMessage=r.IncomingMessage,c.Agent=function(){},c.Agent.defaultMaxSockets=4,c.globalAgent=new c.Agent,c.STATUS_CODES=n,c.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]},8725:(e,t,s)=>{t.fetch=c(s.g.fetch)&&c(s.g.ReadableStream),t.writableStream=c(s.g.WritableStream),t.abortController=c(s.g.AbortController),t.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),t.blobConstructor=!0}catch(e){}var i;function r(){if(void 0!==i)return i;if(s.g.XMLHttpRequest){i=new s.g.XMLHttpRequest;try{i.open("GET",s.g.XDomainRequest?"/":"https://example.com")}catch(e){i=null}}else i=null;return i}function a(e){var t=r();if(!t)return!1;try{return t.responseType=e,t.responseType===e}catch(e){}return!1}var n=void 0!==s.g.ArrayBuffer,o=n&&c(s.g.ArrayBuffer.prototype.slice);function c(e){return"function"==typeof e}t.arraybuffer=t.fetch||n&&a("arraybuffer"),t.msstream=!t.fetch&&o&&a("ms-stream"),t.mozchunkedarraybuffer=!t.fetch&&n&&a("moz-chunked-arraybuffer"),t.overrideMimeType=t.fetch||!!r()&&c(r().overrideMimeType),t.vbArray=c(s.g.VBArray),i=null},1989:(e,t,s)=>{var i=s(8764).Buffer,r=s(4155),a=s(8725),n=s(5717),o=s(5676),c=s(8473),d=s(2885),h=o.IncomingMessage,u=o.readyStates;var l=e.exports=function(e){var t,s=this;c.Writable.call(s),s._opts=e,s._body=[],s._headers={},e.auth&&s.setHeader("Authorization","Basic "+new i(e.auth).toString("base64")),Object.keys(e.headers).forEach((function(t){s.setHeader(t,e.headers[t])}));var r=!0;if("disable-fetch"===e.mode||"requestTimeout"in e&&!a.abortController)r=!1,t=!0;else if("prefer-streaming"===e.mode)t=!1;else if("allow-wrong-content-type"===e.mode)t=!a.overrideMimeType;else{if(e.mode&&"default"!==e.mode&&"prefer-fast"!==e.mode)throw new Error("Invalid value for opts.mode");t=!0}s._mode=function(e,t){return a.fetch&&t?"fetch":a.mozchunkedarraybuffer?"moz-chunked-arraybuffer":a.msstream?"ms-stream":a.arraybuffer&&e?"arraybuffer":a.vbArray&&e?"text:vbarray":"text"}(t,r),s._fetchTimer=null,s.on("finish",(function(){s._onFinish()}))};n(l,c.Writable),l.prototype.setHeader=function(e,t){var s=e.toLowerCase();-1===f.indexOf(s)&&(this._headers[s]={name:e,value:t})},l.prototype.getHeader=function(e){var t=this._headers[e.toLowerCase()];return t?t.value:null},l.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},l.prototype._onFinish=function(){var e=this;if(!e._destroyed){var t=e._opts,n=e._headers,o=null;"GET"!==t.method&&"HEAD"!==t.method&&(o=a.arraybuffer?d(i.concat(e._body)):a.blobConstructor?new s.g.Blob(e._body.map((function(e){return d(e)})),{type:(n["content-type"]||{}).value||""}):i.concat(e._body).toString());var c=[];if(Object.keys(n).forEach((function(e){var t=n[e].name,s=n[e].value;Array.isArray(s)?s.forEach((function(e){c.push([t,e])})):c.push([t,s])})),"fetch"===e._mode){var h=null;if(a.abortController){var l=new AbortController;h=l.signal,e._fetchAbortController=l,"requestTimeout"in t&&0!==t.requestTimeout&&(e._fetchTimer=s.g.setTimeout((function(){e.emit("requestTimeout"),e._fetchAbortController&&e._fetchAbortController.abort()}),t.requestTimeout))}s.g.fetch(e._opts.url,{method:e._opts.method,headers:c,body:o||void 0,mode:"cors",credentials:t.withCredentials?"include":"same-origin",signal:h}).then((function(t){e._fetchResponse=t,e._connect()}),(function(t){s.g.clearTimeout(e._fetchTimer),e._destroyed||e.emit("error",t)}))}else{var f=e._xhr=new s.g.XMLHttpRequest;try{f.open(e._opts.method,e._opts.url,!0)}catch(t){return void r.nextTick((function(){e.emit("error",t)}))}"responseType"in f&&(f.responseType=e._mode.split(":")[0]),"withCredentials"in f&&(f.withCredentials=!!t.withCredentials),"text"===e._mode&&"overrideMimeType"in f&&f.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in t&&(f.timeout=t.requestTimeout,f.ontimeout=function(){e.emit("requestTimeout")}),c.forEach((function(e){f.setRequestHeader(e[0],e[1])})),e._response=null,f.onreadystatechange=function(){switch(f.readyState){case u.LOADING:case u.DONE:e._onXHRProgress()}},"moz-chunked-arraybuffer"===e._mode&&(f.onprogress=function(){e._onXHRProgress()}),f.onerror=function(){e._destroyed||e.emit("error",new Error("XHR error"))};try{f.send(o)}catch(t){return void r.nextTick((function(){e.emit("error",t)}))}}}},l.prototype._onXHRProgress=function(){var e=this;(function(e){try{var t=e.status;return null!==t&&0!==t}catch(e){return!1}})(e._xhr)&&!e._destroyed&&(e._response||e._connect(),e._response._onXHRProgress())},l.prototype._connect=function(){var e=this;e._destroyed||(e._response=new h(e._xhr,e._fetchResponse,e._mode,e._fetchTimer),e._response.on("error",(function(t){e.emit("error",t)})),e.emit("response",e._response))},l.prototype._write=function(e,t,s){this._body.push(e),s()},l.prototype.abort=l.prototype.destroy=function(){var e=this;e._destroyed=!0,s.g.clearTimeout(e._fetchTimer),e._response&&(e._response._destroyed=!0),e._xhr?e._xhr.abort():e._fetchAbortController&&e._fetchAbortController.abort()},l.prototype.end=function(e,t,s){"function"==typeof e&&(s=e,e=void 0),c.Writable.prototype.end.call(this,e,t,s)},l.prototype.flushHeaders=function(){},l.prototype.setTimeout=function(){},l.prototype.setNoDelay=function(){},l.prototype.setSocketKeepAlive=function(){};var f=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]},5676:(e,t,s)=>{var i=s(4155),r=s(8764).Buffer,a=s(8725),n=s(5717),o=s(8473),c=t.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},d=t.IncomingMessage=function(e,t,n,c){var d=this;if(o.Readable.call(d),d._mode=n,d.headers={},d.rawHeaders=[],d.trailers={},d.rawTrailers=[],d.on("end",(function(){i.nextTick((function(){d.emit("close")}))})),"fetch"===n){if(d._fetchResponse=t,d.url=t.url,d.statusCode=t.status,d.statusMessage=t.statusText,t.headers.forEach((function(e,t){d.headers[t.toLowerCase()]=e,d.rawHeaders.push(t,e)})),a.writableStream){var h=new WritableStream({write:function(e){return new Promise((function(t,s){d._destroyed?s():d.push(new r(e))?t():d._resumeFetch=t}))},close:function(){s.g.clearTimeout(c),d._destroyed||d.push(null)},abort:function(e){d._destroyed||d.emit("error",e)}});try{return void t.body.pipeTo(h).catch((function(e){s.g.clearTimeout(c),d._destroyed||d.emit("error",e)}))}catch(e){}}var u=t.body.getReader();!function e(){u.read().then((function(t){if(!d._destroyed){if(t.done)return s.g.clearTimeout(c),void d.push(null);d.push(new r(t.value)),e()}})).catch((function(e){s.g.clearTimeout(c),d._destroyed||d.emit("error",e)}))}()}else{if(d._xhr=e,d._pos=0,d.url=e.responseURL,d.statusCode=e.status,d.statusMessage=e.statusText,e.getAllResponseHeaders().split(/\r?\n/).forEach((function(e){var t=e.match(/^([^:]+):\s*(.*)/);if(t){var s=t[1].toLowerCase();"set-cookie"===s?(void 0===d.headers[s]&&(d.headers[s]=[]),d.headers[s].push(t[2])):void 0!==d.headers[s]?d.headers[s]+=", "+t[2]:d.headers[s]=t[2],d.rawHeaders.push(t[1],t[2])}})),d._charset="x-user-defined",!a.overrideMimeType){var l=d.rawHeaders["mime-type"];if(l){var f=l.match(/;\s*charset=([^;])(;|$)/);f&&(d._charset=f[1].toLowerCase())}d._charset||(d._charset="utf-8")}}};n(d,o.Readable),d.prototype._read=function(){var e=this._resumeFetch;e&&(this._resumeFetch=null,e())},d.prototype._onXHRProgress=function(){var e=this,t=e._xhr,i=null;switch(e._mode){case"text:vbarray":if(t.readyState!==c.DONE)break;try{i=new s.g.VBArray(t.responseBody).toArray()}catch(e){}if(null!==i){e.push(new r(i));break}case"text":try{i=t.responseText}catch(t){e._mode="text:vbarray";break}if(i.length>e._pos){var a=i.substr(e._pos);if("x-user-defined"===e._charset){for(var n=new r(a.length),o=0;o<a.length;o++)n[o]=255&a.charCodeAt(o);e.push(n)}else e.push(a,e._charset);e._pos=i.length}break;case"arraybuffer":if(t.readyState!==c.DONE||!t.response)break;i=t.response,e.push(new r(new Uint8Array(i)));break;case"moz-chunked-arraybuffer":if(i=t.response,t.readyState!==c.LOADING||!i)break;e.push(new r(new Uint8Array(i)));break;case"ms-stream":if(i=t.response,t.readyState!==c.LOADING)break;var d=new s.g.MSStreamReader;d.onprogress=function(){d.result.byteLength>e._pos&&(e.push(new r(new Uint8Array(d.result.slice(e._pos)))),e._pos=d.result.byteLength)},d.onload=function(){e.push(null)},d.readAsArrayBuffer(i)}e._xhr.readyState===c.DONE&&"ms-stream"!==e._mode&&e.push(null)}},6455:function(e){e.exports=function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),e}function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function d(e,t,s){return(d=c()?Reflect.construct:function(e,t,s){var i=[null];i.push.apply(i,t);var r=new(Function.bind.apply(e,i));return s&&o(r,s.prototype),r}).apply(null,arguments)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?h(e):t}function l(e){var t=c();return function(){var s,i=n(e);if(t){var r=n(this).constructor;s=Reflect.construct(i,arguments,r)}else s=i.apply(this,arguments);return u(this,s)}}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e}function p(e,t,s){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=f(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(s):r.value}})(e,t,s||e)}var m="SweetAlert2:",b=function(e){for(var t=[],s=0;s<e.length;s++)-1===t.indexOf(e[s])&&t.push(e[s]);return t},g=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},y=function(e){return Object.keys(e).map((function(t){return e[t]}))},v=function(e){return Array.prototype.slice.call(e)},w=function(t){console.warn("".concat(m," ").concat("object"===e(t)?t.join(" "):t))},k=function(e){console.error("".concat(m," ").concat(e))},S=[],_=function(e){-1===S.indexOf(e)&&(S.push(e),w(e))},O=function(e,t){_('"'.concat(e,'" is deprecated and will be removed in the next major release. Please use "').concat(t,'" instead.'))},T=function(e){return"function"==typeof e?e():e},x=function(e){return e&&"function"==typeof e.toPromise},C=function(e){return x(e)?e.toPromise():Promise.resolve(e)},I=function(e){return e&&Promise.resolve(e)===e},M=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),N=function(t){return"object"===e(t)&&t.jquery},A=function(e){return e instanceof Element||N(e)},E=function(t){var s={};return"object"!==e(t[0])||A(t[0])?["title","html","icon"].forEach((function(i,r){var a=t[r];"string"==typeof a||A(a)?s[i]=a:void 0!==a&&k("Unexpected type of ".concat(i,'! Expected "string" or "Element", got ').concat(e(a)))})):r(s,t[0]),s},P="swal2-",B=function(e){var t={};for(var s in e)t[e[s]]=P+e[s];return t},V=B(["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","header","content","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error"]),L=B(["success","warning","info","question","error"]),q=function(){return document.body.querySelector(".".concat(V.container))},D=function(e){var t=q();return t?t.querySelector(e):null},R=function(e){return D(".".concat(e))},G=function(){return R(V.popup)},F=function(){return R(V.icon)},U=function(){return R(V.title)},j=function(){return R(V.content)},H=function(){return R(V["html-container"])},z=function(){return R(V.image)},W=function(){return R(V["progress-steps"])},K=function(){return R(V["validation-message"])},X=function(){return D(".".concat(V.actions," .").concat(V.confirm))},Y=function(){return D(".".concat(V.actions," .").concat(V.deny))},Z=function(){return R(V["input-label"])},Q=function(){return D(".".concat(V.loader))},J=function(){return D(".".concat(V.actions," .").concat(V.cancel))},$=function(){return R(V.actions)},ee=function(){return R(V.header)},te=function(){return R(V.footer)},se=function(){return R(V["timer-progress-bar"])},ie=function(){return R(V.close)},re='\n  a[href],\n  area[href],\n  input:not([disabled]),\n  select:not([disabled]),\n  textarea:not([disabled]),\n  button:not([disabled]),\n  iframe,\n  object,\n  embed,\n  [tabindex="0"],\n  [contenteditable],\n  audio[controls],\n  video[controls],\n  summary\n',ae=function(){var e=v(G().querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])')).sort((function(e,t){return(e=parseInt(e.getAttribute("tabindex")))>(t=parseInt(t.getAttribute("tabindex")))?1:e<t?-1:0})),t=v(G().querySelectorAll(re)).filter((function(e){return"-1"!==e.getAttribute("tabindex")}));return b(e.concat(t)).filter((function(e){return xe(e)}))},ne=function(){return!oe()&&!document.body.classList.contains(V["no-backdrop"])},oe=function(){return document.body.classList.contains(V["toast-shown"])},ce=function(){return G().hasAttribute("data-loading")},de={previousBodyPadding:null},he=function(e,t){if(e.textContent="",t){var s=(new DOMParser).parseFromString(t,"text/html");v(s.querySelector("head").childNodes).forEach((function(t){e.appendChild(t)})),v(s.querySelector("body").childNodes).forEach((function(t){e.appendChild(t)}))}},ue=function(e,t){if(!t)return!1;for(var s=t.split(/\s+/),i=0;i<s.length;i++)if(!e.classList.contains(s[i]))return!1;return!0},le=function(e,t){v(e.classList).forEach((function(s){-1===y(V).indexOf(s)&&-1===y(L).indexOf(s)&&-1===y(t.showClass).indexOf(s)&&e.classList.remove(s)}))},fe=function(t,s,i){if(le(t,s),s.customClass&&s.customClass[i]){if("string"!=typeof s.customClass[i]&&!s.customClass[i].forEach)return w("Invalid type of customClass.".concat(i,'! Expected string or iterable object, got "').concat(e(s.customClass[i]),'"'));ye(t,s.customClass[i])}};function pe(e,t){if(!t)return null;switch(t){case"select":case"textarea":case"file":return we(e,V[t]);case"checkbox":return e.querySelector(".".concat(V.checkbox," input"));case"radio":return e.querySelector(".".concat(V.radio," input:checked"))||e.querySelector(".".concat(V.radio," input:first-child"));case"range":return e.querySelector(".".concat(V.range," input"));default:return we(e,V.input)}}var me,be=function(e){if(e.focus(),"file"!==e.type){var t=e.value;e.value="",e.value=t}},ge=function(e,t,s){e&&t&&("string"==typeof t&&(t=t.split(/\s+/).filter(Boolean)),t.forEach((function(t){e.forEach?e.forEach((function(e){s?e.classList.add(t):e.classList.remove(t)})):s?e.classList.add(t):e.classList.remove(t)})))},ye=function(e,t){ge(e,t,!0)},ve=function(e,t){ge(e,t,!1)},we=function(e,t){for(var s=0;s<e.childNodes.length;s++)if(ue(e.childNodes[s],t))return e.childNodes[s]},ke=function(e,t,s){s==="".concat(parseInt(s))&&(s=parseInt(s)),s||0===parseInt(s)?e.style[t]="number"==typeof s?"".concat(s,"px"):s:e.style.removeProperty(t)},Se=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flex";e.style.display=t},_e=function(e){e.style.display="none"},Oe=function(e,t,s,i){var r=e.querySelector(t);r&&(r.style[s]=i)},Te=function(e,t,s){t?Se(e,s):_e(e)},xe=function(e){return!(!e||!(e.offsetWidth||e.offsetHeight||e.getClientRects().length))},Ce=function(){return!xe(X())&&!xe(Y())&&!xe(J())},Ie=function(e){return!!(e.scrollHeight>e.clientHeight)},Me=function(e){var t=window.getComputedStyle(e),s=parseFloat(t.getPropertyValue("animation-duration")||"0"),i=parseFloat(t.getPropertyValue("transition-duration")||"0");return s>0||i>0},Ne=function(e,t){if("function"==typeof e.contains)return e.contains(t)},Ae=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=se();xe(s)&&(t&&(s.style.transition="none",s.style.width="100%"),setTimeout((function(){s.style.transition="width ".concat(e/1e3,"s linear"),s.style.width="0%"}),10))},Ee=function(){var e=se(),t=parseInt(window.getComputedStyle(e).width);e.style.removeProperty("transition"),e.style.width="100%";var s=parseInt(window.getComputedStyle(e).width),i=parseInt(t/s*100);e.style.removeProperty("transition"),e.style.width="".concat(i,"%")},Pe=function(){return"undefined"==typeof window||"undefined"==typeof document},Be='\n <div aria-labelledby="'.concat(V.title,'" aria-describedby="').concat(V.content,'" class="').concat(V.popup,'" tabindex="-1">\n   <div class="').concat(V.header,'">\n     <ul class="').concat(V["progress-steps"],'"></ul>\n     <div class="').concat(V.icon,'"></div>\n     <img class="').concat(V.image,'" />\n     <h2 class="').concat(V.title,'" id="').concat(V.title,'"></h2>\n     <button type="button" class="').concat(V.close,'"></button>\n   </div>\n   <div class="').concat(V.content,'">\n     <div id="').concat(V.content,'" class="').concat(V["html-container"],'"></div>\n     <input class="').concat(V.input,'" />\n     <input type="file" class="').concat(V.file,'" />\n     <div class="').concat(V.range,'">\n       <input type="range" />\n       <output></output>\n     </div>\n     <select class="').concat(V.select,'"></select>\n     <div class="').concat(V.radio,'"></div>\n     <label for="').concat(V.checkbox,'" class="').concat(V.checkbox,'">\n       <input type="checkbox" />\n       <span class="').concat(V.label,'"></span>\n     </label>\n     <textarea class="').concat(V.textarea,'"></textarea>\n     <div class="').concat(V["validation-message"],'" id="').concat(V["validation-message"],'"></div>\n   </div>\n   <div class="').concat(V.actions,'">\n     <div class="').concat(V.loader,'"></div>\n     <button type="button" class="').concat(V.confirm,'"></button>\n     <button type="button" class="').concat(V.deny,'"></button>\n     <button type="button" class="').concat(V.cancel,'"></button>\n   </div>\n   <div class="').concat(V.footer,'"></div>\n   <div class="').concat(V["timer-progress-bar-container"],'">\n     <div class="').concat(V["timer-progress-bar"],'"></div>\n   </div>\n </div>\n').replace(/(^|\n)\s*/g,""),Ve=function(){var e=q();return!!e&&(e.parentNode.removeChild(e),ve([document.documentElement,document.body],[V["no-backdrop"],V["toast-shown"],V["has-column"]]),!0)},Le=function(e){lr.isVisible()&&me!==e.target.value&&lr.resetValidationMessage(),me=e.target.value},qe=function(){var e=j(),t=we(e,V.input),s=we(e,V.file),i=e.querySelector(".".concat(V.range," input")),r=e.querySelector(".".concat(V.range," output")),a=we(e,V.select),n=e.querySelector(".".concat(V.checkbox," input")),o=we(e,V.textarea);t.oninput=Le,s.onchange=Le,a.onchange=Le,n.onchange=Le,o.oninput=Le,i.oninput=function(e){Le(e),r.value=i.value},i.onchange=function(e){Le(e),i.nextSibling.value=i.value}},De=function(e){return"string"==typeof e?document.querySelector(e):e},Re=function(e){var t=G();t.setAttribute("role",e.toast?"alert":"dialog"),t.setAttribute("aria-live",e.toast?"polite":"assertive"),e.toast||t.setAttribute("aria-modal","true")},Ge=function(e){"rtl"===window.getComputedStyle(e).direction&&ye(q(),V.rtl)},Fe=function(e){var t=Ve();if(Pe())k("SweetAlert2 requires document to initialize");else{var s=document.createElement("div");s.className=V.container,t&&ye(s,V["no-transition"]),he(s,Be);var i=De(e.target);i.appendChild(s),Re(e),Ge(i),qe()}},Ue=function(t,s){t instanceof HTMLElement?s.appendChild(t):"object"===e(t)?je(t,s):t&&he(s,t)},je=function(e,t){e.jquery?He(t,e):he(t,e.toString())},He=function(e,t){if(e.textContent="",0 in t)for(var s=0;s in t;s++)e.appendChild(t[s].cloneNode(!0));else e.appendChild(t.cloneNode(!0))},ze=function(){if(Pe())return!1;var e=document.createElement("div"),t={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd oanimationend",animation:"animationend"};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&void 0!==e.style[s])return t[s];return!1}(),We=function(){var e=document.createElement("div");e.className=V["scrollbar-measure"],document.body.appendChild(e);var t=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),t},Ke=function(e,t){var s=$(),i=Q(),r=X(),a=Y(),n=J();t.showConfirmButton||t.showDenyButton||t.showCancelButton||_e(s),fe(s,t,"actions"),Ye(r,"confirm",t),Ye(a,"deny",t),Ye(n,"cancel",t),Xe(r,a,n,t),t.reverseButtons&&(s.insertBefore(n,i),s.insertBefore(a,i),s.insertBefore(r,i)),he(i,t.loaderHtml),fe(i,t,"loader")};function Xe(e,t,s,i){if(!i.buttonsStyling)return ve([e,t,s],V.styled);ye([e,t,s],V.styled),i.confirmButtonColor&&(e.style.backgroundColor=i.confirmButtonColor),i.denyButtonColor&&(t.style.backgroundColor=i.denyButtonColor),i.cancelButtonColor&&(s.style.backgroundColor=i.cancelButtonColor)}function Ye(e,t,s){Te(e,s["show".concat(g(t),"Button")],"inline-block"),he(e,s["".concat(t,"ButtonText")]),e.setAttribute("aria-label",s["".concat(t,"ButtonAriaLabel")]),e.className=V[t],fe(e,s,"".concat(t,"Button")),ye(e,s["".concat(t,"ButtonClass")])}function Ze(e,t){"string"==typeof t?e.style.background=t:t||ye([document.documentElement,document.body],V["no-backdrop"])}function Qe(e,t){t in V?ye(e,V[t]):(w('The "position" parameter is not valid, defaulting to "center"'),ye(e,V.center))}function Je(e,t){if(t&&"string"==typeof t){var s="grow-".concat(t);s in V&&ye(e,V[s])}}var $e=function(e,t){var s=q();if(s){Ze(s,t.backdrop),!t.backdrop&&t.allowOutsideClick&&w('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),Qe(s,t.position),Je(s,t.grow),fe(s,t,"container");var i=document.body.getAttribute("data-swal2-queue-step");i&&(s.setAttribute("data-queue-step",i),document.body.removeAttribute("data-swal2-queue-step"))}},et={promise:new WeakMap,innerParams:new WeakMap,domCache:new WeakMap},tt=["input","file","range","select","radio","checkbox","textarea"],st=function(e,t){var s=j(),i=et.innerParams.get(e),r=!i||t.input!==i.input;tt.forEach((function(e){var i=V[e],a=we(s,i);at(e,t.inputAttributes),a.className=i,r&&_e(a)})),t.input&&(r&&it(t),nt(t))},it=function(e){if(!ht[e.input])return k('Unexpected type of input! Expected "text", "email", "password", "number", "tel", "select", "radio", "checkbox", "textarea", "file" or "url", got "'.concat(e.input,'"'));var t=dt(e.input),s=ht[e.input](t,e);Se(s),setTimeout((function(){be(s)}))},rt=function(e){for(var t=0;t<e.attributes.length;t++){var s=e.attributes[t].name;-1===["type","value","style"].indexOf(s)&&e.removeAttribute(s)}},at=function(e,t){var s=pe(j(),e);if(s)for(var i in rt(s),t)"range"===e&&"placeholder"===i||s.setAttribute(i,t[i])},nt=function(e){var t=dt(e.input);e.customClass&&ye(t,e.customClass.input)},ot=function(e,t){e.placeholder&&!t.inputPlaceholder||(e.placeholder=t.inputPlaceholder)},ct=function(e,t,s){if(s.inputLabel){e.id=V.input;var i=document.createElement("label"),r=V["input-label"];i.setAttribute("for",e.id),i.className=r,ye(i,s.customClass.inputLabel),i.innerText=s.inputLabel,t.insertAdjacentElement("beforebegin",i)}},dt=function(e){var t=V[e]?V[e]:V.input;return we(j(),t)},ht={};ht.text=ht.email=ht.password=ht.number=ht.tel=ht.url=function(t,s){return"string"==typeof s.inputValue||"number"==typeof s.inputValue?t.value=s.inputValue:I(s.inputValue)||w('Unexpected type of inputValue! Expected "string", "number" or "Promise", got "'.concat(e(s.inputValue),'"')),ct(t,t,s),ot(t,s),t.type=s.input,t},ht.file=function(e,t){return ct(e,e,t),ot(e,t),e},ht.range=function(e,t){var s=e.querySelector("input"),i=e.querySelector("output");return s.value=t.inputValue,s.type=t.input,i.value=t.inputValue,ct(s,e,t),e},ht.select=function(e,t){if(e.textContent="",t.inputPlaceholder){var s=document.createElement("option");he(s,t.inputPlaceholder),s.value="",s.disabled=!0,s.selected=!0,e.appendChild(s)}return ct(e,e,t),e},ht.radio=function(e){return e.textContent="",e},ht.checkbox=function(e,t){var s=pe(j(),"checkbox");s.value=1,s.id=V.checkbox,s.checked=Boolean(t.inputValue);var i=e.querySelector("span");return he(i,t.inputPlaceholder),e},ht.textarea=function(e,t){e.value=t.inputValue,ot(e,t),ct(e,e,t);var s=function(e){return parseInt(window.getComputedStyle(e).paddingLeft)+parseInt(window.getComputedStyle(e).paddingRight)};if("MutationObserver"in window){var i=parseInt(window.getComputedStyle(G()).width);new MutationObserver((function(){var t=e.offsetWidth+s(G())+s(j());G().style.width=t>i?"".concat(t,"px"):null})).observe(e,{attributes:!0,attributeFilter:["style"]})}return e};var ut=function(e,t){var s=H();fe(s,t,"htmlContainer"),t.html?(Ue(t.html,s),Se(s,"block")):t.text?(s.textContent=t.text,Se(s,"block")):_e(s),st(e,t),fe(j(),t,"content")},lt=function(e,t){var s=te();Te(s,t.footer),t.footer&&Ue(t.footer,s),fe(s,t,"footer")},ft=function(e,t){var s=ie();he(s,t.closeButtonHtml),fe(s,t,"closeButton"),Te(s,t.showCloseButton),s.setAttribute("aria-label",t.closeButtonAriaLabel)},pt=function(e,t){var s=et.innerParams.get(e),i=F();return s&&t.icon===s.icon?(gt(i,t),void mt(i,t)):t.icon||t.iconHtml?t.icon&&-1===Object.keys(L).indexOf(t.icon)?(k('Unknown icon! Expected "success", "error", "warning", "info" or "question", got "'.concat(t.icon,'"')),_e(i)):(Se(i),gt(i,t),mt(i,t),void ye(i,t.showClass.icon)):_e(i)},mt=function(e,t){for(var s in L)t.icon!==s&&ve(e,L[s]);ye(e,L[t.icon]),yt(e,t),bt(),fe(e,t,"icon")},bt=function(){for(var e=G(),t=window.getComputedStyle(e).getPropertyValue("background-color"),s=e.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix"),i=0;i<s.length;i++)s[i].style.backgroundColor=t},gt=function(e,t){e.textContent="",t.iconHtml?he(e,vt(t.iconHtml)):"success"===t.icon?he(e,'\n      <div class="swal2-success-circular-line-left"></div>\n      <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>\n      <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>\n      <div class="swal2-success-circular-line-right"></div>\n    '):"error"===t.icon?he(e,'\n      <span class="swal2-x-mark">\n        <span class="swal2-x-mark-line-left"></span>\n        <span class="swal2-x-mark-line-right"></span>\n      </span>\n    '):he(e,vt({question:"?",warning:"!",info:"i"}[t.icon]))},yt=function(e,t){if(t.iconColor){e.style.color=t.iconColor,e.style.borderColor=t.iconColor;for(var s=0,i=[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"];s<i.length;s++){var r=i[s];Oe(e,r,"backgroundColor",t.iconColor)}Oe(e,".swal2-success-ring","borderColor",t.iconColor)}},vt=function(e){return'<div class="'.concat(V["icon-content"],'">').concat(e,"</div>")},wt=function(e,t){var s=z();if(!t.imageUrl)return _e(s);Se(s,""),s.setAttribute("src",t.imageUrl),s.setAttribute("alt",t.imageAlt),ke(s,"width",t.imageWidth),ke(s,"height",t.imageHeight),s.className=V.image,fe(s,t,"image")},kt=[],St=function(e){O("Swal.queue()","async/await");var t=this;kt=e;var s=function(e,t){kt=[],e(t)},i=[];return new Promise((function(e){!function r(a,n){a<kt.length?(document.body.setAttribute("data-swal2-queue-step",a),t.fire(kt[a]).then((function(t){void 0!==t.value?(i.push(t.value),r(a+1,n)):s(e,{dismiss:t.dismiss})}))):s(e,{value:i})}(0)}))},_t=function(){return q()&&q().getAttribute("data-queue-step")},Ot=function(e,t){return t&&t<kt.length?kt.splice(t,0,e):kt.push(e)},Tt=function(e){void 0!==kt[e]&&kt.splice(e,1)},xt=function(e){var t=document.createElement("li");return ye(t,V["progress-step"]),he(t,e),t},Ct=function(e){var t=document.createElement("li");return ye(t,V["progress-step-line"]),e.progressStepsDistance&&(t.style.width=e.progressStepsDistance),t},It=function(e,t){var s=W();if(!t.progressSteps||0===t.progressSteps.length)return _e(s);Se(s),s.textContent="";var i=parseInt(void 0===t.currentProgressStep?_t():t.currentProgressStep);i>=t.progressSteps.length&&w("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),t.progressSteps.forEach((function(e,r){var a=xt(e);if(s.appendChild(a),r===i&&ye(a,V["active-progress-step"]),r!==t.progressSteps.length-1){var n=Ct(t);s.appendChild(n)}}))},Mt=function(e,t){var s=U();Te(s,t.title||t.titleText,"block"),t.title&&Ue(t.title,s),t.titleText&&(s.innerText=t.titleText),fe(s,t,"title")},Nt=function(e,t){var s=ee();fe(s,t,"header"),It(e,t),pt(e,t),wt(e,t),Mt(e,t),ft(e,t)},At=function(e,t){var s=q(),i=G();t.toast?(ke(s,"width",t.width),i.style.width="100%"):ke(i,"width",t.width),ke(i,"padding",t.padding),t.background&&(i.style.background=t.background),_e(K()),Et(i,t)},Et=function(e,t){e.className="".concat(V.popup," ").concat(xe(e)?t.showClass.popup:""),t.toast?(ye([document.documentElement,document.body],V["toast-shown"]),ye(e,V.toast)):ye(e,V.modal),fe(e,t,"popup"),"string"==typeof t.customClass&&ye(e,t.customClass),t.icon&&ye(e,V["icon-".concat(t.icon)])},Pt=function(e,t){At(e,t),$e(e,t),Nt(e,t),ut(e,t),Ke(e,t),lt(e,t),"function"==typeof t.didRender?t.didRender(G()):"function"==typeof t.onRender&&t.onRender(G())},Bt=function(){return xe(G())},Vt=function(){return X()&&X().click()},Lt=function(){return Y()&&Y().click()},qt=function(){return J()&&J().click()};function Dt(){for(var e=this,t=arguments.length,s=new Array(t),i=0;i<t;i++)s[i]=arguments[i];return d(e,s)}function Rt(e){return function(s){a(c,s);var o=l(c);function c(){return t(this,c),o.apply(this,arguments)}return i(c,[{key:"_main",value:function(t,s){return p(n(c.prototype),"_main",this).call(this,t,r({},e,s))}}]),c}(this)}var Gt=function(e){var t=G();t||lr.fire(),t=G();var s=$(),i=Q();!e&&xe(X())&&(e=X()),Se(s),e&&(_e(e),i.setAttribute("data-button-to-replace",e.className)),i.parentNode.insertBefore(i,e),ye([t,s],V.loading),Se(i),t.setAttribute("data-loading",!0),t.setAttribute("aria-busy",!0),t.focus()},Ft=100,Ut={},jt=function(){Ut.previousActiveElement&&Ut.previousActiveElement.focus?(Ut.previousActiveElement.focus(),Ut.previousActiveElement=null):document.body&&document.body.focus()},Ht=function(e){return new Promise((function(t){if(!e)return t();var s=window.scrollX,i=window.scrollY;Ut.restoreFocusTimeout=setTimeout((function(){jt(),t()}),Ft),void 0!==s&&void 0!==i&&window.scrollTo(s,i)}))},zt=function(){return Ut.timeout&&Ut.timeout.getTimerLeft()},Wt=function(){if(Ut.timeout)return Ee(),Ut.timeout.stop()},Kt=function(){if(Ut.timeout){var e=Ut.timeout.start();return Ae(e),e}},Xt=function(){var e=Ut.timeout;return e&&(e.running?Wt():Kt())},Yt=function(e){if(Ut.timeout){var t=Ut.timeout.increase(e);return Ae(t,!0),t}},Zt=function(){return Ut.timeout&&Ut.timeout.isRunning()},Qt=!1,Jt={};function $t(){Jt[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data-swal-template"]=this,Qt||(document.body.addEventListener("click",es),Qt=!0)}var es=function(e){for(var t=e.target;t&&t!==document;t=t.parentNode)for(var s in Jt){var i=t.getAttribute(s);if(i)return void Jt[s].fire({template:i})}},ts={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,animation:!0,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,onBeforeOpen:void 0,onOpen:void 0,willOpen:void 0,didOpen:void 0,onRender:void 0,didRender:void 0,onClose:void 0,onAfterClose:void 0,willClose:void 0,didClose:void 0,onDestroy:void 0,didDestroy:void 0,scrollbarPadding:!0},ss=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","onAfterClose","onClose","onDestroy","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],is={animation:'showClass" and "hideClass',onBeforeOpen:"willOpen",onOpen:"didOpen",onRender:"didRender",onClose:"willClose",onAfterClose:"didClose",onDestroy:"didDestroy"},rs=["allowOutsideClick","allowEnterKey","backdrop","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],as=function(e){return Object.prototype.hasOwnProperty.call(ts,e)},ns=function(e){return-1!==ss.indexOf(e)},os=function(e){return is[e]},cs=function(e){as(e)||w('Unknown parameter "'.concat(e,'"'))},ds=function(e){-1!==rs.indexOf(e)&&w('The parameter "'.concat(e,'" is incompatible with toasts'))},hs=function(e){os(e)&&O(e,os(e))},us=function(e){for(var t in e)cs(t),e.toast&&ds(t),hs(t)},ls=Object.freeze({isValidParameter:as,isUpdatableParameter:ns,isDeprecatedParameter:os,argsToParams:E,isVisible:Bt,clickConfirm:Vt,clickDeny:Lt,clickCancel:qt,getContainer:q,getPopup:G,getTitle:U,getContent:j,getHtmlContainer:H,getImage:z,getIcon:F,getInputLabel:Z,getCloseButton:ie,getActions:$,getConfirmButton:X,getDenyButton:Y,getCancelButton:J,getLoader:Q,getHeader:ee,getFooter:te,getTimerProgressBar:se,getFocusableElements:ae,getValidationMessage:K,isLoading:ce,fire:Dt,mixin:Rt,queue:St,getQueueStep:_t,insertQueueStep:Ot,deleteQueueStep:Tt,showLoading:Gt,enableLoading:Gt,getTimerLeft:zt,stopTimer:Wt,resumeTimer:Kt,toggleTimer:Xt,increaseTimer:Yt,isTimerRunning:Zt,bindClickHandler:$t});function fs(){if(et.innerParams.get(this)){var e=et.domCache.get(this);_e(e.loader);var t=e.popup.getElementsByClassName(e.loader.getAttribute("data-button-to-replace"));t.length?Se(t[0],"inline-block"):Ce()&&_e(e.actions),ve([e.popup,e.actions],V.loading),e.popup.removeAttribute("aria-busy"),e.popup.removeAttribute("data-loading"),e.confirmButton.disabled=!1,e.denyButton.disabled=!1,e.cancelButton.disabled=!1}}function ps(e){var t=et.innerParams.get(e||this),s=et.domCache.get(e||this);return s?pe(s.content,t.input):null}var ms=function(){null===de.previousBodyPadding&&document.body.scrollHeight>window.innerHeight&&(de.previousBodyPadding=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight="".concat(de.previousBodyPadding+We(),"px"))},bs=function(){null!==de.previousBodyPadding&&(document.body.style.paddingRight="".concat(de.previousBodyPadding,"px"),de.previousBodyPadding=null)},gs=function(){if((/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&!ue(document.body,V.iosfix)){var e=document.body.scrollTop;document.body.style.top="".concat(-1*e,"px"),ye(document.body,V.iosfix),vs(),ys()}},ys=function(){if(!navigator.userAgent.match(/(CriOS|FxiOS|EdgiOS|YaBrowser|UCBrowser)/i)){var e=44;G().scrollHeight>window.innerHeight-e&&(q().style.paddingBottom="".concat(e,"px"))}},vs=function(){var e,t=q();t.ontouchstart=function(t){e=ws(t)},t.ontouchmove=function(t){e&&(t.preventDefault(),t.stopPropagation())}},ws=function(e){var t=e.target,s=q();return!(ks(e)||Ss(e)||t!==s&&(Ie(s)||"INPUT"===t.tagName||Ie(j())&&j().contains(t)))},ks=function(e){return e.touches&&e.touches.length&&"stylus"===e.touches[0].touchType},Ss=function(e){return e.touches&&e.touches.length>1},_s=function(){if(ue(document.body,V.iosfix)){var e=parseInt(document.body.style.top,10);ve(document.body,V.iosfix),document.body.style.top="",document.body.scrollTop=-1*e}},Os=function(){return!!window.MSInputMethodContext&&!!document.documentMode},Ts=function(){var e=q(),t=G();e.style.removeProperty("align-items"),t.offsetTop<0&&(e.style.alignItems="flex-start")},xs=function(){"undefined"!=typeof window&&Os()&&(Ts(),window.addEventListener("resize",Ts))},Cs=function(){"undefined"!=typeof window&&Os()&&window.removeEventListener("resize",Ts)},Is=function(){v(document.body.children).forEach((function(e){e===q()||Ne(e,q())||(e.hasAttribute("aria-hidden")&&e.setAttribute("data-previous-aria-hidden",e.getAttribute("aria-hidden")),e.setAttribute("aria-hidden","true"))}))},Ms=function(){v(document.body.children).forEach((function(e){e.hasAttribute("data-previous-aria-hidden")?(e.setAttribute("aria-hidden",e.getAttribute("data-previous-aria-hidden")),e.removeAttribute("data-previous-aria-hidden")):e.removeAttribute("aria-hidden")}))},Ns={swalPromiseResolve:new WeakMap};function As(e,t,s,i){oe()?Ds(e,i):(Ht(s).then((function(){return Ds(e,i)})),Ut.keydownTarget.removeEventListener("keydown",Ut.keydownHandler,{capture:Ut.keydownListenerCapture}),Ut.keydownHandlerAdded=!1),t.parentNode&&!document.body.getAttribute("data-swal2-queue-step")&&t.parentNode.removeChild(t),ne()&&(bs(),_s(),Cs(),Ms()),Es()}function Es(){ve([document.documentElement,document.body],[V.shown,V["height-auto"],V["no-backdrop"],V["toast-shown"]])}function Ps(e){var t=G();if(t){e=Bs(e);var s=et.innerParams.get(this);if(s&&!ue(t,s.hideClass.popup)){var i=Ns.swalPromiseResolve.get(this);ve(t,s.showClass.popup),ye(t,s.hideClass.popup);var r=q();ve(r,s.showClass.backdrop),ye(r,s.hideClass.backdrop),Vs(this,t,s),i(e)}}}var Bs=function(e){return void 0===e?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:r({isConfirmed:!1,isDenied:!1,isDismissed:!1},e)},Vs=function(e,t,s){var i=q(),r=ze&&Me(t),a=s.onClose,n=s.onAfterClose,o=s.willClose,c=s.didClose;Ls(t,o,a),r?qs(e,t,i,s.returnFocus,c||n):As(e,i,s.returnFocus,c||n)},Ls=function(e,t,s){null!==t&&"function"==typeof t?t(e):null!==s&&"function"==typeof s&&s(e)},qs=function(e,t,s,i,r){Ut.swalCloseEventFinishedCallback=As.bind(null,e,s,i,r),t.addEventListener(ze,(function(e){e.target===t&&(Ut.swalCloseEventFinishedCallback(),delete Ut.swalCloseEventFinishedCallback)}))},Ds=function(e,t){setTimeout((function(){"function"==typeof t&&t(),e._destroy()}))};function Rs(e,t,s){var i=et.domCache.get(e);t.forEach((function(e){i[e].disabled=s}))}function Gs(e,t){if(!e)return!1;if("radio"===e.type)for(var s=e.parentNode.parentNode.querySelectorAll("input"),i=0;i<s.length;i++)s[i].disabled=t;else e.disabled=t}function Fs(){Rs(this,["confirmButton","denyButton","cancelButton"],!1)}function Us(){Rs(this,["confirmButton","denyButton","cancelButton"],!0)}function js(){return Gs(this.getInput(),!1)}function Hs(){return Gs(this.getInput(),!0)}function zs(e){var t=et.domCache.get(this),s=et.innerParams.get(this);he(t.validationMessage,e),t.validationMessage.className=V["validation-message"],s.customClass&&s.customClass.validationMessage&&ye(t.validationMessage,s.customClass.validationMessage),Se(t.validationMessage);var i=this.getInput();i&&(i.setAttribute("aria-invalid",!0),i.setAttribute("aria-describedBy",V["validation-message"]),be(i),ye(i,V.inputerror))}function Ws(){var e=et.domCache.get(this);e.validationMessage&&_e(e.validationMessage);var t=this.getInput();t&&(t.removeAttribute("aria-invalid"),t.removeAttribute("aria-describedBy"),ve(t,V.inputerror))}function Ks(){return et.domCache.get(this).progressSteps}var Xs=function(){function e(s,i){t(this,e),this.callback=s,this.remaining=i,this.running=!1,this.start()}return i(e,[{key:"start",value:function(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}},{key:"stop",value:function(){return this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date-this.started),this.remaining}},{key:"increase",value:function(e){var t=this.running;return t&&this.stop(),this.remaining+=e,t&&this.start(),this.remaining}},{key:"getTimerLeft",value:function(){return this.running&&(this.stop(),this.start()),this.remaining}},{key:"isRunning",value:function(){return this.running}}]),e}(),Ys={email:function(e,t){return/^[a-zA-Z0-9.+_-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]{2,24}$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid email address")},url:function(e,t){return/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid URL")}};function Zs(e){e.inputValidator||Object.keys(Ys).forEach((function(t){e.input===t&&(e.inputValidator=Ys[t])}))}function Qs(e){(!e.target||"string"==typeof e.target&&!document.querySelector(e.target)||"string"!=typeof e.target&&!e.target.appendChild)&&(w('Target parameter is not valid, defaulting to "body"'),e.target="body")}function Js(e){Zs(e),e.showLoaderOnConfirm&&!e.preConfirm&&w("showLoaderOnConfirm is set to true, but preConfirm is not defined.\nshowLoaderOnConfirm should be used together with preConfirm, see usage example:\nhttps://sweetalert2.github.io/#ajax-request"),e.animation=T(e.animation),Qs(e),"string"==typeof e.title&&(e.title=e.title.split("\n").join("<br />")),Fe(e)}var $s=["swal-title","swal-html","swal-footer"],ei=function(e){var t="string"==typeof e.template?document.querySelector(e.template):e.template;if(!t)return{};var s=t.content||t;return oi(s),r(ti(s),si(s),ii(s),ri(s),ai(s),ni(s,$s))},ti=function(t){var s={};return v(t.querySelectorAll("swal-param")).forEach((function(t){ci(t,["name","value"]);var i=t.getAttribute("name"),r=t.getAttribute("value");"boolean"==typeof ts[i]&&"false"===r&&(r=!1),"object"===e(ts[i])&&(r=JSON.parse(r)),s[i]=r})),s},si=function(e){var t={};return v(e.querySelectorAll("swal-button")).forEach((function(e){ci(e,["type","color","aria-label"]);var s=e.getAttribute("type");t["".concat(s,"ButtonText")]=e.innerHTML,t["show".concat(g(s),"Button")]=!0,e.hasAttribute("color")&&(t["".concat(s,"ButtonColor")]=e.getAttribute("color")),e.hasAttribute("aria-label")&&(t["".concat(s,"ButtonAriaLabel")]=e.getAttribute("aria-label"))})),t},ii=function(e){var t={},s=e.querySelector("swal-image");return s&&(ci(s,["src","width","height","alt"]),s.hasAttribute("src")&&(t.imageUrl=s.getAttribute("src")),s.hasAttribute("width")&&(t.imageWidth=s.getAttribute("width")),s.hasAttribute("height")&&(t.imageHeight=s.getAttribute("height")),s.hasAttribute("alt")&&(t.imageAlt=s.getAttribute("alt"))),t},ri=function(e){var t={},s=e.querySelector("swal-icon");return s&&(ci(s,["type","color"]),s.hasAttribute("type")&&(t.icon=s.getAttribute("type")),s.hasAttribute("color")&&(t.iconColor=s.getAttribute("color")),t.iconHtml=s.innerHTML),t},ai=function(e){var t={},s=e.querySelector("swal-input");s&&(ci(s,["type","label","placeholder","value"]),t.input=s.getAttribute("type")||"text",s.hasAttribute("label")&&(t.inputLabel=s.getAttribute("label")),s.hasAttribute("placeholder")&&(t.inputPlaceholder=s.getAttribute("placeholder")),s.hasAttribute("value")&&(t.inputValue=s.getAttribute("value")));var i=e.querySelectorAll("swal-input-option");return i.length&&(t.inputOptions={},v(i).forEach((function(e){ci(e,["value"]);var s=e.getAttribute("value"),i=e.innerHTML;t.inputOptions[s]=i}))),t},ni=function(e,t){var s={};for(var i in t){var r=t[i],a=e.querySelector(r);a&&(ci(a,[]),s[r.replace(/^swal-/,"")]=a.innerHTML.trim())}return s},oi=function(e){var t=$s.concat(["swal-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);v(e.querySelectorAll("*")).forEach((function(s){if(s.parentNode===e){var i=s.tagName.toLowerCase();-1===t.indexOf(i)&&w("Unrecognized element <".concat(i,">"))}}))},ci=function(e,t){v(e.attributes).forEach((function(s){-1===t.indexOf(s.name)&&w(['Unrecognized attribute "'.concat(s.name,'" on <').concat(e.tagName.toLowerCase(),">."),"".concat(t.length?"Allowed attributes are: ".concat(t.join(", ")):"To set the value, use HTML within the element.")])}))},di=10,hi=function(e){var t=q(),s=G();"function"==typeof e.willOpen?e.willOpen(s):"function"==typeof e.onBeforeOpen&&e.onBeforeOpen(s);var i=window.getComputedStyle(document.body).overflowY;mi(t,s,e),setTimeout((function(){fi(t,s)}),di),ne()&&(pi(t,e.scrollbarPadding,i),Is()),oe()||Ut.previousActiveElement||(Ut.previousActiveElement=document.activeElement),ui(s,e),ve(t,V["no-transition"])},ui=function(e,t){"function"==typeof t.didOpen?setTimeout((function(){return t.didOpen(e)})):"function"==typeof t.onOpen&&setTimeout((function(){return t.onOpen(e)}))},li=function e(t){var s=G();if(t.target===s){var i=q();s.removeEventListener(ze,e),i.style.overflowY="auto"}},fi=function(e,t){ze&&Me(t)?(e.style.overflowY="hidden",t.addEventListener(ze,li)):e.style.overflowY="auto"},pi=function(e,t,s){gs(),xs(),t&&"hidden"!==s&&ms(),setTimeout((function(){e.scrollTop=0}))},mi=function(e,t,s){ye(e,s.showClass.backdrop),t.style.setProperty("opacity","0","important"),Se(t),setTimeout((function(){ye(t,s.showClass.popup),t.style.removeProperty("opacity")}),di),ye([document.documentElement,document.body],V.shown),s.heightAuto&&s.backdrop&&!s.toast&&ye([document.documentElement,document.body],V["height-auto"])},bi=function(e,t){"select"===t.input||"radio"===t.input?ki(e,t):-1!==["text","email","number","tel","textarea"].indexOf(t.input)&&(x(t.inputValue)||I(t.inputValue))&&Si(e,t)},gi=function(e,t){var s=e.getInput();if(!s)return null;switch(t.input){case"checkbox":return yi(s);case"radio":return vi(s);case"file":return wi(s);default:return t.inputAutoTrim?s.value.trim():s.value}},yi=function(e){return e.checked?1:0},vi=function(e){return e.checked?e.value:null},wi=function(e){return e.files.length?null!==e.getAttribute("multiple")?e.files:e.files[0]:null},ki=function(t,s){var i=j(),r=function(e){return _i[s.input](i,Oi(e),s)};x(s.inputOptions)||I(s.inputOptions)?(Gt(X()),C(s.inputOptions).then((function(e){t.hideLoading(),r(e)}))):"object"===e(s.inputOptions)?r(s.inputOptions):k("Unexpected type of inputOptions! Expected object, Map or Promise, got ".concat(e(s.inputOptions)))},Si=function(e,t){var s=e.getInput();_e(s),C(t.inputValue).then((function(i){s.value="number"===t.input?parseFloat(i)||0:"".concat(i),Se(s),s.focus(),e.hideLoading()})).catch((function(t){k("Error in inputValue promise: ".concat(t)),s.value="",Se(s),s.focus(),e.hideLoading()}))},_i={select:function(e,t,s){var i=we(e,V.select),r=function(e,t,i){var r=document.createElement("option");r.value=i,he(r,t),r.selected=Ti(i,s.inputValue),e.appendChild(r)};t.forEach((function(e){var t=e[0],s=e[1];if(Array.isArray(s)){var a=document.createElement("optgroup");a.label=t,a.disabled=!1,i.appendChild(a),s.forEach((function(e){return r(a,e[1],e[0])}))}else r(i,s,t)})),i.focus()},radio:function(e,t,s){var i=we(e,V.radio);t.forEach((function(e){var t=e[0],r=e[1],a=document.createElement("input"),n=document.createElement("label");a.type="radio",a.name=V.radio,a.value=t,Ti(t,s.inputValue)&&(a.checked=!0);var o=document.createElement("span");he(o,r),o.className=V.label,n.appendChild(a),n.appendChild(o),i.appendChild(n)}));var r=i.querySelectorAll("input");r.length&&r[0].focus()}},Oi=function t(s){var i=[];return"undefined"!=typeof Map&&s instanceof Map?s.forEach((function(s,r){var a=s;"object"===e(a)&&(a=t(a)),i.push([r,a])})):Object.keys(s).forEach((function(r){var a=s[r];"object"===e(a)&&(a=t(a)),i.push([r,a])})),i},Ti=function(e,t){return t&&t.toString()===e.toString()},xi=function(e,t){e.disableButtons(),t.input?Mi(e,t,"confirm"):Pi(e,t,!0)},Ci=function(e,t){e.disableButtons(),t.returnInputValueOnDeny?Mi(e,t,"deny"):Ai(e,t,!1)},Ii=function(e,t){e.disableButtons(),t(M.cancel)},Mi=function(e,t,s){var i=gi(e,t);t.inputValidator?Ni(e,t,i):e.getInput().checkValidity()?"deny"===s?Ai(e,t,i):Pi(e,t,i):(e.enableButtons(),e.showValidationMessage(t.validationMessage))},Ni=function(e,t,s){e.disableInput(),Promise.resolve().then((function(){return C(t.inputValidator(s,t.validationMessage))})).then((function(i){e.enableButtons(),e.enableInput(),i?e.showValidationMessage(i):Pi(e,t,s)}))},Ai=function(e,t,s){t.showLoaderOnDeny&&Gt(Y()),t.preDeny?Promise.resolve().then((function(){return C(t.preDeny(s,t.validationMessage))})).then((function(t){!1===t?e.hideLoading():e.closePopup({isDenied:!0,value:void 0===t?s:t})})):e.closePopup({isDenied:!0,value:s})},Ei=function(e,t){e.closePopup({isConfirmed:!0,value:t})},Pi=function(e,t,s){t.showLoaderOnConfirm&&Gt(),t.preConfirm?(e.resetValidationMessage(),Promise.resolve().then((function(){return C(t.preConfirm(s,t.validationMessage))})).then((function(t){xe(K())||!1===t?e.hideLoading():Ei(e,void 0===t?s:t)}))):Ei(e,s)},Bi=function(e,t,s,i){t.keydownTarget&&t.keydownHandlerAdded&&(t.keydownTarget.removeEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1),s.toast||(t.keydownHandler=function(t){return Ri(e,t,i)},t.keydownTarget=s.keydownListenerCapture?window:G(),t.keydownListenerCapture=s.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)},Vi=function(e,t,s){var i=ae();if(i.length)return(t+=s)===i.length?t=0:-1===t&&(t=i.length-1),i[t].focus();G().focus()},Li=["ArrowRight","ArrowDown","Right","Down"],qi=["ArrowLeft","ArrowUp","Left","Up"],Di=["Escape","Esc"],Ri=function(e,t,s){var i=et.innerParams.get(e);i&&(i.stopKeydownPropagation&&t.stopPropagation(),"Enter"===t.key?Gi(e,t,i):"Tab"===t.key?Fi(t,i):-1!==[].concat(Li,qi).indexOf(t.key)?Ui(t.key):-1!==Di.indexOf(t.key)&&ji(t,i,s))},Gi=function(e,t,s){if(!t.isComposing&&t.target&&e.getInput()&&t.target.outerHTML===e.getInput().outerHTML){if(-1!==["textarea","file"].indexOf(s.input))return;Vt(),t.preventDefault()}},Fi=function(e,t){for(var s=e.target,i=ae(),r=-1,a=0;a<i.length;a++)if(s===i[a]){r=a;break}e.shiftKey?Vi(t,r,-1):Vi(t,r,1),e.stopPropagation(),e.preventDefault()},Ui=function(e){if(-1!==[X(),Y(),J()].indexOf(document.activeElement)){var t=-1!==Li.indexOf(e)?"nextElementSibling":"previousElementSibling",s=document.activeElement[t];s&&s.focus()}},ji=function(e,t,s){T(t.allowEscapeKey)&&(e.preventDefault(),s(M.esc))},Hi=function(e,t,s){et.innerParams.get(e).toast?zi(e,t,s):(Ki(t),Xi(t),Yi(e,t,s))},zi=function(e,t,s){t.popup.onclick=function(){var t=et.innerParams.get(e);t.showConfirmButton||t.showDenyButton||t.showCancelButton||t.showCloseButton||t.timer||t.input||s(M.close)}},Wi=!1,Ki=function(e){e.popup.onmousedown=function(){e.container.onmouseup=function(t){e.container.onmouseup=void 0,t.target===e.container&&(Wi=!0)}}},Xi=function(e){e.container.onmousedown=function(){e.popup.onmouseup=function(t){e.popup.onmouseup=void 0,(t.target===e.popup||e.popup.contains(t.target))&&(Wi=!0)}}},Yi=function(e,t,s){t.container.onclick=function(i){var r=et.innerParams.get(e);Wi?Wi=!1:i.target===t.container&&T(r.allowOutsideClick)&&s(M.backdrop)}};function Zi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};us(r({},t,e)),Ut.currentInstance&&Ut.currentInstance._destroy(),Ut.currentInstance=this;var s=Qi(e,t);Js(s),Object.freeze(s),Ut.timeout&&(Ut.timeout.stop(),delete Ut.timeout),clearTimeout(Ut.restoreFocusTimeout);var i=$i(this);return Pt(this,s),et.innerParams.set(this,s),Ji(this,i,s)}var Qi=function(e,t){var s=ei(e),i=r({},ts,t,s,e);return i.showClass=r({},ts.showClass,i.showClass),i.hideClass=r({},ts.hideClass,i.hideClass),!1===e.animation&&(i.showClass={popup:"swal2-noanimation",backdrop:"swal2-noanimation"},i.hideClass={}),i},Ji=function(e,t,s){return new Promise((function(i){var r=function(t){e.closePopup({isDismissed:!0,dismiss:t})};Ns.swalPromiseResolve.set(e,i),t.confirmButton.onclick=function(){return xi(e,s)},t.denyButton.onclick=function(){return Ci(e,s)},t.cancelButton.onclick=function(){return Ii(e,r)},t.closeButton.onclick=function(){return r(M.close)},Hi(e,t,r),Bi(e,Ut,s,r),bi(e,s),hi(s),er(Ut,s,r),tr(t,s),setTimeout((function(){t.container.scrollTop=0}))}))},$i=function(e){var t={popup:G(),container:q(),content:j(),actions:$(),confirmButton:X(),denyButton:Y(),cancelButton:J(),loader:Q(),closeButton:ie(),validationMessage:K(),progressSteps:W()};return et.domCache.set(e,t),t},er=function(e,t,s){var i=se();_e(i),t.timer&&(e.timeout=new Xs((function(){s("timer"),delete e.timeout}),t.timer),t.timerProgressBar&&(Se(i),setTimeout((function(){e.timeout&&e.timeout.running&&Ae(t.timer)}))))},tr=function(e,t){if(!t.toast)return T(t.allowEnterKey)?void(sr(e,t)||Vi(t,-1,1)):ir()},sr=function(e,t){return t.focusDeny&&xe(e.denyButton)?(e.denyButton.focus(),!0):t.focusCancel&&xe(e.cancelButton)?(e.cancelButton.focus(),!0):!(!t.focusConfirm||!xe(e.confirmButton)||(e.confirmButton.focus(),0))},ir=function(){document.activeElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur()};function rr(e){var t=G(),s=et.innerParams.get(this);if(!t||ue(t,s.hideClass.popup))return w("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");var i={};Object.keys(e).forEach((function(t){lr.isUpdatableParameter(t)?i[t]=e[t]:w('Invalid parameter to update: "'.concat(t,'". Updatable params are listed here: https://github.com/sweetalert2/sweetalert2/blob/master/src/utils/params.js\n\nIf you think this parameter should be updatable, request it here: https://github.com/sweetalert2/sweetalert2/issues/new?template=02_feature_request.md'))}));var a=r({},s,i);Pt(this,a),et.innerParams.set(this,a),Object.defineProperties(this,{params:{value:r({},this.params,e),writable:!1,enumerable:!0}})}function ar(){var e=et.domCache.get(this),t=et.innerParams.get(this);t&&(e.popup&&Ut.swalCloseEventFinishedCallback&&(Ut.swalCloseEventFinishedCallback(),delete Ut.swalCloseEventFinishedCallback),Ut.deferDisposalTimer&&(clearTimeout(Ut.deferDisposalTimer),delete Ut.deferDisposalTimer),or(t),cr(this))}var nr,or=function(e){"function"==typeof e.didDestroy?e.didDestroy():"function"==typeof e.onDestroy&&e.onDestroy()},cr=function(e){delete e.params,delete Ut.keydownHandler,delete Ut.keydownTarget,dr(et),dr(Ns)},dr=function(e){for(var t in e)e[t]=new WeakMap},hr=Object.freeze({hideLoading:fs,disableLoading:fs,getInput:ps,close:Ps,closePopup:Ps,closeModal:Ps,closeToast:Ps,enableButtons:Fs,disableButtons:Us,enableInput:js,disableInput:Hs,showValidationMessage:zs,resetValidationMessage:Ws,getProgressSteps:Ks,_main:Zi,update:rr,_destroy:ar}),ur=function(){function e(){if(t(this,e),"undefined"!=typeof window){"undefined"==typeof Promise&&k("This package requires a Promise library, please include a shim to enable it in this browser (See: https://github.com/sweetalert2/sweetalert2/wiki/Migration-from-SweetAlert-to-SweetAlert2#1-ie-support)"),nr=this;for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];var a=Object.freeze(this.constructor.argsToParams(i));Object.defineProperties(this,{params:{value:a,writable:!1,enumerable:!0,configurable:!0}});var n=this._main(this.params);et.promise.set(this,n)}}return i(e,[{key:"then",value:function(e){return et.promise.get(this).then(e)}},{key:"finally",value:function(e){return et.promise.get(this).finally(e)}}]),e}();r(ur.prototype,hr),r(ur,ls),Object.keys(hr).forEach((function(e){ur[e]=function(){var t;if(nr)return(t=nr)[e].apply(t,arguments)}})),ur.DismissReason=M,ur.version="10.16.9";var lr=ur;return lr.default=lr,lr}(),void 0!==this&&this.Sweetalert2&&(this.swal=this.sweetAlert=this.Swal=this.SweetAlert=this.Sweetalert2),"undefined"!=typeof document&&function(e,t){var s=e.createElement("style");if(e.getElementsByTagName("head")[0].appendChild(s),s.styleSheet)s.styleSheet.disabled||(s.styleSheet.cssText=t);else try{s.innerHTML=t}catch(e){s.innerText=t}}(document,'.swal2-popup.swal2-toast{flex-direction:column;align-items:stretch;width:auto;padding:1.25em;overflow-y:hidden;background:#fff;box-shadow:0 0 .625em #d9d9d9}.swal2-popup.swal2-toast .swal2-header{flex-direction:row;padding:0}.swal2-popup.swal2-toast .swal2-title{flex-grow:1;justify-content:flex-start;margin:0 .625em;font-size:1em}.swal2-popup.swal2-toast .swal2-loading{justify-content:center}.swal2-popup.swal2-toast .swal2-input{height:2em;margin:.3125em auto;font-size:1em}.swal2-popup.swal2-toast .swal2-validation-message{font-size:1em}.swal2-popup.swal2-toast .swal2-footer{margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-popup.swal2-toast .swal2-close{position:static;width:.8em;height:.8em;line-height:.8}.swal2-popup.swal2-toast .swal2-content{justify-content:flex-start;margin:0 .625em;padding:0;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-html-container{padding:.625em 0 0}.swal2-popup.swal2-toast .swal2-html-container:empty{padding:0}.swal2-popup.swal2-toast .swal2-icon{width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:700}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{font-size:.25em}}.swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-popup.swal2-toast .swal2-actions{flex:1;flex-basis:auto!important;align-self:stretch;width:auto;height:2.2em;height:auto;margin:0 .3125em;margin-top:.3125em;padding:0}.swal2-popup.swal2-toast .swal2-styled{margin:.125em .3125em;padding:.3125em .625em;font-size:1em}.swal2-popup.swal2-toast .swal2-styled:focus{box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(100,150,200,.5)}.swal2-popup.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;transform:rotate(45deg);border-radius:50%}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-.8em;left:-.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-popup.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{-webkit-animation:swal2-toast-animate-success-line-tip .75s;animation:swal2-toast-animate-success-line-tip .75s}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{-webkit-animation:swal2-toast-animate-success-line-long .75s;animation:swal2-toast-animate-success-line-long .75s}.swal2-popup.swal2-toast.swal2-show{-webkit-animation:swal2-toast-show .5s;animation:swal2-toast-show .5s}.swal2-popup.swal2-toast.swal2-hide{-webkit-animation:swal2-toast-hide .1s forwards;animation:swal2-toast-hide .1s forwards}.swal2-container{display:flex;position:fixed;z-index:1060;top:0;right:0;bottom:0;left:0;flex-direction:row;align-items:center;justify-content:center;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}.swal2-container.swal2-backdrop-show,.swal2-container.swal2-noanimation{background:rgba(0,0,0,.4)}.swal2-container.swal2-backdrop-hide{background:0 0!important}.swal2-container.swal2-top{align-items:flex-start}.swal2-container.swal2-top-left,.swal2-container.swal2-top-start{align-items:flex-start;justify-content:flex-start}.swal2-container.swal2-top-end,.swal2-container.swal2-top-right{align-items:flex-start;justify-content:flex-end}.swal2-container.swal2-center{align-items:center}.swal2-container.swal2-center-left,.swal2-container.swal2-center-start{align-items:center;justify-content:flex-start}.swal2-container.swal2-center-end,.swal2-container.swal2-center-right{align-items:center;justify-content:flex-end}.swal2-container.swal2-bottom{align-items:flex-end}.swal2-container.swal2-bottom-left,.swal2-container.swal2-bottom-start{align-items:flex-end;justify-content:flex-start}.swal2-container.swal2-bottom-end,.swal2-container.swal2-bottom-right{align-items:flex-end;justify-content:flex-end}.swal2-container.swal2-bottom-end>:first-child,.swal2-container.swal2-bottom-left>:first-child,.swal2-container.swal2-bottom-right>:first-child,.swal2-container.swal2-bottom-start>:first-child,.swal2-container.swal2-bottom>:first-child{margin-top:auto}.swal2-container.swal2-grow-fullscreen>.swal2-modal{display:flex!important;flex:1;align-self:stretch;justify-content:center}.swal2-container.swal2-grow-row>.swal2-modal{display:flex!important;flex:1;align-content:center;justify-content:center}.swal2-container.swal2-grow-column{flex:1;flex-direction:column}.swal2-container.swal2-grow-column.swal2-bottom,.swal2-container.swal2-grow-column.swal2-center,.swal2-container.swal2-grow-column.swal2-top{align-items:center}.swal2-container.swal2-grow-column.swal2-bottom-left,.swal2-container.swal2-grow-column.swal2-bottom-start,.swal2-container.swal2-grow-column.swal2-center-left,.swal2-container.swal2-grow-column.swal2-center-start,.swal2-container.swal2-grow-column.swal2-top-left,.swal2-container.swal2-grow-column.swal2-top-start{align-items:flex-start}.swal2-container.swal2-grow-column.swal2-bottom-end,.swal2-container.swal2-grow-column.swal2-bottom-right,.swal2-container.swal2-grow-column.swal2-center-end,.swal2-container.swal2-grow-column.swal2-center-right,.swal2-container.swal2-grow-column.swal2-top-end,.swal2-container.swal2-grow-column.swal2-top-right{align-items:flex-end}.swal2-container.swal2-grow-column>.swal2-modal{display:flex!important;flex:1;align-content:center;justify-content:center}.swal2-container.swal2-no-transition{transition:none!important}.swal2-container:not(.swal2-top):not(.swal2-top-start):not(.swal2-top-end):not(.swal2-top-left):not(.swal2-top-right):not(.swal2-center-start):not(.swal2-center-end):not(.swal2-center-left):not(.swal2-center-right):not(.swal2-bottom):not(.swal2-bottom-start):not(.swal2-bottom-end):not(.swal2-bottom-left):not(.swal2-bottom-right):not(.swal2-grow-fullscreen)>.swal2-modal{margin:auto}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.swal2-container .swal2-modal{margin:0!important}}.swal2-popup{display:none;position:relative;box-sizing:border-box;flex-direction:column;justify-content:center;width:32em;max-width:100%;padding:1.25em;border:none;border-radius:5px;background:#fff;font-family:inherit;font-size:1rem}.swal2-popup:focus{outline:0}.swal2-popup.swal2-loading{overflow-y:hidden}.swal2-header{display:flex;flex-direction:column;align-items:center;padding:0 1.8em}.swal2-title{position:relative;max-width:100%;margin:0 0 .4em;padding:0;color:#595959;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word}.swal2-actions{display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:100%;margin:1.25em auto 0;padding:0}.swal2-actions:not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}.swal2-actions:not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0,0,0,.1),rgba(0,0,0,.1))}.swal2-actions:not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0,0,0,.2),rgba(0,0,0,.2))}.swal2-loader{display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;-webkit-animation:swal2-rotate-loading 1.5s linear 0s infinite normal;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 transparent #2778c4 transparent}.swal2-styled{margin:.3125em;padding:.625em 1.1em;box-shadow:none;font-weight:500}.swal2-styled:not([disabled]){cursor:pointer}.swal2-styled.swal2-confirm{border:0;border-radius:.25em;background:initial;background-color:#2778c4;color:#fff;font-size:1em}.swal2-styled.swal2-deny{border:0;border-radius:.25em;background:initial;background-color:#d14529;color:#fff;font-size:1em}.swal2-styled.swal2-cancel{border:0;border-radius:.25em;background:initial;background-color:#757575;color:#fff;font-size:1em}.swal2-styled:focus{outline:0;box-shadow:0 0 0 3px rgba(100,150,200,.5)}.swal2-styled::-moz-focus-inner{border:0}.swal2-footer{justify-content:center;margin:1.25em 0 0;padding:1em 0 0;border-top:1px solid #eee;color:#545454;font-size:1em}.swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;height:.25em;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}.swal2-timer-progress-bar{width:100%;height:.25em;background:rgba(0,0,0,.2)}.swal2-image{max-width:100%;margin:1.25em auto}.swal2-close{position:absolute;z-index:2;top:0;right:0;align-items:center;justify-content:center;width:1.2em;height:1.2em;padding:0;overflow:hidden;transition:color .1s ease-out;border:none;border-radius:5px;background:0 0;color:#ccc;font-family:serif;font-size:2.5em;line-height:1.2;cursor:pointer}.swal2-close:hover{transform:none;background:0 0;color:#f27474}.swal2-close:focus{outline:0;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}.swal2-close::-moz-focus-inner{border:0}.swal2-content{z-index:1;justify-content:center;margin:0;padding:0 1.6em;color:#545454;font-size:1.125em;font-weight:400;line-height:normal;text-align:center;word-wrap:break-word}.swal2-checkbox,.swal2-file,.swal2-input,.swal2-radio,.swal2-select,.swal2-textarea{margin:1em auto}.swal2-file,.swal2-input,.swal2-textarea{box-sizing:border-box;width:100%;transition:border-color .3s,box-shadow .3s;border:1px solid #d9d9d9;border-radius:.1875em;background:inherit;box-shadow:inset 0 1px 1px rgba(0,0,0,.06);color:inherit;font-size:1.125em}.swal2-file.swal2-inputerror,.swal2-input.swal2-inputerror,.swal2-textarea.swal2-inputerror{border-color:#f27474!important;box-shadow:0 0 2px #f27474!important}.swal2-file:focus,.swal2-input:focus,.swal2-textarea:focus{border:1px solid #b4dbed;outline:0;box-shadow:0 0 0 3px rgba(100,150,200,.5)}.swal2-file::-moz-placeholder,.swal2-input::-moz-placeholder,.swal2-textarea::-moz-placeholder{color:#ccc}.swal2-file:-ms-input-placeholder,.swal2-input:-ms-input-placeholder,.swal2-textarea:-ms-input-placeholder{color:#ccc}.swal2-file::placeholder,.swal2-input::placeholder,.swal2-textarea::placeholder{color:#ccc}.swal2-range{margin:1em auto;background:#fff}.swal2-range input{width:80%}.swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}.swal2-range input,.swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}.swal2-input{height:2.625em;padding:0 .75em}.swal2-input[type=number]{max-width:10em}.swal2-file{background:inherit;font-size:1.125em}.swal2-textarea{height:6.75em;padding:.75em}.swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:inherit;color:inherit;font-size:1.125em}.swal2-checkbox,.swal2-radio{align-items:center;justify-content:center;background:#fff;color:inherit}.swal2-checkbox label,.swal2-radio label{margin:0 .6em;font-size:1.125em}.swal2-checkbox input,.swal2-radio input{flex-shrink:0;margin:0 .4em}.swal2-input-label{display:flex;justify-content:center;margin:1em auto}.swal2-validation-message{align-items:center;justify-content:center;margin:0 -2.7em;padding:.625em;overflow:hidden;background:#f0f0f0;color:#666;font-size:1em;font-weight:300}.swal2-validation-message::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}.swal2-icon{position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:1.25em auto 1.875em;border:.25em solid transparent;border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}.swal2-icon.swal2-error{border-color:#f27474;color:#f27474}.swal2-icon.swal2-error .swal2-x-mark{position:relative;flex-grow:1}.swal2-icon.swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}.swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}.swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}.swal2-icon.swal2-error.swal2-icon-show{-webkit-animation:swal2-animate-error-icon .5s;animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-error.swal2-icon-show .swal2-x-mark{-webkit-animation:swal2-animate-error-x-mark .5s;animation:swal2-animate-error-x-mark .5s}.swal2-icon.swal2-warning{border-color:#facea8;color:#f8bb86}.swal2-icon.swal2-info{border-color:#9de0f6;color:#3fc3ee}.swal2-icon.swal2-question{border-color:#c9dae1;color:#87adbd}.swal2-icon.swal2-success{border-color:#a5dc86;color:#a5dc86}.swal2-icon.swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;transform:rotate(45deg);border-radius:50%}.swal2-icon.swal2-success [class^=swal2-success-circular-line][class$=left]{top:-.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}.swal2-icon.swal2-success [class^=swal2-success-circular-line][class$=right]{top:-.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}.swal2-icon.swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-.25em;left:-.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}.swal2-icon.swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}.swal2-icon.swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}.swal2-icon.swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}.swal2-icon.swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-line-tip{-webkit-animation:swal2-animate-success-line-tip .75s;animation:swal2-animate-success-line-tip .75s}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-line-long{-webkit-animation:swal2-animate-success-line-long .75s;animation:swal2-animate-success-line-long .75s}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-circular-line-right{-webkit-animation:swal2-rotate-success-circular-line 4.25s ease-in;animation:swal2-rotate-success-circular-line 4.25s ease-in}.swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:0 0 1.25em;padding:0;background:inherit;font-weight:600}.swal2-progress-steps li{display:inline-block;position:relative}.swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}.swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}[class^=swal2]{-webkit-tap-highlight-color:transparent}.swal2-show{-webkit-animation:swal2-show .3s;animation:swal2-show .3s}.swal2-hide{-webkit-animation:swal2-hide .15s forwards;animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{right:auto;left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}@supports (-ms-accelerator:true){.swal2-range input{width:100%!important}.swal2-range output{display:none}}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.swal2-range input{width:100%!important}.swal2-range output{display:none}}@-webkit-keyframes swal2-toast-show{0%{transform:translateY(-.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0)}}@keyframes swal2-toast-show{0%{transform:translateY(-.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0)}}@-webkit-keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@-webkit-keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@-webkit-keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@-webkit-keyframes swal2-show{0%{transform:scale(.7)}45%{transform:scale(1.05)}80%{transform:scale(.95)}100%{transform:scale(1)}}@keyframes swal2-show{0%{transform:scale(.7)}45%{transform:scale(1.05)}80%{transform:scale(.95)}100%{transform:scale(1)}}@-webkit-keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(.5);opacity:0}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(.5);opacity:0}}@-webkit-keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@-webkit-keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@-webkit-keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@-webkit-keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(.4);opacity:0}50%{margin-top:1.625em;transform:scale(.4);opacity:0}80%{margin-top:-.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(.4);opacity:0}50%{margin-top:1.625em;transform:scale(.4);opacity:0}80%{margin-top:-.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@-webkit-keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0);opacity:1}}@-webkit-keyframes swal2-rotate-loading{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}@keyframes swal2-rotate-loading{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto!important}body.swal2-no-backdrop .swal2-container{top:auto;right:auto;bottom:auto;left:auto;max-width:calc(100% - .625em * 2);background-color:transparent!important}body.swal2-no-backdrop .swal2-container>.swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}body.swal2-no-backdrop .swal2-container.swal2-top{top:0;left:50%;transform:translateX(-50%)}body.swal2-no-backdrop .swal2-container.swal2-top-left,body.swal2-no-backdrop .swal2-container.swal2-top-start{top:0;left:0}body.swal2-no-backdrop .swal2-container.swal2-top-end,body.swal2-no-backdrop .swal2-container.swal2-top-right{top:0;right:0}body.swal2-no-backdrop .swal2-container.swal2-center{top:50%;left:50%;transform:translate(-50%,-50%)}body.swal2-no-backdrop .swal2-container.swal2-center-left,body.swal2-no-backdrop .swal2-container.swal2-center-start{top:50%;left:0;transform:translateY(-50%)}body.swal2-no-backdrop .swal2-container.swal2-center-end,body.swal2-no-backdrop .swal2-container.swal2-center-right{top:50%;right:0;transform:translateY(-50%)}body.swal2-no-backdrop .swal2-container.swal2-bottom{bottom:0;left:50%;transform:translateX(-50%)}body.swal2-no-backdrop .swal2-container.swal2-bottom-left,body.swal2-no-backdrop .swal2-container.swal2-bottom-start{bottom:0;left:0}body.swal2-no-backdrop .swal2-container.swal2-bottom-end,body.swal2-no-backdrop .swal2-container.swal2-bottom-right{right:0;bottom:0}@media print{body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow-y:scroll!important}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown) .swal2-container{position:static!important}}body.swal2-toast-shown .swal2-container{background-color:transparent}body.swal2-toast-shown .swal2-container.swal2-top{top:0;right:auto;bottom:auto;left:50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{top:0;right:0;bottom:auto;left:auto}body.swal2-toast-shown .swal2-container.swal2-top-left,body.swal2-toast-shown .swal2-container.swal2-top-start{top:0;right:auto;bottom:auto;left:0}body.swal2-toast-shown .swal2-container.swal2-center-left,body.swal2-toast-shown .swal2-container.swal2-center-start{top:50%;right:auto;bottom:auto;left:0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{top:50%;right:auto;bottom:auto;left:50%;transform:translate(-50%,-50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{top:50%;right:0;bottom:auto;left:auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-left,body.swal2-toast-shown .swal2-container.swal2-bottom-start{top:auto;right:auto;bottom:0;left:0}body.swal2-toast-shown .swal2-container.swal2-bottom{top:auto;right:auto;bottom:0;left:50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{top:auto;right:0;bottom:0;left:auto}')},2885:(e,t,s)=>{var i=s(8764).Buffer;e.exports=function(e){if(e instanceof Uint8Array){if(0===e.byteOffset&&e.byteLength===e.buffer.byteLength)return e.buffer;if("function"==typeof e.buffer.slice)return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}if(i.isBuffer(e)){for(var t=new Uint8Array(e.length),s=e.length,r=0;r<s;r++)t[r]=e[r];return t.buffer}throw new Error("Argument must be a Buffer")}},2511:function(e,t,s){var i;e=s.nmd(e),function(r){t&&t.nodeType,e&&e.nodeType;var a="object"==typeof s.g&&s.g;a.global!==a&&a.window!==a&&a.self;var n,o=2147483647,c=36,d=/^xn--/,h=/[^\x20-\x7E]/,u=/[\x2E\u3002\uFF0E\uFF61]/g,l={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,p=String.fromCharCode;function m(e){throw RangeError(l[e])}function b(e,t){for(var s=e.length,i=[];s--;)i[s]=t(e[s]);return i}function g(e,t){var s=e.split("@"),i="";return s.length>1&&(i=s[0]+"@",e=s[1]),i+b((e=e.replace(u,".")).split("."),t).join(".")}function y(e){for(var t,s,i=[],r=0,a=e.length;r<a;)(t=e.charCodeAt(r++))>=55296&&t<=56319&&r<a?56320==(64512&(s=e.charCodeAt(r++)))?i.push(((1023&t)<<10)+(1023&s)+65536):(i.push(t),r--):i.push(t);return i}function v(e){return b(e,(function(e){var t="";return e>65535&&(t+=p((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=p(e)})).join("")}function w(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function k(e,t,s){var i=0;for(e=s?f(e/700):e>>1,e+=f(e/t);e>455;i+=c)e=f(e/35);return f(i+36*e/(e+38))}function S(e){var t,s,i,r,a,n,d,h,u,l,p,b=[],g=e.length,y=0,w=128,S=72;for((s=e.lastIndexOf("-"))<0&&(s=0),i=0;i<s;++i)e.charCodeAt(i)>=128&&m("not-basic"),b.push(e.charCodeAt(i));for(r=s>0?s+1:0;r<g;){for(a=y,n=1,d=c;r>=g&&m("invalid-input"),((h=(p=e.charCodeAt(r++))-48<10?p-22:p-65<26?p-65:p-97<26?p-97:c)>=c||h>f((o-y)/n))&&m("overflow"),y+=h*n,!(h<(u=d<=S?1:d>=S+26?26:d-S));d+=c)n>f(o/(l=c-u))&&m("overflow"),n*=l;S=k(y-a,t=b.length+1,0==a),f(y/t)>o-w&&m("overflow"),w+=f(y/t),y%=t,b.splice(y++,0,w)}return v(b)}function _(e){var t,s,i,r,a,n,d,h,u,l,b,g,v,S,_,O=[];for(g=(e=y(e)).length,t=128,s=0,a=72,n=0;n<g;++n)(b=e[n])<128&&O.push(p(b));for(i=r=O.length,r&&O.push("-");i<g;){for(d=o,n=0;n<g;++n)(b=e[n])>=t&&b<d&&(d=b);for(d-t>f((o-s)/(v=i+1))&&m("overflow"),s+=(d-t)*v,t=d,n=0;n<g;++n)if((b=e[n])<t&&++s>o&&m("overflow"),b==t){for(h=s,u=c;!(h<(l=u<=a?1:u>=a+26?26:u-a));u+=c)_=h-l,S=c-l,O.push(p(w(l+_%S,0))),h=f(_/S);O.push(p(w(h,0))),a=k(s,v,i==r),s=0,++i}++s,++t}return O.join("")}n={version:"1.3.2",ucs2:{decode:y,encode:v},decode:S,encode:_,toASCII:function(e){return g(e,(function(e){return h.test(e)?"xn--"+_(e):e}))},toUnicode:function(e){return g(e,(function(e){return d.test(e)?S(e.slice(4).toLowerCase()):e}))}},void 0===(i=function(){return n}.call(t,s,t,e))||(e.exports=i)}()},8575:(e,t,s)=>{"use strict";var i=s(2511),r=s(2502);function a(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=v,t.resolve=function(e,t){return v(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?v(e,!1,!0).resolveObject(t):t},t.format=function(e){r.isString(e)&&(e=v(e));return e instanceof a?e.format():a.prototype.format.call(e)},t.Url=a;var n=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,d=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),h=["'"].concat(d),u=["%","/","?",";","#"].concat(h),l=["/","?","#"],f=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},b={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=s(7673);function v(e,t,s){if(e&&r.isObject(e)&&e instanceof a)return e;var i=new a;return i.parse(e,t,s),i}a.prototype.parse=function(e,t,s){if(!r.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var a=e.indexOf("?"),o=-1!==a&&a<e.indexOf("#")?"?":"#",d=e.split(o);d[0]=d[0].replace(/\\/g,"/");var v=e=d.join(o);if(v=v.trim(),!s&&1===e.split("#").length){var w=c.exec(v);if(w)return this.path=v,this.href=v,this.pathname=w[1],w[2]?(this.search=w[2],this.query=t?y.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var k=n.exec(v);if(k){var S=(k=k[0]).toLowerCase();this.protocol=S,v=v.substr(k.length)}if(s||k||v.match(/^\/\/[^@\/]+@[^@\/]+/)){var _="//"===v.substr(0,2);!_||k&&b[k]||(v=v.substr(2),this.slashes=!0)}if(!b[k]&&(_||k&&!g[k])){for(var O,T,x=-1,C=0;C<l.length;C++){-1!==(I=v.indexOf(l[C]))&&(-1===x||I<x)&&(x=I)}-1!==(T=-1===x?v.lastIndexOf("@"):v.lastIndexOf("@",x))&&(O=v.slice(0,T),v=v.slice(T+1),this.auth=decodeURIComponent(O)),x=-1;for(C=0;C<u.length;C++){var I;-1!==(I=v.indexOf(u[C]))&&(-1===x||I<x)&&(x=I)}-1===x&&(x=v.length),this.host=v.slice(0,x),v=v.slice(x),this.parseHost(),this.hostname=this.hostname||"";var M="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!M)for(var N=this.hostname.split(/\./),A=(C=0,N.length);C<A;C++){var E=N[C];if(E&&!E.match(f)){for(var P="",B=0,V=E.length;B<V;B++)E.charCodeAt(B)>127?P+="x":P+=E[B];if(!P.match(f)){var L=N.slice(0,C),q=N.slice(C+1),D=E.match(p);D&&(L.push(D[1]),q.unshift(D[2])),q.length&&(v="/"+q.join(".")+v),this.hostname=L.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),M||(this.hostname=i.toASCII(this.hostname));var R=this.port?":"+this.port:"",G=this.hostname||"";this.host=G+R,this.href+=this.host,M&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==v[0]&&(v="/"+v))}if(!m[S])for(C=0,A=h.length;C<A;C++){var F=h[C];if(-1!==v.indexOf(F)){var U=encodeURIComponent(F);U===F&&(U=escape(F)),v=v.split(F).join(U)}}var j=v.indexOf("#");-1!==j&&(this.hash=v.substr(j),v=v.slice(0,j));var H=v.indexOf("?");if(-1!==H?(this.search=v.substr(H),this.query=v.substr(H+1),t&&(this.query=y.parse(this.query)),v=v.slice(0,H)):t&&(this.search="",this.query={}),v&&(this.pathname=v),g[S]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){R=this.pathname||"";var z=this.search||"";this.path=R+z}return this.href=this.format(),this},a.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",s=this.pathname||"",i=this.hash||"",a=!1,n="";this.host?a=e+this.host:this.hostname&&(a=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(a+=":"+this.port)),this.query&&r.isObject(this.query)&&Object.keys(this.query).length&&(n=y.stringify(this.query));var o=this.search||n&&"?"+n||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||g[t])&&!1!==a?(a="//"+(a||""),s&&"/"!==s.charAt(0)&&(s="/"+s)):a||(a=""),i&&"#"!==i.charAt(0)&&(i="#"+i),o&&"?"!==o.charAt(0)&&(o="?"+o),t+a+(s=s.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(o=o.replace("#","%23"))+i},a.prototype.resolve=function(e){return this.resolveObject(v(e,!1,!0)).format()},a.prototype.resolveObject=function(e){if(r.isString(e)){var t=new a;t.parse(e,!1,!0),e=t}for(var s=new a,i=Object.keys(this),n=0;n<i.length;n++){var o=i[n];s[o]=this[o]}if(s.hash=e.hash,""===e.href)return s.href=s.format(),s;if(e.slashes&&!e.protocol){for(var c=Object.keys(e),d=0;d<c.length;d++){var h=c[d];"protocol"!==h&&(s[h]=e[h])}return g[s.protocol]&&s.hostname&&!s.pathname&&(s.path=s.pathname="/"),s.href=s.format(),s}if(e.protocol&&e.protocol!==s.protocol){if(!g[e.protocol]){for(var u=Object.keys(e),l=0;l<u.length;l++){var f=u[l];s[f]=e[f]}return s.href=s.format(),s}if(s.protocol=e.protocol,e.host||b[e.protocol])s.pathname=e.pathname;else{for(var p=(e.pathname||"").split("/");p.length&&!(e.host=p.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),s.pathname=p.join("/")}if(s.search=e.search,s.query=e.query,s.host=e.host||"",s.auth=e.auth,s.hostname=e.hostname||e.host,s.port=e.port,s.pathname||s.search){var m=s.pathname||"",y=s.search||"";s.path=m+y}return s.slashes=s.slashes||e.slashes,s.href=s.format(),s}var v=s.pathname&&"/"===s.pathname.charAt(0),w=e.host||e.pathname&&"/"===e.pathname.charAt(0),k=w||v||s.host&&e.pathname,S=k,_=s.pathname&&s.pathname.split("/")||[],O=(p=e.pathname&&e.pathname.split("/")||[],s.protocol&&!g[s.protocol]);if(O&&(s.hostname="",s.port=null,s.host&&(""===_[0]?_[0]=s.host:_.unshift(s.host)),s.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===p[0]?p[0]=e.host:p.unshift(e.host)),e.host=null),k=k&&(""===p[0]||""===_[0])),w)s.host=e.host||""===e.host?e.host:s.host,s.hostname=e.hostname||""===e.hostname?e.hostname:s.hostname,s.search=e.search,s.query=e.query,_=p;else if(p.length)_||(_=[]),_.pop(),_=_.concat(p),s.search=e.search,s.query=e.query;else if(!r.isNullOrUndefined(e.search)){if(O)s.hostname=s.host=_.shift(),(M=!!(s.host&&s.host.indexOf("@")>0)&&s.host.split("@"))&&(s.auth=M.shift(),s.host=s.hostname=M.shift());return s.search=e.search,s.query=e.query,r.isNull(s.pathname)&&r.isNull(s.search)||(s.path=(s.pathname?s.pathname:"")+(s.search?s.search:"")),s.href=s.format(),s}if(!_.length)return s.pathname=null,s.search?s.path="/"+s.search:s.path=null,s.href=s.format(),s;for(var T=_.slice(-1)[0],x=(s.host||e.host||_.length>1)&&("."===T||".."===T)||""===T,C=0,I=_.length;I>=0;I--)"."===(T=_[I])?_.splice(I,1):".."===T?(_.splice(I,1),C++):C&&(_.splice(I,1),C--);if(!k&&!S)for(;C--;C)_.unshift("..");!k||""===_[0]||_[0]&&"/"===_[0].charAt(0)||_.unshift(""),x&&"/"!==_.join("/").substr(-1)&&_.push("");var M,N=""===_[0]||_[0]&&"/"===_[0].charAt(0);O&&(s.hostname=s.host=N?"":_.length?_.shift():"",(M=!!(s.host&&s.host.indexOf("@")>0)&&s.host.split("@"))&&(s.auth=M.shift(),s.host=s.hostname=M.shift()));return(k=k||s.host&&_.length)&&!N&&_.unshift(""),_.length?s.pathname=_.join("/"):(s.pathname=null,s.path=null),r.isNull(s.pathname)&&r.isNull(s.search)||(s.path=(s.pathname?s.pathname:"")+(s.search?s.search:"")),s.auth=e.auth||s.auth,s.slashes=s.slashes||e.slashes,s.href=s.format(),s},a.prototype.parseHost=function(){var e=this.host,t=o.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},2502:e=>{"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},4927:(e,t,s)=>{function i(e){try{if(!s.g.localStorage)return!1}catch(e){return!1}var t=s.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(i("noDeprecation"))return e;var s=!1;return function(){if(!s){if(i("throwDeprecation"))throw new Error(t);i("traceDeprecation")?console.trace(t):console.warn(t),s=!0}return e.apply(this,arguments)}}},1496:e=>{"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var s=function(){};s.prototype=t.prototype,e.prototype=new s,e.prototype.constructor=e}},384:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},9539:(e,t,s)=>{var i=s(4155),r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),s={},i=0;i<t.length;i++)s[t[i]]=Object.getOwnPropertyDescriptor(e,t[i]);return s},a=/%[sdj%]/g;t.format=function(e){if(!y(e)){for(var t=[],s=0;s<arguments.length;s++)t.push(c(arguments[s]));return t.join(" ")}s=1;for(var i=arguments,r=i.length,n=String(e).replace(a,(function(e){if("%%"===e)return"%";if(s>=r)return e;switch(e){case"%s":return String(i[s++]);case"%d":return Number(i[s++]);case"%j":try{return JSON.stringify(i[s++])}catch(e){return"[Circular]"}default:return e}})),o=i[s];s<r;o=i[++s])b(o)||!k(o)?n+=" "+o:n+=" "+c(o);return n},t.deprecate=function(e,s){if(void 0!==i&&!0===i.noDeprecation)return e;if(void 0===i)return function(){return t.deprecate(e,s).apply(this,arguments)};var r=!1;return function(){if(!r){if(i.throwDeprecation)throw new Error(s);i.traceDeprecation?console.trace(s):console.error(s),r=!0}return e.apply(this,arguments)}};var n,o={};function c(e,s){var i={seen:[],stylize:h};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),m(s)?i.showHidden=s:s&&t._extend(i,s),v(i.showHidden)&&(i.showHidden=!1),v(i.depth)&&(i.depth=2),v(i.colors)&&(i.colors=!1),v(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=d),u(i,e,i.depth)}function d(e,t){var s=c.styles[t];return s?"["+c.colors[s][0]+"m"+e+"["+c.colors[s][1]+"m":e}function h(e,t){return e}function u(e,s,i){if(e.customInspect&&s&&O(s.inspect)&&s.inspect!==t.inspect&&(!s.constructor||s.constructor.prototype!==s)){var r=s.inspect(i,e);return y(r)||(r=u(e,r,i)),r}var a=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(y(t)){var s="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(s,"string")}if(g(t))return e.stylize(""+t,"number");if(m(t))return e.stylize(""+t,"boolean");if(b(t))return e.stylize("null","null")}(e,s);if(a)return a;var n=Object.keys(s),o=function(e){var t={};return e.forEach((function(e,s){t[e]=!0})),t}(n);if(e.showHidden&&(n=Object.getOwnPropertyNames(s)),_(s)&&(n.indexOf("message")>=0||n.indexOf("description")>=0))return l(s);if(0===n.length){if(O(s)){var c=s.name?": "+s.name:"";return e.stylize("[Function"+c+"]","special")}if(w(s))return e.stylize(RegExp.prototype.toString.call(s),"regexp");if(S(s))return e.stylize(Date.prototype.toString.call(s),"date");if(_(s))return l(s)}var d,h="",k=!1,T=["{","}"];(p(s)&&(k=!0,T=["[","]"]),O(s))&&(h=" [Function"+(s.name?": "+s.name:"")+"]");return w(s)&&(h=" "+RegExp.prototype.toString.call(s)),S(s)&&(h=" "+Date.prototype.toUTCString.call(s)),_(s)&&(h=" "+l(s)),0!==n.length||k&&0!=s.length?i<0?w(s)?e.stylize(RegExp.prototype.toString.call(s),"regexp"):e.stylize("[Object]","special"):(e.seen.push(s),d=k?function(e,t,s,i,r){for(var a=[],n=0,o=t.length;n<o;++n)M(t,String(n))?a.push(f(e,t,s,i,String(n),!0)):a.push("");return r.forEach((function(r){r.match(/^\d+$/)||a.push(f(e,t,s,i,r,!0))})),a}(e,s,i,o,n):n.map((function(t){return f(e,s,i,o,t,k)})),e.seen.pop(),function(e,t,s){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return s[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+s[1];return s[0]+t+" "+e.join(", ")+" "+s[1]}(d,h,T)):T[0]+h+T[1]}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,s,i,r,a){var n,o,c;if((c=Object.getOwnPropertyDescriptor(t,r)||{value:t[r]}).get?o=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(o=e.stylize("[Setter]","special")),M(i,r)||(n="["+r+"]"),o||(e.seen.indexOf(c.value)<0?(o=b(s)?u(e,c.value,null):u(e,c.value,s-1)).indexOf("\n")>-1&&(o=a?o.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+o.split("\n").map((function(e){return"   "+e})).join("\n")):o=e.stylize("[Circular]","special")),v(n)){if(a&&r.match(/^\d+$/))return o;(n=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),n=e.stylize(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),n=e.stylize(n,"string"))}return n+": "+o}function p(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function b(e){return null===e}function g(e){return"number"==typeof e}function y(e){return"string"==typeof e}function v(e){return void 0===e}function w(e){return k(e)&&"[object RegExp]"===T(e)}function k(e){return"object"==typeof e&&null!==e}function S(e){return k(e)&&"[object Date]"===T(e)}function _(e){return k(e)&&("[object Error]"===T(e)||e instanceof Error)}function O(e){return"function"==typeof e}function T(e){return Object.prototype.toString.call(e)}function x(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(v(n)&&(n=i.env.NODE_DEBUG||""),e=e.toUpperCase(),!o[e])if(new RegExp("\\b"+e+"\\b","i").test(n)){var s=i.pid;o[e]=function(){var i=t.format.apply(t,arguments);console.error("%s %d: %s",e,s,i)}}else o[e]=function(){};return o[e]},t.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=p,t.isBoolean=m,t.isNull=b,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=y,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=v,t.isRegExp=w,t.isObject=k,t.isDate=S,t.isError=_,t.isFunction=O,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=s(384);var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function I(){var e=new Date,t=[x(e.getHours()),x(e.getMinutes()),x(e.getSeconds())].join(":");return[e.getDate(),C[e.getMonth()],t].join(" ")}function M(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",I(),t.format.apply(t,arguments))},t.inherits=s(1496),t._extend=function(e,t){if(!t||!k(t))return e;for(var s=Object.keys(t),i=s.length;i--;)e[s[i]]=t[s[i]];return e};var N="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function A(e,t){if(!e){var s=new Error("Promise was rejected with a falsy value");s.reason=e,e=s}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(N&&e[N]){var t;if("function"!=typeof(t=e[N]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,N,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,s,i=new Promise((function(e,i){t=e,s=i})),r=[],a=0;a<arguments.length;a++)r.push(arguments[a]);r.push((function(e,i){e?s(e):t(i)}));try{e.apply(this,r)}catch(e){s(e)}return i}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),N&&Object.defineProperty(t,N,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=N,t.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],s=0;s<arguments.length;s++)t.push(arguments[s]);var r=t.pop();if("function"!=typeof r)throw new TypeError("The last argument must be of type Function");var a=this,n=function(){return r.apply(a,arguments)};e.apply(this,t).then((function(e){i.nextTick(n,null,e)}),(function(e){i.nextTick(A,e,n)}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,r(e)),t}},7026:e=>{"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},7529:e=>{e.exports=function(){for(var e={},s=0;s<arguments.length;s++){var i=arguments[s];for(var r in i)t.call(i,r)&&(e[r]=i[r])}return e};var t=Object.prototype.hasOwnProperty},2361:()=>{},4616:()=>{}},t={};function s(i){var r=t[i];if(void 0!==r)return r.exports;var a=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(a.exports,a,a.exports,s),a.loaded=!0,a.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,i=n(e);if(t){var r=n(this).constructor;s=Reflect.construct(i,arguments,r)}else s=i.apply(this,arguments);return c(this,s)}}var h=function(){function t(s){e(this,t),this._defaultOptions={auth:{headers:{}},authEndpoint:"/broadcasting/auth",broadcaster:"pusher",csrfToken:null,host:null,key:null,namespace:"App.Events"},this.setOptions(s),this.connect()}return i(t,[{key:"setOptions",value:function(e){return this.options=r(this._defaultOptions,e),this.csrfToken()&&(this.options.auth.headers["X-CSRF-TOKEN"]=this.csrfToken()),e}},{key:"csrfToken",value:function(){var e;return"undefined"!=typeof window&&window.Laravel&&window.Laravel.csrfToken?window.Laravel.csrfToken:this.options.csrfToken?this.options.csrfToken:"undefined"!=typeof document&&"function"==typeof document.querySelector&&(e=document.querySelector('meta[name="csrf-token"]'))?e.getAttribute("content"):null}}]),t}(),u=function(){function t(){e(this,t)}return i(t,[{key:"listenForWhisper",value:function(e,t){return this.listen(".client-"+e,t)}},{key:"notification",value:function(e){return this.listen(".Illuminate\\Notifications\\Events\\BroadcastNotificationCreated",e)}},{key:"stopListeningForWhisper",value:function(e,t){return this.stopListening(".client-"+e,t)}}]),t}(),l=function(){function t(s){e(this,t),this.setNamespace(s)}return i(t,[{key:"format",value:function(e){return"."===e.charAt(0)||"\\"===e.charAt(0)?e.substr(1):(this.namespace&&(e=this.namespace+"."+e),e.replace(/\./g,"\\"))}},{key:"setNamespace",value:function(e){this.namespace=e}}]),t}(),f=function(t){a(r,t);var s=d(r);function r(t,i,a){var n;return e(this,r),(n=s.call(this)).name=i,n.pusher=t,n.options=a,n.eventFormatter=new l(n.options.namespace),n.subscribe(),n}return i(r,[{key:"subscribe",value:function(){this.subscription=this.pusher.subscribe(this.name)}},{key:"unsubscribe",value:function(){this.pusher.unsubscribe(this.name)}},{key:"listen",value:function(e,t){return this.on(this.eventFormatter.format(e),t),this}},{key:"listenToAll",value:function(e){var t=this;return this.subscription.bind_global((function(s,i){if(!s.startsWith("pusher:")){var r=t.options.namespace.replace(/\./g,"\\"),a=s.startsWith(r)?s.substring(r.length+1):"."+s;e(a,i)}})),this}},{key:"stopListening",value:function(e,t){return t?this.subscription.unbind(this.eventFormatter.format(e),t):this.subscription.unbind(this.eventFormatter.format(e)),this}},{key:"stopListeningToAll",value:function(e){return e?this.subscription.unbind_global(e):this.subscription.unbind_global(),this}},{key:"subscribed",value:function(e){return this.on("pusher:subscription_succeeded",(function(){e()})),this}},{key:"error",value:function(e){return this.on("pusher:subscription_error",(function(t){e(t)})),this}},{key:"on",value:function(e,t){return this.subscription.bind(e,t),this}}]),r}(u),p=function(t){a(r,t);var s=d(r);function r(){return e(this,r),s.apply(this,arguments)}return i(r,[{key:"whisper",value:function(e,t){return this.pusher.channels.channels[this.name].trigger("client-".concat(e),t),this}}]),r}(f),m=function(t){a(r,t);var s=d(r);function r(){return e(this,r),s.apply(this,arguments)}return i(r,[{key:"whisper",value:function(e,t){return this.pusher.channels.channels[this.name].trigger("client-".concat(e),t),this}}]),r}(f),b=function(t){a(r,t);var s=d(r);function r(){return e(this,r),s.apply(this,arguments)}return i(r,[{key:"here",value:function(e){return this.on("pusher:subscription_succeeded",(function(t){e(Object.keys(t.members).map((function(e){return t.members[e]})))})),this}},{key:"joining",value:function(e){return this.on("pusher:member_added",(function(t){e(t.info)})),this}},{key:"leaving",value:function(e){return this.on("pusher:member_removed",(function(t){e(t.info)})),this}},{key:"whisper",value:function(e,t){return this.pusher.channels.channels[this.name].trigger("client-".concat(e),t),this}}]),r}(f),g=function(t){a(r,t);var s=d(r);function r(t,i,a){var n;return e(this,r),(n=s.call(this)).events={},n.listeners={},n.name=i,n.socket=t,n.options=a,n.eventFormatter=new l(n.options.namespace),n.subscribe(),n}return i(r,[{key:"subscribe",value:function(){this.socket.emit("subscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"unsubscribe",value:function(){this.unbind(),this.socket.emit("unsubscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"listen",value:function(e,t){return this.on(this.eventFormatter.format(e),t),this}},{key:"stopListening",value:function(e,t){return this.unbindEvent(this.eventFormatter.format(e),t),this}},{key:"subscribed",value:function(e){return this.on("connect",(function(t){e(t)})),this}},{key:"error",value:function(e){return this}},{key:"on",value:function(e,t){var s=this;return this.listeners[e]=this.listeners[e]||[],this.events[e]||(this.events[e]=function(t,i){s.name===t&&s.listeners[e]&&s.listeners[e].forEach((function(e){return e(i)}))},this.socket.on(e,this.events[e])),this.listeners[e].push(t),this}},{key:"unbind",value:function(){var e=this;Object.keys(this.events).forEach((function(t){e.unbindEvent(t)}))}},{key:"unbindEvent",value:function(e,t){this.listeners[e]=this.listeners[e]||[],t&&(this.listeners[e]=this.listeners[e].filter((function(e){return e!==t}))),t&&0!==this.listeners[e].length||(this.events[e]&&(this.socket.removeListener(e,this.events[e]),delete this.events[e]),delete this.listeners[e])}}]),r}(u),y=function(t){a(r,t);var s=d(r);function r(){return e(this,r),s.apply(this,arguments)}return i(r,[{key:"whisper",value:function(e,t){return this.socket.emit("client event",{channel:this.name,event:"client-".concat(e),data:t}),this}}]),r}(g),v=function(t){a(r,t);var s=d(r);function r(){return e(this,r),s.apply(this,arguments)}return i(r,[{key:"here",value:function(e){return this.on("presence:subscribed",(function(t){e(t.map((function(e){return e.user_info})))})),this}},{key:"joining",value:function(e){return this.on("presence:joining",(function(t){return e(t.user_info)})),this}},{key:"leaving",value:function(e){return this.on("presence:leaving",(function(t){return e(t.user_info)})),this}}]),r}(y),w=function(t){a(r,t);var s=d(r);function r(){return e(this,r),s.apply(this,arguments)}return i(r,[{key:"subscribe",value:function(){}},{key:"unsubscribe",value:function(){}},{key:"listen",value:function(e,t){return this}},{key:"stopListening",value:function(e,t){return this}},{key:"subscribed",value:function(e){return this}},{key:"error",value:function(e){return this}},{key:"on",value:function(e,t){return this}}]),r}(u),k=function(t){a(r,t);var s=d(r);function r(){return e(this,r),s.apply(this,arguments)}return i(r,[{key:"whisper",value:function(e,t){return this}}]),r}(w),S=function(t){a(r,t);var s=d(r);function r(){return e(this,r),s.apply(this,arguments)}return i(r,[{key:"here",value:function(e){return this}},{key:"joining",value:function(e){return this}},{key:"leaving",value:function(e){return this}},{key:"whisper",value:function(e,t){return this}}]),r}(w),_=function(t){a(r,t);var s=d(r);function r(){var t;return e(this,r),(t=s.apply(this,arguments)).channels={},t}return i(r,[{key:"connect",value:function(){void 0!==this.options.client?this.pusher=this.options.client:this.pusher=new Pusher(this.options.key,this.options)}},{key:"listen",value:function(e,t,s){return this.channel(e).listen(t,s)}},{key:"channel",value:function(e){return this.channels[e]||(this.channels[e]=new f(this.pusher,e,this.options)),this.channels[e]}},{key:"privateChannel",value:function(e){return this.channels["private-"+e]||(this.channels["private-"+e]=new p(this.pusher,"private-"+e,this.options)),this.channels["private-"+e]}},{key:"encryptedPrivateChannel",value:function(e){return this.channels["private-encrypted-"+e]||(this.channels["private-encrypted-"+e]=new m(this.pusher,"private-encrypted-"+e,this.options)),this.channels["private-encrypted-"+e]}},{key:"presenceChannel",value:function(e){return this.channels["presence-"+e]||(this.channels["presence-"+e]=new b(this.pusher,"presence-"+e,this.options)),this.channels["presence-"+e]}},{key:"leave",value:function(e){var t=this;[e,"private-"+e,"presence-"+e].forEach((function(e,s){t.leaveChannel(e)}))}},{key:"leaveChannel",value:function(e){this.channels[e]&&(this.channels[e].unsubscribe(),delete this.channels[e])}},{key:"socketId",value:function(){return this.pusher.connection.socket_id}},{key:"disconnect",value:function(){this.pusher.disconnect()}}]),r}(h),O=function(t){a(r,t);var s=d(r);function r(){var t;return e(this,r),(t=s.apply(this,arguments)).channels={},t}return i(r,[{key:"connect",value:function(){var e=this,t=this.getSocketIO();return this.socket=t(this.options.host,this.options),this.socket.on("reconnect",(function(){Object.values(e.channels).forEach((function(e){e.subscribe()}))})),this.socket}},{key:"getSocketIO",value:function(){if(void 0!==this.options.client)return this.options.client;if("undefined"!=typeof io)return io;throw new Error("Socket.io client not found. Should be globally available or passed via options.client")}},{key:"listen",value:function(e,t,s){return this.channel(e).listen(t,s)}},{key:"channel",value:function(e){return this.channels[e]||(this.channels[e]=new g(this.socket,e,this.options)),this.channels[e]}},{key:"privateChannel",value:function(e){return this.channels["private-"+e]||(this.channels["private-"+e]=new y(this.socket,"private-"+e,this.options)),this.channels["private-"+e]}},{key:"presenceChannel",value:function(e){return this.channels["presence-"+e]||(this.channels["presence-"+e]=new v(this.socket,"presence-"+e,this.options)),this.channels["presence-"+e]}},{key:"leave",value:function(e){var t=this;[e,"private-"+e,"presence-"+e].forEach((function(e){t.leaveChannel(e)}))}},{key:"leaveChannel",value:function(e){this.channels[e]&&(this.channels[e].unsubscribe(),delete this.channels[e])}},{key:"socketId",value:function(){return this.socket.id}},{key:"disconnect",value:function(){this.socket.disconnect()}}]),r}(h),T=function(t){a(r,t);var s=d(r);function r(){var t;return e(this,r),(t=s.apply(this,arguments)).channels={},t}return i(r,[{key:"connect",value:function(){}},{key:"listen",value:function(e,t,s){return new w}},{key:"channel",value:function(e){return new w}},{key:"privateChannel",value:function(e){return new k}},{key:"presenceChannel",value:function(e){return new S}},{key:"leave",value:function(e){}},{key:"leaveChannel",value:function(e){}},{key:"socketId",value:function(){return"fake-socket-id"}},{key:"disconnect",value:function(){}}]),r}(h);const x=function(){function t(s){e(this,t),this.options=s,this.connect(),this.options.withoutInterceptors||this.registerInterceptors()}return i(t,[{key:"channel",value:function(e){return this.connector.channel(e)}},{key:"connect",value:function(){"pusher"==this.options.broadcaster?this.connector=new _(this.options):"socket.io"==this.options.broadcaster?this.connector=new O(this.options):"null"==this.options.broadcaster?this.connector=new T(this.options):"function"==typeof this.options.broadcaster&&(this.connector=new this.options.broadcaster(this.options))}},{key:"disconnect",value:function(){this.connector.disconnect()}},{key:"join",value:function(e){return this.connector.presenceChannel(e)}},{key:"leave",value:function(e){this.connector.leave(e)}},{key:"leaveChannel",value:function(e){this.connector.leaveChannel(e)}},{key:"listen",value:function(e,t,s){return this.connector.listen(e,t,s)}},{key:"private",value:function(e){return this.connector.privateChannel(e)}},{key:"encryptedPrivate",value:function(e){return this.connector.encryptedPrivateChannel(e)}},{key:"socketId",value:function(){return this.connector.socketId()}},{key:"registerInterceptors",value:function(){"function"==typeof Vue&&Vue.http&&this.registerVueRequestInterceptor(),"function"==typeof axios&&this.registerAxiosRequestInterceptor(),"function"==typeof jQuery&&this.registerjQueryAjaxSetup()}},{key:"registerVueRequestInterceptor",value:function(){var e=this;Vue.http.interceptors.push((function(t,s){e.socketId()&&t.headers.set("X-Socket-ID",e.socketId()),s()}))}},{key:"registerAxiosRequestInterceptor",value:function(){var e=this;axios.interceptors.request.use((function(t){return e.socketId()&&(t.headers["X-Socket-Id"]=e.socketId()),t}))}},{key:"registerjQueryAjaxSetup",value:function(){var e=this;void 0!==jQuery.ajax&&jQuery.ajaxPrefilter((function(t,s,i){e.socketId()&&i.setRequestHeader("X-Socket-Id",e.socketId())}))}}]),t}();window.Pusher=s(6606),window.Echo=new x({broadcaster:"pusher",key:"d2059ddf4f6dd4d07d04",cluster:"ap2",forceTLS:!0});var C=s(6455),I=s.n(C);function M(e,t){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=document.querySelector(".alert-box"),r=document.createElement("div"),a=document.createElement("div"),n=document.createElement("p"),o=document.createElement("a"),c=document.createElement("div");r.classList.add("ab"),a.classList.add("ab_inner"),n.classList.add("ab_inner--msg"),n.innerText=e,o.classList.add("ab_inner--close"),o.setAttribute("href","#"),o.innerText="✕",c.classList.add("ab_inner--sign"),c.classList.add(t),c.innerHTML+='<svg class="ab_svg"><use xlink:href="/extra.svg#fa-'.concat(t,'"></use></svg>'),a.appendChild(n),a.appendChild(o),a.appendChild(c),r.appendChild(a),i.appendChild(r),o.addEventListener("click",(function(e){var t=e.target.closest(".ab");t.classList.add("hide"),t.parentNode.removeChild(t)})),s||(setTimeout((function(){r.classList.add("hide")}),3e3),setTimeout((function(){r.parentNode&&r.parentNode.removeChild(r)}),3400))}window.addEventListener("fetchPriceException",(function(){M("Сервер не смог обработать запрос. Пожалуйста, убедитесь, что у Вас нет проблем с соединением, обновите страницу и попробуйте снова.","error",!0)})),window.addEventListener("swal:confirm",(function(e){var t=e.detail,s="en"===document.documentElement.getAttribute("lang")?"Cancel":"Отменить";I().fire({title:t.title,text:t.text,icon:t.icon,confirmButtonText:t.confirmText,showCancelButton:!0,cancelButtonText:s,reverseButtons:!0,customClass:{title:"title",cancelButton:"cancelButton",confirmButton:"confirmButton ".concat(t.icon)}}).then((function(e){e.isConfirmed&&("algo"===t.model&&window.livewire.emit("toggle-algo"),"deal:close"===t.model&&window.livewire.emit("close-deal",t.id,t.profit))}))})),window.addEventListener("user:throw-alert",(function(e){return M(e.detail.message,e.detail.status)})),window.addEventListener("user:location-reload",(function(e){M(e.detail.message,e.detail.status),setTimeout((function(){return window.location.reload()}),1e3)}));var N=s(7757),A=s.n(N),E=s(9669),P=s.n(E),B=s(2956),V=s.n(B),L=document.querySelector(".page-spinner-wrapper"),q=function(){L.classList.remove("hidden"),L.classList.add("flex")},D=function(){L.classList.add("hidden"),L.classList.remove("flex")};function R(e,t,s,i,r,a,n){try{var o=e[a](n),c=o.value}catch(e){return void s(e)}o.done?t(c):Promise.resolve(c).then(i,r)}function G(){window.addEventListener("reindex-table",(function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t&&q(),setTimeout((function(){e(),t&&D()}),2222)}));var e=function(){var e=document.querySelectorAll("#dealsTable tbody tr"),t={};e.forEach((function(e){var s,i=e.getAttribute("data-id").trim(),r=e.querySelector(".deal__dest").innerText.trim(),a=e.querySelector(".deal__als").innerText.trim(),n=e.querySelector(".deal-profit__profit"),o=parseFloat(e.querySelector(".deal__inv").innerText.trim()),c=parseFloat(e.getAttribute("data-pwb")),d=e.querySelector(".deal-profit");(s=A().mark((function s(){var h,u,l,f,p;return A().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:h=new(V().currencycom)({enableRateLimit:!0});case 1:if(0!=e.getAttribute("data-ico")){s.next=14;break}return s.next=4,Promise.all([h.watchTicker("".concat(a,"/USD"))]);case 4:u=s.sent,l=u[0].last,f=(l*o/c).toFixed(2),p=(c*o/l).toFixed(2),n.innerText=t[i]="Buy"===r?f:p,d.classList.add("bg-price"),setTimeout((function(){return d.classList.remove("bg-price")}),150),"Buy"===r&&parseFloat(f)>o||"Sell"===r&&parseFloat(p)>o?(d.classList.add("up"),d.classList.remove("down")):(d.classList.add("down"),d.classList.remove("up")),s.next=1;break;case 14:case"end":return s.stop()}}),s)})),function(){var e=this,t=arguments;return new Promise((function(i,r){var a=s.apply(e,t);function n(e){R(a,i,r,n,o,"next",e)}function o(e){R(a,i,r,n,o,"throw",e)}n(void 0)}))})()})),function(e){try{setInterval((function(){P().post("/user/update-profit",{payload:e})}),5e3)}catch(e){}}(t)};e()}function F(e,t,s,i,r,a,n){try{var o=e[a](n),c=o.value}catch(e){return void s(e)}o.done?t(c):Promise.resolve(c).then(i,r)}function U(e){return function(){var t=this,s=arguments;return new Promise((function(i,r){var a=e.apply(t,s);function n(e){F(a,i,r,n,o,"next",e)}function o(e){F(a,i,r,n,o,"throw",e)}n(void 0)}))}}function j(){function e(e){return t.apply(this,arguments)}function t(){return(t=U(A().mark((function e(t){var s,i,r;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"1cf225187412007c872394b0e5fa1208",e.next=3,fetch("https://api.marketstack.com/v1/eod?access_key=".concat("1cf225187412007c872394b0e5fa1208","&symbols=").concat(t));case 3:return s=e.sent,e.next=6,s.json();case 6:return i=e.sent,r=i.data[0].close,e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}window.addEventListener("reindex-table",(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&q(),setTimeout((function(){s(),e&&D()}),2222)}));var s=function(){for(var t=document.querySelectorAll("#dealsTable tbody tr"),s={},i=function(i){var r=t[i],a=r.querySelector(".deal__inv").innerText.trim(),n=r.querySelector(".deal__dest").innerText.trim(),o=r.querySelector(".deal__als").innerText.trim(),c=r.querySelector(".deal-profit"),d=r.querySelector(".deal-profit__profit"),h=r.getAttribute("data-id").trim(),u=function(){var t=U(A().mark((function t(){var i,u,l,f,p;return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e(o);case 3:i=t.sent,u=(i*a/r.getAttribute("data-pwb")).toFixed(2),l=u-a,c.classList.add("bg-price"),setTimeout((function(){return c.classList.remove("bg-price")}),150),"Sell"===n?(f=parseFloat(a-l).toFixed(2),d.innerText=f,s[h]=f):(p=parseFloat(u).toFixed(2),d.innerText=p,s[h]=p),d.innerText>a?(c.classList.add("up"),c.classList.remove("down")):(c.classList.remove("up"),c.classList.add("down")),t.next=14;break;case 12:t.prev=12,t.t0=t.catch(0);case 14:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(){return t.apply(this,arguments)}}();!function(e){try{setInterval((function(){P().post("/user/update-profit",{payload:e})}),5e3)}catch(e){}}(s),setInterval((function(){return u()}),1e4),u()},r=t.length-1;r>=0;r--)i(r)};s()}document.addEventListener("DOMContentLoaded",(function(){var e,t,s,i,r;s="en"===document.documentElement.getAttribute("lang")?"Copied!":"Скопировано!",i=document.querySelector(".copy-btn__btc"),r=document.getElementById("textToBeCopied"),i&&r&&(t=r,(e=i).addEventListener("click",(function(){var i=document.createElement("input"),r=document.body;r.appendChild(i),i.value=t.innerHTML.trim(),i.select(),document.execCommand("copy"),r.removeChild(i),e.querySelector("span").innerText=s,e.style.background="#366C3C"}))),function(){var e=document.querySelectorAll('button[data-type="check"]');function t(e){var t=document.documentElement.getAttribute("lang"),s="en"===t?"Action rejected. Please contact technical support for details.":"Команда отклонена. Пожалуйста, обратитесь в техническую поддержку за подробностями.",i="en"===t?"To make withdrawals, your account must be verified.":"Для того, чтобы выводить деньги, вам нужно верифицировать свой аккаунт.";if("false"===e.target.dataset.pass){if("not-verified"===e.target.dataset.spec)return M(i,"error"),!1;if("baned"===e.target.dataset.spec)return M(s,"error"),!1}}e&&e.forEach((function(e){e.addEventListener("click",t)}))}(),new Pusher("d2059ddf4f6dd4d07d04",{cluster:"ap2"}).subscribe("chat-room").bind("chat-message-sent",(function(){Livewire.emit("refetch")})),document.querySelector(".market_crypto")&&G(),document.querySelector(".market_forex")&&j(),document.querySelector(".inv-modal"),document.querySelector(".payInfoForm")}))})()})();